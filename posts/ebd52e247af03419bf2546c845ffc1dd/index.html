<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微服务架构的优势与不足 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微服务架构的优势与不足" />
<meta property="og:description" content="原文链接：http://blog.daocloud.io/microservices-1/?utm_source=tuicool&amp;utm_medium=referral
编者的话｜本文来自 Nginx 官方博客，是微服务系列文章的第一篇，主要探讨了传统的单体式应用的不足，以及微服务架构的优势与挑战。
作者介绍：Chris Richardson，是世界著名的软件大师，经典技术著作《POJOS IN ACTION》一书的作者，也是 cloudfoundry.com 最初的创始人，Chris Richardson 与 Martin Fowler、Sam Newman、Adrian Cockcroft 等并称为世界十大软件架构师。
Chris Richardson 所著所有文章已独家授权 DaoCloud 翻译并刊载。
本期内容 微服务在当下引起广泛关注，成为文章、博客、社交媒体讨论和大会演讲的热点；在 Gartner 的 “Hype Cycle” 上排名也非常靠前。与此同时，在软件社区也有人质疑微服务并非新事物。反对者认为微服务只是 SOA （Service Oriented Architecture）的二度包装。然而，无论是追捧还是质疑，微服务架构拥有巨大优势，尤其是它让敏捷开发和复杂的企业应用交付成为可能。
本系列包含 7 篇文章，介绍了微服务的设计、构建和部署，并与传统的单体架构进行了比较。本系列将分析微服务架构的各种因素，你也将了解微服务架构模型的优劣、是否适合你的项目，以及如何应用。
Chris Richardson 微服务系列全 7 篇：
1. 微服务架构概念解析
2. 构建微服务架构：使用 API Gateway
3. 深入微服务架构的进程间通信
4. 服务发现的可行方案以及实践案例
5. 微服务的事件驱动数据管理
6. 选择微服务部署策略
7. 将单体应用改造为微服务
首先让我们了解为何要将微服务纳入考量。
构建单体应用 假设我们要开发一款全新的与 Uber 和 Hailo 竞争的打车软件。在前期的会议和需求整理后，你要么需要手动创建一个新项目，要么可以使用 Rails、Spring Boot、Play 或者 Maven 来生成。这个新应用可能采用了六边形架构模块，如下图所示：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ebd52e247af03419bf2546c845ffc1dd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-05-20T13:44:46+08:00" />
<meta property="article:modified_time" content="2016-05-20T13:44:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微服务架构的优势与不足</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>原文链接：<a target="_blank" href="http://blog.daocloud.io/microservices-1/?utm_source=tuicool&amp;utm_medium=referral" rel="nofollow noopener noreferrer">http://blog.daocloud.io/microservices-1/?utm_source=tuicool&amp;utm_medium=referral</a></p> 
<p></p> 
<blockquote style="padding:0px; margin:24px 40px; font-size:18px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-style:italic; outline:0px; vertical-align:baseline; quotes:&quot;&quot; &quot;&quot;; line-height:26px; color:rgb(64,64,64)"> 
 <p style="margin-top:0px; margin-bottom:0px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">编者的话｜</span>本文来自 Nginx 官方博客，是微服务系列文章的第一篇，主要探讨了传统的单体式应用的不足，以及微服务架构的优势与挑战。</p> 
</blockquote> 
<p></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span id="more-3149" style="border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline"></span></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">作者介绍：</span>Chris Richardson，是世界著名的软件大师，经典技术著作《POJOS IN ACTION》一书的作者，也是 cloudfoundry.com 最初的创始人，Chris Richardson 与 Martin Fowler、Sam Newman、Adrian Cockcroft 等并称为世界十大软件架构师。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">Chris Richardson 所著所有文章已独家授权 DaoCloud 翻译并刊载。</span></p> 
<h4 class="135brush" style="font-family:inherit; font-weight:inherit; line-height:inherit; color:inherit; margin:15px 0px 10px; font-size:24px; border:0px; font-style:inherit; outline:0px; padding:0px; vertical-align:baseline; clear:both; font-variant:inherit; float:left; width:825px"> 本期内容</h4> 
<hr style="height:1px; margin-top:20px; margin-bottom:1.5em; border-right-width:0px; border-bottom-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(238,238,238); background-color:rgb(204,204,204)"> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 微服务在当下引起广泛关注，成为文章、博客、社交媒体讨论和大会演讲的热点；在 Gartner 的 “Hype Cycle” 上排名也非常靠前。与此同时，在软件社区也有人质疑微服务并非新事物。反对者认为微服务只是 SOA （Service Oriented Architecture）的二度包装。然而，无论是追捧还是质疑，微服务架构拥有巨大优势，尤其是它让敏捷开发和复杂的企业应用交付成为可能。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 本系列包含 7 篇文章，介绍了微服务的设计、构建和部署，并与传统的单体架构进行了比较。本系列将分析微服务架构的各种因素，你也将了解微服务架构模型的优劣、是否适合你的项目，以及如何应用。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> Chris Richardson 微服务系列全 7 篇：</p> 
<blockquote style="padding:0px; margin:24px 40px; font-size:18px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-style:italic; outline:0px; vertical-align:baseline; quotes:&quot;&quot; &quot;&quot;; line-height:26px; color:rgb(64,64,64)"> 
 <p style="margin-top:0px; margin-bottom:24px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 1. 微服务架构概念解析</p> 
 <p style="margin-top:0px; margin-bottom:24px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 2. 构建微服务架构：使用 API Gateway</p> 
 <p style="margin-top:0px; margin-bottom:24px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 3. 深入微服务架构的进程间通信</p> 
 <p style="margin-top:0px; margin-bottom:24px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 4. 服务发现的可行方案以及实践案例</p> 
 <p style="margin-top:0px; margin-bottom:24px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 5. 微服务的事件驱动数据管理</p> 
 <p style="margin-top:0px; margin-bottom:24px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 6. 选择微服务部署策略</p> 
 <p style="margin-top:0px; margin-bottom:0px; border:0px; font-size:16px; font-style:inherit; font-weight:inherit; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline"> 7. 将单体应用改造为微服务</p> 
</blockquote> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 首先让我们了解为何要将微服务纳入考量。</p> 
<h3 id="toc_0" style="font-family:Montserrat,sans-serif; line-height:35px; color:rgb(64,64,64); margin:15px 0px 10px; font-size:26px; border:0px; outline:0px; padding:0px; vertical-align:baseline; clear:both; float:left; width:825px"> 构建单体应用</h3> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 假设我们要开发一款全新的与 Uber 和 Hailo 竞争的打车软件。在前期的会议和需求整理后，你要么需要手动创建一个新项目，要么可以使用 Rails、Spring Boot、Play 或者 Maven 来生成。这个新应用可能采用了六边形架构模块，如下图所示：</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <a target="_blank" href="http://blog.daocloud.io/wp-content/uploads/2016/05/Richardson-microservices-part1-1_monolithic-architecture.png" rel="nofollow noopener noreferrer" style="color:purple; text-decoration:none; border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline; background:0px 0px"><img class=" size-full wp-image-3150 aligncenter" src="https://images2.imgbox.com/92/5f/0L3VOf92_o.png" alt="Richardson-microservices-part1-1_monolithic-architecture" width="767" height="810" style="border:0px; vertical-align:middle; height:auto; max-width:100%; clear:both; display:block; margin:0px auto"></a></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 应用的核心是商业逻辑，它由定义服务、域对象和事件各模块来完成。各种适配器围绕核心与外部交互。适配器包括数据库访问组件、生成和 consume 信息的消息组件，以及提供 API 或者 UI 访问支持的 web 模块。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 尽管拥有逻辑缜密的模块化设计，整个应用仍然以整体打包和部署，实际格式依赖于应用的语言和框架。譬如，许多 Java 应用被打包为 WAR 文件，部署在 Tomcat 或者 Jetty 这样的应用服务器。有些 Java 应用本身就是包涵 JARs 的软件包。与此类似，Rails 和 Node.js 应用也通过目录层级打包。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 采用此种风格的应用非常普遍。由于 IDE 和其他工具擅长构建单一应用，这类应用也易于部署。这类应用也非常容易测试。你可以非常轻松地进行端到端测试，使用 Seleniu 测试 UI 。整体应用也便于部署，只需将软件包复制到服务器。你也可以通过运行多个包和负载均衡实现扩展。在项目早期这么做非常有效。</p> 
<h3 id="toc_0" style="font-family:Montserrat,sans-serif; line-height:35px; color:rgb(64,64,64); margin:15px 0px 10px; font-size:26px; border:0px; outline:0px; padding:0px; vertical-align:baseline; clear:both; float:left; width:825px"> 踏入单体架构的地狱</h3> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 很不幸，这一简单的方法有着巨大的局限。成功的应用最终会随着时间变得巨大。在每个 sprint 阶段，开发团队都会新加许多行代码。几年后，原本小而简单的应用会变得臃肿。举个极端的例子，我最近与一位开发者交流，他正在开发一款小工具，来分析他们应用（包括几百万行代码）中的几千个 JARs 的依赖。我相信每年都会有大量开发者不遗余力地对付这种麻烦。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 一旦你的应用变得庞大、复杂，你的开发团队将饱受折磨，苦苦挣扎于敏捷开发和交付。一大原因就是应用已经格外复杂，庞大到任何一个开发者都无法完全理解。最后，修复 bug 和实施新功能也就极其困难且耗时颇多。更可怕的是，这是一个向下的螺旋发展。代码库越难理解，正确的修改就越难。最后你会深陷庞大的、无法估量的泥淖之中。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 而这种应用的尺寸也会拖慢开发进度。应用越大，启动时间越长。譬如在最近的调查中，不少开发者指出启动时间长达 12 分钟。我也听说有的应用启动时间居然得 40 分钟。如果开发者不得不频繁重启应用服务器，那大量时间就被浪费，生产效率也饱受其害。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 庞大且复杂的单体应用的另一大问题就是难以进行持续部署。现在， SaaS 应用的发展水平足以在单日内多次将修改推送到生产环境。然而要让复杂的单个应用达到此水平却极为棘手。想更新应用的单个部分，必须重新部署整个应用，漫长的启动时间更是雪上加霜。另外，由于不能完全预见修改的影响，你不得不提前进行大量人工测试。结果就是，持续部署变得不可能。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 如果单体应用的不同模块在资源需求方面有冲突的话，那应用的扩展也很难。比如，模块之一需要执行 CPU-intensive 图像处理逻辑，最好部署到 AWS 的 EC2 Compute Optimized instances；而另一模块需要内存数据库，最好适配 EC2 Memory-optimized instances。由于这两个模块需要共同部署，你不得不在在硬件选择方面做妥协。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 单体应用的另一问题就是可靠性。由于所有模块都运行在同一进程中，任何模块中的一个 bug，比如内存泄漏都可能弄垮整个进程；此外，由于应用中的所有实例都是唯一，这个 bug 将影响整个应用的可用性。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 最后，单体应用会让采用新框架和语言极其困难。举例来说，你有两百万行使用 XYZ 框架的代码，如果要使用 ABC 框架重写代码，无论时间还是成本都将非常高昂，即便新框架更好。这也就成为使用新技术的阻碍。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 总结：这个一开始曾经成功关键业务应用，最终却变成一个臃肿的、无法理解的庞然大物。它使用老旧、陈腐、低效的技术，几乎吸引不到出色的开发者。这个应用非常难于扩展，也不稳定可靠。最终，敏捷开发和交付几乎成为不可能。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 你该何去何从？</p> 
<h3 id="toc_0" style="font-family:Montserrat,sans-serif; line-height:35px; color:inherit; margin:15px 0px 10px; font-size:26px; border:0px; font-style:inherit; outline:0px; padding:0px; vertical-align:baseline; clear:both; font-variant:inherit; float:left; width:825px"> 微服务——直击痛点</h3> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 诸如亚马逊、eBay、Netflix 等公司已经通过采用微服务架构范式解决了上文（第一部分）提到的问题。不同于构建单一、庞大的应用，微服务架构将应用拆分为一套小且互相关联的服务。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 一个微服务一般完成某个特定的功能，比如订单管理、客户管理等。每个微服务都是一个微型应用，有着自己六边形架构，包括商业逻辑和各种接口。有的微服务通过暴露 API 被别的微服务或者应用客户端所用；有的微服务则通过网页 UI 实现。在运行时，每个实例通常是一个云虚拟机或者 Docker 容器。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 对于前文所述的系统，一种可能的系统分解图如下：</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <a target="_blank" href="http://blog.daocloud.io/wp-content/uploads/2016/05/Richardson-microservices-part1-2_microservices-architecture.png" rel="nofollow noopener noreferrer" style="color:purple; text-decoration:none; border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline; background:0px 0px"><img class="  wp-image-3151 aligncenter" src="https://images2.imgbox.com/9c/45/F6jh0ZCr_o.png" alt="Richardson-microservices-part1-2_microservices-architecture" width="715" height="730" style="border:0px; vertical-align:middle; height:auto; max-width:100%; clear:both; display:block; margin:0px auto"></a></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 应用的每个功能区都由其自身微服务实施。此外，整个网页应用被拆分为一套简单的网页应用（比如我们的打车软件拆分为乘客应用和司机应用），从而能够轻松地针对特定用户、设备或者用户案例进行单独部署。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 每个后端服务包括一个 REST API 和由其它服务提供的服务消耗 API。例如，司机管理服务使用“通知”服务器来告知司机即将的行程。UI 服务唤醒其它服务，从而呈现网页。这些服务也可能用到基于信息的异步通信。内部服务通信会在本系列文章中详述。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 有的 REST API 也对司机和乘客的移动应用开放。这些应用并不能直接访问后端服务器，相反，通信由名为 API Gateway 的中间人调解。AIP Gateway 负责负载均衡、缓存、访问控制、API 计费、监控等，通过 NGINX 高效实施。本系列的后续文章将会讲解 API Gateway。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <a target="_blank" href="http://blog.daocloud.io/wp-content/uploads/2016/05/Richardson-microservices-part1-3_scale-cube.png" rel="nofollow noopener noreferrer" style="color:purple; text-decoration:none; border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline; background:0px 0px"><img class=" size-full wp-image-3152 aligncenter" src="https://images2.imgbox.com/2e/fc/CrDQqYdd_o.png" alt="Richardson-microservices-part1-3_scale-cube" width="713" height="534" style="border:0px; vertical-align:middle; height:auto; max-width:100%; clear:both; display:block; margin:0px auto"></a></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 上图是 Scale Cube 的 3D 模型，来自《The Art of Scalability》 一书。微服务架构范式对应 Y 轴，X 轴由负载均衡器后端运行的多个应用副本组成，Z 轴（数据分割）将需求路由到相关服务。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 应用通常同时使用这三种不同类型的扩展。Y 轴扩展将应用分解为如图一（https://www.nginx.com/wp-content/uploads/2015/05/Graph-031-e1431992337817.png）所示的微服务。在运行时维度，X 轴扩展在输出和可用性的负载均衡后运行多个实例。部分应用会使用 Z 轴扩展来对服务进行数据分割。下图展示了行程管理服务（Trip Management）是如何使用 Docker 部署到 AWS EC2 上的。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <a target="_blank" href="http://blog.daocloud.io/wp-content/uploads/2016/05/Richardson-microservices-part1-4_dockerized-application.png" rel="nofollow noopener noreferrer" style="color:purple; text-decoration:none; border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline; background:0px 0px"><img class="  wp-image-3153 aligncenter" src="https://images2.imgbox.com/e2/79/f7Cg0wco_o.png" alt="Richardson-microservices-part1-4_dockerized-application" width="722" height="722" style="border:0px; vertical-align:middle; height:auto; max-width:100%; clear:both; display:block; margin:0px auto"></a></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 在运行时，行程管理服务包括多个服务实例，每个服务实例都是一个 Docker 容器。为了实现高可用性，这些容器运行在多个云虚拟机上。在应用实例前面是 NGINX 这样的负载均衡，将请求分发给全部实例。负载均衡也可以处理缓存、访问控制、 API 测量和监控等。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 微服务架构范式对应用和数据库的关系影响巨大。每个服务都有自身的数据库计划，而不与其它服务共享同一个数据库。一方面，这个方法类似企业级数据模型。同时，它也导致部分数据的重复。然而，要想从微服务中获益，为每个服务提供单个的数据库计划就非常必要，这能保证松散耦合。下面的图表展示了示例应用的数据库架构。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <a target="_blank" href="http://blog.daocloud.io/wp-content/uploads/2016/05/intro-microservices.png" rel="nofollow noopener noreferrer" style="color:purple; text-decoration:none; border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline; background:0px 0px"><img class="  wp-image-3154 aligncenter" src="https://images2.imgbox.com/f4/f0/1vfsLMMY_o.png" alt="intro-microservices" width="685" height="476" style="border:0px; vertical-align:middle; height:auto; max-width:100%; clear:both; display:block; margin:0px auto"></a></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 每个服务都有其自己的数据库。此外，单个服务可以使用符合自己需要的特定类型的数据库，即多语言一致性架构。例如，为了发现附近乘客，驾驶员管理服务必须使用高效支持地理位置请求的数据库。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 表面上看，微服务架构范式与 SOA 非常类似，这两种架构都包括一套服务。然而，微服务架构范式被看作不包含某些功能的 SOA 。这些功能包括网络服务说明（ WS-* ）和 Enterprise Service Bus (ESB) 的商品化和请求包。基于微服务的应用更青睐 REST 这样简单的、轻量级的协议，而不是 WS-* 。他们也极力避免在微服务中使用 ESBs 及类似功能。微服务架构范式也拒绝 SOA 的其它部分，比如 canonical schema 的概念。</p> 
<h3 id="toc_0" style="font-family:Montserrat,sans-serif; line-height:35px; color:inherit; margin:15px 0px 10px; font-size:26px; border:0px; font-style:inherit; outline:0px; padding:0px; vertical-align:baseline; clear:both; font-variant:inherit; float:left; width:825px"> 微服务架构的好处</h3> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 微服务架构模式有很多好处<span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">。首先，</span>通过分解巨大单体应用为多个服务方法解决了复杂性问题。在功能不变的情况下，应用被分解为多个可管理的分支或服务。每个服务都有一个用 RPC- 或者消息驱动 API 定义清楚的边界。微服务架构模式给采用单体式编码方式很难实现的功能提供了模块化的解决方案，由此，单个服务很容易开发、理解和维护。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">第二，</span>这种架构使得每个服务都可以有专门开发团队来开发。开发者可以自由选择开发技术，提供 API 服务。当然，许多公司试图避免混乱，只提供某些技术选择。然后，这种自由意味着开发者不需要被迫使用某项目开始时采用的过时技术，他们可以选择现在的技术。甚至于，因为服务都是相对简单，即使用现在技术重写以前代码也不是很困难的事情。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">第三，</span>微服务架构模式使得每个微服务独立部署，开发者不再需要协调其它服务部署对本服务的影响。这种改变可以加快部署速度，譬如 UI 团队可以采用 AB 测试并快速部署变化。微服务架构模式使得持续化部署成为可能。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">最后，</span>微服务架构模式使得每个服务独立扩展。你可以根据每个服务的规模来部署满足需求的实利。甚至于，你可以使用更适合于服务资源需求的硬件。比如，你可以在 EC2 Compute Optimized instances 上部署 CPU 敏感的服务，而在 EC2 memory-optimized instances 上部署内存数据库。</p> 
<h3 id="toc_0" style="font-family:Montserrat,sans-serif; line-height:35px; color:inherit; margin:15px 0px 10px; font-size:26px; border:0px; font-style:inherit; outline:0px; padding:0px; vertical-align:baseline; clear:both; font-variant:inherit; float:left; width:825px"> 微服务架构的不足</h3> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> Fred Brooks 在 30 年前写道 “there are no silver bullets”，像任何其它科技一样，微服务架构也有不足。其中一个跟他的名字类似，“微服务”强调了服务大小，实际上，有一些开发者鼓吹建立稍微大一些的，10-100 LOC服务组。尽管小服务更乐于被采用，但是不要忘了微服务只是结果，而不是最终目的。微服务的目的是有效的拆分应用，实现敏捷开发和部署。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 另外一个不足之处在于，微服务应用是分布式系统，由此会带来固有的复杂性。开发者需要在 RPC 或者消息传递之间选择并完成进程间通讯机制。此外，他们必须写代码来处理消息传递中速度过慢或者不可用等局部失效问题。当然这并不是什么难事，但相对于单体式应用中通过语言层级的方法或者进程调用，微服务下这种技术显得更复杂一些。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 另外一个关于微服务的挑战来自于分区的数据库架构。同时更新多个业务主体的事务很普遍。这种事务对于单体式应用来说很容易，因为只有一个数据库。在微服务架构应用中，需要更新不同服务所使用的不同的数据库。使用分布式事务并不一定是好的选择，不仅仅是因为 CAP 理论，还因为当前高扩展性的 NoSQL 数据库和消息传递中间件并不支持这一需求。最终你不得不使用一个最终一致性的方法，从而对开发者提出了更高的要求和挑战。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 测试一个基于微服务架构的应用也是很复杂的任务。比如，对于采用流行的 Spring Boot 架构的单体式 web 应用，测试它的 REST API，是很容易的事情。反过来，同样的服务测试需要启动与它有关的所有服务（至少需要这些服务的 stubs）。再重申一次，不能低估了采用微服务架构带来的复杂性。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 另外一个挑战在于，微服务架构模式应用的改变将会波及多个服务。比如，假设你在完成一个案例，需要修改服务A、B、C，而 A 依赖 B，B 依赖 C。在单体应用中，你只需要改变相关模块，整合变化，部署就好了。对比之下，微服务架构模式就需要考虑相关改变对不同服务的影响。比如，你需要更新服务 C，然后是 B，最后才是 A。幸运的是，许多改变一般只影响一个服务，而需要协调多服务的改变很少。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 部署一个微服务应用也很复杂，一个单体应用只需要在复杂均衡器后面部署各自的服务器就好了。每个应用实例是需要配置诸如数据库和消息中间件等基础服务。相比之下，一个微服务应用一般由大批服务构成。根据 Adrian Cockcroft 的分享，Hailo 由 160 个不同服务构成，而 NetFlix 则超过 600 个服务。每个服务都有多个实例，这就形成大量需要配置、部署、扩展和监控的部分。除此之外，你还需要完成一个服务发现机制（后续文章中发表），以用来发现与它通讯服务的地址（包括服务器地址和端口）。传统的解决问题办法并不能解决这么复杂的问题。最终，成功部署一个微服务应用需要开发者有足够的控制部署方法，并高度自动化。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 自动化的方法之一是使用譬如 Cloud Foundry 这样的 PaaS 服务。PaaS 能让开发者轻松部署和管理微服务，让他们无需为获取并配置 IT 资源劳神。同时，配置 PaaS 的系统和网络专家可以采用最佳实践和策略来简化这些问题。另外一个自动部署微服务应用的方法是开发自己的基础 PaaS 系统。通常的起步方式是 Mesos 或 Kubernetes 这样的集群管理方案，配合 Docker 使用。作为一种基于软件的应用交付方法，NGINX 能够方便地在微服务层面提供缓冲、权限控制、API 统计、以及监控。我们会在后续的文章中分析它如何解决这些问题。</p> 
<h3 id="toc_0" style="font-family:Montserrat,sans-serif; line-height:35px; color:inherit; margin:15px 0px 10px; font-size:26px; border:0px; font-style:inherit; outline:0px; padding:0px; vertical-align:baseline; clear:both; font-variant:inherit; float:left; width:825px"> 总结</h3> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 构建复杂的应用的确非常困难。单体式的架构更适合轻量级的简单应用。如果你用它来开发复杂应用，那真的会很糟糕。微服务架构模式可以用来构建复杂应用，当然，这种架构模型也有自己的缺点和挑战。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 在后续的博客中，我会深入探索微服务架构模式，并讨论多个话题，包括服务发现、服务部署选择、以及将单体应用拆分为多个服务的策略。</p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> <span style="border:0px; font-style:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline">下期题目：构建微服务架构：使用 API Gateway ，敬请期待！</span></p> 
<p style="margin-top:0px; margin-bottom:24px; border:0px; font-family:'Microsoft Yahei',Arial,Helvetica,sans-serif; font-size:16px; outline:0px; padding-top:0px; padding-bottom:0px; vertical-align:baseline; color:rgb(64,64,64); line-height:20px"> 阅读英文原文：<a target="_blank" href="https://www.nginx.com/blog/introduction-to-microservices/#rd?sukey=fa67fe3435f5c4beec6f6cb43b96b08f1bd5e81949c8ff8b1378a0b2b94608dce9afd0ef72370c53e80e111d7ff9595f" rel="nofollow noopener noreferrer" style="color:purple; text-decoration:none; border:0px; font-style:inherit; font-weight:inherit; margin:0px; outline:0px; padding:0px; vertical-align:baseline; background:0px 0px">https://www.nginx.com/blog/introduction-to-microservices/#rd?sukey=fa67fe3435f5c4beec6f6cb43b96b08f1bd5e81949c8ff8b1378a0b2b94608dce9afd0ef72370c53e80e111d7ff9595f</a></p> 
<br>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/baa75fd89e306ab1c04f2d9af3f8c1a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL Server 如何实现&#34;选择所有行&#34;和&#34;编辑所有行&#34;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5042fbc60098cc94d59a2618766b03c2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java单例设计模式的几种写法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>