<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zabbix 批量添加主机 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zabbix 批量添加主机" />
<meta property="og:description" content="zabbix 批量添加主机 1.1::通过本教程起到抛砖引玉效果，希望各位朋友受益良多。
1.2::如您有任何问题请联系作者，QQ1284524409。
1.3::以下提供的任何软件仅供学习交流使用。
1.4::**项目地址**
jihulib项目地址
#!/usr/bin/python
# coding:utf-8
import json
import urllib2
from urllib2 import URLError
import sys, argparse
import xlrd
defaultencoding = &#39;utf-8&#39;
if sys.getdefaultencoding() != defaultencoding:
reload(sys)
sys.setdefaultencoding(defaultencoding)
class zabbix_api:
def __init__(self):
self.url = &#39;http://127.0.0.1/zabbix/api_jsonrpc.php&#39; # 修改URL
self.header = {&#34;Content-Type&#34;:&#34;application/json&#34;}
self.user_login()
def user_login(self):
data = json.dumps({
&#34;jsonrpc&#34;: &#34;2.0&#34;,
&#34;method&#34;: &#34;user.login&#34;,
&#34;params&#34;: {
&#34;user&#34;: &#34;Admin&#34;, # web页面登录用户名
&#34;password&#34;: &#34;zabbix&#34; # web页面登录密码
},
&#34;id&#34;: 0
})
request = urllib2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0549b16e2d1cd4a8175cbf6911a034e2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-27T16:47:05+08:00" />
<meta property="article:modified_time" content="2023-12-27T16:47:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zabbix 批量添加主机</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>zabbix 批量添加主机</h2> 
<p>1.1::通过本教程起到抛砖引玉效果，希望各位朋友受益良多。</p> 
<p>1.2::如您有任何问题请联系作者，QQ1284524409。</p> 
<p>1.3::以下提供的任何软件仅供学习交流使用。</p> 
<p>1.4::**项目地址**</p> 
<p><a class="link-info" href="https://jihulab.com/NoYoWiFi/zabbix/-/tree/zabbix_api" rel="nofollow" title="jihulib项目地址">jihulib项目地址</a></p> 
<hr> 
<p></p> 
<p>#!/usr/bin/python<br> # coding:utf-8<br>   <br> import json<br> import urllib2<br> from urllib2 import URLError<br> import sys, argparse<br> import xlrd</p> 
<p>defaultencoding = 'utf-8'<br> if sys.getdefaultencoding() != defaultencoding:<br>     reload(sys)<br>     sys.setdefaultencoding(defaultencoding)<br>   <br> class zabbix_api:<br>     def __init__(self):<br>         self.url = 'http://127.0.0.1/zabbix/api_jsonrpc.php'  # 修改URL<br>         self.header = {"Content-Type":"application/json"}<br>         self.user_login()</p> 
<p>    def user_login(self):<br>         data = json.dumps({<!-- --><br>                            "jsonrpc": "2.0",<br>                            "method": "user.login",<br>                            "params": {<!-- --><br>                                       "user": "Admin",  # web页面登录用户名<br>                                       "password": "zabbix"  # web页面登录密码<br>                                       },<br>                            "id": 0<br>                            })<br>         request = urllib2.Request(self.url, data, self.header)<br>         try:<br>             result = urllib2.urlopen(request, timeout = 2)<br>         except URLError as e:<br>             print u"\033[041m地址请求失败请检查!\033[0m \n\033[041m%s!\033[0m" % e<br>             sys.exit(1)<br>         else:<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 self.authID = response['result']<br>             elif response.get('error','') != '':<br>                 print u"\033[041m用户认证失败请检查!\033[0m \n\033[041m%s\033[0m" % (response['error']['data'])<br>                 sys.exit(1)<br>     #![01_创建模板]<br>     def template_get(self, templateName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"template.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "filter": {<!-- --><br>                                                 "host": templateName<br>                                             }<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)     <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['templateid']<br>         else:<br>             return response['result']<br>                     <br>     def template_create(self, templateName):<br>         default_id = {}<br>         default_id['groupid'] = self.hostGroup_get('000_LocalTemplates')<br>         if default_id['groupid'] == []:<br>             self.hostGroup_create('000_LocalTemplates')<br>             default_id['groupid'] = self.hostGroup_get('000_LocalTemplates')<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in range(len(name_list_1)):<br>             name_2 = {}<br>             id_2 = {}<br>             name_2['name'] = name_list_1[n_2]['name']<br>             id_2['templateid'] = self.template_get(name_list_1[n_2]['name'])<br>             if id_2['templateid'] != []:<br>                 print u"创建模板 : \033[041m%s\033[0m 失败!,模板重复创建" % name_list_1[n_2]['name']<br>                 continue<br>             name_list_2.append(name_2)<br>         for n_3 in range(len(name_list_2)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "template.create",<br>                                 "params": {<!-- --><br>                                             "host": name_list_2[n_3]['name'],<br>                                             "groups": {<!-- --><br>                                                         "groupid": default_id['groupid']<br>                                                     },<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"创建模板 : \033[042m%s\033[0m 成功!,模板ID为 : \033[042m%s\033[0m" % (name_list_2[n_3]['name'], ",".join(response['result']['templateids']))<br>             elif response.get('error','') != '':<br>                 print u"创建模板 : \033[041m%s\033[0m 失败!\n\033[041m%s\033[0m" % (name_list_2[n_3]['name'], response['error']['data'])</p> 
<p>    def template_delete(self, templateName):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         id_list_2 = []<br>         for n_2 in range(len(name_list_1)):<br>             name_2 = {}<br>             id_2 = {}<br>             name_2['name'] = name_list_1[n_2]['name']<br>             id_2['templateids'] = self.template_get(name_list_1[n_2]['name'])<br>             if id_2['templateids'] == []:<br>                 print u"删除模板 : \033[041m%s\033[0m 失败!,模板不存在!" % name_list_1[n_2]['name']<br>                 continue<br>             name_list_2.append(name_2)<br>             id_list_2.append(id_2)<br>         for n_3 in range(len(name_list_2)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "template.delete",<br>                                 "params": [<br>                                             id_list_2[n_3]['templateids']<br>                                         ],<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"删除模板 : \033[042m%s\033[0m 成功!,模板ID为 : \033[042m%s\033[0m" % (name_list_2[n_3]['name'], ",".join(response['result']['templateids']))<br>             elif response.get('error','') != '':<br>                 print u"删除模板 : \033[041m%s\033[0m 失败!\n\033[041m%s\033[0m" % (name_list_2[n_3]['name'], response['error']['data'])<br>     #![02_为模板创建应用集]<br>     def application_get(self, templateName, applicationName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"application.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "hostids": self.template_get(templateName),<br>                                     "filter":{<!-- --><br>                                             "name": applicationName<br>                                         },<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)     <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['applicationid']<br>         else:<br>             return response['result']</p> 
<p>    def application_create(self, templateName, applicationName):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in applicationName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为模板删除应用集失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['templateid'] = self.template_get(name_list_1[n_3]['name'])<br>             if id_3['templateid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 创建应用集失败!,\033[041m模板不存在\033[0m" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4_1 = []<br>         id_list_4_2 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4_1 = {}<br>             id_4_2 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4_1['templateid'] = id_list_3[n_4]['templateid']<br>             id_4_2['applicationid'] = self.application_get(name_list_3_1[n_4]['name'], name_list_3_2[n_4]['name'])<br>             if id_4_2['applicationid'] != []:<br>                 print u"为模板 : \033[041m%s\033[0m 创建应用集 : \033[041m%s\033[0m 失败!,\033[041m应用集已存在!\033[0m" % \<br>                 (name_list_3_1[n_4]['name'], name_list_3_2[n_4]['name'])<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4_1.append(id_4_1)<br>             id_list_4_2.append(id_4_2)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "application.create",<br>                                 "params": {<!-- --><br>                                             "name": name_list_4_2[n_5]['name'],<br>                                             "hostid": id_list_4_1[n_5]['templateid'],<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为模板 : \033[042m%s\033[0m 创建应用集 : \033[042m%s\033[0m 成功!,并且应用集ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['applicationids']))<br>             elif response.get('error','') != '':<br>                 print u"为模板 : \033[041m%s\033[0m 创建应用集 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], response['error']['data'])</p> 
<p>    def application_delete(self, templateName, applicationName):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in applicationName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为模板删除应用集失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['templateid'] = self.template_get(name_list_1[n_3]['name'])<br>             if id_3['templateid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 删除应用集失败!,模板不存在" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4['applicationid'] = self.application_get(name_list_3_1[n_4]['name'], name_list_3_2[n_4]['name'])<br>             if id_4['applicationid'] == []:<br>                 print u"为模板删除应用集失败!,\033[041m应用集不存在\033[0m !"<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4.append(id_4)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "application.delete",<br>                                 "params": [<br>                                             id_list_4[n_5]['applicationid']<br>                                         ],<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为模板 : \033[042m%s\033[0m 删除应用集 : \033[042m%s\033[0m 成功!,并且应用集ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['applicationids']))<br>             elif response.get('error','') != '':<br>                 print u"为模板 : \033[041m%s\033[0m 删除应用集 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], response['error']['data'])<br>     #![03_为模板创建监控项]<br>     def item_get(self, templateName, itemName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"item.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "hostids": self.template_get(templateName),<br>                                     "filter":{<!-- --><br>                                             "name": itemName<br>                                         },<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)     <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['itemid']<br>         else:<br>             return response['result']<br>               <br>     def item_create(self, templateName, itemApplication, itemName, itemKey, itemValueType, itemDely):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in itemApplication.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         name_list_3 = []<br>         for n_3 in itemName.split('//'):<br>             name_3 = {}<br>             name_3['name'] = n_3<br>             name_list_3.append(name_3)<br>         name_list_4 = []<br>         for n_4 in itemKey.split('//'):<br>             name_4 = {}<br>             name_4['name'] = n_4<br>             name_list_4.append(name_4)<br>         name_list_5 = []<br>         for n_5 in itemValueType.split('//'):<br>             name_5 = {}<br>             name_5['name'] = n_5<br>             name_list_5.append(name_5)<br>         name_list_6 = []<br>         for n_6 in itemDely.split('//'):<br>             name_6 = {}<br>             name_6['name'] = n_6<br>             name_list_6.append(name_6)  <br>         if len(name_list_1) != len(name_list_2) or \<br>         len(name_list_1) != len(name_list_3) or \<br>         len(name_list_1) != len(name_list_4) or \<br>         len(name_list_1) != len(name_list_5) or \<br>         len(name_list_1) != len(name_list_6):<br>             print u"为模板创建监控项失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_7_1 = []<br>         name_list_7_2 = []<br>         name_list_7_3 = []<br>         name_list_7_4 = []<br>         name_list_7_5 = []<br>         name_list_7_6 = []<br>         id_list_7 = []<br>         for n_7 in range(len(name_list_1)):<br>             name_7_1 = {}<br>             name_7_2 = {}<br>             name_7_3 = {}<br>             name_7_4 = {}<br>             name_7_5 = {}<br>             name_7_6 = {}<br>             id_7 = {}<br>             name_7_1['name'] = name_list_1[n_7]['name']<br>             name_7_2['name'] = name_list_2[n_7]['name']<br>             name_7_3['name'] = name_list_3[n_7]['name']<br>             name_7_4['name'] = name_list_4[n_7]['name']<br>             name_7_5['name'] = name_list_5[n_7]['name']<br>             name_7_6['name'] = name_list_6[n_7]['name']<br>             id_7['templateid'] = self.template_get(name_list_1[n_7]['name'])<br>             if id_7['templateid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 创建监控项失败!,模板不存在" % name_list_1[n_7]['name']<br>                 continue<br>             name_list_7_1.append(name_7_1)<br>             name_list_7_2.append(name_7_2)<br>             name_list_7_3.append(name_7_3)<br>             name_list_7_4.append(name_7_4)<br>             name_list_7_5.append(name_7_5)<br>             name_list_7_6.append(name_7_6)<br>             id_list_7.append(id_7)<br>         name_list_8_1 = []<br>         name_list_8_2 = []<br>         name_list_8_3 = []<br>         name_list_8_4 = []<br>         name_list_8_5 = []<br>         name_list_8_6 = []<br>         id_list_8_1 = []<br>         id_list_8_2 = []<br>         for n_8 in range(len(name_list_1)):<br>             name_8_1 = {}<br>             name_8_2 = {}<br>             name_8_3 = {}<br>             name_8_4 = {}<br>             name_8_5 = {}<br>             name_8_6 = {}<br>             id_8_1 = {}<br>             id_8_2 = {}<br>             name_8_1['name'] = name_list_7_1[n_8]['name']<br>             name_8_2['name'] = name_list_7_2[n_8]['name']<br>             name_8_3['name'] = name_list_7_3[n_8]['name']<br>             name_8_4['name'] = name_list_7_4[n_8]['name']<br>             name_8_5['name'] = name_list_7_5[n_8]['name']<br>             name_8_6['name'] = name_list_7_6[n_8]['name']<br>             id_8_1['templateid'] = id_list_7[n_8]['templateid']<br>             id_8_2['applicationid'] = self.application_get(name_list_7_1[n_8]['name'], name_list_7_2[n_8]['name'])<br>             if id_8_2['applicationid'] == []:<br>                 print u"为监控项 : \033[041m%s\033[0m 附加应用集 : \033[041m%s\033[0m 失败!,应用集不存在" % \<br>                 (name_list_7_3[n_8]['name'], name_list_7_2[n_8]['name'])<br>                 continue<br>             name_list_8_1.append(name_8_1)<br>             name_list_8_2.append(name_8_2)<br>             name_list_8_3.append(name_8_3)<br>             name_list_8_4.append(name_8_4)<br>             name_list_8_5.append(name_8_5)<br>             name_list_8_6.append(name_8_6)<br>             id_list_8_1.append(id_8_1)<br>             id_list_8_2.append(id_8_2)<br>         name_list_9_1 = []<br>         name_list_9_2 = []<br>         name_list_9_3 = []<br>         name_list_9_4 = []<br>         name_list_9_5 = []<br>         name_list_9_6 = []<br>         id_list_9_1 = []<br>         id_list_9_2 = []<br>         for n_9 in range(len(name_list_1)):<br>             name_9_1 = {}<br>             name_9_2 = {}<br>             name_9_3 = {}<br>             name_9_4 = {}<br>             name_9_5 = {}<br>             name_9_6 = {}<br>             id_9_1 = {}<br>             id_9_2 = {}<br>             id_9_3 = {}<br>             name_9_1['name'] = name_list_8_1[n_9]['name']<br>             name_9_2['name'] = name_list_8_2[n_9]['name']<br>             name_9_3['name'] = name_list_8_3[n_9]['name']<br>             name_9_4['name'] = name_list_8_4[n_9]['name']<br>             name_9_5['name'] = name_list_8_5[n_9]['name']<br>             name_9_6['name'] = name_list_8_6[n_9]['name']<br>             id_9_1['templateid'] = id_list_8_1[n_9]['templateid']<br>             id_9_2['applicationid'] = id_list_8_2[n_9]['applicationid']<br>             id_9_3['itemid'] = self.item_get(name_list_8_1[n_9]['name'], name_list_8_3[n_9]['name'])<br>             if id_9_3['itemid'] != []:<br>                 print u"为模板 : \033[041m%s\033[0m 创建监控项失败!,监控项 : \033[041m%s\033[0m 已存在,并且监控项ID为 : \033[041m%s\033[0m" % \<br>                     (name_list_8_1[n_9]['name'], name_list_8_3[n_9]['name'], id_9_3['itemid'])<br>                 continue<br>             name_list_9_1.append(name_9_1)<br>             name_list_9_2.append(name_9_2)<br>             name_list_9_3.append(name_9_3)<br>             name_list_9_4.append(name_9_4)<br>             name_list_9_5.append(name_9_5)<br>             name_list_9_6.append(name_9_6)<br>             id_list_9_1.append(id_9_1)<br>             id_list_9_2.append(id_9_2)<br>         for n_10 in range(len(name_list_9_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "item.create",<br>                                 "params": {<!-- --><br>                                             "hostid": id_list_9_1[n_10]['templateid'],<br>                                             "applications": [id_list_9_2[n_10]['applicationid']],<br>                                             "name": name_list_9_3[n_10]['name'],<br>                                             "type": 7,<br>                                             "key_": name_list_9_4[n_10]['name'],<br>                                             "value_type": name_list_9_5[n_10]['name'],<br>                                             "delay": name_list_9_6[n_10]['name']<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为模板 : \033[042m%s\033[0m 创建监控项 : \033[042m%s\033[0m 成功!,并且监控项ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_9_1[n_10]['name'], name_list_9_3[n_10]['name'], ",".join(response['result']['itemids']))<br>             elif response.get('error','') != '':<br>                 print u"为模板 : \033[041m%s\033[0m 创建监控项 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_9_1[n_10]['name'], name_list_9_3[n_10]['name'], response['error']['data'])</p> 
<p>    def item_delete(self, templateName, itemName):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in itemName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为模板删除应用集失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['templateid'] = self.template_get(name_list_1[n_3]['name'])<br>             if id_3['templateid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 删除监控项失败!,模板不存在" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4['itemid'] = self.item_get(name_list_3_1[n_4]['name'], name_list_3_2[n_4]['name'])<br>             if id_4['itemid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 删除监控项 : \033[041m%s\033[0m 失败!,\033[041m监控项不存在\033[0m !" %\<br>                 (name_list_4_1[n_4]('name'), name_list_4_2[n_4]('name'))<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4.append(id_4)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "item.delete",<br>                                 "params": [<br>                                             id_list_4[n_5]['itemid']<br>                                         ],<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为模板 : \033[042m%s\033[0m 删除监控项 : \033[042m%s\033[0m 成功!,并且应监控项ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['itemids']))<br>             elif response.get('error','') != '':<br>                 print u"为模板 : \033[041m%s\033[0m 删除监控项 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], response['error']['data'])<br>     #![04_为模板创建触发器]<br>     def trigger_get(self, templateName, descriptionName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"trigger.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "templateids": self.template_get(templateName),<br>                                     "filter":{<!-- --><br>                                             "description": descriptionName<br>                                         },<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)     <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['triggerid']<br>         else:<br>             return response['result']</p> 
<p>    def trigger_create(self, templateName, itemName, descriptionName, expressionName):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in itemName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         name_list_3 = []<br>         for n_3 in descriptionName.split('//'):<br>             name_3 = {}<br>             name_3['name'] = n_3<br>             name_list_3.append(name_3)<br>         name_list_4 = []<br>         for n_4 in expressionName.split('//'):<br>             name_4 = {}<br>             name_4['name'] = n_4<br>             name_list_4.append(name_4)<br>         if len(name_list_1) != len(name_list_2) or \<br>         len(name_list_1) != len(name_list_3) or \<br>         len(name_list_1) != len(name_list_4):<br>             print u"为模板创建触发器失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_5_1 = []<br>         name_list_5_2 = []<br>         name_list_5_3 = []<br>         name_list_5_4 = []<br>         for n_5 in range(len(name_list_1)):<br>             name_5_1 = {}<br>             name_5_2 = {}<br>             name_5_3 = {}<br>             name_5_4 = {}<br>             id_5 = {}<br>             name_5_1['name'] = name_list_1[n_5]['name']<br>             name_5_2['name'] = name_list_2[n_5]['name']<br>             name_5_3['name'] = name_list_3[n_5]['name']<br>             name_5_4['name'] = name_list_4[n_5]['name']<br>             id_5['templateid'] = self.template_get(name_list_1[n_5]['name'])<br>             if id_5['templateid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 的监控项创建触发器失败!,模板不存在"  % name_list_1[n_5]['name']<br>                 continue<br>             name_list_5_1.append(name_5_1)<br>             name_list_5_2.append(name_5_2)<br>             name_list_5_3.append(name_5_3)<br>             name_list_5_3.append(name_5_3)<br>             name_list_5_4.append(name_5_4)<br>         name_list_6_1 = []<br>         name_list_6_2 = []<br>         name_list_6_3 = []<br>         name_list_6_4 = []<br>         for n_6 in range(len(name_list_5_1)):<br>             name_6_1 = {}<br>             name_6_2 = {}<br>             name_6_3 = {}<br>             name_6_4 = {}<br>             id_6 = {}<br>             name_6_1['name'] = name_list_5_1[n_6]['name']<br>             name_6_2['name'] = name_list_5_2[n_6]['name']<br>             name_6_3['name'] = name_list_5_3[n_6]['name']<br>             name_6_4['name'] = name_list_5_4[n_6]['name']<br>             id_6['itemid'] = self.item_get(name_list_5_1[n_6]['name'], name_list_5_2[n_6]['name'])<br>             if id_6['itemid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 的监控项 : \033[041m%s\033[0m 创建触发器失败!,监控项不存在" % \<br>                 (name_list_5_1[n_6]['name'], name_list_5_2[n_6]['name'])<br>                 continue<br>             name_list_6_1.append(name_6_1)<br>             name_list_6_2.append(name_6_2)<br>             name_list_6_3.append(name_6_3)<br>             name_list_6_4.append(name_6_4)<br>         name_list_7_1 = []<br>         name_list_7_2 = []<br>         name_list_7_3 = []<br>         name_list_7_4 = []<br>         for n_7 in range(len(name_list_5_1)):<br>             name_7_1 = {}<br>             name_7_2 = {}<br>             name_7_3 = {}<br>             name_7_4 = {}<br>             id_7 = {}<br>             name_7_1['name'] = name_list_5_1[n_7]['name']<br>             name_7_2['name'] = name_list_5_2[n_7]['name']<br>             name_7_3['name'] = name_list_5_3[n_7]['name']<br>             name_7_4['name'] = name_list_5_4[n_7]['name']<br>             id_7['description'] = self.trigger_get(name_list_5_1[n_7]['name'], name_list_5_3[n_7]['name'])<br>             if id_7['description'] != []:<br>                 print u"为模板 : \033[041m%s\033[0m 的监控项 : \033[041m%s\033[0m 创建触发器失败!,触发器 : \033[041m%s\033[0m 已存在,并且触发器ID为 : \033[041m%s\033[0m" % \<br>                 (name_list_5_1[n_7]['name'], name_list_5_2[n_7]['name'], name_list_5_3[n_7]['name'], id_7['description'])<br>                 continue<br>             name_list_7_1.append(name_7_1)<br>             name_list_7_2.append(name_7_2)<br>             name_list_7_3.append(name_7_3)<br>             name_list_7_4.append(name_7_4)<br>         for n_8 in range(len(name_list_7_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "trigger.create",<br>                                 "params": {<!-- --><br>                                             "description": name_list_7_3[n_8]['name'],<br>                                             "expression": name_list_7_4[n_8]['name'],<br>                                             "priority": 5,<br>                                             "manual_close": 1<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为模板 : \033[042m%s\033[0m 的监控项 : \033[042m%s\033[0m 创建触发器 : \033[042m%s\033[0m 成功!,并且触发器ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_7_1[n_8]['name'], name_list_7_2[n_8]['name'], name_list_7_3[n_8]['name'], ",".join(response['result']['triggerids']))<br>             elif response.get('error','') != '':<br>                 print u"为模板 : \033[041m%s\033[0m 的监控项 : \033[041m%s\033[0m 创建触发器 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_7_1[n_8]['name'], name_list_7_2[n_8]['name'], name_list_7_3[n_8]['name'], response['error']['data'])<br>                 <br>     def trigger_delete(self, templateName, descriptionName):<br>         name_list_1 = []<br>         for n_1 in templateName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in descriptionName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为模板删除应用集失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['triggerid'] = self.trigger_get(name_list_1[n_3]['name'], name_list_2[n_3]['name'])<br>             if id_3['triggerid'] == []:<br>                 print u"为模板 : \033[041m%s\033[0m 删除触发器 : \033[041m%s\033[0m 失败!,\033[041m触发器不存在\033[0m !" % \<br>                 (name_list_1[n_3]['name'], name_list_2[n_3]['name'])<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         for n_4 in range(len(name_list_3_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc":"2.0",<br>                                 "method":"trigger.delete",<br>                                 "params":[<br>                                             id_list_3[n_4]['triggerid']<br>                                         ],<br>                                 "auth":self.authID,<br>                                 "id":1,<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)     <br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为模板 : \033[042m%s\033[0m 删除触发器 : \033[042m%s\033[0m 成功!,并且触发器ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_3_1[n_4]['name'], name_list_3_2[n_4]['name'], ",".join(response['result']['triggerids']))<br>             elif response.get('error','') != '':<br>                 print u"为模板 : \033[041m%s\033[0m 删除触发器 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_3_1[n_4]['name'], name_list_3_2[n_4]['name'], response['error']['data'])<br>     #![05_创建主机]<br>     def host_get(self, hostName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"host.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "filter": {<!-- --><br>                                                 "host": hostName<br>                                             },<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)     <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['hostid']<br>         else:<br>             return response['result']</p> 
<p>    def host_create(self, hostName):<br>         default_id = {}<br>         default_id['groupid'] = self.hostGroup_get('000_LocalHost')<br>         if default_id['groupid'] == []:<br>             self.hostGroup_create('000_LocalHost')<br>             default_id['groupid'] = self.hostGroup_get('000_LocalHost')<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in range(len(name_list_1)):<br>             name_2 = {}<br>             id_2 = {}<br>             name_2['name'] = name_list_1[n_2]['name']<br>             id_2['hostid'] = self.host_get(name_list_1[n_2]['name'])<br>             if id_2['hostid'] != []:<br>                 print u"创建主机 : \033[041m%s\033[0m 失败!,主机重复创建" % name_list_1[n_2]['name']<br>                 continue<br>             name_list_2.append(name_2)<br>         for n_3 in range(len(name_list_2)):<br>             data = json.dumps({<!-- --><br>                                "jsonrpc":"2.0",<br>                                "method":"host.create",<br>                                "params":{<!-- --><br>                                          "host": name_list_2[n_3]['name'],<br>                                          "interfaces": [<br>                                                             {<!-- --><br>                                                                 "type": 1,<br>                                                                 "main": 1,<br>                                                                 "useip": 1,<br>                                                                 "ip": "127.0.0.1",<br>                                                                 "dns": "",<br>                                                                 "port": "10050"<br>                                                             }<br>                                                         ],<br>                                         "groups": [<br>                                                         {<!-- --><br>                                                             "groupid": default_id['groupid']<br>                                                         }<br>                                                    ],<br>                                          },<br>                                "auth": self.authID,<br>                                "id":1                  <br>             })<br>             request = urllib2.Request(self.url, data, self.header)  <br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"创建主机 : \033[042m%s\033[0m 成功!,主机ID为 : \033[042m%s\033[0m" % (name_list_2[n_3]['name'], ",".join(response['result']['hostids']))<br>             elif response.get('error','') != '':<br>                 print u"创建主机 : \033[041m%s\033[0m 失败!\n\033[041m%s\033[0m" % (name_list_2[n_3]['name'], response['error']['data'])</p> 
<p>    def host_delete(self, hostName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         id_list_2 = []<br>         for n_2 in range(len(name_list_1)):<br>             name_2 = {}<br>             id_2 = {}<br>             name_2['name'] = name_list_1[n_2]['name']<br>             id_2['hostid'] = self.host_get(name_list_1[n_2]['name'])<br>             if id_2['hostid'] == []:<br>                 print u"删除主机组 : \033[041m%s\033[0m 失败!,主机组不存在" % name_list_1[n_2]['name']<br>                 continue<br>             name_list_2.append(name_2)<br>             id_list_2.append(id_2)<br>         for n_3 in range(len(name_list_2)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "host.delete",<br>                                 "params": [<br>                                             id_list_2[n_3]['hostid']<br>                                         ],<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"删除主机 : \033[042m%s\033[0m 成功!,主机组ID为 : \033[042m%s\033[0m" % (name_list_2[n_3]['name'], ",".join(response['result']['hostids']))<br>             elif response.get('error','') != '':<br>                 print u"删除主机 : \033[041m%s\033[0m 失败!\n\033[041m%s\033[0m" % (name_list_2[n_3]['name'], response['error']['data'])<br>     #![06_为主机创建接口]<br>     def interface_get(self, hostName, ipName, portName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"hostinterface.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "hostids": self.host_get(hostName),<br>                                     "filter":{<!-- --><br>                                             "ip": ipName,<br>                                             "port": portName<br>                                         },<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)     <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['interfaceid']<br>         else:<br>             return response['result']</p> 
<p>    def interface_massadd(self, hostName, ipName, portName, defaultName, typeName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in ipName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         name_list_3 = []<br>         for n_3 in portName.split('//'):<br>             name_3 = {}<br>             name_3['name'] = n_3<br>             name_list_3.append(name_3)<br>         name_list_4 = []<br>         for n_4 in defaultName.split('//'):<br>             name_4 = {}<br>             name_4['name'] = n_4<br>             name_list_4.append(name_4)<br>         name_list_5 = []<br>         for n_5 in typeName.split('//'):<br>             name_5 = {}<br>             name_5['name'] = n_5<br>             name_list_5.append(name_5)  <br>         if len(name_list_1) != len(name_list_2) or \<br>         len(name_list_1) != len(name_list_3) or \<br>         len(name_list_1) != len(name_list_4) or \<br>         len(name_list_1) != len(name_list_5):<br>             print u"为主机附加接口失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_6_1 = []<br>         name_list_6_2 = []<br>         name_list_6_3 = []<br>         name_list_6_4 = []<br>         name_list_6_5 = []<br>         id_list_6 = []<br>         for n_6 in range(len(name_list_1)):<br>             name_6_1 = {}<br>             name_6_2 = {}<br>             name_6_3 = {}<br>             name_6_4 = {}<br>             name_6_5 = {}<br>             id_6 = {}<br>             name_6_1['name'] = name_list_1[n_6]['name']<br>             name_6_2['name'] = name_list_2[n_6]['name']<br>             name_6_3['name'] = name_list_3[n_6]['name']<br>             name_6_4['name'] = name_list_4[n_6]['name']<br>             name_6_5['name'] = name_list_5[n_6]['name']<br>             id_6['hostid'] = self.host_get(name_list_1[n_6]['name'])<br>             if id_6['hostid'] == []:<br>                 print u"为主机附加接口失败!,主机 : \033[041m%s\033[0m 不存在" % name_list_1[n_6]['name']<br>                 continue<br>             name_list_6_1.append(name_6_1)<br>             name_list_6_2.append(name_6_2)<br>             name_list_6_3.append(name_6_3)<br>             name_list_6_4.append(name_6_4)<br>             name_list_6_5.append(name_6_5)<br>             id_list_6.append(id_6)<br>         name_list_7_1 = []<br>         name_list_7_2 = []<br>         name_list_7_3 = []<br>         name_list_7_4 = []<br>         name_list_7_5 = []<br>         id_list_7 = []<br>         for n_7 in range(len(name_list_1)):<br>             name_7_1 = {}<br>             name_7_2 = {}<br>             name_7_3 = {}<br>             name_7_4 = {}<br>             name_7_5 = {}<br>             id_7_1 = {}<br>             id_7_2 = {}<br>             name_7_1['name'] = name_list_1[n_7]['name']<br>             name_7_2['name'] = name_list_2[n_7]['name']<br>             name_7_3['name'] = name_list_3[n_7]['name']<br>             name_7_4['name'] = name_list_4[n_7]['name']<br>             name_7_5['name'] = name_list_5[n_7]['name']<br>             id_7_1['hostid'] = id_list_6[n_7]['hostid']<br>             id_7_2['interfaceid'] = self.interface_get(name_list_1[n_7]['name'], name_list_2[n_7]['name'], name_list_3[n_7]['name'])<br>             if id_7_2['interfaceid'] != []:<br>                 print u"为主机 : \033[041m%s\033[0m 附加接口失败!,接口 : \033[041m%s\033[0m 已存在,并且接口ID为 : \033[042m%s\033[0m" % \<br>                     (name_list_1[n_7]['name'], name_list_3[n_7]['name'], id_7_2['interfaceid'])<br>                 continue<br>             name_list_7_1.append(name_7_1)<br>             name_list_7_2.append(name_7_2)<br>             name_list_7_3.append(name_7_3)<br>             name_list_7_4.append(name_7_4)<br>             name_list_7_5.append(name_7_5)<br>             id_list_7.append(id_7_1)<br>         for n_8 in range(len(name_list_7_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "hostinterface.massadd",<br>                                 "params": {<!-- --><br>                                             "hosts": [<br>                                                         {<!-- --><br>                                                             "hostid": id_list_7[n_8]['hostid']<br>                                                         }<br>                                                 ],<br>                                             "interfaces": [<br>                                                             {<!-- --><br>                                                                 "dns": "",                                                                    <br>                                                                 "ip": name_list_7_2[n_8]['name'],<br>                                                                 "main": name_list_7_4[n_8]['name'],<br>                                                                 "port": name_list_7_3[n_8]['name'],<br>                                                                 "type": name_list_7_5[n_8]['name'],<br>                                                                 "useip": 1,<br>                                                             }<br>                                                         ],<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为主机 : \033[042m%s\033[0m 附加接口 : \033[042m%s\033[0m 成功!,并且接口ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_7_1[n_8]['name'], name_list_7_3[n_8]['name'], ",".join(response['result']['interfaceids']['interfaceids']))<br>             elif response.get('error','') != '':<br>                 print u"为主机 : \033[041m%s\033[0m 附加接口 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_7_1[n_8]['name'],name_list_7_3[n_8]['name'], response['error']['data'])</p> 
<p>    def interface_massRemove(self, hostName, ipName, portName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in ipName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         name_list_3 = []<br>         for n_3 in portName.split('//'):<br>             name_3 = {}<br>             name_3['name'] = n_3<br>             name_list_3.append(name_3)<br>         if len(name_list_1) != len(name_list_2) or \<br>         len(name_list_1) != len(name_list_3):<br>             print u"为主机移除接口失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         name_list_4_3 = []<br>         id_list_4 = []<br>         for n_4 in range(len(name_list_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             name_4_3 = {}<br>             id_4 = {}<br>             name_4_1['name'] = name_list_1[n_4]['name']<br>             name_4_2['name'] = name_list_2[n_4]['name']<br>             name_4_3['name'] = name_list_3[n_4]['name']<br>             id_4['hostid'] = self.host_get(name_list_1[n_4]['name'])<br>             if id_4['hostid'] == []:<br>                 print u"为主机 : \033[041m%s\033[0m 移除接口失败!,主机不存在" % name_list_1[n_4]['name']<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             name_list_4_3.append(name_4_3)<br>             id_list_4.append(id_4)<br>         name_list_5_1 = []<br>         name_list_5_2 = []<br>         name_list_5_3 = []<br>         id_list_5 = []<br>         for n_5 in range(len(name_list_1)):<br>             name_5_1 = {}<br>             name_5_2 = {}<br>             name_5_3 = {}<br>             id_5_1 = {}<br>             id_5_2 = {}<br>             name_5_1['name'] = name_list_1[n_5]['name']<br>             name_5_2['name'] = name_list_2[n_5]['name']<br>             name_5_3['name'] = name_list_3[n_5]['name']<br>             id_5_1['hostid'] = id_list_4[n_5]['hostid']<br>             id_5_2['interfaceid'] = self.interface_get(name_list_1[n_5]['name'], name_list_2[n_5]['name'], name_list_3[n_5]['name'])<br>             if id_5_2['interfaceid'] == []:<br>                 print u"为主机 : \033[041m%s\033[0m 移除接口失败!,接口 : \033[041m%s\033[0m 不存在" % (name_list_1[n_5]['name'], name_list_3[n_5]['name'])<br>                 continue<br>             name_list_5_1.append(name_5_1)<br>             name_list_5_2.append(name_5_2)<br>             name_list_5_3.append(name_5_3)<br>             id_list_5.append(id_5_1)       <br>         for n_6 in range(len(name_list_5_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "hostinterface.massremove",<br>                                 "params": {<!-- --><br>                                             "hosts": [<br>                                                         {<!-- --><br>                                                             "hostids": id_list_5[n_6]['hostid']<br>                                                         }<br>                                                 ],<br>                                             "interfaces": [<br>                                                             {<!-- --><br>                                                                 "dns": "",                                                                    <br>                                                                 "ip": name_list_5_2[n_6]['name'],<br>                                                                 "port": name_list_5_3[n_6]['name'],<br>                                                             }<br>                                                         ],<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为主机 : \033[042m%s\033[0m 移除接口 : \033[042m%s\033[0m 成功!,并且接口ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_5_1[n_6]['name'], name_list_5_3[n_6]['name'], ",".join([str(i) for i in response['result']['interfaceids']]))<br>             elif response.get('error','') != '':<br>                 print u"为主机 : \033[041m%s\033[0m 移除接口 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_5_1[n_6]['name'], name_list_5_3[n_6]['name'], response['error']['data'])<br>     #![07_为主机关联模板]<br>     def host_massadd(self, hostName, templateName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in templateName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为主机附加模板失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['hostid'] = self.host_get(name_list_1[n_3]['name'])<br>             if id_3['hostid'] == []:<br>                 print u"为主机 : \033[041m%s\033[0m 附加模板失败!,主机不存在" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4_1 = []<br>         id_list_4_2 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4_1 = {}<br>             id_4_2 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4_1['hostid'] = id_list_3[n_4]['hostid']<br>             id_4_2['templateid'] = self.template_get(name_list_3_2[n_4]['name'])<br>             if id_4_2['templateid'] == []:<br>                 print u"为主机附加模板 : \033[041m%s\033[0m 失败!,模板不存在!" % name_list_3_2[n_4]['name']<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4_1.append(id_4_1)<br>             id_list_4_2.append(id_4_2)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "host.massadd",<br>                                 "params": {<!-- --><br>                                             "hosts": [<br>                                                             {<!-- --><br>                                                                 "hostid": id_list_4_1[n_5]['hostid']<br>                                                             }<br>                                                         ],<br>                                             "templates": [<br>                                                         {<!-- --><br>                                                             "templateid": id_list_4_2[n_5]['templateid']<br>                                                         }<br>                                                     ],<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为主机 : \033[042m%s\033[0m 附加模板 : \033[042m%s\033[0m 成功!,并且主机ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['hostids']))<br>             elif response.get('error','') != '':<br>                 print u"为主机 : \033[041m%s\033[0m 附加模板 : \033[041m%s\033[0m 失败!,并且主机ID为 : \033[041m%s\033[0m \<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], id_list_4_2[n_5]['templateid'], response['error']['data'])<br>     <br>     def host_massremove(self, hostName, templateName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in templateName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为主机附加模板失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['hostid'] = self.host_get(name_list_1[n_3]['name'])<br>             if id_3['hostid'] == []:<br>                 print u"为主机 : \033[041m%s\033[0m 附加模板失败!,主机不存在" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4_1 = []<br>         id_list_4_2 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4_1 = {}<br>             id_4_2 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4_1['hostid'] = id_list_3[n_4]['hostid']<br>             id_4_2['templateid'] = self.template_get(name_list_3_2[n_4]['name'])<br>             if id_4_2['templateid'] == []:<br>                 print u"为主机附加模板 : \033[041m%s\033[0m 失败!,模板不存在!" % name_list_3_2[n_4]['name']<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4_1.append(id_4_1)<br>             id_list_4_2.append(id_4_2)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "host.massremove",<br>                                 "params": {<!-- --><br>                                             "hostids": [<br>                                                             id_list_4_1[n_5]['hostid']<br>                                                     ],<br>                                             "templateids_clear": id_list_4_2[n_5]['templateid']<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为主机 : \033[042m%s\033[0m 移除模板 : \033[042m%s\033[0m 成功!,并且主机ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['hostids']))<br>             elif response.get('error','') != '':<br>                 print u"为主机 : \033[041m%s\033[0m 移除模板 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], response['error']['data'])<br>     #![08_创建主机组]<br>     def hostGroup_get(self, hostGroupName):<br>         data = json.dumps({<!-- --><br>                             "jsonrpc":"2.0",<br>                             "method":"hostgroup.get",<br>                             "params":{<!-- --><br>                                     "output": "extend",<br>                                     "filter": {<!-- --><br>                                                 "name": hostGroupName<br>                                             }<br>                                     },<br>                             "auth":self.authID,<br>                             "id":1,<br>                         })<br>         request = urllib2.Request(self.url, data, self.header)   <br>         result = urllib2.urlopen(request)<br>         response = json.loads(result.read())<br>         result.close()<br>         if response.get('result','') != []:<br>             return response['result'][0]['groupid']<br>         else:<br>             return response['result']<br>              <br>     def hostGroup_create(self, hostGroupName):<br>         name_list_1 = []<br>         for n_1 in hostGroupName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in range(len(name_list_1)):<br>             name_2 = {}<br>             id_2 = {}<br>             name_2['name'] = name_list_1[n_2]['name']<br>             id_2['groupid'] = self.hostGroup_get(name_list_1[n_2]['name'])<br>             if id_2['groupid'] != []:<br>                 print u"创建主机组 : \033[041m%s\033[0m 失败!,主机组重复创建" % name_list_1[n_2]['name']<br>                 continue<br>             name_list_2.append(name_2)<br>         for n_3 in range(len(name_list_2)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "hostgroup.create",<br>                                 "params": {<!-- --><br>                                 "name": name_list_2[n_3]['name']<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)  <br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"创建主机组 : \033[042m%s\033[0m 成功!,主机组ID为 : \033[042m%s\033[0m" % (name_list_2[n_3]['name'], ",".join(response['result']['groupids']))<br>             elif response.get('error','') != '':<br>                 print u"创建主机组 : \033[041m%s\033[0m 失败!\n\033[041m%s\033[0m" % (name_list_2[n_3]['name'], response['error']['data'])   <br>  <br>     def hostGroup_delete(self, hostGroupName):<br>         name_list_1 = []<br>         for n_1 in hostGroupName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         id_list_2 = []<br>         for n_2 in range(len(name_list_1)):<br>             name_2 = {}<br>             id_2 = {}<br>             name_2['name'] = name_list_1[n_2]['name']<br>             id_2['groupid'] = self.hostGroup_get(name_list_1[n_2]['name'])<br>             if id_2['groupid'] == []:<br>                 print u"删除主机组 : \033[041m%s\033[0m 失败!,主机组不存在" % name_list_1[n_2]['name']<br>                 continue<br>             name_list_2.append(name_2)<br>             id_list_2.append(id_2)<br>         for n_3 in range(len(name_list_2)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "hostgroup.delete",<br>                                 "params": [<br>                                             id_list_2[n_3]['groupid']<br>                                         ],<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"删除主机组 : \033[042m%s\033[0m 成功!,主机组ID为 : \033[042m%s\033[0m" % (name_list_2[n_3]['name'], ",".join(response['result']['groupids']))<br>             elif response.get('error','') != '':<br>                 print u"删除主机组 : \033[041m%s\033[0m 失败!\n\033[041m%s\033[0m" % (name_list_2[n_3]['name'], response['error']['data'])<br>     #![09_为主机附加主机组]<br>     def hostGroup_massadd(self, hostName, hostGroupName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in hostGroupName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为主机附加主机组失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['hostid'] = self.host_get(name_list_1[n_3]['name'])<br>             if id_3['hostid'] == []:<br>                 print u"为主机 : \033[041m%s\033[0m 附加主机组失败!,主机不存在" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4_1 = []<br>         id_list_4_2 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4_1 = {}<br>             id_4_2 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4_1['hostid'] = id_list_3[n_4]['hostid']<br>             id_4_2['groupid'] = self.hostGroup_get(name_list_3_2[n_4]['name'])<br>             if id_4_2['groupid'] == []:<br>                 print u"为主机附加主机组 : \033[041m%s\033[0m 失败!,主机组不存在!" % name_list_3_2[n_4]['name']<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4_1.append(id_4_1)<br>             id_list_4_2.append(id_4_2)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "host.massadd",<br>                                 "params": {<!-- --><br>                                             "hosts": [<br>                                                             {<!-- --><br>                                                                 "hostid": id_list_4_1[n_5]['hostid']<br>                                                             }<br>                                                         ],<br>                                             "groups": [<br>                                                         {<!-- --><br>                                                             "groupid": id_list_4_2[n_5]['groupid']<br>                                                         }<br>                                                     ],<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为主机 : \033[042m%s\033[0m 附加模板 : \033[042m%s\033[0m 成功!,并且主机ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['hostids']))<br>             elif response.get('error','') != '':<br>                 print u"为主机 : \033[041m%s\033[0m 附加模板 : \033[041m%s\033[0m 失败!,并且主机ID为 : \033[041m%s\033[0m \<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], id_list_4_2[n_5]['groupid'], response['error']['data'])</p> 
<p>    def hostGroup_massremove(self, hostName, hostGroupName):<br>         name_list_1 = []<br>         for n_1 in hostName.split('//'):<br>             name_1 = {}<br>             name_1['name'] = n_1<br>             name_list_1.append(name_1)<br>         name_list_2 = []<br>         for n_2 in hostGroupName.split('//'):<br>             name_2 = {}<br>             name_2['name'] = n_2<br>             name_list_2.append(name_2)<br>         if len(name_list_1) != len(name_list_2):<br>             print u"为主机移除主机组失败!,\033[041m输入的参数存在空值\033[0m"<br>             sys.exit(1)<br>         name_list_3_1 = []<br>         name_list_3_2 = []<br>         id_list_3 = []<br>         for n_3 in range(len(name_list_1)):<br>             name_3_1 = {}<br>             name_3_2 = {}<br>             id_3 = {}<br>             name_3_1['name'] = name_list_1[n_3]['name']<br>             name_3_2['name'] = name_list_2[n_3]['name']<br>             id_3['hostid'] = self.host_get(name_list_1[n_3]['name'])<br>             if id_3['hostid'] == []:<br>                 print u"为主机 : \033[041m%s\033[0m 移除主机组失败!,主机不存在" % name_list_1[n_3]['name']<br>                 continue<br>             name_list_3_1.append(name_3_1)<br>             name_list_3_2.append(name_3_2)<br>             id_list_3.append(id_3)<br>         name_list_4_1 = []<br>         name_list_4_2 = []<br>         id_list_4_1 = []<br>         id_list_4_2 = []<br>         for n_4 in range(len(name_list_3_1)):<br>             name_4_1 = {}<br>             name_4_2 = {}<br>             id_4_1 = {}<br>             id_4_2 = {}<br>             name_4_1['name'] = name_list_3_1[n_4]['name']<br>             name_4_2['name'] = name_list_3_2[n_4]['name']<br>             id_4_1['hostid'] = id_list_3[n_4]['hostid']<br>             id_4_2['groupid'] = self.hostGroup_get(name_list_3_2[n_4]['name'])<br>             if id_4_2['groupid'] == []:<br>                 print u"为主机移除主机组 : \033[041m%s\033[0m 失败!,主机组不存在!" % name_list_3_2[n_4]['name']<br>                 continue<br>             name_list_4_1.append(name_4_1)<br>             name_list_4_2.append(name_4_2)<br>             id_list_4_1.append(id_4_1)<br>             id_list_4_2.append(id_4_2)<br>         for n_5 in range(len(name_list_4_1)):<br>             data = json.dumps({<!-- --><br>                                 "jsonrpc": "2.0",<br>                                 "method": "host.massremove",<br>                                 "params": {<!-- --><br>                                             "hostids": [<br>                                                             id_list_4_1[n_5]['hostid']<br>                                                     ],<br>                                             "groupids": id_list_4_2[n_5]['groupid']<br>                                         },<br>                                 "auth": self.authID,<br>                                 "id": 1<br>                             })<br>             request = urllib2.Request(self.url, data, self.header)<br>             result = urllib2.urlopen(request)<br>             response = json.loads(result.read())<br>             result.close()<br>             if response.get('result','') != '':<br>                 print u"为主机 : \033[042m%s\033[0m 移除主机组 : \033[042m%s\033[0m 成功!,并且主机ID为 : \033[042m%s\033[0m" % \<br>                 (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], ",".join(response['result']['hostids']))<br>             elif response.get('error','') != '':<br>                 print u"为主机 : \033[041m%s\033[0m 移除主机组 : \033[041m%s\033[0m 失败!\<br>                 \n\033[041m%s\033[0m" % (name_list_4_1[n_5]['name'],name_list_4_2[n_5]['name'], response['error']['data'])</p> 
<p>if __name__ == "__main__":<br>     zabbix = zabbix_api()<br>     #![01_创建模板]<br>     parser = argparse.ArgumentParser(description='zabbix  api ', usage='%(prog)s [options]')<br>     parser.add_argument('-ct', nargs='+', metavar=('模板名称'), dest='ct', help=u"创建模板(多个可用//隔开)")<br>     parser.add_argument('-cte', nargs='?', metavar=('无参数'), dest='cte', default='cte', \<br>                         help=u"通过zabbix_api.xlsx的Sheet2表为A列的主机批量创建模板")<br>     parser.add_argument('-dt', metavar=('模板名称'), nargs='+', dest='dt', help=u"删除模板(多个可用//隔开)")<br>     parser.add_argument('-dte', nargs='?', metavar=('无参数'), dest='dte', default='dte', \<br>                         help=u"通过zabbix_api.xlsx的Sheet2表从A列批量删除模板")<br>     #![02_为模板创建应用集]<br>     parser.add_argument('-ca', nargs='+', metavar=('模板名称 应用集名称'), dest='ca', \<br>                         help=u"为模板(多个模板可用//隔开)创建应用集(多个应用集可用//隔开)")<br>     parser.add_argument('-cae', nargs='?', metavar=('无参数'), dest='cae',default='cae', \<br>                         help=u"通过zabbix_api.xlsx的Sheet5表为A列模板批量创建B列应用集")<br>     parser.add_argument('-da', nargs='+', metavar=('模板名称 应用集名称'), dest='da', \<br>                         help=u"为模板(多个模板可用//隔开)删除应用集(多个应用集可用//隔开)")<br>     parser.add_argument('-dae', nargs='?', metavar=('无参数'), dest='dae',default='dae', \<br>                         help=u"通过zabbix_api.xlsx的Sheet5表为A列模板批量删除B列应用集")<br>     #![03_为模板创建监控项]<br>     parser.add_argument('-ci', nargs='+', \<br>                         metavar=('模板名称 应用集名称 监控项名称 监控项键值 监控项信息类型 监控项更新间隔'), \<br>                         dest='ci', help=u"为模板(多个模板可用//隔开)创建监控项(多个监控项可用//隔开)")<br>     parser.add_argument('-cie', nargs='?', metavar=('无参数'), dest='cie',default='cie', \<br>                         help=u"通过zabbix_api.xlsx的Sheet5表为A列模板批量创建CDEF列监控项,并附加到B列应用集")<br>     parser.add_argument('-di', nargs='+', metavar=('模板名称 应用集名称'), dest='di', \<br>                         help=u"为模板(多个模板可用//隔开)删除监控项(多个监控项可用//隔开)")<br>     parser.add_argument('-die', nargs='?', metavar=('无参数'), dest='die',default='die', \<br>                         help=u"通过zabbix_api.xlsx的Sheet5表为A列模板批量删除C列监控项")<br>     #![04_为模板创建触发器]<br>     parser.add_argument('-ctg', nargs='+', \<br>                         metavar=('模板名称 监控项名称 触发器名称 触发器表达式'), \<br>                         dest='ctg', help=u"为监控项(多个监控项可用//隔开)创建触发器(多个触发器可用//隔开)")<br>     parser.add_argument('-ctge', nargs='?', metavar=('无参数'), dest='ctge',default='ctge', \<br>                         help=u"通过zabbix_api.xlsx的Sheet6表为A列模板的B列监控项批量创建CD列触发器")<br>     parser.add_argument('-dtg', nargs='+', metavar=('模板名称 触发器名称'), dest='dtg', \<br>                         help=u"为模板(多个模板可用//隔开)删除触发器(多个触发器可用//隔开)")<br>     parser.add_argument('-dtge', nargs='?', metavar=('无参数'), dest='dtge',default='dtge', \<br>                         help=u"通过zabbix_api.xlsx的Sheet6表为A列模板批量删除C列触发器")<br>     #![05_创建主机]<br>     parser.add_argument('-ch', nargs='+', metavar=('主机名称'), dest='ch', \<br>                         help=u"创建主机(多个可用//隔开)")<br>     parser.add_argument('-che', nargs='?', metavar=('无参数'), dest='che', default='che', \<br>                         help=u"通过zabbix_api.xlsx的Sheet4表从A列批量创建主机")<br>     parser.add_argument('-dh', nargs='+', metavar=('主机组名称'), dest='dh', help=u"删除主机组(多个可用//隔开)")<br>     parser.add_argument('-dhe', nargs='?', metavar=('无参数'), dest='dhe', default='dhe', \<br>                         help=u"通过zabbix_api.xlsx的Sheet1表从A列批量删除主机组")<br>     #![06_为主机创建接口]<br>     parser.add_argument('-mai', nargs='+', \<br>                         metavar=('主机名称 接口地址 接口端口 作为默认接口 接口类型'), \<br>                         dest='mai', help=u"为主机(多个主机可用//隔开)附加接口(多个接口可用//隔开)")<br>     parser.add_argument('-maie', nargs='?', metavar=('无参数'), dest='maie',default='maie', \<br>                         help=u"通过zabbix_api.xlsx的Sheet4表为A列主机批量附加BCDE列接口")<br>     parser.add_argument('-mri', nargs='+', metavar=('主机名称 接口地址 接口端口'), dest='mri', \<br>                         help=u"为主机(多个主机可用//隔开)移除接口(多个接口可用//隔开)")<br>     parser.add_argument('-mrie', nargs='?', metavar=('无参数'), dest='mrie', default='mrie', \<br>                         help=u"通过zabbix_api.xlsx的Sheet4表为A列主机批量移除BC列接口")<br>     #![07_为主机关联模板]<br>     parser.add_argument('-mat', nargs='+', metavar=('主机组名称 模板名称'), dest='mat', \<br>                         help=u"为主机(多个主机可用//隔开)附加模板(多个模板可用//隔开)")<br>     parser.add_argument('-mate', nargs='?', metavar=('无参数'), dest='mate',default='mate', \<br>                         help=u"通过zabbix_api.xlsx的Sheet3表为A列主机组批量附加B列模板")<br>     parser.add_argument('-mrt', nargs='+', metavar=('主机组名称 模板名称'), dest='mrt', \<br>                         help=u"为主机(多个主机可用//隔开)移除模板(多个模板可用//隔开)")<br>     parser.add_argument('-mrte', nargs='?', metavar=('无参数'), dest='mrte', default='mrte',\<br>                         help=u"通过zabbix_api.xlsx的Sheet3表为A列主机组批量移除B列模板")<br>     #![08_创建主机组]<br>     parser.add_argument('-cg', nargs='+', metavar=('主机组名称'), dest='cg', help=u"创建主机组(多个可用//隔开)")<br>     parser.add_argument('-cge', nargs='?', metavar=('无参数'), dest='cge', default='cge', \<br>                         help=u"通过zabbix_api.xlsx的Sheet1表从A列批量创建主机组")<br>     parser.add_argument('-dg', nargs='+', metavar=('主机组名称'), dest='dg', help=u"删除主机组(多个可用//隔开)")<br>     parser.add_argument('-dge', nargs='?', metavar=('无参数'), dest='dge', default='dge', \<br>                         help=u"通过zabbix_api.xlsx的Sheet1表从A列批量删除主机组")<br>     #![09_为主机附加主机组]<br>     parser.add_argument('-mag', nargs='+', metavar=('主机名称 模板名称'), dest='mag', \<br>                         help=u"为主机(多个主机可用//隔开)附加主机组(多个主机组可用//隔开)")<br>     parser.add_argument('-mage', nargs='?', metavar=('无参数'), dest='mage',default='mage', \<br>                         help=u"通过zabbix_api.xlsx的Sheet3表为A列主机批量附加B列主机组")<br>     parser.add_argument('-mrg', nargs='+', metavar=('主机组名称 模板名称'), dest='mrg', \<br>                         help=u"为主机(多个主机可用//隔开)移除主机组(多个主机组可用//隔开)")<br>     parser.add_argument('-mrge', nargs='?', metavar=('无参数'), dest='mrge', default='mrge',\<br>                         help=u"通过zabbix_api.xlsx的Sheet3表为A列主机组批量移除B列主机组")<br>     parser.add_argument('-v', '--version', action='version', version='%(prog)s 如有问题请联系作者QQ1284524409', help=u"如有问题请联系作者QQ1284524409")<br>     if len(sys.argv) == 1:<br>         print parser.print_help()<br>     else:<br>         args = parser.parse_args()<br>         #![01_创建模板]<br>         if args.ct:<br>             zabbix.template_create(args.ct[0])<br>         elif args.cte != 'cte':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for row in xrange(workbook.sheets()[0].nrows):<br>                 if row == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[0].cell(row, 0).value<br>                     if templateName == '':<br>                         break<br>                     try:<br>                         zabbix.template_create(templateName)<br>                     except Exception as e:<br>                         print u"Sheet2表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (row + 1, e)<br>                         sys.exit(1)<br>         elif args.dt:<br>             zabbix.template_delete(args.dt[0])<br>         elif args.dte != 'dte':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for row in xrange(workbook.sheets()[0].nrows):<br>                 if row == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[0].cell(row, 0).value<br>                     if templateName == '':<br>                         break<br>                     try:<br>                         zabbix.template_delete(templateName)<br>                     except Exception as e:<br>                         print u"Sheet2表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (row + 1, e)<br>                         sys.exit(1)<br>         #![02_为模板创建应用集]<br>         elif args.ca:<br>             zabbix.application_create(args.ca[0], args.ca[1])<br>         elif args.cae != 'cae':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for x in xrange(workbook.sheets()[1].nrows):<br>                 if x == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[1].cell(x, 0).value<br>                     if templateName == '':<br>                         break<br>                     applicationName = workbook.sheets()[1].cell(x, 1).value<br>                     if applicationName == '':<br>                         break<br>                     try:<br>                         zabbix.application_create(templateName, applicationName)<br>                     except Exception as e:<br>                         print u"Sheet5表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (x + 1, e)<br>                         sys.exit(1)<br>         elif args.da:<br>             zabbix.application_delete(args.da[0], args.da[1])<br>         elif args.dae != 'dae':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for x in xrange(workbook.sheets()[1].nrows):<br>                 if x == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[1].cell(x, 0).value<br>                     if templateName == '':<br>                         break<br>                     applicationName = workbook.sheets()[1].cell(x, 1).value<br>                     if applicationName == '':<br>                         break<br>                     try:<br>                         zabbix.application_delete(templateName, applicationName)<br>                     except Exception as e:<br>                         print u"Sheet5表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (x + 1, e)<br>                         sys.exit(1)<br>         #![03_为模板创建监控项]<br>         elif args.ci:<br>             zabbix.item_create(args.ci[0], args.ci[1], args.ci[2], args.ci[3], args.ci[4], args.ci[5])<br>         elif args.cie != 'cie':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for x in xrange(workbook.sheets()[6].nrows):<br>                 if x == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[2].cell(x, 0).value<br>                     if templateName == '':<br>                         break<br>                     itemApplication = workbook.sheets()[2].cell(x, 1).value<br>                     if itemApplication == '':<br>                         break<br>                     itemName = workbook.sheets()[2].cell(x, 2).value<br>                     if itemName == '':<br>                         break<br>                     itemKey = workbook.sheets()[2].cell(x, 3).value<br>                     if itemKey == '':<br>                         break<br>                     itemValueType = workbook.sheets()[2].cell(x, 4).value<br>                     if itemValueType == '':<br>                         break<br>                     itemDely = workbook.sheets()[2].cell(x, 5).value<br>                     if itemDely == '':<br>                         break<br>                     try:<br>                         zabbix.item_create(templateName, itemApplication, itemName, itemKey, str(int(itemValueType)), itemDely)<br>                     except Exception as e:<br>                         print u"Sheet5表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (x + 1, e)<br>                         sys.exit(1)<br>         elif args.di:<br>             zabbix.item_delete(args.di[0], args.di[1])<br>         elif args.die != 'die':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for x in xrange(workbook.sheets()[2].nrows):<br>                 if x == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[2].cell(x, 0).value<br>                     if templateName == '':<br>                         break<br>                     itemName = workbook.sheets()[2].cell(x, 1).value<br>                     if itemName == '':<br>                         break<br>                     try:<br>                         zabbix.item_delete(templateName, itemName)<br>                     except Exception as e:<br>                         print u"Sheet5表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (x + 1, e)<br>                         sys.exit(1)<br>         #![04_为模板创建触发器]<br>         elif args.ctg:<br>             zabbix.trigger_create(args.ctg[0], args.ctg[1], args.ctg[2], args.ctg[3])<br>         elif args.ctge != 'ctge':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for x in xrange(workbook.sheets()[3].nrows):<br>                 if x == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[3].cell(x, 0).value<br>                     if templateName == '':<br>                         break<br>                     itemName = workbook.sheets()[3].cell(x, 1).value<br>                     if itemName == '':<br>                         break<br>                     descriptionName = workbook.sheets()[3].cell(x, 2).value<br>                     if descriptionName == '':<br>                         break<br>                     expressionName = workbook.sheets()[3].cell(x, 3).value<br>                     if expressionName == '':<br>                         break<br>                     try:<br>                         zabbix.trigger_create(templateName, itemName, descriptionName, expressionName)<br>                     except Exception as e:<br>                         print u"Sheet5表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (x + 1, e)<br>                         sys.exit(1)<br>         elif args.dtg:<br>             zabbix.trigger_delete(args.dtg[0], args.dtg[1])<br>         elif args.dtge != 'dtge':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for x in xrange(workbook.sheets()[3].nrows):<br>                 if x == 0:<br>                     continue<br>                 else:<br>                     templateName = workbook.sheets()[3].cell(x, 0).value<br>                     if templateName == '':<br>                         break<br>                     triggerName = workbook.sheets()[3].cell(x, 2).value<br>                     if triggerName == '':<br>                         break<br>                     try:<br>                         zabbix.trigger_delete(templateName, triggerName)<br>                     except Exception as e:<br>                         print u"Sheet5表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (x + 1, e)<br>                         sys.exit(1)<br>         #![05_创建主机]<br>         elif args.ch:<br>             zabbix.host_create(args.ch[0])<br>         elif args.che != 'che':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for row in xrange(workbook.sheets()[4].nrows):<br>                 if row == 0:<br>                     continue<br>                 else:                    <br>                     hostName = workbook.sheets()[4].cell(row, 0).value<br>                     if hostName == '':<br>                         break<br>                     try:<br>                         zabbix.host_create(hostName)<br>                     except Exception as e:<br>                         print u"Sheet4表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (row + 1, e)<br>                         sys.exit(1)<br>         elif args.dh:<br>             zabbix.host_delete(args.dh[0])<br>         elif args.dhe != 'dhe':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for row in xrange(workbook.sheets()[4].nrows):<br>                 if row == 0:<br>                     continue<br>                 else:<br>                     hosthost = workbook.sheets()[4].cell(row, 0).value<br>                     if hosthost == '':<br>                         break<br>                     try:<br>                         zabbix.host_delete(hosthost)<br>                     except Exception as e:<br>                         print u"Sheet4表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (row + 1, e)<br>                         sys.exit(1)<br>         #![06_为主机创建接口]<br>         elif args.mai:<br>             zabbix.interface_massadd(args.mai[0], args.mai[1], args.mai[2], args.mai[3], args.mai[4])<br>         elif args.maie != 'maie':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for col1 in xrange(workbook.sheets()[5].nrows):<br>                 if col1 == 0:<br>                     continue<br>                 else:<br>                     hostName = workbook.sheets()[5].cell(col1, 0).value<br>                     if hostName == '':<br>                         break<br>                     ipName = workbook.sheets()[5].cell(col1, 1).value<br>                     if ipName == '':<br>                         break<br>                     portName = workbook.sheets()[5].cell(col1, 2).value<br>                     if portName == '':<br>                         break<br>                     defaultName = workbook.sheets()[5].cell(col1, 3).value<br>                     if defaultName == '':<br>                         break<br>                     typeName = workbook.sheets()[5].cell(col1, 4).value<br>                     if typeName == '':<br>                         break<br>                     try:<br>                         zabbix.interface_massadd(hostName, ipName, str(int(portName)), str(int(defaultName)), str(int(typeName)))<br>                     except Exception as e:<br>                         print u"Sheet4表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (col1 + 1, e)<br>                         sys.exit(1)<br>         elif args.mri:<br>             zabbix.interface_massRemove(args.mri[0], args.mri[1], args.mri[2])<br>         elif args.mrie != 'mrie':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for col1 in xrange(workbook.sheets()[5].nrows):<br>                 if col1 == 0:<br>                     continue<br>                 else:<br>                     hostName = workbook.sheets()[5].cell(col1, 0).value<br>                     if hostName == '':<br>                         break<br>                     ipName = workbook.sheets()[5].cell(col1, 1).value<br>                     if ipName == '':<br>                         break<br>                     portName = workbook.sheets()[5].cell(col1, 2).value<br>                     if portName == '':<br>                         break<br>                     try:<br>                         zabbix.interface_massRemove(hostName, ipName, str(int(portName)))<br>                     except Exception as e:<br>                         print u"Sheet4表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (col1 + 1, e)<br>                         sys.exit(1)<br>         #![07_为主机关联模板]<br>         elif args.mat:<br>             zabbix.host_massadd(args.mat[0], args.mat[1])<br>         elif args.mate != 'mate':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for n_1 in xrange(workbook.sheets()[6].nrows):<br>                 if n_1 == 0:<br>                     continue<br>                 else:<br>                     hostgroup = workbook.sheets()[6].cell(n_1, 0).value<br>                     if hostgroup == '':<br>                         break<br>                     templateName = workbook.sheets()[6].cell(n_1, 1).value<br>                     if templateName == '':<br>                         break<br>                     try:<br>                         zabbix.host_massadd(hostgroup, templateName)<br>                     except Exception as e:<br>                         print u"Sheet3表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (n_1 + 1, e)<br>                         sys.exit(1)<br>         elif args.mrt:<br>             zabbix.host_massremove(args.mrt[0], args.mrt[1])<br>         elif args.mrte != 'mrte':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for n_1 in xrange(workbook.sheets()[6].nrows):<br>                 if n_1 == 0:<br>                     continue<br>                 else:<br>                     hostgroup = workbook.sheets()[6].cell(n_1, 0).value<br>                     if hostgroup == '':<br>                         break<br>                     templateName = workbook.sheets()[6].cell(n_1, 1).value<br>                     if templateName == '':<br>                         break<br>                     try:<br>                         zabbix.host_massremove(hostgroup, templateName)<br>                     except Exception as e:<br>                         print u"Sheet3表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (n_1 + 1, e)<br>                         sys.exit(1)<br>         #![08_创建主机组]<br>         elif args.cg:<br>             zabbix.hostGroup_create(args.cg[0])<br>         elif args.cge != 'cge':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for row in xrange(workbook.sheets()[7].nrows):<br>                 if row == 0:<br>                     continue<br>                 else:                    <br>                     hostgroup = workbook.sheets()[7].cell(row, 0).value<br>                     if hostgroup == '':<br>                         break<br>                     try:<br>                         zabbix.hostGroup_create(hostgroup)<br>                     except Exception as e:<br>                         print u"Sheet1表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (row + 1, e)<br>                         sys.exit(1)<br>         elif args.dg:<br>             zabbix.hostGroup_delete(args.dg[0])<br>         elif args.dge != 'dge':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for row in xrange(workbook.sheets()[7].nrows):<br>                 if row == 0:<br>                     continue<br>                 else:<br>                     hostgroup = workbook.sheets()[7].cell(row, 0).value<br>                     if hostgroup == '':<br>                         break<br>                     try:<br>                         zabbix.hostGroup_delete(hostgroup)<br>                     except Exception as e:<br>                         print u"Sheet1表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (row + 1, e)<br>                         sys.exit(1)<br>         #![09_为主机附加主机组]<br>         elif args.mag:<br>             zabbix.hostGroup_massadd(args.mag[0], args.mag[1])<br>         elif args.mage != 'mage':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for n_1 in xrange(workbook.sheets()[8].nrows):<br>                 if n_1 == 0:<br>                     continue<br>                 else:<br>                     hostName = workbook.sheets()[8].cell(n_1, 0).value<br>                     if hostName == '':<br>                         break<br>                     hostGroupName = workbook.sheets()[8].cell(n_1, 1).value<br>                     if hostGroupName == '':<br>                         break<br>                     try:<br>                         zabbix.hostGroup_massadd(hostName, hostGroupName)<br>                     except Exception as e:<br>                         print u"Sheet3表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (n_1 + 1, e)<br>                         sys.exit(1)<br>         elif args.mrg:<br>             zabbix.hostGroup_massremove(args.mrt[0], args.mrt[1])<br>         elif args.mrge != 'mrge':<br>             workbook = xlrd.open_workbook('zabbix_api.xlsx')<br>             for n_1 in xrange(workbook.sheets()[8].nrows):<br>                 if n_1 == 0:<br>                     continue<br>                 else:<br>                     hostName = workbook.sheets()[8].cell(n_1, 0).value<br>                     if hostName == '':<br>                         break<br>                     hostGroupName = workbook.sheets()[8].cell(n_1, 1).value<br>                     if hostGroupName == '':<br>                         break<br>                     try:<br>                         zabbix.hostGroup_massremove(hostName, hostGroupName)<br>                     except Exception as e:<br>                         print u"Sheet3表第\033[041m%s\033[0m行数据异常\n\033[041m%s\033[0m" % (n_1 + 1, e)<br>                         sys.exit(1)<br>  </p> 
<hr> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bb491ef9c275bb0c16b291e7d1593999/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【1】Docker详解与部署微服务实战</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ef09d727c44939d01489b60278faff6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【贪心算法】专题练习一</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>