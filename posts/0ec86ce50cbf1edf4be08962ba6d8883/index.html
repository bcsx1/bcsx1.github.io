<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Go Over a Complete Example of Parametric Bootstrap Test with R - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Go Over a Complete Example of Parametric Bootstrap Test with R" />
<meta property="og:description" content="文章目录 QuestionSolution1. State the hypotheses2. Importing and examining the data3. Exploratory analysis of the data4. Paramatrizing5. Executing the bootstrap test6. Draw conclusion (statistical inference) Full Code Below I did a complete example of a parametric test to illustrate some important concepts. Question Suppose we obtained a random sample (which is representative of the US population), and we grouped the individuals into different groups according to which age decade they are in (the AgeDecade column, whose values are strings)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0ec86ce50cbf1edf4be08962ba6d8883/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-14T00:34:29+08:00" />
<meta property="article:modified_time" content="2021-03-14T00:34:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Go Over a Complete Example of Parametric Bootstrap Test with R</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#Question_3" rel="nofollow">Question</a></li><li><a href="#Solution_7" rel="nofollow">Solution</a></li><li><ul><li><a href="#1_State_the_hypotheses_9" rel="nofollow">1. State the hypotheses</a></li><li><a href="#2_Importing_and_examining_the_data_17" rel="nofollow">2. Importing and examining the data</a></li><li><a href="#3_Exploratory_analysis_of_the_data_36" rel="nofollow">3. Exploratory analysis of the data</a></li><li><a href="#4_Paramatrizing_60" rel="nofollow">4. Paramatrizing</a></li><li><a href="#5_Executing_the_bootstrap_test_73" rel="nofollow">5. Executing the bootstrap test</a></li><li><a href="#6_Draw_conclusion_statistical_inference_95" rel="nofollow">6. Draw conclusion (statistical inference)</a></li></ul> 
   </li><li><a href="#Full_Code_99" rel="nofollow">Full Code</a></li></ul> 
 </li></ul> 
</div> 
<br> Below I did a complete example of a parametric test to illustrate some important concepts. 
<p></p> 
<h3><a id="Question_3"></a>Question</h3> 
<p>Suppose we obtained a random sample (which is representative of the US population), and we grouped the individuals into different groups according to which age decade they are in (the <code>AgeDecade</code> column, whose values are strings). The data is about the individuals’ heartbeat per minute (pulse rate), which corresponds to the <code>Pulse</code> column in the data below. In this problem, we want to test if the collected data provide evidence that the average pulse rate of people aged 20-29 is different from the average pulse rate of people aged 30-39. You may assume pulse rates follow a normal distribution (for the entire population as well as for each age category). We run 10000 repetitions.</p> 
<h3><a id="Solution_7"></a>Solution</h3> 
<h4><a id="1_State_the_hypotheses_9"></a>1. State the hypotheses</h4> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           H 
          
         
           0 
          
         
        
          : 
         
         
         
           μ 
          
          
          
            30 
           
          
            − 
           
          
            39 
           
          
         
        
          − 
         
         
         
           μ 
          
          
          
            20 
           
          
            − 
           
          
            29 
           
          
         
        
          = 
         
        
          0 
         
        
       
         H_0:\mu_{30-39}-\mu_{20-29}=0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.791661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           H 
          
         
           a 
          
         
        
          : 
         
         
         
           μ 
          
          
          
            30 
           
          
            − 
           
          
            39 
           
          
         
        
          − 
         
         
         
           μ 
          
          
          
            20 
           
          
            − 
           
          
            29 
           
          
         
        
          ≠ 
         
        
          0 
         
        
       
         H_a: \mu_{30-39}-\mu_{20-29}\ne 0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.791661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.902771em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span><br> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          μ 
         
        
       
         \mu 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span></span> stands for the mean pulse rate for the corresponding US population, and the <em>test statistic</em> of interest is thus the difference <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            x 
           
          
            ˉ 
           
          
          
          
            30 
           
          
            − 
           
          
            39 
           
          
         
        
          − 
         
         
          
          
            x 
           
          
            ˉ 
           
          
          
          
            20 
           
          
            − 
           
          
            29 
           
          
         
        
       
         \bar x_{30-39}-\bar x_{20-29} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.791661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.776111em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span></li><li>Equivalently, the hypotheses may be stated as: 
  <ul><li>Null hypothesis: the average pulse rate of people aged 20-29 is not different from the average pulse rate of people aged 30-39</li><li>Alternative hypothesis: the average pulse rate of people aged 20-29 is different from the average pulse rate of people aged 30-39.</li></ul> </li></ul> 
<h4><a id="2_Importing_and_examining_the_data_17"></a>2. Importing and examining the data</h4> 
<pre><code>- You can refer to the code and outputs below
</code></pre> 
<pre><code class="prism language-r"><span class="token comment"># load the data (.csv file located in the same file/working directory)</span>
nhanes <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"nhanes.csv"</span><span class="token punctuation">)</span>

<span class="token comment"># Examine the data</span>
head<span class="token punctuation">(</span>nhanes<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>nhanes<span class="token punctuation">)</span>
</code></pre> 
<table><thead><tr><th><img src="https://images2.imgbox.com/b8/cd/ol6XE3lk_o.jpg" alt=""></th><th>Fig.1 <code>head(nhanes)</code></th></tr></thead><tbody></tbody></table> 
<table><thead><tr><th><img src="https://images2.imgbox.com/08/ee/pY5SCjC3_o.jpg" alt=""></th><th>Fig.2 <code>summary(nhanes)</code></th></tr></thead><tbody></tbody></table> 
<h4><a id="3_Exploratory_analysis_of_the_data_36"></a>3. Exploratory analysis of the data</h4> 
<ul><li>From the boxplot below, we can infer that the test statistic is negative i.e. there is at least a difference in the means of the observed sample</li><li>-0.7768498 is this difference</li></ul> 
<pre><code class="prism language-r"><span class="token comment"># side-by-side boxplot our sample</span>
boxplot<span class="token punctuation">(</span>Pulse <span class="token operator">~</span> AgeDecade<span class="token punctuation">,</span> data <span class="token operator">=</span> nhanes<span class="token punctuation">,</span> horizontal <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> 
</code></pre> 
<table><thead><tr><th><img src="https://images2.imgbox.com/d9/4b/sliQqKZE_o.jpg" alt="boxplot(Pulse ~ AgeDecade, data = nhanes, horizontal = TRUE) "></th><th>Fig.2 <code>boxplot()</code></th></tr></thead><tbody></tbody></table> 
<pre><code class="prism language-r"><span class="token comment"># Calculating the test statistic of the sample</span>
elder <span class="token operator">&lt;-</span> nhanes<span class="token operator">$</span>Pulse<span class="token punctuation">[</span>nhanes<span class="token operator">$</span>AgeDecade<span class="token operator">==</span><span class="token string">"30-39"</span><span class="token punctuation">]</span>
elder_mean_pulse <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>elder<span class="token punctuation">)</span>

younger <span class="token operator">&lt;-</span> nhanes<span class="token operator">$</span>Pulse<span class="token punctuation">[</span>nhanes<span class="token operator">$</span>AgeDecade<span class="token operator">==</span><span class="token string">"20-29"</span><span class="token punctuation">]</span>
younger_mean_pulse <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>younger<span class="token punctuation">)</span>

obs_diff <span class="token operator">&lt;-</span> elder_mean_pulse <span class="token operator">-</span> younger_mean_pulse
obs_diff <span class="token comment">#  -0.7768498 is the result</span>
</code></pre> 
<h4><a id="4_Paramatrizing_60"></a>4. Paramatrizing</h4> 
<ul><li>Parametrizing the population under the null hypothesis of no difference using the obtained data</li><li>Because we assumed both groups of sample are from the same population, we can pool them together to estimate that hypothetical population. Moreover, since the sample is a random sample, we can assume the sample is representative of the “null population”, so the sample mean is going to estimate the population mean, and the sample standard deviation is going to estimate the population standard deviation.</li></ul> 
<pre><code class="prism language-r">mean <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>nhanes<span class="token operator">$</span>Pulse<span class="token punctuation">)</span>
mean <span class="token comment"># 75.15403</span>

sd <span class="token operator">&lt;-</span> sd<span class="token punctuation">(</span>nhanes<span class="token operator">$</span>Pulse<span class="token punctuation">)</span>
sd <span class="token comment"># 11.78723</span>
<span class="token comment"># N(mean = 75.15403, sd = 11.78723) is the null population </span>
</code></pre> 
<h4><a id="5_Executing_the_bootstrap_test_73"></a>5. Executing the bootstrap test</h4> 
<ul><li> <p>The general implementation is straightforward. However, I must mention one big thing to notice in this step (I’ve made this mistake in the past):<br> Because we have a two-tailed test, the order of your subtraction does not really matter (i.e. you can calculate either <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             x 
            
           
             ˉ 
            
           
           
           
             20 
            
           
             − 
            
           
             29 
            
           
          
         
           − 
          
          
           
           
             x 
            
           
             ˉ 
            
           
           
           
             30 
            
           
             − 
            
           
             39 
            
           
          
         
        
          \bar x_{20-29}-\bar x_{30-39} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.791661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.776111em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> or vice versa. Here, we assume we stritcly follow the hypotheses to use <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             x 
            
           
             ˉ 
            
           
           
           
             30 
            
           
             − 
            
           
             39 
            
           
          
         
           − 
          
          
           
           
             x 
            
           
             ˉ 
            
           
           
           
             20 
            
           
             − 
            
           
             29 
            
           
          
         
        
          \bar x_{30-39}-\bar x_{20-29} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.791661em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.776111em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, and we denote our observation to be <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           o 
          
         
           b 
          
         
           s 
          
         
           _ 
          
         
           d 
          
         
           i 
          
         
           f 
          
         
           f 
          
         
           = 
          
         
           − 
          
         
           0.7768498 
          
         
        
          obs\_diff = -0.7768498 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">s</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">−</span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span><span class="mord">9</span><span class="mord">8</span></span></span></span></span>. But one thing should always be implemented: you always want to make sure that when you are calculating the empirical <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           p 
          
         
        
          p 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span>-value, you are looking for the probability that, under the null hypothesis, a random sample produces a difference in sample means that is at least as extreme or more extreme than your observed sample’s difference, which means</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           P 
          
         
           ( 
          
          
           
            
            
              ( 
             
             
              
              
                x 
               
              
                ˉ 
               
              
              
              
                30 
               
              
                − 
               
              
                39 
               
              
             
            
              − 
             
             
              
              
                x 
               
              
                ˉ 
               
              
              
              
                20 
               
              
                − 
               
              
                29 
               
              
             
            
              = 
             
            
              o 
             
            
              b 
             
            
              s 
             
            
              _ 
             
            
              d 
             
            
              i 
             
            
              f 
             
            
              f 
             
            
              ) 
             
            
           
             ⏟ 
            
           
           
           
             a 
            
           
             s 
            
           
               
            
           
             e 
            
           
             x 
            
           
             t 
            
           
             r 
            
           
             e 
            
           
             m 
            
           
             e 
            
           
               
            
           
             a 
            
           
             s 
            
           
               
            
           
             o 
            
           
             u 
            
           
             r 
            
           
               
            
           
             o 
            
           
             b 
            
           
             s 
            
           
             e 
            
           
             r 
            
           
             v 
            
           
             a 
            
           
             t 
            
           
             i 
            
           
             o 
            
           
             n 
            
           
          
         
           ∨ 
          
          
           
            
            
              ( 
             
             
              
              
                x 
               
              
                ˉ 
               
              
              
              
                30 
               
              
                − 
               
              
                39 
               
              
             
            
              − 
             
             
              
              
                x 
               
              
                ˉ 
               
              
              
              
                20 
               
              
                − 
               
              
                29 
               
              
             
            
              &lt; 
             
            
              o 
             
            
              b 
             
            
              s 
             
            
              _ 
             
            
              d 
             
            
              i 
             
            
              f 
             
            
              f 
             
            
              ) 
             
            
              ∨ 
             
            
              ( 
             
             
              
              
                x 
               
              
                ˉ 
               
              
              
              
                30 
               
              
                − 
               
              
                39 
               
              
             
            
              − 
             
             
              
              
                x 
               
              
                ˉ 
               
              
              
              
                20 
               
              
                − 
               
              
                29 
               
              
             
            
              &gt; 
             
            
              o 
             
            
              b 
             
            
              s 
             
            
              _ 
             
            
              d 
             
            
              i 
             
            
              f 
             
            
              f 
             
            
           
             ⏟ 
            
           
           
           
             m 
            
           
             o 
            
           
             r 
            
           
             e 
            
           
               
            
           
             e 
            
           
             x 
            
           
             t 
            
           
             r 
            
           
             e 
            
           
             m 
            
           
             e 
            
           
               
            
           
             t 
            
           
             h 
            
           
             a 
            
           
             n 
            
           
               
            
           
             o 
            
           
             u 
            
           
             r 
            
           
               
            
           
             o 
            
           
             b 
            
           
             s 
            
           
             e 
            
           
             r 
            
           
             v 
            
           
             a 
            
           
             t 
            
           
             i 
            
           
             o 
            
           
             n 
            
           
          
         
           ) 
          
         
           ∣ 
          
          
          
            H 
           
          
            0 
           
          
         
           ) 
          
         
        
          P(\underbrace {(\bar x_{30-39}-\bar x_{20-29}=obs\_diff)}_{as ~extreme ~as ~our ~observation} \lor \underbrace{(\bar x_{30-39}-\bar x_{20-29}&lt;obs\_diff) \lor (\bar x_{30-39}-\bar x_{20-29}&gt;obs\_diff}_{more~extreme~than~our ~observation})|H_0) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.39411em; vertical-align: -1.64411em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -1.35589em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">s</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">e</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">s</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">n</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="svg-align" style="top: -2.042em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"> 
                   <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice"> 
                    <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path> 
                   </svg></span><span class="brace-center" style="height: 0.548em;"> 
                   <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice"> 
                    <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path> 
                   </svg></span><span class="brace-right" style="height: 0.548em;"> 
                   <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice"> 
                    <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path> 
                   </svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">s</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.958em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.64411em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.39411em; vertical-align: -1.64411em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -1.35589em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">e</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">n</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="svg-align" style="top: -2.042em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;"> 
                   <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice"> 
                    <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path> 
                   </svg></span><span class="brace-center" style="height: 0.548em;"> 
                   <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice"> 
                    <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path> 
                   </svg></span><span class="brace-right" style="height: 0.548em;"> 
                   <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice"> 
                    <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path> 
                   </svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">s</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.56778em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">x</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">ˉ</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mbin mtight">−</span><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">s</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.958em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.64411em;"><span class=""></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>. Thus, we have two <code>abs()</code> function used in the line <code>empirical_p &lt;- mean(abs(diffs) &gt;= abs(obs_diff))</code> below.<br> Moreover, we have to <code>round()</code> the sampled values because the pulse rate should be integers</p> </li></ul> 
<pre><code class="prism language-r">diffs <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> seq_along<span class="token punctuation">(</span>diffs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  group1 <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>length<span class="token punctuation">(</span>elder<span class="token punctuation">)</span><span class="token punctuation">,</span>  mean <span class="token operator">=</span> mean<span class="token punctuation">,</span>sd <span class="token operator">=</span> sd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  group2 <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>length<span class="token punctuation">(</span>younger<span class="token punctuation">)</span><span class="token punctuation">,</span>mean <span class="token operator">=</span> mean<span class="token punctuation">,</span>sd <span class="token operator">=</span> sd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  diff <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>group1<span class="token punctuation">)</span> <span class="token operator">-</span> mean<span class="token punctuation">(</span>group2<span class="token punctuation">)</span>
  diffs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> diff
<span class="token punctuation">}</span>
empirical_p <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>diffs<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> abs<span class="token punctuation">(</span>obs_diff<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment"># notice the two abs() above</span>
<span class="token comment"># Moreover, recall that mean() applied </span>
<span class="token comment"># to a logical vector computes the proportion</span>
empirical_p <span class="token comment"># this is  0.241</span>
</code></pre> 
<h4><a id="6_Draw_conclusion_statistical_inference_95"></a>6. Draw conclusion (statistical inference)</h4> 
<ul><li>Given the assumption that random sampling is implemented, we do a parametric bootstrap test. The empirical p-value, obtained by drawing random samples from a normal distribution <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          N 
         
        
          ( 
         
        
          75.15403 
         
        
          , 
         
        
          11.78723 
         
        
          ) 
         
        
       
         N(75.15403, 11.78723) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mopen">(</span><span class="mord">7</span><span class="mord">5</span><span class="mord">.</span><span class="mord">1</span><span class="mord">5</span><span class="mord">4</span><span class="mord">0</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">.</span><span class="mord">7</span><span class="mord">8</span><span class="mord">7</span><span class="mord">2</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span> 10000 times, is <code>0.241</code>, which is large. This is weak evidence against the null hypothesis of no difference, so we fail to reject the null hypothesis and may suggest that there is no difference between the average pulse rate of people aged 20-29 and the average pulse rate of people aged 30-39.</li></ul> 
<h3><a id="Full_Code_99"></a>Full Code</h3> 
<pre><code class="prism language-r">nhanes <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"nhanes.csv"</span><span class="token punctuation">)</span>


head<span class="token punctuation">(</span>nhanes<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>nhanes<span class="token punctuation">)</span>


boxplot<span class="token punctuation">(</span>Pulse <span class="token operator">~</span> AgeDecade<span class="token punctuation">,</span> data <span class="token operator">=</span> nhanes<span class="token punctuation">,</span> horizontal <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> 


elder <span class="token operator">&lt;-</span> nhanes<span class="token operator">$</span>Pulse<span class="token punctuation">[</span>nhanes<span class="token operator">$</span>AgeDecade<span class="token operator">==</span><span class="token string">"30-39"</span><span class="token punctuation">]</span>
elder_mean_pulse <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>elder<span class="token punctuation">)</span>
younger <span class="token operator">&lt;-</span> nhanes<span class="token operator">$</span>Pulse<span class="token punctuation">[</span>nhanes<span class="token operator">$</span>AgeDecade<span class="token operator">==</span><span class="token string">"20-29"</span><span class="token punctuation">]</span>
younger_mean_pulse <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>younger<span class="token punctuation">)</span>
obs_diff <span class="token operator">&lt;-</span> elder_mean_pulse <span class="token operator">-</span> younger_mean_pulse
obs_diff


diffs <span class="token operator">&lt;-</span> rep<span class="token punctuation">(</span><span class="token keyword">NA</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> seq_along<span class="token punctuation">(</span>diffs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  group1 <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>length<span class="token punctuation">(</span>elder<span class="token punctuation">)</span><span class="token punctuation">,</span>  mean <span class="token operator">=</span> mean<span class="token punctuation">,</span>sd <span class="token operator">=</span> sd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  group2 <span class="token operator">&lt;-</span> round<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span>length<span class="token punctuation">(</span>younger<span class="token punctuation">)</span><span class="token punctuation">,</span>mean <span class="token operator">=</span> mean<span class="token punctuation">,</span>sd <span class="token operator">=</span> sd<span class="token punctuation">)</span><span class="token punctuation">)</span>
  diff <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>group1<span class="token punctuation">)</span> <span class="token operator">-</span> mean<span class="token punctuation">(</span>group2<span class="token punctuation">)</span>
  diffs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;-</span> diff
<span class="token punctuation">}</span>
empirical_p <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>diffs<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> abs<span class="token punctuation">(</span>obs_diff<span class="token punctuation">)</span><span class="token punctuation">)</span>
empirical_p
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fa7cf0af0f031adeecbf5d22503f05b0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MSP430第三十二章：Comp_B</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0302e284aa610132f2bbd53cf1685a4b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">H3C路由器-内/外网用户通过公网IP访问内部服务器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>