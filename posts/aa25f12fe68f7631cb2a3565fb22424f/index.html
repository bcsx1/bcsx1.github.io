<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos7下使用mycat实现mysql负载均衡和读写分离 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos7下使用mycat实现mysql负载均衡和读写分离" />
<meta property="og:description" content="一、前期工作 参考文章《Centos7下采用haproxy&#43;keepalived搭建mysql高可用负载均衡》
1、关闭防火墙和SELINUX（4台虚拟机）
2、设置yum源（4台虚拟机）
3、安装mysql（7.80、7.81、7.82）
二、Mysql一主两从配置 1、修改MySQL配置文件 在7.80、7.81、7.82的MySQL配置文件/etc/my.cnf分别增加下面这一段。
server-id=80 #任意自然数n，保证三台MySQL主机id不一样。
log-bin=mysql-bin #开启二进制日志
replicate-do-db=aa #要同步的数据库，默认所有库
保存后，重启mysql服务
sudo systemctl restart mysqld
或sudo service mysqld restart
2、查看主mysql（7.80）二进制日志 登录mysql -uroot -p
密码Lr12345!
mysql&gt; show master status;
3、在从mysql（7.81、7.82）告知二进制文件名与位置 mysql&gt; change master to
-&gt; master_host=&#39;192.168.7.80&#39;,
-&gt; master_user=&#39;root&#39;,
-&gt; master_password=&#39;Lr12345!&#39;,
-&gt; master_log_file=&#39;mysql-bin.000001&#39;,
-&gt; master_log_pos=154;
查看结果
mysql&gt; start slave;
mysql&gt; show slave status\G;
4、验证主从同步 192.168.7.80主MySQL操作：
mysql&gt;create database aa;
mysql&gt;use aa;
mysql&gt;create table tab1(id int auto_increment,name varchar(10),primary key(id));" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/aa25f12fe68f7631cb2a3565fb22424f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-02T09:46:20+08:00" />
<meta property="article:modified_time" content="2023-08-02T09:46:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos7下使用mycat实现mysql负载均衡和读写分离</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="676" src="https://images2.imgbox.com/8a/47/oIOxkwOi_o.jpg" width="1200"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="440" src="https://images2.imgbox.com/58/ab/keXWGoD0_o.png" width="487"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>一、前期工作</strong></strong></h3> 
<p style="text-align:left;"><strong>参考文章《Centos7下采用haproxy+keepalived搭建mysql高可用负载均衡》</strong></p> 
<p style="margin-left:.0001pt;text-align:left;">1、关闭防火墙和SELINUX（4台虚拟机）<br> 2、设置yum源（4台虚拟机）<br> 3、安装mysql（7.80、7.81、7.82）</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>二、Mysql一主两从配置</strong></strong></h3> 
<h4 style="margin-left:.0001pt;text-align:left;">1、修改MySQL配置文件</h4> 
<p style="margin-left:.0001pt;text-align:left;">在7.80、7.81、7.82的MySQL配置文件/etc/my.cnf分别增加下面这一段。</p> 
<p style="margin-left:.0001pt;text-align:left;">server-id=80 #任意自然数n，保证三台MySQL主机id不一样。</p> 
<p style="margin-left:.0001pt;text-align:left;">log-bin=mysql-bin   #开启二进制日志</p> 
<p style="margin-left:.0001pt;text-align:left;">replicate-do-db=aa   #要同步的数据库，默认所有库</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">保存后，重启mysql服务</p> 
<p style="margin-left:.0001pt;text-align:left;">sudo systemctl restart mysqld</p> 
<p style="margin-left:.0001pt;text-align:left;">或sudo service mysqld restart</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;">2、查看主mysql（7.80）二进制日志</h4> 
<p style="margin-left:.0001pt;text-align:left;">登录mysql -uroot -p</p> 
<p style="margin-left:.0001pt;text-align:left;">密码Lr12345!</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show master status;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;">3、在从mysql（7.81、7.82）告知二进制文件名与位置</h4> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; change master to</p> 
<p style="margin-left:.0001pt;text-align:left;">    -&gt; master_host='192.168.7.80',</p> 
<p style="margin-left:.0001pt;text-align:left;">    -&gt; master_user='root',</p> 
<p style="margin-left:.0001pt;text-align:left;">    -&gt; master_password='Lr12345!',</p> 
<p style="margin-left:.0001pt;text-align:left;">    -&gt; master_log_file='mysql-bin.000001',</p> 
<p style="margin-left:.0001pt;text-align:left;">    -&gt; master_log_pos=154;</p> 
<p style="margin-left:.0001pt;text-align:left;">查看结果</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; start slave;</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show slave status\G;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;">4、验证主从同步</h4> 
<p style="margin-left:.0001pt;text-align:left;">192.168.7.80主MySQL操作：</p> 
<p style="margin-left:.0001pt;text-align:left;">            mysql&gt;create database aa;</p> 
<p style="margin-left:.0001pt;text-align:left;">            mysql&gt;use aa;</p> 
<p style="margin-left:.0001pt;text-align:left;">            mysql&gt;create table tab1(id int auto_increment,name varchar(10),primary key(id));</p> 
<p style="margin-left:.0001pt;text-align:left;">            mysql&gt;show databases;</p> 
<p style="margin-left:.0001pt;text-align:left;">            mysql&gt;show tables;</p> 
<p style="margin-left:.0001pt;text-align:left;">在7.80数据库aa上写入数据，看是否同步到7.81和7.82中。</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>三、7.83上安装Mycat</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:left;">#安装Java环境(mycat基于java)</p> 
<p style="margin-left:.0001pt;text-align:left;">yum install java-1.8.0-openjdk.x86_64</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#将下载的mycat安装包拷到/usr/local/ 并解压</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /usr/local</p> 
<p style="margin-left:.0001pt;text-align:left;"> tar -zxvf Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"># 创建专门运行mycat账号</p> 
<p style="margin-left:.0001pt;text-align:left;">adduser mycat</p> 
<p style="margin-left:.0001pt;text-align:left;"># 切换到mycat文件夹路径下</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /usr/local</p> 
<p style="margin-left:.0001pt;text-align:left;"># 将文件权限赋给mycat账号</p> 
<p style="margin-left:.0001pt;text-align:left;">chown mycat:mycat -R mycat</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#配置环境变量，最后面添加</p> 
<p style="margin-left:.0001pt;text-align:left;">vim /etc/profile</p> 
<p style="margin-left:.0001pt;text-align:left;">export JAVA_HOME=/usr</p> 
<p style="margin-left:.0001pt;text-align:left;">export MYCAT_HOME=/usr/local/mycat</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"># 刷新环境变量文件</p> 
<p style="margin-left:.0001pt;text-align:left;">source /etc/profile</p> 
<p style="margin-left:.0001pt;text-align:left;"># 切换mycat用户</p> 
<p style="margin-left:.0001pt;text-align:left;">su mycat</p> 
<p style="margin-left:.0001pt;text-align:left;">#切换目录</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /usr/local/mycat/bin/</p> 
<p style="margin-left:.0001pt;text-align:left;">#启动mycat</p> 
<p style="margin-left:.0001pt;text-align:left;">./mycat start</p> 
<p style="margin-left:.0001pt;text-align:left;">#查看mycat运行状态</p> 
<p style="margin-left:.0001pt;text-align:left;">./mycat status</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>四、修改配置参数</strong></strong></h3> 
<h4 style="margin-left:.0001pt;text-align:left;">1、修改配置文件schema.xml</h4> 
<p style="margin-left:.0001pt;text-align:left;">vi /usr/local/mycat/conf/schema.xml</p> 
<p style="margin-left:.0001pt;text-align:left;">内容如下：</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;?xml version="1.0"?&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!DOCTYPE mycat:schema SYSTEM "schema.dtd"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;mycat:schema xmlns:mycat="http://io.mycat/"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;schema name="aa" checkSQLschema="false" sqlMaxLimit="100" dataNode="jgywnode"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;/schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;dataNode name="jgywnode" dataHost="jgywhost" database="aa" /&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;dataHost name="jgywhost" maxCon="1000" minCon="10" balance="3" writeType="0" dbType="mysql" dbDriver="native"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    </p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;writeHost host="master" url="192.168.7.80:3306" user="root" password="Lr12345!"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">            &lt;readHost host="slave" url="192.168.7.81:3306" user="root" password="Lr12345!"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">            &lt;readHost host="slave2" url="192.168.7.82:3306" user="root" password="Lr12345!"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;/writeHost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;/dataHost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/mycat:schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;">2、修改配置文件server.xml</h4> 
<p style="margin-left:.0001pt;text-align:left;">vi /usr/local/mycat/conf/server.xml</p> 
<p style="margin-left:.0001pt;text-align:left;">内容如下：</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- - - Licensed under the Apache License, Version 2.0 (the "License");</p> 
<p style="margin-left:.0001pt;text-align:left;">- you may not use this file except in compliance with the License. - You</p> 
<p style="margin-left:.0001pt;text-align:left;">may obtain a copy of the License at - - http://www.apache.org/licenses/LICENSE-2.0</p> 
<p style="margin-left:.0001pt;text-align:left;">- - Unless required by applicable law or agreed to in writing, software -</p> 
<p style="margin-left:.0001pt;text-align:left;">distributed under the License is distributed on an "AS IS" BASIS, - WITHOUT</p> 
<p style="margin-left:.0001pt;text-align:left;">WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. - See the</p> 
<p style="margin-left:.0001pt;text-align:left;">License for the specific language governing permissions and - limitations</p> 
<p style="margin-left:.0001pt;text-align:left;">under the License. --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!DOCTYPE mycat:server SYSTEM "server.dtd"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;mycat:server xmlns:mycat="http://io.mycat/"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;system&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="nonePasswordLogin"&gt;0&lt;/property&gt; &lt;!-- 0为需要密码登陆、1为不需要密码登陆 ,默认为0，设置为1则需要指定默认账户--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="ignoreUnknownCommand"&gt;0&lt;/property&gt;&lt;!-- 0遇上没有实现的报文(Unknown command:),就会报错、1为忽略该报文，返回ok报文。</p> 
<p style="margin-left:.0001pt;text-align:left;">在某些mysql客户端存在客户端已经登录的时候还会继续发送登录报文,mycat会报错,该设置可以绕过这个错误--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useHandshakeV10"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;property name="removeGraveAccent"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useSqlStat"&gt;0&lt;/property&gt;  &lt;!-- 1为开启实时统计、0为关闭 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useGlobleTableCheck"&gt;0&lt;/property&gt;  &lt;!-- 1为开启全加班一致性检测、0为关闭 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sqlExecuteTimeout"&gt;300&lt;/property&gt;  &lt;!-- SQL 执行超时 单位:秒--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sequnceHandlerType"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="sequnceHandlerPattern"&gt;(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">INSERT INTO `travelrecord` (`id`,user_id) VALUES ('next value for MYCATSEQ_GLOBAL',"xxx");</p> 
<p style="margin-left:.0001pt;text-align:left;">--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--必须带有MYCATSEQ_或者 mycatseq_进入序列匹配流程 注意MYCATSEQ_有空格的情况--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sequnceHandlerPattern"&gt;(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="subqueryRelationshipCheck"&gt;false&lt;/property&gt; &lt;!-- 子查询中存在关联查询的情况下,检查关联字段中是否有分片字段 .默认 false --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sequenceHanlderClass"&gt;io.mycat.route.sequence.handler.HttpIncrSequenceHandler&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">      &lt;!--  &lt;property name="useCompression"&gt;1&lt;/property&gt;--&gt; &lt;!--1为开启mysql压缩协议--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;!--  &lt;property name="fakeMySQLVersion"&gt;5.6.20&lt;/property&gt;--&gt; &lt;!--设置模拟的MySQL版本号--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- &lt;property name="processorBufferChunk"&gt;40960&lt;/property&gt; --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="processors"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="processorExecutor"&gt;32&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"> --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;!--默认为type 0: DirectByteBufferPool | type 1 ByteBufferArena | type 2 NettyBufferPool --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="processorBufferPoolType"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--默认是65535 64K 用于sql解析时最大文本长度 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="maxStringLiteralLength"&gt;65535&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="sequnceHandlerType"&gt;0&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="backSocketNoDelay"&gt;1&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="frontSocketNoDelay"&gt;1&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="processorExecutor"&gt;16&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="serverPort"&gt;8066&lt;/property&gt; &lt;property name="managerPort"&gt;9066&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="idleTimeout"&gt;300000&lt;/property&gt; &lt;property name="bindIp"&gt;0.0.0.0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="dataNodeIdleCheckPeriod"&gt;300000&lt;/property&gt; 5 * 60 * 1000L; //连接空闲检查</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="frontWriteQueueSize"&gt;4096&lt;/property&gt; &lt;property name="processors"&gt;32&lt;/property&gt; --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--分布式事务开关，0为不过滤分布式事务，1为过滤分布式事务（如果分布式事务内只涉及全局表，则不过滤），2为不过滤分布式事务,但是记录分布式事务日志--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="serverPort"&gt;3310&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="managerPort"&gt;9066&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="handleDistributedTransactions"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--off heap for merge/order/group/limit      1开启   0关闭--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useOffHeapForMerge"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--单位为m--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;property name="memoryPageSize"&gt;64k&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--单位为k--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="spillsFileBufferSize"&gt;1k&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useStreamOutput"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--单位为m--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="systemReserveMemorySize"&gt;384m&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--是否采用zookeeper协调切换  --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useZKSwitch"&gt;false&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- XA Recovery Log日志路径 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="XARecoveryLogBaseDir"&gt;./&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- XA Recovery Log日志名称 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="XARecoveryLogBaseName"&gt;tmlog&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--如果为 true的话 严格遵守隔离级别,不会在仅仅只有select语句的时候在事务中切换连接--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="strictTxIsolation"&gt;false&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useZKSwitch"&gt;true&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--如果为0的话,涉及多个DataNode的catlet任务不会跨线程执行--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="parallExecute"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/system&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- 全局SQL防火墙设置 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--白名单可以使用通配符%或着*--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="127.0.0.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="127.0.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="127.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="1*7.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--这些配置情况下对于127.0.0.1都能以root账户登录--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;firewall&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;whitehost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">      &lt;host host="1*7.0.0.*" user="root"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;/whitehost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">       &lt;blacklist check="false"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">       &lt;/blacklist&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/firewall&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;user name="root" defaultAccount="true"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="password"&gt;Lr12345!&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="schemas"&gt;aa&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="defaultSchema"&gt;aa&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--No MyCAT Database selected 错误前会尝试使用该schema作为schema，不设置则为null,报错 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- 表级 DML 权限设置 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;privileges check="false"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;schema name="aa" dml="0110" &gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;table name="tb01" dml="0000"&gt;&lt;/table&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;table name="tb02" dml="1111"&gt;&lt;/table&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/privileges&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"> --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/user&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;user name="readonly"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="password"&gt;Lr12345!&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="schemas"&gt;aa&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="readOnly"&gt;true&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="defaultSchema"&gt;aa&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/user&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/mycat:server&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;">3、重启mycat</h4> 
<p style="margin-left:.0001pt;text-align:left;">#切换目录</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /usr/local/mycat/bin/</p> 
<p style="margin-left:.0001pt;text-align:left;">./mycat restart</p> 
<p style="margin-left:.0001pt;text-align:left;">#查看mycat状态</p> 
<p style="margin-left:.0001pt;text-align:left;">./mycat status</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>五、验证读写分离和负载均衡</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:left;">用客户端连192.168.7.83:3310</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>六、Mycat命令行监控</strong></strong></h3> 
<h4 style="margin-left:.0001pt;text-align:left;">1、7.83安装mysql</h4> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="text-align:left;">2、连接管理端口</h4> 
<p style="margin-left:.0001pt;text-align:left;">mysql -h192.168.7.83 -uroot -pLr12345! -P9066</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;">3、常见管理命令</h4> 
<p style="margin-left:.0001pt;text-align:left;">1) 查看mycat版本</p> 
<p style="margin-left:.0001pt;text-align:left;">show @@version;</p> 
<p style="margin-left:.0001pt;text-align:left;">2) 查看当前的库</p> 
<p style="margin-left:.0001pt;text-align:left;">show @@database;</p> 
<p style="margin-left:.0001pt;text-align:left;">3) 查看MyCAT数据节点的列表,dataNode节点：</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show @@datanode;</p> 
<p style="margin-left:.0001pt;text-align:left;">其中,“NAME”表示 dataNode 的名称;“dataHost”表示对应 dataHost 属性的值,即数据主机; “ACTIVE”表示活跃连接数;“IDLE”表示闲置连接数;“SIZE”对应总连接数量。</p> 
<p style="margin-left:.0001pt;text-align:left;">4) 查看心跳报告：</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show @@heartbeat;             该命令用于报告心跳状态</p> 
<p style="margin-left:.0001pt;text-align:left;">5) 查看Mycat的前端连接状态，即应用与mycat的连接：</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show @@connection\G</p> 
<p style="margin-left:.0001pt;text-align:left;">从上面获取到的连接 ID 属性，可以手动杀掉某个连接。</p> 
<p style="margin-left:.0001pt;text-align:left;">kill @@connection id,id,id</p> 
<p style="margin-left:.0001pt;text-align:left;">6) 显示后端连接状态：</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show @@backend\G</p> 
<p style="margin-left:.0001pt;text-align:left;">7) 显示数据源：</p> 
<p style="margin-left:.0001pt;text-align:left;">mysql&gt; show @@datasource;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>七、MyCAT-WEB</strong></strong><strong><strong>性能监控工具安装</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:left;">这里安装在7.83（与mycat同一台）</p> 
<p style="margin-left:.0001pt;text-align:left;">两个安装包：</p> 
<p style="margin-left:.0001pt;text-align:left;">apache-zookeeper-3.7.1-bin.tar.gz</p> 
<p style="margin-left:.0001pt;text-align:left;">Mycat-web-1.0-SNAPSHOT-20170102153329-linux.tar.gz</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>1、安装zookeeper</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;">#1下载安装包https://www.apache.org/dyn/closer.lua/zookeeper/zookeeper-3.7.1/apache-zookeeper-3.7.1-bin.tar.gz</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#2 安装包拷贝到Linux系统/root目录下，并解压</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /root</p> 
<p style="margin-left:.0001pt;text-align:left;">tar -zxvf apache-zookeeper-3.7.1-bin.tar.gz</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#3进入ZooKeeper解压后的配置目录（conf），复制配置文件并改名</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /root/apache-zookeeper-3.7.1-bin/conf</p> 
<p style="margin-left:.0001pt;text-align:left;">cp zoo_sample.cfg zoo.cfg</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#4 进入ZooKeeper的命令目录（bin），运行启动命令</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /root/apache-zookeeper-3.7.1-bin/bin</p> 
<p style="margin-left:.0001pt;text-align:left;">./zkServer.sh start</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#5 ZooKeeper服务端口为2181，查看服务已经启动</p> 
<p style="margin-left:.0001pt;text-align:left;">netstat -ant | grep 2181</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>2、安装</strong></strong><strong><strong>Mycat-web</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;">#1下载安装包</p> 
<p style="margin-left:.0001pt;text-align:left;">http://dl.mycat.org.cn/mycat-web-1.0/</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#2 安装包拷贝到Linux系统/usr/local目录下，并解压</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /usr/local</p> 
<p style="margin-left:.0001pt;text-align:left;">tar -zxvf Mycat-web-1.0-SNAPSHOT-20170102153329-linux.tar.gz</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#3进入mycat-web的目录下运行启动命令</p> 
<p style="margin-left:.0001pt;text-align:left;">cd /usr/local/mycat-web/</p> 
<p style="margin-left:.0001pt;text-align:left;">./start.sh &amp;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#4  Mycat-web服务端口为8082，查看服务已经启动</p> 
<p style="margin-left:.0001pt;text-align:left;">netstat -ant | grep 8082</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">#5 通过地址访问服务</p> 
<p style="margin-left:.0001pt;text-align:left;">http://192.168.7.83:8082/mycat/</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>3、设置mycat-eye</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;">Mycat服务管理</p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="152" src="https://images2.imgbox.com/5d/a6/ljtLKHXW_o.png" width="553"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">Mycat-VM管理</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p><img alt="" height="248" src="https://images2.imgbox.com/8c/89/0awMwi1R_o.png" width="553"> </p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">Mysql管理</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p> <img alt="" height="243" src="https://images2.imgbox.com/02/f3/Hi9D2u5Z_o.png" width="553"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>八、Mycat多库实现</strong></strong></h3> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>1、Schema.xml配置</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;">&lt;?xml version="1.0"?&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!DOCTYPE mycat:schema SYSTEM "schema.dtd"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;mycat:schema xmlns:mycat="http://io.mycat/"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;schema name="testbb" checkSQLschema="false" sqlMaxLimit="100" dataNode="dn1" &gt; &lt;/schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;schema name="666" checkSQLschema="false" sqlMaxLimit="100" dataNode="dn2" &gt; &lt;/schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;dataNode name="dn1" dataHost="localhost1" database="testbb"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;dataNode name="dn2" dataHost="localhost2" database="666"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    </p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;dataHost name="localhost1" maxCon="1000" minCon="10" balance="3" writeType="0" dbType="mysql" dbDriver="native"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;       </p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;writeHost host="master" url="192.168.7.80:3306" user="root" password="Lr12345!"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">            &lt;readHost host="slave" url="192.168.7.81:3306" user="root" password="Lr12345!"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">            &lt;readHost host="slave2" url="192.168.7.82:3306" user="root" password="Lr12345!"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;/writeHost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;/dataHost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;dataHost name="localhost2" maxCon="1000" minCon="10" balance="3" writeType="0" dbType="mysql" dbDriver="native"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;writeHost host="master" url="192.168.7.80:3306" user="root" password="Lr12345!"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">            &lt;readHost host="slave" url="192.168.7.81:3306" user="root" password="Lr12345!"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">            &lt;readHost host="slave2" url="192.168.7.82:3306" user="root" password="Lr12345!"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;/writeHost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;/dataHost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/mycat:schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>2、Server.xml配置</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- - - Licensed under the Apache License, Version 2.0 (the "License");</p> 
<p style="margin-left:.0001pt;text-align:left;">- you may not use this file except in compliance with the License. - You</p> 
<p style="margin-left:.0001pt;text-align:left;">may obtain a copy of the License at - - http://www.apache.org/licenses/LICENSE-2.0</p> 
<p style="margin-left:.0001pt;text-align:left;">- - Unless required by applicable law or agreed to in writing, software -</p> 
<p style="margin-left:.0001pt;text-align:left;">distributed under the License is distributed on an "AS IS" BASIS, - WITHOUT</p> 
<p style="margin-left:.0001pt;text-align:left;">WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. - See the</p> 
<p style="margin-left:.0001pt;text-align:left;">License for the specific language governing permissions and - limitations</p> 
<p style="margin-left:.0001pt;text-align:left;">under the License. --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!DOCTYPE mycat:server SYSTEM "server.dtd"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;mycat:server xmlns:mycat="http://io.mycat/"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;system&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="nonePasswordLogin"&gt;0&lt;/property&gt; &lt;!-- 0为需要密码登陆、1为不需要密码登陆 ,默认为0，设置为1则需要指定默认账户--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="ignoreUnknownCommand"&gt;0&lt;/property&gt;&lt;!-- 0遇上没有实现的报文(Unknown command:),就会报错、1为忽略该报文，返回ok报文。</p> 
<p style="margin-left:.0001pt;text-align:left;">在某些mysql客户端存在客户端已经登录的时候还会继续发送登录报文,mycat会报错,该设置可以绕过这个错误--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useHandshakeV10"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">    &lt;property name="removeGraveAccent"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useSqlStat"&gt;0&lt;/property&gt;  &lt;!-- 1为开启实时统计、0为关闭 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useGlobleTableCheck"&gt;0&lt;/property&gt;  &lt;!-- 1为开启全加班一致性检测、0为关闭 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sqlExecuteTimeout"&gt;300&lt;/property&gt;  &lt;!-- SQL 执行超时 单位:秒--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sequnceHandlerType"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="sequnceHandlerPattern"&gt;(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">INSERT INTO `travelrecord` (`id`,user_id) VALUES ('next value for MYCATSEQ_GLOBAL',"xxx");</p> 
<p style="margin-left:.0001pt;text-align:left;">--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--必须带有MYCATSEQ_或者 mycatseq_进入序列匹配流程 注意MYCATSEQ_有空格的情况--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sequnceHandlerPattern"&gt;(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="subqueryRelationshipCheck"&gt;false&lt;/property&gt; &lt;!-- 子查询中存在关联查询的情况下,检查关联字段中是否有分片字段 .默认 false --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="sequenceHanlderClass"&gt;io.mycat.route.sequence.handler.HttpIncrSequenceHandler&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">      &lt;!--  &lt;property name="useCompression"&gt;1&lt;/property&gt;--&gt; &lt;!--1为开启mysql压缩协议--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;!--  &lt;property name="fakeMySQLVersion"&gt;5.6.20&lt;/property&gt;--&gt; &lt;!--设置模拟的MySQL版本号--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- &lt;property name="processorBufferChunk"&gt;40960&lt;/property&gt; --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="processors"&gt;1&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="processorExecutor"&gt;32&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"> --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;!--默认为type 0: DirectByteBufferPool | type 1 ByteBufferArena | type 2 NettyBufferPool --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="processorBufferPoolType"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--默认是65535 64K 用于sql解析时最大文本长度 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="maxStringLiteralLength"&gt;65535&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="sequnceHandlerType"&gt;0&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="backSocketNoDelay"&gt;1&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="frontSocketNoDelay"&gt;1&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="processorExecutor"&gt;16&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="serverPort"&gt;8066&lt;/property&gt; &lt;property name="managerPort"&gt;9066&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="idleTimeout"&gt;300000&lt;/property&gt; &lt;property name="bindIp"&gt;0.0.0.0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="dataNodeIdleCheckPeriod"&gt;300000&lt;/property&gt; 5 * 60 * 1000L; //连接空闲检查</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="frontWriteQueueSize"&gt;4096&lt;/property&gt; &lt;property name="processors"&gt;32&lt;/property&gt; --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--分布式事务开关，0为不过滤分布式事务，1为过滤分布式事务（如果分布式事务内只涉及全局表，则不过滤），2为不过滤分布式事务,但是记录分布式事务日志--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="serverPort"&gt;3310&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="managerPort"&gt;9066&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="handleDistributedTransactions"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--off heap for merge/order/group/limit      1开启   0关闭--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useOffHeapForMerge"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--单位为m--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">        &lt;property name="memoryPageSize"&gt;64k&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--单位为k--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="spillsFileBufferSize"&gt;1k&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useStreamOutput"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--单位为m--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="systemReserveMemorySize"&gt;384m&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--是否采用zookeeper协调切换  --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useZKSwitch"&gt;false&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- XA Recovery Log日志路径 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="XARecoveryLogBaseDir"&gt;./&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- XA Recovery Log日志名称 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--&lt;property name="XARecoveryLogBaseName"&gt;tmlog&lt;/property&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--如果为 true的话 严格遵守隔离级别,不会在仅仅只有select语句的时候在事务中切换连接--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="strictTxIsolation"&gt;false&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="useZKSwitch"&gt;true&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--如果为0的话,涉及多个DataNode的catlet任务不会跨线程执行--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="parallExecute"&gt;0&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/system&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- 全局SQL防火墙设置 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--白名单可以使用通配符%或着*--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="127.0.0.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="127.0.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="127.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--例如&lt;host host="1*7.*" user="root"/&gt;--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--这些配置情况下对于127.0.0.1都能以root账户登录--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;firewall&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;whitehost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">      &lt;host host="1*7.0.0.*" user="root"/&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">   &lt;/whitehost&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">       &lt;blacklist check="false"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">       &lt;/blacklist&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/firewall&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">--&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;user name="root" defaultAccount="true"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="password"&gt;Lr12345!&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="schemas"&gt;testbb,666&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="defaultSchema"&gt;666&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--No MyCAT Database selected 错误前会尝试使用该schema作为schema，不设置则为null,报错 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!-- 表级 DML 权限设置 --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;!--</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;privileges check="false"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;schema name="aa" dml="0110" &gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;table name="tb01" dml="0000"&gt;&lt;/table&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;table name="tb02" dml="1111"&gt;&lt;/table&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/schema&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/privileges&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"> --&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/user&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;user name="readonly"&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="password"&gt;Lr12345!&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="schemas"&gt;testbb,666&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;property name="readOnly"&gt;true&lt;/property&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/user&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;">&lt;/mycat:server&gt;</p> 
<p style="margin-left:.0001pt;text-align:left;"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5d4a64bba0cdd2e64906d4477ae15bfd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python&#43;Playwright(Nuitka、Pyinstaller打包)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3f7d7548afc6d614822daefab670f486/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">六. Nacos 注册中心底层原理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>