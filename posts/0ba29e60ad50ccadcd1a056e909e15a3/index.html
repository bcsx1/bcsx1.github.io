<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>shell脚本学习 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="shell脚本学习" />
<meta property="og:description" content="shell是一个用 C 语言编写的程序，是用户使用 Linux 的桥梁。Shell 既是一种命令语言，又是一种程序设计语言。 实际上Shell是一个命令解释器，它解释由用户输入的命令并且把它们送到内核。不仅如此，Shell有自己的编程语言用于对命令的编辑，它允许用户编写由shell命令组成的程序。Shell编程语言具有普通编程语言的很多特点，比如它也有循环结构和分支控制结构等，用这种编程语言编写的Shell程序与其他应用程序具有同样的效果。 1、shell的分类 查看分类：cat /etc/shells
[root@localhost lk_test]# cat /etc/shells /bin/sh /bin/bash /usr/bin/sh /usr/bin/bash 在linux中有很多类型的shell，不同的shell具备不同的功能，shell还决定了脚本中函数的语法，linux中默认的shell是/bin/bash。流行的shell有ash、bash、ksh、csh、zsh等，不同的shell都有自己的特点以及用途。
编写规范：
#!/bin/bash	告知系统当前这个脚本要使用的shell解释器 Shell相关指令 文件命名规范：
文件名.sh # .sh是linux下bash shell 的默认后缀。
1.1、Bash 常用快捷键 快捷键作用ctrl&#43;A把光标移动到命令行开头。如果我们输入的命令过长，想要把光标移动到命令行开头时使用。ctrl&#43;E把光标移动到命令行结尾。ctrl&#43;C强制终止当前的命令。ctrl&#43;L清屏，相当于clear命令。ctrl&#43;U删除或剪切光标之前的命令。我输入了一行很长的命令，不用使用退格键一个一个字符的删除，使用这个快捷键会更加方便ctrl&#43;K删除或剪切光标之后的内容。ctrl&#43;Y粘贴ctrl&#43;U或ctul&#43;K剪切的内容。ctrl&#43;R在历史命令中搜索，按下ctrl&#43;R之后，就会出现搜索界面，只要输入搜索内容，就会从历史命令中搜索。ctrl&#43;D退出当前终端。ctrl&#43;Z暂停，并放入后台。这个快捷键牵扯工作管理的内容。ctrl&#43;S暂停屏幕输出。ctrl&#43;Q恢复屏幕输出。 1.2、输入输出重定向 linux 的标准输入与输出
设备设备名文件描述符作类型用键盘/dev/stdin0标准输入显示器/dev/stdout1标准输出显示器/dev/stderr2标准错误输出 输入重定向 ​ 输入重定向：是指不使用系统提供的标准输入端口，而进行重新的指定。换言之，就是不使用标准输入端口输入文件，而是使用指定的文件作为标准输入设备。（重定向简单理解就是使用 “&lt;”符来修改标准输入设备）.
类型符号（语法）功能标准输入命令 &lt; 文件1命令把文件1的内容作为标准输入设备标识符限定输入命令 &lt;&lt; 标识符命令把标准输入中读入内容，直到遇到“标识符”分解符为止输入输出重定向（同时使用）命令 &lt; 文件1 &gt; 文件2命令把文件1的内容作为标准输入，把文件2作为标准输出。 输出重定向 ​ 输出重定向：（通俗的讲，就是把要输出的文件信息写入到一个文件中去，而不是将要输出的文件信息输出到控制台（显示屏），在linux中，默认的标准输出设备是控制台（或称为显示器）,用户输出的信息默认情况下都会显示到控制台。
&amp;表示全部文件，文件不管对错；1表示标准输出文件；2表示标准错误输出。
类型符号（语法）作用标住输出重定向命令 &gt; 文件以覆盖方式，把命令的正确输出内容输出到指定的文件或设备当中标住输出重定向命令 &gt;&gt; 文件以追加方式，把命令的正确输出内容输出到指定的文件或设备当中标准错误输出重定向错误命令2 &gt; 文件以覆盖方式，把命令的错误输出输出到指定的文件或设备当中标准错误输出重定向错误命令2 &gt;&gt; 文件以追加方式，把命令的错误输出输出到指定的文件或设备当中正确输出和错误输出同时保存命令 &gt; 文件 2&gt;&amp;1以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中。正确输出和错误输出同时保存命令 &gt;&gt; 文件 2&gt;&amp;1以追加的方式，把正确输出和错误输出都保存到同一个文件当中。正确输出和错误输出同时保存命令 &amp;&gt; 文件以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中。正确输出和错误输出同时保存命令 &amp;&gt;&gt; 文件以追加的方式，把正确输出和错误输出都保存到同一个文件当中。正确输出和错误输出同时保存命令 &gt;&gt; 文件a 2&gt;&gt;文件2把正确的输出追加到文件a中，把错误的输出追加到文件2中。 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0ba29e60ad50ccadcd1a056e909e15a3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-11T23:31:45+08:00" />
<meta property="article:modified_time" content="2023-10-11T23:31:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">shell脚本学习</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code>	shell是一个用 C 语言编写的程序，是用户使用 Linux 的桥梁。Shell 既是一种命令语言，又是一种程序设计语言。
	实际上Shell是一个命令解释器，它解释由用户输入的命令并且把它们送到内核。不仅如此，Shell有自己的编程语言用于对命令的编辑，它允许用户编写由shell命令组成的程序。Shell编程语言具有普通编程语言的很多特点，比如它也有循环结构和分支控制结构等，用这种编程语言编写的Shell程序与其他应用程序具有同样的效果。
</code></pre> 
<h2><a id="1shell_2"></a>1、shell的分类</h2> 
<p>查看分类：<strong><code>cat /etc/shells</code></strong></p> 
<pre><code>[root@localhost lk_test]# cat /etc/shells
/bin/sh
/bin/bash
/usr/bin/sh
/usr/bin/bash
</code></pre> 
<p>在linux中有很多类型的shell，不同的shell具备不同的功能，shell还决定了脚本中函数的语法，<font color="red"><strong>linux中默认的shell是<code>/bin/bash</code></strong></font>。流行的shell有<strong>ash、bash、ksh、csh、zsh</strong>等，不同的shell都有自己的特点以及用途。</p> 
<p><strong>编写规范：</strong></p> 
<pre><code class="prism language-sh"><span class="token shebang important">#!/bin/bash	告知系统当前这个脚本要使用的shell解释器</span>
Shell相关指令
</code></pre> 
<p><strong>文件命名规范：</strong></p> 
<blockquote> 
 <p><strong>文件名.sh</strong> # .sh是linux下bash shell 的默认后缀。</p> 
</blockquote> 
<h3><a id="11Bash__26"></a>1.1、Bash 常用快捷键</h3> 
<table><thead><tr><th>快捷键</th><th>作用</th></tr></thead><tbody><tr><td>ctrl+A</td><td>把光标移动到命令行开头。如果我们输入的命令过长，想要把光标移动到命令行开头时使用。</td></tr><tr><td>ctrl+E</td><td>把光标移动到命令行结尾。</td></tr><tr><td><strong>ctrl+C</strong></td><td>强制终止当前的命令。</td></tr><tr><td><strong>ctrl+L</strong></td><td>清屏，相当于clear命令。</td></tr><tr><td><strong>ctrl+U</strong></td><td><strong>删除</strong>或剪切光标之前的命令。我输入了一行很长的命令，不用使用退格键一个一个字符的删除，使用这个快捷键会更加方便</td></tr><tr><td><strong>ctrl+K</strong></td><td><strong>删除</strong>或剪切光标之后的内容。</td></tr><tr><td><strong>ctrl+Y</strong></td><td>粘贴ctrl+U或ctul+K剪切的内容。</td></tr><tr><td>ctrl+R</td><td>在历史命令中搜索，按下ctrl+R之后，就会出现搜索界面，只要输入搜索内容，就会从历史命令中搜索。</td></tr><tr><td><strong>ctrl+D</strong></td><td>退出当前终端。</td></tr><tr><td>ctrl+Z</td><td>暂停，并放入后台。这个快捷键牵扯工作管理的内容。</td></tr><tr><td>ctrl+S</td><td>暂停屏幕输出。</td></tr><tr><td>ctrl+Q</td><td>恢复屏幕输出。</td></tr></tbody></table> 
<h3><a id="12_43"></a>1.2、输入输出重定向</h3> 
<p>linux 的标准输入与输出</p> 
<table><thead><tr><th>设备</th><th>设备名</th><th>文件描述符</th><th>作类型用</th></tr></thead><tbody><tr><td>键盘</td><td>/dev/stdin</td><td>0</td><td>标准输入</td></tr><tr><td>显示器</td><td>/dev/stdout</td><td>1</td><td>标准输出</td></tr><tr><td>显示器</td><td>/dev/stderr</td><td>2</td><td>标准错误输出</td></tr></tbody></table> 
<h4><a id="_53"></a>输入重定向</h4> 
<p>​ <strong>输入重定向</strong>：是指不使用系统提供的标准输入端口，而进行重新的指定。换言之，就是不使用标准输入端口输入文件，而是使用指定的文件作为标准输入设备。（重定向简单理解就是使用 “<strong><font color="red">&lt;</font></strong>”符来修改标准输入设备）.</p> 
<table><thead><tr><th>类型</th><th>符号（语法）</th><th>功能</th></tr></thead><tbody><tr><td>标准输入</td><td>命令 &lt; 文件1</td><td>命令把文件1的内容作为标准输入设备</td></tr><tr><td>标识符限定输入</td><td>命令 &lt;&lt; 标识符</td><td>命令把标准输入中读入内容，直到遇到“标识符”分解符为止</td></tr><tr><td>输入输出重定向（同时使用）</td><td>命令 &lt; 文件1 &gt; 文件2</td><td>命令把文件1的内容作为标准输入，把文件2作为标准输出。</td></tr></tbody></table> 
<h4><a id="_63"></a>输出重定向</h4> 
<p>​ 输出重定向：（通俗的讲，就是把要输出的文件信息写入到一个文件中去，而不是将要输出的文件信息输出到控制台（显示屏），在linux中，默认的标准输出设备是控制台（或称为显示器）,用户输出的信息默认情况下都会显示到控制台。</p> 
<p><font color="blue"><strong>&amp;表示全部文件，文件不管对错；1表示标准输出文件；2表示标准错误输出。</strong></font></p> 
<table><thead><tr><th>类型</th><th>符号（语法）</th><th>作用</th></tr></thead><tbody><tr><td>标住输出重定向</td><td>命令 <strong>&gt;</strong> 文件</td><td><font color="blue"><strong>以覆盖方式</strong></font>，把命令的正确输出内容输出到指定的文件或设备当中</td></tr><tr><td>标住输出重定向</td><td>命令 <strong>&gt;&gt;</strong> 文件</td><td><font color="blue"><strong>以追加方式</strong></font>，把命令的正确输出内容输出到指定的文件或设备当中</td></tr><tr><td>标准错误输出重定向</td><td>错误命令2 &gt; 文件</td><td>以覆盖方式，把命令的错误输出输出到指定的文件或设备当中</td></tr><tr><td>标准错误输出重定向</td><td>错误命令2 &gt;&gt; 文件</td><td>以追加方式，把命令的错误输出输出到指定的文件或设备当中</td></tr><tr><td>正确输出和错误输出同时保存</td><td>命令 &gt; 文件 2&gt;&amp;1</td><td>以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中。</td></tr><tr><td>正确输出和错误输出同时保存</td><td>命令 &gt;&gt; 文件 2&gt;&amp;1</td><td>以追加的方式，把正确输出和错误输出都保存到同一个文件当中。</td></tr><tr><td>正确输出和错误输出同时保存</td><td>命令 &amp;&gt; 文件</td><td>以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中。</td></tr><tr><td>正确输出和错误输出同时保存</td><td>命令 &amp;&gt;&gt; 文件</td><td>以追加的方式，把正确输出和错误输出都保存到同一个文件当中。</td></tr><tr><td>正确输出和错误输出同时保存</td><td>命令 &gt;&gt; 文件a 2&gt;&gt;文件2</td><td>把正确的输出追加到文件a中，把错误的输出追加到文件2中。</td></tr></tbody></table> 
<h3><a id="13devnull__81"></a>1.3、/dev/null 文件</h3> 
<p>如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到**/dev/null**中</p> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@localhost ~]</span>$  command &gt; dev/null
</code></pre> 
<h3><a id="14_89"></a>1.4、多命令顺序执行</h3> 
<table><thead><tr><th>多命令执行符</th><th>作用</th><th>格式</th></tr></thead><tbody><tr><td>；</td><td>命令1 ；命令2</td><td>多个命令顺序执行，命令之间没有任何逻辑联系。</td></tr><tr><td>&amp;&amp;</td><td>命令1 &amp;&amp; 命令2</td><td>当命令1正确执行（? = 0 ） ， 则 命 令 2 才 会 执 行；<br>当 命 令 1 执 行 不 正 确 （ ?≠0），则命令2才会执行 。</td></tr><tr><td>ll</td><td>命令1 || 命令2</td><td>当命令1执行不正确（? ≠ 0 ） ， 则 命 令 2 才 会 执 行;<br>当命令1正 确 执 行 （ ?=0），则命令2不会执行。</td></tr></tbody></table> 
<h3><a id="15shell_96"></a>1.5、两种方式执行shell脚本</h3> 
<p>第一种：给文件增加执行权限</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">chmod</span> u+x test.sh
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ ./test.sh  <span class="token comment">#绝对路径或相对路径执行</span>
</code></pre> 
<p>第二种（了解）：通过Bash调用执行脚本</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">bash</span> test.sh
</code></pre> 
<h2><a id="2shell_112"></a>2、shell变量</h2> 
<p><strong>变量：</strong> 在一个脚本周期内,其值可以发生改变的量。</p> 
<h3><a id="21_116"></a>2.1、变量的命名规则：</h3> 
<p>在定义变量时，有一些规则需要遵守:</p> 
<blockquote> 
 <ol><li>命名只能使用英文**<font color="blue">字母，数字和下划线</font>**，首个字符不能以数字开头。</li><li><font color="blue"><strong>等号左右两侧不能有空格</strong></font>，可以使用下划线“_”，变量的值如果有空格，需要使用单引号或双引号包括。如:“test=“hello world!””。其中双引号括起来的内容“$”，“(”和反引号都拥有特殊含义，而<strong>单引号括起来的内容都是普通字符。</strong></li><li>不能使用标点符号，不能使用bash里的关键字（可用help命令查看保留关键字）。</li><li><strong>环境变量建议大写</strong>，便于区分。</li><li>如果需要增加变量的值，那么可以进行变量值的叠加。不过变量需要用双引号包含<font color="blue"><strong>"<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             变量名 
            
           
             " 
            
           
             或用 
            
           
          
            变量名"或用 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord cjk_fallback">变量名</span><span class="mord">"</span><span class="mord cjk_fallback">或用</span></span></span></span></span>{变量名}</strong></font>包含变量名。</li></ol> 
</blockquote> 
<p><strong>关于单双引号的问题：</strong></p> 
<blockquote> 
 <ul><li>双引号能够识别变量，双引号能够实现转义（类似于“\*”）。</li><li>单引号是不能识别变量，只会原样输出，单引号是不能转义的。</li></ul> 
</blockquote> 
<p>示例：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token number">123</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$test</span>"</span><span class="token number">456</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$test</span>
<span class="token number">123456</span>
<span class="token comment">#叠加变量test，变量值变成了123456</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">test</span><span class="token operator">=</span><span class="token variable">${test}</span><span class="token number">789</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$test</span>
<span class="token number">123456789</span>
<span class="token comment">#再叠加变量test，变量值编程了123456789</span>
</code></pre> 
<h3><a id="22shell_146"></a>2.2、shell中特殊符号</h3> 
<table><thead><tr><th>符号</th><th>作用</th></tr></thead><tbody><tr><td>’ ’</td><td>单引号。在单引号中所有的特殊符号，如“$”和”(反引号)都没有特殊含义。单引号括起来的都是普通字符，会原样输出。</td></tr><tr><td>" "</td><td>双引号。在双引号中特殊符号都没有特殊含义，但是“$”，“`”（esc键下面）和“\”是例外，拥有“调用变量的值”、“引用命令”和“转义符”的特殊含义。</td></tr><tr><td>· ·</td><td>反引号。<font color="blue"><strong>反引号括起来的内容是系统命令</strong></font>，<strong>在Bash中会先执行它</strong>。和( ) 作 用 一 样 ， 不 过 推 荐 使 用 ()作用一样，不过推荐使用()作用一样，不过推荐使用()，因为反引号非常容易看错。</td></tr><tr><td><strong>$()</strong></td><td>和反引号作用一样，用来<font color="blue"><strong>引用系统命令</strong></font>。(<strong>推荐使用)</strong></td></tr><tr><td>()</td><td>用于一串命令执行时，()中的命令会在子Shell中运行。</td></tr><tr><td>{}</td><td>用于一串命令执行时，{ }中的命令会在当前Shell中执行。也可以用于变量变形与替换。</td></tr><tr><td>[ ]</td><td>用于变量的测试。</td></tr><tr><td>#</td><td>在Shell脚本中，#开头的行代表注释。</td></tr><tr><td>$</td><td>用于调用变量的值，如需要调用变量name的值时，需要用$name的方式得到变量的值。</td></tr><tr><td>\</td><td>转义符，跟在\之后的特殊符号将失去特殊含义，变为普通字符。如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            将输出“ 
           
          
         
           将输出“ 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord cjk_fallback">将输出</span><span class="mord">“</span></span></span></span></span>”符号，而不当做是变量引用。</td></tr><tr><td><strong>$(())</strong></td><td>是用来进行数学运算的。其等价于**<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            [ 
           
          
            ] 
           
          
            ∗ 
           
          
            ∗ 
           
          
            ，支持 
           
          
            + 
           
          
            − 
           
          
            ∗ 
           
          
            / 
           
          
         
           []**，支持+-*/%，并且在使用中变量可以不使用 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;"></span><span class="mord">∗</span><span class="mord cjk_fallback">，支持</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span></span></span></span></span>，直接使用变量名即可。如：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            ( 
           
          
            ( 
           
          
         
           (( 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">((</span></span></span></span></span>a+<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            b 
           
          
            ) 
           
          
            ) 
           
          
            、 
           
          
         
           b)) 、 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">))</span><span class="mord cjk_fallback">、</span></span></span></span></span>((a+b))、$[a+b]</td></tr></tbody></table> 
<p><strong>示例1：单引号和双引号</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">name</span><span class="token operator">=</span>sc
<span class="token comment">#定义变量name 的值是sc（就是最正直的人，超哥我了!）</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">'$name'</span>
<span class="token variable">$name</span>
<span class="token comment">#如果输出时使用单引号，则$name原封不动的输出</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$name</span>"</span>
sc
<span class="token comment">#如果输出时使用双引号，则会输出变量name的值 sc</span>

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span>
<span class="token number">2018</span>年10月21日星期一18:16:33 CST
<span class="token comment">#反引号括起来的命令会正常执行</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">'`date`'</span>
<span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span>
<span class="token comment">#但是如果反引号命令被单引号括起来，那么这个命令不会执行，`date`会被当成普通字符输出</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> "`date'"
<span class="token number">2018</span>年10月21日星期一18:14:21 CST
<span class="token comment">#如果是双引号括起来，那么这个命令又会正常执行</span>
</code></pre> 
<p><strong>示例2：反引号</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token function">ls</span>
<span class="token function">ls</span>
<span class="token comment">#如果命令不用反引号包含，命令不会执行，而是直接输出</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span>
anaconda-ks.cfginstall.loginstall.log.syslog <span class="token function">sh</span> <span class="token builtin class-name">test</span> testfile
<span class="token comment">#只有用反引号包括命令，这个命令才会执行</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span><span class="token variable">)</span></span>
<span class="token number">2018</span>年10月21日星期一18:25:09 CST
<span class="token comment">#使用$(命令)的方式也是可以的</span>

</code></pre> 
<h3><a id="23_200"></a>2.3、变量的分类：</h3> 
<blockquote> 
 <ul><li><strong>用户自定义变量</strong>：是最常见的变量，由用户自由定义变量名和变量的值。</li><li><strong>环境变量</strong>：主要保存的是和系统操作环境相关的数据，比如当前登录用户，用户的家目录，命令的提示符等。环境变量的变量名可以自由定义，但是一般对系统起作用的环境变量的变量名是系统预先设定好的。</li><li><strong>位置参数变量</strong>：主要是用来向脚本当中传递参数或数据，变量名不能自定义，变量作用是固定的。</li><li><strong>预定义变量</strong>：是Bash中已经定义好的变量，变量名不能自定义，变量作用也是固定的。</li></ul> 
</blockquote> 
<table><thead><tr><th>变量分类</th><th>名称</th><th>作用</th><th>内容</th></tr></thead><tbody><tr><td>用户自定义变量</td><td>自定义</td><td>自定义</td><td>自定义</td></tr><tr><td>用户自定义环境变量</td><td>自定义</td><td>自定义</td><td>自定义</td></tr><tr><td>系统自带环境变量(/etc/profile)</td><td>确定</td><td>确定</td><td>自定义</td></tr><tr><td>位置参数变量</td><td>确定</td><td>自定义</td><td>自定义</td></tr><tr><td>预定义变量</td><td>确定</td><td>自定义</td><td>自定义</td></tr></tbody></table> 
<h4><a id="231_215"></a>2.3.1、用户自定义变量：</h4> 
<h5><a id="2311_217"></a>2.3.1.1、变量定义</h5> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">2name</span><span class="token operator">=</span><span class="token string">"li si"</span>
-bash: <span class="token assign-left variable">2name</span><span class="token operator">=</span>shen chao: <span class="token builtin class-name">command</span> not found
<span class="token comment">#变量名不能用数字开头</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ name <span class="token operator">=</span> <span class="token string">"li si"</span>
-bash: name: <span class="token builtin class-name">command</span> not found
<span class="token comment">#等号左右两侧不能有空格</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">name</span><span class="token operator">=</span>li si
-bash: chao: <span class="token builtin class-name">command</span> not found
<span class="token comment">#变量的值如果有空格，必须用引号包含</span>
</code></pre> 
<h5><a id="2312_231"></a>2.3.1.2、变量调用</h5> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"li si"</span>
<span class="token comment">#定义变量name</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$name</span> <span class="token comment">#调用变量使用  $变量名</span>
li si
<span class="token comment">#输出变量name的值</span>
</code></pre> 
<h5><a id="2313_241"></a>2.3.1.3、变量查看</h5> 
<blockquote> 
 <p>语法：<strong>set [选项]</strong></p> 
 <p><strong>选项:</strong></p> 
 <ul><li> <p>-u ：如果设定此选项，调用未声明变量时会报错（默认无任何提示）。</p> </li><li> <p>-x ：如果设定此选项，在命令执行之前，会把命令先输出一次。</p> </li><li> <p>+&lt;参数&gt;：取消某个set曾启动的参数。如：set +u</p> </li></ul> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token comment">#直接使用set 命令，会查询系统中所有的变量，包含用户自定义变量和环境变量</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">set</span>
<span class="token assign-left variable"><span class="token environment constant">BASH</span></span><span class="token operator">=</span>/bin/bash
…省略部分输出…
<span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">'shen chao'</span>

<span class="token comment">#当设置了-u选项后，如果调用没有设定的变量会有报错。默认是没有任何输出的。</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">set</span> <span class="token parameter variable">-u</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$file</span>
-bash: file: unbound variable

<span class="token comment">#如果设定了-x选项，会在每个命令执行之前，先把命令输出一次</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">set</span> <span class="token parameter variable">-x</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">ls</span>
+ls <span class="token parameter variable">--color</span><span class="token operator">=</span>auto
anaconda-ks.cfginstall.loginstall.log.syslog <span class="token function">sh</span> tdir testtestfile

<span class="token comment">#取消启动的x参数</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">set</span> +x
</code></pre> 
<h5><a id="2314_275"></a>2.3.1.4、变量删除</h5> 
<pre><code class="prism language-shell"><span class="token comment"># 删除某个变量</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">unset</span> 变量名
</code></pre> 
<h4><a id="232_282"></a>2.3.2、环境变量</h4> 
<h5><a id="2321_284"></a>2.3.2.1、环境变量设置</h5> 
<pre><code class="prism language-powershell"><span class="token comment"># 使用export声明的变量即是环境变量</span>
<span class="token namespace">[root@localhost ~]</span>$  export age=<span class="token string">"18"</span>
</code></pre> 
<h5><a id="2322_291"></a>2.3.2.2、环境变量查询和删除</h5> 
<p><strong>env命令和set命令的区别：</strong></p> 
<ul><li>set命令<strong>可以查看所有变量</strong>;</li><li>env命令<strong>只能查看环境变量</strong>。</li></ul> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">unset</span> gender   <span class="token comment">#删除环境变量gender</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">env</span> <span class="token operator">|</span> <span class="token function">grep</span> gender
</code></pre> 
<h5><a id="2322_303"></a>2.3.2.2、系统默认环境变量</h5> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">env</span>
<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>localhost.localdomain      <span class="token comment">#主机名</span>
<span class="token assign-left variable"><span class="token environment constant">SHELL</span></span><span class="token operator">=</span>/bin/bash                     <span class="token comment">#当前的shell</span>
<span class="token assign-left variable"><span class="token environment constant">TERM</span></span><span class="token operator">=</span>linux                          <span class="token comment">#终端环境</span>
<span class="token assign-left variable"><span class="token environment constant">HISTSIZE</span></span><span class="token operator">=</span><span class="token number">1000</span>                       <span class="token comment">#历史命令条数</span>
<span class="token assign-left variable">SSH_CLIENT</span><span class="token operator">=</span><span class="token number">192.168</span>.26.130 <span class="token number">4824</span> <span class="token number">22</span>   <span class="token comment">#当前操作环境是用ssh连接的，这里记录客户端ip</span>
<span class="token assign-left variable">SSH_TTY</span><span class="token operator">=</span>/dev/pts/1                  <span class="token comment">#ssh连接的终端时pts/1</span>
<span class="token assign-left variable"><span class="token environment constant">USER</span></span><span class="token operator">=</span>root                           <span class="token comment">#当前登录的用户</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>更多参数可以使用set和env命令查看<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
<h4><a id="233_317"></a>2.3.3、位置参数变量：</h4> 
<table><thead><tr><th>位置参数变量</th><th>作用</th></tr></thead><tbody><tr><td>$n</td><td><strong>n为数字</strong>，<font color="blue"><strong>$0表示当前 Shell 脚本程序的名称</strong></font>，<br>$1-9 代表第一到第九个参 数 , 10以上的参数需要用大括号包含 ，如： {10}</td></tr><tr><td>$*</td><td>这个变量<font color="blue"><strong>代表命令行中所有的参数</strong></font>，$把所有的参数<strong>看成一个整体</strong>。</td></tr><tr><td>$@</td><td>这个变量也<font color="blue"><strong>代表命令行中所有的参数</strong></font>，不过$@<strong>把每个参数区分对待</strong>。</td></tr><tr><td>$#</td><td>这个变量代表<font color="blue"><strong>命令行中所有参数的个数</strong></font>。</td></tr></tbody></table> 
<p><strong>示例1： $1 是给写的shell脚本传的第一个参数，$2 是给写的shell脚本传的第二个参数…</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vim</span> test.sh
<span class="token comment">#!/bin/sh</span>
<span class="token builtin class-name">echo</span> <span class="token string">"shell脚本本身的名字: <span class="token variable">$0</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"传给shell的第一个参数: <span class="token variable">$1</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"传给shell的第二个参数: <span class="token variable">$2</span>"</span>

<span class="token comment"># 保存退出后，在test.sh所在的目录下输入 bash test.sh 1 2</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">bash</span> test.sh <span class="token number">1</span> <span class="token number">2</span>
<span class="token comment"># 结果输出：</span>
shell脚本本身的名字: test.sh
传给shell的第一个参数: <span class="token number">0</span>
传给shell的第二个参数: <span class="token number">1</span>
</code></pre> 
<p><strong>示例2：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ∗ 
         
        
          会把接收的所有参数当成一个整体对待，而 
         
        
       
         *会把接收的所有参数当成一个整体对待，而 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">∗</span><span class="mord cjk_fallback">会把接收的所有参数当成一个整体对待，而</span></span></span></span></span>@则会区分对待接收到的所有参数。</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> parameter2.sh
<span class="token comment">#!/bin/bash</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$*</span>"</span>
<span class="token comment">#定义for循环，in后面有几个值，for会循环多少次，注意“$*”要用双引号括起来</span>
<span class="token comment">#每次循环会把in后面的值赋予变量i</span>
<span class="token comment">#Shell把$*中的所有参数看成是一个整体，所以这个for循环只会循环一次</span>
	<span class="token keyword">do</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"The parameters is: <span class="token variable">$i</span>"</span>
		<span class="token comment">#打印变量$i的值</span>
	<span class="token keyword">done</span>
<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment">#定义变量x的值为1</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">y</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span>
<span class="token comment">#同样in后面的有几个值，for循环几次，每次都把值赋予变量y</span>
<span class="token comment">#可是Shell中把“$@”中的每个参数都看成是独立的，所以“$@”中有几个参数，就会循环几次</span>
	<span class="token keyword">do</span>
		<span class="token comment">#输出变量y的值</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"The parameter<span class="token variable">$x</span> is: <span class="token variable">$y</span>"</span>
		<span class="token comment">#然变量x每次循环都加1，为了输出时看的更清楚</span>
		<span class="token comment"># $(())是用来进行数学运算的。其等价于$[]</span>
		<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$x <span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>		
	<span class="token keyword">done</span>
	
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ ./parameter2.sh a b c d e
<span class="token comment"># 输出结果：</span>
The parameters is: a b c d e
The parameter1 is: a
The parameter2 is: b
The parameter3 is: c
The parameter4 is: d
The parameter5 is: e
</code></pre> 
<h4><a id="234_379"></a>2.3.4、预定义变量</h4> 
<table><thead><tr><th>预定义变量</th><th>作用</th></tr></thead><tbody><tr><td><font color="blue"><strong>$?</strong> </font></td><td>最后一次执行的命令的返回状态。如果这个变量的值为0，证明上一个命令正确执行;<br>如果这个变量的值为非0(具体是哪个数，由命令自己来决定），则证明上一个命令执行不正确了。</td></tr><tr><td><font color="blue"><strong>$$</strong></font></td><td>当前进程的进程号（PID)</td></tr><tr><td><font color="blue"><strong>$!</strong></font></td><td>后台运行的最后一个进程的进程号(PID)</td></tr></tbody></table> 
<p><strong>示例1：$?</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">ls</span>
count.sh hello.sh parameter2.sh parameter.sh
<span class="token comment">#ls命令正确执行</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token comment">#预定义变量“$?”的值是0，证明上一个命令执行正确</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">ls</span> install.log
ls:无法访问install.log:没有那个文件或目录
<span class="token comment">#当前目录中没有install.log文件，所以ls命令报错了</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token number">2</span>
<span class="token comment">#变量“$?”返回一个非О的值，证明上一个命令没有正确执行</span>
<span class="token comment">#至于错误的返回值到底是多少，是在编写ls命令时定义好的，如果碰到文件不存在就返回数值2</span>
</code></pre> 
<h3><a id="24_404"></a>2.4、只读变量</h3> 
<blockquote> 
 <p>**语法：**readonly (选项) (参数)</p> 
 <p><strong>选项：</strong></p> 
 <ul><li>-f：定义只读函数；</li><li>-a：定义只读数组变量；</li><li>-p：显示系统中全部只读变量列表。</li></ul> 
 <p><strong>参数：</strong></p> 
 <ul><li>变量定义：定义变量，格式为“<strong>变量名=‘变量值’</strong>”</li></ul> 
 <p>注意：</p> 
 <ul><li><strong>declare -r variable不能去除只读属性，unset不能删除只读变量。</strong></li><li><strong>只读变量不能更改内容，不能重设，只有当前shell注销后才失效。</strong></li></ul> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> readonly.sh
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token comment"># 定义只读变量 或者 readonly a=10</span>
<span class="token builtin class-name">readonly</span> a
<span class="token comment"># 给只读变量重新赋值，会报错readonly variable</span>
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">20</span>   
<span class="token builtin class-name">echo</span> <span class="token variable">$a</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ ./readonly.sh
<span class="token comment"># 输出结果</span>
./readonly.sh: line <span class="token number">6</span>: a: <span class="token builtin class-name">readonly</span> variable
<span class="token number">10</span>

<span class="token comment"># 显示所有只读变量</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># readonly     </span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-r</span> <span class="token assign-left variable"><span class="token environment constant">BASHOPTS</span></span><span class="token operator">=</span><span class="token string">"checkwinsize:cmdhist:expand_aliases:extquote:force_fignore:histappend:hostcomplete:interactive_comments:login_shell:progcomp:promptvars:sourcepath"</span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-ir</span> BASHPID
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-ar</span> <span class="token assign-left variable"><span class="token environment constant">BASH_VERSINFO</span></span><span class="token operator">=</span><span class="token string">'([0]="4" [1]="2" [2]="46" [3]="1" [4]="release" [5]="x86_64-redhat-linux-gnu")'</span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-ir</span> <span class="token assign-left variable"><span class="token environment constant">EUID</span></span><span class="token operator">=</span><span class="token string">"1102"</span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-ir</span> <span class="token assign-left variable"><span class="token environment constant">PPID</span></span><span class="token operator">=</span><span class="token string">"118456"</span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-r</span> <span class="token assign-left variable"><span class="token environment constant">SHELLOPTS</span></span><span class="token operator">=</span><span class="token string">"braceexpand:emacs:hashall:histexpand:history:interactive-comments:monitor"</span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-ir</span> <span class="token assign-left variable"><span class="token environment constant">UID</span></span><span class="token operator">=</span><span class="token string">"1102"</span>
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-r</span> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token string">"10"</span>
</code></pre> 
<h3><a id="25_449"></a>2.5、接受键盘输入</h3> 
<blockquote> 
 <p><strong>语法：<code>read [选项] [变量名]</code></strong><br> <strong>选项:</strong><br> -a 后跟一个变量 ：该变量会被认为是个数组，然后给其赋值，默认是以空格为分割符。<br> -p “提示信息”：在等待read输入时，输出提示信息。<br> -t 秒数：read命令会一直等待用户输入，使用此选项可以指定等待时间。<br> -n 数字：read命令只接受指定的字符数，就会执行。<br> -s ：隐藏输入的数据，适用于机密信息的输入。<br> -d ： 后面跟一个标志符，其实只有其后的第一个字符有用，作为结束的标志。<br> -e ： 在输入的时候可以使用命令补全功能。</p> 
 <p><strong>变量名:</strong><br> 变量名可以自定义，如果不指定变量名，会把输入保存入默认变量REPLY ；<br> 如果只提供了一个变量名，则整个输入行赋予该变量。<br> 如果提供了一个以上的变量名，则输入行分为若干字，一个接一个地赋予各个变量，而命令行上的最后一个变量取得剩余的所有字。</p> 
</blockquote> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-SHELL">[root@localhost ~]$ vi read.sh
#!/bin/bash
# 提示“请输入姓名”并等待30 秒（超时的话，会获取已输入的内容），把用户的输入保存入变量name 中
read -t 30 -p "Please input your name: " name
# 看看变量“$name”中是否保存了你的输入
echo "Name is $name"

# 提示“请输入年龄”并等待30秒，把用户的输入保存入变量age中,
# 年龄是隐私，所以我们用“-s”选项隐藏输入
read -s -t 30 -p "Please enter your age: " age
# 输出年龄前，先换一行
echo -e "\n"
echo "Age is $age"

# 提示“请选择性别”并等待30秒，把用户的输入保存入变量gender
# 使用“-n 1”选项只接收一个输入字符就会执行（都不用输入回车）
read -n 1 -t 30 -p "Please select your gender[M/F]:" gender
# 输出性别前，先换一行
echo -e "\n"
echo "Sex is $gender"

[appuser@iZ6uc01r2mgepqzn51on1sZ lk_test]$ ./read.sh 
#录入及输出结果
Please input your name: lisi
Name is lisi
Please enter your age: 

Age is 20
Please select your gender[M/F]:M

Sex is M
</code></pre> 
<h2><a id="3shell_502"></a>3、shell运算符</h2> 
<p>​ 在shell中，运算符和其他编程脚本语言一样，常见的有<strong>算数运算符、关系运算符、逻辑运算符、字符串运算符、文件测试运算符</strong> 等。</p> 
<h3><a id="31_506"></a>3.1、算数运算符</h3> 
<p>​ 原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 <strong>awk 和 expr，expr</strong> 最常用。</p> 
<p><font color="blue"><strong>expr 是一款表达式计算工具，使用它能完成表达式的求值操作</strong></font>。</p> 
<p>**示例1：**两个数相加(注意使用的是反引号 ` 而不是单引号 ')</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> computer.sh
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> <span class="token number">2</span> + <span class="token number">2</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">"两数之和为 : <span class="token variable">$val</span>"</span>
<span class="token comment">#注意</span>
<span class="token comment">#表达式和运算符之间要有空格，例如 2+2 是不对的，必须写成 2 + 2，这与我们熟悉的大多数编程语言不一样。</span>
<span class="token comment">#完整的表达式要被 ` ` 包含，注意这个字符不是常用的单引号，在 Esc 键下边。</span>
</code></pre> 
<p><strong>常用的算术运算符：（假定变量 a 为 10，变量 b 为 20）</strong></p> 
<table><thead><tr><th>运算符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>+</td><td>加法</td><td>expr $a + $b 结果为 30</td></tr><tr><td>-</td><td>减法</td><td>expr $a - $b 结果为 -10</td></tr><tr><td>*</td><td>乘法</td><td>expr $a * $b 结果为 200</td></tr><tr><td>/</td><td>除法</td><td>expr $b / $a 结果为 2</td></tr><tr><td>%</td><td>取余</td><td>expr $b % $a 结果为 0</td></tr><tr><td>=</td><td>赋值</td><td>a=$b 将把变量 b 的值赋给 a</td></tr><tr><td>==</td><td>相等。用于比较两个数字，相同则返回 true</td><td>[ $a == $b ] 返回 false</td></tr><tr><td>!=</td><td>不相等。用于比较两个数字，不相同则返回 true</td><td>[ $a != $b ] 返回 true</td></tr></tbody></table> 
<p><strong>注意：</strong><font color="blue"><strong>条件表达式要放在方括号之间，并且要有空格</strong>，必须写成 [ $a == $b ]</font></p> 
<p>示例：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> computers.sh
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token number">20</span>
<span class="token builtin class-name">echo</span> <span class="token string">'算术运算符测试'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'a+b= '</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a + $b<span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">'a-b= '</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a - $b<span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">'a*b= '</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a <span class="token punctuation">\</span>* $b<span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">'a/b= '</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a / $b<span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">'a%b= '</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a % $b<span class="token variable">`</span></span>

<span class="token comment">#判断是否相等</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">==</span> <span class="token variable">$b</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">'a等于b'</span>
<span class="token keyword">else</span>
	<span class="token builtin class-name">echo</span> <span class="token string">'a不等于b'</span>
<span class="token keyword">fi</span>
</code></pre> 
<h4><a id="311letexpr___562"></a>3.1.1、let、expr、[ ] 的使用</h4> 
<p><strong>关于这三个的区别和联系，文字说太烦，看达到同样效果，它们各自如何实现：</strong></p> 
<pre><code class="prism language-shell"><span class="token assign-left variable">a</span><span class="token operator">=</span>$<span class="token punctuation">[</span><span class="token number">1</span>+1<span class="token punctuation">]</span>
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
<span class="token builtin class-name">let</span> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">1</span>+1
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">expr</span> <span class="token number">1</span> + <span class="token number">1</span> <span class="token variable">)</span></span>
</code></pre> 
<h3><a id="32__573"></a>3.2、 关系运算符</h3> 
<p>​ 关系运算符<font color="blue"><strong>只支持数字，不支持字符串，除非字符串的值是数字</strong></font>。</p> 
<p><strong>常用的关系运算符：（假定变量 a 为 10，变量 b 为 20）</strong></p> 
<table><thead><tr><th>关系运算符</th><th>单词</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><strong>-eq</strong></td><td>equal</td><td>检测两个数是否相等，相等返回 true</td><td>[ $a -eq $b ] 返回 false</td></tr><tr><td><strong>-ne</strong></td><td>not equal</td><td>检测两个数是否相等，不相等返回 true</td><td>[ $a -ne $b ] 返回 true</td></tr><tr><td><strong>-gt</strong></td><td>great than</td><td>检测左边的数是否大于右边的，<br>如果是，则返回 true</td><td>[ $a -gt $b ] 返回 false</td></tr><tr><td><strong>-lt</strong></td><td>less than</td><td>检测左边的数是否小于右边的，<br>如果是，则返回 true</td><td>[ $a -lt $b ] 返回 true</td></tr><tr><td><strong>-ge</strong></td><td>great than or equal</td><td>检测左边的数是否大于等于右边的，<br>如果是，则返回 true</td><td>[ $a -ge $b ] 返回 false</td></tr><tr><td><strong>-le</strong></td><td>less than or equal</td><td>检测左边的数是否小于等于右边的，<br>如果是，则返回 true</td><td>[ $a -le $b ] 返回 true</td></tr></tbody></table> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token number">10</span> <span class="token parameter variable">-gt</span> <span class="token number">10</span> <span class="token punctuation">]</span> 
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span> <span class="token comment">#最后一次执行的命令的返回状态。返回0代表执行正确。</span>
 <span class="token number">1</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token number">10</span> <span class="token parameter variable">-eq</span> <span class="token number">10</span> <span class="token punctuation">]</span> 
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span> 
 <span class="token number">0</span>
</code></pre> 
<h3><a id="33_599"></a>3.3、逻辑运算符</h3> 
<p>​ <strong>常用的布尔运算符：（假定变量 a 为 10，变量 b 为 20）</strong></p> 
<table><thead><tr><th>逻辑运算符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>!</td><td><strong>非运算</strong>，表达式为 true 则返回 false，否则返回 true</td><td>[ ! false ] 返回 true</td></tr><tr><td>-o</td><td><strong>或（或者）运算</strong>，有一个表达式为 true 则返回 true</td><td>[ $a -lt 20 -o $b -gt 100 ] 返回 true</td></tr><tr><td>-a</td><td><strong>与（并且）运算</strong>，两个表达式都为 true 才返回 true</td><td>[ $a -lt 20 -a $b -gt 100 ] 返回 false</td></tr></tbody></table> 
<h3><a id="34_609"></a>3.4、字符串运算符</h3> 
<p><strong>常用的字符串运算符：（假定变量 a 为 “abc”，变量 b 为 “efg”）</strong></p> 
<table><thead><tr><th>运算符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>=</td><td>检测两个字符串是否相等，相等返回 true</td><td>[ $a = $b ] 返回 false</td></tr><tr><td>!=</td><td>检测两个字符串是否相等，不相等返回 true</td><td>[ $a != $b ] 返回 true</td></tr><tr><td>-z</td><td>检测字符串长度是否为0，为0返回 true</td><td>[ -z $a ] 返回 false</td></tr><tr><td>-n</td><td>检测字符串长度是否为0，不为0返回 true</td><td>[ -n $a ] 返回 true</td></tr><tr><td>$</td><td>检测字符串是否为空，不为空返回 true</td><td>[ $a ] 返回 true</td></tr></tbody></table> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-shell"> <span class="token comment"># 字符串长度是否为0,是则返回0[root@localhost ~]$ a="aaa"</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token string">"bbb"</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">${a}</span>"</span> <span class="token operator">=</span> <span class="token string">"{<!-- --><span class="token variable">$b</span>}"</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"is eaqual:<span class="token variable">$?</span>"</span>
is eaqual:1
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">${a}</span>"</span> <span class="token operator">!=</span> <span class="token string">"{<!-- --><span class="token variable">$b</span>}"</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"is no  eaqual:<span class="token variable">$?</span>"</span>
is no  eaqual:0
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">${a}</span>"</span> <span class="token punctuation">]</span> <span class="token comment"># 字符串长度是否为0，是则返回0</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"length is zero : <span class="token variable">$?</span>"</span>
length is zero <span class="token builtin class-name">:</span> <span class="token number">1</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">"<span class="token variable">${a}</span>"</span> <span class="token punctuation">]</span> <span class="token comment"># 字符串长度是否为0，不是则返回0</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"length is no  zero : <span class="token variable">$?</span>"</span>
length is no  zero <span class="token builtin class-name">:</span> <span class="token number">0</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token punctuation">]</span> <span class="token comment"># 字符串是否为空，不是则返回0</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token punctuation">]</span>
 <span class="token builtin class-name">echo</span> <span class="token string">"is empty:<span class="token variable">$?</span>"</span>
is empty:0
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$  <span class="token punctuation">[</span> $<span class="token string">"<span class="token variable">$b</span>"</span> <span class="token punctuation">]</span> <span class="token comment"># 字符串是否为空，不是则返回0</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"is empty:<span class="token variable">$?</span>"</span>
is empty:0
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">echo</span> <span class="token string">"string length : <span class="token variable">${<!-- --><span class="token operator">#</span>a}</span>"</span> <span class="token comment"># 输出变量a的长度</span>
string length <span class="token builtin class-name">:</span> <span class="token number">3</span>
</code></pre> 
<h3><a id="35_649"></a>3.5、文件测试运算符（重点）</h3> 
<p><strong>文件测试运算符用于检测 Unix/Linux 文件的各种属性。</strong></p> 
<table><thead><tr><th>操作符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>-b filename</td><td>检测文件是否是块设备文件，如果是，则返回 true</td><td>[ -b $file ] 返回 false</td></tr><tr><td>-c filename</td><td>检测文件是否是字符设备文件，如果是，则返回 true</td><td>[ -c $file ] 返回 false</td></tr><tr><td><font color="red"><strong>-d filename</strong></font></td><td>检测文件<font color="red"><strong>是否是目录</strong></font>，如果是，则返回 true</td><td>[ -d $file ] 返回 false</td></tr><tr><td><font color="red"><strong>-f filename</strong></font></td><td>检测文件**<font color="red">是否是普通文件</font>**（既不是目录，也不是设备文件），如果是，则返回 true</td><td>[ -f $file ] 返回 true</td></tr><tr><td>-g filename</td><td>检测文件是否设置了 SGID 位，如果是，则返回 true</td><td>[ -g $file ] 返回 false</td></tr><tr><td>-k filename</td><td>检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true</td><td>[ -k $file ] 返回 false</td></tr><tr><td>-p filename</td><td>检测文件是否是有名管道，如果是，则返回 true</td><td>[ -p $file ] 返回 false</td></tr><tr><td>-u filename</td><td>检测文件是否设置了 SUID 位，如果是，则返回 true</td><td>[ -u $file ] 返回 false</td></tr><tr><td><font color="red"><strong>-r filename</strong></font></td><td>检测文件<font color="red"><strong>是否可读</strong></font>，如果是，则返回 true</td><td>[ -r $file ] 返回 true</td></tr><tr><td><font color="red"><strong>-w filename</strong></font></td><td>检测文件<font color="red"><strong>是否可写</strong></font>，如果是，则返回 true</td><td>[ -w $file ] 返回 true</td></tr><tr><td><font color="red"><strong>-x filename</strong></font></td><td>检测文件<font color="red"><strong>是否可执行</strong></font>，如果是，则返回 true</td><td>[ -x $file ] 返回 true</td></tr><tr><td><font color="red"><strong>-s filename</strong></font></td><td>检测文件<font color="red"><strong>是否为空</strong></font>（文件大小是否大于0），不为空返回 true</td><td>[ -s $file ] 返回 true</td></tr><tr><td><font color="red"><strong>-e filename</strong></font></td><td>检测文件（包括目录）<font color="red"><strong>是否存在</strong></font>，如果是，则返回 true</td><td>[ -e $file ] 返回 true</td></tr></tbody></table> 
<h2><a id="4_669"></a>4、流程控制</h2> 
<h3><a id="41if_671"></a>4.1、if条件判断</h3> 
<h4><a id="411if_673"></a>4.1.1、单分支if条件</h4> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> 条件判断表达式 <span class="token punctuation">]</span>
	<span class="token keyword">then</span>
		程序
<span class="token keyword">fi</span>
</code></pre> 
<p><strong>示例1：统计根分区使用率</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> test_if_1.sh
<span class="token comment">#!/bin/bash</span>

<span class="token comment">#统计根分区使用率</span>
<span class="token assign-left variable">rate</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">df</span> <span class="token parameter variable">-h</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"/dev/vda1"</span> <span class="token operator">|</span> <span class="token function">awk</span> '<span class="token punctuation">{<!-- --></span>print $5<span class="token punctuation">}</span>’<span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">"%"</span> <span class="token parameter variable">-f1</span><span class="token variable">)</span></span>
<span class="token comment">#把根分区使用率作为变量值赋予变量rate</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$rate</span> <span class="token parameter variable">-ge</span> <span class="token number">80</span> <span class="token punctuation">]</span>
<span class="token comment">#判断rate的值如果大于等于80，则执行then程序</span>
	<span class="token keyword">then</span>
		<span class="token comment">#打印警告信息。在实际工作中，也可以向管理员发送邮件。</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"Warning!/dev/vda1 is fu11!!"</span>	
<span class="token keyword">fi</span>
</code></pre> 
<p><strong>示例2：创建目录</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> add_dir.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#创建目录，判断是否存在，存在就结束，反之创建</span>
<span class="token builtin class-name">echo</span> <span class="token string">"当前脚本名称为<span class="token variable">$0</span>"</span>
<span class="token assign-left variable">DIR</span><span class="token operator">=</span><span class="token string">"/media/cdrom"</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token variable">$DIR</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$DIR</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$DIR</span> 创建成功"</span>
</code></pre> 
<h4><a id="412if_716"></a>4.1.2、双分支if条件语句</h4> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> 条件判断式 <span class="token punctuation">]</span>
	<span class="token keyword">then</span>
		条件成立时，执行的程序
	<span class="token keyword">else</span>
		条件不成立时，执行的另一个程序
<span class="token keyword">fi</span>
</code></pre> 
<h4><a id="413if_729"></a>4.1.3、多分支if条件语句</h4> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> 条件判断式1 <span class="token punctuation">]</span>
	<span class="token keyword">then</span>
		当条件判断式1成立时，执行程序1
<span class="token keyword">elif</span> <span class="token punctuation">[</span> 条件判断式2 <span class="token punctuation">]</span>
	<span class="token keyword">then</span>
		当条件判断式2成立时，执行程序2
…省略更多条件…
<span class="token keyword">else</span>
	当所有条件都不成立时，最后执行此程序
<span class="token keyword">fi</span>
</code></pre> 
<h3><a id="42case_746"></a>4.2、多分支case条件语句</h3> 
<p>​ case语句和if…elif…else语句一样都是多分支条件语句，不过和if多分支条件语句不同的是，<strong>case语句只能判断一种条件关系</strong>，而if语句可以判断多种条件关系。</p> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">case</span> $变量名 <span class="token keyword">in</span>
	<span class="token string">"值1"</span><span class="token punctuation">)</span>
        如果变量的值等于值1，则执行程序1
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
	<span class="token string">"值2"</span><span class="token punctuation">)</span>
        如果变量的值等于值2，则执行程序2
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
	…省略其他分支…
	*<span class="token punctuation">)</span>
        如果变量的值都不是以上的值，则执行此程序
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre> 
<p>示例：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> if-case.sh
<span class="token comment">#!/bin/bash</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"请输入一个字符，并按Enter确认："</span> KEY
<span class="token keyword">case</span> <span class="token string">"<span class="token variable">$KEY</span>"</span> <span class="token keyword">in</span>
	<span class="token punctuation">[</span>a-z<span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span>A-Z<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"您输入的是字母"</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
	<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token builtin class-name">echo</span> <span class="token string">"您输入的是数字"</span>
		<span class="token punctuation">;</span><span class="token punctuation">;</span>
	*<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"您输入的是其他字符"</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre> 
<h3><a id="43for_786"></a>4.3、for循环</h3> 
<p>​ for循环是固定循环，也就是在循环时已经知道需要进行几次的循环，有时也把for循环称为计数循环。for的语法有如下两种:</p> 
<p><strong>语法1：</strong></p> 
<blockquote> 
 <ul><li>这种语法中for循环的次数，取决于in后面值的个数（空格分隔），有几个值就循环几次，并且每次循环都把值赋予变量。</li></ul> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token keyword">for</span> 变量 <span class="token keyword">in</span> 值1 值2 值3 …<span class="token punctuation">(</span>可以是一个文件等<span class="token punctuation">)</span>
	<span class="token keyword">do</span>
		程序
	<span class="token keyword">done</span>
</code></pre> 
<p><strong>语法2：</strong></p> 
<blockquote> 
 <ul><li>**初始值：**在循环开始时，需要给某个变量赋予初始值，如i=1;</li><li><strong>循环控制条件</strong>：用于指定变量循环的次数，如i&lt;=100，则只要i的值小于等于100，循环就会继续;</li><li><strong>变量变化</strong>：每次循环之后，变量该如何变化，如i=i+1。代表每次循环之后，变量i的值都加1。</li></ul> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> 初始值<span class="token punctuation">;</span>循环控制条件<span class="token punctuation">;</span>变量变化 <span class="token punctuation">))</span></span>
	<span class="token keyword">do</span>
		程序
	<span class="token keyword">done</span>
</code></pre> 
<p><strong>示例1：批量解压缩</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> auto-tar.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#批量解压脚本</span>
<span class="token comment">#进入压缩包目录</span>
<span class="token builtin class-name">cd</span> /lamp
<span class="token comment">#把所有.tar.gz结尾的文件的文件覆盖到ls.log 临时文件中</span>
<span class="token function">ls</span> *.tar.gz <span class="token operator">&gt;</span> ls.log
<span class="token comment">#或者这样写for i in `cat ls.log`</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> ls.log<span class="token variable">)</span></span> `
<span class="token comment">#读取ls.log文件的内容，文件中有多少个值，就会循环多少次，每次循环把文件名赋予变量i</span>
	<span class="token keyword">do</span>
		<span class="token function">tar</span> <span class="token parameter variable">-zxf</span> <span class="token variable">$i</span> <span class="token operator">&amp;&gt;</span>/dev/null
		<span class="token comment">#解压缩，并把所有输出都丢弃</span>
	<span class="token keyword">done</span>
<span class="token comment">#删除临时文件ls.log</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /lamp/ls.log
</code></pre> 
<p><strong>示例2：批量添加指定数量的用户</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> useradd.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#批量添加指定数量的用户</span>
<span class="token comment">#让用户输入用户名前缀，把输入保存入变量name</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"Please input user name: "</span> <span class="token parameter variable">-t</span> <span class="token number">30</span> name

<span class="token comment">#让用户输入添加用户的数量，把输入保存入变量num</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"Please input the number of users: "</span> <span class="token parameter variable">-t</span> <span class="token number">30</span> num

<span class="token comment">#让用户输入初始密码，把输入保存入变量pass</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"Please input the password of users: "</span> <span class="token parameter variable">-t</span> <span class="token number">30</span> pass

<span class="token comment">#判断三个变量不为空</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$name</span>"</span> <span class="token parameter variable">-a</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$num</span>"</span>-a <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$pass</span>"</span><span class="token punctuation">]</span>
	<span class="token keyword">then</span>
		<span class="token comment"># 定义变量的值为后续命令的结果。</span>
		<span class="token comment"># 后续命令作用是：把变量num的值中的数字替换为空。如果能替换为空，证明num的值为数字；如果不能替换为空，证明num的值为非数字。</span>
		<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $num <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/[0-9]//g'</span><span class="token variable">)</span></span>
		<span class="token comment">#如果变量y的值为空，证明num变量是数字</span>
		<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$y</span>"</span><span class="token punctuation">]</span>
			<span class="token keyword">then</span>
				<span class="token comment">#循环num变量指定的次数</span>
				<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>$num<span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">))</span></span>
				<span class="token keyword">do</span>
					/usr/sbin/useradd <span class="token variable">$name</span><span class="token variable">$i</span> <span class="token operator">&amp;&gt;</span>/dev/null
					<span class="token comment">#添加用户，用户名为变量name 的值加变量i的数字</span>
					<span class="token builtin class-name">echo</span> <span class="token variable">$pass</span> <span class="token operator">|</span> /usr/bin/passwd <span class="token parameter variable">--stdin</span> <span class="token variable">$name</span><span class="token variable">$i</span> <span class="token operator">&amp;&gt;</span>/dev/null
					<span class="token comment">#给用户设定初始密码为变量pass 的值</span>
				<span class="token keyword">done</span>
			<span class="token keyword">else</span> 
				<span class="token builtin class-name">echo</span> <span class="token string">"num 必须为纯数字！！！"</span>
		<span class="token keyword">fi</span>
	<span class="token keyword">else</span> 
		<span class="token builtin class-name">echo</span> <span class="token string">"name、num、password 均不能为空！！！"</span>
<span class="token keyword">fi</span>
</code></pre> 
<p><strong>示例3：批量删除用户</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> sh/userdel.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#批量删除用户</span>
<span class="token comment">#读取用户信息文件，提取可以登录用户，取消root用户，截取第一列用户名</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/passwd <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"/bin/bash"</span><span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">"root"</span><span class="token operator">|</span><span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">":"</span> <span class="token parameter variable">-f</span> <span class="token number">1</span><span class="token variable">)</span></span>
<span class="token comment">#循环，有多少个普通用户，循环多少次</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">$user</span>
	<span class="token keyword">do</span>
		<span class="token comment">#每次循环，删除指定普通用户</span>
		<span class="token function">userdel</span> <span class="token parameter variable">-r</span> <span class="token variable">$i</span>	
	<span class="token keyword">done</span>
</code></pre> 
<h3><a id="44_while_890"></a>4.4、 while循环</h3> 
<p>​ 对while循环来讲，只要条件判断式成立，循环就会一直继续，直到条件判断式不成立，循环才会停止。</p> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">while</span> <span class="token punctuation">[</span> 条件判断式 <span class="token punctuation">]</span>
	<span class="token keyword">do</span>
		程序
	<span class="token keyword">done</span>
</code></pre> 
<p><strong>示例：输入的数值进行比较判断</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> addnum.sh
<span class="token comment">#!/bin/bash</span>

<span class="token comment"># 说明：expr是一款表达式计算工具，使用它能完成表达式的求值操作&lt;/font&gt;</span>
<span class="token assign-left variable">PRICE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">expr</span> <span class="token environment constant">$RANDOM</span> % <span class="token number">1000</span><span class="token variable">)</span></span>
<span class="token assign-left variable">TIMES</span><span class="token operator">=</span><span class="token number">0</span>

<span class="token builtin class-name">echo</span> <span class="token string">"商品的价格为0-999之间，猜猜看是多少？"</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
<span class="token keyword">do</span>
  	<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"请输入您猜的价格："</span> INT
  	<span class="token comment"># let是用于计算的工具，用于执行一个或多个表达式。在计算中不用加$来表示变量。</span>
  	<span class="token builtin class-name">let</span> TIMES++
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$INT</span> <span class="token parameter variable">-eq</span> <span class="token variable">$PRICE</span> <span class="token punctuation">]</span> 
		<span class="token keyword">then</span>
	  		<span class="token builtin class-name">echo</span> <span class="token string">"恭喜您猜对了，实际价格是 <span class="token variable">$PRICE</span>"</span>
	  		<span class="token builtin class-name">echo</span> <span class="token string">"您总共猜了 <span class="token variable">$TIMES</span> 次"</span>
			<span class="token builtin class-name">exit</span> <span class="token number">0</span>
	<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$INT</span> <span class="token parameter variable">-gt</span> <span class="token variable">$PRICE</span> <span class="token punctuation">]</span> 
		<span class="token keyword">then</span>
	 		<span class="token builtin class-name">echo</span> <span class="token string">"太高了"</span>
	<span class="token keyword">else</span>
	  <span class="token builtin class-name">echo</span> <span class="token string">"太低了"</span>
	<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre> 
<h3><a id="45until_933"></a>4.5、until循环</h3> 
<p>​ 和while循环相反，until循环时只要条件判断式不成立则进行循环，并执行循环程序。一旦循环条件成立，则终止循环。</p> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">until</span> <span class="token punctuation">[</span> 条件判断式 <span class="token punctuation">]</span>
	<span class="token keyword">do</span>
		程序
	<span class="token keyword">done</span>
</code></pre> 
<p><strong>示例：从1加到100</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> sh/until.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#从1加到100</span>
<span class="token comment">#给变量i和变量s赋值</span>
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token comment">#循环直到变量i的值大于100，就停止循环</span>
<span class="token keyword">until</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token parameter variable">-gt</span> <span class="token number">100</span> <span class="token punctuation">]</span>
	<span class="token keyword">do</span>
		<span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span> $s<span class="token operator">+</span>$i <span class="token variable">))</span></span>
		<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span> $i<span class="token operator">+</span><span class="token number">1</span> <span class="token variable">))</span></span>
	<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token string">"The sum is: <span class="token variable">$s</span>"</span>
</code></pre> 
<h3><a id="46_964"></a>4.6、函数</h3> 
<p><strong>语法：</strong></p> 
<pre><code class="prism language-shell"><span class="token keyword">function</span> 函数名 <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	程序
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>示例：接收用户输入的数字，然后从1加到这个数字</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> function.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#接收用户输入的数字，然后从1加到这个数字</span>

<span class="token comment">#定义函数sum</span>
<span class="token keyword">function</span> <span class="token function-name function">sum</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token number">0</span>
	<span class="token comment">#循环直到i大于$1为止。 $1 是函数sum 的第一个参数。</span>
	<span class="token comment">#在函数中也可以使用位置参数变量，不过这里的$1指的是函数的第一个参数</span>
	<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>$num<span class="token punctuation">;</span>i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">))</span></span>		
		<span class="token keyword">do</span>
			<span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span> $i<span class="token operator">+</span>$s <span class="token variable">))</span></span>
		<span class="token keyword">done</span>
	<span class="token comment">#输出1加到$1的和</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"The sum of 1+2+3...+<span class="token variable">$1</span> is :<span class="token variable">$s</span>"</span>
<span class="token punctuation">}</span>

<span class="token comment">#接收用户输入的数字，并把值赋予变量num</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"Please input a number: "</span> <span class="token parameter variable">-t</span> <span class="token number">30</span> num

<span class="token comment">#把变量num值中的数字替换为空，并赋予变量y</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $num <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/[0-9]//g'</span><span class="token variable">)</span></span>

<span class="token comment">#判断变量y是否为空，以确定变量num中是否为数字</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$y</span>"</span><span class="token punctuation">]</span>
	<span class="token keyword">then</span>
		<span class="token comment">#调用sum函数，并把变量num的值作为第一个参数传递给sum函数</span>
		<span class="token function">sum</span> <span class="token variable">$num</span>		
<span class="token keyword">else</span>
	<span class="token comment">#如果变量num 的值不是数字，则输出报错信息</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"Error!! Please input a number!"</span>	
<span class="token keyword">fi</span>
</code></pre> 
<h3><a id="47_1011"></a>4.7、特殊流程控制语句</h3> 
<h4><a id="471_exit_1013"></a>4.7.1、 exit语句</h4> 
<p>​ 系统是有exit命令的，用于退出当前用户的登录状态。</p> 
<p>​ 在Shell脚本中，exit语句是用来退出当前脚本的。也就是说，<strong><font color="blue">在Shell脚本中，只要碰到了exit语句，后续的程序就不再执行，而直接退出脚本</font></strong>。</p> 
<p><strong><font color="red">exit的语法: <code>exit [返回值]</code></font></strong></p> 
<ul><li>如果<strong>exit命令之后定义了返回值，那么这个脚本执行之后的返回值就是我们自己定义的返回值。可以通过查询$?这个变量，来查看返回值</strong>。</li><li>如果exit之后没有定义返回值，脚本执行之后的返回值是执行exit 语句之前，最后执行的一条命令的返回值。</li></ul> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> exit.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#演示exit的作用</span>

<span class="token comment">#接收用户的输入，并把输入赋予变量num</span>
<span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"Please input a number: "</span> <span class="token parameter variable">-t</span> <span class="token number">30</span> num
<span class="token comment">#如果变量num的值是数字，则把num的值替换为空，否则不替换。并把替换之后的值赋予变量y</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $num <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/[0-9]//g'</span><span class="token variable">)</span></span>

<span class="token comment">#判断变量y的值如果不为空，输出报错信息，退出脚本，退出返回值为18</span>
<span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">"<span class="token variable">$y</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">"Error! Please input a number!"</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">18</span>

<span class="token comment">#如果没有退出，则打印变量num中的数字</span>
<span class="token builtin class-name">echo</span> <span class="token string">"The number is: <span class="token variable">$num</span>"</span>
</code></pre> 
<h4><a id="472break_1043"></a>4.7.2、break语句</h4> 
<p>​ 当程序执行到break语句时，会<strong>结束整个当前循环</strong>。而continue 语句也是结束循环的语句，不过continue 语句是结束单次当前循环，而下次循环会继续。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> break.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#演示break 跳出循环</span>
<span class="token comment">#循环十次</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">))</span></span>
    <span class="token keyword">do</span>
        <span class="token comment">#如果变量i的值等于4,方括号前中前后要有空格。</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token parameter variable">-eq</span> <span class="token number">4</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token comment">#退出整个循环</span>
            <span class="token builtin class-name">break</span>
        <span class="token keyword">fi</span>
        <span class="token comment">#输出变量i的值</span>
        <span class="token builtin class-name">echo</span> <span class="token variable">$i</span>
    <span class="token keyword">done</span>
</code></pre> 
<h4><a id="473continue_1064"></a>4.7.3、continue语句</h4> 
<p>​ continue也是结束流程控制的语句。如果在循环中，continue语句只会<strong>结束单次当前循环</strong>。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> continue.sh
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#演示continue</span>
<span class="token comment">#循环十次</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">))</span></span>
	<span class="token keyword">do</span>
		<span class="token comment">#如果变量i的值等于4</span>
		<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$i</span>"</span> <span class="token parameter variable">-eq</span> <span class="token number">4</span> <span class="token punctuation">]</span>
			<span class="token keyword">then</span>
			<span class="token comment">#退出换成continue</span>
			<span class="token builtin class-name">continue</span>			
		<span class="token keyword">fi</span>
		<span class="token comment">#输出变量i的值</span>
		<span class="token builtin class-name">echo</span> <span class="token variable">$i</span>	
	<span class="token keyword">done</span>
</code></pre> 
<h2><a id="5_1086"></a>5、字符截取、替换和处理命令</h2> 
<h3><a id="51_1088"></a>5.1、正则表达式</h3> 
<table><thead><tr><th>元字符</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>\</td><td>转义符，将特殊字符进行转义，忽略其特殊意义</td><td>a.b匹配a.b，但不能匹配ajb，.被转义为特殊意义</td></tr><tr><td>^</td><td>匹配行首，awk中，^则是匹配字符串的开始</td><td>^tux匹配以tux开头的行</td></tr><tr><td>$</td><td>匹配行尾，awk中，$则是匹配字符串的结尾</td><td>tux$匹配以tux结尾的行</td></tr><tr><td><strong>.</strong></td><td>匹配除换行符\n之外的**<font color="blue">任意单个字符</font>**</td><td>ab.匹配abc或abd，不可匹配abcd或abde，只能匹配单字符</td></tr><tr><td>[ ]</td><td>匹配包含在**<font color="blue">[指定字符]之中的任意一个字符</font>**</td><td>coo[kl]可以匹配cook或cool</td></tr><tr><td>[^]</td><td>匹配**<font color="blue"><code>[^指定字符]</code>之外的任意一个字符</font>**</td><td><code>123[^45]</code>不可以匹配1234或1235，1236、1237都可以</td></tr><tr><td>[-]</td><td>匹配[]中**<font color="blue">指定范围内的任意一个字符</font>**，要写成递增</td><td>[0-9]可以匹配1、2或3等其中任意一个数字</td></tr><tr><td>?</td><td>匹配之前的项1次或者0次</td><td>colou?r可以匹配color或者colour，不能匹配colouur</td></tr></tbody></table> 
<table><thead><tr><th>元字符</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>\</td><td>转义符，将特殊字符进行转义，忽略其特殊意义</td><td>a.b匹配a.b，但不能匹配ajb，.被转义为特殊意义</td></tr><tr><td>^</td><td>以什么开头</td><td>^tux匹配以tux开头的行</td></tr><tr><td>$</td><td>以什么结尾</td><td>tux$匹配以tux结尾的行</td></tr><tr><td>.</td><td>匹配除换行符\n之外的**<font color="blue">任意单个字符</font>**</td><td>ab.匹配abc或abd，不可匹配abcd或abde，只能匹配单字符</td></tr><tr><td>[ ]</td><td>匹配包含在**<font color="blue">[指定字符]之中的任意一个字符</font>**</td><td>coo[kl]可以匹配cook或cool</td></tr><tr><td>[^]</td><td>匹配**<font color="blue"><code>[^指定字符]</code>之外的任意一个字符</font>**</td><td>123[^45]不可以匹配1234或1235，1236、1237都可以</td></tr><tr><td>[-]</td><td>匹配[]中**<font color="blue">指定范围内的任意一个字符</font>**，要写成递增</td><td>[0-9]可以匹配1、2或3等其中任意一个数字</td></tr><tr><td>?</td><td>匹配<font color="blue"><strong>之前的单个字符1次或者0次</strong></font></td><td>colou?r可以匹配color或者colour，不能匹配colouur 。即：u字符匹配0次或1次</td></tr><tr><td>+</td><td>匹配**<font color="blue">之前的单个字符1次或者多次</font>**</td><td>sa-6+匹配sa-6、sa-666，不能匹配sa-</td></tr><tr><td>*</td><td>匹配**<font color="blue">之前的单个字符0次或者多次</font>**</td><td>co*l匹配cl、col、cool、coool等</td></tr><tr><td>()</td><td>匹配表达式，创建一个用于匹配的子串，即 括号中的字符串 是一个整体</td><td>ma(tri)?匹配max或maxtrix</td></tr><tr><td>{n}</td><td>匹配之前的项n次，n是可以为0的正整数</td><td>[0-9]{3}匹配任意一个三位数，可以扩展为 <code>[0-9][0-9][0-9]</code></td></tr><tr><td>{n,}</td><td>之前的项至少需要匹配n次</td><td>[0-9]{2,}匹配任意一个两位数或更多位数不支持{n,}{n,}{n,}</td></tr><tr><td>{n,m}</td><td>指定之前的项至少匹配n次，最多匹配m次，n&lt;=m</td><td>[0-9]{2,5}匹配从两位数到五位数之间的任意一个数字</td></tr><tr><td>|</td><td>交替匹配|两边的任意一项， 即 或者</td><td>ab(c|d)匹配abc或abd</td></tr></tbody></table> 
<h3><a id="52_1119"></a>5.2、字符截取、替换命令</h3> 
<h4><a id="521cut__1121"></a>5.2.1、cut 列提取命令</h4> 
<p>​ cut命令的默认分隔符是制表符，也就是“tab”键，不过对空格符支持的不怎么好。</p> 
<blockquote> 
 <p><strong>语法：<code>cut [选项] 文件名</code></strong><br> <strong>选项:</strong></p> 
 <ul><li>-f 列号 ：提取第几列。</li><li>-d 分隔符 ：按照指定分隔符分割列。</li><li>-n ：取消分割多字节字符。</li><li>-c 字符范围 ：不依赖分隔符来区分列，而是通过字符范围（行首为0）来进行字段提取。 
   <ul><li>“n-”表示从第n个字符到行尾;</li><li>“n-m”从第n个字符到第m个字符;</li><li>“-m”表示从第1个字符到第m个字符。</li></ul> </li><li>–complement 补足被选择的字节、字符或字段</li><li>–out-delimiter 指定输出内容是的字段分割符</li></ul> 
</blockquote> 
<p><strong>示例1：切分或提取文件中的内容</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> student.txt
<span class="token function">id</span>	name	gender	mark
<span class="token number">1</span>	liming	m	<span class="token number">86</span>
<span class="token number">2</span>	sc	m	<span class="token number">67</span>
<span class="token number">3</span>	tg	n	<span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost lk_test<span class="token punctuation">]</span>$ <span class="token function">cut</span> <span class="token parameter variable">-f</span> <span class="token number">2</span> student.txt
<span class="token comment">#提取第二列内容，输出结果如下：（默认以tab键作为分隔符）</span>
name
liming
sc
tg
<span class="token punctuation">[</span>root@localhost lk_test<span class="token punctuation">]</span>$ <span class="token function">cut</span> <span class="token parameter variable">-f</span> <span class="token number">2,3</span> student.txt
<span class="token comment"># 想要提取多列，只要列号直接用“,”分开,输出结果如下：</span>
name    gender
liming  m
sc      m
tg      n
<span class="token punctuation">[</span>root@localhost lk_test<span class="token punctuation">]</span>$ <span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">":"</span> <span class="token parameter variable">-f</span> <span class="token number">1,3</span> /etc/passwd
<span class="token comment"># 以冒号切分文件内容，并提起文件中的 第1、3列，输出结果如下：</span>
root:0
bin:1
daemon:2
adm:3
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略其它用户
<span class="token punctuation">[</span>root@localhost lk_test<span class="token punctuation">]</span>$ <span class="token function">cut</span> <span class="token parameter variable">-c</span> <span class="token number">8</span>- student.txt
<span class="token comment"># 提取所有行的第8个字符开始到行尾的数据，输出结果如下：</span>
        gender  mark
g       m       <span class="token number">86</span>
<span class="token number">67</span>
<span class="token number">90</span>
</code></pre> 
<p><strong>示例2：切分、提取shell命令结果的数据</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost lk_test<span class="token punctuation">]</span>$ <span class="token function">df</span> <span class="token parameter variable">-h</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">" "</span> <span class="token parameter variable">-f</span> <span class="token number">1</span>-12
<span class="token comment"># 截取df命令的第1-12列的数据，输出结果如下：</span>
Filesystem      Size  Used Avail Use% Mounted
/dev/vda1        99G   45G
devtmpfs        <span class="token number">1</span>.9G   
tmpfs           <span class="token number">1</span>.9G
tmpfs           <span class="token number">1</span>.9G
tmpfs           <span class="token number">1</span>.9G
tmpfs           378M
tmpfs           378M
tmpfs           378M
</code></pre> 
<h4><a id="522awk__1189"></a>5.2.2、awk 编程</h4> 
<p>​ awk是一种编程语言，用于linux下对文本和数据进行处理。数据可以来自<code>标准输入</code>、<code>一个或多个文件</code>，或其他<code>命令的输出</code>。</p> 
<h5><a id="5221printf__1193"></a>5.2.2.1、printf 格式化输出</h5> 
<blockquote> 
 <p><strong>语法：<code>printf ‘输出类型输出格式’ 输出内容</code></strong></p> 
 <p><strong>输出类型：</strong></p> 
 <ul><li><strong>%c</strong> ：ASCII字符，显示相对应参数的第一个字符。</li><li><strong>%-ns</strong> ：输出字符串。 
   <ul><li>减号“-”表示左对齐(默认右对齐)；</li><li>n是数字指代输出几个字符；几个参数就写几个%-ns</li></ul> </li><li><strong>%-ni</strong> ：输出整数，n是数字指代输出几个数字。</li><li><strong>%m.nf</strong> ：输出浮点数。 
   <ul><li>m和n是数字，m为宽度，n为小数位数。</li><li>如%8.2f代表共输出8位数，其中2位是小数，6位是整数。</li></ul> </li><li>%a(%A) ：浮点数、十六进制数字和p-(P-)记数法(C99)</li><li><strong>%d</strong> ：有符号十进制整数。</li><li><strong>%f</strong> ：浮点数(包括float和doulbe)</li><li>%e(%E) ：浮点数指数输出[e-(E-)记数法]</li><li>%g(%G) ：浮点数不显无意义的零"0"</li><li>%i ：有符号十进制整数(与%d相同)</li><li>%u ：无符号十进制整数</li><li>%o ：八进制整数 e.g. 0123</li><li>%x(%X) ：十六进制整数0f(0F) e.g. 0x1234</li><li>%p ：指针</li><li><strong>%s</strong> ：字符串</li><li>%% ：“%”</li></ul> 
 <p><strong>输出格式：</strong></p> 
 <ul><li>\a ：输出警告声音。</li><li>\b ：输出退格键，也就是Backspace键。</li><li>\f ：清除屏幕。</li><li>\n ：换行。</li><li>\r ：回车，也就是Enter键。</li><li>\t ：水平输出退格键，也就是Tab 键。</li><li>\v ：垂直输出退格键，也就是Tab 键。</li></ul> 
</blockquote> 
<p>示例：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> student2.txt
ID      Name    php  	 Linux  	MySQL 	  Average
<span class="token number">1</span>       AAA      <span class="token number">66</span>         <span class="token number">66</span>       <span class="token number">66</span>           <span class="token number">66</span>
<span class="token number">2</span>       BBB      <span class="token number">77</span>         <span class="token number">77</span>       <span class="token number">77</span>           <span class="token number">77</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>

<span class="token comment">#printf格式输出文件</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">printf</span> <span class="token string">'%s\t %s\t %s\t %s\t %s\t %s\t \n'</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> student2.txt<span class="token variable">)</span></span>
<span class="token comment"># %s分别对应后面的参数,6列就写6个</span>
ID	 Name	 php	 Linux	 MySQL	 Average	 
<span class="token number">1</span>	 AAA	 <span class="token number">66</span>	 <span class="token number">66</span>	 <span class="token number">66</span>	 <span class="token number">66</span>	 
<span class="token number">2</span>	 BBB	 <span class="token number">77</span>	 <span class="token number">77</span>	 <span class="token number">77</span>	 <span class="token number">77</span>	 
<span class="token number">3</span>	 CCC	 <span class="token number">88</span>	 <span class="token number">88</span>	 <span class="token number">88</span>	 <span class="token number">88</span>	

<span class="token comment">#如果不想把成绩当成字符串输出，而是按照整型和浮点型输出</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">printf</span> <span class="token string">'%i\t %s\t %i\t %i\t %i\t %8.2f\t \n'</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> student2.txt <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> Name<span class="token variable">)</span></span>
<span class="token comment">#说明： grep -v 参数 ：代表显示没有被匹配的行。</span>
<span class="token number">1</span>	 AAA	 <span class="token number">66</span>	 <span class="token number">66</span>	 <span class="token number">66</span>	    <span class="token number">66.00</span>	 
<span class="token number">2</span>	 BBB	 <span class="token number">77</span>	 <span class="token number">77</span>	 <span class="token number">77</span>	    <span class="token number">77.00</span>	 
<span class="token number">3</span>	 CCC	 <span class="token number">88</span>	 <span class="token number">88</span>	 <span class="token number">88</span>	    <span class="token number">88.00</span>

</code></pre> 
<h5><a id="5222awk__1256"></a>5.2.2.2、awk 基本使用</h5> 
<blockquote> 
 <p><strong>语法：<code>awk '条件1{动作1} 条件2{动作2}...' 文件名</code></strong></p> 
 <p>**条件（Pattern）：**一般使用关系表达式作为条件。这些关系表达式非常多，例如:<br> x &gt; 10 判断变量x是否大于10<br> x == y 判断变量x是否等于变量y<br> A ~ B 判断字符串A中是否包含能匹配B表达式的子字符串<br> A !~ B 判断字符串A中是否不包含能匹配B表达式的子字符串</p> 
 <p><strong>动作（Action） :</strong></p> 
 <ul><li>格式化输出</li><li>流程控制语句</li></ul> 
 <p><strong>常用参数：</strong></p> 
 <ul><li>-F 指定输入时用到的字段分隔符.</li><li>-v 自定义变量.</li><li>-f 从脚本中读取awk命令.</li><li>-m 对val值设置内在限制.</li></ul> 
</blockquote> 
<p>示例：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'{printf $2 "\t" $6 "\n"}'</span> student2.txt
<span class="token comment"># 输出第二列和第六列</span>
Name	Average
AAA	<span class="token number">66</span>
BBB	<span class="token number">77</span>
CCC	<span class="token number">88</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">df</span> <span class="token parameter variable">-h</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1 "\t" $3}'</span>
<span class="token comment">#截取df命令的第一列和第三列</span>
Filesystem	Used
/dev/vda1	45G
devtmpfs	<span class="token number">0</span>
tmpfs	65M
tmpfs	520K
tmpfs	<span class="token number">0</span>
tmpfs	<span class="token number">0</span>
tmpfs	<span class="token number">0</span>
tmpfs	<span class="token number">0</span>
</code></pre> 
<h5><a id="5223awk__1300"></a>5.2.2.3、awk 的条件</h5> 
<table><thead><tr><th>条件的类型</th><th>条件</th><th>说明</th></tr></thead><tbody><tr><td>awk保留字</td><td>BEGIN</td><td>在awk程序一开始时，尚未读取任何数据之前执行。BEGIN后的动作只在程序开始时执行一次</td></tr><tr><td>awk保留字</td><td>END</td><td>在awk程序处理完所有数据，即将结束时执行。END后的动作只在程序结束时执行一次</td></tr><tr><td>关系运算符</td><td>&gt;</td><td>大于</td></tr><tr><td>关系运算符</td><td>&lt;</td><td>小于</td></tr><tr><td>关系运算符</td><td>&gt;=</td><td>大于等于</td></tr><tr><td>关系运算符</td><td>&lt;=</td><td>小于等于</td></tr><tr><td>关系运算符</td><td>==</td><td>等于。用于判断两个值是否相等，如果是给变量赋值，请使用""号</td></tr><tr><td>关系运算符</td><td>!=</td><td>不等于</td></tr><tr><td>关系运算符</td><td>A~B</td><td>判断字符串A中是否包含能匹配B表达式的子字符串</td></tr><tr><td>关系运算符</td><td>A!~B</td><td>判断字符串A中是否不包含能匹配B表达式的子字符串</td></tr><tr><td>正则表达式</td><td>/正则/</td><td>如果在"//"中可以写入字符，也可以支持正则表达式</td></tr></tbody></table> 
<h6><a id="BEGIN_1316"></a>BEGIN</h6> 
<p>​ BEGIN是awk的保留字，是一种特殊的条件类型。BEGIN的执行时机是“在 awk程序一开始时，尚未读取任何数据之前执行”。一旦BEGIN后的动作执行一次，当awk开始从文件中读入数据，BEGIN的条件就不再成立，所以<strong>BEGIN定义的动作只能被执行一次</strong>。示例如下：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'BEGIN{printf "This is a transcript \n" } {printf $2 "\t" $6 "\n"}'</span> student2.txt
<span class="token comment">#这里定义了两个动作</span>
<span class="token comment">#第一个动作使用BEGIN条件，所以会在读入文件数据前打印“这是一张成绩单”(只会执行一次)</span>
<span class="token comment">#第二个动作会打印文件的第二字段和第六字段</span>
This is a transcript 
Name	Average
AAA	<span class="token number">66</span>
BBB	<span class="token number">77</span>
CCC	<span class="token number">88</span>
</code></pre> 
<h6><a id="END_1332"></a>END</h6> 
<p>​ END也是awk保留字，不过刚好和BEGIN相反。END是在awk程序处理完所有数据，即将结束时执行。END后的动作只在程序结束时执行一次。示例如下:</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'END{printf "The End \n"} {printf $2 "\t" $6 "\n"}'</span> student2.txt
<span class="token comment">#在输出结尾输入“The End”，这并不是文档本身的内容，而且只会执行一次</span>
Name	Average
AAA	<span class="token number">66</span>
BBB	<span class="token number">77</span>
CCC	<span class="token number">88</span>
The End
</code></pre> 
<h6><a id="_1346"></a>关系运算符</h6> 
<p><strong>示例1：假设我想看看平均成绩大于等于87分的学员是谁。</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> student2.txt <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> Name <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'$6 &gt;= 87 {printf $2 "\n"}'</span>
<span class="token comment">#使用cat输出文件内容，用grep取反包含“Name”的行</span>
<span class="token comment">#判断第六字段（平均成绩）大于等于87分的行，如果判断式成立，则打第二列（学员名$2）</span>
CCC
</code></pre> 
<p>​ 加入了条件之后，只有条件成立动作才会执行，如果条件不满足，则动作则不运行。通过这个示例，可以发</p> 
<p>现，虽然awk是列提取命令，但是也要按行来读入的。</p> 
<p><strong><font color="red">awk命令的执行过程如下</font>:</strong></p> 
<blockquote> 
 <ul><li>1、如果有BEGIN条件，则先执行BEGIN定义的动作。</li><li>2、如果没有BEGIN条件，则读入第一行，把第一行的数据依次赋予$0、$1、$2等变量。其中$0代表此行的整体数据，$1代表第一字段，$2代表第二字段。</li><li>3、依据条件类型判断动作是否执行。如果条件符合，则执行动作，否则读入下一行数据。如果没有条件，则每行都执行动作。</li><li>4、读入下一行数据，重复执行以上步骤。</li></ul> 
</blockquote> 
<p><strong>示例2：查看sc用户的平均成绩:</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'$2 ~ /sc/ {printf $4 "\n"}'</span> student.txt
<span class="token comment">#如果第二字段中输入包含有“sc”字符，则打印第四字段数据</span>
<span class="token number">67</span>
</code></pre> 
<p><strong>注意：</strong></p> 
<p>​ <strong>在awk中</strong>，使用“//”包含的字符串，awk命令才会查找。即 <strong><font color="red">字符串必须用“//”包含，awk命令才能正确识别</font>。</strong></p> 
<h6><a id="_1380"></a>正则表达式</h6> 
<p>​ 如果要想让awk 识别字符串，必须使用“//”包含。</p> 
<p>示例1：打印liming的成绩</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'/liming/ {print}'</span> student.txt
<span class="token number">1</span>       liming  m       <span class="token number">86</span>
</code></pre> 
<p>**例子2：**查看真正的系统分区的使用状况，而不想查看光盘和临时分区的使用状况。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">df</span> <span class="token parameter variable">-h</span>
Filesystem      Size  Used Avail Use% Mounted on
/dev/vda1        99G   45G   50G  <span class="token number">48</span>% /
devtmpfs        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev
tmpfs           <span class="token number">1</span>.9G   65M  <span class="token number">1</span>.8G   <span class="token number">4</span>% /dev/shm
tmpfs           <span class="token number">1</span>.9G  520K  <span class="token number">1</span>.9G   <span class="token number">1</span>% /run
tmpfs           <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /sys/fs/cgroup
tmpfs           378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/0
tmpfs           378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/1100
tmpfs           378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/1102
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">df</span> <span class="token parameter variable">-h</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/vda[0-9]/ {printf $1 "\t" $5 "\n"}'</span>
/dev/vda1	<span class="token number">48</span>%
</code></pre> 
<h5><a id="5224awk__1408"></a>5.2.2.4、awk 内置变量</h5> 
<table><thead><tr><th>awk内置变量</th><th>作用</th></tr></thead><tbody><tr><td>$0</td><td>代表目前awk所读入的整行数据。我们已知awk是一行一行读入数据的，$0就代表当前读入行的整行数据</td></tr><tr><td>$n</td><td>代表目前读入行的第n个字段。比如，$1表示第1个字段(列)，$2表示第2个字段(列)，如此类推</td></tr><tr><td><strong>NF</strong></td><td><strong>当前行拥有的字段（列）总数</strong></td></tr><tr><td><strong>NR</strong></td><td>当前awk所处理的行，是<strong>总数据的第几行</strong></td></tr><tr><td><strong>FS</strong></td><td>用户定义分隔符。awk的默认分隔符是任何空格，如果想要使用其他分隔符（如“:”），就需要FS变量定义</td></tr><tr><td>ARGC</td><td>命令行参数个数</td></tr><tr><td>ARGV</td><td>命令行参数数组</td></tr><tr><td>FNR</td><td>当前文件中的当前记录数（对输入文件起始为1）</td></tr><tr><td>OFMT</td><td>数值的输出格式（默认为%.6g）</td></tr><tr><td>OFS</td><td>输出字段的分隔符（默认为空格）</td></tr><tr><td>ORS</td><td>输出记录分隔符（默认为换行符）</td></tr><tr><td>RS</td><td>输入记录分隔符（默认为换行符）</td></tr></tbody></table> 
<p><strong><font color="blue">awk常用统计实例</font></strong></p> 
<pre><code class="prism language-shell"><span class="token comment"># 1、打印文件的第一列(域) ：</span>
<span class="token function">awk</span> <span class="token string">'{print $1}'</span> filename
 
<span class="token comment"># 2、打印文件的前两列(域) ：</span>
<span class="token function">awk</span> <span class="token string">'{print $1,$2}'</span> filename
 
<span class="token comment"># 3、打印完第一列，然后打印第二列 ： </span>
<span class="token function">awk</span> <span class="token string">'{print $1 $2}'</span> filename

<span class="token comment"># 4、打印文本文件的总行数 ： </span>
<span class="token function">awk</span> <span class="token string">'END{print NR}'</span> filename

<span class="token comment"># 5、打印文本第一行 ：</span>
<span class="token function">awk</span> <span class="token string">'NR==1{print}'</span> filename

<span class="token comment"># 6、打印文本第二行第一列 ：</span>
<span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">"2, 1p"</span> filename <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'print $1'</span>


<span class="token comment"># 1. 获取第一列</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1}'</span>

<span class="token comment"># 2. 获取第一列，第二列，第三列</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1, $2, $3}'</span>

<span class="token comment"># 3. 获取第一行的第一列，第二列，第三列</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==1{print $1, $2, $3}'</span>

<span class="token comment"># 4. 获取行数NR</span>
<span class="token function">df</span> <span class="token parameter variable">-h</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'END{print NR}'</span>

<span class="token comment"># 5. 获取列数NF（这里是获取最后一行的列数，注意每行的列数可能是不同的）</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'END{print NF}'</span>

<span class="token comment"># 6. 获取最后一列</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $NF}'</span>

<span class="token comment"># 7. 对文件进行操作</span>
<span class="token function">awk</span> <span class="token string">'{print $1}'</span> fileName

<span class="token comment"># 8. 指定分隔符（这里以:分割）</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span><span class="token function">awk</span>  -F<span class="token string">':'</span> <span class="token string">'{print $1}'</span>

<span class="token comment"># 9. 超出范围不报错</span>
<span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> watchdog <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $100}'</span>
</code></pre> 
<pre><code class="prism language-shell"><span class="token comment"># 查询可以登录的用户的用户名和UID；（自定义:为分隔符)</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> /etc/passwd <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"/bin/bash"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{FS=":"} {printf $1 "\t" $3 "\n"}'</span>
<span class="token comment"># 输出结果，发现第一行没有生效。原因：忘记了“BEGIN”条件</span>
root:x:0:0:root:/root:/bin/bash 
test6   <span class="token number">1000</span>

<span class="token comment"># 修改后的命令如下</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> /etc/passwd <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"/bin/bash"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'BEGIN {FS=":"} {printf $1 "\t" $3 "\t 行号:" NR "\t 字段数:" NF "\n"}'</span>
<span class="token comment">#开始执行{分隔符是“:”}{输出第一字段和第三字段输出行号(NR值）字段数(NF值）}</span>
root    <span class="token number">0</span>        行号:1  字段数:7
test6   <span class="token number">1000</span>     行号:2  字段数:7

<span class="token comment"># 如果只想看看sshd这个伪用户的相关信息，则可以这样使用:</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$  <span class="token function">cat</span> /etc/passwd <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'BEGIN {FS=":"} $1=="sshd" {printf $1 "\t" $3 "\t 行号:" NR "\t 字段数:" NF "\n"}'</span>
sshd    <span class="token number">74</span>       行号:19         字段数:7
</code></pre> 
<h5><a id="5225awk__1495"></a>5.2.2.5、awk 流程控制</h5> 
<p>后面还要利用下student2.txt文件做练习，再看看这个文件的内容:</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$  <span class="token function">cat</span> student2.txt
ID      Name    php  	 Linux  	MySQL 	  Average
<span class="token number">1</span>       AAA      <span class="token number">66</span>         <span class="token number">66</span>       <span class="token number">66</span>           <span class="token number">66</span>
<span class="token number">2</span>       BBB      <span class="token number">77</span>         <span class="token number">77</span>       <span class="token number">77</span>           <span class="token number">77</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>
</code></pre> 
<p>**<font color="red">在awk中定义变量与调用变量的值。</font>**假设想统计PHP成绩的总分：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'NR==2 {php1=$3} 
NR==3 {php2=$3} 
NR==4 {php3=$3; totle=phpl+php2+php3; print "totle php is " totle}'</span> student2.txt
<span class="token comment"># 统计PHIP成绩的总分:</span>
totle php is <span class="token number">165</span>
</code></pre> 
<p><strong>以上命令说明：</strong></p> 
<blockquote> 
 <ul><li><strong><code>NR==2 {iphp1=$3}</code></strong> ： (条件是NR==2，动作是php1=$3） 这句话是指如果输入数据是第二行（第一行是标题行），就把第二行的第三字段的值赋予变量“php1”。</li><li><strong><code>NR==3 {php2=$3}</code></strong> ：是指如果输入数据是第三行，就把第三行的第三字段的值赋予变量“php2”。</li><li><strong><code>NR==4 {php3=$3;totle=phpl+php2+php3;print “totle php is " totle}</code></strong> ：（NR==4是条件，后面(中的都是动作)，这句话是指如果输入数据是第四行，就把第四行的第三字段的值赋予变量"php3”;然后定义变量totle的值是“php1+php2+php3”；然后输出“totle php is”关键字，后面加变量totle的值。</li></ul> 
</blockquote> 
<p><strong>在awk编程中，因为命令语句非常长，在输入格式时需要注意以下内容:</strong></p> 
<blockquote> 
 <ul><li> <p><strong>多个条件 {动作}</strong> ：可以用空格分割，也可以用回车分割。</p> </li><li> <p>在一个动作中，如果需要执行多个命令，需要用 “;” 分割，或用回车分割。</p> </li><li> <p>在awk中，变量的赋值与调用都不需要加入“$”符。</p> </li><li> <p>条件中判断两个值是否相同，请使用 “==”，以便和变量赋值进行区分。</p> </li></ul> 
</blockquote> 
<p>再看下该如何实现流程控制，假设如果Linux成绩大于80，就是一个super man(学PHP的表示压力很大!) :</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'{if (NR&gt;=2) {if ($4&gt;80) printf $2 " is a super man!\n"}}'</span> student2.txt
<span class="token comment"># 程序中有两个if判断，第一个判断行号大于2，第二个判断Linux成绩大于80分</span>
CCC is a super man<span class="token operator">!</span>

<span class="token comment"># 在 awk中 if判断语句，完全可以直接利用awk自带的条件来取代，优化后代码如下：</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'NR&gt;=2 {test=$4}
test&gt;80 {printf $2 " is a super man! \n"}'</span> student2.txt
<span class="token comment"># 先判断行号如果大于2，就把第四字段赋予变量test；再判断如果test的值大于80分，就打印super man</span>
CCC is a super man<span class="token operator">!</span>
</code></pre> 
<h5><a id="5226awk__1548"></a>5.2.2.6、awk 函数</h5> 
<p>​ awk编程也允许在编程时使用函数，awk函数的定义方法如下:</p> 
<pre><code class="prism language-shell"><span class="token keyword">function</span> 函数名（参数列表）<span class="token punctuation">{<!-- --></span>
	函数体
<span class="token punctuation">}</span>
</code></pre> 
<p>**示例1：**定义一个简单的函数，使用函数来打印student2.txt的学员姓名和平均成绩.</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">awk</span> <span class="token string">'function test(a,b) { 
		#定义函数test，包含两个参数，函数体的内容是输出这两个参数的值
		printf a "\t" b "\n" 
	}
	# 调用test函数,并向两个参数传递值。
	{ test($2,$6) } 
	'</span> student2.txt
<span class="token comment"># 输出结果:</span>
Name	Average
AAA	<span class="token number">66</span>
BBB	<span class="token number">77</span>
CCC	<span class="token number">88</span>
</code></pre> 
<h5><a id="5227awk__1575"></a>5.2.2.7、awk 中调用脚本</h5> 
<p>​ 对于小的单行程序来说，将脚本作为命令行自变量传递给awk是非常简单的，而对于多行程序就比较难处理。当程序是多行的时候，使用外部脚本是很适合的。首先在外部文件中写好脚本，然后可以使用awk的-f选项，使其读入脚本并且执行。</p> 
<pre><code class="prism language-shell"><span class="token comment"># 编写一个awk脚本</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">vi</span> pass.awk
BEGIN <span class="token punctuation">{<!-- --></span>FS<span class="token operator">=</span><span class="token string">":"</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span> print <span class="token variable">$1</span> <span class="token string">"<span class="token entity" title="\t">\t</span>"</span>  <span class="token variable">$3</span><span class="token punctuation">}</span>

<span class="token comment"># 使用“-f”选项来调用这个脚本:</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$  <span class="token function">awk</span> <span class="token parameter variable">-f</span> pass.awk /etc/passwd
root    <span class="token number">0</span>
bin     <span class="token number">1</span>
daemon  <span class="token number">2</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出
</code></pre> 
<h4><a id="523sed__1593"></a>5.2.3、sed 文本选取、替换、删除、新增的命令</h4> 
<p>​ sed主要是用来将数据进行选取、替换、删除、新增的命令。</p> 
<p><strong>语法：<code>sed [选项] ‘[动作]’ 文件名</code></strong></p> 
<blockquote> 
 <p><strong>选项:</strong></p> 
 <ul><li><strong>-i</strong> ：直接对原文件进行操作。</li><li><strong>-r</strong> ：支持扩展正则表达式。</li><li><strong>-n</strong> ：只显示匹配处理的行。不加-n的时候，sed处理的数据和不处理的都会输出。</li><li><strong>-e</strong> ：执行多个编辑命令时（一般用；代替）</li><li>-f 脚本文件名 ：执行脚本文件中的命令，脚本文件中一行一条命令。</li></ul> 
 <p><strong>动作:</strong></p> 
 <ul><li><strong>a\</strong> ：在当前<strong>行下面插入文本</strong>; a前面可以跟行号、正则，等匹配规则。</li><li><strong>i\</strong> ：在当前<strong>行上面插入文本</strong>;</li><li><strong>c\</strong> ：把选定的行改为新的文本; 如：<strong>70c</strong> 为第70行， <strong>/cs/c</strong> 代表包含cs的行。</li><li><strong>d</strong> ：删除，<strong>删除选择的行;</strong></li><li>D ：删除模板块的第一行;</li><li><strong>s</strong> ：字串替换，用一个字符串替换另外一个字符串。（匹配正则表达式） 
   <ul><li>格式为 ‘<strong>行范围</strong>s**/旧字串/**新字串/g’（和vim中的替换格式类似）。</li></ul> </li><li>h ：拷贝模板块的内容到内存中的缓冲区;</li><li>H ：追加模板块的内容到内存中的缓冲区;</li><li>g ：获得内存缓冲区的内容，并替代当前模板块中的文本;</li><li>G ：获得内存缓冲区的内容，并追加到当前模板块文本的后面;</li><li>l ：列表不能打印字符的清单;</li><li>n ：读取下一个输入行，用下一个命令处理新的行而不是用第一个命令;</li><li>N ：追加下一个输入行到模板块后面并在二者间嵌入一个新行，改变当前行号码;</li><li><strong>p</strong> ：打印匹配行。 P(大写) 打印模板块的第一行; 如： 
   <ul><li><strong>1,5p</strong>：输出1到5行；</li><li><strong>$p</strong>：最后1行；</li><li><strong>3,5!p</strong>：取反输出除3~5行之外的行；</li><li><strong>2~3p，每隔3行取2行</strong>。</li></ul> </li><li>q ：退出Sed;</li><li>b lable ：分支到脚本中带有标记的地方，如果分支不存在则分支到脚本的末尾;</li><li>r file ：从file中读行;</li><li>t label ：if分支，从最后一行开始，条件一旦满足或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾;</li><li>T label ：错误分支，从最后一行开始，一旦发生错误或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾;</li><li>w file ：写并追加模板块到file末尾;</li><li>W file ：写并追加模板块的第一行到file末尾;</li><li>! ：表示后面的命令对所有没有被选定的行发生作用;</li><li>= ：打印当前行号;</li><li><code>#</code> ：把注释扩展到下一个换行符以前;</li></ul> 
 <p><strong>sed替换标记：</strong></p> 
 <ul><li> <p>g 表示行内全面替换;</p> </li><li> <p>p 表示打印行;</p> </li><li> <p>w 表示把行写入一个文件;</p> </li><li> <p>x 表示互换模板块中的文本和缓冲区中的文本;</p> </li><li> <p>y 表示把一个字符翻译为另外的字符（但是不用于正则表达式）;</p> </li><li> <p>\1 子串匹配标记;</p> </li><li> <p>&amp; 已匹配字符串标记;</p> </li></ul> 
 <p><strong>sed元字符集：</strong></p> 
 <ul><li> <p>^ 匹配行开始，如：/^sed/匹配所有以sed开头的行;</p> </li><li> <p>$ 匹配行结束，如：/sed$/匹配所有以sed结尾的行;</p> </li><li> <p>. 匹配一个非换行符的任意字符，如：/s.d/匹配s后接一个任意字符，最后是d;</p> </li><li> <p>匹配0个或多个字符，如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行;</p> </li><li> <p>[] 匹配一个指定范围内的字符，如/[ss]ed/匹配sed和Sed;</p> </li><li> <p>[^] 匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行;</p> </li><li> <p>\(…\) 匹配子串，保存匹配的字符，如s/(love)able/\1rs，loveable被替换成lovers;</p> </li><li> <p>&amp; 保存搜索字符用来替换其他字符，如s/love/<strong>&amp;</strong>/，love这成<strong>love</strong>;</p> </li><li> <p>\&lt; 匹配单词的开始，如:/\&lt;</p> </li><li> <p>\&gt; 匹配单词的结束，如**/<strong>love\&gt;</strong>/** 该正则匹配包含以love结尾的单词的行;</p> </li><li> <p>x{m} 重复字符x，m次，如：/0{5}/匹配包含5个0的行;</p> </li><li> <p>x{m,} 重复字符x，至少m次，如：/0{5,}/匹配至少有5个0的行;</p> </li><li> <p>x{m,n} 重复字符x，至少m次，不多于n次，如：/0{5,10}/匹配5~10个0的行;</p> </li></ul> 
 <p><strong>注意：</strong></p> 
 <ul><li>sed所做的修改并不会直接改变文件的内容（如果是用管道符接收的命令的输出，这种情况连文件都没有），而是把修改结果只显示到屏幕上，除非使用 <strong>-i</strong> 选项才会直接修改文件。</li></ul> 
</blockquote> 
<h5><a id="5231_1676"></a>5.2.3.1、提取行数据</h5> 
<p>​ 假设想查看下student2.txt的第二行，那么就可以利用“p”动作了:</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ $ <span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">'2p'</span> student2.txt
<span class="token comment"># 指定输出某行，使用-n选项</span>
<span class="token number">1</span>       AAA      <span class="token number">66</span>         <span class="token number">66</span>       <span class="token number">66</span>           <span class="token number">66</span>
</code></pre> 
<h5><a id="5232_1686"></a>5.2.3.2、删除行数据</h5> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@localhost ~]</span>$ sed <span class="token string">'2,4d'</span> student2<span class="token punctuation">.</span>txt
<span class="token comment">#删除第二行到第四行数据</span>
ID      Name    php  	 Linux  	MySQL 	  Average
</code></pre> 
<h5><a id="5233_1694"></a>5.2.3.3、追加、插入行数据</h5> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@localhost ~]</span>$ sed <span class="token string">'2a hello'</span> student2<span class="token punctuation">.</span>txt
<span class="token comment">#在第二行后加入一行，内容为hello</span>
ID      Name    php  	 Linux  	MySQL 	  Average
1       AAA      66         66       66           66
hello
2       BBB      77         77       77           77
3       CCC      88         88       88           88

<span class="token namespace">[root@localhost ~]</span>$ sed <span class="token string">'2i hello world'</span> student2<span class="token punctuation">.</span>txt
<span class="token comment">#在第二行前插入一行数据，内容为hello world</span>
ID      Name    php  	 Linux  	MySQL 	  Average
hello world
1       AAA      66         66       66           66
2       BBB      77         77       77           77
3       CCC      88         88       88           88

<span class="token namespace">[root@localhost ~]</span>$ sed <span class="token string">'1a\hello1\nhello2\nhello3'</span> student2<span class="token punctuation">.</span>txt
<span class="token comment">#在第1行后加入多行数据，</span>
ID      Name    php      Linux          MySQL     Average
hello1
hello2
hello3
1       AAA      66         66       66           66
2       BBB      77         77       77           77
3       CCC      88         88       88           88
</code></pre> 
<h5><a id="5234__1724"></a>5.2.3.4、 替换行数据</h5> 
<p>假设AAA的成绩太好了，我实在是不想看到他的成绩刺激我，那就可以使用"c"动作。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sed</span> <span class="token string">'2c No such person'</span> student2.txt 
<span class="token comment"># 将第二行数据替换为：No such person</span>
ID      Name    php      Linux          MySQL     Average
No such person
<span class="token number">2</span>       BBB      <span class="token number">77</span>         <span class="token number">77</span>       <span class="token number">77</span>           <span class="token number">77</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'2c No such person'</span> student2.txt
<span class="token comment"># 使用-i直接修改文件</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> student2.txt
ID      Name    php      Linux          MySQL     Average
No such person
<span class="token number">2</span>       BBB      <span class="token number">77</span>         <span class="token number">77</span>       <span class="token number">77</span>           <span class="token number">77</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>
<span class="token comment"># 恢复原AAA成绩</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'2c 1       AAA      66         66       66           66'</span> student2.txt
</code></pre> 
<h5><a id="5235_1746"></a>5.2.3.5、字符串替换</h5> 
<p>​ “c”动作是进行整行替换的，如果只想替换行中的部分数据，就要使用“s”动作了。g 使得 sed 对文件中所有符合的字符串都被替换, 修改后内容会到标准输出，不会修改原文件。</p> 
<p>​ 写法：<strong><code>sed '行范围s/旧字串/新字串/g' 文件名</code></strong></p> 
<pre><code class="prism language-shell"><span class="token comment"># 假设想作弊给BBB用户成绩改高点:</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sed</span> <span class="token string">'3s/77/99/g'</span> student2.txt
<span class="token comment">#在第三行中，把77换成99</span>
ID      Name    php      Linux          MySQL     Average
<span class="token number">1</span>       AAA      <span class="token number">66</span>         <span class="token number">66</span>       <span class="token number">66</span>           <span class="token number">66</span>
<span class="token number">2</span>       BBB      <span class="token number">99</span>         <span class="token number">99</span>       <span class="token number">99</span>           <span class="token number">99</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>

<span class="token comment"># 注释掉用户AAA的成绩</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sed</span> <span class="token string">'2s/^/#/g'</span> student2.txt
<span class="token comment">#这里使用正则表达式，“^”代表行首</span>
ID      Name    php      Linux          MySQL     Average
<span class="token comment">#1       AAA      66         66       66           66</span>
<span class="token number">2</span>       BBB      <span class="token number">77</span>         <span class="token number">77</span>       <span class="token number">77</span>           <span class="token number">77</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sed</span> <span class="token parameter variable">-e</span> <span class="token string">'s/AAA//g ; s/BBB//g'</span> student2.txt
<span class="token comment">#同时把“AAA”和“BBB”替换为空</span>
ID      Name    php      Linux          MySQL     Average
<span class="token number">1</span>             <span class="token number">66</span>         <span class="token number">66</span>       <span class="token number">66</span>           <span class="token number">66</span>
<span class="token number">2</span>             <span class="token number">77</span>         <span class="token number">77</span>       <span class="token number">77</span>           <span class="token number">77</span>
<span class="token number">3</span>       CCC      <span class="token number">88</span>         <span class="token number">88</span>       <span class="token number">88</span>           <span class="token number">88</span>
</code></pre> 
<h3><a id="53_1777"></a>5.3、字符处理命令</h3> 
<h4><a id="531sort__1779"></a>5.3.1、sort 排序命令</h4> 
<p><strong>语法：<code>sort [选项] 文件名</code></strong></p> 
<blockquote> 
 <p><strong>选项:</strong></p> 
 <ul><li>-f ：忽略大小写。</li><li>-b ：忽略每行前面的空白部分。</li><li>-n ：以数值型进行排序，默认使用字符串型排序。</li><li>-r ：反向排序。</li><li>-u ：删除重复行。就是uniq命令。</li><li>-t ：指定分隔符，默认是分隔符是制表符。</li><li>-k n[,m] ：按照指定的字段范围排序。从第n字段开始，到m字段结束（默认到行尾）。此处[]代表m为非必输。</li></ul> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token comment"># sort命令默认是用每行开头第一个字符来进行排序的。</span>

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sort</span> /etc/passwd
<span class="token comment">#排序用户信息文件</span>
abrt:x:173:173::/etc/abrt:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sort</span> <span class="token parameter variable">-r</span> /etc/passwd
<span class="token comment"># 反向排序</span>
tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
test6:x:1000:1000::/home/test6:/bin/bash
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出

<span class="token comment"># 指定排序的字段，使用“-t”指定分隔符，并使用“-k”选项指定字段号。加入我想要按照UID字段排序/etc/passwd文件:</span>
<span class="token punctuation">[</span>root@localhost~<span class="token punctuation">]</span>$ <span class="token function">sort</span> <span class="token parameter variable">-t</span> <span class="token string">":"</span> <span class="token parameter variable">-k</span> <span class="token number">3,3</span> /etc/passwd
<span class="token comment"># 指定分隔符是“:”，用第三字段开头，第三字段结尾排序，就是只用第三字段排序.</span>
<span class="token comment"># 第一个字符先排序，如果一致，第二个字符再排序.</span>
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
test6:x:1000:1000::/home/test6:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出
</code></pre> 
<h4><a id="532uniq__1824"></a>5.3.2、uniq 取消重复行</h4> 
<p><strong>语法：<code>uniq [选项] 文件名</code></strong><br> <strong>选项：</strong></p> 
<ul><li>-i ：忽略大小写。</li></ul> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> student.txt
<span class="token comment"># 查看文件内容</span>
<span class="token function">id</span>      name    gender  mark
no such person
no such person
No such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">uniq</span> student.txt
<span class="token comment"># 取消重复行，默认区分大小写。</span>
<span class="token function">id</span>      name    gender  mark
no such person
No such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">uniq</span> <span class="token parameter variable">-i</span> student.txt
<span class="token comment"># 取消重复行，-i 忽略大小写。</span>
<span class="token function">id</span>      name    gender  mark
no such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> student.txt
<span class="token comment"># 查看文件内容, 原文件内容未发生变化。</span>
<span class="token function">id</span>      name    gender  mark
no such person
no such person
No such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
</code></pre> 
<h4><a id="533wc__1863"></a>5.3.3、wc 统计命令</h4> 
<p><strong>语法：<code>wc [选项] 文件名</code></strong><br> <strong>选项：</strong></p> 
<ul><li>-l ：只统计行数。</li><li>-w ：只统计单词数。</li><li>-m ：只统计字符数。</li></ul> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">wc</span> student.txt
<span class="token comment"># student.txt文件有： 6行，21个单词，85个字符。 </span>
 <span class="token number">6</span> <span class="token number">21</span> <span class="token number">85</span> student.txt
adm:x:3:4:adm:/var/adm:/sbin/nologin
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">sort</span> <span class="token parameter variable">-r</span> /etc/passwd
<span class="token comment"># 反向排序</span>
tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
test6:x:1000:1000::/home/test6:/bin/bash
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出

<span class="token comment"># 指定排序的字段，使用“-t”指定分隔符，并使用“-k”选项指定字段号。加入我想要按照UID字段排序/etc/passwd文件:</span>
<span class="token punctuation">[</span>root@localhost~<span class="token punctuation">]</span>$ <span class="token function">sort</span> <span class="token parameter variable">-t</span> <span class="token string">":"</span> <span class="token parameter variable">-k</span> <span class="token number">3,3</span> /etc/passwd
<span class="token comment"># 指定分隔符是“:”，用第三字段开头，第三字段结尾排序，就是只用第三字段排序.</span>
<span class="token comment"># 第一个字符先排序，如果一致，第二个字符再排序.</span>
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
test6:x:1000:1000::/home/test6:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>此处省略部分输出
</code></pre> 
<h4><a id="532uniq__1901"></a>5.3.2、uniq 取消重复行</h4> 
<p><strong>语法：<code>uniq [选项] 文件名</code></strong><br> <strong>选项：</strong></p> 
<ul><li>-i ：忽略大小写。</li></ul> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> student.txt
<span class="token comment"># 查看文件内容</span>
<span class="token function">id</span>      name    gender  mark
no such person
no such person
No such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">uniq</span> student.txt
<span class="token comment"># 取消重复行，默认区分大小写。</span>
<span class="token function">id</span>      name    gender  mark
no such person
No such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">uniq</span> <span class="token parameter variable">-i</span> student.txt
<span class="token comment"># 取消重复行，-i 忽略大小写。</span>
<span class="token function">id</span>      name    gender  mark
no such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">cat</span> student.txt
<span class="token comment"># 查看文件内容, 原文件内容未发生变化。</span>
<span class="token function">id</span>      name    gender  mark
no such person
no such person
No such person
<span class="token number">2</span>       sc      m       <span class="token number">67</span>
<span class="token number">3</span>       tg      n       <span class="token number">90</span>
</code></pre> 
<h4><a id="533wc__1940"></a>5.3.3、wc 统计命令</h4> 
<p><strong>语法：<code>wc [选项] 文件名</code></strong><br> <strong>选项：</strong></p> 
<ul><li>-l ：只统计行数。</li><li>-w ：只统计单词数。</li><li>-m ：只统计字符数。</li></ul> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span>$ <span class="token function">wc</span> student.txt
<span class="token comment"># student.txt文件有： 6行，21个单词，85个字符。 </span>
 <span class="token number">6</span> <span class="token number">21</span> <span class="token number">85</span> student.txt
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ff489b2650814434bce410ad47d5cf2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">随手查_AD画板粗略步骤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/82c8bd924ead21c34798d38d402f55b7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于实现离线地图的几种方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>