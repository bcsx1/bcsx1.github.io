<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android11 部分定制修改（持续更新） - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android11 部分定制修改（持续更新）" />
<meta property="og:description" content="提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档
文章目录 前言1.修改之前的接4K显示器，默认4K60Hz记录2.移除launcher搜索框3.设置客户默认壁纸，添加客户壁纸到壁纸库4.内置客户需要的apk5.亮度条调节呈线性变化，修复99%~100%亮度突变的问题6.替换开机画面为客户给的画面7.修改默认语言为中文，修改设备名称型号与硬件为27M3U-A8.关闭systemUI中的下拉栏中的飞行模式，电源相关的saver9.清除主界面的应用图标10.移除点击菜单键跳出屏幕设置的弹窗11.修复下拉状态栏长按图标报错的问题12.在关机前执行的一些操作13.设备默认MTP模式（UsbDeviceManager.java）14.默认连接物理键盘时，开启屏幕键盘15.修改屏幕默认色温16.加入自定义按键17.开发者选项默认开启[HW停用叠加层]18.删除电源图标19.音量默认50%, notification volume默认为020.亮度线性变化后，80%-90%亮度变化小，90%-100%亮度变化大21.settings移除系统-&gt;手势-&gt;导航选项22.增加长按电源键广播，屏蔽原生的关机选项(为了规避navigation bar覆盖原生关机选项)23.如果使用某apk进行录像，那么不弹出录像提示框24.关闭双击电源键，启动相机的功能25.修改鼠标右键功能为返回键26.系统app开机自启动27.屏蔽特定cameraID28.修改音量曲线，减少其最大值，防止破音29.修复屏幕录制音频后，再播放时，右声道无声音问题30.移除闹铃音频编译31.因为权限，可能导致无法打开相机的问题32. 去除状态栏33.动态更换开机动画34. log增加func的显示35. 精确每一阶音量曲线 前言 Android11 源码部分修改
1.修改之前的接4K显示器，默认4K60Hz记录 @@ -1668,7 &#43;1668,7 @@ int setVideoResolution(int resolution) { setValue(HDMI_VIDEO_AUTO, 1); - if(resolution == 28){ &#43; if(resolution == 28 &amp;&amp; getValue(HDMI_VIDEO_AUTO,&#34;1&#34;) == 1){ resolution = 27; } 2.移除launcher搜索框 --- a/packages/apps/Launcher3/res/layout/search_container_workspace.xml &#43;&#43;&#43; b/packages/apps/Launcher3/res/layout/search_container_workspace.xml @@ -22,9 &#43;22,9 @@ android:id=&#34;@id/search_container_workspace&#34; android:padding=&#34;0dp&#34; &gt; - &lt;fragment &#43; &lt;!--fragment android:name=&#34;com.android.launcher3.qsb.QsbContainerView$QsbFragment&#34; android:layout_width=&#34;match_parent&#34; android:tag=&#34;qsb_view&#34; - android:layout_height=&#34;match_parent&#34;/&gt; &#43; android:layout_height=&#34;match_parent&#34;/--&gt; &lt;/com.android.launcher3.qsb.QsbContainerView&gt; \ No newline at end of file diff --git a/packages/apps/Launcher3/src/com/android/launcher3/Workspace." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/c4040a5e1cd0753c62e72131af884a8a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-16T15:27:26+08:00" />
<meta property="article:modified_time" content="2023-03-16T15:27:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android11 部分定制修改（持续更新）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#14K4K60Hz_11" rel="nofollow">1.修改之前的接4K显示器，默认4K60Hz记录</a></li><li><a href="#2launcher_22" rel="nofollow">2.移除launcher搜索框</a></li><li><a href="#3_83" rel="nofollow">3.设置客户默认壁纸，添加客户壁纸到壁纸库</a></li><li><a href="#4apk_108" rel="nofollow">4.内置客户需要的apk</a></li><li><a href="#599100_146" rel="nofollow">5.亮度条调节呈线性变化，修复99%~100%亮度突变的问题</a></li><li><a href="#6_221" rel="nofollow">6.替换开机画面为客户给的画面</a></li><li><a href="#727M3UA_227" rel="nofollow">7.修改默认语言为中文，修改设备名称型号与硬件为27M3U-A</a></li><li><a href="#8systemUIsaver_265" rel="nofollow">8.关闭systemUI中的下拉栏中的飞行模式，电源相关的saver</a></li><li><a href="#9_337" rel="nofollow">9.清除主界面的应用图标</a></li><li><a href="#10_345" rel="nofollow">10.移除点击菜单键跳出屏幕设置的弹窗</a></li><li><a href="#11_388" rel="nofollow">11.修复下拉状态栏长按图标报错的问题</a></li><li><a href="#12_423" rel="nofollow">12.在关机前执行的一些操作</a></li><li><a href="#13MTPUsbDeviceManagerjava_466" rel="nofollow">13.设备默认MTP模式（UsbDeviceManager.java）</a></li><li><a href="#14_519" rel="nofollow">14.默认连接物理键盘时，开启屏幕键盘</a></li><li><a href="#15_545" rel="nofollow">15.修改屏幕默认色温</a></li><li><a href="#16_562" rel="nofollow">16.加入自定义按键</a></li><li><a href="#17HW_611" rel="nofollow">17.开发者选项默认开启[HW停用叠加层]</a></li><li><a href="#18_668" rel="nofollow">18.删除电源图标</a></li><li><a href="#1950_notification_volume0_726" rel="nofollow">19.音量默认50%, notification volume默认为0</a></li><li><a href="#20809090100_797" rel="nofollow">20.亮度线性变化后，80%-90%亮度变化小，90%-100%亮度变化大</a></li><li><a href="#21settings_838" rel="nofollow">21.settings移除系统-&gt;手势-&gt;导航选项</a></li><li><a href="#22navigation_bar_858" rel="nofollow">22.增加长按电源键广播，屏蔽原生的关机选项(为了规避navigation bar覆盖原生关机选项)</a></li><li><a href="#23apk_887" rel="nofollow">23.如果使用某apk进行录像，那么不弹出录像提示框</a></li><li><a href="#24_902" rel="nofollow">24.关闭双击电源键，启动相机的功能</a></li><li><a href="#25_917" rel="nofollow">25.修改鼠标右键功能为返回键</a></li><li><a href="#26app_931" rel="nofollow">26.系统app开机自启动</a></li><li><a href="#27cameraID_1031" rel="nofollow">27.屏蔽特定cameraID</a></li><li><a href="#28_1081" rel="nofollow">28.修改音量曲线，减少其最大值，防止破音</a></li><li><a href="#29_1096" rel="nofollow">29.修复屏幕录制音频后，再播放时，右声道无声音问题</a></li><li><a href="#30_1103" rel="nofollow">30.移除闹铃音频编译</a></li><li><a href="#31_1116" rel="nofollow">31.因为权限，可能导致无法打开相机的问题</a></li><li><a href="#32__1139" rel="nofollow">32. 去除状态栏</a></li><li><a href="#33_1155" rel="nofollow">33.动态更换开机动画</a></li><li><a href="#34_logfunc_1219" rel="nofollow">34. log增加func的显示</a></li><li><a href="#35__1230" rel="nofollow">35. 精确每一阶音量曲线</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p>Android11 源码部分修改</p> 
<hr> 
<h2><a id="14K4K60Hz_11"></a>1.修改之前的接4K显示器，默认4K60Hz记录</h2> 
<pre><code class="prism language-c+++">@@ -1668,7 +1668,7 @@ int setVideoResolution(int resolution) {
         setValue(HDMI_VIDEO_AUTO, 1);
 
 
-    if(resolution == 28){
+    if(resolution == 28 &amp;&amp; getValue(HDMI_VIDEO_AUTO,"1") == 1){
         resolution = 27;
     }
</code></pre> 
<h2><a id="2launcher_22"></a>2.移除launcher搜索框</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>search_container_workspace<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>search_container_workspace<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">9</span> <span class="token operator">+</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">9</span> @@
         android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">"@id/search_container_workspace"</span>
         android<span class="token operator">:</span>padding<span class="token operator">=</span><span class="token string">"0dp"</span> <span class="token operator">&gt;</span>
 
<span class="token operator">-</span>    <span class="token operator">&lt;</span>fragment
<span class="token operator">+</span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>fragment
         android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"com.android.launcher3.qsb.QsbContainerView$QsbFragment"</span>
         android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">"match_parent"</span>
         android<span class="token operator">:</span>tag<span class="token operator">=</span><span class="token string">"qsb_view"</span>
<span class="token operator">-</span>        android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">"match_parent"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">+</span>        android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">"match_parent"</span><span class="token operator">/</span><span class="token operator">--</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>launcher3<span class="token punctuation">.</span>qsb<span class="token punctuation">.</span>QsbContainerView<span class="token operator">&gt;</span>
\ No newline at end of file
diff <span class="token operator">--</span>git a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Workspace<span class="token punctuation">.</span>java b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Workspace<span class="token punctuation">.</span>java
index <span class="token number">1441e0</span>b93b<span class="token punctuation">.</span><span class="token number">.4</span>a5d7b71f7 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Workspace<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Workspace<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">512</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token operator">+</span><span class="token number">512</span><span class="token punctuation">,</span><span class="token number">12</span> @@ public class Workspace extends PagedView<span class="token operator">&lt;</span>WorkspacePageIndicator<span class="token operator">&gt;</span>
         <span class="token punctuation">}</span>
 
         CellLayout<span class="token punctuation">.</span>LayoutParams lp <span class="token operator">=</span> new CellLayout<span class="token punctuation">.</span><span class="token function">LayoutParams</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> firstPage<span class="token punctuation">.</span><span class="token function">getCountX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">/** 
         lp.canReorder = false;
         if (!firstPage.addViewToCellLayout(qsb, 0, R.id.search_container_workspace, lp, true)) {
             Log.e(TAG, "Failed to add to item at (0, 0) to CellLayout");
         }
+        */</span>
     <span class="token punctuation">}</span>
 
     public <span class="token keyword">void</span> <span class="token function">removeAllWorkspaceScreens</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsContainerView<span class="token punctuation">.</span>java b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsContainerView<span class="token punctuation">.</span>java
index c989e7bf64<span class="token punctuation">.</span><span class="token punctuation">.</span>e3c94c1a19 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsContainerView<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsContainerView<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">318</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">318</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AllAppsContainerView extends SpringRelativeLayout implements DragSo
         mSearchContainer <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>search_container_all_apps<span class="token punctuation">)</span><span class="token punctuation">;</span>
         mSearchUiManager <span class="token operator">=</span> <span class="token punctuation">(</span>SearchUiManager<span class="token punctuation">)</span> mSearchContainer<span class="token punctuation">;</span>
         mSearchUiManager<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        mSearchContainer<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
     public SearchUiManager <span class="token function">getSearchUiManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsTransitionController<span class="token punctuation">.</span>java b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsTransitionCon
troller<span class="token punctuation">.</span>java
index a9b030e056<span class="token punctuation">.</span><span class="token number">.7</span>c017d2d4d <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsTransitionController<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>allapps<span class="token operator">/</span>AllAppsTransitionController<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">211</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">211</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AllAppsTransitionController implements StateHandler<span class="token operator">&lt;</span>LauncherState<span class="token operator">&gt;</span><span class="token punctuation">,</span>
             setter<span class="token punctuation">.</span><span class="token function">setViewAlpha</span><span class="token punctuation">(</span>mAppsView<span class="token punctuation">.</span><span class="token function">getContentView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> allAppsFade<span class="token punctuation">)</span><span class="token punctuation">;</span>
             setter<span class="token punctuation">.</span><span class="token function">setViewAlpha</span><span class="token punctuation">(</span>mAppsView<span class="token punctuation">.</span><span class="token function">getScrollBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> allAppsFade<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token operator">-</span>        mAppsView<span class="token punctuation">.</span><span class="token function">getSearchUiManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setContentVisibility</span><span class="token punctuation">(</span>visibleElements<span class="token punctuation">,</span> setter<span class="token punctuation">,</span> allAppsFade<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//mAppsView.getSearchUiManager().setContentVisibility(visibleElements, setter, allAppsFade);</span>
 
         setter<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span>mScrimView<span class="token punctuation">,</span> ScrimView<span class="token punctuation">.</span>DRAG_HANDLE_ALPHA<span class="token punctuation">,</span>
                 <span class="token punctuation">(</span>visibleElements <span class="token operator">&amp;</span> VERTICAL_SWIPE_INDICATOR<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">255</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> allAppsFade<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="3_83"></a>3.设置客户默认壁纸，添加客户壁纸到壁纸库</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">-</span>sw720dp<span class="token operator">-</span>nodpi<span class="token operator">/</span>default_wallpaper<span class="token punctuation">.</span>png b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">-</span>sw720dp<span class="token operator">-</span>nodpi<span class="token operator">/</span>default_wallpaper<span class="token punctuation">.</span>png
index cb00d82a82<span class="token punctuation">.</span><span class="token punctuation">.</span>ecf08e015d <span class="token number">100644</span>
Binary files a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">-</span>sw720dp<span class="token operator">-</span>nodpi<span class="token operator">/</span>default_wallpaper<span class="token punctuation">.</span>png and b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">-</span>sw720dp<span class="token operator">-</span>nodpi<span class="token operator">/</span>default_wallpaper<span class="token punctuation">.</span>png differ
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">/</span>default_wallpaper01<span class="token punctuation">.</span>png b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">/</span>default_wallpaper01<span class="token punctuation">.</span>png
new file mode <span class="token number">100644</span>
index <span class="token number">0000000000.</span><span class="token punctuation">.</span>f8b0cbb1b6
Binary files <span class="token operator">/</span>dev<span class="token operator">/</span>null and b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">/</span>default_wallpaper01<span class="token punctuation">.</span>png differ
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">/</span>default_wallpaper01_small<span class="token punctuation">.</span>png b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">/</span>default_wallpaper01_small<span class="token punctuation">.</span>png
new file mode <span class="token number">100644</span>
index <span class="token number">0000000000.</span><span class="token punctuation">.</span>f8b0cbb1b6
Binary files <span class="token operator">/</span>dev<span class="token operator">/</span>null and b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>drawable<span class="token operator">/</span>default_wallpaper01_small<span class="token punctuation">.</span>png differ
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">-</span>nodpi<span class="token operator">/</span>wallpapers<span class="token punctuation">.</span>xml b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">-</span>nodpi<span class="token operator">/</span>wallpapers<span class="token punctuation">.</span>xml
index <span class="token number">1e340</span>e4b28<span class="token punctuation">.</span><span class="token number">.57708</span>d1f25 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">-</span>nodpi<span class="token operator">/</span>wallpapers<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>WallpaperPicker<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">-</span>nodpi<span class="token operator">/</span>wallpapers<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">5</span> <span class="token operator">+</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">6</span> @@
 
 <span class="token operator">&lt;</span>resources<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>string<span class="token operator">-</span>array name<span class="token operator">=</span><span class="token string">"wallpapers"</span> translatable<span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">&gt;</span>
<span class="token operator">+</span>    <span class="token operator">&lt;</span>item<span class="token operator">&gt;</span>default_wallpaper01<span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>string<span class="token operator">-</span>array<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>resources<span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="4apk_108"></a>4.内置客户需要的apk</h2> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>build<span class="token operator">/</span>make<span class="token operator">/</span>target<span class="token operator">/</span>product<span class="token operator">/</span>handheld_product<span class="token punctuation">.</span>mk
@@ <span class="token operator">-</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">12</span> @@ PRODUCT_PACKAGES <span class="token operator">+=</span> \
     preinstalled<span class="token operator">-</span>packages<span class="token operator">-</span>platform<span class="token operator">-</span>handheld<span class="token operator">-</span>product<span class="token punctuation">.</span>xml \
     QuickSearchBox \
     SettingsIntelligence \
<span class="token operator">-</span>    frameworks<span class="token operator">-</span>base<span class="token operator">-</span>overlays
<span class="token operator">+</span>    frameworks<span class="token operator">-</span>base<span class="token operator">-</span>overlays \
<span class="token operator">+</span>    chrome \

<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Chrome<span class="token operator">/</span>Android<span class="token punctuation">.</span>mk
@@ <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span> @@
<span class="token operator">+</span># <span class="token comment">///ADD START</span>
<span class="token operator">+</span># <span class="token comment">///ADD END</span>
<span class="token operator">+</span># 设置当前工作路径
<span class="token operator">+</span>LOCAL_PATH<span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>call my<span class="token operator">-</span>dir<span class="token punctuation">)</span>
<span class="token operator">+</span># 清除变量值
<span class="token operator">+</span>include $<span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
<span class="token operator">+</span># 生成的模块名称
<span class="token operator">+</span>LOCAL_MODULE <span class="token operator">:</span><span class="token operator">=</span> chrome
<span class="token operator">+</span># 生成的模块类型
<span class="token operator">+</span>LOCAL_MODULE_CLASS <span class="token operator">:</span><span class="token operator">=</span> APPS
<span class="token operator">+</span># 生成的模块后缀名<span class="token punctuation">,</span>此处为apk
<span class="token operator">+</span>LOCAL_MODULE_SUFFIX <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>COMMON_ANDROID_PACKAGE_SUFFIX<span class="token punctuation">)</span>
<span class="token operator">+</span># 设置模块tag，tags取值可以为<span class="token operator">:</span>user debug eng tests optional
<span class="token operator">+</span># optional表示全平台编译
<span class="token operator">+</span>LOCAL_MODULE_TAGS <span class="token operator">:</span><span class="token operator">=</span> optional
<span class="token operator">+</span># LOCAL_PRIVILEGED_MODULE <span class="token operator">:</span><span class="token operator">=</span> true
<span class="token operator">+</span>LOCAL_BUILT_MODULE_STEM <span class="token operator">:</span><span class="token operator">=</span> package<span class="token punctuation">.</span>apk
<span class="token operator">+</span># 设置源文件
<span class="token operator">+</span>LOCAL_SRC_FILES <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>LOCAL_MODULE<span class="token punctuation">)</span><span class="token punctuation">.</span>apk
<span class="token operator">+</span># LOCAL_CERTIFICATE <span class="token operator">:</span><span class="token operator">=</span> platform
<span class="token operator">+</span># 设置签名，此处表示保持apk原有签名
<span class="token operator">+</span>LOCAL_CERTIFICATE <span class="token operator">:</span><span class="token operator">=</span> PRESIGNED
<span class="token operator">+</span># 此处表示预编译方式
<span class="token operator">+</span>include $<span class="token punctuation">(</span>BUILD_PREBUILT<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="599100_146"></a>5.亮度条调节呈线性变化，修复99%~100%亮度突变的问题</h2> 
<pre><code class="prism language-c"><span class="token comment">//Android11 其亮度随亮度调变化是呈现非线性的，用了新的算法，我们这里修改一下</span>
<span class="token comment">//255太亮了，我们这里设置最大亮度值未241</span>
<span class="token comment">/*
	几个数值的说明
	0.94486916F == 241/255		我们自己设定的亮度值百分比
	65535						亮度条最大的数值
*/</span>
<span class="token comment">//设置亮度最大值241</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">1178</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">1178</span><span class="token punctuation">,</span><span class="token number">7</span> @@
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Note<span class="token operator">:</span> This setting is deprecated<span class="token punctuation">,</span> please use
     config_screenBrightnessSettingMaximumFloat instead <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>    <span class="token operator">&lt;</span>integer name<span class="token operator">=</span><span class="token string">"config_screenBrightnessSettingMaximum"</span><span class="token operator">&gt;</span><span class="token number">255</span><span class="token operator">&lt;</span><span class="token operator">/</span>integer<span class="token operator">&gt;</span>
<span class="token operator">+</span>    <span class="token operator">&lt;</span>integer name<span class="token operator">=</span><span class="token string">"config_screenBrightnessSettingMaximum"</span><span class="token operator">&gt;</span><span class="token number">241</span><span class="token operator">&lt;</span><span class="token operator">/</span>integer<span class="token operator">&gt;</span>

<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>settings<span class="token operator">/</span>display<span class="token operator">/</span>BrightnessLevelPreferenceController<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>settings<span class="token operator">/</span>display<span class="token operator">/</span>BrightnessLevelPreferenceController<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">141</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token operator">+</span><span class="token number">141</span><span class="token punctuation">,</span><span class="token number">24</span> @@ public class BrightnessLevelPreferenceController extends AbstractPreferenceContr
                     System<span class="token punctuation">.</span>SCREEN_BRIGHTNESS_FOR_VR_FLOAT<span class="token punctuation">,</span> mMaxBrightness<span class="token punctuation">)</span><span class="token punctuation">,</span>
                     mMinVrBrightness<span class="token punctuation">,</span> mMaxVrBrightness<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            
             value <span class="token operator">=</span> <span class="token function">convertLinearToGammaFloat</span><span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>System<span class="token punctuation">.</span><span class="token function">getFloat</span><span class="token punctuation">(</span>mContentResolver<span class="token punctuation">,</span>
                     System<span class="token punctuation">.</span>SCREEN_BRIGHTNESS_FLOAT<span class="token punctuation">,</span> mDefaultBacklight<span class="token punctuation">)</span><span class="token punctuation">,</span>
                     mMinBrightness<span class="token punctuation">,</span> mMaxBrightness<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token operator">-</span>        <span class="token keyword">return</span> <span class="token function">getPercentage</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> GAMMA_SPACE_MIN<span class="token punctuation">,</span> GAMMA_SPACE_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
<span class="token operator">+</span>        <span class="token keyword">int</span> val <span class="token operator">=</span> Settings<span class="token punctuation">.</span>System<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span>mContentResolver<span class="token punctuation">,</span> System<span class="token punctuation">.</span>SCREEN_BRIGHTNESS<span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&gt;</span> <span class="token number">241</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            Settings<span class="token punctuation">.</span>System<span class="token punctuation">.</span><span class="token function">putInt</span><span class="token punctuation">(</span>mContentResolver<span class="token punctuation">,</span> System<span class="token punctuation">.</span>SCREEN_BRIGHTNESS<span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>            val <span class="token operator">=</span> <span class="token number">241</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span>
<span class="token operator">+</span>        
<span class="token operator">+</span>        <span class="token comment">//return getPercentage(value, GAMMA_SPACE_MIN, GAMMA_SPACE_MAX);</span>
<span class="token operator">+</span>        <span class="token keyword">return</span> <span class="token function">getPercentage</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
     private <span class="token keyword">double</span> <span class="token function">getPercentage</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">,</span> <span class="token keyword">int</span> min<span class="token punctuation">,</span> <span class="token keyword">int</span> max<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token keyword">return</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>settings<span class="token operator">/</span>BrightnessController<span class="token punctuation">.</span>java b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com
<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>settings<span class="token operator">/</span>BrightnessController<span class="token punctuation">.</span>java
index <span class="token number">71e788375</span>d<span class="token punctuation">.</span><span class="token punctuation">.</span>ad9548ceed <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>settings<span class="token operator">/</span>BrightnessController<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>settings<span class="token operator">/</span>BrightnessController<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">379</span><span class="token punctuation">,</span><span class="token number">9</span> <span class="token operator">+</span><span class="token number">379</span><span class="token punctuation">,</span><span class="token number">12</span> @@ public class BrightnessController implements ToggleSlider<span class="token punctuation">.</span>Listener <span class="token punctuation">{<!-- --></span>
             maxBacklight <span class="token operator">=</span> mMaximumBacklight<span class="token punctuation">;</span>
             settingToChange <span class="token operator">=</span> Settings<span class="token punctuation">.</span>System<span class="token punctuation">.</span>SCREEN_BRIGHTNESS_FLOAT<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token operator">+</span>        <span class="token comment">/*
         final float valFloat = MathUtils.min(convertGammaToLinearFloat(value,
                 minBacklight, maxBacklight),
                 1.0f);
+        */</span>
<span class="token operator">+</span>        final <span class="token keyword">float</span> valFloat <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>value <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token number">65535</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.94486916F</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>stopTracking<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token comment">// TODO(brightnessfloat): change to use float value instead.</span>
             MetricsLogger<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span>mContext<span class="token punctuation">,</span> metric<span class="token punctuation">,</span>
@@ <span class="token operator">-</span><span class="token number">450</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">453</span><span class="token punctuation">,</span><span class="token number">8</span> @@ public class BrightnessController implements ToggleSlider<span class="token punctuation">.</span>Listener <span class="token punctuation">{<!-- --></span>
             <span class="token keyword">return</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token comment">// Returns GAMMA_SPACE_MIN - GAMMA_SPACE_MAX</span>
<span class="token operator">-</span>        final <span class="token keyword">int</span> sliderVal <span class="token operator">=</span> <span class="token function">convertLinearToGammaFloat</span><span class="token punctuation">(</span>brightnessValue<span class="token punctuation">,</span> min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//final int sliderVal = convertLinearToGammaFloat(brightnessValue, min, max);</span>
<span class="token operator">+</span>        final <span class="token keyword">int</span> sliderVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>brightnessValue <span class="token operator">/</span> <span class="token number">0.94486916F</span><span class="token punctuation">)</span>  <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">animateSliderTo</span><span class="token punctuation">(</span>sliderVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="6_221"></a>6.替换开机画面为客户给的画面</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>bootable<span class="token operator">/</span>bootloader<span class="token operator">/</span>lk<span class="token operator">/</span>dev<span class="token operator">/</span>logo<span class="token operator">/</span>wuxga<span class="token operator">/</span>wuxga_uboot_3840_2160<span class="token punctuation">.</span>bmp b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>bootable<span class="token operator">/</span>bootloader<span class="token operator">/</span>lk<span class="token operator">/</span>dev<span class="token operator">/</span>logo<span class="token operator">/</span>wuxga<span class="token operator">/</span>wuxga_uboot_3840_2160<span class="token punctuation">.</span>bmp
index bed0bf0c89<span class="token punctuation">.</span><span class="token number">.43630442</span>d2 <span class="token number">100644</span>
Binary files a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>bootable<span class="token operator">/</span>bootloader<span class="token operator">/</span>lk<span class="token operator">/</span>dev<span class="token operator">/</span>logo<span class="token operator">/</span>wuxga<span class="token operator">/</span>wuxga_uboot_3840_2160<span class="token punctuation">.</span>bmp and b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>bootable<span class="token operator">/</span>bootloader<span class="token operator">/</span>lk<span class="token operator">/</span>dev<span class="token operator">/</span>logo<span class="token operator">/</span>wuxga<span class="token operator">/</span>wuxga_uboot_3840_2160<span class="token punctuation">.</span>bmp differ
</code></pre> 
<h2><a id="727M3UA_227"></a>7.修改默认语言为中文，修改设备名称型号与硬件为27M3U-A</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>build<span class="token operator">/</span>make<span class="token operator">/</span>tools<span class="token operator">/</span>buildinfo<span class="token punctuation">.</span>sh b<span class="token operator">/</span>build<span class="token operator">/</span>make<span class="token operator">/</span>tools<span class="token operator">/</span>buildinfo<span class="token punctuation">.</span>sh
index <span class="token number">9</span>bee115484<span class="token punctuation">.</span><span class="token punctuation">.</span>a1f97c4252 <span class="token number">100755</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>build<span class="token operator">/</span>make<span class="token operator">/</span>tools<span class="token operator">/</span>buildinfo<span class="token punctuation">.</span>sh
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>build<span class="token operator">/</span>make<span class="token operator">/</span>tools<span class="token operator">/</span>buildinfo<span class="token punctuation">.</span>sh
@@ <span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">8</span> @@ fi
 echo <span class="token string">"ro.wifi.channels=$PRODUCT_DEFAULT_WIFI_CHANNELS"</span>
 
 echo <span class="token string">"# ro.build.product is obsolete; use ro.product.device"</span>
<span class="token operator">-</span>echo <span class="token string">"ro.build.product=$TARGET_DEVICE"</span>
<span class="token operator">+</span>#echo <span class="token string">"ro.build.product=$TARGET_DEVICE"</span>
<span class="token operator">+</span>echo <span class="token string">"ro.build.product=27M3U-A"</span>
 
 echo <span class="token string">"# Do not try to parse description or thumbprint"</span>
 echo <span class="token string">"ro.build.description=$PRIVATE_BUILD_DESC"</span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>device<span class="token operator">/</span>emdoor<span class="token operator">/</span>C27C4<span class="token operator">/</span>vnd_C27C4<span class="token punctuation">.</span>mk b<span class="token operator">/</span>device<span class="token operator">/</span>emdoor<span class="token operator">/</span>C27C4<span class="token operator">/</span>vnd_C27C4<span class="token punctuation">.</span>mk
index de9dd75575<span class="token punctuation">.</span><span class="token number">.0f</span>c38c1934 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>device<span class="token operator">/</span>emdoor<span class="token operator">/</span>C27C4<span class="token operator">/</span>vnd_C27C4<span class="token punctuation">.</span>mk
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>device<span class="token operator">/</span>emdoor<span class="token operator">/</span>C27C4<span class="token operator">/</span>vnd_C27C4<span class="token punctuation">.</span>mk
@@ <span class="token operator">-</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">13</span> <span class="token operator">+</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">13</span> @@ PRODUCT_BUILD_PRODUCT_IMAGE <span class="token operator">:</span><span class="token operator">=</span> false
 endif
 
 <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">set</span> <span class="token expression">locales <span class="token operator">&amp;</span> aapt config<span class="token punctuation">.</span></span></span>
<span class="token operator">-</span>PRODUCT_LOCALES <span class="token operator">:</span><span class="token operator">=</span> en_US zh_CN zh_TW es_ES pt_BR ru_RU fr_FR de_DE tr_TR vi_VN ms_MY in_ID th_TH it_IT ar_EG hi_IN bn_IN ur_PK fa_IR pt_PT nl_NL el_GR hu_HU tl_PH ro_RO cs_CZ ko_KR km
_KH iw_IL my_MM pl_PL es_US bg_BG hr_HR lv_LV lt_LT sk_SK uk_UA de_AT da_DK fi_FI nb_NO sv_SE en_GB hy_AM zh_HK et_EE ja_JP kk_KZ sr_RS sl_SI ca_ES
<span class="token operator">+</span>PRODUCT_LOCALES <span class="token operator">:</span><span class="token operator">=</span> zh_CN en_US zh_TW es_ES pt_BR ru_RU fr_FR de_DE tr_TR vi_VN ms_MY in_ID th_TH it_IT ar_EG hi_IN bn_IN ur_PK fa_IR pt_PT nl_NL el_GR hu_HU tl_PH ro_RO cs_CZ ko_KR km
_KH iw_IL my_MM pl_PL es_US bg_BG hr_HR lv_LV lt_LT sk_SK uk_UA de_AT da_DK fi_FI nb_NO sv_SE en_GB hy_AM zh_HK et_EE ja_JP kk_KZ sr_RS sl_SI ca_ES
 
 <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Set those variables here to overwrite the inherited values<span class="token punctuation">.</span></span></span>
 PRODUCT_MANUFACTURER <span class="token operator">:</span><span class="token operator">=</span> innocn
 PRODUCT_NAME <span class="token operator">:</span><span class="token operator">=</span> vnd_C27C4
 PRODUCT_DEVICE <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>strip $<span class="token punctuation">(</span>MTK_BASE_PROJECT<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">-</span>PRODUCT_MODEL <span class="token operator">:</span><span class="token operator">=</span> C27C4
<span class="token operator">+</span>PRODUCT_MODEL <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">27</span>M3U<span class="token operator">-</span>A
 PRODUCT_POLICY <span class="token operator">:</span><span class="token operator">=</span> android<span class="token punctuation">.</span>policy_phone
 PRODUCT_BRAND <span class="token operator">:</span><span class="token operator">=</span> innocn
</code></pre> 
<h2><a id="8systemUIsaver_265"></a>8.关闭systemUI中的下拉栏中的飞行模式，电源相关的saver</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>settings<span class="token operator">/</span>SettingsActivity<span class="token punctuation">.</span>java b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>settings<span class="token operator">/</span>SettingsActivity<span class="token punctuation">.</span>java
index <span class="token number">3681</span>ad2f46<span class="token punctuation">.</span><span class="token punctuation">.</span>bca2196b01 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>settings<span class="token operator">/</span>SettingsActivity<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>settings<span class="token operator">/</span>SettingsActivity<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">485</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">485</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class SettingsActivity extends SettingsBaseActivity
         LocalBroadcastManager<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerReceiver</span><span class="token punctuation">(</span>mDevelopmentSettingsListener<span class="token punctuation">,</span>
                 new <span class="token function">IntentFilter</span><span class="token punctuation">(</span>DevelopmentSettingsEnabler<span class="token punctuation">.</span>DEVELOPMENT_SETTINGS_CHANGED_ACTION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token operator">-</span>        <span class="token function">registerReceiver</span><span class="token punctuation">(</span>mBatteryInfoReceiver<span class="token punctuation">,</span> new <span class="token function">IntentFilter</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_BATTERY_CHANGED<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//registerReceiver(mBatteryInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));</span>
 
         <span class="token function">updateTilesList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
@@ <span class="token operator">-</span><span class="token number">495</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">495</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class SettingsActivity extends SettingsBaseActivity
         super<span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         LocalBroadcastManager<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unregisterReceiver</span><span class="token punctuation">(</span>mDevelopmentSettingsListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
         mDevelopmentSettingsListener <span class="token operator">=</span> null<span class="token punctuation">;</span>
<span class="token operator">-</span>        <span class="token function">unregisterReceiver</span><span class="token punctuation">(</span>mBatteryInfoReceiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//unregisterReceiver(mBatteryInfoReceiver);</span>
     <span class="token punctuation">}</span>
 
     @Override
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>quick_qs_status_icons<span class="token punctuation">.</span>xml b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>quick_qs_status_ico
ns<span class="token punctuation">.</span>xml
index <span class="token number">44f</span><span class="token number">52</span>efd17<span class="token punctuation">.</span><span class="token number">.12</span>b0a7ebfa <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>quick_qs_status_icons<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>quick_qs_status_icons<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">7</span> @@
         android<span class="token operator">:</span>paddingEnd<span class="token operator">=</span><span class="token string">"@dimen/signal_cluster_battery_padding"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span>com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>BatteryMeterView
<span class="token operator">+</span>        android<span class="token operator">:</span>visibility<span class="token operator">=</span><span class="token string">"gone"</span>
         android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">"@+id/batteryRemainingIcon"</span>
         android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">"match_parent"</span>
         android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">"wrap_content"</span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>system_icons<span class="token punctuation">.</span>xml b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>system_icons<span class="token punctuation">.</span>xml
index <span class="token number">818</span>d1d7717<span class="token punctuation">.</span><span class="token number">.2f</span><span class="token number">7</span>b569267 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>system_icons<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>system_icons<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">7</span> @@
         android<span class="token operator">:</span>orientation<span class="token operator">=</span><span class="token string">"horizontal"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span>com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>BatteryMeterView android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">"@+id/battery"</span>
<span class="token operator">+</span>        android<span class="token operator">:</span>visibility<span class="token operator">=</span><span class="token string">"gone"</span>
         android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">"match_parent"</span>
         android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">"wrap_content"</span>
         android<span class="token operator">:</span>clipToPadding<span class="token operator">=</span><span class="token string">"false"</span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
index <span class="token number">848</span>cdb1e83<span class="token punctuation">.</span><span class="token punctuation">.</span>ab3c66a3ac <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">7</span> @@
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> The <span class="token keyword">default</span> tiles to display in QuickSettings <span class="token operator">--</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>string name<span class="token operator">=</span><span class="token string">"quick_settings_tiles_default"</span> translatable<span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>        wifi<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>rotation<span class="token punctuation">,</span>battery<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>airplane<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>screenrecord
<span class="token operator">+</span>        wifi<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>screenrecord
     <span class="token operator">&lt;</span><span class="token operator">/</span>string<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> The minimum number of tiles to display in QuickSettings <span class="token operator">--</span><span class="token operator">&gt;</span>
@@ <span class="token operator">-</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">7</span> @@
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Tiles native to System UI<span class="token punctuation">.</span> Order should match <span class="token string">"quick_settings_tiles_default"</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>string name<span class="token operator">=</span><span class="token string">"quick_settings_tiles_stock"</span> translatable<span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>        wifi<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>battery<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>rotation<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>airplane<span class="token punctuation">,</span>location<span class="token punctuation">,</span>hotspot<span class="token punctuation">,</span>inversion<span class="token punctuation">,</span>saver<span class="token punctuation">,</span>dark<span class="token punctuation">,</span>work<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>night<span class="token punctuation">,</span>screenrecord<span class="token punctuation">,</span>reverse
<span class="token operator">+</span>        wifi<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>location<span class="token punctuation">,</span>hotspot<span class="token punctuation">,</span>inversion<span class="token punctuation">,</span>dark<span class="token punctuation">,</span>work<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>night<span class="token punctuation">,</span>screenrecord<span class="token punctuation">,</span>reverse
     <span class="token operator">&lt;</span><span class="token operator">/</span>string<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> The tiles to display in QuickSettings <span class="token operator">--</span><span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="9_337"></a>9.清除主界面的应用图标</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>res<span class="token operator">/</span>xml<span class="token operator">/</span>default_workspace_3x3<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>res<span class="token operator">/</span>xml<span class="token operator">/</span>default_workspace_3x3<span class="token punctuation">.</span>xml
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>res<span class="token operator">/</span>xml<span class="token operator">/</span>default_workspace_4x4<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>res<span class="token operator">/</span>xml<span class="token operator">/</span>default_workspace_4x4<span class="token punctuation">.</span>xml
<span class="token comment">//有些在vendor，按需去掉应用</span>
</code></pre> 
<h2><a id="10_345"></a>10.移除点击菜单键跳出屏幕设置的弹窗</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java
index <span class="token number">0970</span>dae479<span class="token punctuation">.</span><span class="token punctuation">.</span>b9de23fb4b <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">2650</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">2650</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class Launcher extends StatefulActivity<span class="token operator">&lt;</span>LauncherState<span class="token operator">&gt;</span> implements Launche
 
     @Override
     public boolean <span class="token function">onKeyUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> keyCode<span class="token punctuation">,</span> KeyEvent event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        <span class="token comment">/*
         if (keyCode == KeyEvent.KEYCODE_MENU) {
             // KEYCODE_MENU is sent by some tests, for example
             // LauncherJankTests#testWidgetsContainerFling. Don't just remove its handling.
@@ -2667,6 +2668,7 @@ public class Launcher extends StatefulActivity&lt;LauncherState&gt; implements Launche
             }
             return true;
         }
+        */</span>
         <span class="token keyword">return</span> super<span class="token punctuation">.</span><span class="token function">onKeyUp</span><span class="token punctuation">(</span>keyCode<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3
<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java
index <span class="token number">1e1233</span>eea2<span class="token punctuation">.</span><span class="token number">.38</span>c35454a2 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>Launcher3<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>launcher3<span class="token operator">/</span>Launcher<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">2690</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">2690</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class Launcher extends StatefulActivity<span class="token operator">&lt;</span>LauncherState<span class="token operator">&gt;</span> implements Launche
 
     @Override
     public boolean <span class="token function">onKeyUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> keyCode<span class="token punctuation">,</span> KeyEvent event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        <span class="token comment">/*
         if (keyCode == KeyEvent.KEYCODE_MENU) {
             // KEYCODE_MENU is sent by some tests, for example
             // LauncherJankTests#testWidgetsContainerFling. Don't just remove its handling.
@@ -2707,6 +2708,7 @@ public class Launcher extends StatefulActivity&lt;LauncherState&gt; implements Launche
             }
             return true;
         }
+        */</span>
         <span class="token keyword">return</span> super<span class="token punctuation">.</span><span class="token function">onKeyUp</span><span class="token punctuation">(</span>keyCode<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="11_388"></a>11.修复下拉状态栏长按图标报错的问题</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>statusbar<span class="token operator">/</span>phone<span class="token operator">/</span>StatusBar<span class="token punctuation">.</span>java b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>statusbar<span class="token operator">/</span>phone<span class="token operator">/</span>StatusBar<span class="token punctuation">.</span>java
index <span class="token number">27</span>d6901f42<span class="token punctuation">.</span><span class="token number">.95</span>bda3e26a <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>statusbar<span class="token operator">/</span>phone<span class="token operator">/</span>StatusBar<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>statusbar<span class="token operator">/</span>phone<span class="token operator">/</span>StatusBar<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">2692</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">2692</span><span class="token punctuation">,</span><span class="token number">14</span> @@ public class StatusBar extends SystemUI implements DemoMode<span class="token punctuation">,</span>
         <span class="token function">startActivityDismissingKeyguard</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> onlyProvisioned<span class="token punctuation">,</span> dismissShade<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
<span class="token operator">+</span>    <span class="token comment">// Monkey SystemUI AsyncTask RuntimeException</span>
<span class="token operator">+</span>    private Runnable mRunnable <span class="token operator">=</span> new <span class="token function">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        @Override
<span class="token operator">+</span>        public <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            mAssistManagerLazy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hideAssist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span>
<span class="token operator">+</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
     public <span class="token keyword">void</span> <span class="token function">startActivityDismissingKeyguard</span><span class="token punctuation">(</span>final Intent intent<span class="token punctuation">,</span> boolean onlyProvisioned<span class="token punctuation">,</span>
             final boolean dismissShade<span class="token punctuation">,</span> final boolean disallowEnterPictureInPictureWhileLaunching<span class="token punctuation">,</span>
             final Callback callback<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
@@ <span class="token operator">-</span><span class="token number">2700</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">2708</span><span class="token punctuation">,</span><span class="token number">10</span> @@ public class StatusBar extends SystemUI implements DemoMode<span class="token punctuation">,</span>
         final boolean afterKeyguardGone <span class="token operator">=</span> mActivityIntentHelper<span class="token punctuation">.</span><span class="token function">wouldLaunchResolverActivity</span><span class="token punctuation">(</span>
                 intent<span class="token punctuation">,</span> mLockscreenUserManager<span class="token punctuation">.</span><span class="token function">getCurrentUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         Runnable runnable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">-</span>            mAssistManagerLazy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hideAssist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>            <span class="token comment">// Monkey SystemUI AsyncTask RuntimeException</span>
<span class="token operator">+</span>            <span class="token comment">//mAssistManagerLazy.get().hideAssist();</span>
<span class="token operator">+</span>            mHandler<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>mRunnable<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>            <span class="token comment">// End</span>
             intent<span class="token punctuation">.</span><span class="token function">setFlags</span><span class="token punctuation">(</span>
                     Intent<span class="token punctuation">.</span>FLAG_ACTIVITY_NEW_TASK <span class="token operator">|</span> Intent<span class="token punctuation">.</span>FLAG_ACTIVITY_CLEAR_TOP<span class="token punctuation">)</span><span class="token punctuation">;</span>
             intent<span class="token punctuation">.</span><span class="token function">addFlags</span><span class="token punctuation">(</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="12_423"></a>12.在关机前执行的一些操作</h2> 
<pre><code class="prism language-c"><span class="token comment">//文件路径：frameworks/base/services/core/java/com/android/server/power/ShutdownThread.java</span>
public <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// First send the high-level shut down broadcast.</span>
	mActionDone <span class="token operator">=</span> false<span class="token punctuation">;</span>
	Intent intent <span class="token operator">=</span> new <span class="token function">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_SHUTDOWN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	intent<span class="token punctuation">.</span><span class="token function">addFlags</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>FLAG_RECEIVER_FOREGROUND <span class="token operator">|</span> Intent<span class="token punctuation">.</span>FLAG_RECEIVER_REGISTERED_ONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>
	mContext<span class="token punctuation">.</span><span class="token function">sendOrderedBroadcastAsUser</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span>UserHandle<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> null<span class="token punctuation">,</span> br<span class="token punctuation">,</span> mHandler<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//上述代码是发送关机广播，如果在某app里注册了接收ACTION_SHUTDOWN的BroadcastReceiver，在关机时会接收到这一个广播</span>
	<span class="token comment">/*
	在一个需求中，需要Android关机前，先将一些机器关闭，再关闭Android，实现方案如下：
	1.在一个后台服务中注册一个广播接收器，这个接收器接收一个关机广播（还接收各式各样的广播）
	2.这个后台服务接收关机广播时执行，将一些机器关闭的操作
	3.在关机流程时，我们需要将流程卡在发送广播后，下面就实现相关代码
	*/</span>
	boolean actionFlag <span class="token operator">=</span> false<span class="token punctuation">;</span>
	String prop <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
	BufferedReader reader<span class="token punctuation">;</span>
	<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> 
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>actionFlag<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		try <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//获取设备状态</span>
			reader <span class="token operator">=</span> new <span class="token function">BufferedReader</span><span class="token punctuation">(</span>new <span class="token function">FileReader</span><span class="token punctuation">(</span><span class="token string">"/dev/xxx_status"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			prop <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span><span class="token string">"prop = "</span> <span class="token operator">+</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//0：设备关闭；-1：设备未连接；coun&lt;0：超时处理</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"-1"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span> <span class="token operator">||</span> count <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				actionFlag <span class="token operator">=</span> true<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			count<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token comment">//超时处理：如果超过10s未关闭，将直接关闭Android</span>
			<span class="token comment">//此处可优化，可以弹出提示框给用户，让用户判断</span>
			SystemClock<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token function">catch</span> <span class="token punctuation">(</span>IOException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="13MTPUsbDeviceManagerjava_466"></a>13.设备默认MTP模式（UsbDeviceManager.java）</h2> 
<pre><code>具体可见（非常详细的一篇好文）：https://blog.csdn.net/JESSE_ZHAO_503/article/details/7861685
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">/*
	在这里仅对端口切换时会显示MTP模式
	当端口切换时，使用MTP模式
	在这里需要对UsbDeviceManager.java有一些基本的了解
	//具体可见：https://blog.csdn.net/JESSE_ZHAO_503/article/details/7861685
	1、定义一个runnable线程，待命执行mShowBuiltinInstallerRunnable
	2、定义一个receiver，接收各种信息进行处理
	3、定义UsbHandler的looper
	4、发送消息
	5、updateState
	6、setUsbConfig设置usb的功能，SystemProperties.set
	7、setAdbEnabled/setAcmEnabled
	8、这个函数比较特殊，逻辑上需要关注，尤其是对adb/acm的处理	（setEnabledFunctions(String functions, boolean makeDefault)）
	9、updateCurrentAccessory
	10、updateUsbState更新usb的状态，将usb的状态广播出去。广播的intent UsbManager.ACTION_USB_STATE，将usb的状态、功能携带到intent中
	11、消息处理函数public void handleMessage(Message msg) {...}
	12、updateUsbNotification/updateAdbNotification
*/</span>

<span class="token comment">/*
UsbDeviceManager的主要流程：
一 构造函数主要有两个动作：
1创建线程
HandlerThreadthread= new HandlerThread("UsbDeviceManager",
Process.THREAD_PRIORITY_BACKGROUND);
2实例化 mHandler，并给该hander提供looper
mHandler = new UsbHandler(thread.getLooper());
3其他为变量的初始化
二 主要的工作就进入到UsbHandler这个处理类里了
1 UsbHandler的构造函数：a)对usb的function及相关的功能设置，系统属性值进行获取及初始化. b)启用两个监听的动作，监听setting的设置改变以及usb uevent事件的变化。
2 handleMessage的重载，在UsbHandler的成员函数中，会发送消息，那么处理消息的流程是如何被启动的呢？这个流程就是looper来完成的，每个handler内都有message的发送、接收。但是这个handler必须指定looper，有looper来完成消息的分发、管理。Handler中只是完成具体的发送和处理。
三 handleMessage中的几个消息
1 MSG_UPDATE_STATE://usb的连接状态有变化时，收到kernel的uevent信息时(我们主要针对这个mes进行修改)
2 MSG_ENABLE_ADB
3 MSG_SET_CURRENT_FUNCTION://功能设置，上面应用传下来的动作
4 MSG_SYSTEM_READY
5 MSG_BOOT_COMPLETED
*/</span>
public <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span>Message msg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>what<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">case</span> MSG_UPDATE_STATE<span class="token operator">:</span>			<span class="token comment">//当USB的连接状态发生变化时，就执行这里面的代码</span>
                	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                	<span class="token keyword">if</span> <span class="token punctuation">(</span>mBootCompleted<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                	   <span class="token comment">//setEnabledFunctions(UsbManager.FUNCTION_NONE, false);</span>
                	   <span class="token function">setEnabledFunctions</span><span class="token punctuation">(</span>UsbManager<span class="token punctuation">.</span>FUNCTION_MTP<span class="token punctuation">,</span> false<span class="token punctuation">)</span><span class="token punctuation">;</span>
                	   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="14_519"></a>14.默认连接物理键盘时，开启屏幕键盘</h2> 
<pre><code class="prism language-c"><span class="token operator">/</span>device<span class="token operator">/</span>emdoor<span class="token operator">/</span>C27C4<span class="token operator">/</span>innocn_overlay<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SettingsProvider<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>defaults<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">7</span> @@
     <span class="token operator">&lt;</span>integer name<span class="token operator">=</span><span class="token string">"def_multi_press_timeout_millis"</span><span class="token operator">&gt;</span><span class="token number">300</span><span class="token operator">&lt;</span><span class="token operator">/</span>integer<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Default <span class="token keyword">for</span> Settings<span class="token punctuation">.</span>Secure<span class="token punctuation">.</span>SHOW_IME_WITH_HARD_KEYBOARD <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>    <span class="token operator">&lt;</span>bool name<span class="token operator">=</span><span class="token string">"def_show_ime_with_hard_keyboard"</span><span class="token operator">&gt;</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>bool<span class="token operator">&gt;</span>
<span class="token operator">+</span>    <span class="token operator">&lt;</span>bool name<span class="token operator">=</span><span class="token string">"def_show_ime_with_hard_keyboard"</span><span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>bool<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Default <span class="token keyword">for</span> Settings<span class="token punctuation">.</span>System<span class="token punctuation">.</span>POINTER_SPEED <span class="token operator">--</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>integer name<span class="token operator">=</span><span class="token string">"def_pointer_speed"</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token operator">&lt;</span><span class="token operator">/</span>integer<span class="token operator">&gt;</span>


<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SettingsProvider<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>providers<span class="token operator">/</span>settings<span class="token operator">/</span>DatabaseHelper<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">2411</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">2411</span><span class="token punctuation">,</span><span class="token number">9</span> @@ class DatabaseHelper extends SQLiteOpenHelper <span class="token punctuation">{<!-- --></span>
             <span class="token function">loadIntegerSetting</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> Settings<span class="token punctuation">.</span>Secure<span class="token punctuation">.</span>SLEEP_TIMEOUT<span class="token punctuation">,</span>
                     R<span class="token punctuation">.</span>integer<span class="token punctuation">.</span>def_sleep_timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token operator">+</span>            <span class="token function">loadBooleanSetting</span><span class="token punctuation">(</span>stmt<span class="token punctuation">,</span> Settings<span class="token punctuation">.</span>Secure<span class="token punctuation">.</span>SHOW_IME_WITH_HARD_KEYBOARD<span class="token punctuation">,</span>
<span class="token operator">+</span>                    R<span class="token punctuation">.</span>bool<span class="token punctuation">.</span>def_show_ime_with_hard_keyboard<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
             <span class="token comment">/// M: Load MTK added Secure providers before Android M.</span>
             mUtils<span class="token punctuation">.</span><span class="token function">loadCustomSecureSettings</span><span class="token punctuation">(</span>stmt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="15_545"></a>15.修改屏幕默认色温</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt8195<span class="token operator">/</span>hal<span class="token operator">/</span>pq<span class="token operator">/</span>cust_gamma<span class="token punctuation">.</span>cpp b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt8195<span class="token operator">/</span>hal<span class="token operator">/</span>pq<span class="token operator">/</span>cust_gamma<span class="token punctuation">.</span>cpp
index d315a03208<span class="token punctuation">.</span><span class="token number">.36</span>dbd4bfb1 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt8195<span class="token operator">/</span>hal<span class="token operator">/</span>pq<span class="token operator">/</span>cust_gamma<span class="token punctuation">.</span>cpp
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>custom<span class="token operator">/</span>mt8195<span class="token operator">/</span>hal<span class="token operator">/</span>pq<span class="token operator">/</span>cust_gamma<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">1449</span><span class="token punctuation">,</span><span class="token number">103</span> <span class="token operator">+</span><span class="token number">1449</span><span class="token punctuation">,</span><span class="token number">207</span> @@ <span class="token keyword">const</span> <span class="token class-name">gamma_entry_t</span> cust_gamma<span class="token punctuation">[</span>GAMMA_LCM_MAX<span class="token punctuation">]</span><span class="token punctuation">[</span>GAMMA_INDEX_MAX<span class="token punctuation">]</span> <span class="token operator">=</span>
                 <span class="token number">3972</span><span class="token punctuation">,</span>   <span class="token number">3976</span><span class="token punctuation">,</span>   <span class="token number">3980</span><span class="token punctuation">,</span>   <span class="token number">3984</span><span class="token punctuation">,</span>   <span class="token number">3988</span><span class="token punctuation">,</span>   <span class="token number">3992</span><span class="token punctuation">,</span>   <span class="token number">3996</span><span class="token punctuation">,</span>   <span class="token number">4000</span><span class="token punctuation">,</span>   <span class="token number">4004</span><span class="token punctuation">,</span>   <span class="token number">4008</span><span class="token punctuation">,</span>   <span class="token number">4012</span><span class="token punctuation">,</span>   <span class="token number">4016</span><span class="token punctuation">,</span>   <span class="token number">4020</span><span class="token punctuation">,</span>   <span class="token number">4024</span><span class="token punctuation">,</span>   <span class="token number">4028</span><span class="token punctuation">,</span>   <span class="token number">4032</span><span class="token punctuation">,</span>   <span class="token number">4036</span><span class="token punctuation">,</span>   <span class="token number">4040</span><span class="token punctuation">,</span>   <span class="token number">4044</span><span class="token punctuation">,</span>   <span class="token number">4048</span><span class="token punctuation">,</span>   <span class="token number">4052</span><span class="token punctuation">,</span>   <span class="token number">4056</span><span class="token punctuation">,</span>   <span class="token number">4060</span><span class="token punctuation">,</span>   <span class="token number">4064</span><span class="token punctuation">,</span>   <span class="token number">4068</span><span class="token punctuation">,</span>   <span class="token number">4072</span><span class="token punctuation">,</span>   <span class="token number">4076</span><span class="token punctuation">,</span>   <span class="token number">4080</span><span class="token punctuation">,</span>   <span class="token number">4084</span><span class="token punctuation">,</span>   <span class="token number">4088</span><span class="token punctuation">,</span>   <span class="token number">4092</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token punctuation">{<!-- --></span> <span class="token comment">// Gamma 7</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token comment">//对gamma7进行修改，这个需要使用一些仪器去获取对应色温，然后使用IC产商的工具生成对应的gamma值</span>
</code></pre> 
<h2><a id="16_562"></a>16.加入自定义按键</h2> 
<p>具体参考如下博客：<br> https://www.cnblogs.com/dyufei/p/6612790.html<br> 首先在设备树文件中，对原有的GPIO对应的键值进行修改，改为181，具体二进制键值，可以在adb shell中使用getevent查看，点击该按键，即可看到，这部分是驱动修改，下面我们将在framework层进行修改<br> 1.先找到frameworks/base/data/keyboards/Generic.kl文件，新增对应十进制键值为181的键值：</p> 
<pre><code class="prism language-c">	key <span class="token number">181</span>   SELF_MENU
</code></pre> 
<p>2.找到framework/native/include/input/InputEventLabels.h，将SELF_MENU加入到数组static const InputEventLabel KEYCODES[]中，按顺序添加，放在最后，后面好找，如下：</p> 
<pre><code class="prism language-c">	<span class="token function">DEFINE_KEYCODE</span><span class="token punctuation">(</span>SELF_MENU<span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> 
<p>3.找到frameworks/native/include/android/keycodes.h，找到枚举enum {…},根据枚举中最后的值288+1，写入如下（数字一定要跟2中的放置的index对应，所以2中是放在最后的）：</p> 
<pre><code class="prism language-c">	AKEYCODE_SELF_MENU <span class="token operator">=</span> <span class="token number">289</span>
</code></pre> 
<p>4.找到frameworks/base/core/java/android/view/KeyEvent.java，添加如下代码：</p> 
<pre><code class="prism language-c">public <span class="token keyword">static</span> final <span class="token keyword">int</span> KEYCODE_SELF_MENU <span class="token operator">=</span> <span class="token number">289</span><span class="token punctuation">;</span>
<span class="token comment">//顺便修改一下这个</span>
@TestApi
public <span class="token keyword">static</span> final <span class="token keyword">int</span> LAST_KEYCODE <span class="token operator">=</span> KEYCODE_SELF_MENU<span class="token punctuation">;</span>
</code></pre> 
<p>5.找到frameworks/base/core/res/res/values/attrs.xml，在中添加如下：</p> 
<pre><code class="prism language-c"><span class="token operator">&lt;</span><span class="token keyword">enum</span> <span class="token class-name">name</span><span class="token operator">=</span><span class="token string">"KEYCODE_SELF_MENU"</span> value<span class="token operator">=</span><span class="token string">"289"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<p>6.然后在terminal，执行一下make update-api<br> 7.增加广播，在/frameworks/base/core/res/AndroidManifest.xml增加如下</p> 
<pre><code class="prism language-c">    <span class="token operator">&lt;</span>protected<span class="token operator">-</span>broadcast android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.intent.action.ACTION_xxx_xxx_xxx"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<p>8.找到frameworks/base/services/core/java/com/android/server/policy/PhoneWindowManager.java，在类内添加如下方法：</p> 
<pre><code class="prism language-c">@Override
public <span class="token keyword">long</span> <span class="token function">interceptKeyBeforeDispatching</span><span class="token punctuation">(</span>IBinder focusedToken<span class="token punctuation">,</span> KeyEvent event<span class="token punctuation">,</span><span class="token keyword">int</span> policyFlags<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">//找个地方加入这个按键</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>keyCode <span class="token operator">==</span> KeyEvent<span class="token punctuation">.</span>KEYCODE_SELF_MENU<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">sendMenuButtonBroadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//这是一个广播</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

private <span class="token keyword">void</span> <span class="token function">sendMenuButtonBroadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	Intent intent<span class="token operator">=</span>new <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token string">"android.intent.action.ACTION_xxx_xxx_xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	mContext<span class="token punctuation">.</span><span class="token function">sendBroadcast</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="17HW_611"></a>17.开发者选项默认开启[HW停用叠加层]</h2> 
<p>参考：https://www.jianshu.com/p/ec67ee58660a</p> 
<pre><code class="prism language-c">import android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>IBinder<span class="token punctuation">;</span>
import android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Parcel<span class="token punctuation">;</span>
import android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>RemoteException<span class="token punctuation">;</span>
import android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>ServiceManager<span class="token punctuation">;</span>
import android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>RemoteException<span class="token punctuation">;</span>


public class FallbackHome extends Activity <span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	
    <span class="token comment">/**
    *   增加 开启 停用HW叠加层需要的的变量
    */</span>
    private <span class="token keyword">static</span> final <span class="token keyword">int</span> SETTING_VALUE_ON <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    private <span class="token keyword">static</span> final <span class="token keyword">int</span> SETTING_VALUE_OFF <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    private <span class="token keyword">static</span> final String SURFACE_FLINGER_SERVICE_KEY <span class="token operator">=</span> <span class="token string">"SurfaceFlinger"</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> final <span class="token keyword">int</span> SURFACE_FLINGER_READ_CODE <span class="token operator">=</span> <span class="token number">1010</span><span class="token punctuation">;</span>
    private <span class="token keyword">static</span> final <span class="token keyword">int</span> SURFACE_FLINGER_DISABLE_OVERLAYS_CODE <span class="token operator">=</span> <span class="token number">1008</span><span class="token punctuation">;</span>
    private <span class="token keyword">static</span> final String SURFACE_COMPOSER_INTERFACE_KEY <span class="token operator">=</span> <span class="token string">"android.ui.ISurfaceComposer"</span><span class="token punctuation">;</span>
    private IBinder mSurfaceFlinger<span class="token punctuation">;</span>

    <span class="token comment">/**
    *   修改默认 开启 停用HW叠加层的方法writeHardwareOverlaysSetting
    */</span>
    <span class="token keyword">void</span> <span class="token function">writeHardwareOverlaysSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        mSurfaceFlinger <span class="token operator">=</span> ServiceManager<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span>SURFACE_FLINGER_SERVICE_KEY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        try <span class="token punctuation">{<!-- --></span>
            final Parcel data <span class="token operator">=</span> Parcel<span class="token punctuation">.</span><span class="token function">obtain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span><span class="token function">writeInterfaceToken</span><span class="token punctuation">(</span>SURFACE_COMPOSER_INTERFACE_KEY<span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span><span class="token function">writeInt</span><span class="token punctuation">(</span>SETTING_VALUE_ON<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mSurfaceFlinger<span class="token punctuation">.</span><span class="token function">transact</span><span class="token punctuation">(</span>SURFACE_FLINGER_DISABLE_OVERLAYS_CODE<span class="token punctuation">,</span> data<span class="token punctuation">,</span>
                    null <span class="token comment">/* reply */</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token comment">/* flags */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span><span class="token function">recycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token function">catch</span> <span class="token punctuation">(</span>RemoteException ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// intentional no-op</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    @Override
    protected <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        mWallManager <span class="token operator">=</span> <span class="token function">getSystemService</span><span class="token punctuation">(</span>WallpaperManager<span class="token punctuation">.</span>class<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">writeHardwareOverlaysSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mWallManager <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            Log<span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"Wallpaper manager isn't ready, can't listen to color changes!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">loadWallpaperColors</span><span class="token punctuation">(</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="18_668"></a>18.删除电源图标</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>system_icons<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>layout<span class="token operator">/</span>system_icons<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">7</span> @@
         android<span class="token operator">:</span>orientation<span class="token operator">=</span><span class="token string">"horizontal"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span>com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>BatteryMeterView android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">"@+id/battery"</span>
<span class="token operator">+</span>        android<span class="token operator">:</span>visibility<span class="token operator">=</span><span class="token string">"gone"</span>
         android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">"match_parent"</span>
         android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">"wrap_content"</span>
         android<span class="token operator">:</span>clipToPadding<span class="token operator">=</span><span class="token string">"false"</span>


<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">7</span> @@
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> The <span class="token keyword">default</span> tiles to display in QuickSettings <span class="token operator">--</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>string name<span class="token operator">=</span><span class="token string">"quick_settings_tiles_default"</span> translatable<span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>        wifi<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>rotation<span class="token punctuation">,</span>battery<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>airplane<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>screenrecord
<span class="token operator">+</span>        wifi<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>rotation<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>airplane<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>screenrecord
     <span class="token operator">&lt;</span><span class="token operator">/</span>string<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> The minimum number of tiles to display in QuickSettings <span class="token operator">--</span><span class="token operator">&gt;</span>
@@ <span class="token operator">-</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">7</span> @@
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Tiles native to System UI<span class="token punctuation">.</span> Order should match <span class="token string">"quick_settings_tiles_default"</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>string name<span class="token operator">=</span><span class="token string">"quick_settings_tiles_stock"</span> translatable<span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>        wifi<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>battery<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>rotation<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>airplane<span class="token punctuation">,</span>location<span class="token punctuation">,</span>hotspot<span class="token punctuation">,</span>inversion<span class="token punctuation">,</span>saver<span class="token punctuation">,</span>dark<span class="token punctuation">,</span>work<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>night<span class="token punctuation">,</span>screenrecord<span class="token punctuation">,</span>reverse
<span class="token operator">+</span>        wifi<span class="token punctuation">,</span>cell<span class="token punctuation">,</span>dnd<span class="token punctuation">,</span>flashlight<span class="token punctuation">,</span>rotation<span class="token punctuation">,</span>bt<span class="token punctuation">,</span>airplane<span class="token punctuation">,</span>location<span class="token punctuation">,</span>hotspot<span class="token punctuation">,</span>inversion<span class="token punctuation">,</span>saver<span class="token punctuation">,</span>dark<span class="token punctuation">,</span>work<span class="token punctuation">,</span>cast<span class="token punctuation">,</span>night<span class="token punctuation">,</span>screenrecord<span class="token punctuation">,</span>reverse
     <span class="token operator">&lt;</span><span class="token operator">/</span>string<span class="token operator">&gt;</span>


<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">511</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">511</span><span class="token punctuation">,</span><span class="token number">7</span> @@
     <span class="token operator">&lt;</span>string<span class="token operator">-</span>array name<span class="token operator">=</span><span class="token string">"config_statusBarIconBlackList"</span> translatable<span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>item<span class="token operator">&gt;</span>@<span class="token operator">*</span>android<span class="token operator">:</span>string<span class="token operator">/</span>status_bar_rotate<span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>item<span class="token operator">&gt;</span>@<span class="token operator">*</span>android<span class="token operator">:</span>string<span class="token operator">/</span>status_bar_headset<span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">&gt;</span>
<span class="token operator">+</span>        <span class="token operator">&lt;</span>item<span class="token operator">&gt;</span>@<span class="token operator">*</span>android<span class="token operator">:</span>string<span class="token operator">/</span>status_bar_battery<span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>string<span class="token operator">-</span>array<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> A path similar to frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
diff <span class="token operator">--</span>git a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>BatteryMeterView<span class="token punctuation">.</span>java b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>BatteryMeterView<span class="token punctuation">.</span>java
index a2cdd41af0<span class="token punctuation">.</span><span class="token number">.9f</span>e7067e53 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>BatteryMeterView<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>BatteryMeterView<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">292</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">292</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class BatteryMeterView extends LinearLayout implements
                     <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token function">setVisibility</span><span class="token punctuation">(</span>icons<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>mSlotBattery<span class="token punctuation">)</span> <span class="token operator">?</span> View<span class="token punctuation">.</span>GONE <span class="token operator">:</span> View<span class="token punctuation">.</span>VISIBLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token operator">+</span>        <span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token punctuation">}</span>
 
     @Override
</code></pre> 
<h2><a id="1950_notification_volume0_726"></a>19.音量默认50%, notification volume默认为0</h2> 
<pre><code class="prism language-c">
    默认音量为<span class="token number">50</span><span class="token operator">%</span>

diff <span class="token operator">--</span>git a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>audio<span class="token operator">/</span>AudioService<span class="token punctuation">.</span>java b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>audio<span class="token operator">/</span>AudioService<span class="token punctuation">.</span>java
index <span class="token number">256</span>b53e5d8<span class="token punctuation">.</span><span class="token number">.16497</span>a113c <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>audio<span class="token operator">/</span>AudioService<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>audio<span class="token operator">/</span>AudioService<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">337</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">337</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AudioService extends IAudioService<span class="token punctuation">.</span>Stub
         <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_SYSTEM</span>
         <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_RING</span>
         <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_MUSIC</span>
<span class="token operator">-</span>        <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_ALARM</span>
<span class="token operator">+</span>        <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_ALARM</span>
         <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_NOTIFICATION</span>
         <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_BLUETOOTH_SCO</span>
         <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_SYSTEM_ENFORCED</span>
@@ <span class="token operator">-</span><span class="token number">742</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">742</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AudioService extends IAudioService<span class="token punctuation">.</span>Stub
           <span class="token comment">// DTMF tone is not audiable ( or too low)  via BT SCO/ABS device.</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>maxCallVolume <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             AudioSystem<span class="token punctuation">.</span>DEFAULT_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_VOICE_CALL<span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token operator">-</span>                    <span class="token punctuation">(</span>maxCallVolume <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                    <span class="token punctuation">(</span>maxCallVolume <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
@@ <span class="token operator">-</span><span class="token number">742</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">742</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AudioService extends IAudioService<span class="token punctuation">.</span>Stub
           <span class="token comment">// DTMF tone is not audiable ( or too low)  via BT SCO/ABS device.</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>maxCallVolume <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             AudioSystem<span class="token punctuation">.</span>DEFAULT_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_VOICE_CALL<span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token operator">-</span>                    <span class="token punctuation">(</span>maxCallVolume <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                    <span class="token punctuation">(</span>maxCallVolume <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
 
@@ <span class="token operator">-</span><span class="token number">759</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token operator">+</span><span class="token number">759</span><span class="token punctuation">,</span><span class="token number">10</span> @@ public class AudioService extends IAudioService<span class="token punctuation">.</span>Stub
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
             <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPlatformTelevision</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                 AudioSystem<span class="token punctuation">.</span>DEFAULT_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token operator">-</span>                        MAX_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                        MAX_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                 AudioSystem<span class="token punctuation">.</span>DEFAULT_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token operator">-</span>                        MAX_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                        MAX_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
 
@@ <span class="token operator">-</span><span class="token number">778</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">778</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AudioService extends IAudioService<span class="token punctuation">.</span>Stub
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
             <span class="token comment">// Default is 6 out of 7 (default maximum), so scale accordingly.</span>
             AudioSystem<span class="token punctuation">.</span>DEFAULT_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_ALARM<span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token operator">-</span>                        <span class="token number">6</span> <span class="token operator">*</span> MAX_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_ALARM<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">7</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                        <span class="token number">1</span> <span class="token operator">*</span> MAX_STREAM_VOLUME<span class="token punctuation">[</span>AudioSystem<span class="token punctuation">.</span>STREAM_ALARM<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
 
         <span class="token keyword">int</span> maxSystemVolume <span class="token operator">=</span> SystemProperties<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"ro.config.system_vol_steps"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>注意这个Notification volume使用了别名，跟STREAM_RING是一致的，所以修改STREAM_RING的默认值即可</p> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>media<span class="token operator">/</span>java<span class="token operator">/</span>android<span class="token operator">/</span>media<span class="token operator">/</span>AudioSystem<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>media<span class="token operator">/</span>java<span class="token operator">/</span>android<span class="token operator">/</span>media<span class="token operator">/</span>AudioSystem<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">1756</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">1756</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class AudioSystem
     public <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULT_STREAM_VOLUME <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
         <span class="token number">4</span><span class="token punctuation">,</span>   <span class="token comment">// STREAM_VOICE_CALL</span>
         <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token comment">// STREAM_SYSTEM</span>
<span class="token operator">-</span>        <span class="token number">8</span><span class="token punctuation">,</span>   <span class="token comment">// STREAM_RING</span>
<span class="token operator">+</span>        <span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// STREAM_RING</span>
         <span class="token number">8</span><span class="token punctuation">,</span>   <span class="token comment">// STREAM_MUSIC</span>
         <span class="token number">8</span><span class="token punctuation">,</span>   <span class="token comment">// STREAM_ALARM</span>
</code></pre> 
<h2><a id="20809090100_797"></a>20.亮度线性变化后，80%-90%亮度变化小，90%-100%亮度变化大</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>settings<span class="token operator">/</span>BrightnessController<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>settings<span class="token operator">/</span>BrightnessController<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">384</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">384</span><span class="token punctuation">,</span><span class="token number">18</span> @@ public class BrightnessController implements ToggleSlider<span class="token punctuation">.</span>Listener <span class="token punctuation">{<!-- --></span>
                 minBacklight<span class="token punctuation">,</span> maxBacklight<span class="token punctuation">)</span><span class="token punctuation">,</span>
                 <span class="token number">1.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token operator">*</span><span class="token operator">/</span>
<span class="token operator">-</span>        final <span class="token keyword">float</span> valFloat <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>value <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token number">65535</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//final float valFloat = (float)value / (float)65535;</span>
<span class="token operator">+</span>        <span class="token keyword">float</span> modifiedValue <span class="token operator">=</span> <span class="token number">0.0F</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//80%以下的亮度显示不做改变,80%~90%的亮度显示增幅为正常的1.6倍，90%以上的亮度显示增幅为正常的0.4倍</span>
<span class="token operator">+</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">&lt;</span> <span class="token number">52428</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            modifiedValue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>value<span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">52428</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">&lt;</span> <span class="token number">58981</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            modifiedValue <span class="token operator">=</span> <span class="token number">52428.0F</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>value <span class="token operator">-</span> <span class="token number">52428.0F</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.6F</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">58981</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">&lt;=</span> <span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            modifiedValue <span class="token operator">=</span> <span class="token number">65535.0F</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">65535.0F</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>value<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.4F</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span>
<span class="token operator">+</span>        final <span class="token keyword">float</span> valFloat <span class="token operator">=</span> modifiedValue <span class="token operator">/</span> <span class="token number">65535.0F</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>stopTracking<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token comment">// TODO(brightnessfloat): change to use float value instead.</span>
             MetricsLogger<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span>mContext<span class="token punctuation">,</span> metric<span class="token punctuation">,</span>
@@ <span class="token operator">-</span><span class="token number">454</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">465</span><span class="token punctuation">,</span><span class="token number">14</span> @@ public class BrightnessController implements ToggleSlider<span class="token punctuation">.</span>Listener <span class="token punctuation">{<!-- --></span>
         <span class="token punctuation">}</span>
         <span class="token comment">// Returns GAMMA_SPACE_MIN - GAMMA_SPACE_MAX</span>
         <span class="token comment">//final int sliderVal = convertLinearToGammaFloat(brightnessValue, min, max);</span>
<span class="token operator">-</span>        final <span class="token keyword">int</span> sliderVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>brightnessValue <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token keyword">float</span> actualSliderVal <span class="token operator">=</span> brightnessValue <span class="token operator">*</span> <span class="token number">65535.0F</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token keyword">int</span> sliderVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>brightnessValue <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//为了保证slider不跳变，对上面的changed回调做一个逆运算</span>
<span class="token operator">+</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>actualSliderVal <span class="token operator">&gt;=</span> <span class="token number">52428.0F</span> <span class="token operator">&amp;&amp;</span> actualSliderVal <span class="token operator">&lt;</span> <span class="token number">62913.0F</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            sliderVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>actualSliderVal <span class="token operator">-</span> <span class="token number">52428.0F</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1.6F</span> <span class="token operator">+</span> <span class="token number">52428.0F</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>actualSliderVal <span class="token operator">&gt;=</span> <span class="token number">62913.0F</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            sliderVal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>actualSliderVal <span class="token operator">-</span> <span class="token number">65535.0F</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">0.4F</span> <span class="token operator">+</span> <span class="token number">65535.0F</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token operator">+</span>        <span class="token punctuation">}</span>
         <span class="token function">animateSliderTo</span><span class="token punctuation">(</span>sliderVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="21settings_838"></a>21.settings移除系统-&gt;手势-&gt;导航选项</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>res<span class="token operator">/</span>xml<span class="token operator">/</span>gestures<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>MtkSettings<span class="token operator">/</span>res<span class="token operator">/</span>xml<span class="token operator">/</span>gestures<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">12</span> <span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">12</span> @@
         settings<span class="token operator">:</span>searchable<span class="token operator">=</span><span class="token string">"false"</span>
         settings<span class="token operator">:</span>controller<span class="token operator">=</span><span class="token string">"com.android.settings.gestures.DoubleTwistPreferenceController"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
 
<span class="token operator">-</span>    <span class="token operator">&lt;</span>Preference
<span class="token operator">+</span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>Preference
         android<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"gesture_system_navigation_input_summary"</span>
         android<span class="token operator">:</span>title<span class="token operator">=</span><span class="token string">"@string/system_navigation_title"</span>
         android<span class="token operator">:</span>fragment<span class="token operator">=</span><span class="token string">"com.android.settings.gestures.SystemNavigationGestureSettings"</span>
         settings<span class="token operator">:</span>controller<span class="token operator">=</span><span class="token string">"com.android.settings.gestures.SystemNavigationPreferenceController"</span>
<span class="token operator">-</span>        settings<span class="token operator">:</span>keywords<span class="token operator">=</span><span class="token string">"@string/keywords_system_navigation"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">+</span>        settings<span class="token operator">:</span>keywords<span class="token operator">=</span><span class="token string">"@string/keywords_system_navigation"</span> <span class="token operator">/</span><span class="token operator">--</span><span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span>Preference
</code></pre> 
<h2><a id="22navigation_bar_858"></a>22.增加长按电源键广播，屏蔽原生的关机选项(为了规避navigation bar覆盖原生关机选项)</h2> 
<p>主要是另外的systemUI开发关机界面</p> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>policy<span class="token operator">/</span>PhoneWindowManager<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>policy<span class="token operator">/</span>PhoneWindowManager<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">1180</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">1180</span><span class="token punctuation">,</span><span class="token number">11</span> @@ public class PhoneWindowManager implements WindowManagerPolicy <span class="token punctuation">{<!-- --></span>
         mContext<span class="token punctuation">.</span><span class="token function">sendBroadcast</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
<span class="token operator">+</span>    private <span class="token keyword">void</span> <span class="token function">sendPowerButtonLongPressBroadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        Intent intent<span class="token operator">=</span>new <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token string">"android.intent.action.ACTION_POWER_BUTTON_LONG_PRESS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        mContext<span class="token punctuation">.</span><span class="token function">sendBroadcast</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>    <span class="token punctuation">}</span>
<span class="token operator">+</span>
     private <span class="token keyword">void</span> <span class="token function">goToSleep</span><span class="token punctuation">(</span><span class="token keyword">long</span> eventTime<span class="token punctuation">,</span> <span class="token keyword">int</span> reason<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         mRequestedOrGoingToSleep <span class="token operator">=</span> true<span class="token punctuation">;</span>
         mPowerManager<span class="token punctuation">.</span><span class="token function">goToSleep</span><span class="token punctuation">(</span>eventTime<span class="token punctuation">,</span> reason<span class="token punctuation">,</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
@@ <span class="token operator">-</span><span class="token number">1256</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">1261</span><span class="token punctuation">,</span><span class="token number">8</span> @@ public class PhoneWindowManager implements WindowManagerPolicy <span class="token punctuation">{<!-- --></span>
                 mPowerKeyHandled <span class="token operator">=</span> true<span class="token punctuation">;</span>
                 <span class="token function">performHapticFeedback</span><span class="token punctuation">(</span>HapticFeedbackConstants<span class="token punctuation">.</span>LONG_PRESS<span class="token punctuation">,</span> false<span class="token punctuation">,</span>
                         <span class="token string">"Power - Long Press - Global Actions"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span>                <span class="token function">showGlobalActionsInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                <span class="token function">sendPowerButtonLongPressBroadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                <span class="token comment">//showGlobalActionsInternal();</span>
                 <span class="token keyword">break</span><span class="token punctuation">;</span>
             <span class="token keyword">case</span> LONG_PRESS_POWER_SHUT_OFF<span class="token operator">:</span>
             <span class="token keyword">case</span> LONG_PRESS_POWER_SHUT_OFF_NO_CONFIRM<span class="token operator">:</span>
</code></pre> 
<h2><a id="23apk_887"></a>23.如果使用某apk进行录像，那么不弹出录像提示框</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>media<span class="token operator">/</span>MediaProjectionPermissionActivity<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>media<span class="token operator">/</span>MediaProjectionPermissionActivity<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">7</span> @@ public class MediaProjectionPermissionActivity extends Activity
         <span class="token punctuation">}</span>
 
         try <span class="token punctuation">{<!-- --></span>
<span class="token operator">-</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mService<span class="token punctuation">.</span><span class="token function">hasProjectionPermission</span><span class="token punctuation">(</span>mUid<span class="token punctuation">,</span> mPackageName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mService<span class="token punctuation">.</span><span class="token function">hasProjectionPermission</span><span class="token punctuation">(</span>mUid<span class="token punctuation">,</span> mPackageName<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"com.xxxxxx.systemui"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>mPackageName<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                 <span class="token function">setResult</span><span class="token punctuation">(</span>RESULT_OK<span class="token punctuation">,</span> <span class="token function">getMediaProjectionIntent</span><span class="token punctuation">(</span>mUid<span class="token punctuation">,</span> mPackageName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">return</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="24_902"></a>24.关闭双击电源键，启动相机的功能</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>res<span class="token operator">/</span>res<span class="token operator">/</span>values<span class="token operator">/</span>config<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">3185</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">3185</span><span class="token punctuation">,</span><span class="token number">7</span> @@
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Allow the gesture to <span class="token keyword">double</span> tap the power button twice to start the camera <span class="token keyword">while</span> the device
          is non<span class="token operator">-</span>interactive<span class="token punctuation">.</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">-</span>    <span class="token operator">&lt;</span>bool name<span class="token operator">=</span><span class="token string">"config_cameraDoubleTapPowerGestureEnabled"</span><span class="token operator">&gt;</span>true<span class="token operator">&lt;</span><span class="token operator">/</span>bool<span class="token operator">&gt;</span>
<span class="token operator">+</span>    <span class="token operator">&lt;</span>bool name<span class="token operator">=</span><span class="token string">"config_cameraDoubleTapPowerGestureEnabled"</span><span class="token operator">&gt;</span>false<span class="token operator">&lt;</span><span class="token operator">/</span>bool<span class="token operator">&gt;</span>
 
     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Allow the gesture power <span class="token operator">+</span> volume up to change the ringer mode <span class="token keyword">while</span> the device
          is interactive<span class="token punctuation">.</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="25_917"></a>25.修改鼠标右键功能为返回键</h2> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>native<span class="token operator">/</span>services<span class="token operator">/</span>inputflinger<span class="token operator">/</span>reader<span class="token operator">/</span>mapper<span class="token operator">/</span>accumulator<span class="token operator">/</span>CursorButtonAccumulator<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token class-name">uint32_t</span> CursorButtonAccumulator<span class="token operator">::</span><span class="token function">getButtonState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
         result <span class="token operator">|=</span> AMOTION_EVENT_BUTTON_PRIMARY<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>mBtnRight<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">-</span>        result <span class="token operator">|=</span> AMOTION_EVENT_BUTTON_SECONDARY<span class="token punctuation">;</span>
<span class="token operator">+</span>        result <span class="token operator">|=</span> AMOTION_EVENT_BUTTON_BACK<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>mBtnMiddle<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         result <span class="token operator">|=</span> AMOTION_EVENT_BUTTON_TERTIARY<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="26app_931"></a>26.系统app开机自启动</h2> 
<pre><code class="prism language-c">系统服务启动分为三类
<span class="token number">1.</span> <span class="token function">startBootstrapServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">2.</span> <span class="token function">startCoreServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">3.</span> <span class="token function">startOtherServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

startBootstrapServices
<span class="token number">1.</span> 启动Installer服务
<span class="token number">2.</span> 启动ActivityManagerService，Installer服务赋值给AMS
<span class="token number">3.</span> 启动PowerManagerService，AMS initPowerManagement
<span class="token number">4.</span> 启动LightsService
<span class="token number">5.</span> SystemService<span class="token punctuation">.</span>PHASE_WAIT_FOR_DEFAULT_DISPLAY
<span class="token number">6.</span> 启动PackageManagerService
<span class="token number">7.</span> 启动SensorService

startCoreServices
<span class="token number">1.</span> 启动BatteryService
<span class="token number">2.</span> 启动UsageStatsService
<span class="token number">3.</span> AMS setUsageStatsManager

startOtherServices
<span class="token number">1.</span> 启动SchedulingPolicyService
<span class="token number">2.</span> 启动TelecomLoaderService
<span class="token number">3.</span> 启动TelephonyRegistry
<span class="token number">4.</span> 启动CameraService
<span class="token number">5.</span> 启动AccountManagerService
<span class="token number">6.</span> 启动ContentService
<span class="token number">7.</span> AMS安装系统Provider
<span class="token number">8.</span> 启动VibratorService
<span class="token number">9.</span> 启动ConsumerIrService
<span class="token number">10.</span> 启动AlarmManagerService
<span class="token number">11.</span> 初始化WatchDog与AMS相关
<span class="token number">12.</span> 启动WindowManagerService
<span class="token number">13.</span> 启动InputManagerService
<span class="token number">14.</span> 把WMS赋值给AMS
<span class="token number">15.</span> 启动AccessibilityManagerService
<span class="token number">16.</span> 启动LockSettingsService
<span class="token number">17.</span> 启动DeviceIdleController
<span class="token number">18.</span> 启动StatusBarManagerService
<span class="token number">19.</span> 启动ClipboardService
<span class="token number">20.</span> 启动ConnectivityService
<span class="token number">21.</span> 启动NotificationManagerService
<span class="token number">22.</span> 启动JobSchedulerService
<span class="token number">23.</span> 启动LauncherAppsService

最后启动SystemUi
————————————————
版权声明：本文为CSDN博主「字节小站」的原创文章，遵循CC <span class="token number">4.0</span> BY<span class="token operator">-</span>SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https<span class="token operator">:</span><span class="token comment">//blog.csdn.net/future234/article/details/81145447</span>
</code></pre> 
<p>根据上述启动，将一般的系统app放置在方法 startOtherServices中</p> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>services<span class="token operator">/</span>java<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>server<span class="token operator">/</span>SystemServer<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">2344</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token operator">+</span><span class="token number">2344</span><span class="token punctuation">,</span><span class="token number">22</span> @@ public final class SystemServer <span class="token punctuation">{<!-- --></span>
             t<span class="token punctuation">.</span><span class="token function">traceBegin</span><span class="token punctuation">(</span><span class="token string">"StartSystemUI"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             try <span class="token punctuation">{<!-- --></span>
                 <span class="token function">startSystemUi</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> windowManagerF<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                <span class="token function">startMyAppSystemUi</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> windowManagerF<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span> <span class="token function">catch</span> <span class="token punctuation">(</span>Throwable e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                 <span class="token function">reportWtf</span><span class="token punctuation">(</span><span class="token string">"starting System UI"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
             t<span class="token punctuation">.</span><span class="token function">traceEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

@@ <span class="token operator">-</span><span class="token number">2636</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">2648</span><span class="token punctuation">,</span><span class="token number">24</span> @@ public final class SystemServer <span class="token punctuation">{<!-- --></span>
         windowManager<span class="token punctuation">.</span><span class="token function">onSystemUiStarted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
<span class="token operator">+</span>    private <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">startMyAppSystemUi</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> WindowManagerService windowManager<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        PackageManagerInternal pm <span class="token operator">=</span> LocalServices<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span>PackageManagerInternal<span class="token punctuation">.</span>class<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        Intent intent <span class="token operator">=</span> new <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token string">"com.xxxxxxxxx.intent.ACTION_SYSTEM_UI_SERVICE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        intent<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span><span class="token string">"com.xxxxx.systemui"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        intent<span class="token punctuation">.</span><span class="token function">addFlags</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>FLAG_DEBUG_TRIAGED_MISSING<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token comment">//Slog.d(TAG, "Starting service: " + intent);</span>
<span class="token operator">+</span>        context<span class="token punctuation">.</span><span class="token function">startServiceAsUser</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> UserHandle<span class="token punctuation">.</span>SYSTEM<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>    <span class="token punctuation">}</span>
</code></pre> 
<p>加入模块名</p> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>device<span class="token operator">/</span>mediateksample<span class="token operator">/</span>IC_NAMEXXXX<span class="token operator">/</span>device<span class="token punctuation">.</span>mk
@@ <span class="token operator">-</span><span class="token number">210</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">+</span><span class="token number">210</span><span class="token punctuation">,</span><span class="token number">4</span> @@ PACKAGE_FILTER <span class="token operator">+=</span> \
          MtkQuickSearchBox
<span class="token operator">+</span>PRODUCT_PACKAGES <span class="token operator">+=</span> TEST
</code></pre> 
<p>加入TEST.apk，本地加入编译文件</p> 
<pre><code class="prism language-c">include $<span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
LOCAL_MODULE <span class="token operator">:</span><span class="token operator">=</span> TEST
LOCAL_MODULE_CLASS <span class="token operator">:</span><span class="token operator">=</span> APPS
<span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">LOCAL_PROPRIETARY_MODULE <span class="token operator">:</span><span class="token operator">=</span> true</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">LOCAL_MODULE_OWNER <span class="token operator">:</span><span class="token operator">=</span> mtk</span></span>
LOCAL_VENDOR_MODULE <span class="token operator">:</span><span class="token operator">=</span> true
LOCAL_MODULE_TAGS <span class="token operator">:</span><span class="token operator">=</span> optional
LOCAL_MODULE_SUFFIX <span class="token operator">:</span><span class="token operator">=</span> $<span class="token punctuation">(</span>COMMON_ANDROID_PACKAGE_SUFFIX<span class="token punctuation">)</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">LOCAL_PRIVILEGED_MODULE <span class="token operator">:</span><span class="token operator">=</span></span></span>
LOCAL_CERTIFICATE <span class="token operator">:</span><span class="token operator">=</span> platform
LOCAL_SRC_FILES <span class="token operator">:</span><span class="token operator">=</span> TEST<span class="token punctuation">.</span>apk
include $<span class="token punctuation">(</span>BUILD_PREBUILT<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="27cameraID_1031"></a>27.屏蔽特定cameraID</h2> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>av<span class="token operator">/</span>services<span class="token operator">/</span>camera<span class="token operator">/</span>libcameraservice<span class="token operator">/</span>CameraService<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">282</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">282</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token keyword">void</span> CameraService<span class="token operator">::</span><span class="token function">filterAPI1SystemCameraLocked</span><span class="token punctuation">(</span>
@@ <span class="token operator">-</span><span class="token number">282</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">282</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token keyword">void</span> CameraService<span class="token operator">::</span><span class="token function">filterAPI1SystemCameraLocked</span><span class="token punctuation">(</span>
             <span class="token function">ALOGE</span><span class="token punctuation">(</span><span class="token string">"%s: Invalid camera id %s, skipping"</span><span class="token punctuation">,</span> __FUNCTION__<span class="token punctuation">,</span> deviceId<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token operator">-</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>deviceKind <span class="token operator">==</span> SystemCameraKind<span class="token operator">::</span>SYSTEM_ONLY_CAMERA<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>deviceKind <span class="token operator">==</span> SystemCameraKind<span class="token operator">::</span>SYSTEM_ONLY_CAMERA <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"212"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token comment">// All system camera ids will necessarily come after public camera</span>
             <span class="token comment">// device ids as per the HAL interface contract.</span>
             <span class="token keyword">break</span><span class="token punctuation">;</span>

<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>av<span class="token operator">/</span>services<span class="token operator">/</span>camera<span class="token operator">/</span>libcameraservice<span class="token operator">/</span>common<span class="token operator">/</span>CameraProviderManager<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token keyword">void</span> CameraProviderManager<span class="token operator">::</span><span class="token function">collectDeviceIdsLocked</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string
             <span class="token function">ALOGE</span><span class="token punctuation">(</span><span class="token string">"%s: Invalid camera id %s, skipping"</span><span class="token punctuation">,</span> __FUNCTION__<span class="token punctuation">,</span> deviceId<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token operator">-</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>deviceKind <span class="token operator">==</span> SystemCameraKind<span class="token operator">::</span>SYSTEM_ONLY_CAMERA<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>deviceKind <span class="token operator">==</span> SystemCameraKind<span class="token operator">::</span>SYSTEM_ONLY_CAMERA <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"212"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             systemDeviceIds<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
             publicDeviceIds<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>core<span class="token operator">/</span>java<span class="token operator">/</span>android<span class="token operator">/</span>hardware<span class="token operator">/</span>camera2<span class="token operator">/</span>CameraManager<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">1239</span><span class="token punctuation">,</span><span class="token number">16</span> <span class="token operator">+</span><span class="token number">1239</span><span class="token punctuation">,</span><span class="token number">20</span> @@ public final class CameraManager <span class="token punctuation">{<!-- --></span>
             <span class="token keyword">int</span> idCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
             <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                 <span class="token keyword">int</span> status <span class="token operator">=</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">valueAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                String value <span class="token operator">=</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">keyAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> ICameraServiceListener<span class="token punctuation">.</span>STATUS_NOT_PRESENT
<span class="token operator">-</span>                        <span class="token operator">||</span> status <span class="token operator">==</span> ICameraServiceListener<span class="token punctuation">.</span>STATUS_ENUMERATING<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                        <span class="token operator">||</span> status <span class="token operator">==</span> ICameraServiceListener<span class="token punctuation">.</span>STATUS_ENUMERATING
<span class="token operator">+</span>                        <span class="token operator">||</span> <span class="token string">"212"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
                 idCount<span class="token operator">++</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
             cameraIds <span class="token operator">=</span> new String<span class="token punctuation">[</span>idCount<span class="token punctuation">]</span><span class="token punctuation">;</span>
             idCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
             <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                 <span class="token keyword">int</span> status <span class="token operator">=</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">valueAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                String value <span class="token operator">=</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">keyAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> ICameraServiceListener<span class="token punctuation">.</span>STATUS_NOT_PRESENT
<span class="token operator">-</span>                        <span class="token operator">||</span> status <span class="token operator">==</span> ICameraServiceListener<span class="token punctuation">.</span>STATUS_ENUMERATING<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                        <span class="token operator">||</span> status <span class="token operator">==</span> ICameraServiceListener<span class="token punctuation">.</span>STATUS_ENUMERATING
<span class="token operator">+</span>                        <span class="token operator">||</span> <span class="token string">"212"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
                 cameraIds<span class="token punctuation">[</span>idCount<span class="token punctuation">]</span> <span class="token operator">=</span> mDeviceStatus<span class="token punctuation">.</span><span class="token function">keyAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 idCount<span class="token operator">++</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="28_1081"></a>28.修改音量曲线，减少其最大值，防止破音</h2> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>vendor<span class="token operator">/</span>common<span class="token operator">/</span>audio_policy_config<span class="token operator">/</span>audio_policy_volumes<span class="token punctuation">.</span>xml
@@ <span class="token operator">-</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">8</span> <span class="token operator">+</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">8</span> @@ volume index from <span class="token number">0</span> to <span class="token number">100.</span>
     <span class="token operator">&lt;</span>volume stream<span class="token operator">=</span><span class="token string">"AUDIO_STREAM_ALARM"</span> deviceCategory<span class="token operator">=</span><span class="token string">"DEVICE_CATEGORY_SPEAKER"</span><span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>point<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2970</span><span class="token operator">&lt;</span><span class="token operator">/</span>point<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>point<span class="token operator">&gt;</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2010</span><span class="token operator">&lt;</span><span class="token operator">/</span>point<span class="token operator">&gt;</span>
<span class="token operator">-</span>        <span class="token operator">&lt;</span>point<span class="token operator">&gt;</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1020</span><span class="token operator">&lt;</span><span class="token operator">/</span>point<span class="token operator">&gt;</span>
<span class="token operator">-</span>        <span class="token operator">&lt;</span>point<span class="token operator">&gt;</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">&lt;</span><span class="token operator">/</span>point<span class="token operator">&gt;</span>
<span class="token operator">+</span>        <span class="token operator">&lt;</span>point<span class="token operator">&gt;</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1500</span><span class="token operator">&lt;</span><span class="token operator">/</span>point<span class="token operator">&gt;</span>
<span class="token operator">+</span>        <span class="token operator">&lt;</span>point<span class="token operator">&gt;</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1020</span><span class="token operator">&lt;</span><span class="token operator">/</span>point<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>volume<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>volume stream<span class="token operator">=</span><span class="token string">"AUDIO_STREAM_ALARM"</span> deviceCategory<span class="token operator">=</span><span class="token string">"DEVICE_CATEGORY_EARPIECE"</span>
                                         ref<span class="token operator">=</span><span class="token string">"DEFAULT_NON_MUTABLE_EARPIECE_VOLUME_CURVE"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="29_1096"></a>29.修复屏幕录制音频后，再播放时，右声道无声音问题</h2> 
<pre><code class="prism language-c">AudioALSACaptureDataClient<span class="token operator">::</span><span class="token function">AudioALSACaptureDataClient</span><span class="token punctuation">(</span>AudioALSACaptureDataProviderBase <span class="token operator">*</span>pCaptureDataProvider<span class="token punctuation">,</span> <span class="token class-name">stream_attribute_t</span> <span class="token operator">*</span>stream_attribute_target<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">+</span>    <span class="token comment">//mBesRecordStereoMode = false; //formerly==20220628 </span>
<span class="token operator">+</span>    mBesRecordStereoMode <span class="token operator">=</span> true<span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<h2><a id="30_1103"></a>30.移除闹铃音频编译</h2> 
<pre><code class="prism language-c">frameworks<span class="token operator">/</span>base<span class="token operator">/</span>data<span class="token operator">/</span>sounds<span class="token operator">/</span>AllAudio<span class="token punctuation">.</span>mk
@@ <span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">6</span> @@ PRODUCT_COPY_FILES <span class="token operator">+=</span> \
     $<span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span><span class="token operator">/</span>alarms<span class="token operator">/</span>ogg<span class="token operator">/</span>Carbon<span class="token punctuation">.</span>ogg<span class="token operator">:</span>$<span class="token punctuation">(</span>TARGET_COPY_OUT_PRODUCT<span class="token punctuation">)</span><span class="token operator">/</span>media<span class="token operator">/</span>audio<span class="token operator">/</span>alarms<span class="token operator">/</span>Carbon<span class="token punctuation">.</span>ogg \
<span class="token operator">-</span>    $<span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span><span class="token operator">/</span>alarms<span class="token operator">/</span>ogg<span class="token operator">/</span>Cesium<span class="token punctuation">.</span>ogg<span class="token operator">:</span>$<span class="token punctuation">(</span>TARGET_COPY_OUT_PRODUCT<span class="token punctuation">)</span><span class="token operator">/</span>media<span class="token operator">/</span>audio<span class="token operator">/</span>alarms<span class="token operator">/</span>Cesium<span class="token punctuation">.</span>ogg \
     $<span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span><span class="token operator">/</span>alarms<span class="token operator">/</span>ogg<span class="token operator">/</span>Fermium<span class="token punctuation">.</span>ogg<span class="token operator">:</span>$<span class="token punctuation">(</span>TARGET_COPY_OUT_PRODUCT<span class="token punctuation">)</span><span class="token operator">/</span>media<span class="token operator">/</span>audio<span class="token operator">/</span>alarms<span class="token operator">/</span>Fermium<span class="token punctuation">.</span>ogg \
@@ <span class="token operator">-</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">6</span> @@ PRODUCT_COPY_FILES <span class="token operator">+=</span> \
     $<span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span><span class="token operator">/</span>alarms<span class="token operator">/</span>ogg<span class="token operator">/</span>Oxygen<span class="token punctuation">.</span>ogg<span class="token operator">:</span>$<span class="token punctuation">(</span>TARGET_COPY_OUT_PRODUCT<span class="token punctuation">)</span><span class="token operator">/</span>media<span class="token operator">/</span>audio<span class="token operator">/</span>alarms<span class="token operator">/</span>Oxygen<span class="token punctuation">.</span>ogg \
<span class="token operator">-</span>    $<span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span><span class="token operator">/</span>alarms<span class="token operator">/</span>ogg<span class="token operator">/</span>Platinum<span class="token punctuation">.</span>ogg<span class="token operator">:</span>$<span class="token punctuation">(</span>TARGET_COPY_OUT_PRODUCT<span class="token punctuation">)</span><span class="token operator">/</span>media<span class="token operator">/</span>audio<span class="token operator">/</span>alarms<span class="token operator">/</span>Platinum<span class="token punctuation">.</span>ogg \
     $<span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span><span class="token operator">/</span>alarms<span class="token operator">/</span>ogg<span class="token operator">/</span>Plutonium<span class="token punctuation">.</span>ogg<span class="token operator">:</span>$<span class="token punctuation">(</span>TARGET_COPY_OUT_PRODUCT<span class="token punctuation">)</span><span class="token operator">/</span>media<span class="token operator">/</span>audio<span class="token operator">/</span>alarms<span class="token operator">/</span>Plutonium<span class="token punctuation">.</span>ogg \
</code></pre> 
<h2><a id="31_1116"></a>31.因为权限，可能导致无法打开相机的问题</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>av<span class="token operator">/</span>services<span class="token operator">/</span>camera<span class="token operator">/</span>libcameraservice<span class="token operator">/</span>CameraService<span class="token punctuation">.</span>cpp
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>av<span class="token operator">/</span>services<span class="token operator">/</span>camera<span class="token operator">/</span>libcameraservice<span class="token operator">/</span>CameraService<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">567</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">567</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token keyword">void</span> CameraService<span class="token operator">::</span><span class="token function">onTorchStatusChangedLocked</span><span class="token punctuation">(</span><span class="token keyword">const</span> String8<span class="token operator">&amp;</span> cameraId<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
 
 <span class="token keyword">static</span> bool <span class="token function">hasPermissionsForSystemCamera</span><span class="token punctuation">(</span><span class="token keyword">int</span> callingPid<span class="token punctuation">,</span> <span class="token keyword">int</span> callingUid<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">-</span>    <span class="token keyword">return</span> <span class="token function">checkPermission</span><span class="token punctuation">(</span>sSystemCameraPermission<span class="token punctuation">,</span> callingPid<span class="token punctuation">,</span> callingUid<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
<span class="token operator">+</span>    <span class="token keyword">return</span> <span class="token comment">/*checkPermission(sSystemCameraPermission, callingPid, callingUid) &amp;&amp;*/</span>
             <span class="token function">checkPermission</span><span class="token punctuation">(</span>sCameraPermission<span class="token punctuation">,</span> callingPid<span class="token punctuation">,</span> callingUid<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
@@ <span class="token operator">-</span><span class="token number">643</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">643</span><span class="token punctuation">,</span><span class="token number">7</span> @@ std<span class="token operator">::</span>string CameraService<span class="token operator">::</span><span class="token function">cameraIdIntToStrLocked</span><span class="token punctuation">(</span><span class="token keyword">int</span> cameraIdInt<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">&gt;</span> <span class="token operator">*</span>deviceIds <span class="token operator">=</span> <span class="token operator">&amp;</span>mNormalDeviceIdsWithoutSystemCamera<span class="token punctuation">;</span>
     <span class="token keyword">auto</span> callingPid <span class="token operator">=</span> CameraThreadState<span class="token operator">::</span><span class="token function">getCallingPid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">auto</span> callingUid <span class="token operator">=</span> CameraThreadState<span class="token operator">::</span><span class="token function">getCallingUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>sSystemCameraPermission<span class="token punctuation">,</span> callingPid<span class="token punctuation">,</span> callingUid<span class="token punctuation">)</span> <span class="token operator">||</span>
<span class="token operator">+</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token comment">/*checkPermission(sSystemCameraPermission, callingPid, callingUid)*/</span><span class="token function">hasPermissionsForSystemCamera</span><span class="token punctuation">(</span>callingPid<span class="token punctuation">,</span>callingUid<span class="token punctuation">)</span><span class="token operator">||</span>
             <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> callingPid<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         deviceIds <span class="token operator">=</span> <span class="token operator">&amp;</span>mNormalDeviceIds<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="32__1139"></a>32. 去除状态栏</h2> 
<pre><code class="prism language-c"><span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>qs<span class="token operator">/</span>QSFragment<span class="token punctuation">.</span>java
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>vendor<span class="token operator">/</span>mediatek<span class="token operator">/</span>proprietary<span class="token operator">/</span>packages<span class="token operator">/</span>apps<span class="token operator">/</span>SystemUI<span class="token operator">/</span>src<span class="token operator">/</span>com<span class="token operator">/</span>android<span class="token operator">/</span>systemui<span class="token operator">/</span>qs<span class="token operator">/</span>QSFragment<span class="token punctuation">.</span>java
@@ <span class="token operator">-</span><span class="token number">139</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">139</span><span class="token punctuation">,</span><span class="token number">9</span> @@ public class QSFragment extends LifecycleFragment implements QS<span class="token punctuation">,</span> CommandQueue<span class="token punctuation">.</span>Ca
         mFooter <span class="token operator">=</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>qs_footer<span class="token punctuation">)</span><span class="token punctuation">;</span>
         mContainer <span class="token operator">=</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span>id<span class="token punctuation">.</span>quick_settings_container<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token operator">+</span>        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"QSFragment"</span><span class="token punctuation">,</span><span class="token string">"=======mContainer==setVisibility(View.GONE)===="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        mContainer<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>GONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
         mQSContainerImplController <span class="token operator">=</span> mQSContainerImplControllerBuilder
                 <span class="token punctuation">.</span><span class="token function">setQSContainerImpl</span><span class="token punctuation">(</span><span class="token punctuation">(</span>QSContainerImpl<span class="token punctuation">)</span> view<span class="token punctuation">)</span>
                 <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="33_1155"></a>33.动态更换开机动画</h2> 
<pre><code class="prism language-c">diff <span class="token operator">--</span>git a<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc b<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc
index <span class="token number">50324</span>cd709<span class="token punctuation">.</span><span class="token number">.43</span>b0c14417 <span class="token number">100755</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc
@@ <span class="token operator">-</span><span class="token number">202</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">202</span><span class="token punctuation">,</span><span class="token number">7</span> @@ on post<span class="token operator">-</span>fs
     chmod <span class="token number">0770</span> <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_f
 
     chown system system <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_s
<span class="token operator">-</span>    chmod <span class="token number">0770</span> <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_s
<span class="token operator">+</span>    chmod <span class="token number">0777</span> <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_s
     chown root log <span class="token operator">/</span>proc<span class="token operator">/</span>ccci_sib
 
 on post<span class="token operator">-</span>fs<span class="token operator">-</span>data
diff <span class="token operator">--</span>git a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp
index <span class="token number">83</span>bbbbb55e<span class="token punctuation">.</span><span class="token punctuation">.</span>deb7b14877 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">9</span> @@ <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> PRODUCT_BOOTANIMATION_DARK_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> "<span class="token operator">/</span>product<span class="token operator">/</span>media<span class="token operator">/</span>bootanimat
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> PRODUCT_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/product/media/bootanimation.zip"</span><span class="token punctuation">;</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> SYSTEM_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/system/media/bootanimation.zip"</span><span class="token punctuation">;</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> APEX_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/apex/com.android.bootanimation/etc/bootanimation.zip"</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
<span class="token operator">+</span><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> EMDOOR_MNT_VENDOR_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/mnt/vendor/protect_s/bootanimation.zip"</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
diff <span class="token operator">--</span>git a<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc b<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc
index <span class="token number">50324</span>cd709<span class="token punctuation">.</span><span class="token number">.43</span>b0c14417 <span class="token number">100755</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>device<span class="token operator">/</span>mediatek<span class="token operator">/</span>mt8195<span class="token operator">/</span>init<span class="token punctuation">.</span>mt8195<span class="token punctuation">.</span>rc
@@ <span class="token operator">-</span><span class="token number">202</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">202</span><span class="token punctuation">,</span><span class="token number">7</span> @@ on post<span class="token operator">-</span>fs
     chmod <span class="token number">0770</span> <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_f
 
     chown system system <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_s
<span class="token operator">-</span>    chmod <span class="token number">0770</span> <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_s
<span class="token operator">+</span>    chmod <span class="token number">0777</span> <span class="token operator">/</span>mnt<span class="token operator">/</span>vendor<span class="token operator">/</span>protect_s
     chown root log <span class="token operator">/</span>proc<span class="token operator">/</span>ccci_sib
 
 on post<span class="token operator">-</span>fs<span class="token operator">-</span>data
diff <span class="token operator">--</span>git a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp
index <span class="token number">83</span>bbbbb55e<span class="token punctuation">.</span><span class="token punctuation">.</span>deb7b14877 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>frameworks<span class="token operator">/</span>base<span class="token operator">/</span>cmds<span class="token operator">/</span>bootanimation<span class="token operator">/</span>BootAnimation<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">9</span> @@ <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> PRODUCT_BOOTANIMATION_DARK_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> "<span class="token operator">/</span>product<span class="token operator">/</span>media<span class="token operator">/</span>bootanimat
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> PRODUCT_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/product/media/bootanimation.zip"</span><span class="token punctuation">;</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> SYSTEM_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/system/media/bootanimation.zip"</span><span class="token punctuation">;</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> APEX_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/apex/com.android.bootanimation/etc/bootanimation.zip"</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
<span class="token operator">+</span><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> EMDOOR_MNT_VENDOR_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/mnt/vendor/protect_s/bootanimation.zip"</span><span class="token punctuation">;</span>
<span class="token operator">+</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> PRODUCT_ENCRYPTED_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/product/media/bootanimation-encrypted.zip"</span><span class="token punctuation">;</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> SYSTEM_ENCRYPTED_BOOTANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/system/media/bootanimation-encrypted.zip"</span><span class="token punctuation">;</span>
 <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> OEM_SHUTDOWNANIMATION_FILE<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/oem/media/shutdownanimation.zip"</span><span class="token punctuation">;</span>
@@ <span class="token operator">-</span><span class="token number">545</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">548</span><span class="token punctuation">,</span><span class="token number">7</span> @@ <span class="token keyword">void</span> BootAnimation<span class="token operator">::</span><span class="token function">findBootAnimationFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 
     <span class="token keyword">const</span> bool playDarkAnim <span class="token operator">=</span> android<span class="token operator">::</span>base<span class="token operator">::</span><span class="token function">GetIntProperty</span><span class="token punctuation">(</span><span class="token string">"ro.boot.theme"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span>
     <span class="token keyword">static</span> <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">&gt;</span> bootFiles <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">-</span>        APEX_BOOTANIMATION_FILE<span class="token punctuation">,</span> playDarkAnim <span class="token operator">?</span> PRODUCT_BOOTANIMATION_DARK_FILE <span class="token operator">:</span> PRODUCT_BOOTANIMATION_FILE<span class="token punctuation">,</span>
<span class="token operator">+</span>        EMDOOR_MNT_VENDOR_BOOTANIMATION_FILE<span class="token punctuation">,</span>APEX_BOOTANIMATION_FILE<span class="token punctuation">,</span> playDarkAnim <span class="token operator">?</span> PRODUCT_BOOTANIMATION_DARK_FILE <span class="token operator">:</span> PRODUCT_BOOTANIMATION_FILE<span class="token punctuation">,</span>
         OEM_BOOTANIMATION_FILE<span class="token punctuation">,</span> SYSTEM_BOOTANIMATION_FILE
     <span class="token punctuation">}</span><span class="token punctuation">;</span>
     <span class="token keyword">static</span> <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">&gt;</span> shutdownFiles <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
</code></pre> 
<h2><a id="34_logfunc_1219"></a>34. log增加func的显示</h2> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;android/log.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGV</span><span class="token expression"><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_VERBOSE<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> </span><span class="token string">"%s "</span> <span class="token expression">format<span class="token punctuation">,</span> <span class="token constant">__func__</span><span class="token punctuation">,</span> </span><span class="token punctuation">##</span><span class="token expression">__VA_ARGS__<span class="token punctuation">)</span> </span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGD</span><span class="token expression"><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_DEBUG<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> </span><span class="token string">"%s "</span> <span class="token expression">format<span class="token punctuation">,</span> <span class="token constant">__func__</span><span class="token punctuation">,</span> </span><span class="token punctuation">##</span><span class="token expression">__VA_ARGS__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGI</span><span class="token expression"><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_INFO<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> </span><span class="token string">"%s "</span> <span class="token expression">format<span class="token punctuation">,</span> <span class="token constant">__func__</span><span class="token punctuation">,</span> </span><span class="token punctuation">##</span><span class="token expression">__VA_ARGS__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGW</span><span class="token expression"><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_WARN<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> </span><span class="token string">"%s "</span> <span class="token expression">format<span class="token punctuation">,</span> <span class="token constant">__func__</span><span class="token punctuation">,</span> </span><span class="token punctuation">##</span><span class="token expression">__VA_ARGS__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">LOGE</span><span class="token expression"><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token function">__android_log_print</span><span class="token punctuation">(</span>ANDROID_LOG_ERROR<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> </span><span class="token string">"%s "</span> <span class="token expression">format<span class="token punctuation">,</span> <span class="token constant">__func__</span><span class="token punctuation">,</span> </span><span class="token punctuation">##</span><span class="token expression">__VA_ARGS__<span class="token punctuation">)</span></span></span>
</code></pre> 
<h2><a id="35__1230"></a>35. 精确每一阶音量曲线</h2> 
<pre><code class="prism language-c"><span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>av<span class="token operator">/</span>services<span class="token operator">/</span>audiopolicy<span class="token operator">/</span>managerdefault<span class="token operator">/</span>AudioPolicyManager<span class="token punctuation">.</span>cpp
@@ <span class="token operator">-</span><span class="token number">6719</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token operator">+</span><span class="token number">6719</span><span class="token punctuation">,</span><span class="token number">18</span> @@ <span class="token class-name">status_t</span> AudioPolicyManager<span class="token operator">::</span><span class="token function">checkAndSetVolume</span><span class="token punctuation">(</span>IVolumeCurves <span class="token operator">&amp;</span>curves<span class="token punctuation">,</span>
         volumeDb <span class="token operator">=</span> <span class="token number">0.0f</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
<span class="token operator">+</span>    <span class="token keyword">float</span> dbCompensation<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5.42</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.04</span><span class="token punctuation">,</span>
<span class="token operator">+</span>                                <span class="token operator">-</span><span class="token number">11.17</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.64</span><span class="token punctuation">,</span>
<span class="token operator">+</span>                                <span class="token operator">-</span><span class="token number">9.17</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.64</span><span class="token punctuation">,</span>
<span class="token operator">+</span>                                <span class="token operator">-</span><span class="token number">10.16</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">8.21</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6.68</span><span class="token punctuation">,</span>
<span class="token operator">+</span>                                <span class="token operator">-</span><span class="token number">5.15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.21</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.68</span><span class="token punctuation">,</span>
<span class="token operator">+</span>                                <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">+</span>    volumeDb <span class="token operator">=</span> volumeDb <span class="token operator">+</span> dbCompensation<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">+</span>    <span class="token function">ALOGW</span><span class="token punctuation">(</span><span class="token string">"APM::computeVolume: volume source %d muted count %d active=%d, index = %d, volumeDb = %f"</span><span class="token punctuation">,</span> 
<span class="token operator">+</span>        volumeSource<span class="token punctuation">,</span> outputDesc<span class="token operator">-&gt;</span><span class="token function">getMuteCount</span><span class="token punctuation">(</span>volumeSource<span class="token punctuation">)</span><span class="token punctuation">,</span> outputDesc<span class="token operator">-&gt;</span><span class="token function">isActive</span><span class="token punctuation">(</span>volumeSource<span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> volumeDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c99ea63ed0ae94ebc1096ca3802e3017/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JDBC的简单使用与封装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31ebdbfadca8536f0a2e0156c688999e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Verilog含1个数统计电路设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>