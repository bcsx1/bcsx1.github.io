<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>signature=380c781d7acdb4a0b58b81f0ad23d1e8,certbot/certbot-auto at b841f0f307e3f7bda7122761e0efa1139... - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="signature=380c781d7acdb4a0b58b81f0ad23d1e8,certbot/certbot-auto at b841f0f307e3f7bda7122761e0efa1139..." />
<meta property="og:description" content="#!/bin/sh
#
# Download and run the latest release version of the Certbot client.
#
# NOTE: THIS SCRIPT IS AUTO-GENERATED AND SELF-UPDATING
#
# IF YOU WANT TO EDIT IT LOCALLY, *ALWAYS* RUN YOUR COPY WITH THE
# &#34;--no-self-upgrade&#34; FLAG
#
# IF YOU WANT TO SEND PULL REQUESTS, THE REAL SOURCE FOR THIS FILE IS
# letsencrypt-auto-source/letsencrypt-auto.template AND
# letsencrypt-auto-source/pieces/bootstrappers/*
set -e # Work even if somebody does &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2ed6ae136c0b3ff384ee3b2048cc86e5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-29T14:26:33+08:00" />
<meta property="article:modified_time" content="2021-05-29T14:26:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">signature=380c781d7acdb4a0b58b81f0ad23d1e8,certbot/certbot-auto at b841f0f307e3f7bda7122761e0efa1139...</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>#!/bin/sh</p> 
 <p>#</p> 
 <p># Download and run the latest release version of the Certbot client.</p> 
 <p>#</p> 
 <p># NOTE: THIS SCRIPT IS AUTO-GENERATED AND SELF-UPDATING</p> 
 <p>#</p> 
 <p># IF YOU WANT TO EDIT IT LOCALLY, *ALWAYS* RUN YOUR COPY WITH THE</p> 
 <p># "--no-self-upgrade" FLAG</p> 
 <p>#</p> 
 <p># IF YOU WANT TO SEND PULL REQUESTS, THE REAL SOURCE FOR THIS FILE IS</p> 
 <p># letsencrypt-auto-source/letsencrypt-auto.template AND</p> 
 <p># letsencrypt-auto-source/pieces/bootstrappers/*</p> 
 <p>set -e # Work even if somebody does "sh thisscript.sh".</p> 
 <p># Note: you can set XDG_DATA_HOME or VENV_PATH before running this script,</p> 
 <p># if you want to change where the virtual environment will be installed</p> 
 <p># HOME might not be defined when being run through something like systemd</p> 
 <p>if [ -z "$HOME" ]; then</p> 
 <p>HOME=~root</p> 
 <p>fi</p> 
 <p>if [ -z "$XDG_DATA_HOME" ]; then</p> 
 <p>XDG_DATA_HOME=~/.local/share</p> 
 <p>fi</p> 
 <p>if [ -z "$VENV_PATH" ]; then</p> 
 <p># We export these values so they are preserved properly if this script is</p> 
 <p># rerun with sudo/su where $HOME/$XDG_DATA_HOME may have a different value.</p> 
 <p>export OLD_VENV_PATH="$XDG_DATA_HOME/letsencrypt"</p> 
 <p>export VENV_PATH="/opt/eff.org/certbot/venv"</p> 
 <p>fi</p> 
 <p>VENV_BIN="$VENV_PATH/bin"</p> 
 <p>BOOTSTRAP_VERSION_PATH="$VENV_PATH/certbot-auto-bootstrap-version.txt"</p> 
 <p>LE_AUTO_VERSION="1.7.0"</p> 
 <p>BASENAME=$(basename $0)</p> 
 <p>USAGE="Usage: $BASENAME [OPTIONS]</p> 
 <p>A self-updating wrapper script for the Certbot ACME client. When run, updates</p> 
 <p>to both this script and certbot will be downloaded and installed. After</p> 
 <p>ensuring you have the latest versions installed, certbot will be invoked with</p> 
 <p>all arguments you have provided.</p> 
 <p>Help for certbot itself cannot be provided until it is installed.</p> 
 <p>--debug attempt experimental installation</p> 
 <p>-h, --help print this help</p> 
 <p>-n, --non-interactive, --noninteractive run without asking for user input</p> 
 <p>--no-bootstrap do not install OS dependencies</p> 
 <p>--no-permissions-check do not warn about file system permissions</p> 
 <p>--no-self-upgrade do not download updates</p> 
 <p>--os-packages-only install OS dependencies and exit</p> 
 <p>--install-only install certbot, upgrade if needed, and exit</p> 
 <p>-v, --verbose provide more output</p> 
 <p>-q, --quiet provide only update/error output;</p> 
 <p>implies --non-interactive</p> 
 <p>All arguments are accepted and forwarded to the Certbot client when run."</p> 
 <p>export CERTBOT_AUTO="$0"</p> 
 <p>for arg in "$@" ; do</p> 
 <p>case "$arg" in</p> 
 <p>--debug)</p> 
 <p>DEBUG=1;;</p> 
 <p>--os-packages-only)</p> 
 <p>OS_PACKAGES_ONLY=1;;</p> 
 <p>--install-only)</p> 
 <p>INSTALL_ONLY=1;;</p> 
 <p>--no-self-upgrade)</p> 
 <p># Do not upgrade this script (also prevents client upgrades, because each</p> 
 <p># copy of the script pins a hash of the python client)</p> 
 <p>NO_SELF_UPGRADE=1;;</p> 
 <p>--no-permissions-check)</p> 
 <p>NO_PERMISSIONS_CHECK=1;;</p> 
 <p>--no-bootstrap)</p> 
 <p>NO_BOOTSTRAP=1;;</p> 
 <p>--help)</p> 
 <p>HELP=1;;</p> 
 <p>--noninteractive|--non-interactive)</p> 
 <p>NONINTERACTIVE=1;;</p> 
 <p>--quiet)</p> 
 <p>QUIET=1;;</p> 
 <p>renew)</p> 
 <p>ASSUME_YES=1;;</p> 
 <p>--verbose)</p> 
 <p>VERBOSE=1;;</p> 
 <p>-[!-]*)</p> 
 <p>OPTIND=1</p> 
 <p>while getopts ":hnvq" short_arg $arg; do</p> 
 <p>case "$short_arg" in</p> 
 <p>h)</p> 
 <p>HELP=1;;</p> 
 <p>n)</p> 
 <p>NONINTERACTIVE=1;;</p> 
 <p>q)</p> 
 <p>QUIET=1;;</p> 
 <p>v)</p> 
 <p>VERBOSE=1;;</p> 
 <p>esac</p> 
 <p>done;;</p> 
 <p>esac</p> 
 <p>done</p> 
 <p>if [ $BASENAME = "letsencrypt-auto" ]; then</p> 
 <p># letsencrypt-auto does not respect --help or --yes for backwards compatibility</p> 
 <p>NONINTERACTIVE=1</p> 
 <p>HELP=0</p> 
 <p>fi</p> 
 <p># Set ASSUME_YES to 1 if QUIET or NONINTERACTIVE</p> 
 <p>if [ "$QUIET" = 1 -o "$NONINTERACTIVE" = 1 ]; then</p> 
 <p>ASSUME_YES=1</p> 
 <p>fi</p> 
 <p>say() {<!-- --></p> 
 <p>if [ "$QUIET" != 1 ]; then</p> 
 <p>echo "$@"</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>error() {<!-- --></p> 
 <p>echo "$@"</p> 
 <p>}</p> 
 <p># Support for busybox and others where there is no "command",</p> 
 <p># but "which" instead</p> 
 <p>if command -v command &gt; /dev/null 2&gt;&amp;1 ; then</p> 
 <p>export EXISTS="command -v"</p> 
 <p>elif which which &gt; /dev/null 2&gt;&amp;1 ; then</p> 
 <p>export EXISTS="which"</p> 
 <p>else</p> 
 <p>error "Cannot find command nor which... please install one!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p># Certbot itself needs root access for almost all modes of operation.</p> 
 <p># certbot-auto needs root access to bootstrap OS dependencies and install</p> 
 <p># Certbot at a protected path so it can be safely run as root. To accomplish</p> 
 <p># this, this script will attempt to run itself as root if it doesn't have the</p> 
 <p># necessary privileges by using `sudo` or falling back to `su` if it is not</p> 
 <p># available. The mechanism used to obtain root access can be set explicitly by</p> 
 <p># setting the environment variable LE_AUTO_SUDO to 'sudo', 'su', 'su_sudo',</p> 
 <p># 'SuSudo', or '' as used below.</p> 
 <p># Because the parameters in `su -c` has to be a string,</p> 
 <p># we need to properly escape it.</p> 
 <p>SuSudo() {<!-- --></p> 
 <p>args=""</p> 
 <p># This `while` loop iterates over all parameters given to this function.</p> 
 <p># For each parameter, all `'` will be replace by `'"'"'`, and the escaped string</p> 
 <p># will be wrapped in a pair of `'`, then appended to `$args` string</p> 
 <p># For example, `echo "It's only 1\$\!"` will be escaped to:</p> 
 <p># 'echo' 'It'"'"'s only 1$!'</p> 
 <p># │ │└┼┘│</p> 
 <p># │ │ │ └── `'s only 1$!'` the literal string</p> 
 <p># │ │ └── `\"'\"` is a single quote (as a string)</p> 
 <p># │ └── `'It'`, to be concatenated with the strings following it</p> 
 <p># └── `echo` wrapped in a pair of `'`, it's totally fine for the shell command itself</p> 
 <p>while [ $# -ne 0 ]; do</p> 
 <p>args="$args'$(printf "%s" "$1" | sed -e "s/'/'\"'\"'/g")' "</p> 
 <p>shift</p> 
 <p>done</p> 
 <p>su root -c "$args"</p> 
 <p>}</p> 
 <p># Sets the environment variable SUDO to be the name of the program or function</p> 
 <p># to call to get root access. If this script already has root privleges, SUDO</p> 
 <p># is set to an empty string. The value in SUDO should be run with the command</p> 
 <p># to called with root privileges as arguments.</p> 
 <p>SetRootAuthMechanism() {<!-- --></p> 
 <p>SUDO=""</p> 
 <p>if [ -n "${LE_AUTO_SUDO+x}" ]; then</p> 
 <p>case "$LE_AUTO_SUDO" in</p> 
 <p>SuSudo|su_sudo|su)</p> 
 <p>SUDO=SuSudo</p> 
 <p>;;</p> 
 <p>sudo)</p> 
 <p>SUDO="sudo -E"</p> 
 <p>;;</p> 
 <p>'')</p> 
 <p># If we're not running with root, don't check that this script can only</p> 
 <p># be modified by system users and groups.</p> 
 <p>NO_PERMISSIONS_CHECK=1</p> 
 <p>;;</p> 
 <p>*)</p> 
 <p>error "Error: unknown root authorization mechanism '$LE_AUTO_SUDO'."</p> 
 <p>exit 1</p> 
 <p>esac</p> 
 <p>say "Using preset root authorization mechanism '$LE_AUTO_SUDO'."</p> 
 <p>else</p> 
 <p>if test "`id -u`" -ne "0" ; then</p> 
 <p>if $EXISTS sudo 1&gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>SUDO="sudo -E"</p> 
 <p>else</p> 
 <p>say \"sudo\" is not available, will use \"su\" for installation steps...</p> 
 <p>SUDO=SuSudo</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>if [ "$1" = "--cb-auto-has-root" ]; then</p> 
 <p>shift 1</p> 
 <p>else</p> 
 <p>SetRootAuthMechanism</p> 
 <p>if [ -n "$SUDO" ]; then</p> 
 <p>say "Requesting to rerun $0 with root privileges..."</p> 
 <p>$SUDO "$0" --cb-auto-has-root "$@"</p> 
 <p>exit 0</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p># Runs this script again with the given arguments. --cb-auto-has-root is added</p> 
 <p># to the command line arguments to ensure we don't try to acquire root a</p> 
 <p># second time. After the script is rerun, we exit the current script.</p> 
 <p>RerunWithArgs() {<!-- --></p> 
 <p>"$0" --cb-auto-has-root "$@"</p> 
 <p>exit 0</p> 
 <p>}</p> 
 <p>BootstrapMessage() {<!-- --></p> 
 <p># Arguments: Platform name</p> 
 <p>say "Bootstrapping dependencies for $1... (you can skip this with --no-bootstrap)"</p> 
 <p>}</p> 
 <p>ExperimentalBootstrap() {<!-- --></p> 
 <p># Arguments: Platform name, bootstrap function name</p> 
 <p>if [ "$DEBUG" = 1 ]; then</p> 
 <p>if [ "$2" != "" ]; then</p> 
 <p>BootstrapMessage $1</p> 
 <p>$2</p> 
 <p>fi</p> 
 <p>else</p> 
 <p>error "FATAL: $1 support is very experimental at present..."</p> 
 <p>error "if you would like to work on improving it, please ensure you have backups"</p> 
 <p>error "and then run this script again with the --debug flag!"</p> 
 <p>error "Alternatively, you can install OS dependencies yourself and run this script"</p> 
 <p>error "again with --no-bootstrap."</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>DeprecationBootstrap() {<!-- --></p> 
 <p># Arguments: Platform name, bootstrap function name</p> 
 <p>if [ "$DEBUG" = 1 ]; then</p> 
 <p>if [ "$2" != "" ]; then</p> 
 <p>BootstrapMessage $1</p> 
 <p>$2</p> 
 <p>fi</p> 
 <p>else</p> 
 <p>error "WARNING: certbot-auto support for this $1 is DEPRECATED!"</p> 
 <p>error "Please visit certbot.eff.org to learn how to download a version of"</p> 
 <p>error "Certbot that is packaged for your system. While an existing version"</p> 
 <p>error "of certbot-auto may work currently, we have stopped supporting updating"</p> 
 <p>error "system packages for your system. Please switch to a packaged version"</p> 
 <p>error "as soon as possible."</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>MIN_PYTHON_2_VERSION="2.7"</p> 
 <p>MIN_PYVER2=$(echo "$MIN_PYTHON_2_VERSION" | sed 's/\.//')</p> 
 <p>MIN_PYTHON_3_VERSION="3.5"</p> 
 <p>MIN_PYVER3=$(echo "$MIN_PYTHON_3_VERSION" | sed 's/\.//')</p> 
 <p># Sets LE_PYTHON to Python version string and PYVER to the first two</p> 
 <p># digits of the python version.</p> 
 <p># MIN_PYVER and MIN_PYTHON_VERSION are also set by this function, and their</p> 
 <p># values depend on if we try to use Python 3 or Python 2.</p> 
 <p>DeterminePythonVersion() {<!-- --></p> 
 <p># Arguments: "NOCRASH" if we shouldn't crash if we don't find a good python</p> 
 <p>#</p> 
 <p># If no Python is found, PYVER is set to 0.</p> 
 <p>if [ "$USE_PYTHON_3" = 1 ]; then</p> 
 <p>MIN_PYVER=$MIN_PYVER3</p> 
 <p>MIN_PYTHON_VERSION=$MIN_PYTHON_3_VERSION</p> 
 <p>for LE_PYTHON in "$LE_PYTHON" python3; do</p> 
 <p># Break (while keeping the LE_PYTHON value) if found.</p> 
 <p>$EXISTS "$LE_PYTHON" &gt; /dev/null &amp;&amp; break</p> 
 <p>done</p> 
 <p>else</p> 
 <p>MIN_PYVER=$MIN_PYVER2</p> 
 <p>MIN_PYTHON_VERSION=$MIN_PYTHON_2_VERSION</p> 
 <p>for LE_PYTHON in "$LE_PYTHON" python2.7 python27 python2 python; do</p> 
 <p># Break (while keeping the LE_PYTHON value) if found.</p> 
 <p>$EXISTS "$LE_PYTHON" &gt; /dev/null &amp;&amp; break</p> 
 <p>done</p> 
 <p>fi</p> 
 <p>if [ "$?" != "0" ]; then</p> 
 <p>if [ "$1" != "NOCRASH" ]; then</p> 
 <p>error "Cannot find any Pythons; please install one!"</p> 
 <p>exit 1</p> 
 <p>else</p> 
 <p>PYVER=0</p> 
 <p>return 0</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>PYVER=$("$LE_PYTHON" -V 2&gt;&amp;1 | cut -d" " -f 2 | cut -d. -f1,2 | sed 's/\.//')</p> 
 <p>if [ "$PYVER" -lt "$MIN_PYVER" ]; then</p> 
 <p>if [ "$1" != "NOCRASH" ]; then</p> 
 <p>error "You have an ancient version of Python entombed in your operating system..."</p> 
 <p>error "This isn't going to work; you'll need at least version $MIN_PYTHON_VERSION."</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapDebCommon below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_DEB_COMMON_VERSION=1</p> 
 <p>BootstrapDebCommon() {<!-- --></p> 
 <p># Current version tested with:</p> 
 <p>#</p> 
 <p># - Ubuntu</p> 
 <p># - 14.04 (x64)</p> 
 <p># - 15.04 (x64)</p> 
 <p># - Debian</p> 
 <p># - 7.9 "wheezy" (x64)</p> 
 <p># - sid (2015-10-21) (x64)</p> 
 <p># Past versions tested with:</p> 
 <p>#</p> 
 <p># - Debian 8.0 "jessie" (x64)</p> 
 <p># - Raspbian 7.8 (armhf)</p> 
 <p># Believed not to work:</p> 
 <p>#</p> 
 <p># - Debian 6.0.10 "squeeze" (x64)</p> 
 <p>if [ "$QUIET" = 1 ]; then</p> 
 <p>QUIET_FLAG='-qq'</p> 
 <p>fi</p> 
 <p>apt-get $QUIET_FLAG update || error apt-get update hit problems but continuing anyway...</p> 
 <p># virtualenv binary can be found in different packages depending on</p> 
 <p># distro version (#346)</p> 
 <p>virtualenv=</p> 
 <p># virtual env is known to apt and is installable</p> 
 <p>if apt-cache show virtualenv &gt; /dev/null 2&gt;&amp;1 ; then</p> 
 <p>if ! LC_ALL=C apt-cache --quiet=0 show virtualenv 2&gt;&amp;1 | grep -q 'No packages found'; then</p> 
 <p>virtualenv="virtualenv"</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>if apt-cache show python-virtualenv &gt; /dev/null 2&gt;&amp;1; then</p> 
 <p>virtualenv="$virtualenv python-virtualenv"</p> 
 <p>fi</p> 
 <p>augeas_pkg="libaugeas0 augeas-lenses"</p> 
 <p>if [ "$ASSUME_YES" = 1 ]; then</p> 
 <p>YES_FLAG="-y"</p> 
 <p>fi</p> 
 <p>apt-get install $QUIET_FLAG $YES_FLAG --no-install-recommends \</p> 
 <p>python \</p> 
 <p>python-dev \</p> 
 <p>$virtualenv \</p> 
 <p>gcc \</p> 
 <p>$augeas_pkg \</p> 
 <p>libssl-dev \</p> 
 <p>openssl \</p> 
 <p>libffi-dev \</p> 
 <p>ca-certificates \</p> 
 <p>if ! $EXISTS virtualenv &gt; /dev/null ; then</p> 
 <p>error Failed to install a working \"virtualenv\" command, exiting</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapRpmCommonBase below, version</p> 
 <p># numbers in rpm_common.sh and rpm_python3.sh must be increased.</p> 
 <p># Sets TOOL to the name of the package manager</p> 
 <p># Sets appropriate values for YES_FLAG and QUIET_FLAG based on $ASSUME_YES and $QUIET_FLAG.</p> 
 <p># Note: this function is called both while selecting the bootstrap scripts and</p> 
 <p># during the actual bootstrap. Some things like prompting to user can be done in the latter</p> 
 <p># case, but not in the former one.</p> 
 <p>InitializeRPMCommonBase() {<!-- --></p> 
 <p>if type dnf 2&gt;/dev/null</p> 
 <p>then</p> 
 <p>TOOL=dnf</p> 
 <p>elif type yum 2&gt;/dev/null</p> 
 <p>then</p> 
 <p>TOOL=yum</p> 
 <p>else</p> 
 <p>error "Neither yum nor dnf found. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>if [ "$ASSUME_YES" = 1 ]; then</p> 
 <p>YES_FLAG="-y"</p> 
 <p>fi</p> 
 <p>if [ "$QUIET" = 1 ]; then</p> 
 <p>QUIET_FLAG='--quiet'</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>BootstrapRpmCommonBase() {<!-- --></p> 
 <p># Arguments: whitespace-delimited python packages to install</p> 
 <p>InitializeRPMCommonBase # This call is superfluous in practice</p> 
 <p>pkgs="</p> 
 <p>gcc</p> 
 <p>augeas-libs</p> 
 <p>openssl</p> 
 <p>openssl-devel</p> 
 <p>libffi-devel</p> 
 <p>redhat-rpm-config</p> 
 <p>ca-certificates</p> 
 <p>"</p> 
 <p># Add the python packages</p> 
 <p>pkgs="$pkgs</p> 
 <p>$1</p> 
 <p>"</p> 
 <p>if $TOOL list installed "httpd" &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>pkgs="$pkgs</p> 
 <p>mod_ssl</p> 
 <p>"</p> 
 <p>fi</p> 
 <p>if ! $TOOL install $YES_FLAG $QUIET_FLAG $pkgs; then</p> 
 <p>error "Could not install OS dependencies. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapRpmCommon below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_RPM_COMMON_VERSION=1</p> 
 <p>BootstrapRpmCommon() {<!-- --></p> 
 <p># Tested with:</p> 
 <p># - Fedora 20, 21, 22, 23 (x64)</p> 
 <p># - Centos 7 (x64: on DigitalOcean droplet)</p> 
 <p># - CentOS 7 Minimal install in a Hyper-V VM</p> 
 <p># - CentOS 6</p> 
 <p>InitializeRPMCommonBase</p> 
 <p># Most RPM distros use the "python" or "python-" naming convention. Let's try that first.</p> 
 <p>if $TOOL list python &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>python_pkgs="$python</p> 
 <p>python-devel</p> 
 <p>python-virtualenv</p> 
 <p>python-tools</p> 
 <p>python-pip</p> 
 <p>"</p> 
 <p># Fedora 26 starts to use the prefix python2 for python2 based packages.</p> 
 <p># this elseif is theoretically for any Fedora over version 26:</p> 
 <p>elif $TOOL list python2 &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>python_pkgs="$python2</p> 
 <p>python2-libs</p> 
 <p>python2-setuptools</p> 
 <p>python2-devel</p> 
 <p>python2-virtualenv</p> 
 <p>python2-tools</p> 
 <p>python2-pip</p> 
 <p>"</p> 
 <p># Some distros and older versions of current distros use a "python27"</p> 
 <p># instead of the "python" or "python-" naming convention.</p> 
 <p>else</p> 
 <p>python_pkgs="$python27</p> 
 <p>python27-devel</p> 
 <p>python27-virtualenv</p> 
 <p>python27-tools</p> 
 <p>python27-pip</p> 
 <p>"</p> 
 <p>fi</p> 
 <p>BootstrapRpmCommonBase "$python_pkgs"</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapRpmPython3 below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_RPM_PYTHON3_LEGACY_VERSION=1</p> 
 <p># Checks if rh-python36 can be installed.</p> 
 <p>Python36SclIsAvailable() {<!-- --></p> 
 <p>InitializeRPMCommonBase &gt;/dev/null 2&gt;&amp;1;</p> 
 <p>if "${TOOL}" list rh-python36 &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>return 0</p> 
 <p>fi</p> 
 <p>if "${TOOL}" list centos-release-scl &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>return 0</p> 
 <p>fi</p> 
 <p>return 1</p> 
 <p>}</p> 
 <p># Try to enable rh-python36 from SCL if it is necessary and possible.</p> 
 <p>EnablePython36SCL() {<!-- --></p> 
 <p>if "$EXISTS" python3.6 &gt; /dev/null 2&gt; /dev/null; then</p> 
 <p>return 0</p> 
 <p>fi</p> 
 <p>if [ ! -f /opt/rh/rh-python36/enable ]; then</p> 
 <p>return 0</p> 
 <p>fi</p> 
 <p>set +e</p> 
 <p>if ! . /opt/rh/rh-python36/enable; then</p> 
 <p>error 'Unable to enable rh-python36!'</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>set -e</p> 
 <p>}</p> 
 <p># This bootstrap concerns old RedHat-based distributions that do not ship by default</p> 
 <p># with Python 2.7, but only Python 2.6. We bootstrap them by enabling SCL and installing</p> 
 <p># Python 3.6. Some of these distributions are: CentOS/RHEL/OL/SL 6.</p> 
 <p>BootstrapRpmPython3Legacy() {<!-- --></p> 
 <p># Tested with:</p> 
 <p># - CentOS 6</p> 
 <p>InitializeRPMCommonBase</p> 
 <p>if ! "${TOOL}" list rh-python36 &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>echo "To use Certbot on this operating system, packages from the SCL repository need to be installed."</p> 
 <p>if ! "${TOOL}" list centos-release-scl &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>error "Enable the SCL repository and try running Certbot again."</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>if [ "${ASSUME_YES}" = 1 ]; then</p> 
 <p>/bin/echo -n "Enabling the SCL repository in 3 seconds... (Press Ctrl-C to cancel)"</p> 
 <p>sleep 1s</p> 
 <p>/bin/echo -ne "\e[0K\rEnabling the SCL repository in 2 seconds... (Press Ctrl-C to cancel)"</p> 
 <p>sleep 1s</p> 
 <p>/bin/echo -e "\e[0K\rEnabling the SCL repository in 1 second... (Press Ctrl-C to cancel)"</p> 
 <p>sleep 1s</p> 
 <p>fi</p> 
 <p>if ! "${TOOL}" install "${YES_FLAG}" "${QUIET_FLAG}" centos-release-scl; then</p> 
 <p>error "Could not enable SCL. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p># CentOS 6 must use rh-python36 from SCL</p> 
 <p>if "${TOOL}" list rh-python36 &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>python_pkgs="rh-python36-python</p> 
 <p>rh-python36-python-virtualenv</p> 
 <p>rh-python36-python-devel</p> 
 <p>"</p> 
 <p>else</p> 
 <p>error "No supported Python package available to install. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>BootstrapRpmCommonBase "${python_pkgs}"</p> 
 <p># Enable SCL rh-python36 after bootstrapping.</p> 
 <p>EnablePython36SCL</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapRpmPython3 below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_RPM_PYTHON3_VERSION=1</p> 
 <p>BootstrapRpmPython3() {<!-- --></p> 
 <p># Tested with:</p> 
 <p># - Fedora 29</p> 
 <p>InitializeRPMCommonBase</p> 
 <p># Fedora 29 must use python3-virtualenv</p> 
 <p>if $TOOL list python3-virtualenv &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>python_pkgs="python3</p> 
 <p>python3-virtualenv</p> 
 <p>python3-devel</p> 
 <p>"</p> 
 <p>else</p> 
 <p>error "No supported Python package available to install. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>BootstrapRpmCommonBase "$python_pkgs"</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapSuseCommon below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_SUSE_COMMON_VERSION=1</p> 
 <p>BootstrapSuseCommon() {<!-- --></p> 
 <p># SLE12 don't have python-virtualenv</p> 
 <p>if [ "$ASSUME_YES" = 1 ]; then</p> 
 <p>zypper_flags="-nq"</p> 
 <p>install_flags="-l"</p> 
 <p>fi</p> 
 <p>if [ "$QUIET" = 1 ]; then</p> 
 <p>QUIET_FLAG='-qq'</p> 
 <p>fi</p> 
 <p>if zypper search -x python-virtualenv &gt;/dev/null 2&gt;&amp;1; then</p> 
 <p>OPENSUSE_VIRTUALENV_PACKAGES="python-virtualenv"</p> 
 <p>else</p> 
 <p># Since Leap 15.0 (and associated Tumbleweed version), python-virtualenv</p> 
 <p># is a source package, and python2-virtualenv must be used instead.</p> 
 <p># Also currently python2-setuptools is not a dependency of python2-virtualenv,</p> 
 <p># while it should be. Installing it explicitly until upstream fix.</p> 
 <p>OPENSUSE_VIRTUALENV_PACKAGES="python2-virtualenv python2-setuptools"</p> 
 <p>fi</p> 
 <p>zypper $QUIET_FLAG $zypper_flags in $install_flags \</p> 
 <p>python \</p> 
 <p>python-devel \</p> 
 <p>$OPENSUSE_VIRTUALENV_PACKAGES \</p> 
 <p>gcc \</p> 
 <p>augeas-lenses \</p> 
 <p>libopenssl-devel \</p> 
 <p>libffi-devel \</p> 
 <p>ca-certificates</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapArchCommon below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_ARCH_COMMON_VERSION=1</p> 
 <p>BootstrapArchCommon() {<!-- --></p> 
 <p># Tested with:</p> 
 <p># - ArchLinux (x86_64)</p> 
 <p>#</p> 
 <p># "python-virtualenv" is Python3, but "python2-virtualenv" provides</p> 
 <p># only "virtualenv2" binary, not "virtualenv".</p> 
 <p>deps="</p> 
 <p>python2</p> 
 <p>python-virtualenv</p> 
 <p>gcc</p> 
 <p>augeas</p> 
 <p>openssl</p> 
 <p>libffi</p> 
 <p>ca-certificates</p> 
 <p>pkg-config</p> 
 <p>"</p> 
 <p># pacman -T exits with 127 if there are missing dependencies</p> 
 <p>missing=$(pacman -T $deps) || true</p> 
 <p>if [ "$ASSUME_YES" = 1 ]; then</p> 
 <p>noconfirm="--noconfirm"</p> 
 <p>fi</p> 
 <p>if [ "$missing" ]; then</p> 
 <p>if [ "$QUIET" = 1 ]; then</p> 
 <p>pacman -S --needed $missing $noconfirm &gt; /dev/null</p> 
 <p>else</p> 
 <p>pacman -S --needed $missing $noconfirm</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapGentooCommon below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_GENTOO_COMMON_VERSION=1</p> 
 <p>BootstrapGentooCommon() {<!-- --></p> 
 <p>PACKAGES="</p> 
 <p>dev-lang/python:2.7</p> 
 <p>dev-python/virtualenv</p> 
 <p>app-admin/augeas</p> 
 <p>dev-libs/openssl</p> 
 <p>dev-libs/libffi</p> 
 <p>app-misc/ca-certificates</p> 
 <p>virtual/pkgconfig"</p> 
 <p>ASK_OPTION="--ask"</p> 
 <p>if [ "$ASSUME_YES" = 1 ]; then</p> 
 <p>ASK_OPTION=""</p> 
 <p>fi</p> 
 <p>case "$PACKAGE_MANAGER" in</p> 
 <p>(paludis)</p> 
 <p>cave resolve --preserve-world --keep-targets if-possible $PACKAGES -x</p> 
 <p>;;</p> 
 <p>(pkgcore)</p> 
 <p>pmerge --noreplace --oneshot $ASK_OPTION $PACKAGES</p> 
 <p>;;</p> 
 <p>(portage|*)</p> 
 <p>emerge --noreplace --oneshot $ASK_OPTION $PACKAGES</p> 
 <p>;;</p> 
 <p>esac</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapFreeBsd below, this version number</p> 
 <p># must be increased.</p> 
 <p>BOOTSTRAP_FREEBSD_VERSION=1</p> 
 <p>BootstrapFreeBsd() {<!-- --></p> 
 <p>if [ "$QUIET" = 1 ]; then</p> 
 <p>QUIET_FLAG="--quiet"</p> 
 <p>fi</p> 
 <p>pkg install -Ay $QUIET_FLAG \</p> 
 <p>python \</p> 
 <p>py27-virtualenv \</p> 
 <p>augeas \</p> 
 <p>libffi</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapMac below, this version number must</p> 
 <p># be increased.</p> 
 <p>BOOTSTRAP_MAC_VERSION=1</p> 
 <p>BootstrapMac() {<!-- --></p> 
 <p>if hash brew 2&gt;/dev/null; then</p> 
 <p>say "Using Homebrew to install dependencies..."</p> 
 <p>pkgman=brew</p> 
 <p>pkgcmd="brew install"</p> 
 <p>elif hash port 2&gt;/dev/null; then</p> 
 <p>say "Using MacPorts to install dependencies..."</p> 
 <p>pkgman=port</p> 
 <p>pkgcmd="port install"</p> 
 <p>else</p> 
 <p>say "No Homebrew/MacPorts; installing Homebrew..."</p> 
 <p>ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</p> 
 <p>pkgman=brew</p> 
 <p>pkgcmd="brew install"</p> 
 <p>fi</p> 
 <p>$pkgcmd augeas</p> 
 <p>if [ "$(which python)" = "/System/Library/Frameworks/Python.framework/Versions/2.7/bin/python" \</p> 
 <p>-o "$(which python)" = "/usr/bin/python" ]; then</p> 
 <p># We want to avoid using the system Python because it requires root to use pip.</p> 
 <p># python.org, MacPorts or HomeBrew Python installations should all be OK.</p> 
 <p>say "Installing python..."</p> 
 <p>$pkgcmd python</p> 
 <p>fi</p> 
 <p># Workaround for _dlopen not finding augeas on macOS</p> 
 <p>if [ "$pkgman" = "port" ] &amp;&amp; ! [ -e "/usr/local/lib/libaugeas.dylib" ] &amp;&amp; [ -e "/opt/local/lib/libaugeas.dylib" ]; then</p> 
 <p>say "Applying augeas workaround"</p> 
 <p>mkdir -p /usr/local/lib/</p> 
 <p>ln -s /opt/local/lib/libaugeas.dylib /usr/local/lib/</p> 
 <p>fi</p> 
 <p>if ! hash pip 2&gt;/dev/null; then</p> 
 <p>say "pip not installed"</p> 
 <p>say "Installing pip..."</p> 
 <p>curl --silent --show-error --retry 5 https://bootstrap.pypa.io/get-pip.py | python</p> 
 <p>fi</p> 
 <p>if ! hash virtualenv 2&gt;/dev/null; then</p> 
 <p>say "virtualenv not installed."</p> 
 <p>say "Installing with pip..."</p> 
 <p>pip install virtualenv</p> 
 <p>fi</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapSmartOS below, this version number</p> 
 <p># must be increased.</p> 
 <p>BOOTSTRAP_SMARTOS_VERSION=1</p> 
 <p>BootstrapSmartOS() {<!-- --></p> 
 <p>pkgin update</p> 
 <p>pkgin -y install 'gcc49' 'py27-augeas' 'py27-virtualenv'</p> 
 <p>}</p> 
 <p># If new packages are installed by BootstrapMageiaCommon below, this version</p> 
 <p># number must be increased.</p> 
 <p>BOOTSTRAP_MAGEIA_COMMON_VERSION=1</p> 
 <p>BootstrapMageiaCommon() {<!-- --></p> 
 <p>if [ "$QUIET" = 1 ]; then</p> 
 <p>QUIET_FLAG='--quiet'</p> 
 <p>fi</p> 
 <p>if ! urpmi --force $QUIET_FLAG \</p> 
 <p>python \</p> 
 <p>libpython-devel \</p> 
 <p>python-virtualenv</p> 
 <p>then</p> 
 <p>error "Could not install Python dependencies. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>if ! urpmi --force $QUIET_FLAG \</p> 
 <p>git \</p> 
 <p>gcc \</p> 
 <p>python-augeas \</p> 
 <p>libopenssl-devel \</p> 
 <p>libffi-devel \</p> 
 <p>rootcerts</p> 
 <p>then</p> 
 <p>error "Could not install additional dependencies. Aborting bootstrap!"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>}</p> 
 <p># Set Bootstrap to the function that installs OS dependencies on this system</p> 
 <p># and BOOTSTRAP_VERSION to the unique identifier for the current version of</p> 
 <p># that function. If Bootstrap is set to a function that doesn't install any</p> 
 <p># packages BOOTSTRAP_VERSION is not set.</p> 
 <p>if [ -f /etc/debian_version ]; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>BootstrapMessage "Debian-based OSes"</p> 
 <p>BootstrapDebCommon</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapDebCommon $BOOTSTRAP_DEB_COMMON_VERSION"</p> 
 <p>elif [ -f /etc/mageia-release ]; then</p> 
 <p># Mageia has both /etc/mageia-release and /etc/redhat-release</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>ExperimentalBootstrap "Mageia" BootstrapMageiaCommon</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapMageiaCommon $BOOTSTRAP_MAGEIA_COMMON_VERSION"</p> 
 <p>elif [ -f /etc/redhat-release ]; then</p> 
 <p># Run DeterminePythonVersion to decide on the basis of available Python versions</p> 
 <p># whether to use 2.x or 3.x on RedHat-like systems.</p> 
 <p># Then, revert LE_PYTHON to its previous state.</p> 
 <p>prev_le_python="$LE_PYTHON"</p> 
 <p>unset LE_PYTHON</p> 
 <p>DeterminePythonVersion "NOCRASH"</p> 
 <p>RPM_DIST_NAME=`(. /etc/os-release 2&gt; /dev/null &amp;&amp; echo $ID) || echo "unknown"`</p> 
 <p>if [ "$PYVER" -eq 26 -a $(uname -m) != 'x86_64' ]; then</p> 
 <p># 32 bits CentOS 6 and affiliates are not supported anymore by certbot-auto.</p> 
 <p>DEPRECATED_OS=1</p> 
 <p>fi</p> 
 <p># Set RPM_DIST_VERSION to VERSION_ID from /etc/os-release after splitting on</p> 
 <p># '.' characters (e.g. "8.0" becomes "8"). If the command exits with an</p> 
 <p># error, RPM_DIST_VERSION is set to "unknown".</p> 
 <p>RPM_DIST_VERSION=$( (. /etc/os-release 2&gt; /dev/null &amp;&amp; echo "$VERSION_ID") | cut -d '.' -f1 || echo "unknown")</p> 
 <p># If RPM_DIST_VERSION is an empty string or it contains any nonnumeric</p> 
 <p># characters, the value is unexpected so we set RPM_DIST_VERSION to 0.</p> 
 <p>if [ -z "$RPM_DIST_VERSION" ] || [ -n "$(echo "$RPM_DIST_VERSION" | tr -d '[0-9]')" ]; then</p> 
 <p>RPM_DIST_VERSION=0</p> 
 <p>fi</p> 
 <p># Handle legacy RPM distributions</p> 
 <p>if [ "$PYVER" -eq 26 ]; then</p> 
 <p># Check if an automated bootstrap can be achieved on this system.</p> 
 <p>if ! Python36SclIsAvailable; then</p> 
 <p>INTERACTIVE_BOOTSTRAP=1</p> 
 <p>fi</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>BootstrapMessage "Legacy RedHat-based OSes that will use Python3"</p> 
 <p>BootstrapRpmPython3Legacy</p> 
 <p>}</p> 
 <p>USE_PYTHON_3=1</p> 
 <p>BOOTSTRAP_VERSION="BootstrapRpmPython3Legacy $BOOTSTRAP_RPM_PYTHON3_LEGACY_VERSION"</p> 
 <p># Try now to enable SCL rh-python36 for systems already bootstrapped</p> 
 <p># NB: EnablePython36SCL has been defined along with BootstrapRpmPython3Legacy in certbot-auto</p> 
 <p>EnablePython36SCL</p> 
 <p>else</p> 
 <p># Starting to Fedora 29, python2 is on a deprecation path. Let's move to python3 then.</p> 
 <p># RHEL 8 also uses python3 by default.</p> 
 <p>if [ "$RPM_DIST_NAME" = "fedora" -a "$RPM_DIST_VERSION" -ge 29 ]; then</p> 
 <p>RPM_USE_PYTHON_3=1</p> 
 <p>elif [ "$RPM_DIST_NAME" = "rhel" -a "$RPM_DIST_VERSION" -ge 8 ]; then</p> 
 <p>RPM_USE_PYTHON_3=1</p> 
 <p>elif [ "$RPM_DIST_NAME" = "centos" -a "$RPM_DIST_VERSION" -ge 8 ]; then</p> 
 <p>RPM_USE_PYTHON_3=1</p> 
 <p>else</p> 
 <p>RPM_USE_PYTHON_3=0</p> 
 <p>fi</p> 
 <p>if [ "$RPM_USE_PYTHON_3" = 1 ]; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>BootstrapMessage "RedHat-based OSes that will use Python3"</p> 
 <p>BootstrapRpmPython3</p> 
 <p>}</p> 
 <p>USE_PYTHON_3=1</p> 
 <p>BOOTSTRAP_VERSION="BootstrapRpmPython3 $BOOTSTRAP_RPM_PYTHON3_VERSION"</p> 
 <p>else</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>BootstrapMessage "RedHat-based OSes"</p> 
 <p>BootstrapRpmCommon</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapRpmCommon $BOOTSTRAP_RPM_COMMON_VERSION"</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>LE_PYTHON="$prev_le_python"</p> 
 <p>elif [ -f /etc/os-release ] &amp;&amp; `grep -q openSUSE /etc/os-release` ; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>BootstrapMessage "openSUSE-based OSes"</p> 
 <p>BootstrapSuseCommon</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapSuseCommon $BOOTSTRAP_SUSE_COMMON_VERSION"</p> 
 <p>elif [ -f /etc/arch-release ]; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>if [ "$DEBUG" = 1 ]; then</p> 
 <p>BootstrapMessage "Archlinux"</p> 
 <p>BootstrapArchCommon</p> 
 <p>else</p> 
 <p>error "Please use pacman to install letsencrypt packages:"</p> 
 <p>error "# pacman -S certbot certbot-apache"</p> 
 <p>error</p> 
 <p>error "If you would like to use the virtualenv way, please run the script again with the"</p> 
 <p>error "--debug flag."</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapArchCommon $BOOTSTRAP_ARCH_COMMON_VERSION"</p> 
 <p>elif [ -f /etc/manjaro-release ]; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>ExperimentalBootstrap "Manjaro Linux" BootstrapArchCommon</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapArchCommon $BOOTSTRAP_ARCH_COMMON_VERSION"</p> 
 <p>elif [ -f /etc/gentoo-release ]; then</p> 
 <p>DEPRECATED_OS=1</p> 
 <p>elif uname | grep -iq FreeBSD ; then</p> 
 <p>DEPRECATED_OS=1</p> 
 <p>elif uname | grep -iq Darwin ; then</p> 
 <p>DEPRECATED_OS=1</p> 
 <p>elif [ -f /etc/issue ] &amp;&amp; grep -iq "Amazon Linux" /etc/issue ; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>ExperimentalBootstrap "Amazon Linux" BootstrapRpmCommon</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapRpmCommon $BOOTSTRAP_RPM_COMMON_VERSION"</p> 
 <p>elif [ -f /etc/product ] &amp;&amp; grep -q "Joyent Instance" /etc/product ; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>ExperimentalBootstrap "Joyent SmartOS Zone" BootstrapSmartOS</p> 
 <p>}</p> 
 <p>BOOTSTRAP_VERSION="BootstrapSmartOS $BOOTSTRAP_SMARTOS_VERSION"</p> 
 <p>else</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>error "Sorry, I don't know how to bootstrap Certbot on your operating system!"</p> 
 <p>error</p> 
 <p>error "You will need to install OS dependencies, configure virtualenv, and run pip install manually."</p> 
 <p>error "Please see https://letsencrypt.readthedocs.org/en/latest/contributing.html#prerequisites"</p> 
 <p>error "for more info."</p> 
 <p>exit 1</p> 
 <p>}</p> 
 <p>fi</p> 
 <p># We handle this case after determining the normal bootstrap version to allow</p> 
 <p># variables like USE_PYTHON_3 to be properly set. As described above, if the</p> 
 <p># Bootstrap function doesn't install any packages, BOOTSTRAP_VERSION should not</p> 
 <p># be set so we unset it here.</p> 
 <p>if [ "$NO_BOOTSTRAP" = 1 ]; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>:</p> 
 <p>}</p> 
 <p>unset BOOTSTRAP_VERSION</p> 
 <p>fi</p> 
 <p>if [ "$DEPRECATED_OS" = 1 ]; then</p> 
 <p>Bootstrap() {<!-- --></p> 
 <p>error "Skipping bootstrap because certbot-auto is deprecated on this system."</p> 
 <p>}</p> 
 <p>unset BOOTSTRAP_VERSION</p> 
 <p>fi</p> 
 <p># Sets PREV_BOOTSTRAP_VERSION to the identifier for the bootstrap script used</p> 
 <p># to install OS dependencies on this system. PREV_BOOTSTRAP_VERSION isn't set</p> 
 <p># if it is unknown how OS dependencies were installed on this system.</p> 
 <p>SetPrevBootstrapVersion() {<!-- --></p> 
 <p>if [ -f $BOOTSTRAP_VERSION_PATH ]; then</p> 
 <p>PREV_BOOTSTRAP_VERSION=$(cat "$BOOTSTRAP_VERSION_PATH")</p> 
 <p># The list below only contains bootstrap version strings that existed before</p> 
 <p># we started writing them to disk.</p> 
 <p>#</p> 
 <p># DO NOT MODIFY THIS LIST UNLESS YOU KNOW WHAT YOU'RE DOING!</p> 
 <p>elif grep -Fqx "$BOOTSTRAP_VERSION" &lt;&lt; "UNLIKELY_EOF"</p> 
 <p>BootstrapDebCommon 1</p> 
 <p>BootstrapMageiaCommon 1</p> 
 <p>BootstrapRpmCommon 1</p> 
 <p>BootstrapSuseCommon 1</p> 
 <p>BootstrapArchCommon 1</p> 
 <p>BootstrapGentooCommon 1</p> 
 <p>BootstrapFreeBsd 1</p> 
 <p>BootstrapMac 1</p> 
 <p>BootstrapSmartOS 1</p> 
 <p>UNLIKELY_EOF</p> 
 <p>then</p> 
 <p># If there's no bootstrap version saved to disk, but the currently selected</p> 
 <p># bootstrap script is from before we started saving the version number,</p> 
 <p># return the currently selected version to prevent us from rebootstrapping</p> 
 <p># unnecessarily.</p> 
 <p>PREV_BOOTSTRAP_VERSION="$BOOTSTRAP_VERSION"</p> 
 <p>fi</p> 
 <p>}</p> 
 <p>TempDir() {<!-- --></p> 
 <p>mktemp -d 2&gt;/dev/null || mktemp -d -t 'le' # Linux || macOS</p> 
 <p>}</p> 
 <p># Returns 0 if a letsencrypt installation exists at $OLD_VENV_PATH, otherwise,</p> 
 <p># returns a non-zero number.</p> 
 <p>OldVenvExists() {<!-- --></p> 
 <p>[ -n "$OLD_VENV_PATH" -a -f "$OLD_VENV_PATH/bin/letsencrypt" ]</p> 
 <p>}</p> 
 <p># Given python path, version 1 and version 2, check if version 1 is outdated compared to version 2.</p> 
 <p># An unofficial version provided as version 1 (eg. 0.28.0.dev0) will be treated</p> 
 <p># specifically by printing "UNOFFICIAL". Otherwise, print "OUTDATED" if version 1</p> 
 <p># is outdated, and "UP_TO_DATE" if not.</p> 
 <p># This function relies only on installed python environment (2.x or 3.x) by certbot-auto.</p> 
 <p>CompareVersions() {<!-- --></p> 
 <p>"$1" - "$2" "$3" &lt;&lt; "UNLIKELY_EOF"</p> 
 <p>import sys</p> 
 <p>from distutils.version import StrictVersion</p> 
 <p>try:</p> 
 <p>current = StrictVersion(sys.argv[1])</p> 
 <p>except ValueError:</p> 
 <p>sys.stdout.write('UNOFFICIAL')</p> 
 <p>sys.exit()</p> 
 <p>try:</p> 
 <p>remote = StrictVersion(sys.argv[2])</p> 
 <p>except ValueError:</p> 
 <p>sys.stdout.write('UP_TO_DATE')</p> 
 <p>sys.exit()</p> 
 <p>if current &lt; remote:</p> 
 <p>sys.stdout.write('OUTDATED')</p> 
 <p>else:</p> 
 <p>sys.stdout.write('UP_TO_DATE')</p> 
 <p>UNLIKELY_EOF</p> 
 <p>}</p> 
 <p># Create a new virtual environment for Certbot. It will overwrite any existing one.</p> 
 <p># Parameters: LE_PYTHON, VENV_PATH, PYVER, VERBOSE</p> 
 <p>CreateVenv() {<!-- --></p> 
 <p>"$1" - "$2" "$3" "$4" &lt;&lt; "UNLIKELY_EOF"</p> 
 <p>#!/usr/bin/env python</p> 
 <p>import os</p> 
 <p>import shutil</p> 
 <p>import subprocess</p> 
 <p>import sys</p> 
 <p>def create_venv(venv_path, pyver, verbose):</p> 
 <p>if os.path.exists(venv_path):</p> 
 <p>shutil.rmtree(venv_path)</p> 
 <p>stdout = sys.stdout if verbose == '1' else open(os.devnull, 'w')</p> 
 <p>if int(pyver) &lt;= 27:</p> 
 <p># Use virtualenv binary</p> 
 <p>environ = os.environ.copy()</p> 
 <p>environ['VIRTUALENV_NO_DOWNLOAD'] = '1'</p> 
 <p>command = ['virtualenv', '--no-site-packages', '--python', sys.executable, venv_path]</p> 
 <p>subprocess.check_call(command, stdout=stdout, env=environ)</p> 
 <p>else:</p> 
 <p># Use embedded venv module in Python 3</p> 
 <p>command = [sys.executable, '-m', 'venv', venv_path]</p> 
 <p>subprocess.check_call(command, stdout=stdout)</p> 
 <p>if __name__ == '__main__':</p> 
 <p>create_venv(*sys.argv[1:])</p> 
 <p>UNLIKELY_EOF</p> 
 <p>}</p> 
 <p># Check that the given PATH_TO_CHECK has secured permissions.</p> 
 <p># Parameters: LE_PYTHON, PATH_TO_CHECK</p> 
 <p>CheckPathPermissions() {<!-- --></p> 
 <p>"$1" - "$2" &lt;&lt; "UNLIKELY_EOF"</p> 
 <p>"""Verifies certbot-auto cannot be modified by unprivileged users.</p> 
 <p>This script takes the path to certbot-auto as its only command line</p> 
 <p>argument. It then checks that the file can only be modified by uid/gid</p> 
 <p>&lt; 1000 and if other users can modify the file, it prints a warning with</p> 
 <p>a suggestion on how to solve the problem.</p> 
 <p>Permissions on symlinks in the absolute path of certbot-auto are ignored</p> 
 <p>and only the canonical path to certbot-auto is checked. There could be</p> 
 <p>permissions problems due to the symlinks that are unreported by this</p> 
 <p>script, however, issues like this were not caused by our documentation</p> 
 <p>and are ignored for the sake of simplicity.</p> 
 <p>All warnings are printed to stdout rather than stderr so all stderr</p> 
 <p>output from this script can be suppressed to avoid printing messages if</p> 
 <p>this script fails for some reason.</p> 
 <p>"""</p> 
 <p>from __future__ import print_function</p> 
 <p>import os</p> 
 <p>import stat</p> 
 <p>import sys</p> 
 <p>FORUM_POST_URL = 'https://community.letsencrypt.org/t/certbot-auto-deployment-best-practices/91979/'</p> 
 <p>def has_safe_permissions(path):</p> 
 <p>"""Returns True if the given path has secure permissions.</p> 
 <p>The permissions are considered safe if the file is only writable by</p> 
 <p>uid/gid &lt; 1000.</p> 
 <p>The reason we allow more IDs than 0 is because on some systems such</p> 
 <p>as Debian, system users/groups other than uid/gid 0 are used for the</p> 
 <p>path we recommend in our instructions which is /usr/local/bin. 1000</p> 
 <p>was chosen because on Debian 0-999 is reserved for system IDs[1] and</p> 
 <p>on RHEL either 0-499 or 0-999 is reserved depending on the</p> 
 <p>version[2][3]. Due to these differences across different OSes, this</p> 
 <p>detection isn't perfect so we only determine permissions are</p> 
 <p>insecure when we can be reasonably confident there is a problem</p> 
 <p>regardless of the underlying OS.</p> 
 <p>[1] https://www.debian.org/doc/debian-policy/ch-opersys.html#uid-and-gid-classes</p> 
 <p>[2] https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/ch-managing_users_and_groups</p> 
 <p>[3] https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-managing_users_and_groups</p> 
 <p>:param str path: filesystem path to check</p> 
 <p>:returns: True if the path has secure permissions, otherwise, False</p> 
 <p>:rtype: bool</p> 
 <p>"""</p> 
 <p># os.stat follows symlinks before obtaining information about a file.</p> 
 <p>stat_result = os.stat(path)</p> 
 <p>if stat_result.st_mode &amp; stat.S_IWOTH:</p> 
 <p>return False</p> 
 <p>if stat_result.st_mode &amp; stat.S_IWGRP and stat_result.st_gid &gt;= 1000:</p> 
 <p>return False</p> 
 <p>if stat_result.st_mode &amp; stat.S_IWUSR and stat_result.st_uid &gt;= 1000:</p> 
 <p>return False</p> 
 <p>return True</p> 
 <p>def main(certbot_auto_path):</p> 
 <p>current_path = os.path.realpath(certbot_auto_path)</p> 
 <p>last_path = None</p> 
 <p>permissions_ok = True</p> 
 <p># This loop makes use of the fact that os.path.dirname('/') == '/'.</p> 
 <p>while current_path != last_path and permissions_ok:</p> 
 <p>permissions_ok = has_safe_permissions(current_path)</p> 
 <p>last_path = current_path</p> 
 <p>current_path = os.path.dirname(current_path)</p> 
 <p>if not permissions_ok:</p> 
 <p>print('{0} has insecure permissions!'.format(certbot_auto_path))</p> 
 <p>print('To learn how to fix them, visit {0}'.format(FORUM_POST_URL))</p> 
 <p>if __name__ == '__main__':</p> 
 <p>main(sys.argv[1])</p> 
 <p>UNLIKELY_EOF</p> 
 <p>}</p> 
 <p>if [ "$1" = "--le-auto-phase2" ]; then</p> 
 <p># Phase 2: Create venv, install LE, and run.</p> 
 <p>shift 1 # the --le-auto-phase2 arg</p> 
 <p>if [ "$DEPRECATED_OS" = 1 ]; then</p> 
 <p># Phase 2 damage control mode for deprecated OSes.</p> 
 <p># In this situation, we bypass any bootstrap or certbot venv setup.</p> 
 <p>error "Your system is not supported by certbot-auto anymore."</p> 
 <p>if [ ! -d "$VENV_PATH" ] &amp;&amp; OldVenvExists; then</p> 
 <p>VENV_BIN="$OLD_VENV_PATH/bin"</p> 
 <p>fi</p> 
 <p>if [ -f "$VENV_BIN/letsencrypt" -a "$INSTALL_ONLY" != 1 ]; then</p> 
 <p>error "Certbot will no longer receive updates."</p> 
 <p>error "Please visit https://certbot.eff.org/ to check for other alternatives."</p> 
 <p>"$VENV_BIN/letsencrypt" "$@"</p> 
 <p>exit 0</p> 
 <p>else</p> 
 <p>error "Certbot cannot be installed."</p> 
 <p>error "Please visit https://certbot.eff.org/ to check for other alternatives."</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>SetPrevBootstrapVersion</p> 
 <p>if [ -z "$PHASE_1_VERSION" -a "$USE_PYTHON_3" = 1 ]; then</p> 
 <p>unset LE_PYTHON</p> 
 <p>fi</p> 
 <p>INSTALLED_VERSION="none"</p> 
 <p>if [ -d "$VENV_PATH" ] || OldVenvExists; then</p> 
 <p># If the selected Bootstrap function isn't a noop and it differs from the</p> 
 <p># previously used version</p> 
 <p>if [ -n "$BOOTSTRAP_VERSION" -a "$BOOTSTRAP_VERSION" != "$PREV_BOOTSTRAP_VERSION" ]; then</p> 
 <p># Check if we can rebootstrap without manual user intervention: this requires that</p> 
 <p># certbot-auto is in non-interactive mode AND selected bootstrap does not claim to</p> 
 <p># require a manual user intervention.</p> 
 <p>if [ "$NONINTERACTIVE" = 1 -a "$INTERACTIVE_BOOTSTRAP" != 1 ]; then</p> 
 <p>CAN_REBOOTSTRAP=1</p> 
 <p>fi</p> 
 <p># Check if rebootstrap can be done non-interactively and current shell is non-interactive</p> 
 <p># (true if stdin and stdout are not attached to a terminal).</p> 
 <p>if [ \( "$CAN_REBOOTSTRAP" = 1 \) -o \( \( -t 0 \) -a \( -t 1 \) \) ]; then</p> 
 <p>if [ -d "$VENV_PATH" ]; then</p> 
 <p>rm -rf "$VENV_PATH"</p> 
 <p>fi</p> 
 <p># In the case the old venv was just a symlink to the new one,</p> 
 <p># OldVenvExists is now false because we deleted the venv at VENV_PATH.</p> 
 <p>if OldVenvExists; then</p> 
 <p>rm -rf "$OLD_VENV_PATH"</p> 
 <p>ln -s "$VENV_PATH" "$OLD_VENV_PATH"</p> 
 <p>fi</p> 
 <p>RerunWithArgs "$@"</p> 
 <p># Otherwise bootstrap needs to be done manually by the user.</p> 
 <p>else</p> 
 <p># If it is because bootstrapping is interactive, --non-interactive will be of no use.</p> 
 <p>if [ "$INTERACTIVE_BOOTSTRAP" = 1 ]; then</p> 
 <p>error "Skipping upgrade because new OS dependencies may need to be installed."</p> 
 <p>error "This requires manual user intervention: please run this script again manually."</p> 
 <p># If this is because of the environment (eg. non interactive shell without</p> 
 <p># --non-interactive flag set), help the user in that direction.</p> 
 <p>else</p> 
 <p>error "Skipping upgrade because new OS dependencies may need to be installed."</p> 
 <p>error</p> 
 <p>error "To upgrade to a newer version, please run this script again manually so you can"</p> 
 <p>error "approve changes or with --non-interactive on the command line to automatically"</p> 
 <p>error "install any required packages."</p> 
 <p>fi</p> 
 <p># Set INSTALLED_VERSION to be the same so we don't update the venv</p> 
 <p>INSTALLED_VERSION="$LE_AUTO_VERSION"</p> 
 <p># Continue to use OLD_VENV_PATH if the new venv doesn't exist</p> 
 <p>if [ ! -d "$VENV_PATH" ]; then</p> 
 <p>VENV_BIN="$OLD_VENV_PATH/bin"</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>elif [ -f "$VENV_BIN/letsencrypt" ]; then</p> 
 <p># --version output ran through grep due to python-cryptography DeprecationWarnings</p> 
 <p># grep for both certbot and letsencrypt until certbot and shim packages have been released</p> 
 <p>INSTALLED_VERSION=$("$VENV_BIN/letsencrypt" --version 2&gt;&amp;1 | grep "^certbot\|^letsencrypt" | cut -d " " -f 2)</p> 
 <p>if [ -z "$INSTALLED_VERSION" ]; then</p> 
 <p>error "Error: couldn't get currently installed version for $VENV_BIN/letsencrypt: " 1&gt;&amp;2</p> 
 <p>"$VENV_BIN/letsencrypt" --version</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>if [ "$LE_AUTO_VERSION" != "$INSTALLED_VERSION" ]; then</p> 
 <p>say "Creating virtual environment..."</p> 
 <p>DeterminePythonVersion</p> 
 <p>CreateVenv "$LE_PYTHON" "$VENV_PATH" "$PYVER" "$VERBOSE"</p> 
 <p>if [ -n "$BOOTSTRAP_VERSION" ]; then</p> 
 <p>echo "$BOOTSTRAP_VERSION" &gt; "$BOOTSTRAP_VERSION_PATH"</p> 
 <p>elif [ -n "$PREV_BOOTSTRAP_VERSION" ]; then</p> 
 <p>echo "$PREV_BOOTSTRAP_VERSION" &gt; "$BOOTSTRAP_VERSION_PATH"</p> 
 <p>fi</p> 
 <p>say "Installing Python packages..."</p> 
 <p>TEMP_DIR=$(TempDir)</p> 
 <p>trap 'rm -rf "$TEMP_DIR"' EXIT</p> 
 <p># There is no $ interpolation due to quotes on starting heredoc delimiter.</p> 
 <p># -------------------------------------------------------------------------</p> 
 <p>cat &lt;&lt; "UNLIKELY_EOF" &gt; "$TEMP_DIR/letsencrypt-auto-requirements.txt"</p> 
 <p># This is the flattened list of packages certbot-auto installs.</p> 
 <p># To generate this, do (with docker and package hashin installed):</p> 
 <p># ```</p> 
 <p># letsencrypt-auto-source/rebuild_dependencies.py \</p> 
 <p># letsencrypt-auto-source/pieces/dependency-requirements.txt</p> 
 <p># ```</p> 
 <p># If you want to update a single dependency, run commands similar to these:</p> 
 <p># ```</p> 
 <p># pip install hashin</p> 
 <p># hashin -r dependency-requirements.txt cryptography==1.5.2</p> 
 <p># ```</p> 
 <p>ConfigArgParse==1.2.3 \</p> 
 <p>--hash=sha256:edd17be986d5c1ba2e307150b8e5f5107aba125f3574dddd02c85d5cdcfd37dc</p> 
 <p>certifi==2020.4.5.1 \</p> 
 <p>--hash=sha256:1d987a998c75633c40847cc966fcf5904906c920a7f17ef374f5aa4282abd304 \</p> 
 <p>--hash=sha256:51fcb31174be6e6664c5f69e3e1691a2d72a1a12e90f872cbdb1567eb47b6519</p> 
 <p>cffi==1.14.0 \</p> 
 <p>--hash=sha256:001bf3242a1bb04d985d63e138230802c6c8d4db3668fb545fb5005ddf5bb5ff \</p> 
 <p>--hash=sha256:00789914be39dffba161cfc5be31b55775de5ba2235fe49aa28c148236c4e06b \</p> 
 <p>--hash=sha256:028a579fc9aed3af38f4892bdcc7390508adabc30c6af4a6e4f611b0c680e6ac \</p> 
 <p>--hash=sha256:14491a910663bf9f13ddf2bc8f60562d6bc5315c1f09c704937ef17293fb85b0 \</p> 
 <p>--hash=sha256:1cae98a7054b5c9391eb3249b86e0e99ab1e02bb0cc0575da191aedadbdf4384 \</p> 
 <p>--hash=sha256:2089ed025da3919d2e75a4d963d008330c96751127dd6f73c8dc0c65041b4c26 \</p> 
 <p>--hash=sha256:2d384f4a127a15ba701207f7639d94106693b6cd64173d6c8988e2c25f3ac2b6 \</p> 
 <p>--hash=sha256:337d448e5a725bba2d8293c48d9353fc68d0e9e4088d62a9571def317797522b \</p> 
 <p>--hash=sha256:399aed636c7d3749bbed55bc907c3288cb43c65c4389964ad5ff849b6370603e \</p> 
 <p>--hash=sha256:3b911c2dbd4f423b4c4fcca138cadde747abdb20d196c4a48708b8a2d32b16dd \</p> 
 <p>--hash=sha256:3d311bcc4a41408cf5854f06ef2c5cab88f9fded37a3b95936c9879c1640d4c2 \</p> 
 <p>--hash=sha256:62ae9af2d069ea2698bf536dcfe1e4eed9090211dbaafeeedf5cb6c41b352f66 \</p> 
 <p>--hash=sha256:66e41db66b47d0d8672d8ed2708ba91b2f2524ece3dee48b5dfb36be8c2f21dc \</p> 
 <p>--hash=sha256:675686925a9fb403edba0114db74e741d8181683dcf216be697d208857e04ca8 \</p> 
 <p>--hash=sha256:7e63cbcf2429a8dbfe48dcc2322d5f2220b77b2e17b7ba023d6166d84655da55 \</p> 
 <p>--hash=sha256:8a6c688fefb4e1cd56feb6c511984a6c4f7ec7d2a1ff31a10254f3c817054ae4 \</p> 
 <p>--hash=sha256:8c0ffc886aea5df6a1762d0019e9cb05f825d0eec1f520c51be9d198701daee5 \</p> 
 <p>--hash=sha256:95cd16d3dee553f882540c1ffe331d085c9e629499ceadfbda4d4fde635f4b7d \</p> 
 <p>--hash=sha256:99f748a7e71ff382613b4e1acc0ac83bf7ad167fb3802e35e90d9763daba4d78 \</p> 
 <p>--hash=sha256:b8c78301cefcf5fd914aad35d3c04c2b21ce8629b5e4f4e45ae6812e461910fa \</p> 
 <p>--hash=sha256:c420917b188a5582a56d8b93bdd8e0f6eca08c84ff623a4c16e809152cd35793 \</p> 
 <p>--hash=sha256:c43866529f2f06fe0edc6246eb4faa34f03fe88b64a0a9a942561c8e22f4b71f \</p> 
 <p>--hash=sha256:cab50b8c2250b46fe738c77dbd25ce017d5e6fb35d3407606e7a4180656a5a6a \</p> 
 <p>--hash=sha256:cef128cb4d5e0b3493f058f10ce32365972c554572ff821e175dbc6f8ff6924f \</p> 
 <p>--hash=sha256:cf16e3cf6c0a5fdd9bc10c21687e19d29ad1fe863372b5543deaec1039581a30 \</p> 
 <p>--hash=sha256:e56c744aa6ff427a607763346e4170629caf7e48ead6921745986db3692f987f \</p> 
 <p>--hash=sha256:e577934fc5f8779c554639376beeaa5657d54349096ef24abe8c74c5d9c117c3 \</p> 
 <p>--hash=sha256:f2b0fa0c01d8a0c7483afd9f31d7ecf2d71760ca24499c8697aeb5ca37dc090c</p> 
 <p>chardet==3.0.4 \</p> 
 <p>--hash=sha256:84ab92ed1c4d4f16916e05906b6b75a6c0fb5db821cc65e70cbd64a3e2a5eaae \</p> 
 <p>--hash=sha256:fc323ffcaeaed0e0a02bf4d117757b98aed530d9ed4531e3e15460124c106691</p> 
 <p>configobj==5.0.6 \</p> 
 <p>--hash=sha256:a2f5650770e1c87fb335af19a9b7eb73fc05ccf22144eb68db7d00cd2bcb0902</p> 
 <p>cryptography==2.8 \</p> 
 <p>--hash=sha256:02079a6addc7b5140ba0825f542c0869ff4df9a69c360e339ecead5baefa843c \</p> 
 <p>--hash=sha256:1df22371fbf2004c6f64e927668734070a8953362cd8370ddd336774d6743595 \</p> 
 <p>--hash=sha256:369d2346db5934345787451504853ad9d342d7f721ae82d098083e1f49a582ad \</p> 
 <p>--hash=sha256:3cda1f0ed8747339bbdf71b9f38ca74c7b592f24f65cdb3ab3765e4b02871651 \</p> 
 <p>--hash=sha256:44ff04138935882fef7c686878e1c8fd80a723161ad6a98da31e14b7553170c2 \</p> 
 <p>--hash=sha256:4b1030728872c59687badcca1e225a9103440e467c17d6d1730ab3d2d64bfeff \</p> 
 <p>--hash=sha256:58363dbd966afb4f89b3b11dfb8ff200058fbc3b947507675c19ceb46104b48d \</p> 
 <p>--hash=sha256:6ec280fb24d27e3d97aa731e16207d58bd8ae94ef6eab97249a2afe4ba643d42 \</p> 
 <p>--hash=sha256:7270a6c29199adc1297776937a05b59720e8a782531f1f122f2eb8467f9aab4d \</p> 
 <p>--hash=sha256:73fd30c57fa2d0a1d7a49c561c40c2f79c7d6c374cc7750e9ac7c99176f6428e \</p> 
 <p>--hash=sha256:7f09806ed4fbea8f51585231ba742b58cbcfbfe823ea197d8c89a5e433c7e912 \</p> 
 <p>--hash=sha256:90df0cc93e1f8d2fba8365fb59a858f51a11a394d64dbf3ef844f783844cc793 \</p> 
 <p>--hash=sha256:971221ed40f058f5662a604bd1ae6e4521d84e6cad0b7b170564cc34169c8f13 \</p> 
 <p>--hash=sha256:a518c153a2b5ed6b8cc03f7ae79d5ffad7315ad4569b2d5333a13c38d64bd8d7 \</p> 
 <p>--hash=sha256:b0de590a8b0979649ebeef8bb9f54394d3a41f66c5584fff4220901739b6b2f0 \</p> 
 <p>--hash=sha256:b43f53f29816ba1db8525f006fa6f49292e9b029554b3eb56a189a70f2a40879 \</p> 
 <p>--hash=sha256:d31402aad60ed889c7e57934a03477b572a03af7794fa8fb1780f21ea8f6551f \</p> 
 <p>--hash=sha256:de96157ec73458a7f14e3d26f17f8128c959084931e8997b9e655a39c8fde9f9 \</p> 
 <p>--hash=sha256:df6b4dca2e11865e6cfbfb708e800efb18370f5a46fd601d3755bc7f85b3a8a2 \</p> 
 <p>--hash=sha256:ecadccc7ba52193963c0475ac9f6fa28ac01e01349a2ca48509667ef41ffd2cf \</p> 
 <p>--hash=sha256:fb81c17e0ebe3358486cd8cc3ad78adbae58af12fc2bf2bc0bb84e8090fa5ce8</p> 
 <p>distro==1.5.0 \</p> 
 <p>--hash=sha256:0e58756ae38fbd8fc3020d54badb8eae17c5b9dcbed388b17bb55b8a5928df92 \</p> 
 <p>--hash=sha256:df74eed763e18d10d0da624258524ae80486432cd17392d9c3d96f5e83cd2799</p> 
 <p>enum34==1.1.10; python_version &lt; '3.4' \</p> 
 <p>--hash=sha256:a98a201d6de3f2ab3db284e70a33b0f896fbf35f8086594e8c9e74b909058d53 \</p> 
 <p>--hash=sha256:c3858660960c984d6ab0ebad691265180da2b43f07e061c0f8dca9ef3cffd328 \</p> 
 <p>--hash=sha256:cce6a7477ed816bd2542d03d53db9f0db935dd013b70f336a95c73979289f248</p> 
 <p>funcsigs==1.0.2 \</p> 
 <p>--hash=sha256:330cc27ccbf7f1e992e69fef78261dc7c6569012cf397db8d3de0234e6c937ca \</p> 
 <p>--hash=sha256:a7bb0f2cf3a3fd1ab2732cb49eba4252c2af4240442415b4abce3b87022a8f50</p> 
 <p>idna==2.9 \</p> 
 <p>--hash=sha256:7588d1c14ae4c77d74036e8c22ff447b26d0fde8f007354fd48a7814db15b7cb \</p> 
 <p>--hash=sha256:a068a21ceac8a4d63dbfd964670474107f541babbd2250d61922f029858365fa</p> 
 <p>ipaddress==1.0.23 \</p> 
 <p>--hash=sha256:6e0f4a39e66cb5bb9a137b00276a2eff74f93b71dcbdad6f10ff7df9d3557fcc \</p> 
 <p>--hash=sha256:b7f8e0369580bb4a24d5ba1d7cc29660a4a6987763faf1d8a8046830e020e7e2</p> 
 <p>josepy==1.3.0 \</p> 
 <p>--hash=sha256:c341ffa403399b18e9eae9012f804843045764d1390f9cb4648980a7569b1619 \</p> 
 <p>--hash=sha256:e54882c64be12a2a76533f73d33cba9e331950fda9e2731e843490b774e7a01c</p> 
 <p>mock==1.3.0 \</p> 
 <p>--hash=sha256:1e247dbecc6ce057299eb7ee019ad68314bb93152e81d9a6110d35f4d5eca0f6 \</p> 
 <p>--hash=sha256:3f573a18be94de886d1191f27c168427ef693e8dcfcecf95b170577b2eb69cbb</p> 
 <p>parsedatetime==2.5 \</p> 
 <p>--hash=sha256:3b835fc54e472c17ef447be37458b400e3fefdf14bb1ffdedb5d2c853acf4ba1 \</p> 
 <p>--hash=sha256:d2e9ddb1e463de871d32088a3f3cea3dc8282b1b2800e081bd0ef86900451667</p> 
 <p>pbr==5.4.5 \</p> 
 <p>--hash=sha256:07f558fece33b05caf857474a366dfcc00562bca13dd8b47b2b3e22d9f9bf55c \</p> 
 <p>--hash=sha256:579170e23f8e0c2f24b0de612f71f648eccb79fb1322c814ae6b3c07b5ba23e8</p> 
 <p>pyOpenSSL==19.1.0 \</p> 
 <p>--hash=sha256:621880965a720b8ece2f1b2f54ea2071966ab00e2970ad2ce11d596102063504 \</p> 
 <p>--hash=sha256:9a24494b2602aaf402be5c9e30a0b82d4a5c67528fe8fb475e3f3bc00dd69507</p> 
 <p>pyRFC3339==1.1 \</p> 
 <p>--hash=sha256:67196cb83b470709c580bb4738b83165e67c6cc60e1f2e4f286cfcb402a926f4 \</p> 
 <p>--hash=sha256:81b8cbe1519cdb79bed04910dd6fa4e181faf8c88dff1e1b987b5f7ab23a5b1a</p> 
 <p>pycparser==2.20 \</p> 
 <p>--hash=sha256:2d475327684562c3a96cc71adf7dc8c4f0565175cf86b6d7a404ff4c771f15f0 \</p> 
 <p>--hash=sha256:7582ad22678f0fcd81102833f60ef8d0e57288b6b5fb00323d101be910e35705</p> 
 <p>pyparsing==2.4.7 \</p> 
 <p>--hash=sha256:c203ec8783bf771a155b207279b9bccb8dea02d8f0c9e5f8ead507bc3246ecc1 \</p> 
 <p>--hash=sha256:ef9d7589ef3c200abe66653d3f1ab1033c3c419ae9b9bdb1240a85b024efc88b</p> 
 <p>python-augeas==0.5.0 \</p> 
 <p>--hash=sha256:67d59d66cdba8d624e0389b87b2a83a176f21f16a87553b50f5703b23f29bac2</p> 
 <p>pytz==2020.1 \</p> 
 <p>--hash=sha256:a494d53b6d39c3c6e44c3bec237336e14305e4f29bbf800b599253057fbb79ed \</p> 
 <p>--hash=sha256:c35965d010ce31b23eeb663ed3cc8c906275d6be1a34393a1d73a41febf4a048</p> 
 <p>requests==2.23.0 \</p> 
 <p>--hash=sha256:43999036bfa82904b6af1d99e4882b560e5e2c68e5c4b0aa03b655f3d7d73fee \</p> 
 <p>--hash=sha256:b3f43d496c6daba4493e7c431722aeb7dbc6288f52a6e04e7b6023b0247817e6</p> 
 <p>requests-toolbelt==0.9.1 \</p> 
 <p>--hash=sha256:380606e1d10dc85c3bd47bf5a6095f815ec007be7a8b69c878507068df059e6f \</p> 
 <p>--hash=sha256:968089d4584ad4ad7c171454f0a5c6dac23971e9472521ea3b6d49d610aa6fc0</p> 
 <p>six==1.15.0 \</p> 
 <p>--hash=sha256:30639c035cdb23534cd4aa2dd52c3bf48f06e5f4a941509c8bafd8ce11080259 \</p> 
 <p>--hash=sha256:8b74bedcbbbaca38ff6d7491d76f2b06b3592611af620f8426e82dddb04a5ced</p> 
 <p>urllib3==1.25.9 \</p> 
 <p>--hash=sha256:3018294ebefce6572a474f0604c2021e33b3fd8006ecd11d62107a5d2a963527 \</p> 
 <p>--hash=sha256:88206b0eb87e6d677d424843ac5209e3fb9d0190d0ee169599165ec25e9d9115</p> 
 <p>zope.component==4.6.1 \</p> 
 <p>--hash=sha256:bfbe55d4a93e70a78b10edc3aad4de31bb8860919b7cbd8d66f717f7d7b279ac \</p> 
 <p>--hash=sha256:d9c7c27673d787faff8a83797ce34d6ebcae26a370e25bddb465ac2182766aca</p> 
 <p>zope.deferredimport==4.3.1 \</p> 
 <p>--hash=sha256:57b2345e7b5eef47efcd4f634ff16c93e4265de3dcf325afc7315ade48d909e1 \</p> 
 <p>--hash=sha256:9a0c211df44aa95f1c4e6d2626f90b400f56989180d3ef96032d708da3d23e0a</p> 
 <p>zope.deprecation==4.4.0 \</p> 
 <p>--hash=sha256:0d453338f04bacf91bbfba545d8bcdf529aa829e67b705eac8c1a7fdce66e2df \</p> 
 <p>--hash=sha256:f1480b74995958b24ce37b0ef04d3663d2683e5d6debc96726eff18acf4ea113</p> 
 <p>zope.event==4.4 \</p> 
 <p>--hash=sha256:69c27debad9bdacd9ce9b735dad382142281ac770c4a432b533d6d65c4614bcf \</p> 
 <p>--hash=sha256:d8e97d165fd5a0997b45f5303ae11ea3338becfe68c401dd88ffd2113fe5cae7</p> 
 <p>zope.hookable==5.0.1 \</p> 
 <p>--hash=sha256:0194b9b9e7f614abba60c90b231908861036578297515d3d6508eb10190f266d \</p> 
 <p>--hash=sha256:0c2977473918bdefc6fa8dfb311f154e7f13c6133957fe649704deca79b92093 \</p> 
 <p>--hash=sha256:17b8bdb3b77e03a152ca0d5ca185a7ae0156f5e5a2dbddf538676633a1f7380f \</p> 
 <p>--hash=sha256:29d07681a78042cdd15b268ae9decffed9ace68a53eebeb61d65ae931d158841 \</p> 
 <p>--hash=sha256:36fb1b35d1150267cb0543a1ddd950c0bc2c75ed0e6e92e3aaa6ac2e29416cb7 \</p> 
 <p>--hash=sha256:3aed60c2bb5e812bbf9295c70f25b17ac37c233f30447a96c67913ba5073642f \</p> 
 <p>--hash=sha256:3cac1565cc768911e72ca9ec4ddf5c5109e1fef0104f19f06649cf1874943b60 \</p> 
 <p>--hash=sha256:3d4bc0cc4a37c3cd3081063142eeb2125511db3c13f6dc932d899c512690378e \</p> 
 <p>--hash=sha256:3f73096f27b8c28be53ffb6604f7b570fbbb82f273c6febe5f58119009b59898 \</p> 
 <p>--hash=sha256:522d1153d93f2d48aa0bd9fb778d8d4500be2e4dcf86c3150768f0e3adbbc4ef \</p> 
 <p>--hash=sha256:523d2928fb7377bbdbc9af9c0b14ad73e6eaf226349f105733bdae27efd15b5a \</p> 
 <p>--hash=sha256:5848309d4fc5c02150a45e8f8d2227e5bfda386a508bbd3160fed7c633c5a2fa \</p> 
 <p>--hash=sha256:6781f86e6d54a110980a76e761eb54590630fd2af2a17d7edf02a079d2646c1d \</p> 
 <p>--hash=sha256:6fd27921ebf3aaa945fa25d790f1f2046204f24dba4946f82f5f0a442577c3e9 \</p> 
 <p>--hash=sha256:70d581862863f6bf9e175e85c9d70c2d7155f53fb04dcdb2f73cf288ca559a53 \</p> 
 <p>--hash=sha256:81867c23b0dc66c8366f351d00923f2bc5902820a24c2534dfd7bf01a5879963 \</p> 
 <p>--hash=sha256:81db29edadcbb740cd2716c95a297893a546ed89db1bfe9110168732d7f0afdd \</p> 
 <p>--hash=sha256:86bd12624068cea60860a0759af5e2c3adc89c12aef6f71cf12f577e28deefe3 \</p> 
 <p>--hash=sha256:9c184d8f9f7a76e1ced99855ccf390ffdd0ec3765e5cbf7b9cada600accc0a1e \</p> 
 <p>--hash=sha256:acc789e8c29c13555e43fe4bf9fcd15a65512c9645e97bbaa5602e3201252b02 \</p> 
 <p>--hash=sha256:afaa740206b7660d4cc3b8f120426c85761f51379af7a5b05451f624ad12b0af \</p> 
 <p>--hash=sha256:b5f5fa323f878bb16eae68ea1ba7f6c0419d4695d0248bed4b18f51d7ce5ab85 \</p> 
 <p>--hash=sha256:bd89e0e2c67bf4ac3aca2a19702b1a37269fb1923827f68324ac2e7afd6e3406 \</p> 
 <p>--hash=sha256:c212de743283ec0735db24ec6ad913758df3af1b7217550ff270038062afd6ae \</p> 
 <p>--hash=sha256:ca553f524293a0bdea05e7f44c3e685e4b7b022cb37d87bc4a3efa0f86587a8d \</p> 
 <p>--hash=sha256:cab67065a3db92f636128d3157cc5424a145f82d96fb47159c539132833a6d36 \</p> 
 <p>--hash=sha256:d3b3b3eedfdbf6b02898216e85aa6baf50207f4378a2a6803d6d47650cd37031 \</p> 
 <p>--hash=sha256:d9f4a5a72f40256b686d31c5c0b1fde503172307beb12c1568296e76118e402c \</p> 
 <p>--hash=sha256:df5067d87aaa111ed5d050e1ee853ba284969497f91806efd42425f5348f1c06 \</p> 
 <p>--hash=sha256:e2587644812c6138f05b8a41594a8337c6790e3baf9a01915e52438c13fc6bef \</p> 
 <p>--hash=sha256:e27fd877662db94f897f3fd532ef211ca4901eb1a70ba456f15c0866a985464a \</p> 
 <p>--hash=sha256:e427ebbdd223c72e06ba94c004bb04e996c84dec8a0fa84e837556ae145c439e \</p> 
 <p>--hash=sha256:e583ad4309c203ef75a09d43434cf9c2b4fa247997ecb0dcad769982c39411c7 \</p> 
 <p>--hash=sha256:e760b2bc8ece9200804f0c2b64d10147ecaf18455a2a90827fbec4c9d84f3ad5 \</p> 
 <p>--hash=sha256:ea9a9cc8bcc70e18023f30fa2f53d11ae069572a162791224e60cd65df55fb69 \</p> 
 <p>--hash=sha256:ecb3f17dce4803c1099bd21742cd126b59817a4e76a6544d31d2cca6e30dbffd \</p> 
 <p>--hash=sha256:ed794e3b3de42486d30444fb60b5561e724ee8a2d1b17b0c2e0f81e3ddaf7a87 \</p> 
 <p>--hash=sha256:ee885d347279e38226d0a437b6a932f207f691c502ee565aba27a7022f1285df \</p> 
 <p>--hash=sha256:fd5e7bc5f24f7e3d490698f7b854659a9851da2187414617cd5ed360af7efd63 \</p> 
 <p>--hash=sha256:fe45f6870f7588ac7b2763ff1ce98cce59369717afe70cc353ec5218bc854bcc</p> 
 <p>zope.interface==5.1.0 \</p> 
 <p>--hash=sha256:0103cba5ed09f27d2e3de7e48bb320338592e2fabc5ce1432cf33808eb2dfd8b \</p> 
 <p>--hash=sha256:14415d6979356629f1c386c8c4249b4d0082f2ea7f75871ebad2e29584bd16c5 \</p> 
 <p>--hash=sha256:1ae4693ccee94c6e0c88a4568fb3b34af8871c60f5ba30cf9f94977ed0e53ddd \</p> 
 <p>--hash=sha256:1b87ed2dc05cb835138f6a6e3595593fea3564d712cb2eb2de963a41fd35758c \</p> 
 <p>--hash=sha256:269b27f60bcf45438e8683269f8ecd1235fa13e5411de93dae3b9ee4fe7f7bc7 \</p> 
 <p>--hash=sha256:27d287e61639d692563d9dab76bafe071fbeb26818dd6a32a0022f3f7ca884b5 \</p> 
 <p>--hash=sha256:39106649c3082972106f930766ae23d1464a73b7d30b3698c986f74bf1256a34 \</p> 
 <p>--hash=sha256:40e4c42bd27ed3c11b2c983fecfb03356fae1209de10686d03c02c8696a1d90e \</p> 
 <p>--hash=sha256:461d4339b3b8f3335d7e2c90ce335eb275488c587b61aca4b305196dde2ff086 \</p> 
 <p>--hash=sha256:4f98f70328bc788c86a6a1a8a14b0ea979f81ae6015dd6c72978f1feff70ecda \</p> 
 <p>--hash=sha256:558a20a0845d1a5dc6ff87cd0f63d7dac982d7c3be05d2ffb6322a87c17fa286 \</p> 
 <p>--hash=sha256:562dccd37acec149458c1791da459f130c6cf8902c94c93b8d47c6337b9fb826 \</p> 
 <p>--hash=sha256:5e86c66a6dea8ab6152e83b0facc856dc4d435fe0f872f01d66ce0a2131b7f1d \</p> 
 <p>--hash=sha256:60a207efcd8c11d6bbeb7862e33418fba4e4ad79846d88d160d7231fcb42a5ee \</p> 
 <p>--hash=sha256:645a7092b77fdbc3f68d3cc98f9d3e71510e419f54019d6e282328c0dd140dcd \</p> 
 <p>--hash=sha256:6874367586c020705a44eecdad5d6b587c64b892e34305bb6ed87c9bbe22a5e9 \</p> 
 <p>--hash=sha256:74bf0a4f9091131de09286f9a605db449840e313753949fe07c8d0fe7659ad1e \</p> 
 <p>--hash=sha256:7b726194f938791a6691c7592c8b9e805fc6d1b9632a833b9c0640828cd49cbc \</p> 
 <p>--hash=sha256:8149ded7f90154fdc1a40e0c8975df58041a6f693b8f7edcd9348484e9dc17fe \</p> 
 <p>--hash=sha256:8cccf7057c7d19064a9e27660f5aec4e5c4001ffcf653a47531bde19b5aa2a8a \</p> 
 <p>--hash=sha256:911714b08b63d155f9c948da2b5534b223a1a4fc50bb67139ab68b277c938578 \</p> 
 <p>--hash=sha256:a5f8f85986197d1dd6444763c4a15c991bfed86d835a1f6f7d476f7198d5f56a \</p> 
 <p>--hash=sha256:a744132d0abaa854d1aad50ba9bc64e79c6f835b3e92521db4235a1991176813 \</p> 
 <p>--hash=sha256:af2c14efc0bb0e91af63d00080ccc067866fb8cbbaca2b0438ab4105f5e0f08d \</p> 
 <p>--hash=sha256:b054eb0a8aa712c8e9030065a59b5e6a5cf0746ecdb5f087cca5ec7685690c19 \</p> 
 <p>--hash=sha256:b0becb75418f8a130e9d465e718316cd17c7a8acce6fe8fe07adc72762bee425 \</p> 
 <p>--hash=sha256:b1d2ed1cbda2ae107283befd9284e650d840f8f7568cb9060b5466d25dc48975 \</p> 
 <p>--hash=sha256:ba4261c8ad00b49d48bbb3b5af388bb7576edfc0ca50a49c11dcb77caa1d897e \</p> 
 <p>--hash=sha256:d1fe9d7d09bb07228650903d6a9dc48ea649e3b8c69b1d263419cc722b3938e8 \</p> 
 <p>--hash=sha256:d7804f6a71fc2dda888ef2de266727ec2f3915373d5a785ed4ddc603bbc91e08 \</p> 
 <p>--hash=sha256:da2844fba024dd58eaa712561da47dcd1e7ad544a257482392472eae1c86d5e5 \</p> 
 <p>--hash=sha256:dcefc97d1daf8d55199420e9162ab584ed0893a109f45e438b9794ced44c9fd0 \</p> 
 <p>--hash=sha256:dd98c436a1fc56f48c70882cc243df89ad036210d871c7427dc164b31500dc11 \</p> 
 <p>--hash=sha256:e74671e43ed4569fbd7989e5eecc7d06dc134b571872ab1d5a88f4a123814e9f \</p> 
 <p>--hash=sha256:eb9b92f456ff3ec746cd4935b73c1117538d6124b8617bc0fe6fda0b3816e345 \</p> 
 <p>--hash=sha256:ebb4e637a1fb861c34e48a00d03cffa9234f42bef923aec44e5625ffb9a8e8f9 \</p> 
 <p>--hash=sha256:ef739fe89e7f43fb6494a43b1878a36273e5924869ba1d866f752c5812ae8d58 \</p> 
 <p>--hash=sha256:f40db0e02a8157d2b90857c24d89b6310f9b6c3642369852cdc3b5ac49b92afc \</p> 
 <p>--hash=sha256:f68bf937f113b88c866d090fea0bc52a098695173fc613b055a17ff0cf9683b6 \</p> 
 <p>--hash=sha256:fb55c182a3f7b84c1a2d6de5fa7b1a05d4660d866b91dbf8d74549c57a1499e8</p> 
 <p>zope.proxy==4.3.5 \</p> 
 <p>--hash=sha256:00573dfa755d0703ab84bb23cb6ecf97bb683c34b340d4df76651f97b0bab068 \</p> 
 <p>--hash=sha256:092049280f2848d2ba1b57b71fe04881762a220a97b65288bcb0968bb199ec30 \</p> 
 <p>--hash=sha256:0cbd27b4d3718b5ec74fc65ffa53c78d34c65c6fd9411b8352d2a4f855220cf1 \</p> 
 <p>--hash=sha256:17fc7e16d0c81f833a138818a30f366696653d521febc8e892858041c4d88785 \</p> 
 <p>--hash=sha256:19577dfeb70e8a67249ba92c8ad20589a1a2d86a8d693647fa8385408a4c17b0 \</p> 
 <p>--hash=sha256:207aa914576b1181597a1516e1b90599dc690c095343ae281b0772e44945e6a4 \</p> 
 <p>--hash=sha256:219a7db5ed53e523eb4a4769f13105118b6d5b04ed169a283c9775af221e231f \</p> 
 <p>--hash=sha256:2b50ea79849e46b5f4f2b0247a3687505d32d161eeb16a75f6f7e6cd81936e43 \</p> 
 <p>--hash=sha256:5903d38362b6c716e66bbe470f190579c530a5baf03dbc8500e5c2357aa569a5 \</p> 
 <p>--hash=sha256:5c24903675e271bd688c6e9e7df5775ac6b168feb87dbe0e4bcc90805f21b28f \</p> 
 <p>--hash=sha256:5ef6bc5ed98139e084f4e91100f2b098a0cd3493d4e76f9d6b3f7b95d7ad0f06 \</p> 
 <p>--hash=sha256:61b55ae3c23a126a788b33ffb18f37d6668e79a05e756588d9e4d4be7246ab1c \</p> 
 <p>--hash=sha256:63ddb992931a5e616c87d3d89f5a58db086e617548005c7f9059fac68c03a5cc \</p> 
 <p>--hash=sha256:6943da9c09870490dcfd50c4909c0cc19f434fa6948f61282dc9cb07bcf08160 \</p> 
 <p>--hash=sha256:6ad40f85c1207803d581d5d75e9ea25327cd524925699a83dfc03bf8e4ba72b7 \</p> 
 <p>--hash=sha256:6b44433a79bdd7af0e3337bd7bbcf53dd1f9b0fa66bf21bcb756060ce32a96c1 \</p> 
 <p>--hash=sha256:6bbaa245015d933a4172395baad7874373f162955d73612f0b66b6c2c33b6366 \</p> 
 <p>--hash=sha256:7007227f4ea85b40a2f5e5a244479f6a6dfcf906db9b55e812a814a8f0e2c28d \</p> 
 <p>--hash=sha256:74884a0aec1f1609190ec8b34b5d58fb3b5353cf22b96161e13e0e835f13518f \</p> 
 <p>--hash=sha256:7d25fe5571ddb16369054f54cdd883f23de9941476d97f2b92eb6d7d83afe22d \</p> 
 <p>--hash=sha256:7e162bdc5e3baad26b2262240be7d2bab36991d85a6a556e48b9dfb402370261 \</p> 
 <p>--hash=sha256:814d62678dc3a30f4aa081982d830b7c342cf230ffc9d030b020cb154eeebf9e \</p> 
 <p>--hash=sha256:8878a34c5313ee52e20aa50b03138af8d472bae465710fb954d133a9bfd3c38d \</p> 
 <p>--hash=sha256:a66a0d94e5b081d5d695e66d6667e91e74d79e273eee95c1747717ba9cb70792 \</p> 
 <p>--hash=sha256:a69f5cbf4addcfdf03dda564a671040127a6b7c34cf9fe4973582e68441b63fa \</p> 
 <p>--hash=sha256:b00f9f0c334d07709d3f73a7cb8ae63c6ca1a90c790a63b5e7effa666ef96021 \</p> 
 <p>--hash=sha256:b6ed71e4a7b4690447b626f499d978aa13197a0e592950e5d7020308f6054698 \</p> 
 <p>--hash=sha256:bdf5041e5851526e885af579d2f455348dba68d74f14a32781933569a327fddf \</p> 
 <p>--hash=sha256:be034360dd34e62608419f86e799c97d389c10a0e677a25f236a971b2f40dac9 \</p> 
 <p>--hash=sha256:cc8f590a5eed30b314ae6b0232d925519ade433f663de79cc3783e4b10d662ba \</p> 
 <p>--hash=sha256:cd7a318a15fe6cc4584bf3c4426f092ed08c0fd012cf2a9173114234fe193e11 \</p> 
 <p>--hash=sha256:cf19b5f63a59c20306e034e691402b02055c8f4e38bf6792c23cad489162a642 \</p> 
 <p>--hash=sha256:cfc781ce442ec407c841e9aa51d0e1024f72b6ec34caa8fdb6ef9576d549acf2 \</p> 
 <p>--hash=sha256:dea9f6f8633571e18bc20cad83603072e697103a567f4b0738d52dd0211b4527 \</p> 
 <p>--hash=sha256:e4a86a1d5eb2cce83c5972b3930c7c1eac81ab3508464345e2b8e54f119d5505 \</p> 
 <p>--hash=sha256:e7106374d4a74ed9ff00c46cc00f0a9f06a0775f8868e423f85d4464d2333679 \</p> 
 <p>--hash=sha256:e98a8a585b5668aa9e34d10f7785abf9545fe72663b4bfc16c99a115185ae6a5 \</p> 
 <p>--hash=sha256:f64840e68483316eb58d82c376ad3585ca995e69e33b230436de0cdddf7363f9 \</p> 
 <p>--hash=sha256:f8f4b0a9e6683e43889852130595c8854d8ae237f2324a053cdd884de936aa9b \</p> 
 <p>--hash=sha256:fc45a53219ed30a7f670a6d8c98527af0020e6fd4ee4c0a8fb59f147f06d816c</p> 
 <p># Contains the requirements for the letsencrypt package.</p> 
 <p>#</p> 
 <p># Since the letsencrypt package depends on certbot and using pip with hashes</p> 
 <p># requires that all installed packages have hashes listed, this allows</p> 
 <p># dependency-requirements.txt to be used without requiring a hash for a</p> 
 <p># (potentially unreleased) Certbot package.</p> 
 <p>letsencrypt==0.7.0 \</p> 
 <p>--hash=sha256:105a5fb107e45bcd0722eb89696986dcf5f08a86a321d6aef25a0c7c63375ade \</p> 
 <p>--hash=sha256:c36e532c486a7e92155ee09da54b436a3c420813ec1c590b98f635d924720de9</p> 
 <p>certbot==1.7.0 \</p> 
 <p>--hash=sha256:84877127caf779c212d131d36399a45a8e13e06274e7a5e029845df5c84cd974 \</p> 
 <p>--hash=sha256:10b95bb86fb8f1dbbd27558bb42454d5995cbdb45d6c00d961ebba2a4bdc4355</p> 
 <p>acme==1.7.0 \</p> 
 <p>--hash=sha256:ef0e84d670f59c096e9ed8c3bf9e6a7d22ee378fdb4175503c06cc485672c79a \</p> 
 <p>--hash=sha256:288d9bbb075278961d224e43f7f386c491d25366a98ed89a62771c5022978386</p> 
 <p>certbot-apache==1.7.0 \</p> 
 <p>--hash=sha256:514c09a892964332c2485a38bd5720e4cf93e35998341af36eef5401ab165d89 \</p> 
 <p>--hash=sha256:99943b6406e0315f31c1f81e2ced6be38aee3ea24974ef4d7aeeda8202c1c3bc</p> 
 <p>certbot-nginx==1.7.0 \</p> 
 <p>--hash=sha256:fea2387c92155635fbddb02758d5ba73f0d7af459959f91be0a1606fd2e43c55 \</p> 
 <p>--hash=sha256:d52ec3e711884100636c42b639d8959378562ea78183a273d120df808de2724f</p> 
 <p>UNLIKELY_EOF</p> 
 <p># -------------------------------------------------------------------------</p> 
 <p>cat &lt;&lt; "UNLIKELY_EOF" &gt; "$TEMP_DIR/pipstrap.py"</p> 
 <p>#!/usr/bin/env python</p> 
 <p>"""A small script that can act as a trust root for installing pip &gt;=8</p> 
 <p>Embed this in your project, and your VCS checkout is all you have to trust. In</p> 
 <p>a post-peep era, this lets you claw your way to a hash-checking version of pip,</p> 
 <p>with which you can install the rest of your dependencies safely. All it assumes</p> 
 <p>is Python 2.6 or better and *some* version of pip already installed. If</p> 
 <p>anything goes wrong, it will exit with a non-zero status code.</p> 
 <p>"""</p> 
 <p># This is here so embedded copies are MIT-compliant:</p> 
 <p># Copyright (c) 2016 Erik Rose</p> 
 <p>#</p> 
 <p># Permission is hereby granted, free of charge, to any person obtaining a copy</p> 
 <p># of this software and associated documentation files (the "Software"), to</p> 
 <p># deal in the Software without restriction, including without limitation the</p> 
 <p># rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</p> 
 <p># sell copies of the Software, and to permit persons to whom the Software is</p> 
 <p># furnished to do so, subject to the following conditions:</p> 
 <p>#</p> 
 <p># The above copyright notice and this permission notice shall be included in</p> 
 <p># all copies or substantial portions of the Software.</p> 
 <p>from __future__ import print_function</p> 
 <p>from distutils.version import StrictVersion</p> 
 <p>from hashlib import sha256</p> 
 <p>from os import environ</p> 
 <p>from os.path import join</p> 
 <p>from shutil import rmtree</p> 
 <p>try:</p> 
 <p>from subprocess import check_output</p> 
 <p>except ImportError:</p> 
 <p>from subprocess import CalledProcessError, PIPE, Popen</p> 
 <p>def check_output(*popenargs, **kwargs):</p> 
 <p>if 'stdout' in kwargs:</p> 
 <p>raise ValueError('stdout argument not allowed, it will be '</p> 
 <p>'overridden.')</p> 
 <p>process = Popen(stdout=PIPE, *popenargs, **kwargs)</p> 
 <p>output, unused_err = process.communicate()</p> 
 <p>retcode = process.poll()</p> 
 <p>if retcode:</p> 
 <p>cmd = kwargs.get("args")</p> 
 <p>if cmd is None:</p> 
 <p>cmd = popenargs[0]</p> 
 <p>raise CalledProcessError(retcode, cmd)</p> 
 <p>return output</p> 
 <p>import sys</p> 
 <p>from tempfile import mkdtemp</p> 
 <p>try:</p> 
 <p>from urllib2 import build_opener, HTTPHandler, HTTPSHandler</p> 
 <p>except ImportError:</p> 
 <p>from urllib.request import build_opener, HTTPHandler, HTTPSHandler</p> 
 <p>try:</p> 
 <p>from urlparse import urlparse</p> 
 <p>except ImportError:</p> 
 <p>from urllib.parse import urlparse # 3.4</p> 
 <p>__version__ = 1, 5, 1</p> 
 <p>PIP_VERSION = '9.0.1'</p> 
 <p>DEFAULT_INDEX_BASE = 'https://pypi.python.org'</p> 
 <p># wheel has a conditional dependency on argparse:</p> 
 <p>maybe_argparse = (</p> 
 <p>[('18/dd/e617cfc3f6210ae183374cd9f6a26b20514bbb5a792af97949c5aacddf0f/'</p> 
 <p>'argparse-1.4.0.tar.gz',</p> 
 <p>'62b089a55be1d8949cd2bc7e0df0bddb9e028faefc8c32038cc84862aefdd6e4')]</p> 
 <p>if sys.version_info &lt; (2, 7, 0) else [])</p> 
 <p>PACKAGES = maybe_argparse + [</p> 
 <p># Pip has no dependencies, as it vendors everything:</p> 
 <p>('11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/'</p> 
 <p>'pip-{0}.tar.gz'.format(PIP_VERSION),</p> 
 <p>'09f243e1a7b461f654c26a725fa373211bb7ff17a9300058b205c61658ca940d'),</p> 
 <p># This version of setuptools has only optional dependencies:</p> 
 <p>('37/1b/b25507861991beeade31473868463dad0e58b1978c209de27384ae541b0b/'</p> 
 <p>'setuptools-40.6.3.zip',</p> 
 <p>'3b474dad69c49f0d2d86696b68105f3a6f195f7ab655af12ef9a9c326d2b08f8'),</p> 
 <p>('c9/1d/bd19e691fd4cfe908c76c429fe6e4436c9e83583c4414b54f6c85471954a/'</p> 
 <p>'wheel-0.29.0.tar.gz',</p> 
 <p>'1ebb8ad7e26b448e9caa4773d2357849bf80ff9e313964bcaf79cbf0201a1648')</p> 
 <p>]</p> 
 <p>class HashError(Exception):</p> 
 <p>def __str__(self):</p> 
 <p>url, path, actual, expected = self.args</p> 
 <p>return ('{url} did not match the expected hash {expected}. Instead, '</p> 
 <p>'it was {actual}. The file (left at {path}) may have been '</p> 
 <p>'tampered with.'.format(**locals()))</p> 
 <p>def hashed_download(url, temp, digest):</p> 
 <p>"""Download ``url`` to ``temp``, make sure it has the SHA-256 ``digest``,</p> 
 <p>and return its path."""</p> 
 <p># Based on pip 1.4.1's URLOpener but with cert verification removed. Python</p> 
 <p># &gt;=2.7.9 verifies HTTPS certs itself, and, in any case, the cert</p> 
 <p># authenticity has only privacy (not arbitrary code execution)</p> 
 <p># implications, since we're checking hashes.</p> 
 <p>def opener(using_https=True):</p> 
 <p>opener = build_opener(HTTPSHandler())</p> 
 <p>if using_https:</p> 
 <p># Strip out HTTPHandler to prevent MITM spoof:</p> 
 <p>for handler in opener.handlers:</p> 
 <p>if isinstance(handler, HTTPHandler):</p> 
 <p>opener.handlers.remove(handler)</p> 
 <p>return opener</p> 
 <p>def read_chunks(response, chunk_size):</p> 
 <p>while True:</p> 
 <p>chunk = response.read(chunk_size)</p> 
 <p>if not chunk:</p> 
 <p>break</p> 
 <p>yield chunk</p> 
 <p>parsed_url = urlparse(url)</p> 
 <p>response = opener(using_https=parsed_url.scheme == 'https').open(url)</p> 
 <p>path = join(temp, parsed_url.path.split('/')[-1])</p> 
 <p>actual_hash = sha256()</p> 
 <p>with open(path, 'wb') as file:</p> 
 <p>for chunk in read_chunks(response, 4096):</p> 
 <p>file.write(chunk)</p> 
 <p>actual_hash.update(chunk)</p> 
 <p>actual_digest = actual_hash.hexdigest()</p> 
 <p>if actual_digest != digest:</p> 
 <p>raise HashError(url, path, actual_digest, digest)</p> 
 <p>return path</p> 
 <p>def get_index_base():</p> 
 <p>"""Return the URL to the dir containing the "packages" folder.</p> 
 <p>Try to wring something out of PIP_INDEX_URL, if set. Hack "/simple" off the</p> 
 <p>end if it's there; that is likely to give us the right dir.</p> 
 <p>"""</p> 
 <p>env_var = environ.get('PIP_INDEX_URL', '').rstrip('/')</p> 
 <p>if env_var:</p> 
 <p>SIMPLE = '/simple'</p> 
 <p>if env_var.endswith(SIMPLE):</p> 
 <p>return env_var[:-len(SIMPLE)]</p> 
 <p>else:</p> 
 <p>return env_var</p> 
 <p>else:</p> 
 <p>return DEFAULT_INDEX_BASE</p> 
 <p>def main():</p> 
 <p>python = sys.executable or 'python'</p> 
 <p>pip_version = StrictVersion(check_output([python, '-m', 'pip', '--version'])</p> 
 <p>.decode('utf-8').split()[1])</p> 
 <p>has_pip_cache = pip_version &gt;= StrictVersion('6.0')</p> 
 <p>index_base = get_index_base()</p> 
 <p>temp = mkdtemp(prefix='pipstrap-')</p> 
 <p>try:</p> 
 <p>downloads = [hashed_download(index_base + '/packages/' + path,</p> 
 <p>temp,</p> 
 <p>digest)</p> 
 <p>for path, digest in PACKAGES]</p> 
 <p># Calling pip as a module is the preferred way to avoid problems about pip self-upgrade.</p> 
 <p>command = [python, '-m', 'pip', 'install', '--no-index', '--no-deps', '-U']</p> 
 <p># Disable cache since it is not used and it otherwise sometimes throws permission warnings:</p> 
 <p>command.extend(['--no-cache-dir'] if has_pip_cache else [])</p> 
 <p>command.extend(downloads)</p> 
 <p>check_output(command)</p> 
 <p>except HashError as exc:</p> 
 <p>print(exc)</p> 
 <p>except Exception:</p> 
 <p>rmtree(temp)</p> 
 <p>raise</p> 
 <p>else:</p> 
 <p>rmtree(temp)</p> 
 <p>return 0</p> 
 <p>return 1</p> 
 <p>if __name__ == '__main__':</p> 
 <p>sys.exit(main())</p> 
 <p>UNLIKELY_EOF</p> 
 <p># -------------------------------------------------------------------------</p> 
 <p># Set PATH so pipstrap upgrades the right (v)env:</p> 
 <p>PATH="$VENV_BIN:$PATH" "$VENV_BIN/python" "$TEMP_DIR/pipstrap.py"</p> 
 <p>set +e</p> 
 <p>if [ "$VERBOSE" = 1 ]; then</p> 
 <p>"$VENV_BIN/pip" install --disable-pip-version-check --no-cache-dir --require-hashes -r "$TEMP_DIR/letsencrypt-auto-requirements.txt"</p> 
 <p>else</p> 
 <p>PIP_OUT=`"$VENV_BIN/pip" install --disable-pip-version-check --no-cache-dir --require-hashes -r "$TEMP_DIR/letsencrypt-auto-requirements.txt" 2&gt;&amp;1`</p> 
 <p>fi</p> 
 <p>PIP_STATUS=$?</p> 
 <p>set -e</p> 
 <p>if [ "$PIP_STATUS" != 0 ]; then</p> 
 <p># Report error. (Otherwise, be quiet.)</p> 
 <p>error "Had a problem while installing Python packages."</p> 
 <p>if [ "$VERBOSE" != 1 ]; then</p> 
 <p>error</p> 
 <p>error "pip prints the following errors: "</p> 
 <p>error "====================================================="</p> 
 <p>error "$PIP_OUT"</p> 
 <p>error "====================================================="</p> 
 <p>error</p> 
 <p>error "Certbot has problem setting up the virtual environment."</p> 
 <p>if `echo $PIP_OUT | grep -q Killed` || `echo $PIP_OUT | grep -q "allocate memory"` ; then</p> 
 <p>error</p> 
 <p>error "Based on your pip output, the problem can likely be fixed by "</p> 
 <p>error "increasing the available memory."</p> 
 <p>else</p> 
 <p>error</p> 
 <p>error "We were not be able to guess the right solution from your pip "</p> 
 <p>error "output."</p> 
 <p>fi</p> 
 <p>error</p> 
 <p>error "Consult https://certbot.eff.org/docs/install.html#problems-with-python-virtual-environment"</p> 
 <p>error "for possible solutions."</p> 
 <p>error "You may also find some support resources at https://certbot.eff.org/support/ ."</p> 
 <p>fi</p> 
 <p>rm -rf "$VENV_PATH"</p> 
 <p>exit 1</p> 
 <p>fi</p> 
 <p>if [ -d "$OLD_VENV_PATH" -a ! -L "$OLD_VENV_PATH" ]; then</p> 
 <p>rm -rf "$OLD_VENV_PATH"</p> 
 <p>ln -s "$VENV_PATH" "$OLD_VENV_PATH"</p> 
 <p>fi</p> 
 <p>say "Installation succeeded."</p> 
 <p>fi</p> 
 <p># If you're modifying any of the code after this point in this current `if` block, you</p> 
 <p># may need to update the "$DEPRECATED_OS" = 1 case at the beginning of phase 2 as well.</p> 
 <p>if [ "$INSTALL_ONLY" = 1 ]; then</p> 
 <p>say "Certbot is installed."</p> 
 <p>exit 0</p> 
 <p>fi</p> 
 <p>"$VENV_BIN/letsencrypt" "$@"</p> 
 <p>else</p> 
 <p># Phase 1: Upgrade certbot-auto if necessary, then self-invoke.</p> 
 <p>#</p> 
 <p># Each phase checks the version of only the thing it is responsible for</p> 
 <p># upgrading. Phase 1 checks the version of the latest release of</p> 
 <p># certbot-auto (which is always the same as that of the certbot</p> 
 <p># package). Phase 2 checks the version of the locally installed certbot.</p> 
 <p>export PHASE_1_VERSION="$LE_AUTO_VERSION"</p> 
 <p>if [ ! -f "$VENV_BIN/letsencrypt" ]; then</p> 
 <p>if ! OldVenvExists; then</p> 
 <p>if [ "$HELP" = 1 ]; then</p> 
 <p>echo "$USAGE"</p> 
 <p>exit 0</p> 
 <p>fi</p> 
 <p># If it looks like we've never bootstrapped before, bootstrap:</p> 
 <p>Bootstrap</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>if [ "$OS_PACKAGES_ONLY" = 1 ]; then</p> 
 <p>say "OS packages installed."</p> 
 <p>exit 0</p> 
 <p>fi</p> 
 <p>DeterminePythonVersion "NOCRASH"</p> 
 <p># Don't warn about file permissions if the user disabled the check or we</p> 
 <p># can't find an up-to-date Python.</p> 
 <p>if [ "$PYVER" -ge "$MIN_PYVER" -a "$NO_PERMISSIONS_CHECK" != 1 ]; then</p> 
 <p># If the script fails for some reason, don't break certbot-auto.</p> 
 <p>set +e</p> 
 <p># Suppress unexpected error output.</p> 
 <p>CHECK_PERM_OUT=$(CheckPathPermissions "$LE_PYTHON" "$0" 2&gt;/dev/null)</p> 
 <p>CHECK_PERM_STATUS="$?"</p> 
 <p>set -e</p> 
 <p># Only print output if the script ran successfully and it actually produced</p> 
 <p># output. The latter check resolves</p> 
 <p># https://github.com/certbot/certbot/issues/7012.</p> 
 <p>if [ "$CHECK_PERM_STATUS" = 0 -a -n "$CHECK_PERM_OUT" ]; then</p> 
 <p>error "$CHECK_PERM_OUT"</p> 
 <p>fi</p> 
 <p>fi</p> 
 <p>if [ "$NO_SELF_UPGRADE" != 1 ]; then</p> 
 <p>TEMP_DIR=$(TempDir)</p> 
 <p>trap 'rm -rf "$TEMP_DIR"' EXIT</p> 
 <p># ---------------------------------------------------------------------------</p> 
 <p>cat &lt;&lt; "UNLIKELY_EOF" &gt; "$TEMP_DIR/fetch.py"</p> 
 <p>"""Do downloading and JSON parsing without additional dependencies. ::</p> 
 <p># Print latest released version of LE to stdout:</p> 
 <p>python fetch.py --latest-version</p> 
 <p># Download letsencrypt-auto script from git tag v1.2.3 into the folder I'm</p> 
 <p># in, and make sure its signature verifies:</p> 
 <p>python fetch.py --le-auto-script v1.2.3</p> 
 <p>On failure, return non-zero.</p> 
 <p>"""</p> 
 <p>from __future__ import print_function, unicode_literals</p> 
 <p>from distutils.version import LooseVersion</p> 
 <p>from json import loads</p> 
 <p>from os import devnull, environ</p> 
 <p>from os.path import dirname, join</p> 
 <p>import re</p> 
 <p>import ssl</p> 
 <p>from subprocess import check_call, CalledProcessError</p> 
 <p>from sys import argv, exit</p> 
 <p>try:</p> 
 <p>from urllib2 import build_opener, HTTPHandler, HTTPSHandler</p> 
 <p>from urllib2 import HTTPError, URLError</p> 
 <p>except ImportError:</p> 
 <p>from urllib.request import build_opener, HTTPHandler, HTTPSHandler</p> 
 <p>from urllib.error import HTTPError, URLError</p> 
 <p>PUBLIC_KEY = environ.get('LE_AUTO_PUBLIC_KEY', """-----BEGIN PUBLIC KEY-----</p> 
 <p>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA6MR8W/galdxnpGqBsYbq</p> 
 <p>OzQb2eyW15YFjDDEMI0ZOzt8f504obNs920lDnpPD2/KqgsfjOgw2K7xWDJIj/18</p> 
 <p>xUvWPk3LDkrnokNiRkA3KOx3W6fHycKL+zID7zy+xZYBuh2fLyQtWV1VGQ45iNRp</p> 
 <p>9+Zo7rH86cdfgkdnWTlNSHyTLW9NbXvyv/E12bppPcEvgCTAQXgnDVJ0/sqmeiij</p> 
 <p>n9tTFh03aM+R2V/21h8aTraAS24qiPCz6gkmYGC8yr6mglcnNoYbsLNYZ69zF1XH</p> 
 <p>cXPduCPdPdfLlzVlKK1/U7hkA28eG3BIAMh6uJYBRJTpiGgaGdPd7YekUB8S6cy+</p> 
 <p>CQIDAQAB</p> 
 <p>-----END PUBLIC KEY-----</p> 
 <p>""")</p> 
 <p>class ExpectedError(Exception):</p> 
 <p>"""A novice-readable exception that also carries the original exception for</p> 
 <p>debugging"""</p> 
 <p>class HttpsGetter(object):</p> 
 <p>def __init__(self):</p> 
 <p>"""Build an HTTPS opener."""</p> 
 <p># Based on pip 1.4.1's URLOpener</p> 
 <p># This verifies certs on only Python &gt;=2.7.9, and when NO_CERT_VERIFY isn't set.</p> 
 <p>if environ.get('NO_CERT_VERIFY') == '1' and hasattr(ssl, 'SSLContext'):</p> 
 <p>self._opener = build_opener(HTTPSHandler(context=cert_none_context()))</p> 
 <p>else:</p> 
 <p>self._opener = build_opener(HTTPSHandler())</p> 
 <p># Strip out HTTPHandler to prevent MITM spoof:</p> 
 <p>for handler in self._opener.handlers:</p> 
 <p>if isinstance(handler, HTTPHandler):</p> 
 <p>self._opener.handlers.remove(handler)</p> 
 <p>def get(self, url):</p> 
 <p>"""Return the document contents pointed to by an HTTPS URL.</p> 
 <p>If something goes wrong (404, timeout, etc.), raise ExpectedError.</p> 
 <p>"""</p> 
 <p>try:</p> 
 <p># socket module docs say default timeout is None: that is, no</p> 
 <p># timeout</p> 
 <p>return self._opener.open(url, timeout=30).read()</p> 
 <p>except (HTTPError, IOError) as exc:</p> 
 <p>raise ExpectedError("Couldn't download %s." % url, exc)</p> 
 <p>def write(contents, dir, filename):</p> 
 <p>"""Write something to a file in a certain directory."""</p> 
 <p>with open(join(dir, filename), 'wb') as file:</p> 
 <p>file.write(contents)</p> 
 <p>def latest_stable_version(get):</p> 
 <p>"""Return the latest stable release of letsencrypt."""</p> 
 <p>metadata = loads(get(</p> 
 <p>environ.get('LE_AUTO_JSON_URL',</p> 
 <p>'https://pypi.python.org/pypi/certbot/json')).decode('UTF-8'))</p> 
 <p># metadata['info']['version'] actually returns the latest of any kind of</p> 
 <p># release release, contrary to https://wiki.python.org/moin/PyPIJSON.</p> 
 <p># The regex is a sufficient regex for picking out prereleases for most</p> 
 <p># packages, LE included.</p> 
 <p>return str(max(LooseVersion(r) for r</p> 
 <p>in metadata['releases'].keys()</p> 
 <p>if re.match('^[0-9.]+$', r)))</p> 
 <p>def verified_new_le_auto(get, tag, temp_dir):</p> 
 <p>"""Return the path to a verified, up-to-date letsencrypt-auto script.</p> 
 <p>If the download's signature does not verify or something else goes wrong</p> 
 <p>with the verification process, raise ExpectedError.</p> 
 <p>"""</p> 
 <p>le_auto_dir = environ.get(</p> 
 <p>'LE_AUTO_DIR_TEMPLATE',</p> 
 <p>'https://raw.githubusercontent.com/certbot/certbot/%s/'</p> 
 <p>'letsencrypt-auto-source/') % tag</p> 
 <p>write(get(le_auto_dir + 'letsencrypt-auto'), temp_dir, 'letsencrypt-auto')</p> 
 <p>write(get(le_auto_dir + 'letsencrypt-auto.sig'), temp_dir, 'letsencrypt-auto.sig')</p> 
 <p>write(PUBLIC_KEY.encode('UTF-8'), temp_dir, 'public_key.pem')</p> 
 <p>try:</p> 
 <p>with open(devnull, 'w') as dev_null:</p> 
 <p>check_call(['openssl', 'dgst', '-sha256', '-verify',</p> 
 <p>join(temp_dir, 'public_key.pem'),</p> 
 <p>'-signature',</p> 
 <p>join(temp_dir, 'letsencrypt-auto.sig'),</p> 
 <p>join(temp_dir, 'letsencrypt-auto')],</p> 
 <p>stdout=dev_null,</p> 
 <p>stderr=dev_null)</p> 
 <p>except CalledProcessError as exc:</p> 
 <p>raise ExpectedError("Couldn't verify signature of downloaded "</p> 
 <p>"certbot-auto.", exc)</p> 
 <p>def cert_none_context():</p> 
 <p>"""Create a SSLContext object to not check hostname."""</p> 
 <p># PROTOCOL_TLS isn't available before 2.7.13 but this code is for 2.7.9+, so use this.</p> 
 <p>context = ssl.SSLContext(ssl.PROTOCOL_SSLv23)</p> 
 <p>context.verify_mode = ssl.CERT_NONE</p> 
 <p>return context</p> 
 <p>def main():</p> 
 <p>get = HttpsGetter().get</p> 
 <p>flag = argv[1]</p> 
 <p>try:</p> 
 <p>if flag == '--latest-version':</p> 
 <p>print(latest_stable_version(get))</p> 
 <p>elif flag == '--le-auto-script':</p> 
 <p>tag = argv[2]</p> 
 <p>verified_new_le_auto(get, tag, dirname(argv[0]))</p> 
 <p>except ExpectedError as exc:</p> 
 <p>print(exc.args[0], exc.args[1])</p> 
 <p>return 1</p> 
 <p>else:</p> 
 <p>return 0</p> 
 <p>if __name__ == '__main__':</p> 
 <p>exit(main())</p> 
 <p>UNLIKELY_EOF</p> 
 <p># ---------------------------------------------------------------------------</p> 
 <p>if [ "$PYVER" -lt "$MIN_PYVER" ]; then</p> 
 <p>error "WARNING: couldn't find Python $MIN_PYTHON_VERSION+ to check for updates."</p> 
 <p>elif ! REMOTE_VERSION=`"$LE_PYTHON" "$TEMP_DIR/fetch.py" --latest-version` ; then</p> 
 <p>error "WARNING: unable to check for updates."</p> 
 <p>fi</p> 
 <p># If for any reason REMOTE_VERSION is not set, let's assume certbot-auto is up-to-date,</p> 
 <p># and do not go into the self-upgrading process.</p> 
 <p>if [ -n "$REMOTE_VERSION" ]; then</p> 
 <p>LE_VERSION_STATE=`CompareVersions "$LE_PYTHON" "$LE_AUTO_VERSION" "$REMOTE_VERSION"`</p> 
 <p>if [ "$LE_VERSION_STATE" = "UNOFFICIAL" ]; then</p> 
 <p>say "Unofficial certbot-auto version detected, self-upgrade is disabled: $LE_AUTO_VERSION"</p> 
 <p>elif [ "$LE_VERSION_STATE" = "OUTDATED" ]; then</p> 
 <p>say "Upgrading certbot-auto $LE_AUTO_VERSION to $REMOTE_VERSION..."</p> 
 <p># Now we drop into Python so we don't have to install even more</p> 
 <p># dependencies (curl, etc.), for better flow control, and for the option of</p> 
 <p># future Windows compatibility.</p> 
 <p>"$LE_PYTHON" "$TEMP_DIR/fetch.py" --le-auto-script "v$REMOTE_VERSION"</p> 
 <p># Install new copy of certbot-auto.</p> 
 <p># TODO: Deal with quotes in pathnames.</p> 
 <p>say "Replacing certbot-auto..."</p> 
 <p># Clone permissions with cp. chmod and chown don't have a --reference</p> 
 <p># option on macOS or BSD, and stat -c on Linux is stat -f on macOS and BSD:</p> 
 <p>cp -p "$0" "$TEMP_DIR/letsencrypt-auto.permission-clone"</p> 
 <p>cp "$TEMP_DIR/letsencrypt-auto" "$TEMP_DIR/letsencrypt-auto.permission-clone"</p> 
 <p># Using mv rather than cp leaves the old file descriptor pointing to the</p> 
 <p># original copy so the shell can continue to read it unmolested. mv across</p> 
 <p># filesystems is non-atomic, doing `rm dest, cp src dest, rm src`, but the</p> 
 <p># cp is unlikely to fail if the rm doesn't.</p> 
 <p>mv -f "$TEMP_DIR/letsencrypt-auto.permission-clone" "$0"</p> 
 <p>fi # A newer version is available.</p> 
 <p>fi</p> 
 <p>fi # Self-upgrading is allowed.</p> 
 <p>RerunWithArgs --le-auto-phase2 "$@"</p> 
 <p>fi</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8b4f1c011e161743963b7281fb856c27/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">踩坑日记：Unable to process Jar entry [module-info.class]</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ff8dce73bd9617a7b1f92a120dca528b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在VS中使用Boost库出现Macro redefinition错误的解决方法（warning C4005）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>