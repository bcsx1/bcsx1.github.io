<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>计算机网络协议分析全知识点总结兼期末复习重点 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="计算机网络协议分析全知识点总结兼期末复习重点" />
<meta property="og:description" content="计算机网络协议分析知识点总结 第一章 概述数据封装与解封装互联网使用的四种地址 第二章 链路层信道类型与帧类型*以太网（Ethernet II帧格式*，MTU）CSMA/CD与CDMA/CA802.11帧（四个地址）PPP帧/HDLC帧LCP与IPCP的作用PAP认证*CHAP认证*PPPoE技术 第三章 ARP相同局域网与不同局域网的ARP工作原理*ARP请求报文和ARP响应报文（封装）ARP欺骗代理ARP免费ARP* 第3.5章 RIP*RIP报文的封装（使用的端口号，IP地址，MAC地址）*RIP的工作过程*水平分割*触发更新* 第四章 IPIPv4首部格式（首部长度与总长度，TTL,协议，标识，M位，片偏移）首部长度存在的必要性*IP分片考虑含选项（记录路由、源路由）时的分片首部*记录路由选项源路由选项（严格/宽松） IPv6*数据报格式（固定首部40字节，“下一个首部”字段）*6种扩展首部（作用，顺序）源路由扩展首部分片扩展首部8字节*（可分片部分，不可分片部分，分片扩展首部 的格式） 第五章 ICMPICMPv44种差错报告报文（格式及封装，何时产生，由谁产生）*1. 终点不可达ICMP报文2.超时ICMP报文3.参数错误ICMP报文4.重定向ICMP报文 3种请求应答类ICMPv4报文（格式及封装，作用）1.回送请求和应答报文2.时间戳请求和应答报文3.路由器通告和恳求报文 PING命令与ICMPTraceroute命令与ICMP ICMPv6*五种差错报告报文（数据报太大*）数据包太大报文超时报文参数问题报文改变路由报文 3种请求应答类ICMPv4报文（路由询问/通告报文，邻居询问/通告报文）Echo请求/应答报文路由器询问/通告报文邻居询问/通告报文 第六章 UDP熟知端口号UDP首部*UDP检验的两种方案UDP-Lite的检验和及“检验和覆盖”字段的取值*如何判断目标主机的某个UDP端口是否开放* 第七章 TCP理解UDP面向报文、TCP面向字节流标识TCP连接的四元组TCP建立连接*SYN洪泛攻击*TCP端口扫描*发送缓存与接收缓存的作用TCP流量控制（序号、确认号、窗口、死锁现象、糊涂现象）序号与确认号窗口尺寸死锁现象糊涂窗口现象 四个计时器1 超时重传计时器2 坚持计时器3 时间等待计时器4 保活计时器 三种确认机制捎带确认累积确认有丢失的累积确认有重复的累积确认 选择确认 TCP选项选项结束选项无操作选项MSS选项窗口扩大选项时间戳选项允许SACK选项和SACK选项 第八章 SCTPSCTP的特点多宿主TCP头端阻塞与SCTP多重流*TCP头端阻塞SCTP多重流 TCP SYN洪泛攻击与SCTP初始化保护*SCTP分组格式*块类型INIT块INIT ACK块COOKIE ECHO/ACK块建立关联DATA块SACK块数据传输SHUTDOWN关闭关联HEARTBEAT/ACK块ERROR/ABORT块 验证标志的作用TSN,SI,SSN的作用 第九章 DHCP主机的四个网络参数DHCP服务器配置命令DHCP客户端使用68端口的原因租用期DHCP工作过程*DHCP报文及封装*选项及报文类型DHCP中继*（客户与中继、中继与服务器之间的报文交互）获取IPv6地址的方式DHCPv6（端口号，EUI-64）UDP端口号EUI-64转换 第十章 DNS*域名空间域名服务器递归和迭代域名解析顺序资源记录类型（A,AAAA,CNAME,NS,MX,PTR）*A类型CHAME类型NS类型MX类型PTR类型 nslookup命令*DNS报文格式（首部，问题区，回答区）*参数问题区回答区 域名存储*域名压缩*DDNS及应用DNSSec如何防止DNS欺骗* 第十一章 FTP与TFTPFTP控制连接与数据连接*PORT模式与PASV模式的特点*FTP数据连接（PORT模式）FTP数据连接（PASV模式）比较PORT和PASV 协商端口号的过程*NAT对PORT模式的影响*FTP命令与FTP响应的封装*FTP命令FTP响应FTP命令和响应全过程 匿名FTP TFTP基于UDP69可靠传输、流量控制、差错控制 第十二章 HTTP*HTTP请求报文（格式、常用请求方法）*HTTP响应报文（格式、常见状态码）*HTTP认证基本认证摘要认证 常用首部Connection和Keepalive*Host*、Referer*Location*ServerAllowX-Frame-OptionRange和Content-RangeVia和Max-Forwards*追踪HTTP报文请求Via和响应ViaMax-Forwards首部 Expires和Cache-ControlLast-Modified和if-Modified-Since*Etag和If-None-Match*Authentication和WWW-Authentication HTTPS的加密、认证、完整性保护*对称密钥加密技术公开密钥加密技术HTTPS采用混合加密机制报文被篡改HTTP不验证身份 HTTP优化技术（Ajax、Comet、WebSocket）Ajax的解决方法Comet的解决方法WebSocket HTTP2.0的特点二进制分帧请求分优先级首部压缩 第一章 概述 数据封装与解封装 互联网使用的四种地址 特定应用地址：指应用层使用的地址
端口号：本地意义。用来标识主机上运行的应用进程
逻辑地址：互联网中的逻辑地址使用IP地址
物理地址：以太网使用的物理地址是MAC地址
第二章 链路层 信道类型与帧类型* 有线广播信道：Ethernet V2帧/802." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/697565c080b43bed0bc339fef6be5d8f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-01T16:43:16+08:00" />
<meta property="article:modified_time" content="2021-06-01T16:43:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">计算机网络协议分析全知识点总结兼期末复习重点</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>计算机网络协议分析知识点总结</h4> 
 <ul><li><a href="#__4" rel="nofollow">第一章 概述</a></li><li><ul><li><a href="#_5" rel="nofollow">数据封装与解封装</a></li><li><a href="#_7" rel="nofollow">互联网使用的四种地址</a></li></ul> 
  </li><li><a href="#__13" rel="nofollow">第二章 链路层</a></li><li><ul><li><a href="#_14" rel="nofollow">信道类型与帧类型*</a></li><li><a href="#Ethernet_IIMTU_18" rel="nofollow">以太网（Ethernet II帧格式*，MTU）</a></li><li><a href="#CSMACDCDMACA_21" rel="nofollow">CSMA/CD与CDMA/CA</a></li><li><a href="#80211_33" rel="nofollow">802.11帧（四个地址）</a></li><li><a href="#PPPHDLC_40" rel="nofollow">PPP帧/HDLC帧</a></li><li><a href="#LCPIPCP_66" rel="nofollow">LCP与IPCP的作用</a></li><li><a href="#PAP_81" rel="nofollow">PAP认证*</a></li><li><a href="#CHAP_90" rel="nofollow">CHAP认证*</a></li><li><a href="#PPPoE_105" rel="nofollow">PPPoE技术</a></li></ul> 
  </li><li><a href="#_ARP_117" rel="nofollow">第三章 ARP</a></li><li><ul><li><a href="#ARP_118" rel="nofollow">相同局域网与不同局域网的ARP工作原理*</a></li><li><a href="#ARPARP_131" rel="nofollow">ARP请求报文和ARP响应报文（封装）</a></li><li><a href="#ARP_145" rel="nofollow">ARP欺骗</a></li><li><a href="#ARP_153" rel="nofollow">代理ARP</a></li><li><a href="#ARP_160" rel="nofollow">免费ARP*</a></li></ul> 
  </li><li><a href="#35_RIP_172" rel="nofollow">第3.5章 RIP*</a></li><li><ul><li><a href="#RIPIPMAC_173" rel="nofollow">RIP报文的封装（使用的端口号，IP地址，MAC地址）*</a></li><li><a href="#RIP_178" rel="nofollow">RIP的工作过程*</a></li><li><a href="#_188" rel="nofollow">水平分割*</a></li><li><a href="#_195" rel="nofollow">触发更新*</a></li></ul> 
  </li><li><a href="#_IP_199" rel="nofollow">第四章 IP</a></li><li><ul><li><a href="#IPv4_200" rel="nofollow">IPv4</a></li><li><ul><li><a href="#TTLM_201" rel="nofollow">首部格式（首部长度与总长度，TTL,协议，标识，M位，片偏移）</a></li><li><a href="#_217" rel="nofollow">首部长度存在的必要性*</a></li><li><a href="#IP_220" rel="nofollow">IP分片</a></li><li><a href="#_230" rel="nofollow">考虑含选项（记录路由、源路由）时的分片首部*</a></li><li><a href="#_232" rel="nofollow">记录路由选项</a></li><li><a href="#_253" rel="nofollow">源路由选项（严格/宽松）</a></li></ul> 
   </li><li><a href="#IPv6_271" rel="nofollow">IPv6*</a></li><li><ul><li><a href="#40_272" rel="nofollow">数据报格式（固定首部40字节，“下一个首部”字段）*</a></li><li><a href="#6_278" rel="nofollow">6种扩展首部（作用，顺序）</a></li><li><a href="#_288" rel="nofollow">源路由扩展首部</a></li><li><a href="#8__297" rel="nofollow">分片扩展首部8字节*（可分片部分，不可分片部分，分片扩展首部 的格式）</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_ICMP_319" rel="nofollow">第五章 ICMP</a></li><li><ul><li><a href="#ICMPv4_320" rel="nofollow">ICMPv4</a></li><li><ul><li><a href="#4_321" rel="nofollow">4种差错报告报文（格式及封装，何时产生，由谁产生）*</a></li><li><ul><li><a href="#1_ICMP_330" rel="nofollow">1. 终点不可达ICMP报文</a></li><li><a href="#2ICMP_341" rel="nofollow">2.超时ICMP报文</a></li><li><a href="#3ICMP_347" rel="nofollow">3.参数错误ICMP报文</a></li><li><a href="#4ICMP_353" rel="nofollow">4.重定向ICMP报文</a></li></ul> 
    </li><li><a href="#3ICMPv4_357" rel="nofollow">3种请求应答类ICMPv4报文（格式及封装，作用）</a></li><li><ul><li><a href="#1_366" rel="nofollow">1.回送请求和应答报文</a></li><li><a href="#2_373" rel="nofollow">2.时间戳请求和应答报文</a></li><li><a href="#3_385" rel="nofollow">3.路由器通告和恳求报文</a></li></ul> 
    </li><li><a href="#PINGICMP_390" rel="nofollow">PING命令与ICMP</a></li><li><a href="#TracerouteICMP_394" rel="nofollow">Traceroute命令与ICMP</a></li></ul> 
   </li><li><a href="#ICMPv6_413" rel="nofollow">ICMPv6*</a></li><li><ul><li><a href="#_414" rel="nofollow">五种差错报告报文（数据报太大*）</a></li><li><ul><li><a href="#_424" rel="nofollow">数据包太大报文</a></li><li><a href="#_428" rel="nofollow">超时报文</a></li><li><a href="#_439" rel="nofollow">参数问题报文</a></li><li><a href="#_449" rel="nofollow">改变路由报文</a></li></ul> 
    </li><li><a href="#3ICMPv4_453" rel="nofollow">3种请求应答类ICMPv4报文（路由询问/通告报文，邻居询问/通告报文）</a></li><li><ul><li><a href="#Echo_463" rel="nofollow">Echo请求/应答报文</a></li><li><a href="#_469" rel="nofollow">路由器询问/通告报文</a></li><li><a href="#_478" rel="nofollow">邻居询问/通告报文</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_UDP_484" rel="nofollow">第六章 UDP</a></li><li><ul><li><a href="#_485" rel="nofollow">熟知端口号</a></li><li><a href="#UDP_494" rel="nofollow">UDP首部*</a></li><li><a href="#UDP_499" rel="nofollow">UDP检验的两种方案</a></li><li><a href="#UDPLite_512" rel="nofollow">UDP-Lite的检验和及“检验和覆盖”字段的取值*</a></li><li><a href="#UDP_519" rel="nofollow">如何判断目标主机的某个UDP端口是否开放*</a></li></ul> 
  </li><li><a href="#_TCP_525" rel="nofollow">第七章 TCP</a></li><li><ul><li><a href="#UDPTCP_526" rel="nofollow">理解UDP面向报文、TCP面向字节流</a></li><li><a href="#TCP_529" rel="nofollow">标识TCP连接的四元组</a></li><li><a href="#TCP_541" rel="nofollow">TCP建立连接*</a></li><li><a href="#SYN_545" rel="nofollow">SYN洪泛攻击*</a></li><li><a href="#TCP_550" rel="nofollow">TCP端口扫描*</a></li><li><a href="#_555" rel="nofollow">发送缓存与接收缓存的作用</a></li><li><a href="#TCP_565" rel="nofollow">TCP流量控制（序号、确认号、窗口、死锁现象、糊涂现象）</a></li><li><ul><li><a href="#_569" rel="nofollow">序号与确认号</a></li><li><a href="#_582" rel="nofollow">窗口尺寸</a></li><li><a href="#_586" rel="nofollow">死锁现象</a></li><li><a href="#_592" rel="nofollow">糊涂窗口现象</a></li></ul> 
   </li><li><a href="#_598" rel="nofollow">四个计时器</a></li><li><ul><li><a href="#1__599" rel="nofollow">1 超时重传计时器</a></li><li><a href="#2__604" rel="nofollow">2 坚持计时器</a></li><li><a href="#3__606" rel="nofollow">3 时间等待计时器</a></li><li><a href="#4__610" rel="nofollow">4 保活计时器</a></li></ul> 
   </li><li><a href="#_614" rel="nofollow">三种确认机制</a></li><li><ul><li><a href="#_627" rel="nofollow">捎带确认</a></li><li><a href="#_628" rel="nofollow">累积确认</a></li><li><ul><li><a href="#_633" rel="nofollow">有丢失的累积确认</a></li><li><a href="#_637" rel="nofollow">有重复的累积确认</a></li></ul> 
    </li><li><a href="#_640" rel="nofollow">选择确认</a></li></ul> 
   </li><li><a href="#TCP_646" rel="nofollow">TCP选项</a></li><li><ul><li><a href="#_648" rel="nofollow">选项结束选项</a></li><li><a href="#_652" rel="nofollow">无操作选项</a></li><li><a href="#MSS_655" rel="nofollow">MSS选项</a></li><li><a href="#_659" rel="nofollow">窗口扩大选项</a></li><li><a href="#_664" rel="nofollow">时间戳选项</a></li><li><a href="#SACKSACK_667" rel="nofollow">允许SACK选项和SACK选项</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_SCTP_675" rel="nofollow">第八章 SCTP</a></li><li><ul><li><a href="#SCTP_676" rel="nofollow">SCTP的特点</a></li><li><a href="#_679" rel="nofollow">多宿主</a></li><li><a href="#TCPSCTP_681" rel="nofollow">TCP头端阻塞与SCTP多重流*</a></li><li><ul><li><a href="#TCP_682" rel="nofollow">TCP头端阻塞</a></li><li><a href="#SCTP_690" rel="nofollow">SCTP多重流</a></li></ul> 
   </li><li><a href="#TCP_SYNSCTP_695" rel="nofollow">TCP SYN洪泛攻击与SCTP初始化保护*</a></li><li><a href="#SCTP_697" rel="nofollow">SCTP分组格式*</a></li><li><a href="#_699" rel="nofollow">块类型</a></li><li><ul><li><ul><li><a href="#INIT_702" rel="nofollow">INIT块</a></li><li><a href="#INIT_ACK_712" rel="nofollow">INIT ACK块</a></li><li><a href="#COOKIE_ECHOACK_718" rel="nofollow">COOKIE ECHO/ACK块</a></li><li><a href="#_721" rel="nofollow">建立关联</a></li><li><a href="#DATA_724" rel="nofollow">DATA块</a></li><li><a href="#SACK_731" rel="nofollow">SACK块</a></li><li><a href="#_734" rel="nofollow">数据传输</a></li><li><a href="#SHUTDOWN_736" rel="nofollow">SHUTDOWN</a></li><li><a href="#_739" rel="nofollow">关闭关联</a></li><li><a href="#HEARTBEATACK_743" rel="nofollow">HEARTBEAT/ACK块</a></li><li><a href="#ERRORABORT_745" rel="nofollow">ERROR/ABORT块</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_750" rel="nofollow">验证标志的作用</a></li><li><a href="#TSNSISSN_754" rel="nofollow">TSN,SI,SSN的作用</a></li></ul> 
  </li><li><a href="#_DHCP_761" rel="nofollow">第九章 DHCP</a></li><li><ul><li><a href="#_762" rel="nofollow">主机的四个网络参数</a></li><li><a href="#DHCP_764" rel="nofollow">DHCP服务器配置命令</a></li><li><a href="#DHCP68_778" rel="nofollow">DHCP客户端使用68端口的原因</a></li><li><a href="#_786" rel="nofollow">租用期</a></li><li><a href="#DHCP_790" rel="nofollow">DHCP工作过程*</a></li><li><a href="#DHCP_792" rel="nofollow">DHCP报文及封装*</a></li><li><a href="#_808" rel="nofollow">选项及报文类型</a></li><li><a href="#DHCP_810" rel="nofollow">DHCP中继*（客户与中继、中继与服务器之间的报文交互）</a></li><li><a href="#IPv6_822" rel="nofollow">获取IPv6地址的方式</a></li><li><a href="#DHCPv6EUI64_833" rel="nofollow">DHCPv6（端口号，EUI-64）</a></li><li><ul><li><a href="#UDP_834" rel="nofollow">UDP端口号</a></li><li><a href="#EUI64_839" rel="nofollow">EUI-64转换</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_DNS_844" rel="nofollow">第十章 DNS*</a></li><li><ul><li><a href="#_845" rel="nofollow">域名空间</a></li><li><a href="#_850" rel="nofollow">域名服务器</a></li><li><a href="#_858" rel="nofollow">递归和迭代</a></li><li><a href="#_861" rel="nofollow">域名解析顺序</a></li><li><a href="#AAAAACNAMENSMXPTR_871" rel="nofollow">资源记录类型（A,AAAA,CNAME,NS,MX,PTR）*</a></li><li><ul><li><a href="#A_875" rel="nofollow">A类型</a></li><li><a href="#CHAME_882" rel="nofollow">CHAME类型</a></li><li><a href="#NS_888" rel="nofollow">NS类型</a></li><li><a href="#MX_894" rel="nofollow">MX类型</a></li><li><a href="#PTR_900" rel="nofollow">PTR类型</a></li></ul> 
   </li><li><a href="#nslookup_906" rel="nofollow">nslookup命令*</a></li><li><a href="#DNS_910" rel="nofollow">DNS报文格式（首部，问题区，回答区）*</a></li><li><ul><li><a href="#_931" rel="nofollow">参数</a></li><li><a href="#_943" rel="nofollow">问题区</a></li><li><a href="#_951" rel="nofollow">回答区</a></li></ul> 
   </li><li><a href="#_964" rel="nofollow">域名存储*</a></li><li><a href="#_966" rel="nofollow">域名压缩*</a></li><li><a href="#DDNS_974" rel="nofollow">DDNS及应用</a></li><li><a href="#DNSSecDNS_978" rel="nofollow">DNSSec如何防止DNS欺骗*</a></li></ul> 
  </li><li><a href="#_FTPTFTP_984" rel="nofollow">第十一章 FTP与TFTP</a></li><li><ul><li><a href="#FTP_985" rel="nofollow">FTP</a></li><li><ul><li><a href="#_986" rel="nofollow">控制连接与数据连接*</a></li><li><a href="#PORTPASV_993" rel="nofollow">PORT模式与PASV模式的特点*</a></li><li><ul><li><a href="#FTPPORT_994" rel="nofollow">FTP数据连接（PORT模式）</a></li><li><a href="#FTPPASV_1004" rel="nofollow">FTP数据连接（PASV模式）</a></li><li><a href="#PORTPASV_1016" rel="nofollow">比较PORT和PASV</a></li></ul> 
    </li><li><a href="#_1024" rel="nofollow">协商端口号的过程*</a></li><li><a href="#NATPORT_1027" rel="nofollow">NAT对PORT模式的影响*</a></li><li><a href="#FTPFTP_1033" rel="nofollow">FTP命令与FTP响应的封装*</a></li><li><ul><li><a href="#FTP_1034" rel="nofollow">FTP命令</a></li><li><a href="#FTP_1055" rel="nofollow">FTP响应</a></li><li><a href="#FTP_1068" rel="nofollow">FTP命令和响应全过程</a></li></ul> 
    </li><li><a href="#FTP_1079" rel="nofollow">匿名FTP</a></li></ul> 
   </li><li><a href="#TFTP_1082" rel="nofollow">TFTP</a></li><li><ul><li><a href="#UDP69_1083" rel="nofollow">基于UDP69</a></li><li><a href="#_1091" rel="nofollow">可靠传输、流量控制、差错控制</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_HTTP_1101" rel="nofollow">第十二章 HTTP*</a></li><li><ul><li><a href="#HTTP_1102" rel="nofollow">HTTP请求报文（格式、常用请求方法）*</a></li><li><a href="#HTTP_1113" rel="nofollow">HTTP响应报文（格式、常见状态码）*</a></li><li><a href="#HTTP_1116" rel="nofollow">HTTP认证</a></li><li><ul><li><a href="#_1119" rel="nofollow">基本认证</a></li><li><a href="#_1121" rel="nofollow">摘要认证</a></li></ul> 
   </li><li><a href="#_1124" rel="nofollow">常用首部</a></li><li><ul><li><a href="#ConnectionKeepalive_1125" rel="nofollow">Connection和Keepalive*</a></li><li><a href="#HostReferer_1135" rel="nofollow">Host*、Referer*</a></li><li><a href="#Location_1143" rel="nofollow">Location*</a></li><li><a href="#Server_1147" rel="nofollow">Server</a></li><li><a href="#Allow_1151" rel="nofollow">Allow</a></li><li><a href="#XFrameOption_1155" rel="nofollow">X-Frame-Option</a></li><li><a href="#RangeContentRange_1164" rel="nofollow">Range和Content-Range</a></li><li><a href="#ViaMaxForwards_1174" rel="nofollow">Via和Max-Forwards*</a></li><li><ul><li><a href="#HTTP_1177" rel="nofollow">追踪HTTP报文</a></li><li><a href="#ViaVia_1183" rel="nofollow">请求Via和响应Via</a></li><li><a href="#MaxForwards_1186" rel="nofollow">Max-Forwards首部</a></li></ul> 
    </li><li><a href="#ExpiresCacheControl_1196" rel="nofollow">Expires和Cache-Control</a></li><li><a href="#LastModifiedifModifiedSince_1205" rel="nofollow">Last-Modified和if-Modified-Since*</a></li><li><a href="#EtagIfNoneMatch_1220" rel="nofollow">Etag和If-None-Match*</a></li><li><a href="#AuthenticationWWWAuthentication_1233" rel="nofollow">Authentication和WWW-Authentication</a></li></ul> 
   </li><li><a href="#HTTPS_1236" rel="nofollow">HTTPS的加密、认证、完整性保护*</a></li><li><ul><li><a href="#_1237" rel="nofollow">对称密钥加密技术</a></li><li><a href="#_1241" rel="nofollow">公开密钥加密技术</a></li><li><a href="#HTTPS_1243" rel="nofollow">HTTPS采用混合加密机制</a></li><li><a href="#_1247" rel="nofollow">报文被篡改</a></li><li><a href="#HTTP_1252" rel="nofollow">HTTP不验证身份</a></li></ul> 
   </li><li><a href="#HTTPAjaxCometWebSocket_1257" rel="nofollow">HTTP优化技术（Ajax、Comet、WebSocket）</a></li><li><ul><li><a href="#Ajax_1258" rel="nofollow">Ajax的解决方法</a></li><li><a href="#Comet_1263" rel="nofollow">Comet的解决方法</a></li><li><a href="#WebSocket_1269" rel="nofollow">WebSocket</a></li></ul> 
   </li><li><a href="#HTTP20_1274" rel="nofollow">HTTP2.0的特点</a></li><li><ul><li><a href="#_1275" rel="nofollow">二进制分帧</a></li><li><a href="#_1279" rel="nofollow">请求分优先级</a></li><li><a href="#_1286" rel="nofollow">首部压缩</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/97/8c/ByDN9gWU_o.jpg" alt="复习大纲"></p> 
<h2><a id="__4"></a>第一章 概述</h2> 
<h3><a id="_5"></a>数据封装与解封装</h3> 
<p><img src="https://images2.imgbox.com/bb/9e/kq2ueGSD_o.png" alt="数据的封装和解封装"></p> 
<h3><a id="_7"></a>互联网使用的四种地址</h3> 
<p><img src="https://images2.imgbox.com/f6/00/c2GbyRiA_o.png" alt="四种地址"><br> 特定应用地址：指应用层使用的地址<br> 端口号：本地意义。用来标识主机上运行的应用进程<br> 逻辑地址：互联网中的逻辑地址使用IP地址<br> 物理地址：以太网使用的物理地址是MAC地址</p> 
<h2><a id="__13"></a>第二章 链路层</h2> 
<h3><a id="_14"></a>信道类型与帧类型*</h3> 
<ul><li>有线广播信道：Ethernet V2帧/802.3帧</li><li>无线广播信道：802.11帧</li><li>点对点信道：PPP帧/HDLC帧</li></ul> 
<h3><a id="Ethernet_IIMTU_18"></a>以太网（Ethernet II帧格式*，MTU）</h3> 
<p><img src="https://images2.imgbox.com/b3/8c/D4bUKSeQ_o.png" alt="EthernetV2帧"><br> MTU（最大传输单元），以太网的MTU最大值为1500字节，超过MTU要么被丢弃，要么数据就需要分片</p> 
<h3><a id="CSMACDCDMACA_21"></a>CSMA/CD与CDMA/CA</h3> 
<p><strong>CSMA/CD</strong>:载波监听多点接入/碰撞检测，作用在集线器上</p> 
<ul><li>“多点接入”：使用广播信道的总线型网络</li><li>“载波监听”：不停地检测信道（发送前、发送中）</li><li>“碰撞检测”：检测到碰撞→立即停止发送→等待随机事件后再发送</li><li>争用期=以太网的端到端往返时间2τ</li><li>10Mbit/s以太网的争用期2τ=51.2μs。</li><li>最先发送数据的站，在争用期内没有检测到碰撞，则这次发送肯定不会发生碰撞</li><li>如果在争用期内发生发生碰撞，需要用截断二进制支书退避算法来计算等待时间。即退避时间=r倍的争用期=r*2τ，r为离散集合【0,1，…,2^k-1】中的一个随机数。k=Min[重传次数,10]。当重传次数=16次，仍不能成功时即丢弃该帧，并向高层报告<br> <img src="https://images2.imgbox.com/34/06/7LyonBc1_o.png" alt="CSMA/DA工作流程"><img src="https://images2.imgbox.com/a4/14/RF57jXrf_o.png" alt="碰撞实例"></li></ul> 
<p><strong>CSMA/CA</strong>：就是带有冲突避免的CSMA/CD，属于升级版，主要应用在无线网络中</p> 
<h3><a id="80211_33"></a>802.11帧（四个地址）</h3> 
<p><img src="https://images2.imgbox.com/7e/fa/63PPmcKI_o.png" alt="802.11帧"><br> <strong>序号</strong>的作用是可以按序接收，并判断是否丢失或者需要重传<br> <strong>传输持续时间</strong>：两个主机要通信，需要预约帧预约信道，因为没有冲突检测功能，可能会发生冲突，所以由这部分给出占用信道的时间<br> <strong>从AP到AP</strong>与<strong>四个地址</strong>配合使用<br> <img src="https://images2.imgbox.com/1d/0e/ikOmdBU5_o.png" alt="802.11帧的编址方式"><br> 表中1代表AP，0代表主机</p> 
<h3><a id="PPPHDLC_40"></a>PPP帧/HDLC帧</h3> 
<p><img src="https://images2.imgbox.com/b4/a0/TeWQO0l3_o.png" alt="PPP帧的工作流程"></p> 
<p><strong>PPP的工作流程</strong></p> 
<ol><li>链路不可用阶段：表明物理层尚未准备好</li><li>链路建立阶段:用LCP建立和配置PPP链路</li><li>身份认证阶段：身份认证（PAP或CHAP）</li><li>网络协议阶段：使用NCP配置网络层协议</li><li>网络终止阶段：PPP链路终止，但物理层仍可用</li></ol> 
<p><img src="https://images2.imgbox.com/f8/db/Y2wUh5oC_o.png" alt="PPP帧的格式"><br> <strong>PPP帧格式协议字段</strong>：</p> 
<ul><li>=0X0021，数据部分是IP数据报</li><li>=0XC021，数据部分是LCP（建立链路）</li><li>=0X8021,数据部分是IPCP</li><li>=0XC023,数据部分是PAP（身份认证）</li><li>=0XC223,数据部分是CHAP（身份认证）</li></ul> 
<p><img src="https://images2.imgbox.com/89/f3/4jfiOifE_o.png" alt="HDLC帧格式"><br> <strong>HDLC帧</strong>：</p> 
<ol><li>帧标志F：HDLC采用固定的标志字段01111110作为帧的边界。</li><li>地址字段A：用在多点链路中，它是用来存放从站的地址的</li><li>控制字段C：HDLC定义了3种不同的帧，可以根据控制字段区分（信息帧、管理帧、无编号帧）</li><li>信息字段INFO：信息帧和一部分管理帧含有控制字段，这个字段可以包含用户数据的所有比特序列</li><li>校验字段FCS：校验字段包含地址字段、控制字段、信息字段的校验和，但不包括标志字段</li><li>具体可见<a href="https://blog.csdn.net/constantine/article/details/3126258">HDLC帧格式</a></li></ol> 
<h3><a id="LCPIPCP_66"></a>LCP与IPCP的作用</h3> 
<p><img src="https://images2.imgbox.com/8a/68/t1Mv8WmO_o.png" alt="LCP"><br> 功能中的链路配置对应PPP工作流程中的第二步的身份认证，链路终止对应第五步身份认证，链路维护应用于数据传输过程中，长时间没有数据传输时可以提醒对方</p> 
<p><strong>LCP链路配置过程</strong></p> 
<ol><li>request：发起方发送的链路配置请求报文（可包含多个选项）</li><li>ack：如果request中的每一个选项都能被接收端识别，而且都能被接受，则ACK</li><li>nak：如果request中的每个选项都能被识别，但只有部分能接受，则NAK</li><li>reject：如果request中有部分选项不能被识别，或不能被接受，则reject</li></ol> 
<p><img src="https://images2.imgbox.com/d3/a3/0ny2SlWe_o.png" alt="LCP选项"><br> <img src="https://images2.imgbox.com/20/1e/JBqllMlm_o.png" alt="LCP请求报文"></p> 
<p><strong>IPCP的功能</strong>：配置双方的IP协议模块<br> <img src="https://images2.imgbox.com/c0/eb/az8UhmQt_o.png" alt="IPCP"></p> 
<h3><a id="PAP_81"></a>PAP认证*</h3> 
<p><img src="https://images2.imgbox.com/d4/ba/lkaGXJNl_o.png" alt="PAP认证过程"></p> 
<p><strong>PAP认证</strong>：验证方通常是ISP的服务器，被验证方经常是客户端</p> 
<ul><li>两次握手，发送两次报文</li><li>密码在链路上是以明文方式传输的。被验证方首 先发起验证请求。即客户讲账号密码同时传输过去</li><li>不能防止回放攻击和重复的尝试攻击（验证重试频率和次数由被验证控制）。主动权在客户端手里</li><li>PAP认证只在链路建立阶段使用。过了这个阶段就不会再认证了</li></ul> 
<h3><a id="CHAP_90"></a>CHAP认证*</h3> 
<p>CHAP主动权掌握在服务器手里，验证方是服务器，被验证方是客户端，三次握手。只传输用户名（不传输密码），由验证方首先发起验证请求<br> <img src="https://images2.imgbox.com/f8/f2/X59K0Q0J_o.png" alt="CHAP认证"><br> CHAP认证可在链路建立和数据通信阶段使用：</p> 
<ol><li><strong>CHAP身份验证呼叫阶段</strong>：客户端从物理上和服务器联通</li><li><strong>CHAP身份验证挑战阶段</strong>: 服务器方会产生一个报文，包含ID数和随机数发给客户端</li><li><strong>CHAP身份验证回应阶段</strong>：客户端把ID随机数通过MD5算法算出hash值</li><li><strong>CHAP身份验证回应阶段</strong>：客户端把ID和hash值装进报文发给服务端</li><li><strong>CHAP身份验证确认阶段</strong>：客户端的报文中的数值和服务器本地的数据算出的hash值做比对，看看是否正确</li><li><strong>回报认证结果</strong></li></ol> 
<p><strong>CHAP配置与PAP配置的区别</strong>：</p> 
<ul><li>验证方两者建立的数据库是不一样的，体现在：CHAP配置服务端的用户名必须是对端的路由器名称</li><li>被验证方PAP认证不需要建立本地用户名密码，CHAP认证需要建立本地用户名和密码，该名称必须是对端路由器名称，密码一致。</li><li>被验证方PAP需要把本地用户用户名密码发给验证方，CHAP不需要</li></ul> 
<h3><a id="PPPoE_105"></a>PPPoE技术</h3> 
<p>PPPoE：即基于以太网的PPP协议，拨号宽带接入：ADSL、光纤宽带<br> PPPoE允许ISP监控用户流量，可以方便ISP收费（基于时长和流量计费）<br> PPPoE工作流程分两个阶段：发现阶段（建立链路）–》会话阶段（传输数据）<br> <img src="https://images2.imgbox.com/6b/e0/rxPO357y_o.png" alt="发现阶段报文"><br> <img src="https://images2.imgbox.com/71/58/HiK1dzOv_o.png" alt="PPPoE会话阶段报文"><br> <img src="https://images2.imgbox.com/89/92/fPPZduHd_o.png" alt="PPPoE发现阶段"></p> 
<ol><li>PADI:主机广播发送PADI报文，寻找AC，目的MAC地址为广播地址，代码09</li><li>PADO：AC单播发送相应报文PADO，代码07</li><li>PADR：主机在可能受到的多个PADO报文中选择一个合适的PADO报文，然后向所选择的AC发送PADR报文，代码19</li><li>PADS：AC发送一个PADS报文，确认可以进入PPP会话阶段，代码65<br> 类似于DHCP协议</li></ol> 
<h2><a id="_ARP_117"></a>第三章 ARP</h2> 
<h3><a id="ARP_118"></a>相同局域网与不同局域网的ARP工作原理*</h3> 
<p><img src="https://images2.imgbox.com/0c/7a/h5fjAI76_o.png" alt="本网ARP的使用"></p> 
<ol><li>主机A要向主机B发送数据。首先A广播发送ARP请求分组，请求分组中包含主机A的IP、MAC地址，B的IP地址，此时目的MAC为ff:ff:ff:ff:ff:ff。</li><li>主机X,Y收到请求分组后，因为不是目标主机，所以不会响应，但会把主机A的IP、MAC存入自己的ARP表中。主机B收到后，也会添加到ARP表中，同时将会向A发送ARP响应分组，其中包含主机A、B的IP、MAC。</li></ol> 
<p><img src="https://images2.imgbox.com/b5/cb/2CORqTWA_o.png" alt="跨网使用ARP"></p> 
<ol><li>A发出ARP请求分组，其中包含A的IP、MAC，B、R1都收到了分组</li><li>R1发送ARP应答分组，A获得了R1 的MAC，同时R1的ARP缓存上记录了A的IP、MAC</li><li>A收到ARP应答分组，在自己的ARP缓存中记录了R1的F0/0接口的IP和MAC。发送IP包和帧头给R1，其中目的IP地址为C的IP，但目的MAC地址是F0/0的MAC。</li><li>R1向C的网络中发送ARP请求分组</li><li>C收到了ARP请求分组，在自己的ARP缓存中记录了接口F0/1的IP和MAC。并发出了ARP应答分组</li><li>R1收到了ARP应答分组，将C的IP和MAC记录在自己的ARP缓存中。然后将数据报转发给C。此时数据报的源IP地址是A的，但源MAC地址是F0/1</li></ol> 
<h3><a id="ARPARP_131"></a>ARP请求报文和ARP响应报文（封装）</h3> 
<p><img src="https://images2.imgbox.com/b1/a8/YsHH3M7e_o.png" alt="ARP分组格式"></p> 
<ul><li>物理网络类型：以太网，所以为1</li><li>协议类型：网络层的协议类型，IP协议为：0x0800</li><li>物理地址长度：6，协议地址长度：4，单位都是字节</li><li>操作码：1为ARP请求；2为ARP应答</li></ul> 
<p><img src="https://images2.imgbox.com/76/ec/NS0Ki4KA_o.png" alt="ARP分组"></p> 
<ul><li>ARP分组封装在以太网帧中</li><li>需要注意目的MAC在前，源MAC在后</li><li>类型中0x0806代表随后的数据字段是ARP报文，相对的0x0800h代表数据字段是IP数据报</li><li>ARP请求分组（广播）的目的MAC为FF:FF:FF:FF:FF:FF,源MAC为：请求方MAC地址</li><li>ARP应答分组（单播）的目的MAC为：请求方MAC地址，源MAC为：应答方MAC地址</li></ul> 
<h3><a id="ARP_145"></a>ARP欺骗</h3> 
<p><strong>问</strong>：如何使得A发送给B的数据，全部发送到C？<br> <strong>答</strong>：1. C发送一个伪造ARP请求（源IP是B的IP，但是源MAC是C的MAC）<br> 2. A收到后更新自己的ARP缓存表</p> 
<p><strong>思考</strong>：如果B是A的网关，结果会如何？<br> <strong>答</strong>：A将不能正常上网，如果查出，可以通过清空ARP缓存表，再设置静态网关MAC。</p> 
<h3><a id="ARP_153"></a>代理ARP</h3> 
<p><img src="https://images2.imgbox.com/4c/b3/2ZlPGzxt_o.png" alt="代理ARP"></p> 
<ul><li>代理ARP：ARP请求从一个主机发往同一IP网段却不在同一物理网络上的另一台主机</li><li><strong>问题一</strong>：主机A发送ARP请求，请求谁的MAC地址？<br> 答：主机B的MAC地址，因为主机A和主机B的IP地址为同一网段，但是收到的却是路由器的MAC，因为路由器不能转发广播包，于是用自己的MAC和B的IP来应答</li><li><strong>问题二</strong>：主机B能否收到主机A的ARP请求报文?<br> 答：不能，因为二者处于不同广播域。</li></ul> 
<h3><a id="ARP_160"></a>免费ARP*</h3> 
<ul><li>免费ARP：向所在网络请求自己IP所对应的MAC地址</li><li>正常情况下，发送免费ARP请求不会收到ARP应答</li><li>免费ARP的作用： 
  <ol><li><strong>判断其他设备的IP地址是否与本机IP地址冲突</strong><br> 一般设备在网卡地址加载阶段都会想网络中发送免费的ARP报文，当我们想知道某些设备的接口地址但又没有相应的记录可查时，我们就可以利用免费ARP报文，分析出其接口使用的IP地址</li><li><strong>更换网卡时更新MAC地址</strong></li><li><strong>可利用免费ARP进行ARP攻击</strong><br> 在实际环境中，如果构造网关地址的免费ARP报文，并将ARP的源MAC地址设为任何非网关的MAC地址，再把构造的这个虚假网关免费ARP报文向网络中发送，那么所有接收到这个免费ARP报文的主机都会更新自己的ARP表中的网关地址对应的MAC地址，导致这些主机的数据报文全部会被转发到错误的MAC地址上，从而实现了ARP欺骗的攻击</li><li><strong>网关设备利用免费ARP防止ARP攻击</strong><br> 有些网关设备为了防止内部中毒机器对内部其他机器实施网关的ARP欺骗攻击，其会在一定的时间间隔内向网络汇总主动发送免费ARP报文，让网络中的主机更新ARP表中网关的MAC地址信息，从而达到防止或缓解ARP攻击的效果。</li></ol> </li></ul> 
<h2><a id="35_RIP_172"></a>第3.5章 RIP*</h2> 
<h3><a id="RIPIPMAC_173"></a>RIP报文的封装（使用的端口号，IP地址，MAC地址）*</h3> 
<p><img src="https://images2.imgbox.com/60/bb/GsZotRaM_o.png" alt="RIP报文格式"><br> RIP报文使用的是UDP的520端口号<br> IP地址为该路由的目的IP地址<br> MAC地址为下一跳路由器的地址</p> 
<h3><a id="RIP_178"></a>RIP的工作过程*</h3> 
<p><img src="https://images2.imgbox.com/43/3c/8tiHdXNz_o.png" alt="RIP工作过程"></p> 
<ol><li>初始状态:路由器开启RIP进程，宣告相应接口，则设备就会从相关接口发送和接收RIP报文。</li><li>构建路由表：路由器依据收到的RIP报文构建自己的路由表项</li><li>维护路由表：路由器每隔30秒发送更新报文，同时接收相邻路由器发送的更新报文以维护路由表项。</li><li>老化路由表项：路由器为将自己构建的路由表项启动180秒的定时器。180秒内，如果路由器收到更新报文，则重置自己的更新定时器和老化定时器。</li><li>垃圾收集表项：如果180秒过后，路由器没有收到相应路由表项的更新，则启动时长为120秒的垃圾收集定时器，同时将该路由表项的度量置为16。</li><li>删除路由表项：如果120秒之后，路由器仍然没有收到相应路由表项的更新，则路由器将该表项删除。</li></ol> 
<h3><a id="_188"></a>水平分割*</h3> 
<p>RIP从某个接口学到的路由，不会从该接口再发回给邻居路由器。这样不但减少了带宽消耗，还可以防止路由环路。</p> 
<p><img src="https://images2.imgbox.com/06/59/SC3NGZNR_o.png" alt="水平分割"><br> RouterA会向RouterB发送到网络10.0.0.0/8的路由信息，如果没有配置水平分割，RouterB会将从RouterA学习到的这条路由再发送回给RouterA。这样，RouterA可以学习到两条到达10.0.0.0/8网络的路由：跳数为0的直连路由；下一跳指向RouterB，且跳数为2的路由。</p> 
<p>但是在RouterA的RIP路由表中只有直连路由才是活跃的。当RouterA到网络10.0.0.0的路由变成不可达，并且RouterB还没有收到路由不可达的信息时，RouterB会继续向RouterA发送10.0.0.0/8可达的路由信息。即，RouterA会接受到错误的路由信息，认为可以通过RouterB到达10.0.0.0/8网络；而RouterB仍旧认为可以通过RouterA到达10.0.0.0/8网络，从而形成路由环路。配置水平分割后，RouterB将不会再把到网络10.0.0.0/8的路由发回给RouterA，由此避免了路由环路的产生。</p> 
<h3><a id="_195"></a>触发更新*</h3> 
<p>触发更新可以缩短网络收敛时间。在路由表项变化时立即向其他设备广播该信息，而不必等待定时更新。如果没有触发更新，缺省情况下，失效的路由条目会在路由表停留最多300秒（老化定时器+垃圾收集定时器）。</p> 
<p>详细可见：<a href="https://blog.csdn.net/qq_38265137/article/details/80503512">RIP基础知识</a></p> 
<h2><a id="_IP_199"></a>第四章 IP</h2> 
<h3><a id="IPv4_200"></a>IPv4</h3> 
<h4><a id="TTLM_201"></a>首部格式（首部长度与总长度，TTL,协议，标识，M位，片偏移）</h4> 
<p><img src="https://images2.imgbox.com/fa/c1/ClLHFoxY_o.png" alt="IPv4数据报格式"><br> <em><strong>首部长度</strong></em>：4位，首部长度=固定部分（20字节）+可选字段（0~40字节），取值范围5到15，单位为4字节<br> <em><strong>总长度</strong></em>：16位，单位为1字节，最大值为65535，但总长度必须不超过MTU<br> <em><strong>生存时间TTL</strong></em>：8位，指数据报在网络中可通过的路由器数的最大值。IP数据报每经过一个路由器，TTL减1。当减到0时，这个数据报就会被丢失<br> <em><strong>协议</strong></em>：8位，指数据部分是何种协议</p> 
<table><thead><tr><th>协议值</th><th>协议类型</th></tr></thead><tbody><tr><td>6</td><td>TCP</td></tr><tr><td>17</td><td>UDP</td></tr><tr><td>1</td><td>ICMP</td></tr><tr><td>41</td><td>IPv6</td></tr></tbody></table> 
<p><strong>标识</strong>（16位）：标识一个IP数据报，IP数据报分片时，所有分片具有相同的标识<br> <strong>片偏移</strong>（13位）：某分片在原IP数据报中的相对位置。单位为8个字节<br> <strong>标志</strong>(3位)：MF=1，还有分片；MF=0，最后一个分片；DF=1，禁止分片；DF=0，允许分片</p> 
<h4><a id="_217"></a>首部长度存在的必要性*</h4> 
<p><strong>问：“总长度”字段存在的理由？</strong><br> <strong>答</strong>：数据部分的长度可以从总长度中减去首部长度得出</p> 
<h4><a id="IP_220"></a>IP分片</h4> 
<p><img src="https://images2.imgbox.com/9b/5f/dAjVEuuU_o.png" alt="分片与重组"><br> <strong>问：何时何处进行分片和重组？</strong><br> <strong>答</strong>：分片的工作由源主机和中间路由器进行；重组的工作只由目的主机进行</p> 
<p><strong>问：每个路由器都必须计算检验和吗？</strong><br> <strong>答</strong>：中间路由器收到数据报时，也要先检验其完整性，以决定是否可以转发；如可以，则要重新计算检验和，并将其值置于首部检验和字段中然后转发。前者的工作由路由器的接收方完成，后者的工作由发送方完成</p> 
<p><strong>问：R1发出的和R2发出的IP数据报有何不同?</strong><br> <strong>答</strong>：R1和R2在网络中的位置不一样，导致了TTL的不同，因为接口的MTU不一样，所以检验和也不同</p> 
<h4><a id="_230"></a>考虑含选项（记录路由、源路由）时的分片首部*</h4> 
<p>查看选项的第一个字节，如果值为0，则不用复制，如果值为1，则所有分片中都会复制该选项</p> 
<h4><a id="_232"></a>记录路由选项</h4> 
<p><strong>功能</strong>：记录IP数据报从源主机到目的主机所经过的各路由器出接口的IP地址。<br> <strong>工作原理</strong>：</p> 
<ul><li>源主机生成一个可存放多个IP地址的空表，并规定选项长度</li><li>各路由器把主机的出接口IP地址依次填在表中<br> <img src="https://images2.imgbox.com/29/f7/MwRHK3wa_o.png" alt="记录路由选项格式"></li></ul> 
<p><strong>格式</strong>：</p> 
<ul><li>类型=7（0 00 00111） 
  <ul><li>copy=0（只要求第一个IP分片复制该选项内容）</li><li>类别=0（00），编号=7（00111）</li></ul> </li><li>长度：该选项的总长度，最多存放40字节（因为首部最大长度为（2^4-1）*4=60，前面的内容已经占了20字节）</li><li>指针：指向下一个可存放IP地址的位置</li><li>IP地址表：存放IP数据报所经过的路由器IP地址，最多只能放9个路由器地址</li></ul> 
<p><strong>记录路由的过程</strong>：</p> 
<ol><li>IP数据报离开源主机时，指针=4，IP地址表为空</li><li>当指针值&lt;长度值时，中间路由器将IP数据报离开路由器的接口的IP地址记录在IP首部选项中，指针值+4</li><li>当指针值&gt;长度值时，路由器不记录IP地址，直接转发数据报。</li></ol> 
<p><img src="https://images2.imgbox.com/f8/c5/MEEUqvAT_o.png" alt="记录路由的过程"></p> 
<h4><a id="_253"></a>源路由选项（严格/宽松）</h4> 
<p><strong>功能</strong>：由源端指定一系列路由器的IP地址，以限定IP数据报的传输路径<br> <strong>用途</strong>：通常用于测试某特定路径，或绕开某危险网络等<br> <strong>源路由支持两种形式</strong>：</p> 
<ul><li>严格源路由：指定完备路径</li><li>宽松源路由：指定路径要点<br> <img src="https://images2.imgbox.com/1c/4a/VYYFOHBu_o.png" alt="两种路由比较"><br> 当严格源路由记录：A-C-F，则IP数据报的传输路径必须是:A-C-F<br> 当宽松源路由记录：A-C-F,则IP传输的传输路径可以是：A-B-C-E-F<br> <img src="https://images2.imgbox.com/61/eb/0J6jfNOO_o.png" alt="源路由选项格式"><br> <strong>类型</strong>：（1 00 10001），（1 00 00011）</li><li>137（严格源路由），131（宽松源路由）</li><li>COPY=1,每个分片均复制源路由选项</li></ul> 
<p><strong>长度</strong>：该选项的总长度，最多为40字节<br> <strong>指针</strong>：指向当前比较的IP地址<br> <strong>IP地址表</strong>：由源主机生成，指定IP数据报经过的路径</p> 
<h3><a id="IPv6_271"></a>IPv6*</h3> 
<h4><a id="40_272"></a>数据报格式（固定首部40字节，“下一个首部”字段）*</h4> 
<p>IPv6数据报=1个基本首部（40字节）+0个或多个扩展首部+数据<br> <img src="https://images2.imgbox.com/ba/fa/NolFHGuW_o.png" alt="IPv6数据报格式"><br> <img src="https://images2.imgbox.com/9d/41/nm7jym7x_o.png" alt="IPv6数据报全格式"><br> <strong>路由器</strong>通过IPv6数据报中的基本首部中的“<strong>下一个首部</strong>”字段的值来判断一个IPv6数据报是否携带了<strong>扩展首部</strong></p> 
<h4><a id="6_278"></a>6种扩展首部（作用，顺序）</h4> 
<p>6种IPv6扩展首部：</p> 
<table><thead><tr><th>下一首部值</th><th>扩展首部类型</th></tr></thead><tbody><tr><td>0</td><td>逐跳选项</td></tr><tr><td>60</td><td>目的地选项</td></tr><tr><td>43</td><td>源路由</td></tr><tr><td>44</td><td>分片</td></tr><tr><td>51</td><td>认证</td></tr><tr><td>50</td><td>ESP</td></tr></tbody></table> 
<h4><a id="_288"></a>源路由扩展首部</h4> 
<p><img src="https://images2.imgbox.com/9b/d5/33OyG40w_o.png" alt="源路由扩展首部"></p> 
<ul><li>IPv6源主机在该首部中列出IP地址清单，以指定数据报的传输路径</li><li>前一个扩展首部或基本首部中下一个首部字段的值=43</li><li>路由类型：严格源路由/宽松源路由</li><li>跳数：到过目的地还需要的跳数</li></ul> 
<p><img src="https://images2.imgbox.com/a6/a2/hOWvgzrD_o.png" alt="实例"><br> 类比IPv4的源路由选项</p> 
<h4><a id="8__297"></a>分片扩展首部8字节*（可分片部分，不可分片部分，分片扩展首部 的格式）</h4> 
<p><img src="https://images2.imgbox.com/13/6f/ASKdH3n1_o.png" alt="分片扩展首部"></p> 
<ul><li>当源主机需要发送比PMTU更大的数据报时使用分片扩展背部</li><li>前一个扩展首部或基本首部中，下一个首部字段的值=44</li><li>标识、片偏移、M：</li></ul> 
<p><strong>问：为什么没有DF位？</strong><br> 答：IPv6路由器不支持分片</p> 
<p><strong>链路MTU与PMTU</strong></p> 
<ul><li>链路MTU：一条链路上能进行传输的最大传输单元</li><li>PMTU：源地址和目的地址之间的路径中所有链路MTU中的最小值</li></ul> 
<p><strong>最小MTU</strong>:576字节（IPv4网络）、1280字节（IPv6网络），超过可能会被丢弃</p> 
<p><img src="https://images2.imgbox.com/14/a6/hJKI6Q0j_o.png" alt="实例"></p> 
<ul><li>不可分片部分：基本首部+需中间路由器处理的扩展首部（如逐跳选项扩展首部、源路由选项扩展首部）</li><li>可分片部分：只能被目的节点处理的扩展首部（中间路由器不处理）+上层数据</li></ul> 
<p>不可分片部分考虑其中的两个字段：有效载荷长度（除基本首部之外其他的扩展首部和数据报中的内容）、下一个首部（指向紧跟在后面的首部）<br> 分片扩展首部：考虑M位</p> 
<h2><a id="_ICMP_319"></a>第五章 ICMP</h2> 
<h3><a id="ICMPv4_320"></a>ICMPv4</h3> 
<h4><a id="4_321"></a>4种差错报告报文（格式及封装，何时产生，由谁产生）*</h4> 
<p><img src="https://images2.imgbox.com/2d/69/tRrmtlH3_o.png" alt="ICMPv4差错报告报文"><br> 在ICMPv4差错报告报文中，可以得知以上4种信息。<br> 从上到下：</p> 
<ol><li>在ICMP首部中获取</li><li>在ICMP首部中获取</li><li>后面一个IP首部中获取</li><li>后面一个IP首部中获取</li></ol> 
<h5><a id="1_ICMP_330"></a>1. 终点不可达ICMP报文</h5> 
<p><img src="https://images2.imgbox.com/c2/36/I0oNvuOk_o.png" alt="终点不可达"></p> 
<p>由“代码”字段指明丢弃该数据报的具体原因：</p> 
<ul><li>网络不可达（代码=0）路由器找不到目标网络后被丢弃</li><li>主机不可达（代码=1）最后一个路由器找不到目的MAC（由于关机等原因）</li><li>协议不可达（代码=2）由于路由器或主机的协议被卸载等情况而消失了</li><li>端口不可达（代码=3）主机或者路由器的端口没开，无法访问</li><li>不能分片（代码=4）DF位被置位，数据报不能分片却遇到必须分片的情况<br> 。。。。</li></ul> 
<h5><a id="2ICMP_341"></a>2.超时ICMP报文</h5> 
<p><img src="https://images2.imgbox.com/44/49/rZZJflnF_o.png" alt="超时ICMP报文"><br> 两种情况下产生：</p> 
<ol><li>TTL=0（代码=0）路由器上的问题，主机上不会遇到，因为主机不会执行TTL-1的操作</li><li>数据报分片重组超时（代码=1）目标主机上会遇到</li></ol> 
<h5><a id="3ICMP_347"></a>3.参数错误ICMP报文</h5> 
<p><img src="https://images2.imgbox.com/37/23/TLdTlhYy_o.png" alt="参数错误ICMP报文"><br> 当IP数据报的首部出错时：</p> 
<ol><li>IP首部某字段有差错时，代码=0，指针指向差错字段</li><li>缺少所需的选项时，代码=1，指针不使用</li></ol> 
<h5><a id="4ICMP_353"></a>4.重定向ICMP报文</h5> 
<p><img src="https://images2.imgbox.com/3b/c3/c8LEK2fd_o.png" alt="重定向ICMP报文"><br> 当网络拓扑发生变化时，路由重定向ICMP报文可以更新<strong>主机的路由表</strong>。（所以主机是有路由表的，用route print查看路由表）<br> 当A向C发送数据时，A会向R1查询主机C的信息，然后发现R2是必经的路径，从A自己走会更好，于是发重定向报文给A，使A的路径改成A-R2-C</p> 
<h4><a id="3ICMPv4_357"></a>3种请求应答类ICMPv4报文（格式及封装，作用）</h4> 
<p>功能：实现对网络的故障诊断与网络控制<br> ICMP请求应答报文总是在源和目标之间双向、成对出现</p> 
<table><thead><tr><th>类型值</th><th>报文类型</th><th>作用</th></tr></thead><tbody><tr><td>8/0</td><td>回送请求/应答报文</td><td>测试两个站点之间连通性</td></tr><tr><td>13/14</td><td>时间戳请求/应答报文</td><td>测试两个站点之间的往返时间</td></tr><tr><td>9/10</td><td>路由器通告/恳求报文</td><td>通告/寻找默认路由器</td></tr></tbody></table> 
<h5><a id="1_366"></a>1.回送请求和应答报文</h5> 
<p><img src="https://images2.imgbox.com/45/40/hrriyJhp_o.png" alt="回送请求和应答报文"></p> 
<ul><li>类型=8/0：回送请求/回送应答报文</li><li>回送应答报文“数据区”=回送请求报文“数据区”</li><li>标识和序号：用来匹配请求报文和应答报文</li><li>注意：成对的请求和应答报文使用相同的“标识”和“序号”字段</li></ul> 
<h5><a id="2_373"></a>2.时间戳请求和应答报文</h5> 
<p><img src="https://images2.imgbox.com/6b/ca/9fmA3N4R_o.png" alt="时间戳请求和应答报文"></p> 
<ul><li>初始时间戳：发送方发送请求报文时填写</li><li>接收时间戳：接收方收到请求报文时填写</li><li>传送时间戳：接收方发送应答报文时填写</li></ul> 
<p><strong>问1</strong>：如何估算往返时延？<br> <strong>答</strong>：往返时延=发送方收到应答报文的时间-初始时间戳</p> 
<p><strong>问2</strong>：如何估算传输时延？<br> <strong>答</strong>：传输时延=往返时延-（传送时间戳-接收时间戳）</p> 
<h5><a id="3_385"></a>3.路由器通告和恳求报文</h5> 
<p><img src="https://images2.imgbox.com/3a/39/RIVVgVJ7_o.png" alt="路由器通告和恳求报文"><br> 路由器定期（10分钟）广播发送路由器通告报文，正在监听的主机更新路由表<br> 主机启动后广播发送路由器恳求报文，寻找默认路由器<br> 这个报文无线用的多，移动用的少</p> 
<h4><a id="PINGICMP_390"></a>PING命令与ICMP</h4> 
<ul><li>在命令行中输入：<code>ping -f -l 1472 192.168.1.1</code></li><li>如果出现：<code>Packet needs ti be fragmented but DF set.</code>(表示数据包太大需要分片，DF位被置位无法分片)</li><li>当ping成功时：MTU=-l后面的数据+ICMP头（8字节）+IP头（20字节）</li></ul> 
<h4><a id="TracerouteICMP_394"></a>Traceroute命令与ICMP</h4> 
<p><strong>Q1:描述Tracert程序的工作过程</strong><br> <strong>答</strong>：主机A向R1、R2各发送3个类型值8的回送请求报文，收到超时ICMP报文，再向B发送3个回送请求报文，收到类型值为0的超时应答报文</p> 
<p><strong>Q2:Tracert程序运行结束时主机A发出IP数据报的总个数？</strong><br> <strong>答</strong>：3*3，对R1、R2、B三个各发三个报文</p> 
<p><strong>Q3:主机A收到哪几种类型ICMP报文?</strong><br> <strong>答</strong>：请求，响应，超时三种<br> <strong>衍生</strong>：windows操作系统下Tracert程序正常运行时使用了哪些类型的ICMP报文？<br> <strong>答</strong>：回送请求和应答报文、超时；如果是UNIX系统则是超时和终点不可达</p> 
<p><strong>Q4:主机A如何判断何时结束Tracert程序？</strong><br> <strong>答</strong>：B向A发送的不同于R1、R2发送类型的类型值为0的超时应答报文</p> 
<p><strong>Traroute的区别：</strong><br> A发送的是UDP，R1,R2发回的内容一致，B发的是端口不可达的网络不可达报文。</p> 
<p><img src="https://images2.imgbox.com/af/da/lYgNXpJp_o.png" alt="例题"></p> 
<h3><a id="ICMPv6_413"></a>ICMPv6*</h3> 
<h4><a id="_414"></a>五种差错报告报文（数据报太大*）</h4> 
<p>差错类 ：</p> 
<table><thead><tr><th>类型值</th><th>报文类型</th></tr></thead><tbody><tr><td>1</td><td>终点不可达</td></tr><tr><td>2</td><td>数据包太大</td></tr><tr><td>3</td><td>超时</td></tr><tr><td>4</td><td>参数问题</td></tr><tr><td>137</td><td>改变路由</td></tr></tbody></table> 
<h5><a id="_424"></a>数据包太大报文</h5> 
<p>当IPv6数据包的大小超过了链路的MTU值，路由器会丢弃，并向源节点发送此信息。<br> <img src="https://images2.imgbox.com/0e/a5/EHIjcsaU_o.png" alt="数据包太大报文"><br> 注意：区分链路MTU和路径MTU</p> 
<h5><a id="_428"></a>超时报文</h5> 
<ul><li>当IPv6数据报的TTL=0时</li><li>当一个数据报的某些分片未能按期到达时</li></ul> 
<p><img src="https://images2.imgbox.com/4b/3c/OcFKuNHH_o.png" alt="超时报文"><br> 这里的部分由IPv6首部+前8字节组成</p> 
<p>代码值：</p> 
<ul><li>0：超出跳数限制（数据包的跳数值为0）</li><li>1：分片重组超时（IPv6数据包在分片重组时超时）</li></ul> 
<h5><a id="_439"></a>参数问题报文</h5> 
<ul><li>当IPv6数据报的基本首部出错时</li></ul> 
<p><img src="https://images2.imgbox.com/01/ca/bAvCNJtX_o.png" alt="参数问题报文"><br> 代码值：</p> 
<ul><li>0：IPv6包头参数错误</li><li>1：未识别的&lt; Next Header&gt;类型</li><li>2：未识别的IPv6可选项</li><li>3：第一个分片包中包头数据不完整</li></ul> 
<h5><a id="_449"></a>改变路由报文</h5> 
<ul><li>网络拓扑变化时，用于更新主机的路由表</li></ul> 
<p><img src="https://images2.imgbox.com/17/b1/sGzFqrFB_o.png" alt="改变路由报文"></p> 
<h4><a id="3ICMPv4_453"></a>3种请求应答类ICMPv4报文（路由询问/通告报文，邻居询问/通告报文）</h4> 
<table><thead><tr><th>类型值</th><th>报文类型</th></tr></thead><tbody><tr><td>128</td><td>Echo请求</td></tr><tr><td>129</td><td>Echo应答</td></tr><tr><td>133</td><td>路由询问</td></tr><tr><td>134</td><td>路由通告</td></tr><tr><td>135</td><td>邻居询问</td></tr><tr><td>136</td><td>邻居通告</td></tr></tbody></table> 
<h5><a id="Echo_463"></a>Echo请求/应答报文</h5> 
<ul><li>检测两个节点之间的网络连通性</li></ul> 
<p><img src="https://images2.imgbox.com/10/b4/mNZHrklu_o.png" alt="ECHO请求应答报文"><br> 一对应答请求报文的数据部分的值都是一样的</p> 
<h5><a id="_469"></a>路由器询问/通告报文</h5> 
<ul><li>主机发送路由器询问报文寻找默认路由器</li><li>路由器发送路由器通告报文进行响应或定期通告</li></ul> 
<p><img src="https://images2.imgbox.com/f7/c7/Xkwc1dlD_o.png" alt="路由器询问/通告报文"><br> 两种使用情况：</p> 
<ol><li>移动网络有新的设备接入的时候使用</li><li>有线环境的使用</li></ol> 
<h5><a id="_478"></a>邻居询问/通告报文</h5> 
<ul><li>作用与ARP相同</li></ul> 
<p><img src="https://images2.imgbox.com/55/5a/ceioMsVz_o.png" alt="邻居询问/通告报文"><br> 源主机向目的主机发送报文时需要知道MAC地址，IPv4中的ARP是广播的，但是IPv6没有广播，就需要邻居询问/通告报文通过组播来发送。<br> <img src="https://images2.imgbox.com/f0/96/I2p3OmWG_o.png" alt="实例"></p> 
<h2><a id="_UDP_484"></a>第六章 UDP</h2> 
<h3><a id="_485"></a>熟知端口号</h3> 
<table><thead><tr><th>服务</th><th>端口号</th></tr></thead><tbody><tr><td>DNS</td><td>53</td></tr><tr><td>DHCP</td><td>67/68</td></tr><tr><td>TFTP（简单文件传输协议）</td><td>69</td></tr><tr><td>SNMP（网络管理协议）</td><td>161</td></tr><tr><td>RIP</td><td>520</td></tr></tbody></table> 
<h3><a id="UDP_494"></a>UDP首部*</h3> 
<p><img src="https://images2.imgbox.com/8a/2e/ITehml4B_o.png" alt="UDP分组格式"><br> <strong>问</strong>：长度的范围是多少?<br> <strong>答</strong>：8~65535。因为UDP必须要首部，但可以不要数据。于是至少就有8个字节，长度字段就两个字节，于是对应长度最长为65535字节</p> 
<h3><a id="UDP_499"></a>UDP检验的两种方案</h3> 
<p>UDP校验的两种方案：</p> 
<ul><li>使用校验和</li><li>不使用校验和（校验和字段为0）</li></ul> 
<p>UDP接收方检测到校验和有差错时，将<strong>丢弃</strong>整个UDP报文段</p> 
<p>UDP-Lite标准：</p> 
<ul><li>首部必须使用校验和</li><li>数据部分可<strong>部分地</strong>使用校验和</li></ul> 
<p><strong>问题</strong>：使用校验和时，发送方计算出来的校验和为0，如何处理？<br> <strong>答</strong>：填入65535来防止接收方混淆；不存在求和结果为0，所以不存在求反后为65535</p> 
<h3><a id="UDPLite_512"></a>UDP-Lite的检验和及“检验和覆盖”字段的取值*</h3> 
<p><img src="https://images2.imgbox.com/e7/22/Ee44kNJe_o.png" alt="UDP-Lite分组"></p> 
<ul><li>UDP分组的长度字段是冗余的，不需要整个字段也可以算出来</li><li>校验和覆盖：指校验的范围，取值范围：0或&gt;=8，等于0时校验整个UDP分组</li><li>使用UDP和UDP-Lite时，应用层使用的端口号不变，但此时IP首部中的协议字段的值是136（UDP是17）</li></ul> 
<h3><a id="UDP_519"></a>如何判断目标主机的某个UDP端口是否开放*</h3> 
<ol><li>如果udp监听端口开启，在监听范围，就不会回复ICMP包</li><li>netcat会连续相监听端口发送五个探测包，udp报文数据区带一个字符’X’</li><li>如果没有收到目标主机的回复，netcat认为远端监听的端口开启</li></ol> 
<p>找到的较多都是用nc这个软件实现的，判断的关键在于<strong>是否回复icmp包</strong></p> 
<h2><a id="_TCP_525"></a>第七章 TCP</h2> 
<h3><a id="UDPTCP_526"></a>理解UDP面向报文、TCP面向字节流</h3> 
<p><strong>UDP</strong>是面向报文的，发送方的UDP对应用层交下来的报文，不合并，不拆分，只是在其上面加上首部后就交给了下面的网络层，也就是说无论应用层交给UDP多长的报文，它统统发送，一次发送一个。而对接收方，接到后直接去除首部，交给上面的应用层就完成任务了。因此，它需要应用层控制报文的大小<br> <strong>TCP</strong>是面向字节流的，它把上面应用层交下来的数据看成无结构的字节流来发送，可以想象成流水形式的，发送方TCP会将数据放入“蓄水池”（缓存区），等到可以发送的时候就发送，不能发送就等着，TCP会根据当前网络的拥塞状态来确定每个报文段的大小。</p> 
<h3><a id="TCP_529"></a>标识TCP连接的四元组</h3> 
<div class="mermaid"> 
 <svg id="mermaid-svg-cKjPRyT4oh40egdI" width="400.6400146484375" xmlns="http://www.w3.org/2000/svg" height="132.63999938964844" viewbox="0 0.000003814697265625 400.6400146484375 132.63999938964844"> 
  <style>#mermaid-svg-cKjPRyT4oh40egdI .label{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);fill:#333;color:#333}#mermaid-svg-cKjPRyT4oh40egdI .label text{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .node rect,#mermaid-svg-cKjPRyT4oh40egdI .node circle,#mermaid-svg-cKjPRyT4oh40egdI .node ellipse,#mermaid-svg-cKjPRyT4oh40egdI .node polygon,#mermaid-svg-cKjPRyT4oh40egdI .node path{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-svg-cKjPRyT4oh40egdI .node .label{text-align:center;fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .node.clickable{cursor:pointer}#mermaid-svg-cKjPRyT4oh40egdI .arrowheadPath{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-svg-cKjPRyT4oh40egdI .flowchart-link{stroke:#333;fill:none}#mermaid-svg-cKjPRyT4oh40egdI .edgeLabel{background-color:#e8e8e8;text-align:center}#mermaid-svg-cKjPRyT4oh40egdI .edgeLabel rect{opacity:0.9}#mermaid-svg-cKjPRyT4oh40egdI .edgeLabel span{color:#333}#mermaid-svg-cKjPRyT4oh40egdI .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#mermaid-svg-cKjPRyT4oh40egdI .cluster text{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-svg-cKjPRyT4oh40egdI .actor{stroke:#ccf;fill:#ECECFF}#mermaid-svg-cKjPRyT4oh40egdI text.actor&gt;tspan{fill:#000;stroke:none}#mermaid-svg-cKjPRyT4oh40egdI .actor-line{stroke:grey}#mermaid-svg-cKjPRyT4oh40egdI .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-svg-cKjPRyT4oh40egdI .messageLine1{stroke-width:1.5;stroke-dasharray:2, 2;stroke:#333}#mermaid-svg-cKjPRyT4oh40egdI #arrowhead path{fill:#333;stroke:#333}#mermaid-svg-cKjPRyT4oh40egdI .sequenceNumber{fill:#fff}#mermaid-svg-cKjPRyT4oh40egdI #sequencenumber{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI #crosshead path{fill:#333;stroke:#333}#mermaid-svg-cKjPRyT4oh40egdI .messageText{fill:#333;stroke:#333}#mermaid-svg-cKjPRyT4oh40egdI .labelBox{stroke:#ccf;fill:#ECECFF}#mermaid-svg-cKjPRyT4oh40egdI .labelText,#mermaid-svg-cKjPRyT4oh40egdI .labelText&gt;tspan{fill:#000;stroke:none}#mermaid-svg-cKjPRyT4oh40egdI .loopText,#mermaid-svg-cKjPRyT4oh40egdI .loopText&gt;tspan{fill:#000;stroke:none}#mermaid-svg-cKjPRyT4oh40egdI .loopLine{stroke-width:2px;stroke-dasharray:2, 2;stroke:#ccf;fill:#ccf}#mermaid-svg-cKjPRyT4oh40egdI .note{stroke:#aa3;fill:#fff5ad}#mermaid-svg-cKjPRyT4oh40egdI .noteText,#mermaid-svg-cKjPRyT4oh40egdI .noteText&gt;tspan{fill:#000;stroke:none}#mermaid-svg-cKjPRyT4oh40egdI .activation0{fill:#f4f4f4;stroke:#666}#mermaid-svg-cKjPRyT4oh40egdI .activation1{fill:#f4f4f4;stroke:#666}#mermaid-svg-cKjPRyT4oh40egdI .activation2{fill:#f4f4f4;stroke:#666}#mermaid-svg-cKjPRyT4oh40egdI .mermaid-main-font{font-family:"trebuchet ms", verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .section{stroke:none;opacity:0.2}#mermaid-svg-cKjPRyT4oh40egdI .section0{fill:rgba(102,102,255,0.49)}#mermaid-svg-cKjPRyT4oh40egdI .section2{fill:#fff400}#mermaid-svg-cKjPRyT4oh40egdI .section1,#mermaid-svg-cKjPRyT4oh40egdI .section3{fill:#fff;opacity:0.2}#mermaid-svg-cKjPRyT4oh40egdI .sectionTitle0{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .sectionTitle1{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .sectionTitle2{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .sectionTitle3{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .sectionTitle{text-anchor:start;font-size:11px;text-height:14px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .grid .tick{stroke:#d3d3d3;opacity:0.8;shape-rendering:crispEdges}#mermaid-svg-cKjPRyT4oh40egdI .grid .tick text{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .grid path{stroke-width:0}#mermaid-svg-cKjPRyT4oh40egdI .today{fill:none;stroke:red;stroke-width:2px}#mermaid-svg-cKjPRyT4oh40egdI .task{stroke-width:2}#mermaid-svg-cKjPRyT4oh40egdI .taskText{text-anchor:middle;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .taskText:not([font-size]){font-size:11px}#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-svg-cKjPRyT4oh40egdI .task.clickable{cursor:pointer}#mermaid-svg-cKjPRyT4oh40egdI .taskText.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-svg-cKjPRyT4oh40egdI .taskText0,#mermaid-svg-cKjPRyT4oh40egdI .taskText1,#mermaid-svg-cKjPRyT4oh40egdI .taskText2,#mermaid-svg-cKjPRyT4oh40egdI .taskText3{fill:#fff}#mermaid-svg-cKjPRyT4oh40egdI .task0,#mermaid-svg-cKjPRyT4oh40egdI .task1,#mermaid-svg-cKjPRyT4oh40egdI .task2,#mermaid-svg-cKjPRyT4oh40egdI .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutside0,#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutside2{fill:#000}#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutside1,#mermaid-svg-cKjPRyT4oh40egdI .taskTextOutside3{fill:#000}#mermaid-svg-cKjPRyT4oh40egdI .active0,#mermaid-svg-cKjPRyT4oh40egdI .active1,#mermaid-svg-cKjPRyT4oh40egdI .active2,#mermaid-svg-cKjPRyT4oh40egdI .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-svg-cKjPRyT4oh40egdI .activeText0,#mermaid-svg-cKjPRyT4oh40egdI .activeText1,#mermaid-svg-cKjPRyT4oh40egdI .activeText2,#mermaid-svg-cKjPRyT4oh40egdI .activeText3{fill:#000 !important}#mermaid-svg-cKjPRyT4oh40egdI .done0,#mermaid-svg-cKjPRyT4oh40egdI .done1,#mermaid-svg-cKjPRyT4oh40egdI .done2,#mermaid-svg-cKjPRyT4oh40egdI .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-svg-cKjPRyT4oh40egdI .doneText0,#mermaid-svg-cKjPRyT4oh40egdI .doneText1,#mermaid-svg-cKjPRyT4oh40egdI .doneText2,#mermaid-svg-cKjPRyT4oh40egdI .doneText3{fill:#000 !important}#mermaid-svg-cKjPRyT4oh40egdI .crit0,#mermaid-svg-cKjPRyT4oh40egdI .crit1,#mermaid-svg-cKjPRyT4oh40egdI .crit2,#mermaid-svg-cKjPRyT4oh40egdI .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-svg-cKjPRyT4oh40egdI .activeCrit0,#mermaid-svg-cKjPRyT4oh40egdI .activeCrit1,#mermaid-svg-cKjPRyT4oh40egdI .activeCrit2,#mermaid-svg-cKjPRyT4oh40egdI .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-svg-cKjPRyT4oh40egdI .doneCrit0,#mermaid-svg-cKjPRyT4oh40egdI .doneCrit1,#mermaid-svg-cKjPRyT4oh40egdI .doneCrit2,#mermaid-svg-cKjPRyT4oh40egdI .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-svg-cKjPRyT4oh40egdI .milestone{transform:rotate(45deg) scale(0.8, 0.8)}#mermaid-svg-cKjPRyT4oh40egdI .milestoneText{font-style:italic}#mermaid-svg-cKjPRyT4oh40egdI .doneCritText0,#mermaid-svg-cKjPRyT4oh40egdI .doneCritText1,#mermaid-svg-cKjPRyT4oh40egdI .doneCritText2,#mermaid-svg-cKjPRyT4oh40egdI .doneCritText3{fill:#000 !important}#mermaid-svg-cKjPRyT4oh40egdI .activeCritText0,#mermaid-svg-cKjPRyT4oh40egdI .activeCritText1,#mermaid-svg-cKjPRyT4oh40egdI .activeCritText2,#mermaid-svg-cKjPRyT4oh40egdI .activeCritText3{fill:#000 !important}#mermaid-svg-cKjPRyT4oh40egdI .titleText{text-anchor:middle;font-size:18px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:10px}#mermaid-svg-cKjPRyT4oh40egdI g.classGroup text .title{font-weight:bolder}#mermaid-svg-cKjPRyT4oh40egdI g.clickable{cursor:pointer}#mermaid-svg-cKjPRyT4oh40egdI g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-svg-cKjPRyT4oh40egdI g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-svg-cKjPRyT4oh40egdI .classLabel .label{fill:#9370db;font-size:10px}#mermaid-svg-cKjPRyT4oh40egdI .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-svg-cKjPRyT4oh40egdI .dashed-line{stroke-dasharray:3}#mermaid-svg-cKjPRyT4oh40egdI #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI .commit-id,#mermaid-svg-cKjPRyT4oh40egdI .commit-msg,#mermaid-svg-cKjPRyT4oh40egdI .branch-label{fill:lightgrey;color:lightgrey;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .pieTitleText{text-anchor:middle;font-size:25px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .slice{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI g.stateGroup text{fill:#9370db;stroke:none;font-size:10px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI g.stateGroup text{fill:#9370db;fill:#333;stroke:none;font-size:10px}#mermaid-svg-cKjPRyT4oh40egdI g.statediagram-cluster .cluster-label text{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI g.stateGroup .state-title{font-weight:bolder;fill:#000}#mermaid-svg-cKjPRyT4oh40egdI g.stateGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-svg-cKjPRyT4oh40egdI g.stateGroup line{stroke:#9370db;stroke-width:1}#mermaid-svg-cKjPRyT4oh40egdI .transition{stroke:#9370db;stroke-width:1;fill:none}#mermaid-svg-cKjPRyT4oh40egdI .stateGroup .composit{fill:white;border-bottom:1px}#mermaid-svg-cKjPRyT4oh40egdI .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px}#mermaid-svg-cKjPRyT4oh40egdI .state-note{stroke:#aa3;fill:#fff5ad}#mermaid-svg-cKjPRyT4oh40egdI .state-note text{fill:black;stroke:none;font-size:10px}#mermaid-svg-cKjPRyT4oh40egdI .stateLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.7}#mermaid-svg-cKjPRyT4oh40egdI .edgeLabel text{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .stateLabel text{fill:#000;font-size:10px;font-weight:bold;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-cKjPRyT4oh40egdI .node circle.state-start{fill:black;stroke:black}#mermaid-svg-cKjPRyT4oh40egdI .node circle.state-end{fill:black;stroke:white;stroke-width:1.5}#mermaid-svg-cKjPRyT4oh40egdI #statediagram-barbEnd{fill:#9370db}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-cluster rect{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-cluster rect.outer{rx:5px;ry:5px}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-state .divider{stroke:#9370db}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-state .title-state{rx:5px;ry:5px}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-cluster.statediagram-cluster .inner{fill:white}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-cluster.statediagram-cluster-alt .inner{fill:#e0e0e0}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-cluster .inner{rx:0;ry:0}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-state rect.basic{rx:5px;ry:5px}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#efefef}#mermaid-svg-cKjPRyT4oh40egdI .note-edge{stroke-dasharray:5}#mermaid-svg-cKjPRyT4oh40egdI .statediagram-note rect{fill:#fff5ad;stroke:#aa3;stroke-width:1px;rx:0;ry:0}:root{--mermaid-font-family: '"trebuchet ms", verdana, arial';--mermaid-font-family: "Comic Sans MS", "Comic Sans", cursive}#mermaid-svg-cKjPRyT4oh40egdI .error-icon{fill:#522}#mermaid-svg-cKjPRyT4oh40egdI .error-text{fill:#522;stroke:#522}#mermaid-svg-cKjPRyT4oh40egdI .edge-thickness-normal{stroke-width:2px}#mermaid-svg-cKjPRyT4oh40egdI .edge-thickness-thick{stroke-width:3.5px}#mermaid-svg-cKjPRyT4oh40egdI .edge-pattern-solid{stroke-dasharray:0}#mermaid-svg-cKjPRyT4oh40egdI .edge-pattern-dashed{stroke-dasharray:3}#mermaid-svg-cKjPRyT4oh40egdI .edge-pattern-dotted{stroke-dasharray:2}#mermaid-svg-cKjPRyT4oh40egdI .marker{fill:#333}#mermaid-svg-cKjPRyT4oh40egdI .marker.cross{stroke:#333}

:root { --mermaid-font-family: "trebuchet ms", verdana, arial;}</style> 
  <style>#mermaid-svg-cKjPRyT4oh40egdI {
    color: rgba(0, 0, 0, 0.75);
    font: ;
  }</style> 
  <g> 
   <g class="output"> 
    <g class="clusters"></g> 
    <g class="edgePaths"> 
     <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"> 
      <path class="path" d="M92,66.31999969482422L117,66.31999969482422L142,66.31999969482422" marker-end="url(#arrowhead38)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead38" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-B LE-D" style="opacity: 1;" id="L-B-D"> 
      <path class="path" d="M226,66.31999969482422L251,66.31999969482422L276.50000047683716,66.81999969482422" marker-end="url(#arrowhead39)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead39" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel" transform="" style="opacity: 1;"> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8;"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8;"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-B-D" class="edgeLabel L-LS-B' L-LE-D"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" id="A" transform="translate(50,66.31999969482422)" style="opacity: 1;"> 
      <rect rx="0" ry="0" x="-42" y="-22.800000190734863" width="84" height="45.60000038146973" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-32,-12.800000190734863)"> 
        <foreignobject width="64" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           建立连接 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="B" transform="translate(184,66.31999969482422)"> 
      <circle x="-42" y="-22.800000190734863" r="42" class="label-container"></circle> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-32,-12.800000190734863)"> 
        <foreignobject width="64" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           数据传输 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="D" transform="translate(334.3199996948242,66.31999969482422)"> 
      <polygon points="58.32000017166138,0 116.64000034332275,-58.32000017166138 58.32000017166138,-116.64000034332275 0,-58.32000017166138" transform="translate(-58.32000017166138,58.32000017166138)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-32,-12.800000190734863)"> 
        <foreignobject width="64" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           释放连接 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<p><strong>Q1</strong>：标识一个TCP连接的参数有哪些?<br> <strong>A1</strong>：源IP，源端口，目的IP，目的端口</p> 
<p><strong>Q2</strong>：广播和组播应用可以使用TCP吗？<br> <strong>A2</strong>：TCP连接是一对一的，所以是不能使用的</p> 
<h3><a id="TCP_541"></a>TCP建立连接*</h3> 
<p><img src="https://images2.imgbox.com/72/55/pfaDmLFe_o.png" alt="TCP三握手"><br> 初始序号会随时间而改变，因此每个连接都将具有不同的初始序号，且同一次连接中x，y的值是没有关系的。目的是在于防止在网络中被延迟的分组在以后又被传送，而导致某个连接的一方对它做错误的解释。<br> 三次握手的其中一个重要功能是客户端和服务端交换初始序号，以便让对方知道接下来接收数据的时候如何按序列号组装数据。如果初始序号是固定的，攻击者很容易猜出后续的确认号</p> 
<h3><a id="SYN_545"></a>SYN洪泛攻击*</h3> 
<p><img src="https://images2.imgbox.com/c0/48/kD3f9ZVY_o.png" alt="SYN洪泛攻击"></p> 
<ol><li>攻击者发送大量SYN报文段，且伪造源IP</li><li>服务器分配资源，设置计时器，返回SYN+ACK报文段，等待第三个握手报文</li><li>服务器在等待的时间里需要保持大量资源</li></ol> 
<h3><a id="TCP_550"></a>TCP端口扫描*</h3> 
<p>源主机向目标主机的某个TCP端口发送一个SYN报文段，若源主机：</p> 
<ul><li>收到一个SYN+ACK报文段，表示目标主机的该端口处于监听状态</li><li>收到一个是RST报文段，表示目标主机的该TCP端口关闭</li><li>什么也没收到，表示该SYN报文段被防火墙过滤，无法到达目标主机</li></ul> 
<h3><a id="_555"></a>发送缓存与接收缓存的作用</h3> 
<p><img src="https://images2.imgbox.com/d0/24/furj9sc9_o.png" alt="发送缓存"><br> 发送缓存包含：</p> 
<ol><li>发送方TCP准备发送的数据</li><li>已发送出去，但尚未收到确认的数据</li></ol> 
<p><img src="https://images2.imgbox.com/29/82/395nahon_o.png" alt="接收缓存"><br> 接收缓存包含：</p> 
<ol><li>按序到达的、已确认但尚未被应用程序提取的数据</li><li>可能失序到达的数据</li></ol> 
<h3><a id="TCP_565"></a>TCP流量控制（序号、确认号、窗口、死锁现象、糊涂现象）</h3> 
<ul><li>流量控制：发送方根据接收方给定的“窗口尺寸”，来调整发出报文段的大小</li><li>全双工：通信双方都有发送缓存和接收缓存，建立连接后，双方可同时发送数据和接收数据</li></ul> 
<h4><a id="_569"></a>序号与确认号</h4> 
<p>TCP报文段的序号=该TCP报文段<strong>第一个数据字节的编号</strong><br> <strong>确认号是</strong>对收到的数据字节的确认，表示期望收到的下一个报文段中第一个数据字节的编号<br> 确认号 = 收到的最后一个字节编号 +1</p> 
<p><strong>例子</strong>：主机A收到B发送过来的TCP报文段中包含200字节数据，且ACK=1，序号=3670，确认号=5643.</p> 
<p><strong>Q1</strong>：A发给B的TCP报文段中序号和确认号是多少？<br> <strong>答</strong>：序号=5643，确认号=3670+200=3870</p> 
<p><strong>Q2</strong>：表示B已收到5643字节的数据？<br> <strong>答</strong>：表示B收到（初始序号+1 ~ 5642）的所有字节，需要注意的是<strong>初始序号从0~(2^32 - 1)中随机选择</strong></p> 
<h4><a id="_582"></a>窗口尺寸</h4> 
<p>窗口尺寸：指接收缓存空闲空间的大小，由接收方指定<br> <img src="https://images2.imgbox.com/89/0a/tB45GvXu_o.png" alt="窗口尺寸"></p> 
<h4><a id="_586"></a>死锁现象</h4> 
<p><img src="https://images2.imgbox.com/24/17/vVPIfHPm_o.png" alt="TCP传输数据过程"><br> <strong>问</strong>：如果上图中的第8个报文丢失会造成什么现象？怎么解决？<br> <strong>答</strong>：因为发送方收到第7个报文后不能发送数据，要一直等待第8个报文的到来才开始送数据。而接收方发出第8个报文后一直在等待数据的到来，却迟迟收不到，形成了<strong>死锁现象</strong>。<br> 发送方过一定时间未收到第8个报文，会发送一个探测报文出去，探测一下现在接收方的窗口值。<br> 接收方送出第8个报文后，过一段时间未收到数据，会重传该报文（有一种特殊情况就是如果发送方已经没有数据发送了，这时接收方一直收不到数据）。</p> 
<h4><a id="_592"></a>糊涂窗口现象</h4> 
<p><strong>糊涂窗口综合症的产生</strong>：由于发送方产生数据慢，或者接收方处理接收缓冲区数据慢，导致传输报文段的有效载荷小的情况。</p> 
<p><strong>解决</strong>：发送方产生数据慢造成的，启用Nagle算法，使TCP连接上只有一个未被确认的分组，从而强迫发送端收集数据形成大的报文段发送。</p> 
<p>接收端处理缓冲区慢造成的，一是通过宣布窗口大小为0解决，或是通过延时确认解决。</p> 
<h3><a id="_598"></a>四个计时器</h3> 
<h4><a id="1__599"></a>1 超时重传计时器</h4> 
<p>作用：解决报文段丢失问题<br> 是个变化值，TCP发送方每发送一个报文段，启动超时重传计时器，到期未收到确认，重传<br> <img src="https://images2.imgbox.com/64/a0/FAlFgPgC_o.png" alt="自适应算法"></p> 
<h4><a id="2__604"></a>2 坚持计时器</h4> 
<p>作用：解决死锁等待问题</p> 
<h4><a id="3__606"></a>3 时间等待计时器</h4> 
<p><img src="https://images2.imgbox.com/ff/47/lKunaOra_o.png" alt="时间等待计时器"><br> 作用：解决因最后一个挥手报文段丢失而使TCP连接释放失败的问题<br> 2MSL，一般1个MSL设为2分钟</p> 
<h4><a id="4__610"></a>4 保活计时器</h4> 
<p>作用：防止TCP连接处于长时间的空闲</p> 
<ul><li>每当服务器收到客户的数据，就启动保活计时器</li><li>到期没收到客户数据，就发送一个探测报文，连续（间隔75秒）探测10次后关闭这个连接</li></ul> 
<h3><a id="_614"></a>三种确认机制</h3> 
<div class="mermaid"> 
 <svg id="mermaid-svg-LJTXf70JNBCtnHiQ" width="205.83999633789062" xmlns="http://www.w3.org/2000/svg" height="429.0400085449219" viewbox="0 0 205.83999633789062 429.0400085449219"> 
  <style>#mermaid-svg-LJTXf70JNBCtnHiQ .label{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);fill:#333;color:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .label text{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .node rect,#mermaid-svg-LJTXf70JNBCtnHiQ .node circle,#mermaid-svg-LJTXf70JNBCtnHiQ .node ellipse,#mermaid-svg-LJTXf70JNBCtnHiQ .node polygon,#mermaid-svg-LJTXf70JNBCtnHiQ .node path{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-svg-LJTXf70JNBCtnHiQ .node .label{text-align:center;fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .node.clickable{cursor:pointer}#mermaid-svg-LJTXf70JNBCtnHiQ .arrowheadPath{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-svg-LJTXf70JNBCtnHiQ .flowchart-link{stroke:#333;fill:none}#mermaid-svg-LJTXf70JNBCtnHiQ .edgeLabel{background-color:#e8e8e8;text-align:center}#mermaid-svg-LJTXf70JNBCtnHiQ .edgeLabel rect{opacity:0.9}#mermaid-svg-LJTXf70JNBCtnHiQ .edgeLabel span{color:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#mermaid-svg-LJTXf70JNBCtnHiQ .cluster text{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-svg-LJTXf70JNBCtnHiQ .actor{stroke:#ccf;fill:#ECECFF}#mermaid-svg-LJTXf70JNBCtnHiQ text.actor&gt;tspan{fill:#000;stroke:none}#mermaid-svg-LJTXf70JNBCtnHiQ .actor-line{stroke:grey}#mermaid-svg-LJTXf70JNBCtnHiQ .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .messageLine1{stroke-width:1.5;stroke-dasharray:2, 2;stroke:#333}#mermaid-svg-LJTXf70JNBCtnHiQ #arrowhead path{fill:#333;stroke:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .sequenceNumber{fill:#fff}#mermaid-svg-LJTXf70JNBCtnHiQ #sequencenumber{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ #crosshead path{fill:#333;stroke:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .messageText{fill:#333;stroke:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .labelBox{stroke:#ccf;fill:#ECECFF}#mermaid-svg-LJTXf70JNBCtnHiQ .labelText,#mermaid-svg-LJTXf70JNBCtnHiQ .labelText&gt;tspan{fill:#000;stroke:none}#mermaid-svg-LJTXf70JNBCtnHiQ .loopText,#mermaid-svg-LJTXf70JNBCtnHiQ .loopText&gt;tspan{fill:#000;stroke:none}#mermaid-svg-LJTXf70JNBCtnHiQ .loopLine{stroke-width:2px;stroke-dasharray:2, 2;stroke:#ccf;fill:#ccf}#mermaid-svg-LJTXf70JNBCtnHiQ .note{stroke:#aa3;fill:#fff5ad}#mermaid-svg-LJTXf70JNBCtnHiQ .noteText,#mermaid-svg-LJTXf70JNBCtnHiQ .noteText&gt;tspan{fill:#000;stroke:none}#mermaid-svg-LJTXf70JNBCtnHiQ .activation0{fill:#f4f4f4;stroke:#666}#mermaid-svg-LJTXf70JNBCtnHiQ .activation1{fill:#f4f4f4;stroke:#666}#mermaid-svg-LJTXf70JNBCtnHiQ .activation2{fill:#f4f4f4;stroke:#666}#mermaid-svg-LJTXf70JNBCtnHiQ .mermaid-main-font{font-family:"trebuchet ms", verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .section{stroke:none;opacity:0.2}#mermaid-svg-LJTXf70JNBCtnHiQ .section0{fill:rgba(102,102,255,0.49)}#mermaid-svg-LJTXf70JNBCtnHiQ .section2{fill:#fff400}#mermaid-svg-LJTXf70JNBCtnHiQ .section1,#mermaid-svg-LJTXf70JNBCtnHiQ .section3{fill:#fff;opacity:0.2}#mermaid-svg-LJTXf70JNBCtnHiQ .sectionTitle0{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .sectionTitle1{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .sectionTitle2{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .sectionTitle3{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .sectionTitle{text-anchor:start;font-size:11px;text-height:14px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .grid .tick{stroke:#d3d3d3;opacity:0.8;shape-rendering:crispEdges}#mermaid-svg-LJTXf70JNBCtnHiQ .grid .tick text{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .grid path{stroke-width:0}#mermaid-svg-LJTXf70JNBCtnHiQ .today{fill:none;stroke:red;stroke-width:2px}#mermaid-svg-LJTXf70JNBCtnHiQ .task{stroke-width:2}#mermaid-svg-LJTXf70JNBCtnHiQ .taskText{text-anchor:middle;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .taskText:not([font-size]){font-size:11px}#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-svg-LJTXf70JNBCtnHiQ .task.clickable{cursor:pointer}#mermaid-svg-LJTXf70JNBCtnHiQ .taskText.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-svg-LJTXf70JNBCtnHiQ .taskText0,#mermaid-svg-LJTXf70JNBCtnHiQ .taskText1,#mermaid-svg-LJTXf70JNBCtnHiQ .taskText2,#mermaid-svg-LJTXf70JNBCtnHiQ .taskText3{fill:#fff}#mermaid-svg-LJTXf70JNBCtnHiQ .task0,#mermaid-svg-LJTXf70JNBCtnHiQ .task1,#mermaid-svg-LJTXf70JNBCtnHiQ .task2,#mermaid-svg-LJTXf70JNBCtnHiQ .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutside0,#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutside2{fill:#000}#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutside1,#mermaid-svg-LJTXf70JNBCtnHiQ .taskTextOutside3{fill:#000}#mermaid-svg-LJTXf70JNBCtnHiQ .active0,#mermaid-svg-LJTXf70JNBCtnHiQ .active1,#mermaid-svg-LJTXf70JNBCtnHiQ .active2,#mermaid-svg-LJTXf70JNBCtnHiQ .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-svg-LJTXf70JNBCtnHiQ .activeText0,#mermaid-svg-LJTXf70JNBCtnHiQ .activeText1,#mermaid-svg-LJTXf70JNBCtnHiQ .activeText2,#mermaid-svg-LJTXf70JNBCtnHiQ .activeText3{fill:#000 !important}#mermaid-svg-LJTXf70JNBCtnHiQ .done0,#mermaid-svg-LJTXf70JNBCtnHiQ .done1,#mermaid-svg-LJTXf70JNBCtnHiQ .done2,#mermaid-svg-LJTXf70JNBCtnHiQ .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-svg-LJTXf70JNBCtnHiQ .doneText0,#mermaid-svg-LJTXf70JNBCtnHiQ .doneText1,#mermaid-svg-LJTXf70JNBCtnHiQ .doneText2,#mermaid-svg-LJTXf70JNBCtnHiQ .doneText3{fill:#000 !important}#mermaid-svg-LJTXf70JNBCtnHiQ .crit0,#mermaid-svg-LJTXf70JNBCtnHiQ .crit1,#mermaid-svg-LJTXf70JNBCtnHiQ .crit2,#mermaid-svg-LJTXf70JNBCtnHiQ .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-svg-LJTXf70JNBCtnHiQ .activeCrit0,#mermaid-svg-LJTXf70JNBCtnHiQ .activeCrit1,#mermaid-svg-LJTXf70JNBCtnHiQ .activeCrit2,#mermaid-svg-LJTXf70JNBCtnHiQ .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-svg-LJTXf70JNBCtnHiQ .doneCrit0,#mermaid-svg-LJTXf70JNBCtnHiQ .doneCrit1,#mermaid-svg-LJTXf70JNBCtnHiQ .doneCrit2,#mermaid-svg-LJTXf70JNBCtnHiQ .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-svg-LJTXf70JNBCtnHiQ .milestone{transform:rotate(45deg) scale(0.8, 0.8)}#mermaid-svg-LJTXf70JNBCtnHiQ .milestoneText{font-style:italic}#mermaid-svg-LJTXf70JNBCtnHiQ .doneCritText0,#mermaid-svg-LJTXf70JNBCtnHiQ .doneCritText1,#mermaid-svg-LJTXf70JNBCtnHiQ .doneCritText2,#mermaid-svg-LJTXf70JNBCtnHiQ .doneCritText3{fill:#000 !important}#mermaid-svg-LJTXf70JNBCtnHiQ .activeCritText0,#mermaid-svg-LJTXf70JNBCtnHiQ .activeCritText1,#mermaid-svg-LJTXf70JNBCtnHiQ .activeCritText2,#mermaid-svg-LJTXf70JNBCtnHiQ .activeCritText3{fill:#000 !important}#mermaid-svg-LJTXf70JNBCtnHiQ .titleText{text-anchor:middle;font-size:18px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:10px}#mermaid-svg-LJTXf70JNBCtnHiQ g.classGroup text .title{font-weight:bolder}#mermaid-svg-LJTXf70JNBCtnHiQ g.clickable{cursor:pointer}#mermaid-svg-LJTXf70JNBCtnHiQ g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-svg-LJTXf70JNBCtnHiQ g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-svg-LJTXf70JNBCtnHiQ .classLabel .label{fill:#9370db;font-size:10px}#mermaid-svg-LJTXf70JNBCtnHiQ .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-svg-LJTXf70JNBCtnHiQ .dashed-line{stroke-dasharray:3}#mermaid-svg-LJTXf70JNBCtnHiQ #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ .commit-id,#mermaid-svg-LJTXf70JNBCtnHiQ .commit-msg,#mermaid-svg-LJTXf70JNBCtnHiQ .branch-label{fill:lightgrey;color:lightgrey;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .pieTitleText{text-anchor:middle;font-size:25px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .slice{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ g.stateGroup text{fill:#9370db;stroke:none;font-size:10px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ g.stateGroup text{fill:#9370db;fill:#333;stroke:none;font-size:10px}#mermaid-svg-LJTXf70JNBCtnHiQ g.statediagram-cluster .cluster-label text{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ g.stateGroup .state-title{font-weight:bolder;fill:#000}#mermaid-svg-LJTXf70JNBCtnHiQ g.stateGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-svg-LJTXf70JNBCtnHiQ g.stateGroup line{stroke:#9370db;stroke-width:1}#mermaid-svg-LJTXf70JNBCtnHiQ .transition{stroke:#9370db;stroke-width:1;fill:none}#mermaid-svg-LJTXf70JNBCtnHiQ .stateGroup .composit{fill:white;border-bottom:1px}#mermaid-svg-LJTXf70JNBCtnHiQ .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px}#mermaid-svg-LJTXf70JNBCtnHiQ .state-note{stroke:#aa3;fill:#fff5ad}#mermaid-svg-LJTXf70JNBCtnHiQ .state-note text{fill:black;stroke:none;font-size:10px}#mermaid-svg-LJTXf70JNBCtnHiQ .stateLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.7}#mermaid-svg-LJTXf70JNBCtnHiQ .edgeLabel text{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .stateLabel text{fill:#000;font-size:10px;font-weight:bold;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-svg-LJTXf70JNBCtnHiQ .node circle.state-start{fill:black;stroke:black}#mermaid-svg-LJTXf70JNBCtnHiQ .node circle.state-end{fill:black;stroke:white;stroke-width:1.5}#mermaid-svg-LJTXf70JNBCtnHiQ #statediagram-barbEnd{fill:#9370db}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-cluster rect{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-cluster rect.outer{rx:5px;ry:5px}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-state .divider{stroke:#9370db}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-state .title-state{rx:5px;ry:5px}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-cluster.statediagram-cluster .inner{fill:white}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-cluster.statediagram-cluster-alt .inner{fill:#e0e0e0}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-cluster .inner{rx:0;ry:0}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-state rect.basic{rx:5px;ry:5px}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#efefef}#mermaid-svg-LJTXf70JNBCtnHiQ .note-edge{stroke-dasharray:5}#mermaid-svg-LJTXf70JNBCtnHiQ .statediagram-note rect{fill:#fff5ad;stroke:#aa3;stroke-width:1px;rx:0;ry:0}:root{--mermaid-font-family: '"trebuchet ms", verdana, arial';--mermaid-font-family: "Comic Sans MS", "Comic Sans", cursive}#mermaid-svg-LJTXf70JNBCtnHiQ .error-icon{fill:#522}#mermaid-svg-LJTXf70JNBCtnHiQ .error-text{fill:#522;stroke:#522}#mermaid-svg-LJTXf70JNBCtnHiQ .edge-thickness-normal{stroke-width:2px}#mermaid-svg-LJTXf70JNBCtnHiQ .edge-thickness-thick{stroke-width:3.5px}#mermaid-svg-LJTXf70JNBCtnHiQ .edge-pattern-solid{stroke-dasharray:0}#mermaid-svg-LJTXf70JNBCtnHiQ .edge-pattern-dashed{stroke-dasharray:3}#mermaid-svg-LJTXf70JNBCtnHiQ .edge-pattern-dotted{stroke-dasharray:2}#mermaid-svg-LJTXf70JNBCtnHiQ .marker{fill:#333}#mermaid-svg-LJTXf70JNBCtnHiQ .marker.cross{stroke:#333}

:root { --mermaid-font-family: "trebuchet ms", verdana, arial;}</style> 
  <style>#mermaid-svg-LJTXf70JNBCtnHiQ {
    color: rgba(0, 0, 0, 0.75);
    font: ;
  }</style> 
  <g> 
   <g class="output"> 
    <g class="clusters"></g> 
    <g class="edgePaths"> 
     <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"> 
      <path class="path" d="M40.715176496389134,200.36000061035156L85,50L111.92000198364258,50" marker-end="url(#arrowhead49)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead49" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-C" style="opacity: 1;" id="L-A-C"> 
      <path class="path" d="M53.924605019346714,200.36000061035156L85,164.79999923706055L127.92000198364258,164.79999923706055" marker-end="url(#arrowhead50)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead50" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-D" style="opacity: 1;" id="L-A-D"> 
      <path class="path" d="M53.924605019346714,245.95999908447266L85,281.5200004577637L110.50000181198124,282.0200004577637" marker-end="url(#arrowhead51)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead51" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-E" style="opacity: 1;" id="L-A-E"> 
      <path class="path" d="M40.641535006448905,245.95999908447266L85,398.2400016784668L127.92000198364258,398.2400016784668" marker-end="url(#arrowhead52)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead52" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path> 
       </marker> 
      </defs> 
     </g> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel" transform="" style="opacity: 1;"> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8;"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8;"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8;"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-D" class="edgeLabel L-LS-A' L-LE-D"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8;"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-E" class="edgeLabel L-LS-A' L-LE-E"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" id="A" transform="translate(34,223.1599998474121)" style="opacity: 1;"> 
      <rect rx="0" ry="0" x="-26" y="-22.800000190734863" width="52" height="45.60000038146973" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-16,-12.800000190734863)"> 
        <foreignobject width="32" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           差错 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="B" transform="translate(153.92000198364258,50)"> 
      <circle x="-42" y="-22.800000190734863" r="42" class="label-container"></circle> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-32,-12.800000190734863)"> 
        <foreignobject width="64" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           传输出错 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="C" transform="translate(153.92000198364258,164.79999923706055)"> 
      <rect rx="5" ry="5" x="-26" y="-22.800000190734863" width="52" height="45.60000038146973" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-16,-12.800000190734863)"> 
        <foreignobject width="32" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           丢失 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="D" transform="translate(153.92000198364258,281.5200004577637)"> 
      <polygon points="43.92000017166138,0 87.84000034332276,-43.92000017166138 43.92000017166138,-87.84000034332276 0,-43.92000017166138" transform="translate(-43.92000017166138,43.92000017166138)" class="label-container"></polygon> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-16,-12.800000190734863)"> 
        <foreignobject width="32" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           乱序 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="E" transform="translate(153.92000198364258,398.2400016784668)"> 
      <rect rx="5" ry="5" x="-26" y="-22.800000190734863" width="52" height="45.60000038146973" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-16,-12.800000190734863)"> 
        <foreignobject width="32" height="25.600000381469727"> 
         <div style="display: inline-block; white-space: nowrap;">
           重复 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<p>传输出错：检验和，丢失，不确认，超时重传<br> 丢失：超时重传<br> 乱序：缓存失序报文段，立即确认<br> 重复：丢弃，立即确认</p> 
<h4><a id="_627"></a>捎带确认</h4> 
<h4><a id="_628"></a>累积确认</h4> 
<p><img src="https://images2.imgbox.com/0e/99/HE51i9bC_o.png" alt="累积确认"></p> 
<ul><li>接收方在确认seq=100报文之前，收到seq=300报文段，则发回ack=500的确认。</li><li>收到两个连续报文段立即发送确认，或者等待500ms后发送确认</li></ul> 
<h5><a id="_633"></a>有丢失的累积确认</h5> 
<p><img src="https://images2.imgbox.com/bd/73/BgGd7Z7x_o.png" alt="有丢失的累积确认"><br> 当seq=300的报文段丢失，只能确认第一个报文段</p> 
<h5><a id="_637"></a>有重复的累积确认</h5> 
<p><img src="https://images2.imgbox.com/98/af/Qk8evjsH_o.png" alt="有重复的累积确认"></p> 
<h4><a id="_640"></a>选择确认</h4> 
<p><img src="https://images2.imgbox.com/2b/9c/2lauCFSz_o.png" alt="选择确认"><br> 对失序报文段的单独确认<br> 每个不连续的字节块有两个边界：左边界L和右边界R<br> TCP选择确认是可选项，在建立TCP连接时协商SACK选项</p> 
<h3><a id="TCP_646"></a>TCP选项</h3> 
<p><img src="https://images2.imgbox.com/d3/16/pbTNKctt_o.png" alt="TCP首部选项"></p> 
<h4><a id="_648"></a>选项结束选项</h4> 
<p>1字节，用作选项区结束时的填充<br> 只能用作最后一个选项，只能使用一次<br> <img src="https://images2.imgbox.com/bc/61/nfJEwGNC_o.png" alt="选项结束选项"></p> 
<h4><a id="_652"></a>无操作选项</h4> 
<p>1字节，用作选项和选项之间的填充符<br> <img src="https://images2.imgbox.com/c0/d6/jPMp63en_o.png" alt="无操作选项"></p> 
<h4><a id="MSS_655"></a>MSS选项</h4> 
<p>指TCP报文段中数据部分的最大长度<br> 在建立连接极端由双方协商，在连接期间保持不变<br> <img src="https://images2.imgbox.com/59/a7/oJQWsPBX_o.png" alt="MSS选项"></p> 
<h4><a id="_659"></a>窗口扩大选项</h4> 
<p>窗口尺寸：取值范围0~65535，在高速网络中可能不够用，受到MTU影响<br> 窗口扩大因子：在连接建立阶段确定，在连接期间保持不变<br> 新的窗口大小 = 窗口尺寸 * 2^扩大因子<br> <img src="https://images2.imgbox.com/9c/49/g2KL0DON_o.png" alt="窗口扩大因子选项"></p> 
<h4><a id="_664"></a>时间戳选项</h4> 
<p>作用：测量往返时间RTT；防止序号绕回<br> <img src="https://images2.imgbox.com/e1/12/vIDoRPyX_o.png" alt="时间戳选项"></p> 
<h4><a id="SACKSACK_667"></a>允许SACK选项和SACK选项</h4> 
<p><img src="https://images2.imgbox.com/83/87/xAtlBqj7_o.png" alt="允许SACK选项和SACK选项"></p> 
<ul><li>允许SACK选项：在建立连接阶段由双方协商</li><li>SACK选项：用于数据传输阶段</li><li>最多8个数据块</li></ul> 
<p>例子：<br> <img src="https://images2.imgbox.com/62/74/AVxvUhhB_o.png" alt="SACK选项例子"></p> 
<h2><a id="_SCTP_675"></a>第八章 SCTP</h2> 
<h3><a id="SCTP_676"></a>SCTP的特点</h3> 
<p><img src="https://images2.imgbox.com/93/32/NDbNRDYT_o.png" alt="SCTP的特点"><br> 流：指需要按顺序递交到高层协议的消息序列</p> 
<h3><a id="_679"></a>多宿主</h3> 
<p><img src="https://images2.imgbox.com/32/e4/RdLZXVJU_o.png" alt="多宿主"></p> 
<h3><a id="TCPSCTP_681"></a>TCP头端阻塞与SCTP多重流*</h3> 
<h4><a id="TCP_682"></a>TCP头端阻塞</h4> 
<p>采用HTTP/2时，浏览器一般会在单个TCP连接中创建并行的几十个乃至上百个传输。</p> 
<p>如果HTTP/2连接双方的网络中有一个数据包丢失，或者任何一方的网络出现中断，整个TCP连接就会暂停，丢失的数据包需要被重新传输。因为TCP是一个按序传输的链条，因此如果其中一个点丢失了，链路上之后的内容就都需要等待。</p> 
<p>这种单个数据包造成的阻塞，就是TCP上的队头阻塞</p> 
<p>详细见：<a href="https://www.cnblogs.com/cangqinglang/p/12402205.html" rel="nofollow">TCP队头阻塞</a></p> 
<h4><a id="SCTP_690"></a>SCTP多重流</h4> 
<p><img src="https://images2.imgbox.com/fd/74/8g6tuPdI_o.png" alt="多重流"><br> 每个流都是独立的，有各自的编号<br> 阻塞的流不会影响同一关联中的其他流，可以并行传输</p> 
<h3><a id="TCP_SYNSCTP_695"></a>TCP SYN洪泛攻击与SCTP初始化保护*</h3> 
<p><img src="https://images2.imgbox.com/6c/35/yC7WxU7g_o.png" alt="初始化保护"></p> 
<h3><a id="SCTP_697"></a>SCTP分组格式*</h3> 
<p><img src="https://images2.imgbox.com/35/d7/kMrmVLlS_o.png" alt="SCTP分组格式"></p> 
<h3><a id="_699"></a>块类型</h3> 
<p><img src="https://images2.imgbox.com/fc/36/GUwP87y3_o.png" alt="分组通用格式"><br> 在一个SCTP分组中，控制块位于数据块之前</p> 
<h5><a id="INIT_702"></a>INIT块</h5> 
<p><img src="https://images2.imgbox.com/1e/86/lneXKkZx_o.png" alt="INIT块"><br> 在四握手的第一个分组</p> 
<ul><li>初始标志：定义对方所发送分组的“验证标志”</li><li>窗口大小：即rwnd</li><li>输出流：关联的发起者在输出方向上建议的流个数</li><li>最大输入流：关联的发起者在输入方向上支持的最大流个数</li><li>初始TSN：相当于TCP的SYN报文段中的初始序号</li><li>携带INIT块的分组不能再携带其他块</li></ul> 
<h5><a id="INIT_ACK_712"></a>INIT ACK块</h5> 
<p><img src="https://images2.imgbox.com/aa/29/8nNUJoqV_o.png" alt="INIT ACK块"><br> 初始标志：定义对方所发送分组的“验证标志”<br> Cookie：服务器用自己的私钥生成<br> 携带INIT ACK块的分组不能再携带其他块</p> 
<h5><a id="COOKIE_ECHOACK_718"></a>COOKIE ECHO/ACK块</h5> 
<p><img src="https://images2.imgbox.com/c2/47/HhrmvgLU_o.png" alt="COOKIE"><br> 携带COOKIE ECHO/ACK块的分组可携带其他块</p> 
<h5><a id="_721"></a>建立关联</h5> 
<p><img src="https://images2.imgbox.com/74/22/v6shMY8w_o.png" alt="建立关联"><br> 两个验证标志（每个方向一个）标记一个关联</p> 
<h5><a id="DATA_724"></a>DATA块</h5> 
<p><img src="https://images2.imgbox.com/2d/c2/dIpHUY9k_o.png" alt="DATA块"></p> 
<ul><li>U=1时不使用SSN：不按序，类似TCP中的URG和紧急指针</li><li>B=1，开始位，E=1，结束位</li><li>长度：一个数据块至少携带1字节数据</li><li>协议标识符：定义数据的类型</li><li><img src="https://images2.imgbox.com/4e/85/dfUnarC5_o.png" alt="BE含义"></li></ul> 
<h5><a id="SACK_731"></a>SACK块</h5> 
<p><img src="https://images2.imgbox.com/8e/b9/87PbAj1v_o.png" alt="SACK块"><br> 累积TSN确认：最后一个按序收到的数据块</p> 
<h5><a id="_734"></a>数据传输</h5> 
<p><img src="https://images2.imgbox.com/ba/df/7WtdJn1u_o.png" alt="数据传输"></p> 
<h5><a id="SHUTDOWN_736"></a>SHUTDOWN</h5> 
<p><img src="https://images2.imgbox.com/8d/96/S6Iq3oZh_o.png" alt="SHUTDOWN块"><br> 用于关闭一个关联</p> 
<h5><a id="_739"></a>关闭关联</h5> 
<p><img src="https://images2.imgbox.com/f3/a6/BZEJgL7d_o.png" alt="关闭关联"><br> 双方都可以关闭关联<br> 不允许“半关闭”</p> 
<h5><a id="HEARTBEATACK_743"></a>HEARTBEAT/ACK块</h5> 
<p><img src="https://images2.imgbox.com/fd/da/1WCsgo5h_o.png" alt="HEARTBEAT块"></p> 
<h5><a id="ERRORABORT_745"></a>ERROR/ABORT块</h5> 
<p><img src="https://images2.imgbox.com/8f/a3/mnzwZZMm_o.png" alt="ERROR/ABORT块"><br> 当收到的分组有差错时发送ERROR块<br> 异常终止一个关联时发送ABORT块</p> 
<h3><a id="_750"></a>验证标志的作用</h3> 
<p>SCTP使用两个验证标志标识一个关联，两个方向验证标志不同</p> 
<p>同一个关联同一个方向上传输的所有SCTP分组，其验证标识是相同的</p> 
<h3><a id="TSNSISSN_754"></a>TSN,SI,SSN的作用</h3> 
<ul><li>传输序号TSN：（0~2^32-1）TCP用序号对字节编号，SCTP用TSN对数据块编号</li><li>流标识号SI：（0~2^16-1）TCP中每个连接只有一个流，SCTP中每个关联有多个流，用SI标识一个流</li><li>流序号SSN：（0~2^16-1）SCTP用SSN标识数据块在相应流中的位置</li><li>SCTP中每个数据块必须携带TSN、SI和SSN</li></ul> 
<p><img src="https://images2.imgbox.com/ca/16/00gSLWNt_o.png" alt="流、分组和数据块"></p> 
<h2><a id="_DHCP_761"></a>第九章 DHCP</h2> 
<h3><a id="_762"></a>主机的四个网络参数</h3> 
<p>也即：IP地址、默认网关、子网掩码、dns服务器</p> 
<h3><a id="DHCP_764"></a>DHCP服务器配置命令</h3> 
<pre><code class="prism language-java">ip dhcp pool bbb
	network <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.0</span> <span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>
	<span class="token keyword">default</span><span class="token operator">-</span>router <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.254</span>
	dns<span class="token operator">-</span>server <span class="token number">8.8</span><span class="token number">.8</span><span class="token number">.8</span> <span class="token number">7.7</span><span class="token number">.7</span><span class="token number">.7</span>
	lease <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span>
ip dhcp excluded<span class="token operator">-</span>address <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.250</span> <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.254</span>
</code></pre> 
<p>这里的三个1，分别代表着1day 1hour 1minute<br> excluded-address代表着不允许DHCP使用的地址<br> 需要注意的是配置的报文不止一个，例如把第二个报文的IP地址扣一块出来分配给网关</p> 
<h3><a id="DHCP68_778"></a>DHCP客户端使用68端口的原因</h3> 
<p>DHCP客户使用68端口的原因</p> 
<ol><li>如果主机A和主机B都使用2020号临时端口</li><li>DHCP服务器广播发送DHCP OFFER报文（目的端口是2020）时，主机B的DAYTIME进程也会收到</li></ol> 
<p><strong>问</strong>：如果主机C同一时刻也在2020端口请求时<br> <strong>答</strong>：因为DHCP请求也是广播发送，所以主机B也会收到</p> 
<h3><a id="_786"></a>租用期</h3> 
<p>DHCP服务器地址租期的意思是，当一个Ip分配给MAC地址后，在租期内，默认这个MAC地址的IP为该地址，不再进行分配，当到期后，该地址被回收，重新分配。</p> 
<p>设置地址租期，对于减轻DHCP压力，网络稳定有一定的好处，但是有些时候网络会因此出现诸如IP地址不够等一些问题，所以租期的时间需要您依据实际情况合理分配。</p> 
<h3><a id="DHCP_790"></a>DHCP工作过程*</h3> 
<p><img src="https://images2.imgbox.com/c5/dc/InGlos9V_o.png" alt="DHCP工作过程"></p> 
<h3><a id="DHCP_792"></a>DHCP报文及封装*</h3> 
<p><img src="https://images2.imgbox.com/7c/fc/0vtMIyEz_o.png" alt="DHCP报文的封装"></p> 
<p><img src="https://images2.imgbox.com/e5/ab/CCsJ3Nog_o.png" alt="DHCP报文"></p> 
<ul><li>事物标识符：系统生成的随机数，用于匹配请求和响应（四个DHCP报文的事物标识符字段的值相同）</li><li>操作码：请求=1，应答=2（ARP中也有类似）</li><li>硬件类型：1（以太网）</li><li>地址长度：6字节</li><li>秒数：客户机开始获取地址经历的时间（从discover报文发出到收到decline报文）</li><li>标志：只使用最左边一位，指明服务器使用广播回答（1），还是单播回答（0）</li><li>客户IP地址：客户向继续使用的IP地址</li><li>你的IP地址：服务器返回给客户的IP地址</li><li>中继代理：即路由的下一跳IP</li><li>服务器主机名和自举文件名共占用了192个字节，但在很多情况下不会使用，白白浪费了空间。为此，DHCP引入了“选项重载”选项，如果设置了该选项，则这两个字段会被忽略掉，并被用于其他用途</li><li>当租用期到达50%时，要重新发送请求报文，这时的客户IP为原IP，你的IP为服务器重新分配的IP</li></ul> 
<h3><a id="_808"></a>选项及报文类型</h3> 
<p><img src="https://images2.imgbox.com/8b/c9/VFz9CMRu_o.png" alt="DHCP选项"></p> 
<h3><a id="DHCP_810"></a>DHCP中继*（客户与中继、中继与服务器之间的报文交互）</h3> 
<p><img src="https://images2.imgbox.com/d1/74/jtGXGthS_o.png" alt="DHCP中继"></p> 
<ul><li>“跳数”和“中继代理IP地址”：用于跨网的情况使用DHCP的情况</li><li>当服务器与客户机在同一个局域网中时： 
  <ul><li>“跳数”=0</li><li>“中继代理IP地址”=0</li></ul> </li><li>使用DHCP中继时： 
  <ul><li>“跳数”=报文经过的路由器个数</li><li>“中继代理IP地址”=代理的IP地址</li></ul> </li></ul> 
<p><code>Router1(config-if)#ip helper-address 172.25.1.1 /*指定dhcp服务器的地址，表示通过Ethernet0向该服务器发送DHCP请求包*/</code>这里的ip地址为代理路由器于图中的左接口</p> 
<h3><a id="IPv6_822"></a>获取IPv6地址的方式</h3> 
<p>IPv6地址自动配置方式：</p> 
<ol><li>无状态地址配置：全局IP地址=64位前缀（ICMPv6路由器通告报文）+64位接口地址（接口MAC地址的EUI64转换）</li><li>有状态地址自动配置：通过DHCPv6协议</li></ol> 
<p>回顾<strong>ICMPv6的路由器通告报文</strong>，其中的M位、O位决定了从何处获取IP地址</p> 
<ul><li>M=0：使用无状态自动配置，当M=0时，O无论什么值都无效</li><li>M=1：使用DHCPv6获取地址</li><li>O=0：DHCPv6服务器无其他可用配置信息</li><li>O=1：除IPv6地址外其他网络参数通过DHCPv6服务器获得</li></ul> 
<h3><a id="DHCPv6EUI64_833"></a>DHCPv6（端口号，EUI-64）</h3> 
<h4><a id="UDP_834"></a>UDP端口号</h4> 
<ul><li>DHCPv6报文承载在UDPv6上</li><li>客户端侦听的UDP目的端口号是546</li><li>服务器、中继代理侦听的UDP端口号是547</li></ul> 
<h4><a id="EUI64_839"></a>EUI-64转换</h4> 
<p><img src="https://images2.imgbox.com/07/f1/NQppQdWP_o.png" alt="EUI-64转换"><br> <strong>例子</strong>：把MAC地址00-4A-DF-8C-5E-C1进行RUI-64转换。<br> <strong>答</strong>：02-4A-DF-FF-FE-8C-5E-C1</p> 
<h2><a id="_DNS_844"></a>第十章 DNS*</h2> 
<h3><a id="_845"></a>域名空间</h3> 
<p><strong>问</strong>：互联网的域名空间如何划分?<br> <strong>答</strong>：分三类：反向域（.arpa）、通用域（.com/.net/.org/.gov）、国家域（.cn/.fr/.jp）</p> 
<p>一个域名空间下可以有多个服务器</p> 
<h3><a id="_850"></a>域名服务器</h3> 
<p><strong>问</strong>：有几种域名服务器？<br> <strong>答</strong>：根、顶级、权限、本地</p> 
<p><strong>问</strong>：IPv4根和IPv6根域名服务器的数量和分布？<br> <strong>答</strong>：IPv4：13个（1主12辅），美国（1+9），瑞典（1），英国（1），日本（1）<br> IPv6:25个（3主22辅助）<br> 其中中国没有IPv4的根服务器，但是有4个镜像服务器，中国拥有IPv6的根服务器。</p> 
<h3><a id="_858"></a>递归和迭代</h3> 
<p><img src="https://images2.imgbox.com/58/48/AYtaNoQo_o.png" alt="迭代"><br> <img src="https://images2.imgbox.com/90/a1/T6HRA45L_o.png" alt="递归"></p> 
<h3><a id="_861"></a>域名解析顺序</h3> 
<p><img src="https://images2.imgbox.com/00/91/2fDuWDEY_o.png" alt="域名解析顺序"><br> ipconfig /displaydns //清除dns缓存<br> ipconfig /flushdns //获取DNS缓存<br> Hosts文件位置：C:\Windows\System32\drivers\etc</p> 
<p>Host文件作用：</p> 
<ul><li>构造IP与域名的映射（公司局域网）</li><li>加快域名解析（Host优先于DNS）</li><li>屏蔽垃圾网站</li></ul> 
<h3><a id="AAAAACNAMENSMXPTR_871"></a>资源记录类型（A,AAAA,CNAME,NS,MX,PTR）*</h3> 
<p>DNS服务器的数据库由许多资源记录（Resourse Record，RR）组成，是服务器向客户返回的信息</p> 
<p>资源记录是一个四元组：Name，Value，Type，TTL</p> 
<h4><a id="A_875"></a>A类型</h4> 
<p>（Name，Value，Type，TTL）<br> Type = A：域名到IP地址的映射<br> Name是主机域名<br> Value是对应的IPv4地址</p> 
<p>AAAA则对应的是16字节的IPv6地址</p> 
<h4><a id="CHAME_882"></a>CHAME类型</h4> 
<p>（Name，Value，Type，TTL）<br> Type = CHAME：主机别名到规范主机名的映射<br> Name是主机别名<br> Value是对应的规范主机名</p> 
<h4><a id="NS_888"></a>NS类型</h4> 
<p>（Name，Value，Type，TTL）<br> Type = NS：域名和域名所在区域的权限域名服务器的映射<br> Name是域<br> Value是该域的权限域名服务器的主机名</p> 
<h4><a id="MX_894"></a>MX类型</h4> 
<p>（Name，Value，Type，TTL）<br> Type = MX：域名和域名所在区域邮件服务器的映射<br> Name是主机别名<br> Value是别名为Name的邮件服务器的规范主机名</p> 
<h4><a id="PTR_900"></a>PTR类型</h4> 
<p>Type=PTR:IP地址到域名的映射<br> Name是IP地址反向转换后的域名<br> Value是主机的域名</p> 
<h3><a id="nslookup_906"></a>nslookup命令*</h3> 
<p><code>Nslookup [- option] [hostname] [server]</code><br> 向某个DNS服务器发送DNS查询报文<br> 跟浏览器访问网站区别，nslookup命令可以用server一项改变目标服务器，若这项不填，默认是本地服务器。</p> 
<h3><a id="DNS_910"></a>DNS报文格式（首部，问题区，回答区）*</h3> 
<p>DNS查询报文：<br> <img src="https://images2.imgbox.com/85/c2/drmTcV8Z_o.png" alt="DNS查询报文"><br> DNS响应报文：<br> <img src="https://images2.imgbox.com/19/f6/OpPfrHjk_o.png" alt="DNS响应报文"><br> DNS首部：<br> <img src="https://images2.imgbox.com/12/3f/UCvXJVrX_o.png" alt="DNS首部"><br> <strong>问</strong>：用于匹配查询报文和响应报文的字段是？<br> <strong>答</strong>：标识字段可以唯一地标识一个DNS报文并匹配请求和响应</p> 
<p><strong>问</strong>：查询报文中“回答数”字段的值是？<br> <strong>答</strong>：查询只有首部、问题区，其他部分都为0，于是这里的回答数为0</p> 
<p><strong>问</strong>：响应报文中“回答数”=“问题数”吗？<br> <strong>答</strong>：不对，这个问题类似于1个域名可以对应多个IP</p> 
<p><strong>问</strong>：响应报文中“问题区”的值=查询报文中“问题区”的值吗？<br> <strong>答</strong>：对，这里的内容一对的查询响应报文是完全相同的</p> 
<p><strong>问</strong>：如何区分是查询报文还是响应报文？<br> <strong>答</strong>：可以有多种方式，比如查看回答数等字段是否有值，参数、标识字段的值也可以看出</p> 
<h4><a id="_931"></a>参数</h4> 
<p><img src="https://images2.imgbox.com/62/63/9SBjqkof_o.png" alt="参数字段"></p> 
<ul><li>0操作位（QR）：查询为0，响应为1</li><li>1-4查询类型（Option）：标准查询为0，反向查询为1，还有很多空间暂时还没使用</li><li>5授权（AA仅应答）：0响应由授权服务器返回，1响应由非授权服务器返回（例如DNS缓存服务器）</li><li>6截断（TC仅应答）：超过512字节时有用，当为1时，于是让源主机从UDP报文改为重新发一个TCP报文</li><li>7需要递归（RD）：当为1时表示客户希望得到递归回答，不需要一层层服务器查询过去，直接拿到结果</li><li>8递归结果（RA仅应答）：当为1时表示DNS服务器支持递归</li><li>9-11未使用，全0</li><li>12-15查询结果（Rcode）：表示响应中的差错状态</li></ul> 
<p><img src="https://images2.imgbox.com/30/7b/gJyPG8uB_o.png" alt="参数错误的情况"></p> 
<h4><a id="_943"></a>问题区</h4> 
<p><img src="https://images2.imgbox.com/aa/4f/TCVlcG6j_o.png" alt="问题区"><br> 查询域名Name:长度+字符串<br> 例如：<strong>3www5baidu3com0</strong><br> <img src="https://images2.imgbox.com/dc/95/3oS1vFdp_o.png" alt="例子"><br> <strong>问</strong>：这个问题区的长度？<br> <strong>答</strong>：20字节</p> 
<h4><a id="_951"></a>回答区</h4> 
<p><img src="https://images2.imgbox.com/58/9f/31M4R2hH_o.png" alt="回答区"></p> 
<ul><li>生存时间TTL：资源记录信息在缓存中的有效秒数</li><li>长度Data Length：指“资源数据区”的长度</li><li>资源数据区Data:对查询的回答</li></ul> 
<p><img src="https://images2.imgbox.com/fa/35/bMlt8Bf0_o.png" alt="回答区例子"><br> <strong>问</strong>：回答数是多少？<br> <strong>答</strong>：3个</p> 
<p><strong>问</strong>：是否存在重复数据？<br> <strong>答</strong>：是，最后一行以及下面没显示的数据于第2个回答重复了</p> 
<h3><a id="_964"></a>域名存储*</h3> 
<p>DNS解析是分布式存储的，比如根域名服务器只存储260个顶级域名的DNS服务器的ip地址。顶级域名服务器如.com的DNS服务器，存储的则是一些一级域名的权威DNS服务器地址(如http://suning.com，http://qq.com，http://163.com的DNS)。而http://suning.com的权威DNS存储的才是具体的主机记录（如A记录，cname记录，txt记录）。</p> 
<h3><a id="_966"></a>域名压缩*</h3> 
<p><img src="https://images2.imgbox.com/c7/cd/5FUVrVKV_o.png" alt="域名压缩"></p> 
<ul><li>回答区的域名是问题区中域名的重复</li><li>重复部分用偏移指针（2字节）表示</li><li>如果回答区前2位是 
  <ul><li>11（压缩）：接下来14位为偏移指针，指向域名的存放位置（指重复部分从何开始）</li><li>00（无压缩）：接下来6位为域名计数值（域名第1部分字符长度）</li></ul> </li></ul> 
<h3><a id="DDNS_974"></a>DDNS及应用</h3> 
<p>DDNS：DDNS是将用户的动态IP地址映射到一个固定的域名解析服务上，用户每次连接网络的时候，客户端程序就会通过信息传递把该主机的动态IP地址传送给位于服务商主机上的服务器程序，服务器程序负责提供DNS服务并实现动态域名解析。</p> 
<p>应用：动态接入网络、监控行业中的远程访问、内网穿透等</p> 
<h3><a id="DNSSecDNS_978"></a>DNSSec如何防止DNS欺骗*</h3> 
<p>DNSsec(DNS安全扩展)：采用基于公钥的数字签名，由数据所有者对DNS资源记录进行签名<br> - 每一个DNS区均包含一个公钥私钥对<br> - DNS区所有者使用该驱虎的私钥对区域内的DNS数据进行签名<br> - 该区域的公钥在区域内公开发布<br> - 既能验证数据来源，也可以确保数据完整性</p> 
<h2><a id="_FTPTFTP_984"></a>第十一章 FTP与TFTP</h2> 
<h3><a id="FTP_985"></a>FTP</h3> 
<h4><a id="_986"></a>控制连接与数据连接*</h4> 
<p><img src="https://images2.imgbox.com/d5/ea/RTBDM7l9_o.png" alt="FTP的两个链接"><br> <strong>Q1</strong>：两个链接的名称和端口号是什么？<br> <strong>答</strong>：客户端的命令首先交给用户命令解释器，并通过<strong>控制连接</strong>传输给服务器命令接口，这时服务器使用21号端口，客户端使用任意端口（20号或者临时端口）。服务器处理完毕后，把应答返回给客户端。文件传输则通过<strong>数据连接</strong>完成，此时如果是主动模式（PORT）的话，客户端告诉服务器自己打开的端口，服务器从20号端口向客户端的这个端口传输数据；如果是被动模式（PASV）的话，服务器随机打开一个端口，并告诉客户端，然后客户端类似port地向这个端口发送请求并建立连接</p> 
<p><strong>Q2</strong>：两个连接分别用来传输什么信息？<br> <strong>答</strong>：控制连接用于传输命令（包括发送用户名、口令、查询目录命令、传输文件命令等）；数据连接负责传输数据</p> 
<h4><a id="PORTPASV_993"></a>PORT模式与PASV模式的特点*</h4> 
<h5><a id="FTPPORT_994"></a>FTP数据连接（PORT模式）</h5> 
<p><img src="https://images2.imgbox.com/c5/6b/6tacuvqi_o.png" alt="PORT模式"><br> FTP服务器从控制连接上收到一个传输文件命令后，使用20端口与FTP客户建立一个数据连接</p> 
<p>PORT命令：由FTP客户发送，把用于数据连接的临时端口号告诉服务器</p> 
<p><strong>例如</strong>：FTP客户通过1173端口向服务器的21号端口发出的PORT命令如下：<br> port 192,168,1，100，4,150<br> 客户端的IP地址为：192.168.1.100<br> 客户端号：4*256+150=1174</p> 
<h5><a id="FTPPASV_1004"></a>FTP数据连接（PASV模式）</h5> 
<p>FTP服务器从控制连接上收到一个传输文件命令后，使用临时端口与FTP客户建立一个数据连接<br> <img src="https://images2.imgbox.com/62/6e/T8FoOHMk_o.png" alt="PASV"><br> PASV命令：由FTP客户发送，要求FTP服务器返回一个端口号<br> PASV响应：由FTP服务器发送，把用于数据连接的临时端口号告诉客户</p> 
<p>FTP客户发出PASV命令后收到的响应如下：<br> Entering Passive Mode 210,34,80,31,10,20</p> 
<p>服务器IP：210.34.80.31<br> 服务器端口号：10*256+20=2580</p> 
<h5><a id="PORTPASV_1016"></a>比较PORT和PASV</h5> 
<ul><li>PORT模式 
  <ul><li>客户发送PORT命令</li><li>服务器主动发起数据连接请求</li></ul> </li><li>PASV模式 
  <ul><li>客户发送PASV命令</li><li>客户主动发起数据连接请求</li></ul> </li></ul> 
<h4><a id="_1024"></a>协商端口号的过程*</h4> 
<p><strong>问</strong>：PORT模式和PASV模式如何协商端口号？<br> <strong>答</strong>：PORT模式由客户端主动提出自己的端口；PASV模式由服务器主动提出自己的端口给客户端，客户端再给服务器自己的端口</p> 
<h4><a id="NATPORT_1027"></a>NAT对PORT模式的影响*</h4> 
<p>主要见书本第8章Internet地址扩展技术的8.8.4NAT与应用程序间的交互</p> 
<p>server &lt;-wan-&gt; fw — client<br> client在防火墙后面，使用私网地址，通过NAT访问公网：<br> 在一般情况下，port指令将被防火墙阻挡，表现为client发port指令（通常ls就会需要进行一次data传输）时总是得不到server的响应，直到超时错误，此时是因为server无法连接到client所开的随机端口（client在port指令中会告知server自己所开的端口以及自己的地址）；此时client可以使用pasv模式进行工作；如果该client不能使用pasv指令（如一些简单的ftp client程序），我就要求防火墙具有outing ftp proxy功能，或称ftp映射内核代理，即防火墙监控在特定端口（一般是21）的ftp连接，在检测到client向server发送的port指令，把该指令中的client地址以及端口修改为防火墙地址以及端口，再把修改后的数据发往server，同时在server返回数据时将该数据重定向到client的监听端口，完成一次完整的port过程</p> 
<h4><a id="FTPFTP_1033"></a>FTP命令与FTP响应的封装*</h4> 
<h5><a id="FTP_1034"></a>FTP命令</h5> 
<p>FTP命令的格式：命令+参数</p> 
<table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>USER</td><td>用户名</td></tr><tr><td>PASS</td><td>密码</td></tr><tr><td>PORT</td><td>主动模式</td></tr><tr><td>PASV</td><td>被动模式</td></tr><tr><td>LIST</td><td>列出当前目录下的文件列表</td></tr><tr><td>CWD</td><td>改变当前目录</td></tr><tr><td>STOR</td><td>存储文件</td></tr><tr><td>RETR</td><td>读出文件</td></tr><tr><td>QUIT</td><td>退出</td></tr></tbody></table> 
<p><strong>Q1</strong>：FTP命令是谁发送的？<br> <strong>答</strong>：由客户端于控制连接发送的</p> 
<p><strong>Q2</strong>：FTP命令在哪条连接上发送的？<br> <strong>答</strong>：控制连接</p> 
<h5><a id="FTP_1055"></a>FTP响应</h5> 
<p>FTP响应的格式：代码+说明文本</p> 
<table><thead><tr><th>代码</th><th>说明</th></tr></thead><tbody><tr><td>220</td><td>服务就绪（控制连接建立）</td></tr><tr><td>331</td><td>用户名OK，需要口令</td></tr><tr><td>230</td><td>用户登录OK</td></tr><tr><td>200</td><td>命令OK</td></tr><tr><td>150</td><td>文件状态OK，数据连接即将打开</td></tr><tr><td>226</td><td>关闭数据连接</td></tr><tr><td>221</td><td>服务关闭（控制连接关闭）</td></tr></tbody></table> 
<h5><a id="FTP_1068"></a>FTP命令和响应全过程</h5> 
<p><img src="https://images2.imgbox.com/bb/e3/VGWQmH8E_o.png" alt="FTP命令全过程"></p> 
<ol><li>控制连接建立后，FTP服务器在控制连接上发送220（服务就绪）响应</li><li>FTP客户发送USER命令，服务器响应331（用户名OK，需要口令）</li><li>FTP客户发送PASS命令，服务器响应230（用户登录OK）</li><li>FTP客户发送PORT命令，服务器在端口20与客户建立一条数据连接，响应150（数据连接即将打开）</li><li>FTP客户发送LIST命令，服务器在端口20把数据发送给客户，数据传输完毕后，服务器关闭这条数据连接，并响应226（关闭数据连接）</li><li>FTP客户发送PORT命令，服务器在端口20与客户建立一条数据连接，响应150（数据连接即将打开）</li><li>FTP客户发送RETR命令下载一个文件，打开另一个数据连接来传输这个文件，数据传输完毕后，服务器关闭这条数据连接，并响应226（关闭数据连接）</li><li>FTP客户发送QUIT命令请求关闭控制连接，服务器响应221（服务关闭）</li></ol> 
<h4><a id="FTP_1079"></a>匿名FTP</h4> 
<p><strong>Q</strong>：什么是匿名FTP？<br> <strong>答</strong>：即anonymous匿名登录FTP服务器</p> 
<h3><a id="TFTP_1082"></a>TFTP</h3> 
<h4><a id="UDP69_1083"></a>基于UDP69</h4> 
<p>TFTP基于UDP，服务端在UDP的69号端口监听等待客户端发请求</p> 
<ol><li>服务端在UDP69端口监听</li><li>客户端通过UDP发送Write request包给服务端</li><li>服务端收到Write request请求包后，需要发送ACK包给客户端</li><li>客户端发送Data数据给服务端</li><li>服务端接收数据并发送ack包给客户端</li></ol> 
<h4><a id="_1091"></a>可靠传输、流量控制、差错控制</h4> 
<p>TFTP特性：<br> 使用UDP（端口69）作为其传输协议（不像FTP使用TCP端口21）。<br> 不能列出目录内容（FTP）。<br> 无验证或加密机制（不安全的特性）。</p> 
<p>优缺点：<br> 主要是服务占用计算机资源比较少，其次是基于UDP实现，适合小文件传输，传输速度也比较快，多用于局域网的文件共享。</p> 
<p>缺点也就是安全方面了，由于TFTP是设计用于系统引导进程，它不可能提供用户名和口令，udp不可靠传输。</p> 
<h2><a id="_HTTP_1101"></a>第十二章 HTTP*</h2> 
<h3><a id="HTTP_1102"></a>HTTP请求报文（格式、常用请求方法）*</h3> 
<p><img src="https://images2.imgbox.com/fd/22/3HNpWrCq_o.png" alt="HTTP请求报文"><br> <img src="https://images2.imgbox.com/aa/3c/kHQLOxVu_o.png" alt="常见HTTP方法"></p> 
<pre><code>1. GET：发送请求来获得服务器上的资源，请求体重不会包含请求数据，请求数据放在协议头中。另外GET支持快取、缓存、可保留书签等。幂等。
2. POST：和GET一样很常见，向服务器提交资源让服务器处理，比如提交表单、上传文件等，可能导致建立新的资源或者对原有资源的修改。提交的资源放在请求体重。不支持快取。非幂等
3. PUT：和POST类似，HTML表单不支持，发送资源与服务器，并存储在服务器指定位置，要求客户端事先知道该位置
4. GET和POST 的区别：点击返回/刷新按钮时GET没有影响，POST有；GET可以缓存添加书签，POST不行；GET有历史记录，POST没有；GET幂等，POST非幂等；GET只能传输ASCII类型数据，POST没有限制；GET数据全部展示在URL中，不安全，POST通过request body传递数据比较安全；GET可见，POST不可见；GET传输数据的大小会被浏览器和服务器限制，一般是2k，而POST可以传输较大量数据
5. POST与PUT的区别：POST非幂等，PUT幂等；POST资源是在集合上，PUT在具体某一个资源上，所以put较安全，无论请求多少次都是在这个资源上改，post可能请求多少次就创建多少次资源
6. 具体详见：[常见请求方法](https://www.cnblogs.com/zhouwenfan-home/p/11334101.html)
7. 幂等的：连续调用一次或者多次的效果相同
</code></pre> 
<h3><a id="HTTP_1113"></a>HTTP响应报文（格式、常见状态码）*</h3> 
<p><img src="https://images2.imgbox.com/94/be/mLxmuBC8_o.png" alt="HTTP响应报文"><br> <img src="https://images2.imgbox.com/cd/9c/CGS3c3FX_o.png" alt="HTTP响应"></p> 
<h3><a id="HTTP_1116"></a>HTTP认证</h3> 
<p>WWW-Authentication响应首部：服务器对客户的认证<br> Athentication请求首部：客户提供给服务器进行认证的数据</p> 
<h4><a id="_1119"></a>基本认证</h4> 
<p><img src="https://images2.imgbox.com/60/96/zlyLvVp4_o.png" alt="HTTP基本认证"></p> 
<h4><a id="_1121"></a>摘要认证</h4> 
<p><img src="https://images2.imgbox.com/22/bd/cB1E9k9Q_o.png" alt="摘要认证"></p> 
<h3><a id="_1124"></a>常用首部</h3> 
<h4><a id="ConnectionKeepalive_1125"></a>Connection和Keepalive*</h4> 
<p>通用首部</p> 
<p>Connection：TCP连接方式<br> Keep-Alive：定义持久连接的参数</p> 
<pre><code>Connection: Keep-Alive\r\n
Keep-Alive: timeout=5,max=100\r\n
</code></pre> 
<p>含义：空闲5秒后关闭连接，服务器最多再为100个事务保持连接状态</p> 
<h4><a id="HostReferer_1135"></a>Host*、Referer*</h4> 
<p>来自请求首部</p> 
<p>HOST：服务器的主机名<br> Referer：指客户是从该URL代表的页面触发访问当前请求页面的</p> 
<p>HOST：从URL中提取出来<br> Referer：上一个页面的URL</p> 
<h4><a id="Location_1143"></a>Location*</h4> 
<p>来自响应首部</p> 
<p>Location：将客户定向到资源的URL（更换域名时）</p> 
<h4><a id="Server_1147"></a>Server</h4> 
<p>来自响应首部</p> 
<p>Server：服务器软件名称版本</p> 
<h4><a id="Allow_1151"></a>Allow</h4> 
<p>来自响应首部</p> 
<p>Allow：支持的请求方法</p> 
<h4><a id="XFrameOption_1155"></a>X-Frame-Option</h4> 
<p>来自响应首部</p> 
<ul><li>用来设置页面是否可被嵌套到别的页面中</li><li>用来防御利用iframe嵌套的点击劫持攻击</li><li>Deny：表示该页面不允许在frame中展示</li><li>Sameorigin：表示该页面可以在相同域名页面的frame中展示</li><li>Allow-from uri：表示该页面可以在指定来源的frame中展示</li><li><img src="https://images2.imgbox.com/a9/c4/IZhPTl2B_o.png" alt="HTTP点击劫持"></li></ul> 
<h4><a id="RangeContentRange_1164"></a>Range和Content-Range</h4> 
<ul><li>并发分块下载 
  <ul><li>客户端并发请求相同资源的不同片段</li><li>如迅雷、IDM等</li></ul> </li><li>Range请求首部：请求的资源范围 
  <ul><li>Range：bytes = 306302-</li><li>请求这个资源中从306302个字节到末尾的部分</li></ul> </li><li>Content-Range响应首部：响应的资源范围 
  <ul><li>Content-Range：bytes 306302-604047/604048</li><li>响应中指示携带的是该资源的第306302-604047的字节，该资源共604048个字节</li></ul> </li></ul> 
<h4><a id="ViaMaxForwards_1174"></a>Via和Max-Forwards*</h4> 
<p><img src="https://images2.imgbox.com/fb/b7/acVRmiAh_o.png" alt="代理相关请求首部"></p> 
<h5><a id="HTTP_1177"></a>追踪HTTP报文</h5> 
<p>via首部：HTTP报文每经过一个代理，都必须将代理信息添加到Via列表的末尾</p> 
<p>例如：<code>Via:101 proxy.irenes-isp.net,i.1 p1127.att.net</code></p> 
<p>Via的四组件：协议（HTTP时可声），版本，代理主机名，注释（可选）</p> 
<h5><a id="ViaVia_1183"></a>请求Via和响应Via</h5> 
<p><img src="https://images2.imgbox.com/e9/5a/JEiHBpV1_o.png" alt="请求和响应Via"><br> 请求Via总是与响应Via相反</p> 
<h5><a id="MaxForwards_1186"></a>Max-Forwards首部</h5> 
<p>用来限制转发跳数<br> 用来查看代理链中任意一个代理上收到的请求</p> 
<p>每经过一个代理，Max-Forwards值减一<br> 为0时，代理不再转发，并向客户发送TRACE响应</p> 
<p>如上图，客户的Max-Forwards值为2</p> 
<h4><a id="ExpiresCacheControl_1196"></a>Expires和Cache-Control</h4> 
<p>与缓存文档的有效期有关</p> 
<p>Expires：绝对日期（依赖时钟）<br> Cache-Control：相对时间（文档的最大生存时间）</p> 
<p>例：Expires：Tue，08 Feb 2022 11:35:14 GMT<br> Cache-Control:Max-age = 484200</p> 
<h4><a id="LastModifiedifModifiedSince_1205"></a>Last-Modified和if-Modified-Since*</h4> 
<p>与缓存文档的有效期有关</p> 
<p>Last-Modified：资源最后一次被修改的时间<br> if-Modified-Since：与Last-Modified配合使用</p> 
<p>例如：If-Modified-Since:Mon,24 Dec 2018 09:07:57 GMT</p> 
<ul><li>与Last-Modified响应首部配合使用</li><li>客户之前请求过该文档，再次请求相同文档时使用</li><li>把已缓存文档的时间与服务器上实际文档的最后修改时间进行对比 
  <ul><li>相同：返回304 Not Modified,不返回文档的主体</li><li>不同：返回200 OK，返回新文档</li></ul> </li></ul> 
<p>思考：文档内容没变但修改日期改变，或文档内容变化微小的情况<br> 个人认为，如果文档内容变化，即使微小也会发送If-Modified-Since请求首部，发现两端修改时间不一致，从而返回200，修改日期同理，应该也是返回200</p> 
<h4><a id="EtagIfNoneMatch_1220"></a>Etag和If-None-Match*</h4> 
<p>与缓存文档的有效期有关</p> 
<p>Etag：资源的标记信息<br> If-None-Match：与Etag配合使用</p> 
<p>例如：If-None-Match:“03f2b33c0bfcc1:0”</p> 
<ul><li>与ETag响应首部配合使用</li><li>服务器给文档添加ETag信息（包含文档的版本、序列号、内容校验等）；修改文档时，可修改文档的ETag</li><li>客户在HTTP请求报文中加入If-None-Match首部（=ETag值）</li><li>服务器验证文档的ETag是否改变： 
  <ul><li>没变：返回304 Not Modified,不返回文档的主体</li><li>改变：返回200 OK，返回新文档和新ETag</li></ul> </li></ul> 
<h4><a id="AuthenticationWWWAuthentication_1233"></a>Authentication和WWW-Authentication</h4> 
<p>与摘要认证有关<br> <img src="https://images2.imgbox.com/35/2e/KFBt8Nvg_o.png" alt="摘要认证"></p> 
<h3><a id="HTTPS_1236"></a>HTTPS的加密、认证、完整性保护*</h3> 
<h4><a id="_1237"></a>对称密钥加密技术</h4> 
<p>加密解密使用相同的密钥，任何人只要拿到密钥，都能破解密码</p> 
<p>发送密钥就有被窃听的风险，但不发送，对方就不能解密。再说，密钥若能够安全发送，那数据也应该能安全送达</p> 
<h4><a id="_1241"></a>公开密钥加密技术</h4> 
<p><img src="https://images2.imgbox.com/bd/0a/LyxdbusU_o.png" alt="公开密钥加密技术"></p> 
<h4><a id="HTTPS_1243"></a>HTTPS采用混合加密机制</h4> 
<ol><li>使用公开密钥加密方式安全地交换在稍后的共享密钥加密中要使用的密钥</li><li>确保交换的密钥是安全的前提下，使用共享密钥加密方式进行通信</li></ol> 
<h4><a id="_1247"></a>报文被篡改</h4> 
<p><img src="https://images2.imgbox.com/8e/32/7bJoepcK_o.png" alt="报文被篡改"><br> HTTPS用数字签名防止篡改，防否认，防伪造<br> 也可以证明该报文是谁发送的<br> <img src="https://images2.imgbox.com/a7/51/HGhk1FMf_o.png" alt="数字签名防篡改"></p> 
<h4><a id="HTTP_1252"></a>HTTP不验证身份</h4> 
<p>任何人都可以发起请求，任何请求都会返回一个响应<br> <img src="https://images2.imgbox.com/e0/3e/tZWnsofZ_o.png" alt="不验证身份"><br> HTTPS使用证书证明身份<br> <img src="https://images2.imgbox.com/07/84/ctTvMIvL_o.png" alt="使用证书证明身份"></p> 
<h3><a id="HTTPAjaxCometWebSocket_1257"></a>HTTP优化技术（Ajax、Comet、WebSocket）</h3> 
<h4><a id="Ajax_1258"></a>Ajax的解决方法</h4> 
<p>Ajax：实现局部Web页面更新<br> <img src="https://images2.imgbox.com/51/38/4mBS9SpW_o.png" alt="Ajax通信"><br> <img src="https://images2.imgbox.com/f0/bc/mrOfp3Hf_o.png" alt="Ajax举例"></p> 
<h4><a id="Comet_1263"></a>Comet的解决方法</h4> 
<p>收到客户请求，Comet先将响应挂起，当服务器端有内容更新时，再返回该响应<br> <img src="https://images2.imgbox.com/3a/f8/VyPxPeFN_o.png" alt="Comet方法"><br> <img src="https://images2.imgbox.com/e8/3a/40FC1pRW_o.png" alt="Comet举例"><br> Ajax和Comet通信的特点：被动性（即服务端不能主动联系客户端，只能由客户端发起）<br> 对服务器的要求：Ajax通信需要有很高的处理速度，Comet通信需要很高的并发处理能力</p> 
<h4><a id="WebSocket_1269"></a>WebSocket</h4> 
<p>支持由服务器向客户端推送数据<br> 需要先建立HTTP数据，之后使用WebSocket协议<br> <img src="https://images2.imgbox.com/b2/d1/RwFxAqht_o.png" alt="WebSocket"><br> <img src="https://images2.imgbox.com/da/9b/j5QeQkkc_o.png" alt="WebSocket通信过程"></p> 
<h3><a id="HTTP20_1274"></a>HTTP2.0的特点</h3> 
<h4><a id="_1275"></a>二进制分帧</h4> 
<p>每个数据流以消息的形式发送，消息由一或多个帧组成<br> 帧可以乱序发送，再根据每个帧首部的流标识符重新组装<br> <img src="https://images2.imgbox.com/72/36/MMqcPZiT_o.png" alt="二进制分帧"></p> 
<h4><a id="_1279"></a>请求分优先级</h4> 
<p>HTTP1.1持久连接Keepalive：等待订单1完成后，才能接收订单2<br> <img src="https://images2.imgbox.com/35/f1/4Oe7n4XZ_o.png" alt="请求队列FIFO"><br> HTTP1.1 流水线Pipling：先响应订单1，再响应订单2<br> <img src="https://images2.imgbox.com/d6/c6/Sj9RpaeQ_o.png" alt="响应队列FIFO"><br> HTTP2.0 多路复用和请求优先级：订单2请求优先，服务器优先响应订单2<br> <img src="https://images2.imgbox.com/85/df/OM9BnnBW_o.png" alt="HTTP2.0"></p> 
<h4><a id="_1286"></a>首部压缩</h4> 
<p><img src="https://images2.imgbox.com/d8/04/adgw3Hg1_o.png" alt="首部压缩"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f5f49562dbaeec82df94586e50132d7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用AI 来一键体验“返老还童”的快乐！马化腾、李彦宏、杨幂都能还原的那种 |儿童节福利...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/190a552574520a2c55449de1eb9995d2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python的内置函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>