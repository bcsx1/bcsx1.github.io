<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2020电赛F题总结回顾（openmv实现视觉） - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2020电赛F题总结回顾（openmv实现视觉）" />
<meta property="og:description" content="我决定把资源倒腾倒腾发上来，一方面分享大致思路，另一方面也当是纪念了
做的是2020电赛F题：简易无接触温度测量与身份识别装置
文章目录 题目整体设计硬件选择软件流程 视觉算法分辨不同人脸（身份识别）口罩识别现场学习其他优化算法 总结 题目 整体设计 硬件选择 机器视觉模块使用openmv，这一方面是我们在备赛过程中认为openmv的功能足够，一直在准备openmv，另一方面是当时马上下单k210开始学习等到货都已经第三天了，调试来不及风险太大了，所以决定使用openmv
好在我们买的是最顶配型号openmvH7Plus，最终也顺利完成了题目要求的所有任务
温度测量方面是MLX90614使用某宝的模块i2c读取温度，最终我们没有省一拿了省二也是砸在这个模块上，在送测现场出了问题，血的教训，万事都要做好plan B啊~~
主控使用stm32c8t6，这是因为我们在赛前已经用顺手了，其他的也行
其他硬件包括oled显示温度阈值等，按键，有源蜂鸣器，激光小灯等就不赘述了
最后的电路板设计，器件布局如下
软件流程 stm32和openmv通过串口通信，我们指定一个字母对应进入一个模式，通电后openmv就在死循环不断等待字母，收到字母即执行对应模式功能，再返回结果。具体可看软件流程图：
视觉算法 由于分工上我主要负责openmv视觉部分的代码编写等部分，所以这里多说几句视觉方面的python代码编写的心路历程
刚开始学习阶段主要参考的资料就是心疼科技的两个函数库链接：
https://book.openmv.cc/
https://docs.singtown.com/micropython/zh/latest/openmvcam/library/index.html
b站视频也有看点
分辨不同人脸（身份识别） 拿到题目第一反应就是中文入门教程里面看到过这个LBP分辨不同人脸的应用，于是我第一天也确确实实按照手册的思路拍照测试了，但是实际效果并不好，而且受光线和背景影响很大，脸还必须填满摄像头，就很不方便
于是后来又发现了特征点算法，运算时间有了很大提升，但还有一个问题就是如果背景拍到的范围过大，那么将会从背景提取很多无用的特征点，而要求人保持一定的距离把人脸填满屏幕实在太蠢了，怎么解决呢？
我的方法是先加一层人脸识别，将人脸部分局部放大截取出来再拿去提取特征点并进行特征点比对，通过这种方法，就不用对被识别者有很大的要求，实现类似k210一样的功能啦~
关于上面这个思路，直接上代码：
#画出特征点 def draw_keypoints(img, kpts): if kpts: print(kpts) img.draw_keypoints(kpts) img = sensor.snapshot() time.sleep(1000) def find_max(pmax, a, s): global face_num if a&gt;pmax: pmax=a face_num=s return pmax def Distinguish_faces(): global NUM_SUBJECTS global NUM_SUBJECTS_IMGS pyb.LED(3).on() # 重置传感器 sensor.reset() sensor.set_contrast(3) sensor.set_gainceiling(16) sensor.set_framesize(sensor.VGA) sensor.set_windowing((240, 240)) #sensor.set_framesize(sensor.B128X128) # or sensor." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/f78f74c3a95930c684fbcec557bc90e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-01T19:54:51+08:00" />
<meta property="article:modified_time" content="2023-07-01T19:54:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2020电赛F题总结回顾（openmv实现视觉）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>我决定把资源倒腾倒腾发上来，一方面分享大致思路，另一方面也当是纪念了<br> 做的是2020电赛F题：<strong>简易无接触温度测量与身份识别装置</strong><br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">题目</a></li><li><a href="#_5" rel="nofollow">整体设计</a></li><li><ul><li><a href="#_6" rel="nofollow">硬件选择</a></li><li><a href="#_18" rel="nofollow">软件流程</a></li></ul> 
  </li><li><a href="#_23" rel="nofollow">视觉算法</a></li><li><ul><li><a href="#_30" rel="nofollow">分辨不同人脸（身份识别）</a></li><li><a href="#_194" rel="nofollow">口罩识别</a></li><li><a href="#_202" rel="nofollow">现场学习</a></li><li><a href="#_281" rel="nofollow">其他优化算法</a></li></ul> 
  </li><li><a href="#_289" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_3"></a>题目</h2> 
<p><img src="https://images2.imgbox.com/6d/8b/Dc0k8aZt_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_5"></a>整体设计</h2> 
<h3><a id="_6"></a>硬件选择</h3> 
<p>机器视觉模块使用openmv，这一方面是我们在备赛过程中认为openmv的功能足够，一直在准备openmv，另一方面是当时马上下单k210开始学习等到货都已经第三天了，调试来不及风险太大了，所以决定使用openmv<br> 好在我们买的是最顶配型号openmvH7Plus，最终也顺利完成了题目要求的所有任务<br> <img src="https://images2.imgbox.com/d0/23/RAwkri5z_o.png" alt="在这里插入图片描述"></p> 
<p>温度测量方面是MLX90614使用某宝的模块i2c读取温度，最终我们没有省一拿了省二也是砸在这个模块上，在送测现场出了问题，血的教训，万事都要做好plan B啊~~<br> 主控使用stm32c8t6，这是因为我们在赛前已经用顺手了，其他的也行<br> 其他硬件包括oled显示温度阈值等，按键，有源蜂鸣器，激光小灯等就不赘述了<br> 最后的电路板设计，器件布局如下<br> <img src="https://images2.imgbox.com/a8/11/3XFVwk2O_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bb/ce/nQPrOw07_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_18"></a>软件流程</h3> 
<p>stm32和openmv通过串口通信，我们指定一个字母对应进入一个模式，通电后openmv就在死循环不断等待字母，收到字母即执行对应模式功能，再返回结果。具体可看软件流程图：<br> <img src="https://images2.imgbox.com/a9/86/nJYV1ucR_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_23"></a>视觉算法</h2> 
<p>由于分工上我主要负责openmv视觉部分的代码编写等部分，所以这里多说几句视觉方面的python代码编写的心路历程</p> 
<p>刚开始学习阶段主要参考的资料就是心疼科技的两个函数库链接：<br> <a href="https://book.openmv.cc/" rel="nofollow">https://book.openmv.cc/</a><br> <a href="https://docs.singtown.com/micropython/zh/latest/openmvcam/library/index.html" rel="nofollow">https://docs.singtown.com/micropython/zh/latest/openmvcam/library/index.html</a><br> b站视频也有看点</p> 
<h3><a id="_30"></a>分辨不同人脸（身份识别）</h3> 
<p>拿到题目第一反应就是中文入门教程里面看到过这个LBP分辨不同人脸的应用，于是我第一天也确确实实按照手册的思路拍照测试了，但是实际效果并不好，而且受光线和背景影响很大，脸还必须填满摄像头，就很不方便<br> 于是后来又发现了特征点算法，运算时间有了很大提升，但还有一个问题就是如果背景拍到的范围过大，那么将会从背景提取很多无用的特征点，而要求人保持一定的距离把人脸填满屏幕实在太蠢了，怎么解决呢？<br> 我的方法是先加一层人脸识别，将人脸部分局部放大截取出来再拿去提取特征点并进行特征点比对，通过这种方法，就不用对被识别者有很大的要求，实现类似k210一样的功能啦~<br> 关于上面这个思路，直接上代码：</p> 
<pre><code class="prism language-python"><span class="token comment">#画出特征点</span>
<span class="token keyword">def</span> <span class="token function">draw_keypoints</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> kpts<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> kpts<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>kpts<span class="token punctuation">)</span>
        img<span class="token punctuation">.</span>draw_keypoints<span class="token punctuation">(</span>kpts<span class="token punctuation">)</span>
        img <span class="token operator">=</span> sensor<span class="token punctuation">.</span>snapshot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">find_max</span><span class="token punctuation">(</span>pmax<span class="token punctuation">,</span> a<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> face_num
    <span class="token keyword">if</span> a<span class="token operator">&gt;</span>pmax<span class="token punctuation">:</span>
        pmax<span class="token operator">=</span>a
        face_num<span class="token operator">=</span>s
    <span class="token keyword">return</span> pmax

<span class="token keyword">def</span> <span class="token function">Distinguish_faces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> NUM_SUBJECTS
    <span class="token keyword">global</span> NUM_SUBJECTS_IMGS

    pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 重置传感器</span>
    sensor<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_contrast<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_gainceiling<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_framesize<span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>VGA<span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_windowing<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#sensor.set_framesize(sensor.B128X128) # or sensor.QQVGA (or others)</span>

    sensor<span class="token punctuation">.</span>set_pixformat<span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>GRAYSCALE<span class="token punctuation">)</span>

    <span class="token comment">#set_auto_gain :enable 打开（True）或关闭（False）自动增益。默认打开。 value 强迫增益值。</span>
    <span class="token comment">#sensor.set_auto_gain(False, value=1000)</span>
    <span class="token comment">#sensor.set_auto_gain(False, gain_db =700)</span>
    sensor<span class="token punctuation">.</span>set_auto_gain<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> gain_db_ceiling <span class="token operator">=</span> <span class="token number">20.0</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>skip_frames<span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">)</span>

    pmax<span class="token operator">=</span><span class="token number">0</span><span class="token comment">#保存检测点和样本点的匹配程度，越大越接近，初始化为最小</span>


    loop_flag<span class="token operator">=</span><span class="token number">1</span><span class="token comment">#循环检测标志位，检测到人脸身边识别后退出</span>
    type_flag<span class="token operator">=</span><span class="token number">0</span><span class="token comment">#kpts1类别正确标志位，正确为1，错误为0</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>loop_flag<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#加了histeq子自适应直方图均衡，当人脸填满整个屏幕的时候可以提高一点点识别准确度.histeq(adaptive=True, clip_limit=3)</span>
        <span class="token comment">#找图片中人脸</span>
        <span class="token comment">#gamma_corr用于修正图像中色彩，数值越高图像越亮</span>
        faces <span class="token operator">=</span> sensor<span class="token punctuation">.</span>snapshot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gamma_corr<span class="token punctuation">(</span>contrast<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_features<span class="token punctuation">(</span>image<span class="token punctuation">.</span>HaarCascade<span class="token punctuation">(</span><span class="token string">"frontalface"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        lcd<span class="token punctuation">.</span>display<span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>snapshot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">#lcd.display(sensor.snapshot())</span>
        <span class="token comment">#打印增益值</span>
        <span class="token comment">#print("Gain %f dB, Exposure %d us" % \</span>
        <span class="token comment">#    (sensor.get_gain_db(), sensor.get_exposure_us()))</span>
        <span class="token keyword">if</span> faces<span class="token punctuation">:</span>
            <span class="token comment">#获取image中人像部分largest_face的roi</span>
            largest_face <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>faces<span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token keyword">lambda</span> f<span class="token punctuation">:</span> f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            img<span class="token operator">=</span>sensor<span class="token punctuation">.</span>get_fb<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>crop<span class="token punctuation">(</span>roi<span class="token operator">=</span>largest_face<span class="token punctuation">)</span><span class="token comment">#裁剪人脸部分保存到img</span>

            kpts1<span class="token operator">=</span>img<span class="token punctuation">.</span>find_keypoints<span class="token punctuation">(</span>max_keypoints<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> scale_factor<span class="token operator">=</span><span class="token number">1.3</span><span class="token punctuation">)</span>
            <span class="token comment">#注意，这里就是之前bug的位置，因为找到截取出的人脸图片，因为距离和光线原因，可能找不到特征点</span>
            <span class="token comment">#此时kpts1会返回nonetype，所以必须这边判断一致才能进入特征点比对</span>
            <span class="token comment">#print(type(kpts1).__name__=='kp_desc')#.__name__直接返回数据类型</span>

            <span class="token comment">#print((type(kpts1)=="&lt;class 'kptmatch'&gt;")==0)#python两字符串比较==若相等返回0</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>kpts1<span class="token punctuation">)</span><span class="token punctuation">.</span>__name__<span class="token operator">==</span><span class="token string">'kp_desc'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#kpts1的类型是kp_desc，也就是确保find_keypoints找到了特征点</span>
                type_flag<span class="token operator">=</span><span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kpts1 type wrong"</span><span class="token punctuation">)</span>
                type_flag<span class="token operator">=</span><span class="token number">0</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"find no face"</span><span class="token punctuation">)</span>

       <span class="token comment">#仅当图片中有人脸（正脸）且裁切脸部分找到了特征点，才进行特征点比对判断</span>
        <span class="token keyword">if</span> type_flag<span class="token punctuation">:</span>
            loop_flag<span class="token operator">=</span><span class="token number">0</span>

            lcd<span class="token punctuation">.</span>display<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
            <span class="token comment">#print(type(kpts1))</span>
            <span class="token comment">#print(isinstance(kpts1,Kptmatch))</span>
            <span class="token comment">#img.draw_keypoints(kpts)#画出此时的目标特征,没有调用那个定义的函数</span>
            draw_keypoints<span class="token punctuation">(</span>img<span class="token punctuation">,</span> kpts1<span class="token punctuation">)</span>
            num<span class="token operator">=</span><span class="token number">0</span>
            <span class="token comment">#下面进行特征点比对</span>
            kpts2<span class="token operator">=</span><span class="token boolean">None</span>
            <span class="token comment">#存储每个人的特征值</span>
            feature_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment">#这里赋值0只是为了初始化一个列表，在后面求方差计算的时候把列表长度减一即可，0加</span>
            <span class="token keyword">for</span> s <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> NUM_SUBJECTS<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                match_count <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                angle_count<span class="token operator">=</span><span class="token number">0</span>

                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> NUM_SUBJECTS_IMGS<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    kpts2<span class="token operator">=</span>image<span class="token punctuation">.</span>load_descriptor<span class="token punctuation">(</span><span class="token string">"/keypoints/s%s/%s.orb"</span><span class="token operator">%</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>

                    <span class="token comment">#匹配当前找到的特征和最初的目标特征的相似度</span>
                    <span class="token comment"># #threshold阈值设置匹配的准确度，用来过滤掉有歧义的匹配。这个值越小，准确度越高。阈值范围0～100，默认70</span>
                    <span class="token comment">#filter_outliers默认关闭。</span>
                    <span class="token comment">#对于ORB描述符来说，这个函数返回的是kptmatch对象。</span>
                    <span class="token comment">#print(image.match_descriptor(kpts1, kpts2).count())</span>

                    <span class="token comment">#res=image.match_descriptor(kpts1, kpts2)</span>

                    match_count<span class="token operator">+=</span>image<span class="token punctuation">.</span>match_descriptor<span class="token punctuation">(</span>kpts1<span class="token punctuation">,</span> kpts2<span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>

                    <span class="token comment">#angle_count+=image.match_descriptor(kpts1, kpts2).theta()</span>
                <span class="token comment">#print("Average match_count for subject %d: %d"%(s, match_count/NUM_SUBJECTS_IMGS))</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Average match_count for subject %d: %d"</span><span class="token operator">%</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> match_count<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">#pmax = find_max(pmax, match_count/NUM_SUBJECTS_IMGS, s)#match_count越大，被检测人脸与此样本更相似更匹配。</span>
                pmax <span class="token operator">=</span> find_max<span class="token punctuation">(</span>pmax<span class="token punctuation">,</span> match_count<span class="token punctuation">,</span> s<span class="token punctuation">)</span>
                <span class="token comment">#print("pmax:%d"%pmax)</span>
                feature_values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>match_count<span class="token punctuation">)</span><span class="token comment">#存储每个人的特征值</span>


            <span class="token comment">#计算平均值</span>
            feature_sum<span class="token operator">=</span><span class="token number">0</span>
            <span class="token keyword">for</span> feature_value <span class="token keyword">in</span> feature_values<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"feature_value is %d"</span> <span class="token operator">%</span> feature_value<span class="token punctuation">)</span>
                n<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature_values<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>

                feature_sum<span class="token operator">+=</span>feature_value
            average<span class="token operator">=</span>feature_sum<span class="token operator">/</span>n
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"average is %d"</span> <span class="token operator">%</span> average<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n is %d"</span> <span class="token operator">%</span> n<span class="token punctuation">)</span>

            <span class="token comment">#计算方差 （feature_value-average)的平方累加除n</span>
            pow_sum<span class="token operator">=</span><span class="token number">0</span><span class="token comment">#方差计算式中的分子</span>
            <span class="token keyword">for</span> feature_value <span class="token keyword">in</span> feature_values<span class="token punctuation">:</span>
                <span class="token comment">#这一句将列表的第一个元素置为平均值，消除其对方差值的影响</span>
                <span class="token keyword">if</span> feature_value<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
                    feature_value<span class="token operator">=</span>average
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"此项方差为%d"</span> <span class="token operator">%</span> math<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>feature_value<span class="token operator">-</span>average<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                pow_sum<span class="token operator">+=</span>math<span class="token punctuation">.</span><span class="token builtin">pow</span><span class="token punctuation">(</span>feature_value<span class="token operator">-</span>average<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>

            variance<span class="token operator">=</span>pow_sum<span class="token operator">/</span>n
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"variance is %d"</span> <span class="token operator">%</span> variance<span class="token punctuation">)</span>
            <span class="token comment">#根据方差判断，如果三个人的结果差别很大则方差很大，相对来说结果可信，若差别不大则结果不可信</span>
            <span class="token keyword">if</span> variance<span class="token operator">&lt;</span><span class="token number">1500</span><span class="token punctuation">:</span><span class="token comment">#和三个人都差距都较大，返回0</span>

                <span class="token comment">#考虑写成当最大值和最小值的差值和平均值的差值差多少，则判断问不符合，</span>
                <span class="token comment">#或者方差大则低阈值，方差小则高阈值</span>
                uart<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"unknown person !"</span><span class="token punctuation">)</span> <span class="token comment"># face_num保存s中当前最匹配的人的编号。</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                uart<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>face_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#发送只能是字符，而不能是数字，所以需要格式转换str(b)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The most similar person is:%d"</span><span class="token operator">%</span>face_num<span class="token punctuation">)</span> <span class="token comment"># face_num保存s中当前最匹配的人的编号。</span>


    lcd<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>当然代码中还有许多其他的小细节，比如最后加了一个方差计算，这是为了使得识别陌生人脸更准确，即如果拍摄特征点与内存中存储的三个人的特征点比对结果都差不多，也就是方差小，那就就很有可能并不是三个人中的一个人，而是陌生人，这个方差阈值是经过实践得出的，根据光线可能需要不同调整。</p> 
<p>总结一下（速成版本，系统学习理论请参考其他大佬）：</p> 
<ul><li>LBP局部二值模式：采集一定数量的模板 pgm 图片数据。在进行人脸识别时，将读取到的图片与模板数据库进行相似度比较，从中选取最高相似度的模板，从而确定被测人信息。</li><li>特征点AGAST 算法(Adaptive and Generic Accelerated Segment Test）:多尺度快速角点特征提取算法 步骤：提前保存目标特征 orb 文 件，在进行人脸识别时，提取目标的特征点与特征点库进行匹配得出结果，经过方差计算判断可信度后得出结果。</li></ul> 
<h3><a id="_194"></a>口罩识别</h3> 
<p>两种模型引申出的两种不同方法：（openmv算力不足情况下有已经很不错了）</p> 
<ul><li> <p>第一种是用haar算子，将xml类型的文件转为cascade格式，然后识别，详见<a href="https://blog.csdn.net/z5z5z5z56/article/details/109231021">使用openmv实现识别任意物体</a><br> 用 opencv 级 联 分 类 器 opencv_createsamples.exe 训练并生成.xml 文件，而后将其转换为.cascade 文件，生成口罩检测模型并导入 openmv 中，调用find_features进行识别判断。 其缺点是少量样本（几百个）训练的口罩模型在识别过程中准确度较低，且极易受环境噪 音影响，而大量样本（几万个）样本的训练需要长达几个月的结果才能得到较为精确的模型</p> </li><li> <p>第二种是比赛到最后一天才发现有模型的，使用内置的tflite神经网络框架运行即可。现在openmv手册已经有了哈哈哈，估计是受到了电赛影响吧：<a href="https://book.openmv.cc/project/mask.html" rel="nofollow">https://book.openmv.cc/project/mask.html</a><br> tflite（TensorFlow Lite）是谷歌推出的用于移动设备和 IoT 设备端推断的开源深度学习框架。 在 openmv4 plus 上具备了 2m 闪存和固件级支持的 tf 库，可以对捕捉图片进行脱机的神经 网络运算识别，且市面已具有相对成熟的口罩人脸 tflite 库，相比自己训练口罩模型，识别结果大幅提高</p> </li></ul> 
<h3><a id="_202"></a>现场学习</h3> 
<p>由于使用特征点，现场学习不过就是把拍摄，提取特征点，文件保存放到现场进行罢了，在我这套逻辑下现场学习并没有多出多少难度，我们现场拍摄20张够够的了</p> 
<pre><code class="prism language-python"><span class="token comment">#特征学习</span>
<span class="token keyword">def</span> <span class="token function">machine_learning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sensor<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_contrast<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_gainceiling<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_framesize<span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>VGA<span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_windowing<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>set_pixformat<span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>GRAYSCALE<span class="token punctuation">)</span>

    <span class="token comment">#sensor.set_auto_gain(True, value=0)</span>
    sensor<span class="token punctuation">.</span>set_auto_gain<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> gain_db_ceiling <span class="token operator">=</span> <span class="token number">20.0</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>skip_frames<span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">)</span>
    <span class="token comment">#set_auto_gain :enable 打开（True）或关闭（False）自动增益。默认打开。 value 强迫增益值。</span>


    <span class="token keyword">global</span> NUM_SUBJECTS_IMGS
    <span class="token keyword">global</span> NUM_SUBJECTS
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"last NUM_SUBJECTS =%d"</span> <span class="token operator">%</span> NUM_SUBJECTS<span class="token punctuation">)</span>
    NUM_SUBJECTS<span class="token operator">=</span>NUM_SUBJECTS<span class="token operator">+</span><span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"now NUM_SUBJECTS =%d"</span> <span class="token operator">%</span> NUM_SUBJECTS<span class="token punctuation">)</span>

    p_num<span class="token operator">=</span>NUM_SUBJECTS_IMGS
    s<span class="token operator">=</span>NUM_SUBJECTS
    kpts1 <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token comment">#n=20</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>p_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#红灯亮</span>
        pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>
        faces <span class="token operator">=</span> sensor<span class="token punctuation">.</span>snapshot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gamma_corr<span class="token punctuation">(</span>contrast<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_features<span class="token punctuation">(</span>image<span class="token punctuation">.</span>HaarCascade<span class="token punctuation">(</span><span class="token string">"frontalface"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        lcd<span class="token punctuation">.</span>display<span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>snapshot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        lcd<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> faces<span class="token punctuation">:</span>
            largest_face <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>faces<span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token keyword">lambda</span> f<span class="token punctuation">:</span> f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#获取image中人像部分roi</span>
            img<span class="token operator">=</span>sensor<span class="token punctuation">.</span>get_fb<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>crop<span class="token punctuation">(</span>roi<span class="token operator">=</span>largest_face<span class="token punctuation">)</span><span class="token comment">#裁剪</span>

            lcd<span class="token punctuation">.</span>display<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
            <span class="token comment">#寻找保存整个图片中的特征点，因此要求拍摄内容尽量都是脸,上面进行图片中脸部的局部放大后提取特征点</span>
            kpts1 <span class="token operator">=</span> img<span class="token punctuation">.</span>find_keypoints<span class="token punctuation">(</span>max_keypoints<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> scale_factor<span class="token operator">=</span><span class="token number">1.3</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>kpts1 <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#图片中没有找到特征点</span>
                <span class="token comment">#raise(Exception("Couldn't find any keypoints!"))</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Couldn't find any keypoints!"</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>

                <span class="token comment">#画出此时的目标特征,没有调用那个定义的函数</span>
                <span class="token comment">#img.draw_keypoints(kpts)</span>
                draw_keypoints<span class="token punctuation">(</span>img<span class="token punctuation">,</span> kpts1<span class="token punctuation">)</span>

                lcd<span class="token punctuation">.</span>display<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
                <span class="token comment">#保存此时图片和对应特征点orb文件</span>
                <span class="token comment">#保存截取到的图片到SD卡，蓝灯亮的时候完成一次拍照</span>
                image<span class="token punctuation">.</span>save_descriptor<span class="token punctuation">(</span>kpts1<span class="token punctuation">,</span> <span class="token string">"keypoints/s%s/%s.orb"</span><span class="token operator">%</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>p_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
                img<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"keypoints/s%s/%s.pgm"</span><span class="token operator">%</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>p_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
                p_num<span class="token operator">-=</span><span class="token number">1</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>p_num<span class="token punctuation">)</span>
                <span class="token comment">#存一次亮一下提示</span>
                <span class="token comment">#红灯灭，蓝灯亮</span>
                pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span>
                pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>
                sensor<span class="token punctuation">.</span>skip_frames<span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">)</span>
                pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span>
                uart<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"find no face"</span><span class="token punctuation">)</span>
    <span class="token comment">#学习完成闪两次绿灯</span>
    pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>skip_frames<span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span>
    pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>skip_frames<span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span>
    pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sensor<span class="token punctuation">.</span>skip_frames<span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span>
    pyb<span class="token punctuation">.</span>LED<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span>
    lcd<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
    uart<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#发送f代表学习完成</span>
</code></pre> 
<h3><a id="_281"></a>其他优化算法</h3> 
<p>为了让openmv能获得好的结果真的很努力呢哈哈哈</p> 
<ul><li>直方图均值化：.histeq(adaptive=True, clip_limit=3) 直方图均值化后，灰度直方图几乎覆盖了整个灰度的取值范围，并且除了个别灰度值的个数较为突出，整个灰度值分布近似于均匀分布，经过这样处理的图像将具有较大的灰度动态范围和较高的对比度，图像的细节更为丰富。</li><li>局部放大后识别：上面身边识别说过了。sensor.get_fb().crop(roi=largest_face)首先利用固件库自带人脸haar模型进行识别人脸，识别后截取人脸部分再进行特征点比对，这将提高精确度并减少运算量。</li><li>自动增益：sensor.snapshot().gamma_corr(contrast=1.5)伽马校正用于修正图像中色彩和对比度，数值越高图像越亮</li></ul> 
<p>总的来说那两天是把micropython函数库翻了一遍，能试的都一个个试过去了，这几个是对结果确实有帮助的函数</p> 
<h2><a id="_289"></a>总结</h2> 
<p>我们最终获得了福建省二等奖，由于送测的时候90614模块出了问题，测温爆炸，反而其他部分包括视觉部分都是满分，遗憾没有省一，就当吸取要准备planB的教训了害。<br> 关于openmv部分代码，主要内容都在上面一段一段都po出来了，口罩识别见链接官方有，以上都写出了要点，足够有能力的同学可以复现。</p> 
<p><mark>欢迎在评论区学习讨论，遇到问题的解决和互相交流分享经验，不提供硬件和软件工程代码！！</mark><br> end</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c9502c961ab00544929bae581237d0d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【案例实战】高并发业务的多级缓存架构一致性解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/30d4193493d7aa1c6bdf7b80c6b278d0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">窗口函数 OVER(PARTITION BY ...)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>