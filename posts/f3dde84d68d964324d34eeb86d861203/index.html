<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>模拟退火算法（Simulated Annealing，SA） - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="模拟退火算法（Simulated Annealing，SA）" />
<meta property="og:description" content="这是一篇关于模拟退火算法的总结博客，包括算法思想，算法步骤，Python实现，MATLAB实现，算法进阶等。
目录 1 算法思想2 算法步骤3 SA解函数最小值（python实现）4 SA解旅行商问题（MATLAB实现）5 算法进阶 1 算法思想 SA是基于Monte-Carlo 迭代求解策略的一种随机寻优算法；出发点是基于物理中固体物质的退火过程与组合最优化问题（NP完全问题）之间的相似性。GA其实也是一种Greedy算法，但它比Greedy改进的地方就在于，它的搜索过程用到了Metropolis准则，也就是以一定的概率来接受一个比当前解要差的解，因此有可能会跳出局部最优解，找到全局最优解。Monte-Carlo 基本思想：利用大量采样的方法来求解一些难以直接计算得到的积分。例如，假想你有一袋豆子，把豆子均匀地朝一个形状超级不规则的图形上撒，然后数这个图形之中有多少颗豆子，这个豆子的数目就是图形的面积。当你的豆子越小，撒的越多的时候，结果就越精确。借助计算机程序可以生成大量均匀分布坐标点，然后统计出图形内的点数，通过它们占总点数的比例和坐标点生成范围的面积就可以求出图形面积。（这里我没有明白SA中具体哪里用到了Monte-Carlo思想）物理中固体物质的退火过程：
首先物体刚开始处于非晶体状态（左图）。我们将固体加温至充分高，固体内部粒子随温升变为无序状，能量增大，可以自由运动和重新排列（中图）。再让其缓慢冷却，粒子渐趋有序，在每个温度都达到平衡态，最后完全冷却时能量减为最小，物体形成晶体形态，这就是退火（右图）。 2 算法步骤 look这个函数，我们要求它的最小值。
模拟退火算法是这么做的：
设定初始温度 T 0 T_0 T0​，终止温度 T f T_f Tf​，降温速度 0 &lt; r a t e &lt; 1 0&lt;rate&lt;1 0&lt;rate&lt;1， T 0 T_0 T0​要取的很高，相当于加温到很高的温度。 T f T_f Tf​要取的很小，相当于基态， r a t e rate rate越大，降温越慢。取一个起始点x，算出函数值 f(x)。当 T 0 &gt; T f T_0&gt;T_f T0​&gt;Tf​时，随机让 x 移动，计算新的函数值 f(x&#43;1)；根据Metropolis准则进行判断：
（1）如果新值 f(x &#43; 1) &lt; 当前值f(x) ，以概率1把当前值更新为新值；这很好理解，如果你发现移动到的新点求出来的值更小，肯定要更新当前值；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/f3dde84d68d964324d34eeb86d861203/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-12T21:05:43+08:00" />
<meta property="article:modified_time" content="2022-10-12T21:05:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">模拟退火算法（Simulated Annealing，SA）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>这是一篇关于模拟退火算法的总结博客，包括算法思想，算法步骤，Python实现，MATLAB实现，算法进阶等。<br> </p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#1__2" rel="nofollow">1 算法思想</a></li><li><a href="#2__8" rel="nofollow">2 算法步骤</a></li><li><a href="#3_SApython_42" rel="nofollow">3 SA解函数最小值（python实现）</a></li><li><a href="#4_SAMATLAB_98" rel="nofollow">4 SA解旅行商问题（MATLAB实现）</a></li><li><a href="#5__312" rel="nofollow">5 算法进阶</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1__2"></a>1 算法思想</h2> 
<ol><li>SA是基于Monte-Carlo 迭代求解策略的一种随机寻优算法；出发点是基于物理中固体物质的退火过程与组合最优化问题（NP完全问题）之间的相似性。GA其实也是一种<a href="https://zhuanlan.zhihu.com/p/53334049" rel="nofollow">Greedy算法</a>，但它比Greedy改进的地方就在于，它的搜索过程用到了<a href="https://baike.baidu.com/item/Metropolis%E6%8E%A5%E5%8F%97%E5%87%86%E5%88%99/14678977" rel="nofollow">Metropolis准则</a>，也就是以一定的概率来接受一个比当前解要差的解，因此有可能会跳出局部最优解，找到全局最优解。</li><li><a href="https://www.sohu.com/a/325263789_120054637" rel="nofollow">Monte-Carlo 基本思想</a>：利用大量采样的方法来求解一些难以直接计算得到的积分。例如，假想你有一袋豆子，把豆子均匀地朝一个形状超级不规则的图形上撒，然后数这个图形之中有多少颗豆子，这个豆子的数目就是图形的面积。当你的豆子越小，撒的越多的时候，结果就越精确。借助计算机程序可以生成大量均匀分布坐标点，然后统计出图形内的点数，通过它们占总点数的比例和坐标点生成范围的面积就可以求出图形面积。（这里我没有明白SA中具体哪里用到了Monte-Carlo思想）</li><li>物理中固体物质的退火过程：<br> <img src="https://images2.imgbox.com/31/65/e30uTWZz_o.png" alt="在这里插入图片描述"><br> 首先物体刚开始处于非晶体状态（左图）。我们将固体加温至充分高，固体内部粒子随温升变为无序状，能量增大，可以自由运动和重新排列（中图）。再让其缓慢冷却，粒子渐趋有序，在每个温度都达到平衡态，最后完全冷却时能量减为最小，物体形成晶体形态，这就是退火（右图）。</li></ol> 
<h2><a id="2__8"></a>2 算法步骤</h2> 
<p>look这个函数，我们要求它的最小值。<br> <img src="https://images2.imgbox.com/ab/45/gKWl8mhN_o.png" alt="![在这里插入图片描述](https://img-blog.csdnimg.cn/5520b8174e8a40a1ac6ebd27f17332f3.png"><br> 模拟退火算法是这么做的：</p> 
<ol><li>设定初始温度 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           0 
          
         
        
       
         T_0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，终止温度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           f 
          
         
        
       
         T_f 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1076em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，降温速度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0 
         
        
          &lt; 
         
        
          r 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
          &lt; 
         
        
          1 
         
        
       
         0&lt;rate&lt;1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6835em; vertical-align: -0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6542em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           0 
          
         
        
       
         T_0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>要取的很高，相当于加温到很高的温度。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           f 
          
         
        
       
         T_f 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1076em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>要取的很小，相当于基态，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
       
         rate 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>越大，降温越慢。取一个起始点x，算出函数值 f(x)。</li><li>当 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           0 
          
         
        
          &gt; 
         
         
         
           T 
          
         
           f 
          
         
        
       
         T_0&gt;T_f 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1076em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>时，随机让 x 移动，计算新的函数值 f(x+1)；</li><li>根据Metropolis准则进行判断：<br> （1）如果新值 f(x + 1) &lt; 当前值f(x) ，以概率1把当前值更新为新值；这很好理解，如果你发现移动到的新点求出来的值更小，肯定要更新当前值；<br> （2）如果f(x + 1) &gt; f(x) ，计算概率<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          = 
         
        
          e 
         
        
          x 
         
        
          p 
         
        
          ( 
         
        
          − 
         
         
          
          
            f 
           
          
            ( 
           
          
            x 
           
          
            + 
           
          
            1 
           
          
            ) 
           
          
            − 
           
          
            f 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
          
          
            T 
           
          
            0 
           
          
         
        
          ) 
         
        
       
         P = exp(-\frac{f(x + 1)-f(x)}{T_0}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.4551em; vertical-align: -0.4451em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1076em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.1076em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>。取一个随机数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0 
         
        
          &lt; 
         
        
          r 
         
        
          &lt; 
         
        
          1 
         
        
       
         0&lt;r&lt;1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6835em; vertical-align: -0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>，当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
        
          &lt; 
         
        
          P 
         
        
       
         r&lt;P 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span></span>时把当前值更新为新值，否则不更新。可以发现，当前温度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           0 
          
         
        
       
         T_0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>越大，指数函数括号里的值越大，接受这个新值的概率P越大。随着迭代次数的增加，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           0 
          
         
        
       
         T_0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>会越来越小，接受新值的概率P也会越来越小，相当于渐渐冷却了下来，趋于稳定的状态。</li><li>进行一次降温：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           T 
          
         
           0 
          
         
        
          = 
         
         
         
           T 
          
         
           0 
          
         
        
          ∗ 
         
        
          r 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
       
         T_0=T_0*rate 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>，转到步骤2.</li></ol> 
<p>伪代码：</p> 
<pre><code class="prism language-bash">求函数f（x）的最小值
T0:         系统的初始温度（高温状态）
Tf:      温度的下限
rate:       控制降温的速率
f<span class="token punctuation">(</span>now<span class="token punctuation">)</span>：　　　   系统当前状态的评价函数值
f<span class="token punctuation">(</span>new<span class="token punctuation">)</span>:　 　　系统新状态的评价函数值
 
<span class="token keyword">while</span> <span class="token punctuation">(</span>T0 <span class="token operator">&gt;</span> Tf<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> f<span class="token punctuation">(</span>new<span class="token punctuation">)</span> - f<span class="token punctuation">(</span>now<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span>
    　　f<span class="token punctuation">(</span>now<span class="token punctuation">)</span> <span class="token operator">=</span> f<span class="token punctuation">(</span>new<span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>exp<span class="token punctuation">(</span>f<span class="token punctuation">(</span>new<span class="token punctuation">)</span> - f<span class="token punctuation">(</span>now<span class="token punctuation">)</span> / T0<span class="token punctuation">)</span> <span class="token operator">&gt;</span> random<span class="token punctuation">(</span><span class="token number">0,1</span><span class="token punctuation">))</span>
    　　f<span class="token punctuation">(</span>now<span class="token punctuation">)</span> <span class="token operator">=</span> f<span class="token punctuation">(</span>new<span class="token punctuation">)</span>
    <span class="token keyword">else</span>
    　　不更新f<span class="token punctuation">(</span>now<span class="token punctuation">)</span>
    T0 <span class="token operator">=</span> T0 * rate<span class="token punctuation">;</span>
    更新状态new        　　　　　　　　
<span class="token punctuation">}</span>

循环结束，得到模拟退火求得的最小值f<span class="token punctuation">(</span>now<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="3_SApython_42"></a>3 SA解函数最小值（python实现）</h2> 
<p>求下列函数的最小值：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          f 
         
        
          ( 
         
        
          x 
         
        
          ) 
         
        
          = 
         
         
         
           x 
          
         
           3 
          
         
        
          − 
         
        
          60 
         
         
         
           x 
          
         
           2 
          
         
        
          − 
         
        
          4 
         
        
          x 
         
        
          + 
         
        
          6 
         
        
       
         f(x)= x^3-60x^2-4x+6 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord">60</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">4</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">6</span></span></span></span></span></span><br> 定义域为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         [ 
        
       
         0 
        
       
         , 
        
       
         100 
        
       
         ] 
        
       
      
        [0,100] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">100</span><span class="mclose">]</span></span></span></span></span></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> division
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> math


<span class="token comment"># define aim function</span>
<span class="token keyword">def</span> <span class="token function">aimFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">3</span> <span class="token operator">-</span> <span class="token number">60</span> <span class="token operator">*</span> x <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> x <span class="token operator">+</span> <span class="token number">6</span>
    <span class="token keyword">return</span> y


x <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">10</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> aimFunction<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
T <span class="token operator">=</span> <span class="token number">1000</span>  <span class="token comment"># initiate temperature</span>
Tmin <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment"># minimum value of terperature</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>low<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> high<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># initiate x</span>
k <span class="token operator">=</span> <span class="token number">50</span>  <span class="token comment"># times of internal circulation</span>
y <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># initiate result</span>
t <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># time</span>
<span class="token keyword">while</span> T <span class="token operator">&gt;=</span> Tmin<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># calculate y</span>
        y <span class="token operator">=</span> aimFunction<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token comment"># generate a new x in the neighboorhood of x by transform function</span>
        xNew <span class="token operator">=</span> x <span class="token operator">+</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>low<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.055</span><span class="token punctuation">,</span> high<span class="token operator">=</span><span class="token number">0.055</span><span class="token punctuation">)</span> <span class="token operator">*</span> T
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;=</span> xNew <span class="token keyword">and</span> xNew <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            yNew <span class="token operator">=</span> aimFunction<span class="token punctuation">(</span>xNew<span class="token punctuation">)</span>
            <span class="token keyword">if</span> yNew <span class="token operator">-</span> y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                x <span class="token operator">=</span> xNew
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token comment"># metropolis principle</span>
                p <span class="token operator">=</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>yNew <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">/</span> T<span class="token punctuation">)</span>
                r <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>low<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> high<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> r <span class="token operator">&lt;</span> p<span class="token punctuation">:</span>
                    x <span class="token operator">=</span> xNew
    t <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    T <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> t<span class="token punctuation">)</span>  <span class="token comment">#降温函数，也可使用T=0.9T</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> aimFunction<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<p>通过求导计算得到的精确最小值为 40.033，运行求得的最小值为40.072。</p> 
<h2><a id="4_SAMATLAB_98"></a>4 SA解旅行商问题（MATLAB实现）</h2> 
<p><a href="https://blog.csdn.net/weixin_43848614/article/details/107974638">代码来源</a></p> 
<ol><li>总函数：</li></ol> 
<pre><code class="prism language-bash">%% I. 清空环境变量
<span class="token function">clear</span> all
clc
 
%% II. 导入城市位置数据
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">16.4700</span>   <span class="token number">96.1000</span>
     <span class="token number">16.4700</span>   <span class="token number">94.4400</span>
     <span class="token number">20.0900</span>   <span class="token number">92.5400</span>
     <span class="token number">22.3900</span>   <span class="token number">93.3700</span>
     <span class="token number">25.2300</span>   <span class="token number">97.2400</span>
     <span class="token number">22.0000</span>   <span class="token number">96.0500</span>
     <span class="token number">20.4700</span>   <span class="token number">97.0200</span>
     <span class="token number">17.2000</span>   <span class="token number">96.2900</span>
     <span class="token number">16.3000</span>   <span class="token number">97.3800</span>
     <span class="token number">14.0500</span>   <span class="token number">98.1200</span>
     <span class="token number">16.5300</span>   <span class="token number">97.3800</span>
     <span class="token number">21.5200</span>   <span class="token number">95.5900</span>
     <span class="token number">19.4100</span>   <span class="token number">97.1300</span>
     <span class="token number">20.0900</span>   <span class="token number">92.5500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
%% III. 计算距离矩阵
D <span class="token operator">=</span> Distance<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>  %计算距离矩阵
n <span class="token operator">=</span> size<span class="token punctuation">(</span>D,1<span class="token punctuation">)</span><span class="token punctuation">;</span>    %城市的个数
 
%% IV. 初始化参数
T0 <span class="token operator">=</span> 1e10<span class="token punctuation">;</span>                                                                  % 初始温度
Tf <span class="token operator">=</span> 1e-30<span class="token punctuation">;</span>                                                                 % 终止温度
q <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">;</span>                                                                    % 降温速率
Time <span class="token operator">=</span> ceil<span class="token punctuation">(</span>double<span class="token punctuation">(</span>solve<span class="token punctuation">(</span><span class="token punctuation">[</span>num2str<span class="token punctuation">(</span>T0<span class="token punctuation">)</span> <span class="token string">'*(0.9)^x = '</span>, num2str<span class="token punctuation">(</span>Tf<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       % 计算迭代的次数 T0 * <span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">)</span>^x <span class="token operator">=</span> Tf
count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                                                                  % 初始化迭代计数
Obj <span class="token operator">=</span> zeros<span class="token punctuation">(</span>Time, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                       % 目标值矩阵初始化
path <span class="token operator">=</span> zeros<span class="token punctuation">(</span>Time, n<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                      % 每代的最优路线矩阵初始化
 
%% V. 随机产生一个初始路线
S1 <span class="token operator">=</span> randperm<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
DrawPath<span class="token punctuation">(</span>S1, X<span class="token punctuation">)</span>                                                             % 画出初始路线
disp<span class="token punctuation">(</span><span class="token string">'初始种群中的一个随机值:'</span><span class="token punctuation">)</span>
OutputPath<span class="token punctuation">(</span>S1<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                             % 用箭头的形式表述初始路线
rlength <span class="token operator">=</span> PathLength<span class="token punctuation">(</span>D, S1<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                % 计算初始路线的总长度
disp<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'总距离：'</span>, num2str<span class="token punctuation">(</span>rlength<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
%% VI. 迭代优化
<span class="token keyword">while</span> T0 <span class="token operator">&gt;</span> Tf
    count <span class="token operator">=</span> count + <span class="token number">1</span><span class="token punctuation">;</span>                                                      % 更新迭代次数
    %temp <span class="token operator">=</span> zeros<span class="token punctuation">(</span>L,n+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    % <span class="token number">1</span>. 产生新解
    S2 <span class="token operator">=</span> NewAnswer<span class="token punctuation">(</span>S1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    % <span class="token number">2</span>. Metropolis法则判断是否接受新解
    <span class="token punctuation">[</span>S1, R<span class="token punctuation">]</span> <span class="token operator">=</span> Metropolis<span class="token punctuation">(</span>S1, S2, D, T0<span class="token punctuation">)</span><span class="token punctuation">;</span>                                    % Metropolis 抽样算法
    % <span class="token number">3</span>. 记录每次迭代过程的最优路线
    <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> R <span class="token operator">&lt;</span> Obj<span class="token punctuation">(</span>count-1<span class="token punctuation">)</span>                                       % 如果当前温度下的距离小于上个温度的距离，记录当前距离
        Obj<span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token operator">=</span> R<span class="token punctuation">;</span>                                                    
    <span class="token keyword">else</span>
        Obj<span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token operator">=</span> Obj<span class="token punctuation">(</span>count-1<span class="token punctuation">)</span><span class="token punctuation">;</span>                                         
    end
    path<span class="token punctuation">(</span>count,:<span class="token punctuation">)</span> <span class="token operator">=</span> S1<span class="token punctuation">;</span>                                                     % 记录每次迭代的路线
    T0 <span class="token operator">=</span> q * T0<span class="token punctuation">;</span>                                                            % 以q的速率降温
end
 
%% VII. 优化过程迭代图
figure
plot<span class="token punctuation">(</span><span class="token number">1</span>: count, Obj<span class="token punctuation">)</span>
xlabel<span class="token punctuation">(</span><span class="token string">'迭代次数'</span><span class="token punctuation">)</span>
ylabel<span class="token punctuation">(</span><span class="token string">'距离'</span><span class="token punctuation">)</span>
title<span class="token punctuation">(</span><span class="token string">'优化过程'</span><span class="token punctuation">)</span>
grid on
 
%% VIII. 绘制最优路径图
DrawPath<span class="token punctuation">(</span>path<span class="token punctuation">(</span>end, <span class="token builtin class-name">:</span><span class="token punctuation">)</span>, X<span class="token punctuation">)</span>                                                   % path矩阵的最后一行一定是最优路线
 
%% IX. 输出最优解的路线和总距离
disp<span class="token punctuation">(</span><span class="token string">'最优解:'</span><span class="token punctuation">)</span>
S <span class="token operator">=</span> path<span class="token punctuation">(</span>end, <span class="token builtin class-name">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p <span class="token operator">=</span> OutputPath<span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
disp<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'总距离：'</span>, num2str<span class="token punctuation">(</span>PathLength<span class="token punctuation">(</span>D, S<span class="token punctuation">))</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<ol start="2"><li>Metropolis准则判定函数:</li></ol> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> <span class="token punctuation">[</span>S,R<span class="token punctuation">]</span> <span class="token operator">=</span> Metropolis<span class="token punctuation">(</span>S1, S2, D, T<span class="token punctuation">)</span>
%% 输入
% S1：  当前解
% S2:   新解
% D:    距离矩阵（两两城市的之间的距离）
% T:    当前温度
%% 输出
% S：   更新后的当前解
% R：   更新后的路线距离
 
R1 <span class="token operator">=</span> PathLength<span class="token punctuation">(</span>D, S1<span class="token punctuation">)</span><span class="token punctuation">;</span>         % 计算S1路线长度
n <span class="token operator">=</span> length<span class="token punctuation">(</span>S1<span class="token punctuation">)</span><span class="token punctuation">;</span>                 % 城市的个数
 
R2 <span class="token operator">=</span> PathLength<span class="token punctuation">(</span>D,S2<span class="token punctuation">)</span><span class="token punctuation">;</span>          % 计算S2路线长度
dC <span class="token operator">=</span> R2 - R1<span class="token punctuation">;</span>                   % 计算能力之差
<span class="token keyword">if</span> dC <span class="token operator">&lt;</span> <span class="token number">0</span>                       % 如果能力降低 接受新路线
    S <span class="token operator">=</span> S2<span class="token punctuation">;</span>                     % 接受新解
    R <span class="token operator">=</span> R2<span class="token punctuation">;</span>
elseif exp<span class="token punctuation">(</span>-dC/T<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> rand       % 以exp<span class="token punctuation">(</span>-dC/T<span class="token punctuation">)</span>概率接受新路线
    S <span class="token operator">=</span> S2<span class="token punctuation">;</span>
    R <span class="token operator">=</span> R2<span class="token punctuation">;</span>
<span class="token keyword">else</span>                            % 不接受新路线
    S <span class="token operator">=</span> S1<span class="token punctuation">;</span>
    R <span class="token operator">=</span> R1<span class="token punctuation">;</span>
end
end

</code></pre> 
<ol start="3"><li>更新新解的函数:</li></ol> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> S2 <span class="token operator">=</span> NewAnswer<span class="token punctuation">(</span>S1<span class="token punctuation">)</span>
% 输入：当前解S1
% 输出：新解S2
 
n <span class="token operator">=</span> length<span class="token punctuation">(</span>S1<span class="token punctuation">)</span><span class="token punctuation">;</span>
S2 <span class="token operator">=</span> S1<span class="token punctuation">;</span>
a <span class="token operator">=</span> round<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span><span class="token punctuation">)</span> * <span class="token punctuation">(</span>n - <span class="token number">1</span><span class="token punctuation">)</span> + <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    %产生两个随机位置，用于交换
W <span class="token operator">=</span> S2<span class="token punctuation">(</span>a<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
S2<span class="token punctuation">(</span>a<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span> <span class="token operator">=</span> S1<span class="token punctuation">(</span>a<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
S2<span class="token punctuation">(</span>a<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">))</span> <span class="token operator">=</span> W<span class="token punctuation">;</span>

</code></pre> 
<ol start="4"><li>计算两两城市之间的距离:</li></ol> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> D <span class="token operator">=</span> Distance<span class="token punctuation">(</span>citys<span class="token punctuation">)</span>
% 输入:各城市的位置坐标<span class="token punctuation">(</span>citys<span class="token punctuation">)</span>
% 输出:两两城市之间的距离<span class="token punctuation">(</span>D<span class="token punctuation">)</span>
 
n <span class="token operator">=</span> size<span class="token punctuation">(</span>citys, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
D <span class="token operator">=</span> zeros<span class="token punctuation">(</span>n, n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span>: n
    <span class="token keyword">for</span> j <span class="token operator">=</span> i + <span class="token number">1</span>: n
        D<span class="token punctuation">(</span>i, j<span class="token punctuation">)</span> <span class="token operator">=</span> sqrt<span class="token variable"><span class="token punctuation">((</span>citys<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> citys<span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">))</span></span>^2 + <span class="token punctuation">(</span>citys<span class="token punctuation">(</span>i, <span class="token number">2</span><span class="token punctuation">)</span> - citys<span class="token punctuation">(</span>j, <span class="token number">2</span><span class="token punctuation">))</span>^2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        D<span class="token punctuation">(</span>j, i<span class="token punctuation">)</span> <span class="token operator">=</span> D<span class="token punctuation">(</span>i, j<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end
</code></pre> 
<ol start="5"><li>画路径函数：</li></ol> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> DrawPath<span class="token punctuation">(</span>Route, citys<span class="token punctuation">)</span>
%% 画路径函数
% 输入
% Route  待画路径  
% citys  各城市坐标位置
 
%画出初始路线
figure
plot<span class="token punctuation">(</span><span class="token punctuation">[</span>citys<span class="token punctuation">(</span>Route, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> citys<span class="token punctuation">(</span>Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>, <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>, <span class="token punctuation">[</span>citys<span class="token punctuation">(</span>Route, <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> citys<span class="token punctuation">(</span>Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>, <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>, <span class="token string">'o-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on
 
%给每个地点标上序号
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span>: size<span class="token punctuation">(</span>citys, <span class="token number">1</span><span class="token punctuation">)</span>
    text<span class="token punctuation">(</span>citys<span class="token punctuation">(</span>i, <span class="token number">1</span><span class="token punctuation">)</span>, citys<span class="token punctuation">(</span>i, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token punctuation">[</span><span class="token string">'   '</span> num2str<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
 
text<span class="token punctuation">(</span>citys<span class="token punctuation">(</span>Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>, <span class="token number">1</span><span class="token punctuation">)</span>, citys<span class="token punctuation">(</span>Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token string">'       起点'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
text<span class="token punctuation">(</span>citys<span class="token punctuation">(</span>Route<span class="token punctuation">(</span>end<span class="token punctuation">)</span>, <span class="token number">1</span><span class="token punctuation">)</span>, citys<span class="token punctuation">(</span>Route<span class="token punctuation">(</span>end<span class="token punctuation">)</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token string">'       终点'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="6"><li>用箭头的形式描绘出路径方向：</li></ol> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> p <span class="token operator">=</span> OutputPath<span class="token punctuation">(</span>Route<span class="token punctuation">)</span>
% 输入: 路径Route
% 输出: 路径函数

%给R末端添加起点即R<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
Route <span class="token operator">=</span> <span class="token punctuation">[</span>Route, Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
n <span class="token operator">=</span> length<span class="token punctuation">(</span>Route<span class="token punctuation">)</span><span class="token punctuation">;</span>
p <span class="token operator">=</span> num2str<span class="token punctuation">(</span>Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
 
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">2</span>: n
    p <span class="token operator">=</span> <span class="token punctuation">[</span>p, <span class="token string">' —&gt; '</span>, num2str<span class="token punctuation">(</span>Route<span class="token punctuation">(</span>i<span class="token punctuation">))</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
end
disp<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
</code></pre> 
<ol start="7"><li>计算起点与终点之间的路径长度</li></ol> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> Length <span class="token operator">=</span> PathLength<span class="token punctuation">(</span>D, Route<span class="token punctuation">)</span>
%% 输入
% D 两两城市之间的距离
% Route 路线
%% 输出
起点与终点之间的路径长度Length
 
Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
n <span class="token operator">=</span> length<span class="token punctuation">(</span>Route<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span>: <span class="token punctuation">(</span>n - <span class="token number">1</span><span class="token punctuation">)</span>
    Length <span class="token operator">=</span> Length + D<span class="token punctuation">(</span>Route<span class="token punctuation">(</span>i<span class="token punctuation">)</span>, Route<span class="token punctuation">(</span>i + <span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
end
 
Length <span class="token operator">=</span> Length + D<span class="token punctuation">(</span>Route<span class="token punctuation">(</span>n<span class="token punctuation">)</span>, Route<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
</code></pre> 
<p>运行了上述代码后，得到的结果如下：</p> 
<pre><code class="prism language-bash">初始解:
<span class="token number">11</span> —<span class="token operator">&gt;</span> <span class="token number">10</span> —<span class="token operator">&gt;</span> <span class="token number">14</span> —<span class="token operator">&gt;</span> <span class="token number">9</span> —<span class="token operator">&gt;</span> <span class="token number">5</span> —<span class="token operator">&gt;</span> <span class="token number">3</span> —<span class="token operator">&gt;</span> <span class="token number">7</span> —<span class="token operator">&gt;</span> <span class="token number">4</span> —<span class="token operator">&gt;</span> <span class="token number">8</span> —<span class="token operator">&gt;</span> <span class="token number">1</span> —<span class="token operator">&gt;</span> <span class="token number">2</span> —<span class="token operator">&gt;</span> <span class="token number">13</span> —<span class="token operator">&gt;</span> <span class="token number">12</span> —<span class="token operator">&gt;</span> <span class="token number">6</span> —<span class="token operator">&gt;</span> <span class="token number">11</span>
总距离：62.7207
SA求得的最优解:
<span class="token number">9</span> —<span class="token operator">&gt;</span> <span class="token number">11</span> —<span class="token operator">&gt;</span> <span class="token number">8</span> —<span class="token operator">&gt;</span> <span class="token number">13</span> —<span class="token operator">&gt;</span> <span class="token number">7</span> —<span class="token operator">&gt;</span> <span class="token number">12</span> —<span class="token operator">&gt;</span> <span class="token number">6</span> —<span class="token operator">&gt;</span> <span class="token number">5</span> —<span class="token operator">&gt;</span> <span class="token number">4</span> —<span class="token operator">&gt;</span> <span class="token number">3</span> —<span class="token operator">&gt;</span> <span class="token number">14</span> —<span class="token operator">&gt;</span> <span class="token number">2</span> —<span class="token operator">&gt;</span> <span class="token number">1</span> —<span class="token operator">&gt;</span> <span class="token number">10</span> —<span class="token operator">&gt;</span> <span class="token number">9</span>
总距离：29.3405
</code></pre> 
<p>随着迭代次数的增加，SA找到的最短路径变化图如下：<br> <img src="https://images2.imgbox.com/9a/71/aEr8uNny_o.png" alt="在这里插入图片描述"><br> 可以看出，随着不断的迭代，距离是一直在不断下降的。我们不能保证最终的答案一定是最短的，迭代的次数越多，得到的结果就越接近正确答案。但是迭代次数过多就会需要很长的计算时间，所以要适当选择迭代次数。</p> 
<h2><a id="5__312"></a>5 算法进阶</h2> 
<p><strong>1 算法特点：</strong></p> 
<ol><li>如果<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
       
         rate 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>太小，降温就会太快，很可能最终得不到全局最优解。</li><li>理论上来说，只要<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
       
         rate 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>足够大，降温过程足够慢，就一定可以找到全局最优解。但对于计算机来说，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
       
         rate 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span></span>太大会影响计算速度。所以要找到一个合适的方法来权衡解的性能和计算速度。</li><li>可以为循环结束再加一个条件，当连续m次迭代都没有更新当前最优值时，可以认为已经找到了全局最优值，可以提前结束算法。找到一个合适的m值是一个问题。</li><li>初始温度的选择和可行解的邻域也需要研究。</li><li>模拟退火在求解规模较大的问题时，收敛速度很慢。</li></ol> 
<p><strong>2 改进的可行方案：</strong></p> 
<ol><li>设计合适的状态产生函数；</li><li>设计高效的退火历程；</li><li>避免状态的迂回搜索；</li><li>采用并行搜索结构；</li><li>避免陷入局部极小，改进对温度的控制方式；</li><li>选择合适的初始状态；</li><li>设计合适的算法终止准则。</li></ol> 
<p><strong>3 改进的方式：</strong></p> 
<ol><li>增加升温或重升温过程，避免陷入局部极小；</li><li>增加记忆功能（记忆“Best so far”状态）；</li><li>增加补充搜索过程（以最优结果为初始解）；</li><li>对每一当前状态，采用多次搜索策略，以概率接受区域内的最优状态；</li><li>结合其它搜索机制的算法；</li><li>上述各方法的综合。</li></ol> 
<p><strong>4 改进的思路：</strong></p> 
<ol><li>记录“Best so far”状态，并即时更新；</li><li>设置双阈值，使得在尽量保持最优性的前提下减少计算量，即在各温度下当前状态连续 m1 步保持不变则认为Metropolis抽样稳定，若连续 m2 次退温过程中所得最优解不变则认为算法收敛。</li></ol> 
<p><strong>5 改进的退火过程</strong></p> 
<ol><li>给定初温t0，随机产生初始状态s，令初始最优解s*=s，当前状态为s(0)=s，i=p=0；</li><li>令t=ti，以t，s和s(i)调用改进的抽样过程，返回其所得最优解s’和当前状态s’(k)，令当前状态s(i)=s’(k)；</li><li>判断C(s*)&lt;C(s*’)? 若是，则令p=p+1；否则，令s*=s*’，p=0；</li><li>退温ti+1=update(ti)，令i=i+1；</li><li>判断p&gt;m2? 若是，则转第(6)步；否则，返回第(2)步；</li><li>以最优解s*作为最终解输出，停止算法。</li></ol> 
<p><strong>6 改进的抽样过程</strong></p> 
<ol><li>令k=0时的初始当前状态为s’(0)=s(i)，q=0；</li><li>由状态s通过状态产生函数产生新状态s’，计算增量∆C’=C(s’)-C(s)；</li><li>若∆C’&lt;0，则接受s’作为当前解，并判断C(s*’)&gt;C(s’)? 若是，则令s*’=s’，q=0；否则，令q=q+1。若∆C’&gt;0，则以概率exp(-∆C’/t)接受s’作为下一当前状态；</li><li>令k=k+1，判断q&gt;m1? 若是，则转第(5)步；否则，返回第(2)步；</li><li>将当前最优解s*’和当前状态s’(k)返回改进退火过程。</li></ol> 
<p><strong>时间不变的噪声算法（TINA Time-invariant noise algorithm）</strong><br> 状态产生函数中扰动强度不随时间改变，而是和能量大小相关，能量大的扰动大，能量小的扰动小，能量为零，扰动也为零，算法停止。</p> 
<p><strong>单调升温(Monotonic temperature rising) SA</strong><br> 在算法退火后期，温度很低且陷入局部极小解的时，算法很难跳出。因此，可以适当重新提高温度，促使算法跳出。</p> 
<p><strong>记忆指导SA(Simulated Annealing with Memmory Guidance ,简记为SAMG)</strong><br> 增加一个记忆装置，存储算法计算过程产生的最好的解，以这个解为最终解。</p> 
<p><strong>自适应SA算法</strong><br> 根据邻域搜索进展的反馈信息, 自适应确定温度变化和邻域搜索强度特点：</p> 
<p>退火过程中温度参数变化符合幅值递减的下降总趋势, 但不排除局部升温的可能, 以保证寻求到合适的温度序列, 避免陷入局部最优;<br> 算法的终止条件依据退火温度和邻域搜索进展状态设计;<br> 每一温度下算法的迭代次数随温度下降而递增, 邻域搜索强度依其对目标函数的贡献动态分配;<br> 温度变化、邻域搜索和终止条件的控制机制由算法过程自动触发。</p> 
<p><strong>并行性</strong><br> 操作并行性：各个环节同时处理；<br> 进程并行性：同时多个算法运行；<br> 空间并行性：解空间分解分别处理，最终组合。</p> 
<p><strong>传统优化算法与全局优化算法的对比：</strong><br> 全局优化算法：</p> 
<ol><li>不依赖于初始条件；</li><li>不与求解空间有紧密关系，对解域，无可微或连续的要求。求解稳健，但收敛速度慢。能获得全局最优。适合于求解空间不知的情况</li></ol> 
<p>传统优化算法：</p> 
<ol><li>依赖于初始条件。</li><li>与求解空间有紧密关系，促使较快地收敛到局部解，但同时对解域有约束，如可微或连续。利用这些约束，收敛快。</li><li>有些方法，如Davison-Fletcher-Powell直接依赖于至少一阶导数；共轭梯度法隐含地依赖于梯度。</li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02e9538b235fca3dcda90c1f6bef7903/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从零构建libbpf&#43;ebpf CO-RE程序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/afc78130920e24d5daf1dda420306cd2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">遗传算法（Genetic Algorithm，GA）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>