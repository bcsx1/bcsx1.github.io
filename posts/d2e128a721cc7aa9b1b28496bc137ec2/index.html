<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hive3从入门到精通 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="hive3从入门到精通" />
<meta property="og:description" content="查询hive 架构 准备 HDFS配置 vim $HADOOP_HOME/etc/hadoop/core-site.xml &lt;!--配置所有节点的root用户都可作为代理用户--&gt; &lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;/property&gt; &lt;!--配置root用户能够代理的用户组为任意组--&gt; &lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;/property&gt; &lt;!--配置root用户能够代理的用户为任意用户--&gt; &lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.users&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;/property&gt; 启动Hadoop # 启动hadoop start-all.sh # 检查hadoop进程 jps # 检查各端口 netstat -aplnt | grep java 检查MySQL是否启动成功 ps -aux | grep mysql netstat -aplnt | grep 3306 安装hive # 将软件上传到 /opt/soft 目录 # 解压hive tar -zxvf apache-hive-3.1.3-bin.tar.gz # 目录改名 mv apache-hive-3.1.3-bin hive-3 # 进入配置文件目录 cd /opt/soft/hive-3/conf # 复制配置文件 cp hive-env.sh.template hive-env." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/d2e128a721cc7aa9b1b28496bc137ec2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-20T11:41:28+08:00" />
<meta property="article:modified_time" content="2023-11-20T11:41:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">hive3从入门到精通</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="hive_1"></a>查询hive</h2> 
<h3><a id="_3"></a>架构</h3> 
<p><img src="https://images2.imgbox.com/72/be/mSK5P0nY_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/94/c7/KB1YH12P_o.png" alt="hive体系架构"><br> <img src="https://images2.imgbox.com/bb/cd/mwvrU3TJ_o.png" alt="hive执行流程"><br> <img src="https://images2.imgbox.com/a1/fb/T0E2mnuj_o.png" alt="hive架构"></p> 
<h3><a id="_11"></a>准备</h3> 
<h4><a id="HDFS_13"></a>HDFS配置</h4> 
<pre><code class="prism language-bash"><span class="token function">vim</span> <span class="token variable">$HADOOP_HOME</span>/etc/hadoop/core-site.xml 
</code></pre> 
<pre><code class="prism language-xml">  <span class="token comment">&lt;!--配置所有节点的root用户都可作为代理用户--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.proxyuser.root.hosts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!--配置root用户能够代理的用户组为任意组--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.proxyuser.root.groups<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!--配置root用户能够代理的用户为任意用户--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.proxyuser.root.users<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<h4><a id="Hadoop_40"></a>启动Hadoop</h4> 
<pre><code class="prism language-bash"><span class="token comment"># 启动hadoop</span>
start-all.sh
<span class="token comment"># 检查hadoop进程</span>
jps
<span class="token comment"># 检查各端口</span>
<span class="token function">netstat</span> <span class="token parameter variable">-aplnt</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">java</span>
</code></pre> 
<h4><a id="MySQL_51"></a>检查MySQL是否启动成功</h4> 
<pre><code>ps -aux | grep mysql
netstat -aplnt | grep 3306
</code></pre> 
<h3><a id="hive_58"></a>安装hive</h3> 
<pre><code class="prism language-bash"><span class="token comment"># 将软件上传到 /opt/soft 目录</span>
<span class="token comment"># 解压hive</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apache-hive-3.1.3-bin.tar.gz 
<span class="token comment"># 目录改名</span>
<span class="token function">mv</span> apache-hive-3.1.3-bin hive-3
<span class="token comment"># 进入配置文件目录</span>
<span class="token builtin class-name">cd</span> /opt/soft/hive-3/conf
<span class="token comment"># 复制配置文件</span>
<span class="token function">cp</span> hive-env.sh.template  hive-env.sh
<span class="token function">cp</span> hive-default.xml.template  hive-site.xml
<span class="token comment"># 编辑环境配置文件</span>
<span class="token function">vim</span> hive-env.sh
<span class="token comment"># 编辑配置文件</span>
<span class="token function">vim</span> hive-site.xml
</code></pre> 
<h4><a id="hiveenvsh_77"></a>hive-env.sh</h4> 
<pre><code class="prism language-bash"><span class="token comment"># hadoop 安装路径</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/opt/soft/hadoop-3/
<span class="token comment"># hive 配置文件路径</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_CONF_DIR</span><span class="token operator">=</span>/opt/soft/hive-3/conf/
</code></pre> 
<h4><a id="hivesitexml_86"></a>hive-site.xml</h4> 
<pre><code class="prism language-xml">
</code></pre> 
<blockquote> 
 <p>需要修改的位置提炼如下：</p> 
</blockquote> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 记录HIve中的元数据信息  记录在mysql中 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://spark03:3306/hive?useUnicode=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>createDatabaseIfNotExist=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF8<span class="token entity named-entity" title="&amp;">&amp;amp;</span>useSSL=false<span class="token entity named-entity" title="&amp;">&amp;amp;</span>serverTimeZone=Asia/Shanghai<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- jdbc mysql驱动 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionDriverName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>com.mysql.cj.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- mysql的用户名和密码 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionUserName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionPassword<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>Lihaozhe!!@@1122<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.warehouse.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/user/hive/warehouse<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.exec.scratchdir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/user/hive/tmp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.exec.local.scratchdir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/user/hive/local<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Local scratch space for Hive jobs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.downloaded.resources.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/user/hive/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Temporary local directory for added resources in the remote file system.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 日志目录 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.querylog.location<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/user/hive/log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 设置metastore的节点信息 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.uris<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>thrift://spark01:9083<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 客户端远程连接的端口 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.server2.thrift.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>10000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.server2.thrift.bind.host<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>0.0.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.server2.webui.host<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>0.0.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- hive服务的页面的端口 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.server2.webui.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>10002<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.server2.long.polling.timeout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>5000ms<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.server2.enable.doAs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--
&lt;property&gt;
&lt;name&gt;datanucleus.autoCreateSchema&lt;/name&gt;
&lt;value&gt;false&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
&lt;name&gt;datanucleus.fixedDatastore&lt;/name&gt;
&lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.execution.engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mr<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.schema.verification<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>
          Enforce metastore schema version consistency.
          True: Verify that version information stored in is compatible with one from Hive jars.  Also disable automatic
                schema migration attempt. Users are required to manually migrate schema after Hive upgrade which ensures
                proper metastore schema migration. (Default)
          False: Warn if the version information stored in metastore doesn't match with one from in Hive jars.
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>注意：上面配置文件中的路径在 vi 编辑器下 全局替换</p> 
 <pre><code class="prism language-bash">:%s@<span class="token punctuation">\</span><span class="token variable">${system<span class="token operator">:</span>java.io.tmpdir}</span>@/tmp/hive-log@g
</code></pre> 
 <p>不要使用图形化 不然每次保存后3215行都会有个 &amp;#8 特殊字符 如果产生删除即可 具体报错信息 后面有单独的描述</p> 
</blockquote> 
<h4><a id="_MySQL__jar__hive_lib_220"></a>上传 MySQL 连接驱动 jar 包到 hive 安装目录的lib目录下:</h4> 
<pre><code>$HIVE_HOME/lib
</code></pre> 
<blockquote> 
 <p>删除原有的 protobuf-java-2.5.0.jar 文件</p> 
 <p>jar 包有两个 分别为：</p> 
 <ul><li>mysql-connector-j-8.0.33.jar</li><li>protobuf-java-3.5.1.jar</li></ul> 
</blockquote> 
<h4><a id="guava_233"></a>guava版本冲突</h4> 
<p>删除 hive/lib目录中的 guava-19.0.jar</p> 
<p>拷贝hadoop/share/hadoop/common/lib目录中的 guava-27.0-jre.jar 到 hive/lib 目录</p> 
<pre><code class="prism language-bash"><span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$HIVE_HOME</span>/lib/guava-19.0.jar
<span class="token function">cp</span> <span class="token parameter variable">-v</span> <span class="token variable">$HADOOP_HOME</span>/share/hadoop/common/lib/guava-27.0-jre.jar <span class="token variable">$HIVE_HOME</span>/lib
</code></pre> 
<h4><a id="_244"></a>配置环境变量</h4> 
<pre><code class="prism language-bash"><span class="token function">vim</span> /etc/profile.d/my_env.sh
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_HOME</span><span class="token operator">=</span>/opt/soft/hive-3
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HCATALOG_HOME</span><span class="token operator">=</span>/opt/soft/hive-3/hcatalog

<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$ZOOKEEPER_HOME</span>/bin:<span class="token variable">$HADOOP_HOME</span>/bin:<span class="token variable">$HADOOP_HOME</span>/sbin:<span class="token variable">$HIVE_HOME</span>/bin:<span class="token variable">$HCATALOG_HOME</span>/bin:<span class="token variable">$HCATALOG_HOME</span>/sbin
</code></pre> 
<pre><code class="prism language-bash"><span class="token builtin class-name">source</span> /etc/profile
</code></pre> 
<h4><a id="hive_261"></a>初始化hive的元数据库</h4> 
<blockquote> 
 <p><strong>注意</strong>：<strong>初始初始元数据库之前 保证 hadoop 和 mysql 正常启动</strong></p> 
</blockquote> 
<pre><code class="prism language-bash">schematool <span class="token parameter variable">-initSchema</span> <span class="token parameter variable">-dbType</span>  mysql
</code></pre> 
<h4><a id="_269"></a>报错解解决：</h4> 
<pre><code class="prism language-bash">Exception <span class="token keyword">in</span> thread <span class="token string">"main"</span> java.lang.RuntimeException: com.ctc.wstx.exc.WstxParsingException: Illegal character entity: expansion character <span class="token punctuation">(</span>code 0x8
at <span class="token punctuation">[</span>row,col,system-id<span class="token punctuation">]</span>: <span class="token punctuation">[</span><span class="token number">3215,96</span>,<span class="token string">"file:/usr/local/hive/conf/hive-site.xml"</span><span class="token punctuation">]</span>
at org.apache.hadoop.conf.Configuration.loadResource<span class="token punctuation">(</span>Configuration.java:3051<span class="token punctuation">)</span>
<span class="token punctuation">..</span>.
at org.apache.hadoop.util.RunJar.main<span class="token punctuation">(</span>RunJar.java:236<span class="token punctuation">)</span>
Caused by: com.ctc.wstx.exc.WstxParsingException: Illegal character entity: expansion character <span class="token punctuation">(</span>code 0x8
at <span class="token punctuation">[</span>row,col,system-id<span class="token punctuation">]</span>: <span class="token punctuation">[</span><span class="token number">3215,96</span>,<span class="token string">"file:/usr/local/hive/conf/hive-site.xml"</span><span class="token punctuation">]</span>
at com.ctc.wstx.sr.StreamScanner.constructWfcException<span class="token punctuation">(</span>StreamScanner.java:621<span class="token punctuation">)</span>
<span class="token punctuation">..</span>.
at org.apache.hadoop.conf.Configuration.loadResource<span class="token punctuation">(</span>Configuration.java:3034<span class="token punctuation">)</span>
<span class="token punctuation">..</span>. <span class="token number">17</span> <span class="token function">more</span>

报错原因：

hive-site.xml配置文件中，3215行（见报错记录第二行）有特殊字符

解决办法：

进入hive-site.xml文件，跳转到对应行，删除里面的 <span class="token operator">&amp;</span><span class="token comment">#8 特殊字符即可</span>
</code></pre> 
<pre><code class="prism language-bash">Caused by: java.net.URISyntaxException: Relative path <span class="token keyword">in</span> absolute URI: $<span class="token punctuation">{<!-- --></span>system:java.io.tmpdir%7D/$%7Bsystem:user.name%7D
	at java.net.URI.checkPath<span class="token punctuation">(</span>URI.java:1822<span class="token punctuation">)</span>
	at java.net.URI.<span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>URI.java:745<span class="token punctuation">)</span>
	at org.apache.hadoop.fs.Path.initialize<span class="token punctuation">(</span>Path.java:260<span class="token punctuation">)</span>

解决方案：将hive-site.xml配置文件的
hive.querylog.location
hive.exec.local.scratchdir
hive.downloaded.resources.dir
三个值（原始为$标识的相对路径）写成绝对值
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># 全局替换</span>
:%s@<span class="token punctuation">\</span><span class="token variable">${system<span class="token operator">:</span>java.io.tmpdir}</span>@/tmp/hive-log@g
</code></pre> 
<h4><a id="_313"></a>远程模式</h4> 
<pre><code class="prism language-bash"><span class="token comment"># 启动服务端</span>
hive <span class="token parameter variable">--service</span> metastore
hive <span class="token parameter variable">--service</span> hiveserver2

<span class="token comment"># 启动服务端 后台运行</span>
hive <span class="token parameter variable">--service</span> metastore <span class="token operator">&amp;</span>
hive <span class="token parameter variable">--service</span> hiveserver2 <span class="token operator">&amp;</span>

<span class="token comment"># 启动服务端 后台运行</span>
<span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> metastore <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
<span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> hiveserver2 <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

hiveserver2 start
<span class="token function">nohup</span> hiveserver2 start <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

</code></pre> 
<blockquote> 
 <p>bash 中 0、1、2 三个数字分别代表 STDIN_FILENO 、 STDOUT_FILENO 、STDERR_FILENO ，<br> 即标准输入（一般是键盘），<br> 标准输出（一般是显示屏，准确的说是用户终端控制台），<br> 标准错误（输出错信息输出）。</p> 
</blockquote> 
<table><thead><tr><th>数字</th><th>含义</th></tr></thead><tbody><tr><td>0</td><td>标准输入（一般是键盘）</td></tr><tr><td>1</td><td>标准输出（一般是显示屏，准确的说是用户终端控制台）</td></tr><tr><td>2</td><td>标准错误（输出错信息输出）</td></tr></tbody></table> 
<blockquote> 
 <p>/dev/null看作"黑洞". 它等价于一个只写文件.<br> 所有写入它的内容都会永远丢失.<br> 而尝试从它那儿读取内容则什么也读不到</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token comment"># 客户端连接</span>
hive
beeline <span class="token parameter variable">-u</span> jdbc:hive2://spark01:10000 <span class="token parameter variable">-n</span> root
beeline jdbc:hive2://spark01:1000<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> show databases<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_356"></a>体验</h4> 
<pre><code class="prism language-sql"><span class="token keyword">use</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> person <span class="token punctuation">(</span>
	id <span class="token keyword">int</span><span class="token punctuation">,</span>
    phonenum <span class="token keyword">bigint</span><span class="token punctuation">,</span>
    salary dicimal<span class="token punctuation">,</span>
    name string
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">13966668888</span><span class="token punctuation">,</span><span class="token number">9999.99</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code>songsong,bingbing_lili,xiao song:18_xiaoxiao song:19
longlong,pingping_liuliu,xiao long:8_xiaoxiao long:9
</code></pre> 
<pre><code>drop table person;
create table person (
    name string,
    friends array&lt;string&gt;,
    childrens map&lt;string,int&gt;
)
 row format delimited fields terminated by ',' 
 collection items terminated by '_' 
 map keys terminated by ':' 
 lines terminated by '\n';
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath  <span class="token string">'/root/person.txt'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> person<span class="token punctuation">;</span> 
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">data</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">data</span> <span class="token punctuation">(</span>
    name string<span class="token punctuation">,</span> 
   	amount <span class="token keyword">int</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
 <span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath  <span class="token string">'/root/data.txt'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token keyword">data</span><span class="token punctuation">;</span> 
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">data</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">data</span> <span class="token keyword">group</span> <span class="token keyword">by</span> name<span class="token punctuation">;</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">data</span> <span class="token keyword">group</span> <span class="token keyword">by</span> name<span class="token punctuation">;</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">data</span> <span class="token keyword">group</span> <span class="token keyword">by</span> name <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">max</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-hive"># 本地
set mapreduce.framework.name=local;
set hive.exec.mode.local.auto=true;
# yarn
set mapreduce.framework.name=yarn;
set hive.exec.mode.local.auto=false;

# 向量模式
set hive.vectorized.execution.enabled=true;
set hive.vectorized.execution.enabled=false;

set mapreduce.framework.name=local;
set hive.exec.mode.local.auto=true;
set hive.vectorized.execution.enabled=true; 

</code></pre> 
<h3><a id="_429"></a>操作数据库</h3> 
<h4><a id="_431"></a>创建数据库</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建数据库不指定路径</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> db_hive01<span class="token punctuation">;</span>

<span class="token comment">-- 创建数据库指定 hdfs 路径</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> db_hive02 location <span class="token string">'/db_hive02'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建数据库附加 dbproperties</span>
<span class="token keyword">create</span> <span class="token keyword">database</span>  db_hive03  <span class="token keyword">with</span> dbproperties <span class="token punctuation">(</span><span class="token string">'comment'</span><span class="token operator">=</span><span class="token string">'hive体验'</span><span class="token punctuation">,</span><span class="token string">'create-date'</span><span class="token operator">=</span><span class="token string">'2023-11-13'</span><span class="token punctuation">,</span><span class="token string">'create_author'</span><span class="token operator">=</span><span class="token string">'lihaozhe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建数据表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> product<span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span>    <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>product_name<span class="token punctuation">`</span></span>  string <span class="token keyword">COMMENT</span> <span class="token string">'商品名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category_id<span class="token punctuation">`</span></span>   string <span class="token keyword">COMMENT</span> <span class="token string">'所属分类id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>from_date<span class="token punctuation">`</span></span>     string <span class="token keyword">COMMENT</span> <span class="token string">'上架日期'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>product_price<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品单价'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品信息表'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> product<span class="token punctuation">;</span>
<span class="token keyword">describe</span> <span class="token keyword">extended</span> product<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_460"></a>查询数据库</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 查看所有数据库</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>

<span class="token comment">-- 模糊查看所有数据库</span>
<span class="token comment">-- * 代表所有</span>
<span class="token comment">-- | 代表或</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span> <span class="token operator">like</span> <span class="token string">'db_hive*'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看数据库信息</span>
<span class="token keyword">desc</span> <span class="token keyword">database</span> db_hive03<span class="token punctuation">;</span>

<span class="token comment">-- 查看数据库详尽信息</span>
<span class="token keyword">describe</span> <span class="token keyword">database</span> db_hive03<span class="token punctuation">;</span>

<span class="token comment">-- 查看数据库更详尽信息</span>
<span class="token keyword">describe</span> <span class="token keyword">database</span> <span class="token keyword">extended</span> db_hive03<span class="token punctuation">;</span>

<span class="token comment">-- 查看当前在使用哪个数据库</span>
<span class="token keyword">select</span> current_database<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_484"></a>修改数据库</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 修改 dbproperties</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> db_hive03 <span class="token keyword">SET</span> dbproperties <span class="token punctuation">(</span><span class="token string">'crate_data'</span><span class="token operator">=</span><span class="token string">'2023-04-18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改location</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> db_hive02 <span class="token keyword">SET</span> location <span class="token string">'/db_hive002'</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改 owner user</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> database_name <span class="token keyword">set</span> owner <span class="token keyword">user</span> lhz<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_497"></a>使用数据库</h4> 
<pre><code class="prism language-sql"><span class="token keyword">use</span> db_hive03<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_503"></a>删除数据库</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 删除空数据库</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> db_hive02 <span class="token keyword">restrict</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- 删除非空数据库</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> db_hive03 <span class="token keyword">cascade</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_515"></a>操作数据表</h3> 
<blockquote> 
 <p>普通表</p> 
 <p>临时表 temporary</p> 
 <p>外部表 external</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token comment">-- 利用 select 语句查询结果 创建一张表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">as</span> <span class="token keyword">select</span>

<span class="token comment">-- 复刻一张已经存在的表结构 但是 不包含数据</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token operator">like</span>
</code></pre> 
<h4><a id="_531"></a>基本数据类型</h4> 
<table><thead><tr><th>数据类型</th><th>说明</th><th>定义</th></tr></thead><tbody><tr><td>tinyint</td><td>1 byte 有符号整型</td><td></td></tr><tr><td>smallint</td><td>2 byte 有符号整型</td><td></td></tr><tr><td>int</td><td>4 byte 有符号整型</td><td></td></tr><tr><td>bigint</td><td>8 byte 有符号整型</td><td></td></tr><tr><td>float</td><td>4 byte 单精度浮点数</td><td></td></tr><tr><td>double</td><td>8 byte 双精度浮点数</td><td></td></tr><tr><td>dicimal</td><td>十进制精准数据类型</td><td></td></tr><tr><td>varchar</td><td>字符序列 需要指定最大长度 范围[1~65535]</td><td></td></tr><tr><td>string</td><td>字符串 无需指定最大长度</td><td></td></tr><tr><td>timestamp</td><td>时间</td><td></td></tr><tr><td>binary</td><td>二进制数据</td><td></td></tr><tr><td>boolean</td><td></td><td>true false</td></tr><tr><td>array</td><td>一组相同数据类型的集合</td><td>array&lt;string&gt;</td></tr><tr><td>map</td><td>一组相同数据类型的键值对</td><td>map&lt;string,int&gt;</td></tr><tr><td>struct</td><td>由多个属性组成，每个属性都有自己的属性名和数据类型</td><td>struct&lt;id:int,name:string&gt;</td></tr></tbody></table> 
<h4><a id="_551"></a>内部表</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> product<span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span>    <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>product_name<span class="token punctuation">`</span></span>  string <span class="token keyword">COMMENT</span> <span class="token string">'商品名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category_id<span class="token punctuation">`</span></span>   string <span class="token keyword">COMMENT</span> <span class="token string">'所属分类id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>from_date<span class="token punctuation">`</span></span>     string <span class="token keyword">COMMENT</span> <span class="token string">'上架日期'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>product_price<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品单价'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品信息表'</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> product <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'huawei mate 60'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2023-10-25'</span><span class="token punctuation">,</span><span class="token number">6999.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> product <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'xiaomi 14'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2023-11-11'</span><span class="token punctuation">,</span><span class="token number">5999.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> product <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'xiaomi pad 3'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'2023-11-11'</span><span class="token punctuation">,</span><span class="token number">5999.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_567"></a>先有鸡还是先有蛋</h4> 
<blockquote> 
 <p>编写数据文件</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">vim</span> atm.csv
</code></pre> 
<pre><code class="prism language-csv">李昊哲,10000
李胜龙,20000
李大宝,30000
</code></pre> 
<h5><a id="_581"></a>先有表后有数据</h5> 
<blockquote> 
 <p>创建数据表使用自定义分隔符</p> 
</blockquote> 
<pre><code class="prism language-hive">create table atm(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';
</code></pre> 
<blockquote> 
 <p>上传数据文件</p> 
</blockquote> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-put</span> atm.csv /user/hive/warehouse/db_hive.db/atm
hdfs dfs <span class="token parameter variable">-cat</span> /user/hive/warehouse/db_hive.db/atm/atm.csv
</code></pre> 
<blockquote> 
 <p>查询数据表数据</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> atm<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_607"></a>先有数据后有表</h5> 
<blockquote> 
 <p>创建数据目录</p> 
 <p>上传数据文件</p> 
</blockquote> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /user/hive/warehouse/db_hive.db/atm_data
hdfs dfs <span class="token parameter variable">-put</span> atm.csv /user/hive/warehouse/db_hive.db/atm_data
hdfs dfs <span class="token parameter variable">-cat</span> /user/hive/warehouse/db_hive.db/atm_data/atm.csv
</code></pre> 
<blockquote> 
 <p>创建数据表</p> 
 <p>自定义分隔符</p> 
 <p>自定义存储路径</p> 
</blockquote> 
<pre><code class="prism language-hive">create table atm_data(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n'
    location '/user/hive/warehouse/db_hive.db/atm_data';
</code></pre> 
<blockquote> 
 <p>查询数据表数据</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> atm_data<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_641"></a>数据加载</h4> 
<h5><a id="_643"></a>查询其它数据表加载</h5> 
<pre><code class="prism language-hive">create table atm_01(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';

insert into atm_01(name, amount) select name, amount from atm;
insert into atm_01 select name, amount from atm;

select * from atm_01;
</code></pre> 
<h5><a id="_659"></a>通过数据文件加载</h5> 
<h6><a id="_661"></a>通过本地文件系统加载</h6> 
<pre><code class="prism language-hive">create table atm_02(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';
</code></pre> 
<blockquote> 
 <p>追加导入</p> 
</blockquote> 
<pre><code class="prism language-bash">load data <span class="token builtin class-name">local</span> inpath  <span class="token string">'/root/atm.csv'</span> into table atm_02<span class="token punctuation">;</span> 
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> atm_02<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>覆盖导入</p> 
</blockquote> 
<pre><code class="prism language-bash">load data <span class="token builtin class-name">local</span> inpath  <span class="token string">'/root/atm.csv'</span> overwrite into table atm_02<span class="token punctuation">;</span> 
</code></pre> 
<h6><a id="HDFS_688"></a>通过HDFS加载</h6> 
<blockquote> 
 <p>注意：使用该方式 原保存在HDFS上的数据会被移动到新数据表目录 相当于 mv 操作</p> 
</blockquote> 
<pre><code class="prism language-hive">create table atm_03(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';
</code></pre> 
<pre><code class="prism language-bash">load data inpath  <span class="token string">'/user/hive/warehouse/db_hive.db/atm/atm.csv'</span> into table person<span class="token punctuation">;</span> 
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> atm_03<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="hive_709"></a>使用hive脚本加载数据</h5> 
<pre><code class="prism language-hive">create table atm_04(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';

create table atm_05(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';

create table atm_06(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';

create table atm_07(
    name   string,
    amount int
)
    row format delimited fields terminated by ','
    lines terminated by '\n';
</code></pre> 
<pre><code class="prism language-bash">hive <span class="token parameter variable">-e</span> <span class="token string">"insert into db_hive.atm_04 select name, amount from db_hive.atm_03;"</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>atm_04<span class="token punctuation">;</span>
</code></pre> 
<pre><code>hive -e "load data local inpath '/root/atm.csv' into table db_hive.atm_05;"
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>atm_05<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>编写 sql 文件 load.sql</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> db_hive<span class="token punctuation">.</span>atm_06 <span class="token keyword">select</span> name<span class="token punctuation">,</span> amount <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>atm_03<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>hive 执行 load.sql 文件</p> 
</blockquote> 
<pre><code class="prism language-bash">hive <span class="token parameter variable">-f</span> /root/load.sql
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>atm_06<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>编写 脚本文件 load.sh</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/atm.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> db_hive<span class="token punctuation">.</span>atm_07<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>hive 执行 load.sh 文件</p> 
</blockquote> 
<pre><code class="prism language-bash">hive <span class="token parameter variable">-f</span> /root/load.sh
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>atm_07<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_789"></a>数据导出</h4> 
<pre><code class="prism language-bash">hive <span class="token parameter variable">-e</span> <span class="token string">"select name, amount from db_hive.atm_03;"</span> <span class="token operator">&gt;</span> /root/atm_031.csv
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /root/atm_031.csv
</code></pre> 
<pre><code class="prism language-hive">insert overwrite local directory '/root/result' select name, amount from db_hive.atm_03;
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /root/result/000000_0
</code></pre> 
<blockquote> 
 <p>编写 export.sh 脚本</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> name, amount from db_hive.atm_03<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>执行 export.sh 脚本</p> 
</blockquote> 
<pre><code class="prism language-bash">hive <span class="token parameter variable">-f</span> /root/export.sql  <span class="token operator">&gt;</span> /root/atm_032.csv
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /root/atm_032.csv
</code></pre> 
<blockquote> 
 <p>使用 HDFS 命令</p> 
</blockquote> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-ls</span> /user/hive/warehouse/db_hive.db/product
</code></pre> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-cat</span> /user/hive/warehouse/db_hive.db/product/* <span class="token operator">&gt;</span> /root/product.txt
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /root/product.txt
</code></pre> 
<h4><a id="_837"></a>复杂数据类型</h4> 
<h5><a id="array_839"></a>array</h5> 
<blockquote> 
 <p>准备数据 person01.txt</p> 
</blockquote> 
<pre><code class="prism language-bash">李昊哲,大漂亮_大美丽
李胜龙,丽丽_娜娜
李大宝,嘿嘿_哈哈
</code></pre> 
<blockquote> 
 <p>创建数据表</p> 
</blockquote> 
<pre><code class="prism language-bash">create table person01<span class="token punctuation">(</span>
    name string,
    friends array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
    row <span class="token function">format</span> delimited fields terminated by <span class="token string">','</span>
    collection items terminated by <span class="token string">'_'</span>
    lines terminated by <span class="token string">'\n'</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>加载数据</p> 
</blockquote> 
<pre><code class="prism language-bash">load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/root/person01.txt'</span> into table db_hive.person01<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>sql 查询</p> 
</blockquote> 
<pre><code class="prism language-hive">select name, friends,friends[0],friends[1] from person01;
</code></pre> 
<h5><a id="map_874"></a>map</h5> 
<blockquote> 
 <p>准备数据 person02.txt</p> 
</blockquote> 
<pre><code class="prism language-bash">李昊哲,大漂亮:18
李胜龙,丽丽:16
李大宝,娜娜:17
</code></pre> 
<blockquote> 
 <p>创建数据表</p> 
</blockquote> 
<pre><code class="prism language-bash">create table person02<span class="token punctuation">(</span>
    name string,
    friend map<span class="token operator">&lt;</span>string,int<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
    row <span class="token function">format</span> delimited fields terminated by <span class="token string">','</span>
    map keys terminated by <span class="token string">':'</span>
    lines terminated by <span class="token string">'\n'</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>加载数据</p> 
</blockquote> 
<pre><code class="prism language-bash">load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/root/person02.txt'</span> into table db_hive.person02<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>sql 查询</p> 
</blockquote> 
<pre><code class="prism language-hive">select name,friend,friend['丽丽'] from person02;
</code></pre> 
<h5><a id="struct_909"></a>struct</h5> 
<blockquote> 
 <p>准备数据 person03.txt</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token number">1</span>,李哲:18:0
<span class="token number">2</span>,李胜龙:16:1
<span class="token number">3</span>,李大宝:17:1
</code></pre> 
<blockquote> 
 <p>创建数据表</p> 
</blockquote> 
<pre><code class="prism language-bash">create table person03<span class="token punctuation">(</span>
    <span class="token function">id</span> int,
    info struct<span class="token operator">&lt;</span>name:string,age:int,gender:int<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
    row <span class="token function">format</span> delimited fields terminated by <span class="token string">','</span>
    collection items terminated by <span class="token string">':'</span>
    lines terminated by <span class="token string">'\n'</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>加载数据</p> 
</blockquote> 
<pre><code class="prism language-bash">load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/root/person03.txt'</span> into table db_hive.person03<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>sql 查询</p> 
</blockquote> 
<pre><code class="prism language-hive">select id,info,info.name,info.age,info.gender  from person03;
</code></pre> 
<h5><a id="json_944"></a>json数据类型</h5> 
<blockquote> 
 <p>json函数</p> 
 <ul><li> <p>​ get_json_object</p> </li><li> <p>​ json_tuple</p> </li></ul> 
 <p>json serde 加载数据</p> 
</blockquote> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span><span class="token string-property property">"name"</span><span class="token operator">:</span><span class="token string">"user01"</span><span class="token punctuation">,</span><span class="token string-property property">"amount"</span><span class="token operator">:</span><span class="token string">"100"</span><span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"name"</span><span class="token operator">:</span><span class="token string">"lihaozhe"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"friends"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"lizhe"</span><span class="token punctuation">,</span><span class="token string">"lanlan"</span>，<span class="token string">"jinjin"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"student"</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string-property property">"xiaohuihui"</span><span class="token operator">:</span><span class="token number">15000</span><span class="token punctuation">,</span>
        <span class="token string-property property">"huixiaoxiao"</span><span class="token operator">:</span><span class="token number">18000</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"address"</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"province"</span><span class="token operator">:</span><span class="token string">"jilin"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"city"</span><span class="token operator">:</span><span class="token string">"liaoyuan"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"district"</span><span class="token operator">:</span><span class="token string">"dongliao"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="_974"></a>案例一</h6> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> video01 <span class="token punctuation">(</span>info string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data.json'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> db_hive<span class="token punctuation">.</span>video01<span class="token punctuation">;</span>
<span class="token keyword">select</span> info <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>video01<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.rank'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rank<span class="token punctuation">,</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.title'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> title<span class="token punctuation">,</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.dzl'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dzl<span class="token punctuation">,</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.bfl'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> bfl<span class="token punctuation">,</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.zfl'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> zfl<span class="token punctuation">,</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.type'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">type</span><span class="token punctuation">,</span>
    get_json_object<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'$.time'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> paly_time
<span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>video01<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
   json_tuple<span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">'rank'</span><span class="token punctuation">,</span><span class="token string">'title'</span><span class="token punctuation">,</span><span class="token string">'dzl'</span><span class="token punctuation">,</span><span class="token string">'bfl'</span><span class="token punctuation">,</span><span class="token string">'zfl'</span><span class="token punctuation">,</span><span class="token string">'type'</span><span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">(</span>rank<span class="token punctuation">,</span>title<span class="token punctuation">,</span>dzl<span class="token punctuation">,</span>bfl<span class="token punctuation">,</span>zfl<span class="token punctuation">,</span><span class="token keyword">type</span><span class="token punctuation">,</span>pt<span class="token punctuation">)</span>
<span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>video01<span class="token punctuation">;</span>
</code></pre> 
<h6><a id="_1000"></a>案例二</h6> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> video<span class="token punctuation">(</span>
    rank <span class="token keyword">int</span><span class="token punctuation">,</span>
    title string<span class="token punctuation">,</span>
    dzl <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    bfl <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    zfl <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">type</span> string<span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>time<span class="token punctuation">`</span></span> string
<span class="token punctuation">)</span>
    <span class="token keyword">row</span> format serde <span class="token string">'org.apache.hive.hcatalog.data.JsonSerDe'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data.json'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> db_hive<span class="token punctuation">.</span>video02<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> info <span class="token keyword">from</span> db_hive<span class="token punctuation">.</span>video02<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1024"></a>查看表</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 查看表</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看某数据库下的所有表</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token operator">in</span> db_hive<span class="token punctuation">;</span>

<span class="token comment">-- 查看表</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>

<span class="token comment">-- 模糊查看数据表</span>
<span class="token comment">-- * 代表所有</span>
<span class="token comment">-- | 代表或</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token operator">like</span> <span class="token string">'atm'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看基本表信息</span>
<span class="token keyword">describe</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 查看基本表详细信息</span>
<span class="token keyword">describe</span> <span class="token keyword">extended</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 查看基本表详细信息并格式化展示</span>
<span class="token keyword">describe</span> formatted product<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1051"></a>修改表</h4> 
<blockquote> 
 <p>创建原始表</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user <span class="token punctuation">(</span>
    user_id <span class="token keyword">int</span><span class="token punctuation">,</span>
    user_name string
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token operator">like</span> <span class="token string">'tb_user'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1066"></a>修改表名称</h4> 
<blockquote> 
 <p>格式 alter table 旧表名称 rename to 新表名称</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> tb_user <span class="token keyword">rename</span> <span class="token keyword">to</span>  <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token operator">like</span> <span class="token string">'user'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1078"></a>添加字段</h4> 
<blockquote> 
 <p>格式 alter table 表名称 add columns (字段名称 数据类型)</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token keyword">add</span> <span class="token keyword">columns</span> <span class="token punctuation">(</span>gender <span class="token keyword">tinyint</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1094"></a>修改字段名称</h4> 
<blockquote> 
 <p>格式 alter table 表名称 change 旧字段名称 新字段名称 新数据类型 新约束</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-hive">alter table `user` change user_id id int;
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1110"></a>修改字段数据类型</h4> 
<blockquote> 
 <p>格式 alter table 表名称 change 字段名称 字段名称 新的数据类型</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-hive">alter table `user` change gender gender smallint;
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1126"></a>修改所有字段</h4> 
<blockquote> 
 <p>格式 alter table 表名称 replace columns (字段1 数据类型,字段2 数据类型,…)</p> 
</blockquote> 
<pre><code class="prism language-hive">describe `user`;
</code></pre> 
<pre><code class="prism language-hive">alter table `user` replace columns (user_id int, user_name string);
</code></pre> 
<pre><code class="prism language-hive">describe `user`;
</code></pre> 
<h4><a id="_1142"></a>删除表</h4> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> tb_user<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1148"></a>清空表</h4> 
<pre><code class="prism language-sql"><span class="token keyword">truncate</span> <span class="token keyword">table</span> video<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1154"></a>外部表</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> <span class="token keyword">data</span> <span class="token punctuation">(</span>
    name string<span class="token punctuation">,</span> 
   	amount <span class="token keyword">int</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 location <span class="token string">'/data'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-hive">describe formatted data;
</code></pre> 
<pre><code class="prism language-hive">drop table data;
</code></pre> 
<pre><code class="prism language-hive">create external table data (
    name string, 
   	amount int
)
 row format delimited fields terminated by ',' 
 lines terminated by '\n'
 location '/data';
</code></pre> 
<blockquote> 
 <p>Table Type:</p> 
 <ul><li> <p>MANAGED_TABLE 内部表</p> </li><li> <p>EXTERNAL_TABLE 外部表</p> </li></ul> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> formatted <span class="token identifier"><span class="token punctuation">`</span>product<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token comment">-- 内部表转外部表</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> product <span class="token keyword">set</span> tblproperties<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'TRUE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">describe</span> formatted <span class="token identifier"><span class="token punctuation">`</span>product<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token comment">-- 外部表转内部表</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> product <span class="token keyword">set</span> tblproperties<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'FALSE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">describe</span> formatted <span class="token identifier"><span class="token punctuation">`</span>product<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="hive_1200"></a>hive查询优化</h3> 
<pre><code class="prism language-hive">-- 本地
set mapreduce.framework.name=local;
set hive.exec.mode.local.auto=true;
set mapperd.job.tracker=local;
-- yarn
set mapreduce.framework.name=yarn;
set hive.exec.mode.local.auto=false;
set mapperd.job.tracker=yarn

-- 向量模式
set hive.vectorized.execution.enabled=true;
set hive.vectorized.execution.enabled=false;

</code></pre> 
<pre><code class="prism language-hive">set hive.exec.mode.local.auto=true;
set mapperd.job.tracker=local;
set mapreduce.framework.name=local;
set hive.vectorized.execution.enabled=true;
</code></pre> 
<blockquote> 
 <p>注意：在 datagrip 中执行优化后的 hive SQL 可能会有如下报错</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/47/03/7DTnJUgu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">Error <span class="token keyword">while</span> processing statement: FAILED: Execution Error, <span class="token builtin class-name">return</span> code <span class="token number">2</span> from org.apache.hadoop.hive.q.exec.mr.MapRedTas

</code></pre> 
<blockquote> 
 <p>如果出现以上报错，可以通过 Hadoop 配置文件 yarn-site.xml 文件追加以下内容</p> 
</blockquote> 
<pre><code class="prism language-xml">  <span class="token comment">&lt;!-- yarn 允许分配的最大最小内存 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.minimum-allocation-mb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1024<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.maximum-allocation-mb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>4096<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.resource.memory-mb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>4096<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>追加后重启hadoop集群和hive</p> 
</blockquote> 
<h3><a id="DQL_1254"></a>DQL</h3> 
<h4><a id="_1256"></a>准备数据</h4> 
<h5><a id="_deptcsv_1258"></a>部门表 dept.csv</h5> 
<pre><code class="prism language-txt">10,行政部,1700
20,财务部,1800
30,教学部,1900
40,销售部,2000
50,新媒体,1600
</code></pre> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz01/dept
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/dept.csv /quiz01/dept
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> dept <span class="token punctuation">(</span>
	dept_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'部门ID'</span><span class="token punctuation">,</span>
	dept_name string <span class="token keyword">comment</span> <span class="token string">'部门名称'</span><span class="token punctuation">,</span>
    location_code <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'部门位置'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz01/dept'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/dept.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> dept<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_empcsv_1289"></a>员工表 emp.csv</h5> 
<pre><code class="prism language-txt">7369,张三,研发,800.00,30
7499,李四,财务,1600.00,20
7521,王五,行政,1250.00,10
7566,赵六,销售,2975.00,40
7654,侯七,研发,1250.00,30
7698,马八,研发,2850.00,30
7782,金九,行政,2450.0,30
7788,银十,行政,3000.00,10
7839,小芳,销售,5000.00,40
7844,小明,销售,1500.00,40
7876,小李,行政,1100.00,10
7900,小元,讲师,950.00,30
7902,小海,行政,3000.00,10
7934,小红明,讲师,1300.00,30
7934,小红,讲师,1300.00,
</code></pre> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz01/emp
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/emp.csv /quiz01/emp
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> emp <span class="token punctuation">(</span>
	emp_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'员工ID'</span><span class="token punctuation">,</span>
	emp_name string <span class="token keyword">comment</span> <span class="token string">'员工姓名'</span><span class="token punctuation">,</span>
    emp_job string <span class="token keyword">comment</span> <span class="token string">'员工岗位'</span><span class="token punctuation">,</span>
    emp_salary <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'员工薪资'</span><span class="token punctuation">,</span>
    dept_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'员工隶属部门ID'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz01/emp'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/emp.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> emp<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_ordercsv_1332"></a>订单表 order.csv</h5> 
<pre><code class="prism language-txt">30001,2008-09-01,10001
30002,2008-09-12,10003
30003,2008-09-30,10004
30004,2008-10-03,10005
30005,2008-10-08,10001
</code></pre> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz01/order
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data01/order.csv /quiz01/order
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>o_num<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'销售记录编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>o_date<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'销售时间'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>c_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'消费者编号'</span>
<span class="token punctuation">)</span> <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz01/order'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data01/order.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_order_itemcsv_1362"></a>订单详情表 order_item.csv</h5> 
<pre><code class="prism language-txt">30001,1,a1,10,5.2
30001,2,b2,3,7.6
30001,3,bs1,5,11.2
30001,4,bs2,15,9.2
30002,1,b3,2,20
30003,1,c0,100,10
30004,1,o2,50,2.5
30005,1,c0,5,10
30005,2,b1,10,8.99
30005,3,a2,10,2.2
30005,4,m1,5,14.99
</code></pre> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz01/order_item
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data01/order_item.csv /quiz01/order_item
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order_item<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>o_num<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'销售记录编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>o_item<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'销售记录流水'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>f_id<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'水果编号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>quantity<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'数量'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>item_price<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">COMMENT</span> <span class="token string">'单价'</span>
<span class="token punctuation">)</span> <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz01/order_item'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data01/order_item.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order_item<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_tb_categorycsv_1400"></a>分类菜单 tb_category.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz01/tb_category
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data01/tb_category.csv /quiz01/tb_category
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>tb_category<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'分类ID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'分类名称'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>goods_num<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品数量'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>is_show<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否显示'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>is_menu<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'是否导航'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>seq<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'排序'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>parent_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'上级ID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>template_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'模板ID'</span>
<span class="token punctuation">)</span> <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz01/tb_category'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data01/tb_category.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>tb_category<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_regioncsv_1427"></a>地区表 region.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz02/region
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/region.csv /quiz02/region
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> external <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>region<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>parent_code<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'当前地区的上一级地区代码'</span><span class="token punctuation">,</span>  
  <span class="token identifier"><span class="token punctuation">`</span>region_code<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'地区代码'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>region_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'地区名称'</span>
<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz02/region'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/region.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> region<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_personcsv_1450"></a>居民表 person.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz02/person
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/person.csv /quiz02/person
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> external <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>person<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'主键'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>id_card<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'身份证号码'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>mobile<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'中国手机号'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>real_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'身份证姓名'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>uuid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'系统唯一身份标识符'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz02/person'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/person.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> person<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_scorecsv_1475"></a>分数表 score.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz02/score
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/score.csv /quiz02/score
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> external <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>stu_id<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>course_id<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'分数'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz02/score'</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/score.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> score<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/score.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> score<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1500"></a>单表查询</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询所有</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span>

<span class="token comment">-- 按照指定字段查询</span>
<span class="token keyword">select</span> dept_name <span class="token keyword">from</span> dept<span class="token punctuation">;</span>

<span class="token comment">-- 列别名</span>
<span class="token keyword">select</span> dept_name <span class="token keyword">as</span> name <span class="token keyword">from</span> dept<span class="token punctuation">;</span>

<span class="token comment">-- limit 分页查询</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">limit</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">-- where 按条件查询</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- 关系运算符</span>
<span class="token comment">-- = != &gt; &gt;= &lt; &lt;=</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> emp_salary <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">-- in</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- not in</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- like</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> emp_name <span class="token operator">like</span> <span class="token string">'小%'</span><span class="token punctuation">;</span>

<span class="token comment">-- not like</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> emp_name <span class="token operator">not</span> <span class="token operator">like</span> <span class="token string">'小%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 逻辑运算符</span>
<span class="token comment">-- and</span>
<span class="token keyword">select</span>  <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span>  dept_id <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">and</span> emp_salary <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">;</span>

<span class="token comment">-- between and</span>
<span class="token keyword">select</span>  <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span>  emp_salary <span class="token operator">&gt;=</span> <span class="token number">1300</span> <span class="token operator">and</span> emp_salary <span class="token operator">&lt;=</span> <span class="token number">1600</span><span class="token punctuation">;</span>
<span class="token keyword">select</span>  <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span>  emp_salary <span class="token operator">between</span> <span class="token number">1300</span> <span class="token operator">and</span> <span class="token number">1600</span><span class="token punctuation">;</span>

<span class="token comment">-- or</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">or</span> dept_id <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> emp<span class="token punctuation">.</span>dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- not !</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> <span class="token operator">not</span> dept_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- 聚合函数</span>
<span class="token comment">-- count(*) count(1) count(column_name)</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> total <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- max</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- min</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- sum</span>
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- avg</span>
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- 聚合函数</span>
<span class="token comment">-- count(*) count(1) count(column_name)</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> total <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- max</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- min</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- sum</span>
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- avg</span>
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- group by 分组查询</span>
<span class="token keyword">select</span> dept_id <span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> dept_id<span class="token punctuation">;</span>
<span class="token comment">-- having</span>
<span class="token keyword">select</span> dept_id<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> dept_id <span class="token keyword">having</span> avg_salary <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">-- where having</span>
<span class="token keyword">select</span> dept_id<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">!=</span> <span class="token number">40</span> <span class="token keyword">group</span> <span class="token keyword">by</span> dept_id <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">-- order by 全局排序</span>
<span class="token keyword">select</span> dept_id <span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>emp_salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> dept_id <span class="token keyword">order</span> <span class="token keyword">by</span> avg_salary <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- sort by (每个map或reduce)内部排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp sort <span class="token keyword">by</span> dept_id <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- 设置 reduce 数量 仅在当前连接有效 连接断开失效</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>job<span class="token punctuation">.</span>reduce<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp sort <span class="token keyword">by</span> dept_id <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- 将查询结果写入到文件</span>
<span class="token keyword">insert</span> overwrite <span class="token keyword">local</span> directory <span class="token string">'/root/sort-result'</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp sort <span class="token keyword">by</span> dept_id <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- distribute by 分区 类似与 mapreduce 中的 partation 自定义分区</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>job<span class="token punctuation">.</span>reduces<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> overwrite <span class="token keyword">local</span> directory <span class="token string">'/root/distribute-result'</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp distribute <span class="token keyword">by</span> dept_id sort <span class="token keyword">by</span> emp_salary <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- distribute by 分区规则 根据字段的hash值 与 reduce 的数量 进行相除 余数 相同的在到一个分区</span>
<span class="token comment">-- hvie 要求 distribute by 语句执行 在 sort by 语句之前</span>
<span class="token comment">-- 执行结束之后 将 mapreduce.job.reduces 设置为 -1 不然 会影响 分区 分桶 load</span>

<span class="token comment">-- cluster by 只能升序 不能降序 cluster by = sort by + distribute by</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp cluster <span class="token keyword">by</span> dept_id<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1614"></a>多表查询</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 多表查询</span>
<span class="token comment">-- 交叉查询 避免笛卡尔积</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">,</span> emp <span class="token keyword">where</span> dept<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> emp<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>

<span class="token comment">-- 等值join</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept <span class="token keyword">join</span> emp <span class="token keyword">where</span> dept<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> emp<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>

<span class="token comment">-- inner join 内连接</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept <span class="token keyword">inner</span> <span class="token keyword">join</span> emp <span class="token keyword">where</span> dept<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> emp<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>

<span class="token comment">-- left join 左外连接</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> customer <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o <span class="token keyword">on</span> customer<span class="token punctuation">.</span>c_id <span class="token operator">=</span> o<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>

<span class="token comment">-- right join 右外连接</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> customer <span class="token keyword">right</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o <span class="token keyword">on</span> customer<span class="token punctuation">.</span>c_id <span class="token operator">=</span> o<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>

<span class="token comment">-- full join 全外连接</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> customer <span class="token keyword">full</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o <span class="token keyword">on</span> customer<span class="token punctuation">.</span>c_id <span class="token operator">=</span> o<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>

<span class="token comment">-- union 上下拼接 去重</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">or</span> dept_id <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">or</span> dept_id <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- union all 上下拼接 不去重</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">all</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 自关联</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> region <span class="token keyword">where</span> region_code <span class="token operator">=</span> <span class="token string">'220422'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1649"></a>子查询</h4> 
<pre><code class="prism language-hive">-- 子查询作为查询条件
select * from tb_category;
select count(*) from tb_category;
-- 一级导航
select * from tb_category where parent_id = 0;
-- 二级导航
select * from tb_category where parent_id in (select id from tb_category where parent_id = 0);

-- 三级导航
select * from tb_category where parent_id in (
    select id from tb_category where parent_id in (
        select id from tb_category where parent_id = 0
    )
);

-- 子查询作为数据源 也就是 当中一张数据表看待
-- 一级导航
select * from tb_category where parent_id = 0;

-- 二级导航
select t1.id, t1.name, t1.goods_num, t1.is_show, t1.is_menu, t1.seq, t1.parent_id, t1.template_id from tb_category t1
    inner join
    (select id, name, goods_num, is_show, is_menu, seq, parent_id, template_id from tb_category where parent_id = 0) t2
    on t1.parent_id = t2.id;
    
-- 三级导航
select t0.id, t0.name, t0.goods_num, t0.is_show, t0.is_menu, t0.seq, t0.parent_id, t0.template_id from tb_category t0
    inner join
    (select t1.id, t1.name, t1.goods_num, t1.is_show, t1.is_menu, t1.seq, t1.parent_id, t1.template_id from tb_category t1
        inner join
        (select id, name, goods_num, is_show, is_menu, seq, parent_id, template_id from tb_category where parent_id = 0) t2
        on t1.parent_id = t2.id) t3
    on t0.parent_id = t3.id;
    
-- 将一级导航和该导航下的二级导航数据封装一次性送到前端
select id, name, goods_num, is_show, is_menu, seq, t4.parent_id, template_id, second_ids, second_names from tb_category t4
    inner join
    (select parent_id,collect_list(t2.id) second_ids,collect_list(t2.name) second_names from tb_category t2
        inner join
       (select id from tb_category where parent_id = 0) t1
        on t2.parent_id = t1.id group by parent_id) t3
    on t3.parent_id = t4.id;
</code></pre> 
<h4><a id="_1696"></a>函数</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 算数运算函数</span>
<span class="token comment">-- + - * / % &amp; | ^ ~</span>

<span class="token comment">-- 数值函数</span>
<span class="token comment">-- round 四舍五入</span>
<span class="token keyword">select</span> rount<span class="token punctuation">(</span><span class="token number">3.3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num<span class="token punctuation">;</span>
<span class="token keyword">select</span> rount<span class="token punctuation">(</span><span class="token number">3.5</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num<span class="token punctuation">;</span>

<span class="token comment">-- ceil 向上取整</span>
<span class="token keyword">select</span> ceil<span class="token punctuation">(</span><span class="token number">3.3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num<span class="token punctuation">;</span>

<span class="token comment">-- floor 向下取整</span>
<span class="token keyword">select</span> floor<span class="token punctuation">(</span><span class="token number">3.9</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num<span class="token punctuation">;</span>

<span class="token comment">-- mod</span>
<span class="token keyword">select</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 字符串函数</span>
<span class="token comment">-- substr 字符串截取 substr(column_name,start_index,length)</span>
<span class="token keyword">select</span> substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>id_card <span class="token keyword">from</span> person<span class="token punctuation">;</span>

<span class="token comment">-- substring 字符串截取 substring(column_name,start_index,length)</span>
<span class="token keyword">select</span> substring<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>id_card <span class="token keyword">from</span> person<span class="token punctuation">;</span>

<span class="token comment">-- split 字符串分割</span>
<span class="token keyword">select</span> split<span class="token punctuation">(</span><span class="token string">'2023-04-19'</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">)</span>

<span class="token comment">-- nvl 判空 替换 null 值</span>
<span class="token keyword">select</span> nvl<span class="token punctuation">(</span><span class="token string">"李昊哲"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> nvl<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">-- concat 字符串拼接</span>
<span class="token keyword">select</span>  concat<span class="token punctuation">(</span><span class="token string">'slogan'</span><span class="token punctuation">,</span><span class="token string">' - '</span><span class="token punctuation">,</span><span class="token string">'桃李不言下自成蹊'</span><span class="token punctuation">)</span>

<span class="token comment">-- concat 字符串拼接</span>
<span class="token keyword">select</span>  concat_ws<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span>array<span class="token punctuation">(</span><span class="token string">'2022'</span><span class="token punctuation">,</span><span class="token string">'04'</span><span class="token punctuation">,</span><span class="token string">'19'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- get_json_object 解析 json 字符串</span>
<span class="token keyword">select</span> get_json_object<span class="token punctuation">(</span><span class="token string">'{"name":"李昊哲","age":41}'</span><span class="token punctuation">,</span><span class="token string">'$.name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> name<span class="token punctuation">;</span>

<span class="token keyword">select</span> get_json_object<span class="token punctuation">(</span><span class="token string">'[
{"name":"李昊哲","age":41},
{"name":"李哲","age":16}
]'</span><span class="token punctuation">,</span><span class="token string">'$.[0].name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> name<span class="token punctuation">;</span>

<span class="token comment">-- json_tuple</span>
<span class="token keyword">select</span> json_tuple<span class="token punctuation">(</span><span class="token string">'{"name":"李昊哲","age":41}'</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 日期函数</span>
<span class="token comment">-- unix_timestamp</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- from_unixtime</span>
<span class="token keyword">select</span> from_unixtime<span class="token punctuation">(</span><span class="token number">438381000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- current_date</span>
<span class="token keyword">select</span> <span class="token keyword">current_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- current_timestamp</span>
<span class="token keyword">select</span> <span class="token keyword">current_timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- year</span>
<span class="token keyword">select</span> <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- month</span>
<span class="token keyword">select</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- day</span>
<span class="token keyword">select</span> <span class="token keyword">day</span><span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- hours</span>
<span class="token keyword">select</span> <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- minute</span>
<span class="token keyword">select</span> <span class="token keyword">minute</span><span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- second</span>
<span class="token keyword">select</span> <span class="token keyword">second</span><span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- datediff 两个日期相差天数 (结束日期减去开始日期)</span>
<span class="token keyword">select</span> datediff<span class="token punctuation">(</span><span class="token string">'1983-11-22'</span><span class="token punctuation">,</span><span class="token string">'1983-10-18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- date_add 日期增加几天</span>
<span class="token keyword">select</span> date_add<span class="token punctuation">(</span><span class="token string">'1983-11-22'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- date_sub 日期减少几天</span>
<span class="token keyword">select</span> date_sub<span class="token punctuation">(</span><span class="token string">'1983-11-22'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- date_format 日期格式化</span>
<span class="token keyword">select</span> date_format<span class="token punctuation">(</span><span class="token string">'1983-11-22 20:30:00'</span><span class="token punctuation">,</span><span class="token string">'yyyy年MM月dd日 HH时mm分ss秒'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 读取身份证获取出生日期 输出格式为unix_stamp</span>
<span class="token comment">-- 1、字符串截取 2、日期转换</span>
<span class="token keyword">select</span> substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- 读取身份证获取出生日期 输出格式为 yyyy-MM-dd</span>
<span class="token comment">-- 1、字符串截取 2、日期格式化</span>
<span class="token keyword">select</span> substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> substr<span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> date_format<span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span> unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> person <span class="token keyword">limit</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- 流程控制函数</span>
<span class="token comment">-- case when</span>
<span class="token comment">-- 90以上A 80~90B 70~80C 60~70D 60以下E</span>
<span class="token keyword">select</span>
stu_id<span class="token punctuation">,</span>course_id<span class="token punctuation">,</span>
<span class="token keyword">case</span>
<span class="token keyword">when</span> score <span class="token operator">&gt;=</span> <span class="token number">90</span> <span class="token keyword">then</span> <span class="token string">'A'</span>
<span class="token keyword">when</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token keyword">then</span> <span class="token string">'B'</span>
<span class="token keyword">when</span> score <span class="token operator">&gt;=</span> <span class="token number">70</span> <span class="token keyword">then</span> <span class="token string">'C'</span>
<span class="token keyword">when</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token keyword">then</span> <span class="token string">'D'</span>
<span class="token keyword">else</span> <span class="token string">'E'</span>
<span class="token keyword">end</span> <span class="token keyword">as</span> grade
<span class="token keyword">from</span> score<span class="token punctuation">;</span>

<span class="token comment">-- if 三目运算 if(条件表达式,条件为真的返回结果,条件为假的返回结果)</span>
<span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'托尼'</span><span class="token punctuation">,</span><span class="token string">'玛丽'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>发型师<span class="token punctuation">`</span></span>

<span class="token comment">-- 结合字符串函数 时间函数 流程控制函数 计算身份证信息</span>
<span class="token comment">-- 根据身份证号 判断性别 身份证号 第十七位 奇数为男性 偶数为女性</span>
<span class="token keyword">select</span> id_card<span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'精神小伙儿'</span><span class="token punctuation">,</span><span class="token string">'扒蒜老妹儿'</span><span class="token punctuation">)</span> gender <span class="token keyword">from</span> person<span class="token punctuation">;</span>

<span class="token comment">-- 根据身份证号 找出所有男性信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> gender <span class="token keyword">from</span> person <span class="token keyword">where</span> <span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 根据身份证号 计算男性人数和女性人数</span>
<span class="token keyword">select</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'精神小伙儿'</span><span class="token punctuation">,</span><span class="token string">'扒蒜老妹儿'</span><span class="token punctuation">)</span> gender <span class="token punctuation">,</span>
<span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> gender_count
<span class="token keyword">from</span> person <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- 根据身份证号 计算生日排序</span>
<span class="token keyword">select</span>
date_format<span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span> unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>birthday<span class="token punctuation">`</span></span>
<span class="token keyword">from</span> person
<span class="token keyword">order</span> <span class="token keyword">by</span> unix_timestamp<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>birthday<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> <span class="token keyword">desc</span>

<span class="token comment">-- 根据身份证号 计算年龄</span>
<span class="token comment">-- 1、当前月份-出生月份 &gt; 0 说明 已经过完生日 及 使用 当前年份 - 出生年份 = 年龄</span>
<span class="token comment">-- 2、当前月份-出生月份 &lt; 0 说明 未过生日 及 使用 当前年份 - 出生年份 -1 = 年龄</span>
<span class="token comment">-- 3、当前月份-出生月份 = 0 </span>
<span class="token comment">-- 3.1、当前日-出生日 &gt; 0 说明 已经过完生日 及 使用 当前年份 - 出生年份 = 年龄</span>
<span class="token comment">-- 3.2、当前日-出生日 &lt; 0 说明 未过生日 及 使用 当前年份 - 出生年份 -1 = 年龄</span>
<span class="token comment">-- 3.3、当前日-出生日 = 0 说明 生日视作过完了 及 使用 当前年份 - 出生年份  = 年龄</span>
<span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">month</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">year</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">month</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
         <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">year</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">day</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">year</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">day</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
               <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">year</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
               <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">year</span><span class="token punctuation">(</span>from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyyMMdd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
             <span class="token punctuation">)</span>
          <span class="token punctuation">)</span>
       <span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>age<span class="token punctuation">`</span></span>
<span class="token keyword">from</span> person<span class="token punctuation">;</span>

<span class="token comment">-- 集合函数</span>
<span class="token comment">-- size</span>
<span class="token comment">-- array 声明一个集合</span>
<span class="token keyword">select</span> array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">as</span> nums<span class="token punctuation">;</span>

<span class="token comment">-- array_contains 判断 array 中是否包含某元素</span>
<span class="token keyword">select</span> array_contains<span class="token punctuation">(</span>array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num<span class="token punctuation">;</span>

<span class="token comment">-- sort_array array中元素排序 目前只有升序</span>
<span class="token keyword">select</span> sort_array<span class="token punctuation">(</span>array<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> nums<span class="token punctuation">;</span>

<span class="token comment">-- size 集合中元素的数量</span>
<span class="token keyword">select</span> size<span class="token punctuation">(</span>array<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> nums<span class="token punctuation">;</span>

<span class="token comment">-- map</span>
<span class="token keyword">select</span> map<span class="token punctuation">(</span><span class="token string">'校长'</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token string">'讲师'</span><span class="token punctuation">,</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- {"校长":10000,"讲师":8000} </span>

<span class="token comment">-- map_keys 返回 map 中 所有的 key</span>
<span class="token keyword">select</span> map_keys<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>map<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token string">'校长'</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token string">'讲师'</span><span class="token punctuation">,</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">keys</span><span class="token punctuation">;</span>

<span class="token comment">-- map_values 返回 map 中 所有的 value</span>
<span class="token keyword">select</span> map_values<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>map<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token string">'校长'</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token string">'讲师'</span><span class="token punctuation">,</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> v

<span class="token comment">-- struct 声明结构体属性名称</span>
<span class="token keyword">select</span> struct<span class="token punctuation">(</span><span class="token string">'real_name'</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- {"col1":"real_name","col2":"李昊哲","col3":"age","col4":41} </span>

<span class="token comment">-- named_struct 声明结构体属性和值</span>
<span class="token keyword">select</span> named_struct<span class="token punctuation">(</span><span class="token string">'real_name'</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- {"real_name":"李昊哲","age":41}</span>
</code></pre> 
<h3><a id="_1895"></a>综合练习</h3> 
<h4><a id="_1897"></a>练习数据</h4> 
<blockquote> 
 <p>学生表</p> 
 <p>讲师表</p> 
 <p>课程表</p> 
 <p>分数表</p> 
</blockquote> 
<h5><a id="_studentcsv_1907"></a>学生表 student.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz03/student
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/student.csv /quiz03/student
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> student <span class="token punctuation">(</span>
	stu_id string <span class="token keyword">comment</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
	stu_name string <span class="token keyword">comment</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
    birthday string <span class="token keyword">comment</span> <span class="token string">'出生日期'</span><span class="token punctuation">,</span>
    gender string <span class="token keyword">comment</span> <span class="token string">'学生性别'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz03/student'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/student.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> student<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_teachercsv_1931"></a>讲师表 teacher.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz03/teacher
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/teacher.csv /quiz03/teacher
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> teacher <span class="token punctuation">(</span>
	tea_id string <span class="token keyword">comment</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
	tea_name string <span class="token keyword">comment</span> <span class="token string">'课程名称'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz03/teacher'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/teacher.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> teacher<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_coursecsv_1953"></a>课程表 course.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz03/course
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/course.csv /quiz03/course
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> course <span class="token punctuation">(</span>
	course_id string <span class="token keyword">comment</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
	course_name string <span class="token keyword">comment</span> <span class="token string">'课程名称'</span><span class="token punctuation">,</span>
    tea_id string <span class="token keyword">comment</span> <span class="token string">'讲师ID'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz03/course'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/course.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> course<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_scorecsv_1976"></a>分数表 score.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz03/score
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/score.csv /quiz03/score
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> score <span class="token punctuation">(</span>
	stu_id string <span class="token keyword">comment</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
	course_id string <span class="token keyword">comment</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
    score <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'成绩'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz03/score'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/score.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> score<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1999"></a>练习题目</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询所有学生信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>

<span class="token comment">-- 查询周姓学生信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> stu_name <span class="token operator">like</span> <span class="token string">'周%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询周姓学生数量</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> stu_name <span class="token operator">like</span> <span class="token string">'周%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询 学生ID 004 的分数 超过 85 的成绩</span>
<span class="token keyword">select</span> stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> stu_name<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> course_id<span class="token punctuation">,</span> score <span class="token keyword">from</span> student stu <span class="token keyword">inner</span> <span class="token keyword">join</span> score s
   <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> <span class="token number">004</span> <span class="token operator">and</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id <span class="token operator">and</span> score <span class="token operator">&gt;</span> <span class="token number">85</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询 学生程ID 004 的成绩降序</span>
<span class="token keyword">select</span> stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> stu_name<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> course_id<span class="token punctuation">,</span> score <span class="token keyword">from</span> student stu <span class="token keyword">inner</span> <span class="token keyword">join</span> score s
   <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> <span class="token number">004</span>  <span class="token operator">and</span>  stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询 数学成绩不及格学生及其对应的成绩 学生成绩</span>
<span class="token keyword">select</span> stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> stu_name<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> course_name<span class="token punctuation">,</span> score <span class="token keyword">from</span> student stu
    <span class="token keyword">inner</span> <span class="token keyword">join</span> score s <span class="token keyword">inner</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> s<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id <span class="token operator">and</span>  stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
    <span class="token operator">and</span> c<span class="token punctuation">.</span>course_name <span class="token operator">=</span> <span class="token string">'数学'</span> <span class="token operator">and</span> score <span class="token operator">&lt;</span> <span class="token number">60</span> <span class="token keyword">order</span> <span class="token keyword">by</span> score<span class="token punctuation">;</span>

<span class="token comment">-- 查询男女生人数</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>

<span class="token comment">-- 查询编号为 02 的课程平均成绩</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> score <span class="token keyword">where</span> course_id <span class="token operator">=</span> <span class="token number">02</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询每科课程平均成绩</span>
<span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询参加考试学生人数</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> stu_id<span class="token punctuation">)</span> <span class="token keyword">from</span> score <span class="token keyword">where</span> score <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> score <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_id<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> stu_id <span class="token keyword">from</span> score <span class="token keyword">where</span> score <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> score <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">group</span> <span class="token keyword">by</span> stu_id<span class="token punctuation">)</span> t<span class="token punctuation">;</span>

<span class="token comment">-- 查询每科有多少学生参加考试</span>
<span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>stu_id<span class="token punctuation">)</span> <span class="token keyword">from</span> score <span class="token keyword">where</span> score <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> score <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询未参加考试的学生信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> stu_id <span class="token operator">in</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> stu<span class="token punctuation">.</span>stu_id <span class="token keyword">from</span> student stu
        <span class="token keyword">left</span> <span class="token keyword">join</span> score s <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
        <span class="token keyword">group</span> <span class="token keyword">by</span> stu<span class="token punctuation">.</span>stu_id <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> course<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询选修至少 4 门 以上课程学生的学号</span>
<span class="token keyword">select</span> stu_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>course_id<span class="token punctuation">)</span> course_count <span class="token keyword">from</span> score
 <span class="token keyword">group</span> <span class="token keyword">by</span> stu_id
 <span class="token keyword">having</span> course_count <span class="token operator">&gt;=</span> <span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询姓氏相同学生名单 并且同姓人数大于 2 的姓氏</span>
<span class="token keyword">select</span> first_name <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> first_name_count <span class="token keyword">from</span> <span class="token punctuation">(</span>
 <span class="token keyword">select</span> stu_id<span class="token punctuation">,</span>stu_name<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>stu_name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> first_name
 <span class="token keyword">from</span> student
<span class="token punctuation">)</span> ts
 <span class="token keyword">group</span> <span class="token keyword">by</span> ts<span class="token punctuation">.</span>first_name
 <span class="token keyword">having</span> first_name_count <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询每门功课的学生的平均成绩 按照平均成绩升序 平均成绩相同按照课程编号降序</span>
<span class="token keyword">select</span> course_id<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> avg_score
 <span class="token keyword">from</span> score
 <span class="token keyword">group</span> <span class="token keyword">by</span> course_id
 <span class="token keyword">order</span> <span class="token keyword">by</span> avg_score<span class="token punctuation">,</span>course_id <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 统计参加考试人数大于等于 15 的学科</span>
<span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> stu_count <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id <span class="token keyword">having</span> stu_count <span class="token operator">&gt;</span> <span class="token number">15</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询学生总成绩并按照总成绩降序排序</span>
<span class="token keyword">select</span> stu_id<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> sum_score
 <span class="token keyword">from</span> score
 <span class="token keyword">group</span> <span class="token keyword">by</span> stu_id
 <span class="token keyword">order</span> <span class="token keyword">by</span> sum_score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 按照指定格式显示 stu_id 语文 数学 英语 选课数 平均成绩</span>
<span class="token keyword">select</span>
 s<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>
 <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>course_name<span class="token operator">=</span><span class="token string">'语文'</span><span class="token punctuation">,</span>score<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>语文<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
 <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>course_name<span class="token operator">=</span><span class="token string">'数学'</span><span class="token punctuation">,</span>score<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>数学<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
 <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>course_name<span class="token operator">=</span><span class="token string">'英语'</span><span class="token punctuation">,</span>score<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>英语<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
 <span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>选课数<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
 <span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>平均成绩<span class="token punctuation">`</span></span>
 <span class="token keyword">from</span> course c <span class="token keyword">left</span> <span class="token keyword">join</span> score s
 <span class="token keyword">on</span> c<span class="token punctuation">.</span>course_id <span class="token operator">=</span> s<span class="token punctuation">.</span>course_id
 <span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>stu_id
 <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token identifier"><span class="token punctuation">`</span>平均成绩<span class="token punctuation">`</span></span> <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询一共参加了三门功课且其中一门为语文的学生id 和 姓名</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>stu_name <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>stu_id <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> course_count  <span class="token keyword">from</span>
	<span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span>course_id <span class="token keyword">from</span> score
		<span class="token keyword">where</span> stu_id <span class="token operator">in</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> stu_id <span class="token keyword">from</span> score <span class="token keyword">where</span> course_id <span class="token operator">=</span> <span class="token string">"01"</span><span class="token punctuation">)</span>
	<span class="token punctuation">)</span> t1 <span class="token keyword">group</span> <span class="token keyword">by</span>  t1<span class="token punctuation">.</span>stu_id <span class="token keyword">having</span> course_count <span class="token operator">&gt;=</span><span class="token number">3</span>
<span class="token punctuation">)</span> t2 <span class="token keyword">join</span> student s <span class="token keyword">on</span> t2<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id<span class="token punctuation">;</span>
<span class="token comment">-- 分解</span>
<span class="token comment">-- 查询该学生的姓名</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>stu_name <span class="token keyword">from</span>
<span class="token comment">-- 成绩表中学习科目数量 &gt;=3 科的学生</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>stu_id <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> course_count  <span class="token keyword">from</span>
 	<span class="token comment">--  报名了语文的学生还报名了那些学科</span>
	<span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span>course_id <span class="token keyword">from</span> score
		<span class="token keyword">where</span> stu_id <span class="token operator">in</span> <span class="token punctuation">(</span>
            <span class="token comment">-- 查询报名了语文的学生ID</span>
            <span class="token keyword">select</span> stu_id <span class="token keyword">from</span> score <span class="token keyword">where</span> course_id <span class="token operator">=</span> <span class="token string">"01"</span>
        <span class="token punctuation">)</span>
	<span class="token punctuation">)</span> t1 <span class="token keyword">group</span> <span class="token keyword">by</span>  t1<span class="token punctuation">.</span>stu_id <span class="token keyword">having</span> course_count <span class="token operator">&gt;=</span><span class="token number">3</span>
<span class="token punctuation">)</span> t2 <span class="token keyword">join</span> student s <span class="token keyword">on</span> t2<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询两门以上的课程不及格学生的学号及其平均成绩</span>
<span class="token comment">-- 1、先按照学生分组 过滤出成绩低于60的数量 大于1</span>
<span class="token comment">-- 2、计算所有学生的平均成绩</span>
<span class="token comment">-- 3、两个子查询相互join</span>
<span class="token keyword">select</span>  t1<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>avg_score <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> result <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> stu_id <span class="token keyword">having</span> result <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> t1
 <span class="token keyword">left</span> <span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_score <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> stu_id<span class="token punctuation">)</span> t2 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>stu_id <span class="token operator">=</span>t2<span class="token punctuation">.</span>stu_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询所有学生的学号、姓名、选课数、总成绩</span>
<span class="token keyword">select</span>
    stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>stu<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> count_course <span class="token punctuation">,</span>nvl<span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> total_score
<span class="token keyword">from</span> student stu <span class="token keyword">left</span> <span class="token keyword">join</span> score s <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
<span class="token keyword">group</span> <span class="token keyword">by</span> stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> stu<span class="token punctuation">.</span>stu_name <span class="token keyword">order</span> <span class="token keyword">by</span> stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">;</span>

<span class="token comment">-- 平均成绩大于 85 的所有学生的学号、姓名、平均成绩</span>
<span class="token keyword">select</span>
    stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>stu<span class="token punctuation">.</span>stu_name <span class="token punctuation">,</span>nvl<span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span>
<span class="token keyword">from</span> student stu <span class="token keyword">left</span> <span class="token keyword">join</span> score s <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
<span class="token keyword">group</span> <span class="token keyword">by</span> stu<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> stu<span class="token punctuation">.</span>stu_name <span class="token keyword">having</span> nvl<span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">85</span> <span class="token keyword">order</span> <span class="token keyword">by</span> stu<span class="token punctuation">.</span>stu_id

<span class="token comment">-- 查询学生的选课情况：学号，姓名，课程号，课程名称</span>
<span class="token keyword">select</span> student<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>student<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span>c<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>c<span class="token punctuation">.</span>course_name <span class="token keyword">from</span> student
<span class="token keyword">right</span> <span class="token keyword">join</span> score s <span class="token keyword">on</span> student<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
<span class="token keyword">left</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> s<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id

<span class="token comment">-- 查询学生的没有选课情况：学号，姓名</span>
<span class="token keyword">select</span> stu_id<span class="token punctuation">,</span>stu_name <span class="token keyword">from</span>
<span class="token punctuation">(</span>
<span class="token keyword">select</span> student<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>student<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>course_id <span class="token keyword">from</span> student
<span class="token keyword">left</span> <span class="token keyword">join</span> score s <span class="token keyword">on</span> student<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
<span class="token keyword">left</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> s<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id
<span class="token punctuation">)</span> t <span class="token keyword">where</span> course_id <span class="token operator">is</span> <span class="token boolean">null</span>

<span class="token comment">-- 查询出每门课程的及格人数和不及格人数</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>course_name<span class="token punctuation">,</span>pass<span class="token punctuation">,</span>fail
<span class="token keyword">from</span> course c <span class="token keyword">join</span>
<span class="token punctuation">(</span>
<span class="token keyword">select</span>
 course_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>pass<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>fail<span class="token punctuation">`</span></span>
 <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id
<span class="token punctuation">)</span> t <span class="token keyword">on</span> c<span class="token punctuation">.</span>course_id <span class="token operator">=</span> t<span class="token punctuation">.</span>course_id

<span class="token comment">-- 查询课程编号为03且课程成绩在80分以上的学生的学号和姓名及课程信息</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>c<span class="token punctuation">.</span>course_name<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> score <span class="token keyword">where</span> course_id <span class="token operator">=</span> <span class="token string">'03'</span> <span class="token operator">and</span> score <span class="token operator">&gt;</span> <span class="token number">80</span><span class="token punctuation">)</span> t1
<span class="token keyword">left</span> <span class="token keyword">join</span> student s <span class="token keyword">on</span> s<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>stu_id
<span class="token keyword">left</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> t1<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id

<span class="token comment">-- 查询语文成绩低于平均分数的学生是谁，教师是谁</span>
<span class="token keyword">select</span> t3<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span>t3<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>tea_name <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t2<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>c<span class="token punctuation">.</span>tea_id <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span> <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span> <span class="token keyword">from</span> score s <span class="token keyword">right</span> <span class="token keyword">join</span>
         <span class="token punctuation">(</span><span class="token keyword">select</span> course_id <span class="token keyword">from</span> course <span class="token keyword">where</span> course_name <span class="token operator">=</span> <span class="token string">'语文'</span><span class="token punctuation">)</span> t1 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>course_id <span class="token operator">=</span> s<span class="token punctuation">.</span>course_id
         <span class="token keyword">group</span> <span class="token keyword">by</span> stu_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> t1
        <span class="token keyword">where</span> t1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>avg_score<span class="token punctuation">`</span></span> <span class="token keyword">from</span> score s <span class="token keyword">right</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> course_id <span class="token keyword">from</span> course <span class="token keyword">where</span> course_name <span class="token operator">=</span> <span class="token string">'语文'</span><span class="token punctuation">)</span> t1 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>course_id <span class="token operator">=</span> s<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span>
    <span class="token punctuation">)</span> t2 <span class="token keyword">left</span> <span class="token keyword">join</span> student s <span class="token keyword">on</span> t2<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s<span class="token punctuation">.</span>stu_id
    <span class="token keyword">left</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> t2<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id
<span class="token punctuation">)</span>t3 <span class="token keyword">left</span> <span class="token keyword">join</span> teacher t <span class="token keyword">on</span> t3<span class="token punctuation">.</span>tea_id <span class="token operator">=</span> t<span class="token punctuation">.</span>tea_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询所有学生总成绩和平均成绩，</span>
<span class="token comment">-- 且他们的总成绩低于平均成绩的有多少个人，</span>
<span class="token comment">-- 高于平均成绩的有多少人，</span>
<span class="token comment">-- 低于平均成绩的男生和女生分别有多少人，</span>
<span class="token comment">-- 且他们的任课老师是谁。</span>

<span class="token comment">-- 统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-75],[70-60],[0-60]及所占百分比</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span> course_name<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token keyword">from</span> course c <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> course_id<span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">85</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> a<span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">between</span> <span class="token number">75</span> <span class="token operator">and</span> <span class="token number">84</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> b<span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">between</span> <span class="token number">60</span> <span class="token operator">and</span> <span class="token number">74</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c<span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> d
    <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id
<span class="token punctuation">)</span> t <span class="token keyword">on</span> t<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询各科成绩最高分、最低分和平均分，以如下形式显示：</span>
<span class="token comment">-- 课程ID，课程name，最高分，最低分，平均分，中下率，中等率，优良率，优秀率</span>
<span class="token comment">-- 及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span> course_name<span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>最高分<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>最低分<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>平均分<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>优秀率<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>优良率<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>中等率<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>中下率<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>芸芸众生<span class="token punctuation">`</span></span> <span class="token keyword">from</span> course c <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> course_id<span class="token punctuation">,</span>
           <span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token identifier"><span class="token punctuation">`</span>最高分<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
           <span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token identifier"><span class="token punctuation">`</span>最低分<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
           <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token identifier"><span class="token punctuation">`</span>平均分<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">90</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>优秀率<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">between</span> <span class="token number">80</span> <span class="token operator">and</span> <span class="token number">89</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>优良率<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">between</span> <span class="token number">70</span> <span class="token operator">and</span> <span class="token number">79</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>中等率<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">between</span> <span class="token number">60</span> <span class="token operator">and</span> <span class="token number">69</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>中下率<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
       concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>芸芸众生<span class="token punctuation">`</span></span>
    <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id
<span class="token punctuation">)</span> t <span class="token keyword">on</span> t<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询每门课程的男生和女生的比例是多少</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>gender<span class="token punctuation">,</span> concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>count_gender <span class="token operator">/</span> count_course_student<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> proportion <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span>gender<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_gender <span class="token keyword">from</span> score s1 <span class="token keyword">inner</span> <span class="token keyword">join</span> student s2 <span class="token keyword">on</span> s1<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>stu_id <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">,</span>gender<span class="token punctuation">)</span> t1
    <span class="token keyword">inner</span> <span class="token keyword">join</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_course_student <span class="token keyword">from</span> score s1 <span class="token keyword">inner</span> <span class="token keyword">join</span> student s2 <span class="token keyword">on</span> s1<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>stu_id <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">)</span> t2
    <span class="token keyword">on</span> t2<span class="token punctuation">.</span>course_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>course_id<span class="token punctuation">;</span>

<span class="token comment">-- 每门学科的成绩是男生比较优一些还是女生比较优一些，并且每门课程的最高分是谁。</span>
<span class="token keyword">select</span> battle_t<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>male_avg_score<span class="token punctuation">,</span> female_avg_score<span class="token punctuation">,</span> battle<span class="token punctuation">,</span> max_stu_id<span class="token punctuation">,</span>min_stu_id<span class="token punctuation">,</span> max_score<span class="token punctuation">,</span> min_score <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> male_t<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>male_avg_score<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> male_avg_score<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>female_avg_score<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> female_avg_score<span class="token punctuation">,</span>
           <span class="token keyword">case</span>
               <span class="token keyword">when</span> male_avg_score <span class="token operator">&gt;</span> female_avg_score <span class="token keyword">then</span> <span class="token string">'男性优秀'</span>
               <span class="token keyword">when</span> male_avg_score <span class="token operator">&lt;</span> female_avg_score <span class="token keyword">then</span> <span class="token string">'女性优秀'</span>
               <span class="token keyword">else</span> <span class="token string">'势均力敌'</span>
           <span class="token keyword">end</span> battle
        <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> male_avg_score <span class="token keyword">from</span> score s1 <span class="token keyword">inner</span> <span class="token keyword">join</span> student s2 <span class="token keyword">on</span> s1<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>stu_id <span class="token operator">and</span> gender <span class="token operator">=</span> <span class="token string">'男'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">)</span> male_t
        <span class="token keyword">inner</span> <span class="token keyword">join</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> female_avg_score <span class="token keyword">from</span> score s1 <span class="token keyword">inner</span> <span class="token keyword">join</span> student s2 <span class="token keyword">on</span> s1<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>stu_id <span class="token operator">and</span> gender <span class="token operator">=</span> <span class="token string">'女'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">)</span> female_t
        <span class="token keyword">on</span> male_t<span class="token punctuation">.</span>course_id <span class="token operator">=</span> female_t<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> battle_t
    <span class="token keyword">inner</span> <span class="token keyword">join</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> max_t<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>max_t<span class="token punctuation">.</span>stu_id max_stu_id<span class="token punctuation">,</span>max_score<span class="token punctuation">,</span>min_t<span class="token punctuation">.</span>stu_id min_stu_id<span class="token punctuation">,</span>min_score <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span> max_score <span class="token keyword">from</span> score s
                <span class="token keyword">inner</span> <span class="token keyword">join</span>
                <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> max_score <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">)</span> t
                <span class="token keyword">on</span> s<span class="token punctuation">.</span>course_id <span class="token operator">=</span> t<span class="token punctuation">.</span>course_id <span class="token operator">and</span> max_score <span class="token operator">=</span> score<span class="token punctuation">)</span> max_t
        <span class="token keyword">full</span> <span class="token keyword">join</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> stu_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span> min_score <span class="token keyword">from</span> score s
                <span class="token keyword">inner</span> <span class="token keyword">join</span>
                <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> min_score <span class="token keyword">from</span> score <span class="token keyword">group</span> <span class="token keyword">by</span> course_id<span class="token punctuation">)</span> t
                <span class="token keyword">on</span> s<span class="token punctuation">.</span>course_id <span class="token operator">=</span> t<span class="token punctuation">.</span>course_id <span class="token operator">and</span> min_score <span class="token operator">=</span> score<span class="token punctuation">)</span> min_t
        <span class="token keyword">on</span> max_t<span class="token punctuation">.</span>course_id <span class="token operator">=</span> min_t<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> info
    <span class="token keyword">on</span> battle_t<span class="token punctuation">.</span>course_id <span class="token operator">=</span> info<span class="token punctuation">.</span>course_id<span class="token punctuation">;</span>

<span class="token comment">-- 课程编号为"01"且课程分数小于60，按分数降序排列的学生信息</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> stu<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span> stu<span class="token punctuation">.</span>birthday<span class="token punctuation">,</span> stu<span class="token punctuation">.</span>gender<span class="token punctuation">,</span>s<span class="token punctuation">.</span>score
    <span class="token keyword">from</span> score s <span class="token keyword">join</span> student stu <span class="token keyword">on</span> s<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> stu<span class="token punctuation">.</span>stu_id
    <span class="token keyword">where</span> s<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询所有课程成绩在70分以上的学生的姓名、课程名称和分数，按分数升序</span>
<span class="token keyword">select</span> stu<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span> c<span class="token punctuation">.</span>course_name<span class="token punctuation">,</span> s2<span class="token punctuation">.</span>score
    <span class="token keyword">from</span> student stu <span class="token keyword">join</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> s<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>score <span class="token operator">&gt;=</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>is_ok<span class="token punctuation">`</span></span> <span class="token keyword">from</span> score s <span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>stu_id <span class="token keyword">having</span> is_ok <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> t1
    <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>stu_id <span class="token keyword">left</span> <span class="token keyword">join</span> score s2 <span class="token keyword">on</span> stu<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>stu_id <span class="token keyword">left</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> s2<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>course_id
    <span class="token keyword">order</span> <span class="token keyword">by</span> s2<span class="token punctuation">.</span>score<span class="token punctuation">;</span>

<span class="token comment">-- 查询某学生不同课程的成绩相同的学生编号、课程编号、学生成绩</span>
<span class="token keyword">select</span> s1<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>collect_list<span class="token punctuation">(</span>s1<span class="token punctuation">.</span>course_id<span class="token punctuation">)</span> <span class="token keyword">as</span> course_id<span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>s1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> score
    <span class="token keyword">from</span> score s1 <span class="token keyword">join</span> score s2 <span class="token keyword">on</span> s1<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>stu_id
    <span class="token operator">and</span> s1<span class="token punctuation">.</span>course_id <span class="token operator">!=</span> s2<span class="token punctuation">.</span>course_id
    <span class="token operator">and</span> s1<span class="token punctuation">.</span>score <span class="token operator">=</span><span class="token operator">=</span> s2<span class="token punctuation">.</span>score
    <span class="token keyword">group</span> <span class="token keyword">by</span> s1<span class="token punctuation">.</span>stu_id<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="TopN_2256"></a>分组排序取TopN</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询各科成绩前五名的学生</span>
<span class="token keyword">select</span> a<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score <span class="token keyword">from</span> score a
    <span class="token keyword">left</span> <span class="token keyword">join</span> score b
    <span class="token keyword">on</span> a<span class="token punctuation">.</span>course_id <span class="token operator">=</span> b<span class="token punctuation">.</span>course_id <span class="token operator">and</span> a<span class="token punctuation">.</span>score <span class="token operator">&lt;=</span> b<span class="token punctuation">.</span>score
    <span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score
    <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>stu_id<span class="token punctuation">)</span> <span class="token operator">&lt;=</span><span class="token number">5</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> S1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>s1<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>s1<span class="token punctuation">.</span>score <span class="token keyword">from</span> score s1 <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> score s2
        <span class="token keyword">where</span> s2<span class="token punctuation">.</span>course_id<span class="token operator">=</span>s1<span class="token punctuation">.</span>course_id <span class="token operator">AND</span> s2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> s1<span class="token punctuation">.</span>score
        <span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token keyword">order</span> <span class="token keyword">by</span> s1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>s1<span class="token punctuation">.</span>score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- row_number() over () 连续序号</span>
<span class="token comment">-- over()里头的分组以及排序的执行晚于 where 、group by、order by 的执行。</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>  score<span class="token punctuation">,</span>
        row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> course_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> mum
        <span class="token keyword">from</span> score<span class="token punctuation">)</span> t <span class="token keyword">where</span> mum <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">-- rank() over () 排名 跳跃排序 序号不是连续的</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>  score<span class="token punctuation">,</span>
        rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> course_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> mum
        <span class="token keyword">from</span> score<span class="token punctuation">)</span> t <span class="token keyword">where</span> mum <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">-- dense_rank() over () 排名 连续排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>  score<span class="token punctuation">,</span>
        dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> course_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> mum
        <span class="token keyword">from</span> score<span class="token punctuation">)</span> t <span class="token keyword">where</span> mum <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_2292"></a>行列转换</h3> 
<h4><a id="_2294"></a>列转行</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> test <span class="token punctuation">(</span>
    stu_name string<span class="token punctuation">,</span>
    course_name string<span class="token punctuation">,</span>
    score <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> test <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'80'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'90'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token string">'85'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token string">'95'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> stu_name<span class="token punctuation">,</span>
       <span class="token keyword">case</span> <span class="token keyword">when</span> course_name <span class="token operator">=</span> <span class="token string">'语文'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span> <span class="token keyword">as</span> yuwen<span class="token punctuation">,</span>
       <span class="token keyword">case</span> <span class="token keyword">when</span> course_name <span class="token operator">=</span> <span class="token string">'数学'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span> <span class="token keyword">as</span> shuxue
       <span class="token keyword">from</span> test<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- null 在 比较的时候 是最小值</span>
<span class="token keyword">select</span> stu_name<span class="token punctuation">,</span>
       <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> course_name <span class="token operator">=</span> <span class="token string">'语文'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> yuwen<span class="token punctuation">,</span>
       <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> course_name <span class="token operator">=</span> <span class="token string">'数学'</span> <span class="token keyword">then</span> score <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> shuxue
       <span class="token keyword">from</span> test <span class="token keyword">group</span> <span class="token keyword">by</span> stu_name<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3e/ad/PZgOOVt5_o.png" alt="行列转换"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 员工表 emp.csv</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> emp <span class="token punctuation">(</span>
	emp_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'员工ID'</span><span class="token punctuation">,</span>
	emp_name string <span class="token keyword">comment</span> <span class="token string">'员工姓名'</span><span class="token punctuation">,</span>
    emp_job string <span class="token keyword">comment</span> <span class="token string">'员工岗位'</span><span class="token punctuation">,</span>
    emp_salary <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'员工薪资'</span><span class="token punctuation">,</span>
    dept_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'员工隶属部门ID'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz01/emp'</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/emp.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> emp<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- 多个值转为集合 collect_list 不会去重</span>
<span class="token keyword">select</span> collect_list<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span> job_list <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- 多个值转为集合 collect_set 会去重</span>
<span class="token keyword">select</span> collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span> job_set <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- size 获取结合中元素的数量</span>
<span class="token keyword">select</span> size<span class="token punctuation">(</span>collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span><span class="token punctuation">)</span> job_count <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- concat_ws 将多个数据 以分隔符形式 拼接 concat_ws(分隔符,数据1,数据2,...)</span>
<span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span><span class="token punctuation">)</span> job_string <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- split 字符串切分 以分隔符切分字符串 为集合</span>
<span class="token keyword">select</span> split<span class="token punctuation">(</span>concat_ws<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">)</span> job_item <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_2349"></a>行转列</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> sales <span class="token punctuation">(</span>
    emp_name string<span class="token punctuation">,</span>
    january <span class="token keyword">int</span><span class="token punctuation">,</span>
    february <span class="token keyword">int</span><span class="token punctuation">,</span>
    march <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> sales <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">1500</span><span class="token punctuation">,</span><span class="token number">2500</span><span class="token punctuation">,</span><span class="token number">3500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sales<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e7/b3/qCTBxvUj_o.png" alt="行列转换"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> emp_name<span class="token punctuation">,</span><span class="token string">'january'</span> yue<span class="token punctuation">,</span> january sale <span class="token keyword">from</span> sales
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> emp_name<span class="token punctuation">,</span><span class="token string">'february'</span> yue<span class="token punctuation">,</span>february sale <span class="token keyword">from</span> sales
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> emp_name<span class="token punctuation">,</span><span class="token string">'march'</span> yue<span class="token punctuation">,</span>march sale <span class="token keyword">from</span> sales<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> t1<span class="token punctuation">.</span>emp_name<span class="token punctuation">,</span>
    yue_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> january<span class="token punctuation">,</span>
    yue_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> february<span class="token punctuation">,</span>
    yue_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> march
    <span class="token keyword">from</span><span class="token punctuation">(</span>
        <span class="token keyword">select</span> t<span class="token punctuation">.</span>emp_name<span class="token punctuation">,</span>collect_list<span class="token punctuation">(</span>yue<span class="token punctuation">)</span> yue_list <span class="token keyword">from</span><span class="token punctuation">(</span>
            <span class="token keyword">select</span> emp_name<span class="token punctuation">,</span>january yue <span class="token keyword">from</span> sales
            <span class="token keyword">union</span> <span class="token keyword">all</span>
            <span class="token keyword">select</span> emp_name<span class="token punctuation">,</span>february yue <span class="token keyword">from</span> sales
            <span class="token keyword">union</span> <span class="token keyword">all</span>
            <span class="token keyword">select</span> emp_name<span class="token punctuation">,</span>march yue <span class="token keyword">from</span> sales<span class="token punctuation">)</span> t
            <span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>emp_name<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- collect_list</span>
<span class="token keyword">select</span> collect_list<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>job<span class="token punctuation">`</span></span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- collect_set</span>
<span class="token keyword">select</span> collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>job<span class="token punctuation">`</span></span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- concat_ws</span>
<span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>job<span class="token punctuation">`</span></span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- split</span>
<span class="token keyword">select</span> split<span class="token punctuation">(</span>concat_ws<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>emp_job<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>job_list<span class="token punctuation">`</span></span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_2402"></a>用户函数</h3> 
<blockquote> 
 <ul><li>UDF，即用户定义函数(user-defined function)，作用于单行数据，并且产生一个数据行作为输出。</li></ul> 
 <p>Hive中大多数函数都属于这一类，比如数学函数和字符串函数。UDF函数的输入与输出值是1:1关系。</p> 
 <ul><li>UDTF，即用户定义表生成函数（user-defined table-generating function），</li></ul> 
 <p>作用于单行数据，并且产生多个数据行。UDTF函数的输入与输出值是1:n的关系。</p> 
 <ul><li>UDAF，用户定义聚集函数（user-defined aggregate function），作用于多行数据，产生一个输出数据行。<br> Hive中像COUNT、MAX、MIN和SUM这样的函数就是聚集函数。UDAF函数的输入与输出值是n:1的关系。</li></ul> 
</blockquote> 
<h4><a id="_employeecsv_2419"></a>雇员表 employee.csv</h4> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz04/employee
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/employee.csv /quiz04/employee
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> employee<span class="token punctuation">(</span>
    name string <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    sex  string <span class="token keyword">comment</span> <span class="token string">'性别'</span><span class="token punctuation">,</span>
    birthday string <span class="token keyword">comment</span> <span class="token string">'出生年月'</span><span class="token punctuation">,</span>
    hiredate string <span class="token keyword">comment</span> <span class="token string">'入职日期'</span><span class="token punctuation">,</span>
    job string <span class="token keyword">comment</span> <span class="token string">'岗位'</span><span class="token punctuation">,</span>
    salary <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'薪资'</span><span class="token punctuation">,</span>
    bonus <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'奖金'</span><span class="token punctuation">,</span>
    friends array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> <span class="token keyword">comment</span> <span class="token string">'朋友'</span><span class="token punctuation">,</span>
    children map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token keyword">comment</span> <span class="token string">'孩子'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'_'</span> 
 map <span class="token keyword">keys</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">':'</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz04/employee'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/employee.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> employee<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="UDTF_2450"></a>UDTF</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- explode</span>
<span class="token keyword">select</span> explode<span class="token punctuation">(</span>array<span class="token punctuation">(</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'python'</span><span class="token punctuation">,</span><span class="token string">'scala'</span><span class="token punctuation">,</span><span class="token string">'go'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> course<span class="token punctuation">;</span>
<span class="token keyword">select</span> explode<span class="token punctuation">(</span>map<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">,</span><span class="token string">'gender'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token keyword">key</span><span class="token punctuation">,</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- posexplode</span>
<span class="token keyword">select</span> posexplode<span class="token punctuation">(</span>array<span class="token punctuation">(</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'python'</span><span class="token punctuation">,</span><span class="token string">'scala'</span><span class="token punctuation">,</span><span class="token string">'go'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">(</span>pos<span class="token punctuation">,</span>course<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- inline</span>
<span class="token keyword">select</span> inline<span class="token punctuation">(</span>array<span class="token punctuation">(</span>named_struct<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">,</span><span class="token string">'gender'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   named_struct<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'李哲'</span><span class="token punctuation">,</span><span class="token string">'gender'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   named_struct<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'李大宝'</span><span class="token punctuation">,</span><span class="token string">'gender'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- lateral view   </span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>friends<span class="token punctuation">)</span> t <span class="token keyword">as</span> friend<span class="token punctuation">;</span>

<span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>friends<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>friend <span class="token keyword">from</span> employee e lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>friends<span class="token punctuation">)</span> t1 <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>friend<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee e lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>children<span class="token punctuation">)</span> t1 <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>children_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>children_friend_count<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>children<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>children_name<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>nvl<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>children_friend_count<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">from</span> employee e
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>children<span class="token punctuation">)</span> t1 <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>children_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>children_friend_count<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>friends<span class="token punctuation">,</span>e<span class="token punctuation">.</span>children<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>friend<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>children_name<span class="token punctuation">,</span>nvl<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>children_friend_count<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">from</span> employee e
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>friends<span class="token punctuation">)</span> t1 <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>friend<span class="token punctuation">`</span></span>
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>children<span class="token punctuation">)</span> t2 <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>children_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>children_friend_count<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">-- lateral view outer</span>

</code></pre> 
<h4><a id="_movietxt_2483"></a>电影表 movie.txt</h4> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /quiz04/movie
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/movie.txt /quiz04/movie
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> movie<span class="token punctuation">(</span>
    name string <span class="token keyword">comment</span> <span class="token string">'电影名称'</span><span class="token punctuation">,</span>
    category string <span class="token keyword">comment</span> <span class="token string">'电影分类'</span>
<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'-'</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz04/movie'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/movie.txt'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> movie<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="UDTF__2505"></a>UDTF 案例</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 根据上述电影信息表，统计各分类的电影数量</span>
<span class="token keyword">select</span> cate<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token identifier"><span class="token punctuation">`</span>quantity<span class="token punctuation">`</span></span> <span class="token keyword">from</span> movie
 lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>split<span class="token punctuation">(</span>category<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span> tmp <span class="token keyword">as</span> cate
 <span class="token keyword">group</span> <span class="token keyword">by</span> cate<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_2514"></a>分组和去重</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 统计岗位数量</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> emp_job<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> emp_job <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> emp_job<span class="token punctuation">)</span> t<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_2521"></a>窗口函数(开窗函数)</h4> 
<blockquote> 
 <p>能为每行数据划分一个窗口，然后对窗口范围内的数据进行计算，最后将计算结果返回给该行</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">Function</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> argn<span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>window_expression<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">-- 其中Function(arg1,..., argn) 可以是下面分类中的任意一个</span>
    <span class="token comment">-- 聚合函数：比如sum max min avg count等</span>
    <span class="token comment">-- 分析函数：比如lead lag first_value last_value等</span>
    <span class="token comment">-- 排序函数：比如row_number rank dense_rank等    </span>
<span class="token comment">-- OVER [PARTITION BY &lt;...&gt;] 类似于group by 用于指定分组  每个分组你可以把它叫做窗口</span>
<span class="token comment">-- 如果没有PARTITION BY 那么整张表的所有行就是一组</span>
<span class="token comment">-- [ORDER BY &lt;....&gt;]  用于指定每个分组内的数据排序规则 支持ASC、DESC</span>
<span class="token comment">-- [&lt;window_expression&gt;] 用于指定每个窗口中 操作的数据范围 默认是窗口中所有行</span>

</code></pre> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> /quiz04/order
hdfs dfs <span class="token parameter variable">-put</span> /root/data/data02/order.csv /quiz04/order
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span>
<span class="token punctuation">(</span>
    order_id     string <span class="token keyword">comment</span> <span class="token string">'订单id'</span><span class="token punctuation">,</span>
    user_id      string <span class="token keyword">comment</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    user_name    string <span class="token keyword">comment</span> <span class="token string">'用户姓名'</span><span class="token punctuation">,</span>
    order_date   string <span class="token keyword">comment</span> <span class="token string">'下单日期'</span><span class="token punctuation">,</span>
    order_amount <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'订单金额'</span>
<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/quiz04/order'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/data02/order.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_2563"></a>聚合函数</h5> 
<blockquote> 
 <p>rows 基于行</p> 
 <p>range 基于值</p> 
 <p>函数() over(rows between and 3)</p> 
 <ul><li>unbounded preceding 表示从前面的起点</li><li>number preceding 往前</li><li>current row 当前行</li><li>number following 往后</li><li>unbounded following 表示到后面的终点</li></ul> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token comment">-- 统计每个用户截至每次下单的累计下单总额</span>

<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span>
           <span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
           <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
           <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">unbounded</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">current</span> <span class="token keyword">row</span>
           <span class="token punctuation">)</span> sum_order_amount
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span>
           <span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
           <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
           <span class="token keyword">rows</span> <span class="token keyword">unbounded</span> <span class="token keyword">preceding</span>
           <span class="token punctuation">)</span> sum_order_amount
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">-- 统计每个用户截至每次下单的当月累积下单总额</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span>
           <span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
           <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
           <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">unbounded</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">unbounded</span> <span class="token keyword">following</span>
           <span class="token punctuation">)</span> sum_order_amount
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">-- 最近三笔订单总金额</span>
<span class="token comment">-- 当前订单金额与前两笔订单金额的总和</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span>
           <span class="token keyword">partition</span> <span class="token keyword">by</span> user_id
           <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
           <span class="token keyword">rows</span> <span class="token number">2</span> <span class="token keyword">preceding</span>
           <span class="token punctuation">)</span> sum_order_amount
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">-- 当前订单金额与后两笔订单金额的总和</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span>
           <span class="token keyword">partition</span> <span class="token keyword">by</span> user_id
           <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
           <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">current</span> <span class="token keyword">row</span> <span class="token operator">and</span> <span class="token number">2</span> <span class="token keyword">following</span>
           <span class="token punctuation">)</span> sum_order_amount
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">-- 当前订单金额与前一笔订单和后一笔订单金额的总和</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span>
           <span class="token keyword">partition</span> <span class="token keyword">by</span> user_id
           <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
           <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token number">1</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token number">1</span> <span class="token keyword">following</span>
           <span class="token punctuation">)</span> sum_order_amount
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_2634"></a>分析函数</h5> 
<blockquote> 
 <p>lag lead</p> 
 <pre><code>lag() over() 与 lead() over() 函数是跟偏移量相关的两个分析函数，
通过这两个函数可以在一次查询中取出同一字段的前 N 行的数据 (lag) 和后 N 行的数据 (lead) 作为独立的列,
从而更方便地进行进行数据过滤。这种操作可以代替表的自联接，并且 LAG 和 LEAD 有更高的效率。
over() 表示 lag() 与 lead() 操作的数据都在 over() 的范围内，可以使用 partition by 语句（用于分组） order by 语句（用于排序）。
partition by a order by b 表示以 a 字段进行分组，再 以 b 字段进行排序，对数据进行查询。

例如：lag(field, num, defaultvalue) field 需要查找的字段，num 往前查找的 num 行的数据，defaultvalue 没有符合条件的默认值

例如：lead(field, num, defaultvalue) field 需要查找的字段，num 往后查找的 num 行的数据，defaultvalue 没有符合条件的默认值
</code></pre> 
 <p>first_value last_value</p> 
 <pre><code>irst_value 取每个分区内某列的第一个值
语法：first_value(col,true/false) over (partition by col1 order by col2)
第二个参数为true，跳过空值（默认为false）

ast_value 取每个分区内某列的最后一个值
语法：last_value(col,true/false) over (partition by col1 order by col2)
第二个参数为true，跳过空值（默认为false）
</code></pre> 
</blockquote> 
<h6><a id="lead_lag_2662"></a>lead lag</h6> 
<pre><code class="prism language-sql"><span class="token comment">-- 统计每个用户每次下单距离上次下单相隔的天数（首次下单按0天算）</span>
<span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span> datediff<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span>pre_order_date<span class="token punctuation">)</span> diff_data <span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span>
       lag<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>order_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> order_date<span class="token punctuation">)</span> pre_order_date
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>

<span class="token comment">-- 每个用户首笔订单时间</span>
<span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount <span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span>
       lag<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>order_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> order_date<span class="token punctuation">)</span> pre_order_date
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span> t <span class="token keyword">where</span> datediff<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span>pre_order_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">-- 每个用户每个月首笔订单时间</span>
<span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount <span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span>
       lag<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>order_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> order_date<span class="token punctuation">)</span> pre_order_date
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span> t <span class="token keyword">where</span> datediff<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span>pre_order_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
       
<span class="token comment">-- 每个用户每个月最后笔订单时间</span>
<span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount <span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span>
       lead<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>order_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> order_date<span class="token punctuation">)</span> next_order_date
       <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span> t <span class="token keyword">where</span> datediff<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span>next_order_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
       
<span class="token comment">-- 每个岗位先先入职的远哥和后入在的员工工资差</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> hiredate<span class="token punctuation">,</span> job<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> bonus<span class="token punctuation">,</span> friends<span class="token punctuation">,</span> children<span class="token punctuation">,</span> new_salary<span class="token punctuation">,</span><span class="token punctuation">(</span>salary <span class="token operator">-</span> new_salary<span class="token punctuation">)</span> salary_diff <span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> birthday<span class="token punctuation">,</span> hiredate<span class="token punctuation">,</span> job<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> bonus<span class="token punctuation">,</span> friends<span class="token punctuation">,</span> children<span class="token punctuation">,</span>
       lead<span class="token punctuation">(</span>salary<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>salary<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> job <span class="token keyword">order</span> <span class="token keyword">by</span> hiredate<span class="token punctuation">)</span> new_salary
       <span class="token keyword">from</span> employee<span class="token punctuation">)</span> t<span class="token punctuation">;</span>
</code></pre> 
<h6><a id="first_value_last_value_2696"></a>first_value last_value</h6> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询所有下单记录以及每个用户的每个下单记录所在月份的首/末次下单日期</span>
<span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span> first_order_date<span class="token punctuation">,</span> last_order_date <span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span>
        first_value<span class="token punctuation">(</span>order_date<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> order_date<span class="token punctuation">)</span> <span class="token identifier"><span class="token punctuation">`</span>first_order_date<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
        last_value<span class="token punctuation">(</span>order_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
            <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">current</span> <span class="token keyword">row</span> <span class="token operator">and</span> <span class="token keyword">unbounded</span> <span class="token keyword">following</span><span class="token punctuation">)</span> <span class="token identifier"><span class="token punctuation">`</span>last_order_date<span class="token punctuation">`</span></span>
    <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span>t
    <span class="token keyword">where</span> t<span class="token punctuation">.</span>order_date <span class="token operator">=</span> first_order_date <span class="token operator">or</span> t<span class="token punctuation">.</span>order_date <span class="token operator">=</span> last_order_date<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_2709"></a>排序函数</h5> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询各科成绩前五名的学生</span>
<span class="token keyword">select</span> a<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score <span class="token keyword">from</span> score a
    <span class="token keyword">left</span> <span class="token keyword">join</span> score b
    <span class="token keyword">on</span> a<span class="token punctuation">.</span>course_id <span class="token operator">=</span> b<span class="token punctuation">.</span>course_id <span class="token operator">and</span> a<span class="token punctuation">.</span>score <span class="token operator">&lt;=</span> b<span class="token punctuation">.</span>score
    <span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score
    <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>stu_id<span class="token punctuation">)</span> <span class="token operator">&lt;=</span><span class="token number">5</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> S1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>s1<span class="token punctuation">.</span>stu_id<span class="token punctuation">,</span>s1<span class="token punctuation">.</span>score <span class="token keyword">from</span> score s1 <span class="token keyword">where</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> score s2
        <span class="token keyword">where</span> s2<span class="token punctuation">.</span>course_id<span class="token operator">=</span>s1<span class="token punctuation">.</span>course_id <span class="token operator">AND</span> s2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> s1<span class="token punctuation">.</span>score
        <span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token keyword">order</span> <span class="token keyword">by</span> s1<span class="token punctuation">.</span>course_id<span class="token punctuation">,</span>s1<span class="token punctuation">.</span>score <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- row_number() over () 连续序号</span>
<span class="token comment">-- over()里头的分组以及排序的执行晚于 where 、group by、order by 的执行。</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>  score<span class="token punctuation">,</span>
        row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> course_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> mum
        <span class="token keyword">from</span> score<span class="token punctuation">)</span> t <span class="token keyword">where</span> mum <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">-- rank() over () 排名 跳跃排序 序号不是连续的</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>  score<span class="token punctuation">,</span>
        rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> course_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> mum
        <span class="token keyword">from</span> score<span class="token punctuation">)</span> t <span class="token keyword">where</span> mum <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">-- dense_rank() over () 排名 连续排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> course_id<span class="token punctuation">,</span> stu_id<span class="token punctuation">,</span>  score<span class="token punctuation">,</span>
        dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> course_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> mum
        <span class="token keyword">from</span> score<span class="token punctuation">)</span> t <span class="token keyword">where</span> mum <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- 每个月每个消费总金额前三名的用户</span>
<span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span> total_order_amount<span class="token punctuation">,</span> rank_total_order_amount <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span> total_order_amount<span class="token punctuation">,</span>
    dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> total_order_amount <span class="token keyword">desc</span><span class="token punctuation">)</span> rank_total_order_amount
    <span class="token keyword">from</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> order_id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> order_amount<span class="token punctuation">,</span>
           <span class="token function">sum</span><span class="token punctuation">(</span>order_amount<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> substr<span class="token punctuation">(</span>order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> order_date
               <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">unbounded</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">unbounded</span> <span class="token keyword">following</span><span class="token punctuation">)</span> total_order_amount
           <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span> t<span class="token punctuation">)</span> t1 <span class="token keyword">where</span> rank_total_order_amount <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_2757"></a>案例分析</h3> 
<h4><a id="_2759"></a>准备数据</h4> 
<h5><a id="_usercsv_2761"></a>用户信息表 user.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/user
hdfs dfs <span class="token parameter variable">-put</span> /root/user.csv /tmall/user
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span>  string <span class="token keyword">COMMENT</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span>   string <span class="token keyword">COMMENT</span> <span class="token string">'性别'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>birthday<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'生日'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户信息表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/user'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/user.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_skucsv_2784"></a>商品信息表 sku.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/sku
hdfs dfs <span class="token parameter variable">-put</span> /root/sku.csv /tmall/sku
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> sku <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span>      string <span class="token keyword">COMMENT</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span>        string <span class="token keyword">COMMENT</span> <span class="token string">'商品名称'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category_id<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'所属分类id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>from_date<span class="token punctuation">`</span></span>   string <span class="token keyword">COMMENT</span> <span class="token string">'上架日期'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>price<span class="token punctuation">`</span></span>       <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品单价'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品信息表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/sku'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/sku.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> sku<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_categorycsv_2809"></a>商品分类信息表 category.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/category
hdfs dfs <span class="token parameter variable">-put</span> /root/category.csv /tmall/category
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> category <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>category_id<span class="token punctuation">`</span></span>   string <span class="token keyword">COMMENT</span> <span class="token string">'商品分类ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>category_name<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'商品分类名称'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品分类信息表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/category'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/category.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> category<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_ordercsv_2831"></a>订单信息表 order.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/order
hdfs dfs <span class="token parameter variable">-put</span> /root/order.csv /tmall/order
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>order_id<span class="token punctuation">`</span></span>     string <span class="token keyword">COMMENT</span> <span class="token string">'订单id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span>      string <span class="token keyword">COMMENT</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_date<span class="token punctuation">`</span></span>  string <span class="token keyword">COMMENT</span> <span class="token string">'下单日期'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>total_amount<span class="token punctuation">`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单总金额'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单信息表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/order'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/order.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token keyword">order</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_order_detailcsv_2855"></a>订单明细表 order_detail.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/order_detail
hdfs dfs <span class="token parameter variable">-put</span> /root/order_detail.csv /tmall/order_detail
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> order_detail <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>order_detail_id<span class="token punctuation">`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">'订单明细id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>order_id<span class="token punctuation">`</span></span>        string <span class="token keyword">COMMENT</span> <span class="token string">'订单id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span>          string <span class="token keyword">COMMENT</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_date<span class="token punctuation">`</span></span>     string <span class="token keyword">COMMENT</span> <span class="token string">'下单日期'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>price<span class="token punctuation">`</span></span>           <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'下单时的商品单价'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_num<span class="token punctuation">`</span></span>         <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'下单商品件数'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'订单明细表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/order_detail'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/order_detail.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> order_detail<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_user_logincsv_2881"></a>登录明细表 user_login.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/user_login
hdfs dfs <span class="token parameter variable">-put</span> /root/user_login.csv /tmall/user_login
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> user_login <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span>    string <span class="token keyword">comment</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>ip_address<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'ip地址'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>login_ts<span class="token punctuation">`</span></span>   string <span class="token keyword">comment</span> <span class="token string">'登录时间'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>logout_ts<span class="token punctuation">`</span></span>  string <span class="token keyword">comment</span> <span class="token string">'登出时间'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'登录明细表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/user_login'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/user_login.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> user_login<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_sku_price_modify_detailcsv_2905"></a>商品价格变更明细 sku_price_modify_detail.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/sku_price_modify_detail
hdfs dfs <span class="token parameter variable">-put</span> /root/sku_price_modify_detail.csv /tmall/sku_price_modify_detail
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> sku_price_modify_detail <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span>      string <span class="token keyword">comment</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>new_price<span class="token punctuation">`</span></span>   <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'更改后的价格'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>change_date<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'变动日期'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'商品价格变更明细表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/sku_price_modify_detail'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/sku_price_modify_detail.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> sku_price_modify_detail<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_deliverycsv_2928"></a>配送信息表 delivery.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/delivery
hdfs dfs <span class="token parameter variable">-put</span> /root/delivery.csv /tmall/delivery
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> delivery <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>delivery_id<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'配送单id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>order_id<span class="token punctuation">`</span></span>    string <span class="token keyword">comment</span> <span class="token string">'订单id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span>     string <span class="token keyword">comment</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>order_date<span class="token punctuation">`</span></span>  string <span class="token keyword">comment</span> <span class="token string">'下单日期'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>custom_date<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'期望配送日期'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'配送信息表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/delivery'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/delivery.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> delivery<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_friendshipcsv_2953"></a>好友关系表 friendship.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/friendship
hdfs dfs <span class="token parameter variable">-put</span> /root/friendship.csv /tmall/friendship
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> friendship <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>firend_id<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'好友id'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'好友关系表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/friendship'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/friendship.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> friendship<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_favorcsv_2975"></a>收藏信息表 favor.csv</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /tmall/favor
hdfs dfs <span class="token parameter variable">-put</span> /root/favor.csv /tmall/favor
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> favor <span class="token punctuation">(</span>
	<span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span>     string <span class="token keyword">comment</span> <span class="token string">'用户id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>sku_id<span class="token punctuation">`</span></span>      string <span class="token keyword">comment</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>create_date<span class="token punctuation">`</span></span> string <span class="token keyword">comment</span> <span class="token string">'收藏日期'</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'收藏信息表'</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> 
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/tmall/favor'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/favor.csv'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> favor<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_2998"></a>练习题目</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询订单明细表（order_detail）中销量（下单件数）排名第二的商品id，不存在返回null，存在多个排名第二的商品则需要全部返回</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>sku_id <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>sum_sku <span class="token keyword">desc</span><span class="token punctuation">)</span> ranking <span class="token keyword">from</span>
 <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> sum_sku <span class="token keyword">from</span> order_detail  <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> t2 <span class="token keyword">where</span> t2<span class="token punctuation">.</span>ranking <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询订单信息表(order)中最少连续3天下单的用户id</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>user_id <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id
 <span class="token punctuation">,</span>lag<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span>  <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> day01
 <span class="token punctuation">,</span>lead<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> day03
 <span class="token keyword">from</span>
 <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>create_date <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span> create_date<span class="token punctuation">)</span> t1  <span class="token comment">-- 相同用户在同一天下单视为一条记录</span>
<span class="token punctuation">)</span>t2 <span class="token keyword">where</span> datediff<span class="token punctuation">(</span>day03<span class="token punctuation">,</span>day01<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">group</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表(order_detail)统计各品类销售出的商品种类数及累积销量最好的商品</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>category_name<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>name<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>sum_sku_num<span class="token punctuation">,</span>
       rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>sum_sku_num <span class="token keyword">desc</span><span class="token punctuation">)</span> ranking
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span>
    t1<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>category_name<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sum_sku_num<span class="token punctuation">,</span>
    rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>category_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>sum_sku_num <span class="token keyword">desc</span><span class="token punctuation">)</span> ranking
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> c<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>c<span class="token punctuation">.</span>category_name<span class="token punctuation">,</span>od<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>od<span class="token punctuation">.</span>sku_num<span class="token punctuation">)</span> sum_sku_num  <span class="token keyword">from</span> order_detail od
    <span class="token keyword">left</span> <span class="token keyword">join</span> sku s <span class="token keyword">on</span> od<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> s<span class="token punctuation">.</span>sku_id
    <span class="token keyword">left</span> <span class="token keyword">join</span> category c <span class="token keyword">on</span> s<span class="token punctuation">.</span>category_id <span class="token operator">=</span> c<span class="token punctuation">.</span>category_id
    <span class="token keyword">group</span> <span class="token keyword">by</span> c<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span> c<span class="token punctuation">.</span>category_name<span class="token punctuation">,</span> od<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name
<span class="token punctuation">)</span> t1<span class="token punctuation">)</span> t2 <span class="token keyword">where</span> t2<span class="token punctuation">.</span>ranking <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 从订单信息表(order)中统计每个用户截止其每个下单日期的累积消费金额，以及每个用户在其每个下单日期的VIP等级</span>
<span class="token comment">-- 用户vip等级根据累积消费金额计算，计算规则如下：</span>
<span class="token comment">-- 设累积消费总额为X，</span>
<span class="token comment">-- 若0=&lt;X&lt;10000,则vip等级为普通会员</span>
<span class="token comment">-- 若10000&lt;=X&lt;30000,则vip等级为青铜会员</span>
<span class="token comment">-- 若30000&lt;=X&lt;50000,则vip等级为白银会员</span>
<span class="token comment">-- 若50000&lt;=X&lt;80000,则vip为黄金会员</span>
<span class="token comment">-- 若80000&lt;=X&lt;100000,则vip等级为白金会员</span>
<span class="token comment">-- 若X&gt;=100000,则vip等级为钻石会员</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>total_amount_day<span class="token punctuation">,</span>
    <span class="token keyword">case</span>
        <span class="token keyword">when</span> t2<span class="token punctuation">.</span>total_amount_month <span class="token operator">&gt;=</span> <span class="token number">100000</span> <span class="token keyword">then</span> <span class="token string">'钻石会员'</span>
        <span class="token keyword">when</span> t2<span class="token punctuation">.</span>total_amount_month <span class="token operator">&gt;=</span> <span class="token number">80000</span> <span class="token keyword">then</span> <span class="token string">'白金会员'</span>
        <span class="token keyword">when</span> t2<span class="token punctuation">.</span>total_amount_month <span class="token operator">&gt;=</span> <span class="token number">50000</span> <span class="token keyword">then</span> <span class="token string">'黄金会员'</span>
        <span class="token keyword">when</span> t2<span class="token punctuation">.</span>total_amount_month <span class="token operator">&gt;=</span> <span class="token number">30000</span> <span class="token keyword">then</span> <span class="token string">'白银会员'</span>
        <span class="token keyword">when</span> t2<span class="token punctuation">.</span>total_amount_month <span class="token operator">&gt;=</span> <span class="token number">10000</span> <span class="token keyword">then</span> <span class="token string">'青铜会员'</span>
        <span class="token keyword">when</span> t2<span class="token punctuation">.</span>total_amount_month <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token string">'黑铁会员'</span>
    <span class="token keyword">end</span>  vip_level
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>total_amount_day<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>total_amount_day<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> total_amount_month
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>create_date<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>total_amount<span class="token punctuation">)</span> total_amount_day  <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span>
 <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>create_date
<span class="token punctuation">)</span> t1<span class="token punctuation">)</span> t2<span class="token punctuation">;</span>

<span class="token comment">-- 从订单信息表(order)中查询首次下单后第二天仍然下单的用户占所有下单用户的比例，结果保留一位小数，使用百分数显示</span>
<span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>count_order_user <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span> order_user_percent <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> size<span class="token punctuation">(</span>collect_set<span class="token punctuation">(</span>t3<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span><span class="token punctuation">)</span> count_order_user <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>next_day <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>
       lead<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> next_day
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>create_date <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>create_date<span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> t2 <span class="token keyword">where</span> datediff<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>next_day<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> t3<span class="token punctuation">)</span> t4<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表(order_detail)统计每个商品销售首年的年份、销售数量和销售总额</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> t2<span class="token punctuation">.</span>sku_id <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>first_create_date<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> sum_sku_num<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>price <span class="token operator">*</span> sku_num<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> total_amount
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>first_create_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>price<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sku_num
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>create_date<span class="token punctuation">,</span>price<span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span>
       first_value<span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku_id <span class="token keyword">order</span> <span class="token keyword">by</span> create_date<span class="token punctuation">)</span> first_create_date
<span class="token keyword">from</span> order_detail<span class="token punctuation">)</span> t1
<span class="token keyword">where</span> <span class="token keyword">year</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">year</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>first_create_date<span class="token punctuation">)</span>
<span class="token punctuation">)</span> t2<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表(order_detail)中筛选去年总销量小于100的商品及其销量，设今天的日期是2022-01-10，不考虑上架时间小于一个月的商品</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>name<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>total_sku_num
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> total_sku_num  <span class="token keyword">from</span> order_detail <span class="token keyword">where</span> <span class="token keyword">year</span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token string">'2022-01-11'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> sku_id <span class="token keyword">having</span> total_sku_num <span class="token operator">&lt;</span> <span class="token number">100</span> <span class="token punctuation">)</span> t1
<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>name <span class="token keyword">from</span> sku <span class="token keyword">where</span> datediff<span class="token punctuation">(</span><span class="token string">'2022-01-10'</span><span class="token punctuation">,</span>from_date<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> t2
<span class="token keyword">on</span> t1<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>sku_id

<span class="token comment">-- 从用户登录明细表（user_login）中查询每天的新增用户数，</span>
<span class="token comment">-- 若一个用户在某天登录了，且在这一天之前没登录过，则认为该用户为这一天的新增用户</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>first_date_login<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>
       <span class="token function">min</span><span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> first_date_login
<span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id
<span class="token punctuation">)</span> t1 <span class="token keyword">group</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>first_date_login<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表（order_detail）中统计出每种商品销售件数最多的日期及当日销量，如果有同一商品多日销量并列的情况，取其中的最小日期</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>sum_sku_num
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sum_sku_num<span class="token punctuation">,</span>
       row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>sku_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>sum_sku_num<span class="token punctuation">)</span> number
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>create_date<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> sum_sku_num
<span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">,</span> create_date<span class="token punctuation">)</span> t1<span class="token punctuation">)</span> t2
<span class="token keyword">where</span> t2<span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表（order_detail）中查询累积销售件数高于其所属品类平均数的商品</span>
<span class="token keyword">select</span> t3<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>name<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>sum_sku_num<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>avg_cate_num <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>name<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sum_sku_num<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sum_sku_num<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> category_id<span class="token punctuation">)</span> avg_cate_num
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> sum_sku_num <span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> t1
<span class="token keyword">left</span> <span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>category_id <span class="token keyword">from</span> sku<span class="token punctuation">)</span>t2 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> t3
<span class="token keyword">where</span> t3<span class="token punctuation">.</span>sum_sku_num <span class="token operator">&gt;</span> t3<span class="token punctuation">.</span>avg_cate_num<span class="token punctuation">;</span>

<span class="token comment">-- 从用户登录明细表（user_login）和订单信息表（order）中</span>
<span class="token comment">-- 查询每个用户的注册日期（首次登录日期）、总登录次数以及其在2021年的登录次数、订单数和订单总额</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>first_login_date<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>total_login<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>count_order<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>total_amount <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span> first_login_date <span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">)</span> t1
<span class="token keyword">left</span> <span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span> total_login <span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">)</span> t2
    <span class="token keyword">on</span> t1<span class="token punctuation">.</span>user_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>user_id
<span class="token keyword">left</span> <span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_order<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>total_amount<span class="token punctuation">)</span> total_amount <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> <span class="token keyword">where</span> <span class="token keyword">year</span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2021</span> <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">)</span> t3
 <span class="token keyword">on</span> t2<span class="token punctuation">.</span>user_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>user_id<span class="token punctuation">;</span>

<span class="token comment">-- 从商品价格修改明细表（sku_price_modify_detail）中查询2021-10-01的全部商品的价格，假设所有商品初始价格默认都是99</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sku_price_modify_detail <span class="token keyword">where</span> change_date <span class="token operator">=</span> <span class="token string">'2021-10-01'</span><span class="token punctuation">;</span>

<span class="token comment">-- 订单配送中，如果期望配送日期和下单日期相同，称为即时订单，如果期望配送日期和下单日期不同，称为计划订单。</span>
<span class="token comment">-- 从配送信息表（delivery）中求出每个用户的首单（用户的第一个订单）中即时订单的比例，保留两位小数，以小数形式显示</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>custom_date <span class="token operator">=</span> order_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">percent</span> <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> order_date<span class="token punctuation">)</span> num <span class="token keyword">from</span> delivery<span class="token punctuation">)</span> t1
<span class="token keyword">where</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 现需要请向所有用户推荐其朋友收藏但是用户自己未收藏的商品，</span>
<span class="token comment">-- 从好友关系表（friendship）和收藏表（favor）中查询出应向哪位用户推荐哪些商品</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>firend_favor<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> user_id<span class="token punctuation">,</span>friend_id <span class="token keyword">from</span> friendship
<span class="token keyword">union</span>
<span class="token keyword">select</span> friend_id<span class="token punctuation">,</span>user_id <span class="token keyword">from</span> friendship
<span class="token punctuation">)</span> t1 <span class="token keyword">left</span> <span class="token keyword">join</span> favor firend_favor <span class="token keyword">on</span> t1<span class="token punctuation">.</span>friend_id <span class="token operator">=</span> firend_favor<span class="token punctuation">.</span>user_id
<span class="token keyword">left</span> <span class="token keyword">join</span> favor my_favor <span class="token keyword">on</span> t1<span class="token punctuation">.</span>user_id <span class="token operator">=</span> firend_favor<span class="token punctuation">.</span>user_id
<span class="token operator">and</span> firend_favor<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> my_favor<span class="token punctuation">.</span>sku_id
<span class="token keyword">where</span> my_favor<span class="token punctuation">.</span>sku_id <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id

<span class="token comment">-- 从登录明细表（user_login）中查询出，所有用户的连续登录两天及以上的日期区间，以登录时间（login_ts）为准</span>
<span class="token keyword">select</span> t3<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>pre_login_date<span class="token punctuation">)</span> start_date<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>login_date<span class="token punctuation">)</span> end_date <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>login_date<span class="token punctuation">,</span>
       lag<span class="token punctuation">(</span>login_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>login_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> login_date<span class="token punctuation">)</span> pre_login_date
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> login_date
 <span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> t2 <span class="token keyword">where</span> datediff<span class="token punctuation">(</span>login_date<span class="token punctuation">,</span>pre_login_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">)</span> t3 <span class="token keyword">group</span> <span class="token keyword">by</span> t3<span class="token punctuation">.</span>user_id<span class="token punctuation">;</span>

<span class="token comment">-- 从订单信息表（order）和用户信息表（user）中，</span>
<span class="token comment">-- 分别统计每天男性和女性用户的订单总金额，如果当天男性或者女性没有购物，则统计结果为0</span>
<span class="token keyword">select</span> o<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>gender <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">,</span>o<span class="token punctuation">.</span>total_amount<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> male_total_amount<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">,</span>o<span class="token punctuation">.</span>total_amount<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> female_total_amount
<span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o
<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> u <span class="token keyword">on</span> o<span class="token punctuation">.</span>user_id <span class="token operator">=</span> u<span class="token punctuation">.</span>user_id
<span class="token keyword">group</span> <span class="token keyword">by</span> o<span class="token punctuation">.</span>create_date<span class="token punctuation">;</span>

<span class="token comment">-- 查询截止每天的最近3天内的订单金额总和以及订单金额日平均值，保留两位小数，四舍五入</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>total_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token number">2</span> <span class="token keyword">preceding</span> <span class="token operator">and</span>  <span class="token keyword">current</span> <span class="token keyword">row</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> total_3d<span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>total_amount<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token number">2</span> <span class="token keyword">preceding</span> <span class="token operator">and</span>  <span class="token keyword">current</span> <span class="token keyword">row</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> avg_3d
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> create_date<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>total_amount<span class="token punctuation">)</span> total_amount <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> <span class="token keyword">group</span> <span class="token keyword">by</span> create_date<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表(order_detail)中查询出所有购买过商品1和商品2，但是没有购买过商品3的用户</span>
<span class="token keyword">select</span> o<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>od<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> sku_ids <span class="token keyword">from</span> order_detail od <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o
    <span class="token keyword">on</span> od<span class="token punctuation">.</span>order_id <span class="token operator">=</span> o<span class="token punctuation">.</span>order_id
    <span class="token keyword">group</span> <span class="token keyword">by</span> o<span class="token punctuation">.</span>user_id
    <span class="token keyword">having</span> array_contains<span class="token punctuation">(</span>sku_ids<span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span> <span class="token operator">and</span> array_contains<span class="token punctuation">(</span>sku_ids<span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token operator">!</span>array_contains<span class="token punctuation">(</span>sku_ids<span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">from</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> o<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>collect_set<span class="token punctuation">(</span>od<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> sku_ids <span class="token keyword">from</span> order_detail od <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o
    <span class="token keyword">on</span> od<span class="token punctuation">.</span>order_id <span class="token operator">=</span> o<span class="token punctuation">.</span>order_id
    <span class="token keyword">group</span> <span class="token keyword">by</span> o<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> t1
    <span class="token keyword">where</span> array_contains<span class="token punctuation">(</span>sku_ids<span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span> <span class="token operator">and</span> array_contains<span class="token punctuation">(</span>sku_ids<span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token operator">!</span>array_contains<span class="token punctuation">(</span>sku_ids<span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span>

<span class="token comment">-- 从订单明细表（order_detail）中统计每天商品1和商品2销量（件数）的差值（商品1销量-商品2销量）</span>
<span class="token keyword">select</span> create_date<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>sku_id <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>sku_id <span class="token operator">=</span> <span class="token string">'2'</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> sku_num_diff
    <span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> create_date

<span class="token comment">-- 从订单信息表（order）中查询出每个用户的最近三笔订单</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> create_date <span class="token keyword">desc</span><span class="token punctuation">)</span> ranking <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">)</span> t1
<span class="token keyword">where</span> ranking <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment">-- 从登录明细表（user_login）中查询每个用户两个登录日期（以login_ts为准）之间的最大的空档期。</span>
<span class="token comment">-- 统计最大空档期时，用户最后一次登录至今的空档也要考虑在内，假设今天为2021-10-10</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>next_login_date<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>login_date<span class="token punctuation">)</span><span class="token punctuation">)</span> max_gap_period <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>login_date<span class="token punctuation">,</span>
       lead<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>login_date<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2021-10-10'</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>login_date<span class="token punctuation">)</span> next_login_date
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> login_date <span class="token keyword">from</span> user_login<span class="token punctuation">)</span> t1<span class="token punctuation">)</span> t2
<span class="token keyword">group</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>user_id

<span class="token comment">-- 从登录明细表（user_login）用户最后一次登录至今的空档期限，</span>
<span class="token comment">-- 分级推荐</span>
<span class="token comment">-- 一年以上 A级</span>
<span class="token comment">-- 半年以上 B级</span>
<span class="token comment">-- 3到6个月 C级</span>
<span class="token comment">-- 1到3个月 D级</span>
<span class="token comment">-- 一周以上 E级</span>
<span class="token comment">-- 一周以下 F级</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>gap_period<span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> gap_period <span class="token operator">&gt;</span> <span class="token number">365</span> <span class="token keyword">then</span> <span class="token string">'A'</span>
           <span class="token keyword">when</span> gap_period <span class="token operator">&gt;</span> <span class="token number">182</span> <span class="token keyword">then</span> <span class="token string">'B'</span>
           <span class="token keyword">when</span> gap_period <span class="token operator">&gt;</span> <span class="token number">91</span> <span class="token keyword">then</span> <span class="token string">'C'</span>
           <span class="token keyword">when</span> gap_period <span class="token operator">&gt;</span> <span class="token number">30</span> <span class="token keyword">then</span> <span class="token string">'D'</span>
           <span class="token keyword">when</span> gap_period <span class="token operator">&gt;</span> <span class="token number">7</span> <span class="token keyword">then</span> <span class="token string">'E'</span>
           <span class="token keyword">else</span> <span class="token string">'F'</span>
       <span class="token keyword">end</span> <span class="token keyword">level</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>datediff<span class="token punctuation">(</span>date_sub<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>current_date<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>date_format<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> gap_period
<span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>

<span class="token comment">-- 从登录明细表（user_login）中查询在相同时刻，多地登陆（ip_address不同）的用户</span>
<span class="token keyword">select</span> user_id<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> login_date <span class="token keyword">from</span> user_login
 <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span>
 <span class="token keyword">having</span> size<span class="token punctuation">(</span>collect_set<span class="token punctuation">(</span>ip_address<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 商家要求每个商品每个月需要售卖出一定的销售总额</span>
<span class="token comment">-- 假设1号商品销售总额大于21000，2号商品销售总额大于10000，其余商品没有要求</span>
<span class="token comment">-- 写出SQL从订单详情表中（order_detail）查询连续两个月销售总额大于等于任务总额的商品</span>
<span class="token keyword">select</span> t6<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>date_month<span class="token punctuation">,</span>date_amount <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t4<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t5<span class="token punctuation">.</span>create_month
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> t3<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>amount_map <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>collect_list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>ymd<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>total_amount<span class="token punctuation">)</span><span class="token punctuation">)</span> amount_map
     <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>ymd<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>total_amount
        <span class="token keyword">from</span>
            <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy-MM'</span><span class="token punctuation">)</span> ymd<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>price <span class="token operator">*</span> sku_num<span class="token punctuation">)</span> total_amount
                <span class="token keyword">from</span> order_detail <span class="token keyword">where</span> sku_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span>
                <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id <span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy-MM'</span><span class="token punctuation">)</span>
                <span class="token keyword">having</span> <span class="token punctuation">(</span>sku_id <span class="token operator">=</span> <span class="token string">'1'</span> <span class="token operator">and</span> total_amount <span class="token operator">&gt;</span> <span class="token number">21000</span><span class="token punctuation">)</span>
                <span class="token operator">or</span> <span class="token punctuation">(</span>sku_id <span class="token operator">=</span> <span class="token string">'2'</span> <span class="token operator">and</span> total_amount <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span> t1
        <span class="token punctuation">)</span>
    t2 <span class="token keyword">group</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span>
t3 <span class="token keyword">where</span> size<span class="token punctuation">(</span>t3<span class="token punctuation">.</span>amount_map<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> t4
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>t4<span class="token punctuation">.</span>amount_map<span class="token punctuation">)</span> t5 <span class="token keyword">as</span> create_month<span class="token punctuation">)</span> t6
lateral <span class="token keyword">view</span> explode<span class="token punctuation">(</span>t6<span class="token punctuation">.</span>create_month<span class="token punctuation">)</span> t5 <span class="token keyword">as</span> date_month<span class="token punctuation">,</span>date_amount<span class="token punctuation">;</span>

<span class="token comment">-- 从订单详情表中（order_detail）对销售件数对商品进行分类，</span>
<span class="token comment">-- 0-5000为冷门商品，5001-19999位一般商品，20000往上为热门商品，并求出不同类别商品的数量</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>category<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> total
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>
             <span class="token keyword">case</span>
                 <span class="token keyword">when</span> t1<span class="token punctuation">.</span>total_num <span class="token operator">between</span> <span class="token number">0</span> <span class="token operator">and</span> <span class="token number">5000</span> <span class="token keyword">then</span> <span class="token string">'冷门商品'</span>
                 <span class="token keyword">when</span> t1<span class="token punctuation">.</span>total_num <span class="token operator">between</span> <span class="token number">5001</span> <span class="token operator">and</span> <span class="token number">19999</span> <span class="token keyword">then</span> <span class="token string">'一般商品'</span>
                 <span class="token keyword">else</span> <span class="token string">'热门商品'</span>
                 <span class="token keyword">end</span> category
      <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> total_num <span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> t1<span class="token punctuation">)</span> t2
<span class="token keyword">group</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>category<span class="token punctuation">;</span>

<span class="token comment">-- 从订单详情表中（order_detail）和商品（sku）中查询各个品类销售数量前三的商品。</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>sku_id <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sku<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>
       rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku<span class="token punctuation">.</span>category_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>total_sku_num <span class="token keyword">desc</span> <span class="token punctuation">)</span> ranking
    <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> <span class="token keyword">as</span> total_sku_num <span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> t1
    <span class="token keyword">left</span> <span class="token keyword">join</span> sku <span class="token keyword">on</span> t1<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> sku<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> t2 <span class="token keyword">where</span> t2<span class="token punctuation">.</span>ranking <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment">-- 从订单详情表（order_detail）中找出销售额连续3天超过100的商品</span>
<span class="token keyword">select</span> t3<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>amount <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>amount<span class="token punctuation">,</span>
       <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>reference<span class="token punctuation">)</span> count_reference
    <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>amount<span class="token punctuation">,</span>
           date_sub<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>sku_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span><span class="token punctuation">)</span> reference
        <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id <span class="token punctuation">,</span>create_date<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>price <span class="token operator">*</span> sku_num<span class="token punctuation">)</span> amount <span class="token keyword">from</span> order_detail
        <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id <span class="token punctuation">,</span>create_date <span class="token keyword">having</span>  amount <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> t1
    <span class="token punctuation">)</span> t2
<span class="token punctuation">)</span> t3 <span class="token keyword">where</span> t3<span class="token punctuation">.</span>count_reference <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token keyword">order</span> <span class="token keyword">by</span>  t3<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t3<span class="token punctuation">.</span>create_date<span class="token punctuation">;</span>

<span class="token comment">-- 从用户登录明细表（user_login_detail）中首次登录算作当天新增，第二天也登录了算作一日留存</span>
<span class="token comment">-- 新增用户数量 第二日留存数量 第二日登录的留存率</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>count_next_day_login <span class="token operator">/</span> t2<span class="token punctuation">.</span>count_register<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> retention_rate <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>first_login_date<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> count_register<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>ul<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> count_next_day_login <span class="token keyword">from</span>
 <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> first_login_date <span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">)</span> t1
<span class="token keyword">left</span> <span class="token keyword">join</span> user_login ul <span class="token keyword">on</span> t1<span class="token punctuation">.</span>user_id <span class="token operator">=</span> ul<span class="token punctuation">.</span>user_id
<span class="token operator">and</span> datediff<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>t1<span class="token punctuation">.</span>first_login_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>first_login_date<span class="token punctuation">)</span> t2<span class="token punctuation">;</span>

<span class="token comment">-- 从订单详情表（order_detail）中，求出商品连续售卖的时间区间</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> start_date<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> end_date <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>create_date<span class="token punctuation">,</span>date_sub<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku_id <span class="token keyword">order</span> <span class="token keyword">by</span> create_date<span class="token punctuation">)</span><span class="token punctuation">)</span> reference
<span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">,</span>create_date<span class="token punctuation">)</span> t1
<span class="token keyword">group</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>reference<span class="token punctuation">;</span>

<span class="token comment">-- 分别从登陆明细表（user_login）和配送信息表（delivery）中每天用户登录时间和下单时间统计登陆次数和交易次数</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>login_date<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>count_login<span class="token punctuation">,</span> nvl<span class="token punctuation">(</span>count_consumption<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> count_consumption
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> login_date<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_login
      <span class="token keyword">from</span> user_login
      <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> t1
         <span class="token keyword">left</span> <span class="token keyword">join</span>
     <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span> create_date date_consumption<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_consumption
      <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span>
      <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span> create_date<span class="token punctuation">)</span> t2
     <span class="token keyword">on</span> t1<span class="token punctuation">.</span>user_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>user_id <span class="token operator">and</span> t1<span class="token punctuation">.</span>login_date <span class="token operator">=</span> t2<span class="token punctuation">.</span>date_consumption<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表（order_detail）中列出每个商品每个年度的购买总额</span>
<span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy'</span><span class="token punctuation">)</span> every_year<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>price <span class="token operator">*</span> sku_num<span class="token punctuation">)</span> total_amount
<span class="token keyword">from</span> order_detail <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 从订单详情表（order_detail）中查询2021年9月27号-2021年10月3号这一周所有商品每天销售情况</span>
<span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Monday<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Tuesday<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Wednesday<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Thursday<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Friday<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Saturday<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>dayofweek<span class="token punctuation">`</span></span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Sunday
<span class="token keyword">from</span> order_detail <span class="token keyword">where</span> create_date <span class="token operator">between</span> <span class="token string">'2021-09-27'</span> <span class="token operator">and</span> <span class="token string">'2021-10-03'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">;</span>

<span class="token comment">-- 从商品价格变更明细表（sku_price_modify_detail），得到最近一次价格的涨幅情况，并按照涨幅升序排序</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>change_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>new_price<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>increase <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span>change_date<span class="token punctuation">,</span>new_price<span class="token punctuation">,</span>
       new_price <span class="token operator">-</span> nvl<span class="token punctuation">(</span>lag<span class="token punctuation">(</span>new_price<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku_id <span class="token keyword">order</span> <span class="token keyword">by</span> change_date<span class="token punctuation">)</span><span class="token punctuation">,</span>new_price<span class="token punctuation">)</span> increase<span class="token punctuation">,</span>
       rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> sku_id <span class="token keyword">order</span> <span class="token keyword">by</span> change_date <span class="token keyword">desc</span><span class="token punctuation">)</span> ranking
<span class="token keyword">from</span> sku_price_modify_detail<span class="token punctuation">)</span> t1 <span class="token keyword">where</span> ranking <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>increase<span class="token punctuation">;</span>

<span class="token comment">-- 通过商品信息表（sku）订单信息表（order）订单明细表（order_detail）分析</span>
<span class="token comment">-- 如果有一个用户成功下单两个及两个以上的购买成功的手机订单（购买商品为xiaomi 10，apple 12，xiaomi 13）</span>
<span class="token comment">-- 那么输出这个用户的id及第一次成功购买手机的日期和第二次成功购买手机的日期，以及购买手机成功的次数</span>
<span class="token keyword">select</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>first_date<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>date_of_second<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>count_purchases <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date date_of_second<span class="token punctuation">,</span>
       first_value<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>create_date<span class="token punctuation">)</span> first_date<span class="token punctuation">,</span>
       dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>order_id<span class="token punctuation">)</span> ranking<span class="token punctuation">,</span>
       <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> t1<span class="token punctuation">.</span>order_id<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> count_purchases
    <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> o<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>o<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>o<span class="token punctuation">.</span>order_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name
        <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span> o
        <span class="token keyword">left</span> <span class="token keyword">join</span> order_detail od <span class="token keyword">on</span> <span class="token identifier"><span class="token punctuation">`</span>o<span class="token punctuation">`</span></span><span class="token punctuation">.</span>order_id <span class="token operator">=</span> od<span class="token punctuation">.</span>order_id
        <span class="token keyword">left</span> <span class="token keyword">join</span> sku s <span class="token keyword">on</span> od<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> s<span class="token punctuation">.</span>sku_id
    <span class="token punctuation">)</span>t1 <span class="token keyword">where</span> t1<span class="token punctuation">.</span>name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'xiaomi 10'</span><span class="token punctuation">,</span><span class="token string">'apple 12'</span><span class="token punctuation">,</span><span class="token string">'xiaomi 13'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> t2 <span class="token keyword">where</span> t2<span class="token punctuation">.</span>ranking <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表（order_detail）中，求出同一个商品在2020年和2021年中同一个月的售卖情况对比</span>
<span class="token keyword">select</span> nvl<span class="token punctuation">(</span>t2020<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>t2021<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> sku_id<span class="token punctuation">,</span>
       <span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token punctuation">(</span>t2020<span class="token punctuation">.</span>m<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">month</span><span class="token punctuation">(</span>t2021<span class="token punctuation">.</span>m<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
           <span class="token keyword">month</span><span class="token punctuation">(</span>t2021<span class="token punctuation">.</span>m<span class="token punctuation">)</span> <span class="token punctuation">,</span>
           <span class="token keyword">month</span><span class="token punctuation">(</span>t2020<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> m<span class="token punctuation">,</span>
       nvl<span class="token punctuation">(</span>t2020<span class="token punctuation">.</span>sku_sum<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> sku_num_2020<span class="token punctuation">,</span>
       nvl<span class="token punctuation">(</span>t2021<span class="token punctuation">.</span>sku_sum<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> sku_num_2021
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span> concat<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy-MM'</span><span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token string">'-01'</span><span class="token punctuation">)</span> m<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> sku_sum
    <span class="token keyword">from</span> order_detail
    <span class="token keyword">where</span> <span class="token keyword">year</span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2020</span>
    <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy-MM'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> t2020
<span class="token keyword">full</span> <span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span> concat<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy-MM'</span><span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token string">'-01'</span><span class="token punctuation">)</span> m<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> sku_sum
    <span class="token keyword">from</span> order_detail
    <span class="token keyword">where</span> <span class="token keyword">year</span><span class="token punctuation">(</span>create_date<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2021</span>
    <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>create_date<span class="token punctuation">,</span><span class="token string">'yyyy-MM'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> t2021
<span class="token keyword">where</span> t2020<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> t2021<span class="token punctuation">.</span>sku_id<span class="token punctuation">;</span>

<span class="token comment">-- 从订单明细表（order_detail）和收藏信息表（favor）统计2021国庆期间，每个商品总收藏量和购买量</span>
<span class="token keyword">select</span> nvl<span class="token punctuation">(</span>o<span class="token punctuation">.</span>sku_id<span class="token punctuation">,</span>f<span class="token punctuation">.</span>sku_id<span class="token punctuation">)</span> sku_id<span class="token punctuation">,</span>sku_num<span class="token punctuation">,</span>fav <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sku_num<span class="token punctuation">)</span> sku_num <span class="token keyword">from</span> order_detail
    <span class="token keyword">where</span> create_date <span class="token operator">between</span> <span class="token string">'2021-10-01'</span> <span class="token operator">and</span> <span class="token string">'2021-10-07'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> o
<span class="token keyword">full</span> <span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> sku_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> fav <span class="token keyword">from</span> favor <span class="token keyword">where</span> create_date <span class="token operator">&lt;</span> <span class="token string">'2021-10-8'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> sku_id<span class="token punctuation">)</span> f
<span class="token keyword">on</span> f<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> o<span class="token punctuation">.</span>sku_id

<span class="token comment">-- 假设今天是数据中所有日期的最大值，从用户登录明细表中的用户登录时间给各用户分级，求出各等级用户的人数</span>
<span class="token comment">-- 用户等级：</span>
<span class="token comment">-- 忠实用户：近7天活跃且非新用户</span>
<span class="token comment">-- 新晋用户：近7天新增</span>
<span class="token comment">-- 沉睡用户：近7天未活跃但是在7天前活跃</span>
<span class="token comment">-- 流失用户：近30天未活跃但是在30天前活跃</span>
<span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token keyword">level</span> <span class="token keyword">level</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_user <span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> ul<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> datediff<span class="token punctuation">(</span>today<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">30</span> <span class="token keyword">then</span> <span class="token string">'流失用户'</span>
           <span class="token keyword">when</span> datediff<span class="token punctuation">(</span>today<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">7</span> <span class="token operator">and</span>
                datediff<span class="token punctuation">(</span>today<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">30</span> <span class="token keyword">then</span> <span class="token string">'沉睡用户'</span>
           <span class="token keyword">when</span> datediff<span class="token punctuation">(</span>today<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">7</span> <span class="token keyword">then</span> <span class="token string">'新晋用户'</span>
           <span class="token keyword">when</span> datediff<span class="token punctuation">(</span>today<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">7</span> <span class="token operator">and</span>
                datediff<span class="token punctuation">(</span>today<span class="token punctuation">,</span> date_format<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">7</span> <span class="token keyword">then</span> <span class="token string">'忠实用户'</span>
       <span class="token keyword">end</span> <span class="token keyword">level</span>
<span class="token keyword">from</span> user_login ul
<span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> date_format<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>login_ts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> today <span class="token keyword">from</span> user_login<span class="token punctuation">)</span> ref
<span class="token keyword">group</span> <span class="token keyword">by</span> ul<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>today
<span class="token punctuation">)</span> t <span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token punctuation">;</span>

<span class="token comment">-- 用户每天签到可以领1金币，并可以累计签到天数，连续签到的第3、7天分别可以额外领2和6金币。</span>
<span class="token comment">-- 每连续签到7天重新累积签到天数。从用户登录明细表中求出每个用户金币总数，并按照金币总数倒序排序</span>
<span class="token keyword">select</span> t3<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>gold<span class="token punctuation">)</span> total_gold <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>
       <span class="token function">max</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>count_login<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>count_login <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>count_login <span class="token operator">%</span> <span class="token number">7</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> gold
    <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>login_date<span class="token punctuation">,</span>
           date_sub<span class="token punctuation">(</span>login_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>num<span class="token punctuation">)</span> ref<span class="token punctuation">,</span>
           <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>date_sub<span class="token punctuation">(</span>login_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>num<span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>login_date<span class="token punctuation">)</span> count_login
        <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> login_date<span class="token punctuation">,</span>
               row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> num
            <span class="token keyword">from</span> user_login <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>login_ts<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> t1
    <span class="token punctuation">)</span> t2 <span class="token keyword">group</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span>ref
<span class="token punctuation">)</span> t3 <span class="token keyword">group</span> <span class="token keyword">by</span> t3<span class="token punctuation">.</span>user_id <span class="token keyword">order</span> <span class="token keyword">by</span> total_gold <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 动销率定义为品类商品中一段时间内有销量的商品占当前已上架总商品数的比例（有销量的商品/已上架总商品数）。</span>
<span class="token comment">-- 滞销率定义为品类商品中一段时间内没有销量的商品占当前已上架总商品数的比例。（没有销量的商品 / 已上架总商品数）。</span>
<span class="token comment">-- 只要当天任一店铺有任何商品的销量就输出该天的结果</span>
<span class="token comment">-- 从订单明细表（order_detail）和商品信息表（sku）表中求出国庆7天每天每个品类的商品的动销率和滞销率</span>
<span class="token keyword">select</span> t4<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>
       t3<span class="token punctuation">.</span>day01 <span class="token operator">/</span> count_shelf day01_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day01<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day01_ar<span class="token punctuation">,</span>
        t3<span class="token punctuation">.</span>day02 <span class="token operator">/</span> count_shelf day02_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day02<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day02_ar<span class="token punctuation">,</span>
        t3<span class="token punctuation">.</span>day03 <span class="token operator">/</span> count_shelf day03_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day03<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day03_ar<span class="token punctuation">,</span>
        t3<span class="token punctuation">.</span>day04 <span class="token operator">/</span> count_shelf day04_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day04<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day04_ar<span class="token punctuation">,</span>
        t3<span class="token punctuation">.</span>day05 <span class="token operator">/</span> count_shelf day05_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day05<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day05_ar<span class="token punctuation">,</span>
        t3<span class="token punctuation">.</span>day06 <span class="token operator">/</span> count_shelf day06_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day06<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day06_ar<span class="token punctuation">,</span>
        t3<span class="token punctuation">.</span>day07 <span class="token operator">/</span> count_shelf day07_mr<span class="token punctuation">,</span>
       <span class="token punctuation">(</span>count_shelf <span class="token operator">-</span> t3<span class="token punctuation">.</span>day07<span class="token punctuation">)</span> <span class="token operator">/</span> count_shelf day07_ar
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> t2<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-01'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day01<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-02'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day02<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-03'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day03<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-04'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day04<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-05'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day05<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-06'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day06<span class="token punctuation">,</span>
       <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>if<span class="token punctuation">`</span></span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>create_date <span class="token operator">=</span> <span class="token string">'2021-10-07'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day07
       <span class="token keyword">from</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> t1<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>name <span class="token keyword">from</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> s<span class="token punctuation">.</span>category_id<span class="token punctuation">,</span>od<span class="token punctuation">.</span>create_date<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name
            <span class="token keyword">from</span> order_detail od <span class="token keyword">join</span> sku s <span class="token keyword">on</span> od<span class="token punctuation">.</span>sku_id <span class="token operator">=</span> s<span class="token punctuation">.</span>sku_id
        <span class="token punctuation">)</span> t1 <span class="token keyword">where</span> t1<span class="token punctuation">.</span>create_date <span class="token operator">between</span> <span class="token string">'2021-10-01'</span> <span class="token operator">and</span> <span class="token string">'2021-10-07'</span>
    <span class="token punctuation">)</span> t2 <span class="token keyword">group</span> <span class="token keyword">by</span> t2<span class="token punctuation">.</span>category_id
<span class="token punctuation">)</span> t3
<span class="token keyword">join</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> category_id<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count_shelf <span class="token keyword">from</span> sku <span class="token keyword">group</span> <span class="token keyword">by</span> category_id<span class="token punctuation">)</span> t4
<span class="token keyword">on</span> t3<span class="token punctuation">.</span>category_id <span class="token operator">=</span> t4<span class="token punctuation">.</span>category_id<span class="token punctuation">;</span>

<span class="token comment">-- 根据用户登录明细表（user_login），求出平台同时在线最多的人数</span>
<span class="token keyword">select</span>
  <span class="token function">max</span><span class="token punctuation">(</span>sum_l_time<span class="token punctuation">)</span>
<span class="token keyword">from</span>
  <span class="token punctuation">(</span>
    <span class="token keyword">select</span>
      <span class="token function">sum</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>l_time<span class="token punctuation">)</span> sum_l_time
    <span class="token keyword">from</span>
      <span class="token punctuation">(</span>
        <span class="token keyword">select</span>
          login_ts l_time<span class="token punctuation">,</span>
          <span class="token number">1</span> flag
        <span class="token keyword">from</span>
          user_login
        <span class="token keyword">union</span>
        <span class="token keyword">select</span>
          logout_ts l_time<span class="token punctuation">,</span>
          <span class="token operator">-</span><span class="token number">1</span> flag
        <span class="token keyword">from</span>
          user_login
    <span class="token punctuation">)</span>t1 
<span class="token punctuation">)</span>t2<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_3472"></a>分区表</h3> 
<h4><a id="_3474"></a>模拟数据</h4> 
<blockquote> 
 <p>身份证前六位</p> 
</blockquote> 
<blockquote> 
 <p>region_code.txt</p> 
</blockquote> 
<pre><code class="prism language-json"><span class="token number">110101</span><span class="token punctuation">,</span><span class="token number">110102</span><span class="token punctuation">,</span><span class="token number">110103</span><span class="token punctuation">,</span><span class="token number">110104</span><span class="token punctuation">,</span><span class="token number">110105</span><span class="token punctuation">,</span><span class="token number">110106</span><span class="token punctuation">,</span><span class="token number">110107</span><span class="token punctuation">,</span><span class="token number">110108</span><span class="token punctuation">,</span><span class="token number">110109</span><span class="token punctuation">,</span><span class="token number">110111</span><span class="token punctuation">,</span><span class="token number">110112</span><span class="token punctuation">,</span><span class="token number">110113</span><span class="token punctuation">,</span><span class="token number">110114</span><span class="token punctuation">,</span><span class="token number">110224</span><span class="token punctuation">,</span><span class="token number">110226</span><span class="token punctuation">,</span><span class="token number">110227</span><span class="token punctuation">,</span><span class="token number">110228</span><span class="token punctuation">,</span><span class="token number">110229</span><span class="token punctuation">,</span><span class="token number">120101</span><span class="token punctuation">,</span><span class="token number">120102</span><span class="token punctuation">,</span><span class="token number">120103</span><span class="token punctuation">,</span><span class="token number">120104</span><span class="token punctuation">,</span><span class="token number">120105</span><span class="token punctuation">,</span><span class="token number">120106</span><span class="token punctuation">,</span><span class="token number">120107</span><span class="token punctuation">,</span><span class="token number">120108</span><span class="token punctuation">,</span><span class="token number">120109</span><span class="token punctuation">,</span><span class="token number">120110</span><span class="token punctuation">,</span><span class="token number">120111</span><span class="token punctuation">,</span><span class="token number">120112</span><span class="token punctuation">,</span><span class="token number">120113</span><span class="token punctuation">,</span><span class="token number">120114</span><span class="token punctuation">,</span><span class="token number">120221</span><span class="token punctuation">,</span><span class="token number">120223</span><span class="token punctuation">,</span><span class="token number">120224</span><span class="token punctuation">,</span><span class="token number">120225</span><span class="token punctuation">,</span><span class="token number">130101</span><span class="token punctuation">,</span><span class="token number">130102</span><span class="token punctuation">,</span><span class="token number">130103</span><span class="token punctuation">,</span><span class="token number">130104</span><span class="token punctuation">,</span><span class="token number">130105</span><span class="token punctuation">,</span><span class="token number">130106</span><span class="token punctuation">,</span><span class="token number">130107</span><span class="token punctuation">,</span><span class="token number">130121</span><span class="token punctuation">,</span><span class="token number">130123</span><span class="token punctuation">,</span><span class="token number">130124</span><span class="token punctuation">,</span><span class="token number">130125</span><span class="token punctuation">,</span><span class="token number">130126</span><span class="token punctuation">,</span><span class="token number">130127</span><span class="token punctuation">,</span><span class="token number">130128</span><span class="token punctuation">,</span><span class="token number">130129</span><span class="token punctuation">,</span><span class="token number">130130</span><span class="token punctuation">,</span><span class="token number">130131</span><span class="token punctuation">,</span><span class="token number">130132</span><span class="token punctuation">,</span><span class="token number">130133</span><span class="token punctuation">,</span><span class="token number">130181</span><span class="token punctuation">,</span><span class="token number">130182</span><span class="token punctuation">,</span><span class="token number">130183</span><span class="token punctuation">,</span><span class="token number">130184</span><span class="token punctuation">,</span><span class="token number">130185</span><span class="token punctuation">,</span><span class="token number">130201</span><span class="token punctuation">,</span><span class="token number">130202</span><span class="token punctuation">,</span><span class="token number">130203</span><span class="token punctuation">,</span><span class="token number">130204</span><span class="token punctuation">,</span><span class="token number">130205</span><span class="token punctuation">,</span><span class="token number">130206</span><span class="token punctuation">,</span><span class="token number">130221</span><span class="token punctuation">,</span><span class="token number">130223</span><span class="token punctuation">,</span><span class="token number">130224</span><span class="token punctuation">,</span><span class="token number">130225</span><span class="token punctuation">,</span><span class="token number">130227</span><span class="token punctuation">,</span><span class="token number">130229</span><span class="token punctuation">,</span><span class="token number">130230</span><span class="token punctuation">,</span><span class="token number">130281</span><span class="token punctuation">,</span><span class="token number">130282</span><span class="token punctuation">,</span><span class="token number">130283</span><span class="token punctuation">,</span><span class="token number">130301</span><span class="token punctuation">,</span><span class="token number">130302</span><span class="token punctuation">,</span><span class="token number">130303</span><span class="token punctuation">,</span><span class="token number">130304</span><span class="token punctuation">,</span><span class="token number">130321</span><span class="token punctuation">,</span><span class="token number">130322</span><span class="token punctuation">,</span><span class="token number">130323</span><span class="token punctuation">,</span><span class="token number">130324</span><span class="token punctuation">,</span><span class="token number">130401</span><span class="token punctuation">,</span><span class="token number">130402</span><span class="token punctuation">,</span><span class="token number">130403</span><span class="token punctuation">,</span><span class="token number">130404</span><span class="token punctuation">,</span><span class="token number">130406</span><span class="token punctuation">,</span><span class="token number">130421</span><span class="token punctuation">,</span><span class="token number">130423</span><span class="token punctuation">,</span><span class="token number">130424</span><span class="token punctuation">,</span><span class="token number">130425</span><span class="token punctuation">,</span><span class="token number">130426</span><span class="token punctuation">,</span><span class="token number">130427</span><span class="token punctuation">,</span><span class="token number">130428</span><span class="token punctuation">,</span><span class="token number">130429</span><span class="token punctuation">,</span><span class="token number">130430</span><span class="token punctuation">,</span><span class="token number">130431</span><span class="token punctuation">,</span><span class="token number">130432</span><span class="token punctuation">,</span><span class="token number">130433</span><span class="token punctuation">,</span><span class="token number">130434</span><span class="token punctuation">,</span><span class="token number">130435</span><span class="token punctuation">,</span><span class="token number">130481</span><span class="token punctuation">,</span><span class="token number">130501</span><span class="token punctuation">,</span><span class="token number">130502</span><span class="token punctuation">,</span><span class="token number">130503</span><span class="token punctuation">,</span><span class="token number">130521</span><span class="token punctuation">,</span><span class="token number">130522</span><span class="token punctuation">,</span><span class="token number">130523</span><span class="token punctuation">,</span><span class="token number">130524</span><span class="token punctuation">,</span><span class="token number">130525</span><span class="token punctuation">,</span><span class="token number">130526</span><span class="token punctuation">,</span><span class="token number">130527</span><span class="token punctuation">,</span><span class="token number">130528</span><span class="token punctuation">,</span><span class="token number">130529</span><span class="token punctuation">,</span><span class="token number">130530</span><span class="token punctuation">,</span><span class="token number">130531</span><span class="token punctuation">,</span><span class="token number">130532</span><span class="token punctuation">,</span><span class="token number">130533</span><span class="token punctuation">,</span><span class="token number">130534</span><span class="token punctuation">,</span><span class="token number">130535</span><span class="token punctuation">,</span><span class="token number">130581</span><span class="token punctuation">,</span><span class="token number">130582</span><span class="token punctuation">,</span><span class="token number">130601</span><span class="token punctuation">,</span><span class="token number">130602</span><span class="token punctuation">,</span><span class="token number">130603</span><span class="token punctuation">,</span><span class="token number">130604</span><span class="token punctuation">,</span><span class="token number">130621</span><span class="token punctuation">,</span><span class="token number">130622</span><span class="token punctuation">,</span><span class="token number">130623</span><span class="token punctuation">,</span><span class="token number">130624</span><span class="token punctuation">,</span><span class="token number">130625</span><span class="token punctuation">,</span><span class="token number">130626</span><span class="token punctuation">,</span><span class="token number">130627</span><span class="token punctuation">,</span><span class="token number">130628</span><span class="token punctuation">,</span><span class="token number">130629</span><span class="token punctuation">,</span><span class="token number">130630</span><span class="token punctuation">,</span><span class="token number">130631</span><span class="token punctuation">,</span><span class="token number">130632</span><span class="token punctuation">,</span><span class="token number">130633</span><span class="token punctuation">,</span><span class="token number">130634</span><span class="token punctuation">,</span><span class="token number">130635</span><span class="token punctuation">,</span><span class="token number">130636</span><span class="token punctuation">,</span><span class="token number">130637</span><span class="token punctuation">,</span><span class="token number">130638</span><span class="token punctuation">,</span><span class="token number">130681</span><span class="token punctuation">,</span><span class="token number">130682</span><span class="token punctuation">,</span><span class="token number">130683</span><span class="token punctuation">,</span><span class="token number">130684</span><span class="token punctuation">,</span><span class="token number">130701</span><span class="token punctuation">,</span><span class="token number">130702</span><span class="token punctuation">,</span><span class="token number">130703</span><span class="token punctuation">,</span><span class="token number">130705</span><span class="token punctuation">,</span><span class="token number">130706</span><span class="token punctuation">,</span><span class="token number">130721</span><span class="token punctuation">,</span><span class="token number">130722</span><span class="token punctuation">,</span><span class="token number">130723</span><span class="token punctuation">,</span><span class="token number">130724</span><span class="token punctuation">,</span><span class="token number">130725</span><span class="token punctuation">,</span><span class="token number">130726</span><span class="token punctuation">,</span><span class="token number">130727</span><span class="token punctuation">,</span><span class="token number">130728</span><span class="token punctuation">,</span><span class="token number">130729</span><span class="token punctuation">,</span><span class="token number">130730</span><span class="token punctuation">,</span><span class="token number">130731</span><span class="token punctuation">,</span><span class="token number">130732</span><span class="token punctuation">,</span><span class="token number">130733</span><span class="token punctuation">,</span><span class="token number">130801</span><span class="token punctuation">,</span><span class="token number">130802</span><span class="token punctuation">,</span><span class="token number">130803</span><span class="token punctuation">,</span><span class="token number">130804</span><span class="token punctuation">,</span><span class="token number">130821</span><span class="token punctuation">,</span><span class="token number">130822</span><span class="token punctuation">,</span><span class="token number">130823</span><span class="token punctuation">,</span><span class="token number">130824</span><span class="token punctuation">,</span><span class="token number">130825</span><span class="token punctuation">,</span><span class="token number">130826</span><span class="token punctuation">,</span><span class="token number">130827</span><span class="token punctuation">,</span><span class="token number">130828</span><span class="token punctuation">,</span><span class="token number">130901</span><span class="token punctuation">,</span><span class="token number">130902</span><span class="token punctuation">,</span><span class="token number">130903</span><span class="token punctuation">,</span><span class="token number">130921</span><span class="token punctuation">,</span><span class="token number">130922</span><span class="token punctuation">,</span><span class="token number">130923</span><span class="token punctuation">,</span><span class="token number">130924</span><span class="token punctuation">,</span><span class="token number">130925</span><span class="token punctuation">,</span><span class="token number">130926</span><span class="token punctuation">,</span><span class="token number">130927</span><span class="token punctuation">,</span><span class="token number">130928</span><span class="token punctuation">,</span><span class="token number">130929</span><span class="token punctuation">,</span><span class="token number">130930</span><span class="token punctuation">,</span><span class="token number">130981</span><span class="token punctuation">,</span><span class="token number">130982</span><span class="token punctuation">,</span><span class="token number">130983</span><span class="token punctuation">,</span><span class="token number">130984</span><span class="token punctuation">,</span><span class="token number">131001</span><span class="token punctuation">,</span><span class="token number">131002</span><span class="token punctuation">,</span><span class="token number">131003</span><span class="token punctuation">,</span><span class="token number">131022</span><span class="token punctuation">,</span><span class="token number">131023</span><span class="token punctuation">,</span><span class="token number">131024</span><span class="token punctuation">,</span><span class="token number">131025</span><span class="token punctuation">,</span><span class="token number">131026</span><span class="token punctuation">,</span><span class="token number">131028</span><span class="token punctuation">,</span><span class="token number">131081</span><span class="token punctuation">,</span><span class="token number">131082</span><span class="token punctuation">,</span><span class="token number">131101</span><span class="token punctuation">,</span><span class="token number">131102</span><span class="token punctuation">,</span><span class="token number">131121</span><span class="token punctuation">,</span><span class="token number">131122</span><span class="token punctuation">,</span><span class="token number">131123</span><span class="token punctuation">,</span><span class="token number">131124</span><span class="token punctuation">,</span><span class="token number">131125</span><span class="token punctuation">,</span><span class="token number">131126</span><span class="token punctuation">,</span><span class="token number">131127</span><span class="token punctuation">,</span><span class="token number">131128</span><span class="token punctuation">,</span><span class="token number">131181</span><span class="token punctuation">,</span><span class="token number">131182</span><span class="token punctuation">,</span><span class="token number">140101</span><span class="token punctuation">,</span><span class="token number">140105</span><span class="token punctuation">,</span><span class="token number">140106</span><span class="token punctuation">,</span><span class="token number">140107</span><span class="token punctuation">,</span><span class="token number">140108</span><span class="token punctuation">,</span><span class="token number">140109</span><span class="token punctuation">,</span><span class="token number">140110</span><span class="token punctuation">,</span><span class="token number">140121</span><span class="token punctuation">,</span><span class="token number">140122</span><span class="token punctuation">,</span><span class="token number">140123</span><span class="token punctuation">,</span><span class="token number">140181</span><span class="token punctuation">,</span><span class="token number">140201</span><span class="token punctuation">,</span><span class="token number">140202</span><span class="token punctuation">,</span><span class="token number">140203</span><span class="token punctuation">,</span><span class="token number">140211</span><span class="token punctuation">,</span><span class="token number">140212</span><span class="token punctuation">,</span><span class="token number">140221</span><span class="token punctuation">,</span><span class="token number">140222</span><span class="token punctuation">,</span><span class="token number">140223</span><span class="token punctuation">,</span><span class="token number">140224</span><span class="token punctuation">,</span><span class="token number">140225</span><span class="token punctuation">,</span><span class="token number">140226</span><span class="token punctuation">,</span><span class="token number">140227</span><span class="token punctuation">,</span><span class="token number">140301</span><span class="token punctuation">,</span><span class="token number">140302</span><span class="token punctuation">,</span><span class="token number">140303</span><span class="token punctuation">,</span><span class="token number">140311</span><span class="token punctuation">,</span><span class="token number">140321</span><span class="token punctuation">,</span><span class="token number">140322</span><span class="token punctuation">,</span><span class="token number">140401</span><span class="token punctuation">,</span><span class="token number">140402</span><span class="token punctuation">,</span><span class="token number">140411</span><span class="token punctuation">,</span><span class="token number">140421</span><span class="token punctuation">,</span><span class="token number">140423</span><span class="token punctuation">,</span><span class="token number">140424</span><span class="token punctuation">,</span><span class="token number">140425</span><span class="token punctuation">,</span><span class="token number">140426</span><span class="token punctuation">,</span><span class="token number">140427</span><span class="token punctuation">,</span><span class="token number">140428</span><span class="token punctuation">,</span><span class="token number">140429</span><span class="token punctuation">,</span><span class="token number">140430</span><span class="token punctuation">,</span><span class="token number">140431</span><span class="token punctuation">,</span><span class="token number">140481</span><span class="token punctuation">,</span><span class="token number">140501</span><span class="token punctuation">,</span><span class="token number">140502</span><span class="token punctuation">,</span><span class="token number">140521</span><span class="token punctuation">,</span><span class="token number">140522</span><span class="token punctuation">,</span><span class="token number">140524</span><span class="token punctuation">,</span><span class="token number">140525</span><span class="token punctuation">,</span><span class="token number">140581</span><span class="token punctuation">,</span><span class="token number">140601</span><span class="token punctuation">,</span><span class="token number">140602</span><span class="token punctuation">,</span><span class="token number">140603</span><span class="token punctuation">,</span><span class="token number">140621</span><span class="token punctuation">,</span><span class="token number">140622</span><span class="token punctuation">,</span><span class="token number">140623</span><span class="token punctuation">,</span><span class="token number">140624</span><span class="token punctuation">,</span><span class="token number">140701</span><span class="token punctuation">,</span><span class="token number">140702</span><span class="token punctuation">,</span><span class="token number">140721</span><span class="token punctuation">,</span><span class="token number">140722</span><span class="token punctuation">,</span><span class="token number">140723</span><span class="token punctuation">,</span><span class="token number">140724</span><span class="token punctuation">,</span><span class="token number">140725</span><span class="token punctuation">,</span><span class="token number">140726</span><span class="token punctuation">,</span><span class="token number">140727</span><span class="token punctuation">,</span><span class="token number">140728</span><span class="token punctuation">,</span><span class="token number">140729</span><span class="token punctuation">,</span><span class="token number">140781</span><span class="token punctuation">,</span><span class="token number">140801</span><span class="token punctuation">,</span><span class="token number">140802</span><span class="token punctuation">,</span><span class="token number">140821</span><span class="token punctuation">,</span><span class="token number">140822</span><span class="token punctuation">,</span><span class="token number">140823</span><span class="token punctuation">,</span><span class="token number">140824</span><span class="token punctuation">,</span><span class="token number">140825</span><span class="token punctuation">,</span><span class="token number">140826</span><span class="token punctuation">,</span><span class="token number">140827</span><span class="token punctuation">,</span><span class="token number">140828</span><span class="token punctuation">,</span><span class="token number">140829</span><span class="token punctuation">,</span><span class="token number">140830</span><span class="token punctuation">,</span><span class="token number">140881</span><span class="token punctuation">,</span><span class="token number">140882</span><span class="token punctuation">,</span><span class="token number">140901</span><span class="token punctuation">,</span><span class="token number">140902</span><span class="token punctuation">,</span><span class="token number">140921</span><span class="token punctuation">,</span><span class="token number">140922</span><span class="token punctuation">,</span><span class="token number">140923</span><span class="token punctuation">,</span><span class="token number">140924</span><span class="token punctuation">,</span><span class="token number">140925</span><span class="token punctuation">,</span><span class="token number">140926</span><span class="token punctuation">,</span><span class="token number">140927</span><span class="token punctuation">,</span><span class="token number">140928</span><span class="token punctuation">,</span><span class="token number">140929</span><span class="token punctuation">,</span><span class="token number">140930</span><span class="token punctuation">,</span><span class="token number">140931</span><span class="token punctuation">,</span><span class="token number">140932</span><span class="token punctuation">,</span><span class="token number">140981</span><span class="token punctuation">,</span><span class="token number">141001</span><span class="token punctuation">,</span><span class="token number">141002</span><span class="token punctuation">,</span><span class="token number">141021</span><span class="token punctuation">,</span><span class="token number">141022</span><span class="token punctuation">,</span><span class="token number">141023</span><span class="token punctuation">,</span><span class="token number">141024</span><span class="token punctuation">,</span><span class="token number">141025</span><span class="token punctuation">,</span><span class="token number">141026</span><span class="token punctuation">,</span><span class="token number">141027</span><span class="token punctuation">,</span><span class="token number">141028</span><span class="token punctuation">,</span><span class="token number">141029</span><span class="token punctuation">,</span><span class="token number">141030</span><span class="token punctuation">,</span><span class="token number">141031</span><span class="token punctuation">,</span><span class="token number">141032</span><span class="token punctuation">,</span><span class="token number">141033</span><span class="token punctuation">,</span><span class="token number">141034</span><span class="token punctuation">,</span><span class="token number">141081</span><span class="token punctuation">,</span><span class="token number">141082</span><span class="token punctuation">,</span><span class="token number">142301</span><span class="token punctuation">,</span><span class="token number">142302</span><span class="token punctuation">,</span><span class="token number">142303</span><span class="token punctuation">,</span><span class="token number">142322</span><span class="token punctuation">,</span><span class="token number">142323</span><span class="token punctuation">,</span><span class="token number">142325</span><span class="token punctuation">,</span><span class="token number">142326</span><span class="token punctuation">,</span><span class="token number">142327</span><span class="token punctuation">,</span><span class="token number">142328</span><span class="token punctuation">,</span><span class="token number">142329</span><span class="token punctuation">,</span><span class="token number">142330</span><span class="token punctuation">,</span><span class="token number">142332</span><span class="token punctuation">,</span><span class="token number">142333</span><span class="token punctuation">,</span><span class="token number">150101</span><span class="token punctuation">,</span><span class="token number">150102</span><span class="token punctuation">,</span><span class="token number">150103</span><span class="token punctuation">,</span><span class="token number">150104</span><span class="token punctuation">,</span><span class="token number">150105</span><span class="token punctuation">,</span><span class="token number">150121</span><span class="token punctuation">,</span><span class="token number">150122</span><span class="token punctuation">,</span><span class="token number">150123</span><span class="token punctuation">,</span><span class="token number">150124</span><span class="token punctuation">,</span><span class="token number">150125</span><span class="token punctuation">,</span><span class="token number">150201</span><span class="token punctuation">,</span><span class="token number">150202</span><span class="token punctuation">,</span><span class="token number">150203</span><span class="token punctuation">,</span><span class="token number">150204</span><span class="token punctuation">,</span><span class="token number">150205</span><span class="token punctuation">,</span><span class="token number">150206</span><span class="token punctuation">,</span><span class="token number">150207</span><span class="token punctuation">,</span><span class="token number">150221</span><span class="token punctuation">,</span><span class="token number">150222</span><span class="token punctuation">,</span><span class="token number">150223</span><span class="token punctuation">,</span><span class="token number">150301</span><span class="token punctuation">,</span><span class="token number">150302</span><span class="token punctuation">,</span><span class="token number">150303</span><span class="token punctuation">,</span><span class="token number">150304</span><span class="token punctuation">,</span><span class="token number">150401</span><span class="token punctuation">,</span><span class="token number">150402</span><span class="token punctuation">,</span><span class="token number">150403</span><span class="token punctuation">,</span><span class="token number">150404</span><span class="token punctuation">,</span><span class="token number">150421</span><span class="token punctuation">,</span><span class="token number">150422</span><span class="token punctuation">,</span><span class="token number">150423</span><span class="token punctuation">,</span><span class="token number">150424</span><span class="token punctuation">,</span><span class="token number">150425</span><span class="token punctuation">,</span><span class="token number">150426</span><span class="token punctuation">,</span><span class="token number">150428</span><span class="token punctuation">,</span><span class="token number">150429</span><span class="token punctuation">,</span><span class="token number">150430</span><span class="token punctuation">,</span><span class="token number">150501</span><span class="token punctuation">,</span><span class="token number">150502</span><span class="token punctuation">,</span><span class="token number">150521</span><span class="token punctuation">,</span><span class="token number">150522</span><span class="token punctuation">,</span><span class="token number">150523</span><span class="token punctuation">,</span><span class="token number">150524</span><span class="token punctuation">,</span><span class="token number">150525</span><span class="token punctuation">,</span><span class="token number">150526</span><span class="token punctuation">,</span><span class="token number">150581</span><span class="token punctuation">,</span><span class="token number">152101</span><span class="token punctuation">,</span><span class="token number">152102</span><span class="token punctuation">,</span><span class="token number">152103</span><span class="token punctuation">,</span><span class="token number">152104</span><span class="token punctuation">,</span><span class="token number">152105</span><span class="token punctuation">,</span><span class="token number">152106</span><span class="token punctuation">,</span><span class="token number">152122</span><span class="token punctuation">,</span><span class="token number">152123</span><span class="token punctuation">,</span><span class="token number">152127</span><span class="token punctuation">,</span><span class="token number">152128</span><span class="token punctuation">,</span><span class="token number">152129</span><span class="token punctuation">,</span><span class="token number">152130</span><span class="token punctuation">,</span><span class="token number">152131</span><span class="token punctuation">,</span><span class="token number">152201</span><span class="token punctuation">,</span><span class="token number">152202</span><span class="token punctuation">,</span><span class="token number">152221</span><span class="token punctuation">,</span><span class="token number">152222</span><span class="token punctuation">,</span><span class="token number">152223</span><span class="token punctuation">,</span><span class="token number">152224</span><span class="token punctuation">,</span><span class="token number">152501</span><span class="token punctuation">,</span><span class="token number">152502</span><span class="token punctuation">,</span><span class="token number">152522</span><span class="token punctuation">,</span><span class="token number">152523</span><span class="token punctuation">,</span><span class="token number">152524</span><span class="token punctuation">,</span><span class="token number">152525</span><span class="token punctuation">,</span><span class="token number">152526</span><span class="token punctuation">,</span><span class="token number">152527</span><span class="token punctuation">,</span><span class="token number">152528</span><span class="token punctuation">,</span><span class="token number">152529</span><span class="token punctuation">,</span><span class="token number">152530</span><span class="token punctuation">,</span><span class="token number">152531</span><span class="token punctuation">,</span><span class="token number">152601</span><span class="token punctuation">,</span><span class="token number">152602</span><span class="token punctuation">,</span><span class="token number">152624</span><span class="token punctuation">,</span><span class="token number">152625</span><span class="token punctuation">,</span><span class="token number">152626</span><span class="token punctuation">,</span><span class="token number">152627</span><span class="token punctuation">,</span><span class="token number">152629</span><span class="token punctuation">,</span><span class="token number">152630</span><span class="token punctuation">,</span><span class="token number">152631</span><span class="token punctuation">,</span><span class="token number">152632</span><span class="token punctuation">,</span><span class="token number">152634</span><span class="token punctuation">,</span><span class="token number">152701</span><span class="token punctuation">,</span><span class="token number">152722</span><span class="token punctuation">,</span><span class="token number">152723</span><span class="token punctuation">,</span><span class="token number">152724</span><span class="token punctuation">,</span><span class="token number">152725</span><span class="token punctuation">,</span><span class="token number">152726</span><span class="token punctuation">,</span><span class="token number">152727</span><span class="token punctuation">,</span><span class="token number">152728</span><span class="token punctuation">,</span><span class="token number">152801</span><span class="token punctuation">,</span><span class="token number">152822</span><span class="token punctuation">,</span><span class="token number">152823</span><span class="token punctuation">,</span><span class="token number">152824</span><span class="token punctuation">,</span><span class="token number">152825</span><span class="token punctuation">,</span><span class="token number">152826</span><span class="token punctuation">,</span><span class="token number">152827</span><span class="token punctuation">,</span><span class="token number">152921</span><span class="token punctuation">,</span><span class="token number">152922</span><span class="token punctuation">,</span><span class="token number">152923</span><span class="token punctuation">,</span><span class="token number">210101</span><span class="token punctuation">,</span><span class="token number">210102</span><span class="token punctuation">,</span><span class="token number">210103</span><span class="token punctuation">,</span><span class="token number">210104</span><span class="token punctuation">,</span><span class="token number">210105</span><span class="token punctuation">,</span><span class="token number">210106</span><span class="token punctuation">,</span><span class="token number">210111</span><span class="token punctuation">,</span><span class="token number">210112</span><span class="token punctuation">,</span><span class="token number">210113</span><span class="token punctuation">,</span><span class="token number">210114</span><span class="token punctuation">,</span><span class="token number">210122</span><span class="token punctuation">,</span><span class="token number">210123</span><span class="token punctuation">,</span><span class="token number">210124</span><span class="token punctuation">,</span><span class="token number">210181</span><span class="token punctuation">,</span><span class="token number">210201</span><span class="token punctuation">,</span><span class="token number">210202</span><span class="token punctuation">,</span><span class="token number">210203</span><span class="token punctuation">,</span><span class="token number">210204</span><span class="token punctuation">,</span><span class="token number">210211</span><span class="token punctuation">,</span><span class="token number">210212</span><span class="token punctuation">,</span><span class="token number">210213</span><span class="token punctuation">,</span><span class="token number">210224</span><span class="token punctuation">,</span><span class="token number">210281</span><span class="token punctuation">,</span><span class="token number">210282</span><span class="token punctuation">,</span><span class="token number">210283</span><span class="token punctuation">,</span><span class="token number">210301</span><span class="token punctuation">,</span><span class="token number">210302</span><span class="token punctuation">,</span><span class="token number">210303</span><span class="token punctuation">,</span><span class="token number">210304</span><span class="token punctuation">,</span><span class="token number">210311</span><span class="token punctuation">,</span><span class="token number">210321</span><span class="token punctuation">,</span><span class="token number">210323</span><span class="token punctuation">,</span><span class="token number">210381</span><span class="token punctuation">,</span><span class="token number">210401</span><span class="token punctuation">,</span><span class="token number">210402</span><span class="token punctuation">,</span><span class="token number">210403</span><span class="token punctuation">,</span><span class="token number">210404</span><span class="token punctuation">,</span><span class="token number">210411</span><span class="token punctuation">,</span><span class="token number">210421</span><span class="token punctuation">,</span><span class="token number">210422</span><span class="token punctuation">,</span><span class="token number">210423</span><span class="token punctuation">,</span><span class="token number">210501</span><span class="token punctuation">,</span><span class="token number">210502</span><span class="token punctuation">,</span><span class="token number">210503</span><span class="token punctuation">,</span><span class="token number">210504</span><span class="token punctuation">,</span><span class="token number">210505</span><span class="token punctuation">,</span><span class="token number">210521</span><span class="token punctuation">,</span><span class="token number">210522</span><span class="token punctuation">,</span><span class="token number">210601</span><span class="token punctuation">,</span><span class="token number">210602</span><span class="token punctuation">,</span><span class="token number">210603</span><span class="token punctuation">,</span><span class="token number">210604</span><span class="token punctuation">,</span><span class="token number">210624</span><span class="token punctuation">,</span><span class="token number">210681</span><span class="token punctuation">,</span><span class="token number">210682</span><span class="token punctuation">,</span><span class="token number">210701</span><span class="token punctuation">,</span><span class="token number">210702</span><span class="token punctuation">,</span><span class="token number">210703</span><span class="token punctuation">,</span><span class="token number">210711</span><span class="token punctuation">,</span><span class="token number">210726</span><span class="token punctuation">,</span><span class="token number">210727</span><span class="token punctuation">,</span><span class="token number">210781</span><span class="token punctuation">,</span><span class="token number">210782</span><span class="token punctuation">,</span><span class="token number">210801</span><span class="token punctuation">,</span><span class="token number">210802</span><span class="token punctuation">,</span><span class="token number">210803</span><span class="token punctuation">,</span><span class="token number">210804</span><span class="token punctuation">,</span><span class="token number">210811</span><span class="token punctuation">,</span><span class="token number">210881</span><span class="token punctuation">,</span><span class="token number">210882</span><span class="token punctuation">,</span><span class="token number">210901</span><span class="token punctuation">,</span><span class="token number">210902</span><span class="token punctuation">,</span><span class="token number">210903</span><span class="token punctuation">,</span><span class="token number">210904</span><span class="token punctuation">,</span><span class="token number">210905</span><span class="token punctuation">,</span><span class="token number">210911</span><span class="token punctuation">,</span><span class="token number">210921</span><span class="token punctuation">,</span><span class="token number">210922</span><span class="token punctuation">,</span><span class="token number">211001</span><span class="token punctuation">,</span><span class="token number">211002</span><span class="token punctuation">,</span><span class="token number">211003</span><span class="token punctuation">,</span><span class="token number">211004</span><span class="token punctuation">,</span><span class="token number">211005</span><span class="token punctuation">,</span><span class="token number">211011</span><span class="token punctuation">,</span><span class="token number">211021</span><span class="token punctuation">,</span><span class="token number">211081</span><span class="token punctuation">,</span><span class="token number">211101</span><span class="token punctuation">,</span><span class="token number">211102</span><span class="token punctuation">,</span><span class="token number">211103</span><span class="token punctuation">,</span><span class="token number">211121</span><span class="token punctuation">,</span><span class="token number">211122</span><span class="token punctuation">,</span><span class="token number">211201</span><span class="token punctuation">,</span><span class="token number">211202</span><span class="token punctuation">,</span><span class="token number">211204</span><span class="token punctuation">,</span><span class="token number">211221</span><span class="token punctuation">,</span><span class="token number">211223</span><span class="token punctuation">,</span><span class="token number">211224</span><span class="token punctuation">,</span><span class="token number">211281</span><span class="token punctuation">,</span><span class="token number">211282</span><span class="token punctuation">,</span><span class="token number">211301</span><span class="token punctuation">,</span><span class="token number">211302</span><span class="token punctuation">,</span><span class="token number">211303</span><span class="token punctuation">,</span><span class="token number">211321</span><span class="token punctuation">,</span><span class="token number">211322</span><span class="token punctuation">,</span><span class="token number">211324</span><span class="token punctuation">,</span><span class="token number">211381</span><span class="token punctuation">,</span><span class="token number">211382</span><span class="token punctuation">,</span><span class="token number">211401</span><span class="token punctuation">,</span><span class="token number">211402</span><span class="token punctuation">,</span><span class="token number">211403</span><span class="token punctuation">,</span><span class="token number">211404</span><span class="token punctuation">,</span><span class="token number">211421</span><span class="token punctuation">,</span><span class="token number">211422</span><span class="token punctuation">,</span><span class="token number">211481</span><span class="token punctuation">,</span><span class="token number">220101</span><span class="token punctuation">,</span><span class="token number">220102</span><span class="token punctuation">,</span><span class="token number">220103</span><span class="token punctuation">,</span><span class="token number">220104</span><span class="token punctuation">,</span><span class="token number">220105</span><span class="token punctuation">,</span><span class="token number">220106</span><span class="token punctuation">,</span><span class="token number">220112</span><span class="token punctuation">,</span><span class="token number">220122</span><span class="token punctuation">,</span><span class="token number">220181</span><span class="token punctuation">,</span><span class="token number">220182</span><span class="token punctuation">,</span><span class="token number">220183</span><span class="token punctuation">,</span><span class="token number">220201</span><span class="token punctuation">,</span><span class="token number">220202</span><span class="token punctuation">,</span><span class="token number">220203</span><span class="token punctuation">,</span><span class="token number">220204</span><span class="token punctuation">,</span><span class="token number">220211</span><span class="token punctuation">,</span><span class="token number">220221</span><span class="token punctuation">,</span><span class="token number">220281</span><span class="token punctuation">,</span><span class="token number">220282</span><span class="token punctuation">,</span><span class="token number">220283</span><span class="token punctuation">,</span><span class="token number">220284</span><span class="token punctuation">,</span><span class="token number">220301</span><span class="token punctuation">,</span><span class="token number">220302</span><span class="token punctuation">,</span><span class="token number">220303</span><span class="token punctuation">,</span><span class="token number">220322</span><span class="token punctuation">,</span><span class="token number">220323</span><span class="token punctuation">,</span><span class="token number">220381</span><span class="token punctuation">,</span><span class="token number">220382</span><span class="token punctuation">,</span><span class="token number">220401</span><span class="token punctuation">,</span><span class="token number">220402</span><span class="token punctuation">,</span><span class="token number">220403</span><span class="token punctuation">,</span><span class="token number">220421</span><span class="token punctuation">,</span><span class="token number">220422</span><span class="token punctuation">,</span><span class="token number">220501</span><span class="token punctuation">,</span><span class="token number">220502</span><span class="token punctuation">,</span><span class="token number">220503</span><span class="token punctuation">,</span><span class="token number">220521</span><span class="token punctuation">,</span><span class="token number">220523</span><span class="token punctuation">,</span><span class="token number">220524</span><span class="token punctuation">,</span><span class="token number">220581</span><span class="token punctuation">,</span><span class="token number">220582</span><span class="token punctuation">,</span><span class="token number">220601</span><span class="token punctuation">,</span><span class="token number">220602</span><span class="token punctuation">,</span><span class="token number">220621</span><span class="token punctuation">,</span><span class="token number">220622</span><span class="token punctuation">,</span><span class="token number">220623</span><span class="token punctuation">,</span><span class="token number">220625</span><span class="token punctuation">,</span><span class="token number">220681</span><span class="token punctuation">,</span><span class="token number">220701</span><span class="token punctuation">,</span><span class="token number">220702</span><span class="token punctuation">,</span><span class="token number">220721</span><span class="token punctuation">,</span><span class="token number">220722</span><span class="token punctuation">,</span><span class="token number">220723</span><span class="token punctuation">,</span><span class="token number">220724</span><span class="token punctuation">,</span><span class="token number">220801</span><span class="token punctuation">,</span><span class="token number">220802</span><span class="token punctuation">,</span><span class="token number">220821</span><span class="token punctuation">,</span><span class="token number">220822</span><span class="token punctuation">,</span><span class="token number">220881</span><span class="token punctuation">,</span><span class="token number">220882</span><span class="token punctuation">,</span><span class="token number">222401</span><span class="token punctuation">,</span><span class="token number">222402</span><span class="token punctuation">,</span><span class="token number">222403</span><span class="token punctuation">,</span><span class="token number">222404</span><span class="token punctuation">,</span><span class="token number">222405</span><span class="token punctuation">,</span><span class="token number">222406</span><span class="token punctuation">,</span><span class="token number">222424</span><span class="token punctuation">,</span><span class="token number">222426</span><span class="token punctuation">,</span><span class="token number">230101</span><span class="token punctuation">,</span><span class="token number">230102</span><span class="token punctuation">,</span><span class="token number">230103</span><span class="token punctuation">,</span><span class="token number">230104</span><span class="token punctuation">,</span><span class="token number">230105</span><span class="token punctuation">,</span><span class="token number">230106</span><span class="token punctuation">,</span><span class="token number">230107</span><span class="token punctuation">,</span><span class="token number">230108</span><span class="token punctuation">,</span><span class="token number">230121</span><span class="token punctuation">,</span><span class="token number">230123</span><span class="token punctuation">,</span><span class="token number">230124</span><span class="token punctuation">,</span><span class="token number">230125</span><span class="token punctuation">,</span><span class="token number">230126</span><span class="token punctuation">,</span><span class="token number">230127</span><span class="token punctuation">,</span><span class="token number">230128</span><span class="token punctuation">,</span><span class="token number">230129</span><span class="token punctuation">,</span><span class="token number">230181</span><span class="token punctuation">,</span><span class="token number">230182</span><span class="token punctuation">,</span><span class="token number">230183</span><span class="token punctuation">,</span><span class="token number">230184</span><span class="token punctuation">,</span><span class="token number">230201</span><span class="token punctuation">,</span><span class="token number">230202</span><span class="token punctuation">,</span><span class="token number">230203</span><span class="token punctuation">,</span><span class="token number">230204</span><span class="token punctuation">,</span><span class="token number">230205</span><span class="token punctuation">,</span><span class="token number">230206</span><span class="token punctuation">,</span><span class="token number">230207</span><span class="token punctuation">,</span><span class="token number">230208</span><span class="token punctuation">,</span><span class="token number">230221</span><span class="token punctuation">,</span><span class="token number">230223</span><span class="token punctuation">,</span><span class="token number">230224</span><span class="token punctuation">,</span><span class="token number">230225</span><span class="token punctuation">,</span><span class="token number">230227</span><span class="token punctuation">,</span><span class="token number">230229</span><span class="token punctuation">,</span><span class="token number">230230</span><span class="token punctuation">,</span><span class="token number">230231</span><span class="token punctuation">,</span><span class="token number">230281</span><span class="token punctuation">,</span><span class="token number">230301</span><span class="token punctuation">,</span><span class="token number">230302</span><span class="token punctuation">,</span><span class="token number">230303</span><span class="token punctuation">,</span><span class="token number">230304</span><span class="token punctuation">,</span><span class="token number">230305</span><span class="token punctuation">,</span><span class="token number">230306</span><span class="token punctuation">,</span><span class="token number">230307</span><span class="token punctuation">,</span><span class="token number">230321</span><span class="token punctuation">,</span><span class="token number">230381</span><span class="token punctuation">,</span><span class="token number">230382</span><span class="token punctuation">,</span><span class="token number">230401</span><span class="token punctuation">,</span><span class="token number">230402</span><span class="token punctuation">,</span><span class="token number">230403</span><span class="token punctuation">,</span><span class="token number">230404</span><span class="token punctuation">,</span><span class="token number">230405</span><span class="token punctuation">,</span><span class="token number">230406</span><span class="token punctuation">,</span><span class="token number">230407</span><span class="token punctuation">,</span><span class="token number">230421</span><span class="token punctuation">,</span><span class="token number">230422</span><span class="token punctuation">,</span><span class="token number">230501</span><span class="token punctuation">,</span><span class="token number">230502</span><span class="token punctuation">,</span><span class="token number">230503</span><span class="token punctuation">,</span><span class="token number">230505</span><span class="token punctuation">,</span><span class="token number">230506</span><span class="token punctuation">,</span><span class="token number">230521</span><span class="token punctuation">,</span><span class="token number">230522</span><span class="token punctuation">,</span><span class="token number">230523</span><span class="token punctuation">,</span><span class="token number">230524</span><span class="token punctuation">,</span><span class="token number">230601</span><span class="token punctuation">,</span><span class="token number">230602</span><span class="token punctuation">,</span><span class="token number">230603</span><span class="token punctuation">,</span><span class="token number">230604</span><span class="token punctuation">,</span><span class="token number">230605</span><span class="token punctuation">,</span><span class="token number">230606</span><span class="token punctuation">,</span><span class="token number">230621</span><span class="token punctuation">,</span><span class="token number">230622</span><span class="token punctuation">,</span><span class="token number">230623</span><span class="token punctuation">,</span><span class="token number">230624</span><span class="token punctuation">,</span><span class="token number">230701</span><span class="token punctuation">,</span><span class="token number">230702</span><span class="token punctuation">,</span><span class="token number">230703</span><span class="token punctuation">,</span><span class="token number">230704</span><span class="token punctuation">,</span><span class="token number">230705</span><span class="token punctuation">,</span><span class="token number">230706</span><span class="token punctuation">,</span><span class="token number">230707</span><span class="token punctuation">,</span><span class="token number">230708</span><span class="token punctuation">,</span><span class="token number">230709</span><span class="token punctuation">,</span><span class="token number">230710</span><span class="token punctuation">,</span><span class="token number">230711</span><span class="token punctuation">,</span><span class="token number">230712</span><span class="token punctuation">,</span><span class="token number">230713</span><span class="token punctuation">,</span><span class="token number">230714</span><span class="token punctuation">,</span><span class="token number">230715</span><span class="token punctuation">,</span><span class="token number">230716</span><span class="token punctuation">,</span><span class="token number">230722</span><span class="token punctuation">,</span><span class="token number">230781</span><span class="token punctuation">,</span><span class="token number">230801</span><span class="token punctuation">,</span><span class="token number">230802</span><span class="token punctuation">,</span><span class="token number">230803</span><span class="token punctuation">,</span><span class="token number">230804</span><span class="token punctuation">,</span><span class="token number">230805</span><span class="token punctuation">,</span><span class="token number">230811</span><span class="token punctuation">,</span><span class="token number">230822</span><span class="token punctuation">,</span><span class="token number">230826</span><span class="token punctuation">,</span><span class="token number">230828</span><span class="token punctuation">,</span><span class="token number">230833</span><span class="token punctuation">,</span><span class="token number">230881</span><span class="token punctuation">,</span><span class="token number">230882</span><span class="token punctuation">,</span><span class="token number">230901</span><span class="token punctuation">,</span><span class="token number">230902</span><span class="token punctuation">,</span><span class="token number">230903</span><span class="token punctuation">,</span><span class="token number">230904</span><span class="token punctuation">,</span><span class="token number">230921</span><span class="token punctuation">,</span><span class="token number">231001</span><span class="token punctuation">,</span><span class="token number">231002</span><span class="token punctuation">,</span><span class="token number">231003</span><span class="token punctuation">,</span><span class="token number">231004</span><span class="token punctuation">,</span><span class="token number">231005</span><span class="token punctuation">,</span><span class="token number">231024</span><span class="token punctuation">,</span><span class="token number">231025</span><span class="token punctuation">,</span><span class="token number">231081</span><span class="token punctuation">,</span><span class="token number">231083</span><span class="token punctuation">,</span><span class="token number">231084</span><span class="token punctuation">,</span><span class="token number">231085</span><span class="token punctuation">,</span><span class="token number">231101</span><span class="token punctuation">,</span><span class="token number">231102</span><span class="token punctuation">,</span><span class="token number">231121</span><span class="token punctuation">,</span><span class="token number">231123</span><span class="token punctuation">,</span><span class="token number">231124</span><span class="token punctuation">,</span><span class="token number">231181</span><span class="token punctuation">,</span><span class="token number">231182</span><span class="token punctuation">,</span><span class="token number">231201</span><span class="token punctuation">,</span><span class="token number">231202</span><span class="token punctuation">,</span><span class="token number">231221</span><span class="token punctuation">,</span><span class="token number">231222</span><span class="token punctuation">,</span><span class="token number">231223</span><span class="token punctuation">,</span><span class="token number">231224</span><span class="token punctuation">,</span><span class="token number">231225</span><span class="token punctuation">,</span><span class="token number">231226</span><span class="token punctuation">,</span><span class="token number">231281</span><span class="token punctuation">,</span><span class="token number">231282</span><span class="token punctuation">,</span><span class="token number">231283</span><span class="token punctuation">,</span><span class="token number">232721</span><span class="token punctuation">,</span><span class="token number">232722</span><span class="token punctuation">,</span><span class="token number">232723</span><span class="token punctuation">,</span><span class="token number">310101</span><span class="token punctuation">,</span><span class="token number">310103</span><span class="token punctuation">,</span><span class="token number">310104</span><span class="token punctuation">,</span><span class="token number">310105</span><span class="token punctuation">,</span><span class="token number">310106</span><span class="token punctuation">,</span><span class="token number">310107</span><span class="token punctuation">,</span><span class="token number">310108</span><span class="token punctuation">,</span><span class="token number">310109</span><span class="token punctuation">,</span><span class="token number">310110</span><span class="token punctuation">,</span><span class="token number">310112</span><span class="token punctuation">,</span><span class="token number">310113</span><span class="token punctuation">,</span><span class="token number">310114</span><span class="token punctuation">,</span><span class="token number">310115</span><span class="token punctuation">,</span><span class="token number">310116</span><span class="token punctuation">,</span><span class="token number">310117</span><span class="token punctuation">,</span><span class="token number">310118</span><span class="token punctuation">,</span><span class="token number">310225</span><span class="token punctuation">,</span><span class="token number">310226</span><span class="token punctuation">,</span><span class="token number">310230</span><span class="token punctuation">,</span><span class="token number">320101</span><span class="token punctuation">,</span><span class="token number">320102</span><span class="token punctuation">,</span><span class="token number">320103</span><span class="token punctuation">,</span><span class="token number">320104</span><span class="token punctuation">,</span><span class="token number">320105</span><span class="token punctuation">,</span><span class="token number">320106</span><span class="token punctuation">,</span><span class="token number">320107</span><span class="token punctuation">,</span><span class="token number">320111</span><span class="token punctuation">,</span><span class="token number">320112</span><span class="token punctuation">,</span><span class="token number">320113</span><span class="token punctuation">,</span><span class="token number">320114</span><span class="token punctuation">,</span><span class="token number">320115</span><span class="token punctuation">,</span><span class="token number">320122</span><span class="token punctuation">,</span><span class="token number">320123</span><span class="token punctuation">,</span><span class="token number">320124</span><span class="token punctuation">,</span><span class="token number">320125</span><span class="token punctuation">,</span><span class="token number">320201</span><span class="token punctuation">,</span><span class="token number">320202</span><span class="token punctuation">,</span><span class="token number">320203</span><span class="token punctuation">,</span><span class="token number">320204</span><span class="token punctuation">,</span><span class="token number">320205</span><span class="token punctuation">,</span><span class="token number">320206</span><span class="token punctuation">,</span><span class="token number">320211</span><span class="token punctuation">,</span><span class="token number">320281</span><span class="token punctuation">,</span><span class="token number">320282</span><span class="token punctuation">,</span><span class="token number">320301</span><span class="token punctuation">,</span><span class="token number">320302</span><span class="token punctuation">,</span><span class="token number">320303</span><span class="token punctuation">,</span><span class="token number">320304</span><span class="token punctuation">,</span><span class="token number">320305</span><span class="token punctuation">,</span><span class="token number">320311</span><span class="token punctuation">,</span><span class="token number">320321</span><span class="token punctuation">,</span><span class="token number">320322</span><span class="token punctuation">,</span><span class="token number">320323</span><span class="token punctuation">,</span><span class="token number">320324</span><span class="token punctuation">,</span><span class="token number">320381</span><span class="token punctuation">,</span><span class="token number">320382</span><span class="token punctuation">,</span><span class="token number">320401</span><span class="token punctuation">,</span><span class="token number">320402</span><span class="token punctuation">,</span><span class="token number">320404</span><span class="token punctuation">,</span><span class="token number">320405</span><span class="token punctuation">,</span><span class="token number">320411</span><span class="token punctuation">,</span><span class="token number">320481</span><span class="token punctuation">,</span><span class="token number">320482</span><span class="token punctuation">,</span><span class="token number">320483</span><span class="token punctuation">,</span><span class="token number">320501</span><span class="token punctuation">,</span><span class="token number">320502</span><span class="token punctuation">,</span><span class="token number">320503</span><span class="token punctuation">,</span><span class="token number">320504</span><span class="token punctuation">,</span><span class="token number">320505</span><span class="token punctuation">,</span><span class="token number">320506</span><span class="token punctuation">,</span><span class="token number">320507</span><span class="token punctuation">,</span><span class="token number">320581</span><span class="token punctuation">,</span><span class="token number">320582</span><span class="token punctuation">,</span><span class="token number">320583</span><span class="token punctuation">,</span><span class="token number">320584</span><span class="token punctuation">,</span><span class="token number">320585</span><span class="token punctuation">,</span><span class="token number">320601</span><span class="token punctuation">,</span><span class="token number">320602</span><span class="token punctuation">,</span><span class="token number">320611</span><span class="token punctuation">,</span><span class="token number">320621</span><span class="token punctuation">,</span><span class="token number">320623</span><span class="token punctuation">,</span><span class="token number">320681</span><span class="token punctuation">,</span><span class="token number">320682</span><span class="token punctuation">,</span><span class="token number">320683</span><span class="token punctuation">,</span><span class="token number">320684</span><span class="token punctuation">,</span><span class="token number">320701</span><span class="token punctuation">,</span><span class="token number">320703</span><span class="token punctuation">,</span><span class="token number">320704</span><span class="token punctuation">,</span><span class="token number">320705</span><span class="token punctuation">,</span><span class="token number">320706</span><span class="token punctuation">,</span><span class="token number">320721</span><span class="token punctuation">,</span><span class="token number">320722</span><span class="token punctuation">,</span><span class="token number">320723</span><span class="token punctuation">,</span><span class="token number">320724</span><span class="token punctuation">,</span><span class="token number">320801</span><span class="token punctuation">,</span><span class="token number">320802</span><span class="token punctuation">,</span><span class="token number">320803</span><span class="token punctuation">,</span><span class="token number">320804</span><span class="token punctuation">,</span><span class="token number">320811</span><span class="token punctuation">,</span><span class="token number">320826</span><span class="token punctuation">,</span><span class="token number">320829</span><span class="token punctuation">,</span><span class="token number">320830</span><span class="token punctuation">,</span><span class="token number">320831</span><span class="token punctuation">,</span><span class="token number">320901</span><span class="token punctuation">,</span><span class="token number">320902</span><span class="token punctuation">,</span><span class="token number">320921</span><span class="token punctuation">,</span><span class="token number">320922</span><span class="token punctuation">,</span><span class="token number">320923</span><span class="token punctuation">,</span><span class="token number">320924</span><span class="token punctuation">,</span><span class="token number">320925</span><span class="token punctuation">,</span><span class="token number">320928</span><span class="token punctuation">,</span><span class="token number">320981</span><span class="token punctuation">,</span><span class="token number">320982</span><span class="token punctuation">,</span><span class="token number">321001</span><span class="token punctuation">,</span><span class="token number">321002</span><span class="token punctuation">,</span><span class="token number">321003</span><span class="token punctuation">,</span><span class="token number">321011</span><span class="token punctuation">,</span><span class="token number">321023</span><span class="token punctuation">,</span><span class="token number">321081</span><span class="token punctuation">,</span><span class="token number">321084</span><span class="token punctuation">,</span><span class="token number">321088</span><span class="token punctuation">,</span><span class="token number">321101</span><span class="token punctuation">,</span><span class="token number">321102</span><span class="token punctuation">,</span><span class="token number">321111</span><span class="token punctuation">,</span><span class="token number">321121</span><span class="token punctuation">,</span><span class="token number">321181</span><span class="token punctuation">,</span><span class="token number">321182</span><span class="token punctuation">,</span><span class="token number">321183</span><span class="token punctuation">,</span><span class="token number">321201</span><span class="token punctuation">,</span><span class="token number">321202</span><span class="token punctuation">,</span><span class="token number">321203</span><span class="token punctuation">,</span><span class="token number">321281</span><span class="token punctuation">,</span><span class="token number">321282</span><span class="token punctuation">,</span><span class="token number">321283</span><span class="token punctuation">,</span><span class="token number">321284</span><span class="token punctuation">,</span><span class="token number">321301</span><span class="token punctuation">,</span><span class="token number">321302</span><span class="token punctuation">,</span><span class="token number">321321</span><span class="token punctuation">,</span><span class="token number">321322</span><span class="token punctuation">,</span><span class="token number">321323</span><span class="token punctuation">,</span><span class="token number">321324</span><span class="token punctuation">,</span><span class="token number">330101</span><span class="token punctuation">,</span><span class="token number">330102</span><span class="token punctuation">,</span><span class="token number">330103</span><span class="token punctuation">,</span><span class="token number">330104</span><span class="token punctuation">,</span><span class="token number">330105</span><span class="token punctuation">,</span><span class="token number">330106</span><span class="token punctuation">,</span><span class="token number">330108</span><span class="token punctuation">,</span><span class="token number">330122</span><span class="token punctuation">,</span><span class="token number">330127</span><span class="token punctuation">,</span><span class="token number">330181</span><span class="token punctuation">,</span><span class="token number">330182</span><span class="token punctuation">,</span><span class="token number">330183</span><span class="token punctuation">,</span><span class="token number">330184</span><span class="token punctuation">,</span><span class="token number">330185</span><span class="token punctuation">,</span><span class="token number">330201</span><span class="token punctuation">,</span><span class="token number">330203</span><span class="token punctuation">,</span><span class="token number">330204</span><span class="token punctuation">,</span><span class="token number">330205</span><span class="token punctuation">,</span><span class="token number">330206</span><span class="token punctuation">,</span><span class="token number">330211</span><span class="token punctuation">,</span><span class="token number">330225</span><span class="token punctuation">,</span><span class="token number">330226</span><span class="token punctuation">,</span><span class="token number">330227</span><span class="token punctuation">,</span><span class="token number">330281</span><span class="token punctuation">,</span><span class="token number">330282</span><span class="token punctuation">,</span><span class="token number">330283</span><span class="token punctuation">,</span><span class="token number">330301</span><span class="token punctuation">,</span><span class="token number">330302</span><span class="token punctuation">,</span><span class="token number">330303</span><span class="token punctuation">,</span><span class="token number">330304</span><span class="token punctuation">,</span><span class="token number">330322</span><span class="token punctuation">,</span><span class="token number">330324</span><span class="token punctuation">,</span><span class="token number">330326</span><span class="token punctuation">,</span><span class="token number">330327</span><span class="token punctuation">,</span><span class="token number">330328</span><span class="token punctuation">,</span><span class="token number">330329</span><span class="token punctuation">,</span><span class="token number">330381</span><span class="token punctuation">,</span><span class="token number">330382</span><span class="token punctuation">,</span><span class="token number">330401</span><span class="token punctuation">,</span><span class="token number">330402</span><span class="token punctuation">,</span><span class="token number">330411</span><span class="token punctuation">,</span><span class="token number">330421</span><span class="token punctuation">,</span><span class="token number">330424</span><span class="token punctuation">,</span><span class="token number">330481</span><span class="token punctuation">,</span><span class="token number">330482</span><span class="token punctuation">,</span><span class="token number">330483</span><span class="token punctuation">,</span><span class="token number">330501</span><span class="token punctuation">,</span><span class="token number">330521</span><span class="token punctuation">,</span><span class="token number">330522</span><span class="token punctuation">,</span><span class="token number">330523</span><span class="token punctuation">,</span><span class="token number">330601</span><span class="token punctuation">,</span><span class="token number">330602</span><span class="token punctuation">,</span><span class="token number">330621</span><span class="token punctuation">,</span><span class="token number">330624</span><span class="token punctuation">,</span><span class="token number">330681</span><span class="token punctuation">,</span><span class="token number">330682</span><span class="token punctuation">,</span><span class="token number">330683</span><span class="token punctuation">,</span><span class="token number">330701</span><span class="token punctuation">,</span><span class="token number">330702</span><span class="token punctuation">,</span><span class="token number">330703</span><span class="token punctuation">,</span><span class="token number">330723</span><span class="token punctuation">,</span><span class="token number">330726</span><span class="token punctuation">,</span><span class="token number">330727</span><span class="token punctuation">,</span><span class="token number">330781</span><span class="token punctuation">,</span><span class="token number">330782</span><span class="token punctuation">,</span><span class="token number">330783</span><span class="token punctuation">,</span><span class="token number">330784</span><span class="token punctuation">,</span><span class="token number">330801</span><span class="token punctuation">,</span><span class="token number">330802</span><span class="token punctuation">,</span><span class="token number">330821</span><span class="token punctuation">,</span><span class="token number">330822</span><span class="token punctuation">,</span><span class="token number">330824</span><span class="token punctuation">,</span><span class="token number">330825</span><span class="token punctuation">,</span><span class="token number">330881</span><span class="token punctuation">,</span><span class="token number">330901</span><span class="token punctuation">,</span><span class="token number">330902</span><span class="token punctuation">,</span><span class="token number">330903</span><span class="token punctuation">,</span><span class="token number">330921</span><span class="token punctuation">,</span><span class="token number">330922</span><span class="token punctuation">,</span><span class="token number">331001</span><span class="token punctuation">,</span><span class="token number">331002</span><span class="token punctuation">,</span><span class="token number">331003</span><span class="token punctuation">,</span><span class="token number">331004</span><span class="token punctuation">,</span><span class="token number">331021</span><span class="token punctuation">,</span><span class="token number">331022</span><span class="token punctuation">,</span><span class="token number">331023</span><span class="token punctuation">,</span><span class="token number">331024</span><span class="token punctuation">,</span><span class="token number">331081</span><span class="token punctuation">,</span><span class="token number">331082</span><span class="token punctuation">,</span><span class="token number">331101</span><span class="token punctuation">,</span><span class="token number">331102</span><span class="token punctuation">,</span><span class="token number">331121</span><span class="token punctuation">,</span><span class="token number">331122</span><span class="token punctuation">,</span><span class="token number">331123</span><span class="token punctuation">,</span><span class="token number">331124</span><span class="token punctuation">,</span><span class="token number">331125</span><span class="token punctuation">,</span><span class="token number">331126</span><span class="token punctuation">,</span><span class="token number">331127</span><span class="token punctuation">,</span><span class="token number">331181</span><span class="token punctuation">,</span><span class="token number">340101</span><span class="token punctuation">,</span><span class="token number">340102</span><span class="token punctuation">,</span><span class="token number">340103</span><span class="token punctuation">,</span><span class="token number">340104</span><span class="token punctuation">,</span><span class="token number">340111</span><span class="token punctuation">,</span><span class="token number">340121</span><span class="token punctuation">,</span><span class="token number">340122</span><span class="token punctuation">,</span><span class="token number">340123</span><span class="token punctuation">,</span><span class="token number">340201</span><span class="token punctuation">,</span><span class="token number">340202</span><span class="token punctuation">,</span><span class="token number">340203</span><span class="token punctuation">,</span><span class="token number">340204</span><span class="token punctuation">,</span><span class="token number">340207</span><span class="token punctuation">,</span><span class="token number">340221</span><span class="token punctuation">,</span><span class="token number">340222</span><span class="token punctuation">,</span><span class="token number">340223</span><span class="token punctuation">,</span><span class="token number">340301</span><span class="token punctuation">,</span><span class="token number">340302</span><span class="token punctuation">,</span><span class="token number">340303</span><span class="token punctuation">,</span><span class="token number">340304</span><span class="token punctuation">,</span><span class="token number">340311</span><span class="token punctuation">,</span><span class="token number">340321</span><span class="token punctuation">,</span><span class="token number">340322</span><span class="token punctuation">,</span><span class="token number">340323</span><span class="token punctuation">,</span><span class="token number">340401</span><span class="token punctuation">,</span><span class="token number">340402</span><span class="token punctuation">,</span><span class="token number">340403</span><span class="token punctuation">,</span><span class="token number">340404</span><span class="token punctuation">,</span><span class="token number">340405</span><span class="token punctuation">,</span><span class="token number">340406</span><span class="token punctuation">,</span><span class="token number">340421</span><span class="token punctuation">,</span><span class="token number">340501</span><span class="token punctuation">,</span><span class="token number">340502</span><span class="token punctuation">,</span><span class="token number">340503</span><span class="token punctuation">,</span><span class="token number">340504</span><span class="token punctuation">,</span><span class="token number">340505</span><span class="token punctuation">,</span><span class="token number">340521</span><span class="token punctuation">,</span><span class="token number">340601</span><span class="token punctuation">,</span><span class="token number">340602</span><span class="token punctuation">,</span><span class="token number">340603</span><span class="token punctuation">,</span><span class="token number">340604</span><span class="token punctuation">,</span><span class="token number">340621</span><span class="token punctuation">,</span><span class="token number">340701</span><span class="token punctuation">,</span><span class="token number">340702</span><span class="token punctuation">,</span><span class="token number">340703</span><span class="token punctuation">,</span><span class="token number">340711</span><span class="token punctuation">,</span><span class="token number">340721</span><span class="token punctuation">,</span><span class="token number">340801</span><span class="token punctuation">,</span><span class="token number">340802</span><span class="token punctuation">,</span><span class="token number">340803</span><span class="token punctuation">,</span><span class="token number">340811</span><span class="token punctuation">,</span><span class="token number">340822</span><span class="token punctuation">,</span><span class="token number">340823</span><span class="token punctuation">,</span><span class="token number">340824</span><span class="token punctuation">,</span><span class="token number">340825</span><span class="token punctuation">,</span><span class="token number">340826</span><span class="token punctuation">,</span><span class="token number">340827</span><span class="token punctuation">,</span><span class="token number">340828</span><span class="token punctuation">,</span><span class="token number">340881</span><span class="token punctuation">,</span><span class="token number">341001</span><span class="token punctuation">,</span><span class="token number">341002</span><span class="token punctuation">,</span><span class="token number">341003</span><span class="token punctuation">,</span><span class="token number">341004</span><span class="token punctuation">,</span><span class="token number">341021</span><span class="token punctuation">,</span><span class="token number">341022</span><span class="token punctuation">,</span><span class="token number">341023</span><span class="token punctuation">,</span><span class="token number">341024</span><span class="token punctuation">,</span><span class="token number">341101</span><span class="token punctuation">,</span><span class="token number">341102</span><span class="token punctuation">,</span><span class="token number">341103</span><span class="token punctuation">,</span><span class="token number">341122</span><span class="token punctuation">,</span><span class="token number">341124</span><span class="token punctuation">,</span><span class="token number">341125</span><span class="token punctuation">,</span><span class="token number">341126</span><span class="token punctuation">,</span><span class="token number">341181</span><span class="token punctuation">,</span><span class="token number">341182</span><span class="token punctuation">,</span><span class="token number">341201</span><span class="token punctuation">,</span><span class="token number">341202</span><span class="token punctuation">,</span><span class="token number">341203</span><span class="token punctuation">,</span><span class="token number">341204</span><span class="token punctuation">,</span><span class="token number">341221</span><span class="token punctuation">,</span><span class="token number">341222</span><span class="token punctuation">,</span><span class="token number">341225</span><span class="token punctuation">,</span><span class="token number">341226</span><span class="token punctuation">,</span><span class="token number">341282</span><span class="token punctuation">,</span><span class="token number">341301</span><span class="token punctuation">,</span><span class="token number">341302</span><span class="token punctuation">,</span><span class="token number">341321</span><span class="token punctuation">,</span><span class="token number">341322</span><span class="token punctuation">,</span><span class="token number">341323</span><span class="token punctuation">,</span><span class="token number">341324</span><span class="token punctuation">,</span><span class="token number">341401</span><span class="token punctuation">,</span><span class="token number">341402</span><span class="token punctuation">,</span><span class="token number">341421</span><span class="token punctuation">,</span><span class="token number">341422</span><span class="token punctuation">,</span><span class="token number">341423</span><span class="token punctuation">,</span><span class="token number">341424</span><span class="token punctuation">,</span><span class="token number">341501</span><span class="token punctuation">,</span><span class="token number">341502</span><span class="token punctuation">,</span><span class="token number">341503</span><span class="token punctuation">,</span><span class="token number">341521</span><span class="token punctuation">,</span><span class="token number">341522</span><span class="token punctuation">,</span><span class="token number">341523</span><span class="token punctuation">,</span><span class="token number">341524</span><span class="token punctuation">,</span><span class="token number">341525</span><span class="token punctuation">,</span><span class="token number">341601</span><span class="token punctuation">,</span><span class="token number">341602</span><span class="token punctuation">,</span><span class="token number">341621</span><span class="token punctuation">,</span><span class="token number">341622</span><span class="token punctuation">,</span><span class="token number">341623</span><span class="token punctuation">,</span><span class="token number">341701</span><span class="token punctuation">,</span><span class="token number">341702</span><span class="token punctuation">,</span><span class="token number">341721</span><span class="token punctuation">,</span><span class="token number">341722</span><span class="token punctuation">,</span><span class="token number">341723</span><span class="token punctuation">,</span><span class="token number">341801</span><span class="token punctuation">,</span><span class="token number">341802</span><span class="token punctuation">,</span><span class="token number">341821</span><span class="token punctuation">,</span><span class="token number">341822</span><span class="token punctuation">,</span><span class="token number">341823</span><span class="token punctuation">,</span><span class="token number">341824</span><span class="token punctuation">,</span><span class="token number">341825</span><span class="token punctuation">,</span><span class="token number">341881</span><span class="token punctuation">,</span><span class="token number">350101</span><span class="token punctuation">,</span><span class="token number">350102</span><span class="token punctuation">,</span><span class="token number">350103</span><span class="token punctuation">,</span><span class="token number">350104</span><span class="token punctuation">,</span><span class="token number">350105</span><span class="token punctuation">,</span><span class="token number">350111</span><span class="token punctuation">,</span><span class="token number">350121</span><span class="token punctuation">,</span><span class="token number">350122</span><span class="token punctuation">,</span><span class="token number">350123</span><span class="token punctuation">,</span><span class="token number">350124</span><span class="token punctuation">,</span><span class="token number">350125</span><span class="token punctuation">,</span><span class="token number">350128</span><span class="token punctuation">,</span><span class="token number">350181</span><span class="token punctuation">,</span><span class="token number">350182</span><span class="token punctuation">,</span><span class="token number">350201</span><span class="token punctuation">,</span><span class="token number">350202</span><span class="token punctuation">,</span><span class="token number">350203</span><span class="token punctuation">,</span><span class="token number">350204</span><span class="token punctuation">,</span><span class="token number">350205</span><span class="token punctuation">,</span><span class="token number">350206</span><span class="token punctuation">,</span><span class="token number">350211</span><span class="token punctuation">,</span><span class="token number">350212</span><span class="token punctuation">,</span><span class="token number">350301</span><span class="token punctuation">,</span><span class="token number">350302</span><span class="token punctuation">,</span><span class="token number">350303</span><span class="token punctuation">,</span><span class="token number">350321</span><span class="token punctuation">,</span><span class="token number">350322</span><span class="token punctuation">,</span><span class="token number">350401</span><span class="token punctuation">,</span><span class="token number">350402</span><span class="token punctuation">,</span><span class="token number">350403</span><span class="token punctuation">,</span><span class="token number">350421</span><span class="token punctuation">,</span><span class="token number">350423</span><span class="token punctuation">,</span><span class="token number">350424</span><span class="token punctuation">,</span><span class="token number">350425</span><span class="token punctuation">,</span><span class="token number">350426</span><span class="token punctuation">,</span><span class="token number">350427</span><span class="token punctuation">,</span><span class="token number">350428</span><span class="token punctuation">,</span><span class="token number">350429</span><span class="token punctuation">,</span><span class="token number">350430</span><span class="token punctuation">,</span><span class="token number">350481</span><span class="token punctuation">,</span><span class="token number">350501</span><span class="token punctuation">,</span><span class="token number">350502</span><span class="token punctuation">,</span><span class="token number">350503</span><span class="token punctuation">,</span><span class="token number">350504</span><span class="token punctuation">,</span><span class="token number">350505</span><span class="token punctuation">,</span><span class="token number">350521</span><span class="token punctuation">,</span><span class="token number">350524</span><span class="token punctuation">,</span><span class="token number">350525</span><span class="token punctuation">,</span><span class="token number">350526</span><span class="token punctuation">,</span><span class="token number">350527</span><span class="token punctuation">,</span><span class="token number">350581</span><span class="token punctuation">,</span><span class="token number">350582</span><span class="token punctuation">,</span><span class="token number">350583</span><span class="token punctuation">,</span><span class="token number">350601</span><span class="token punctuation">,</span><span class="token number">350602</span><span class="token punctuation">,</span><span class="token number">350603</span><span class="token punctuation">,</span><span class="token number">350622</span><span class="token punctuation">,</span><span class="token number">350623</span><span class="token punctuation">,</span><span class="token number">350624</span><span class="token punctuation">,</span><span class="token number">350625</span><span class="token punctuation">,</span><span class="token number">350626</span><span class="token punctuation">,</span><span class="token number">350627</span><span class="token punctuation">,</span><span class="token number">350628</span><span class="token punctuation">,</span><span class="token number">350629</span><span class="token punctuation">,</span><span class="token number">350681</span><span class="token punctuation">,</span><span class="token number">350701</span><span class="token punctuation">,</span><span class="token number">350702</span><span class="token punctuation">,</span><span class="token number">350721</span><span class="token punctuation">,</span><span class="token number">350722</span><span class="token punctuation">,</span><span class="token number">350723</span><span class="token punctuation">,</span><span class="token number">350724</span><span class="token punctuation">,</span><span class="token number">350725</span><span class="token punctuation">,</span><span class="token number">350781</span><span class="token punctuation">,</span><span class="token number">350782</span><span class="token punctuation">,</span><span class="token number">350783</span><span class="token punctuation">,</span><span class="token number">350784</span><span class="token punctuation">,</span><span class="token number">350801</span><span class="token punctuation">,</span><span class="token number">350802</span><span class="token punctuation">,</span><span class="token number">350821</span><span class="token punctuation">,</span><span class="token number">350822</span><span class="token punctuation">,</span><span class="token number">350823</span><span class="token punctuation">,</span><span class="token number">350824</span><span class="token punctuation">,</span><span class="token number">350825</span><span class="token punctuation">,</span><span class="token number">350881</span><span class="token punctuation">,</span><span class="token number">350901</span><span class="token punctuation">,</span><span class="token number">350902</span><span class="token punctuation">,</span><span class="token number">350921</span><span class="token punctuation">,</span><span class="token number">350922</span><span class="token punctuation">,</span><span class="token number">350923</span><span class="token punctuation">,</span><span class="token number">350924</span><span class="token punctuation">,</span><span class="token number">350925</span><span class="token punctuation">,</span><span class="token number">350926</span><span class="token punctuation">,</span><span class="token number">350981</span><span class="token punctuation">,</span><span class="token number">350982</span><span class="token punctuation">,</span><span class="token number">360101</span><span class="token punctuation">,</span><span class="token number">360102</span><span class="token punctuation">,</span><span class="token number">360103</span><span class="token punctuation">,</span><span class="token number">360104</span><span class="token punctuation">,</span><span class="token number">360105</span><span class="token punctuation">,</span><span class="token number">360111</span><span class="token punctuation">,</span><span class="token number">360121</span><span class="token punctuation">,</span><span class="token number">360122</span><span class="token punctuation">,</span><span class="token number">360123</span><span class="token punctuation">,</span><span class="token number">360124</span><span class="token punctuation">,</span><span class="token number">360201</span><span class="token punctuation">,</span><span class="token number">360202</span><span class="token punctuation">,</span><span class="token number">360203</span><span class="token punctuation">,</span><span class="token number">360222</span><span class="token punctuation">,</span><span class="token number">360281</span><span class="token punctuation">,</span><span class="token number">360301</span><span class="token punctuation">,</span><span class="token number">360302</span><span class="token punctuation">,</span><span class="token number">360313</span><span class="token punctuation">,</span><span class="token number">360321</span><span class="token punctuation">,</span><span class="token number">360322</span><span class="token punctuation">,</span><span class="token number">360323</span><span class="token punctuation">,</span><span class="token number">360401</span><span class="token punctuation">,</span><span class="token number">360402</span><span class="token punctuation">,</span><span class="token number">360403</span><span class="token punctuation">,</span><span class="token number">360421</span><span class="token punctuation">,</span><span class="token number">360423</span><span class="token punctuation">,</span><span class="token number">360424</span><span class="token punctuation">,</span><span class="token number">360425</span><span class="token punctuation">,</span><span class="token number">360426</span><span class="token punctuation">,</span><span class="token number">360427</span><span class="token punctuation">,</span><span class="token number">360428</span><span class="token punctuation">,</span><span class="token number">360429</span><span class="token punctuation">,</span><span class="token number">360430</span><span class="token punctuation">,</span><span class="token number">360481</span><span class="token punctuation">,</span><span class="token number">360501</span><span class="token punctuation">,</span><span class="token number">360502</span><span class="token punctuation">,</span><span class="token number">360521</span><span class="token punctuation">,</span><span class="token number">360601</span><span class="token punctuation">,</span><span class="token number">360602</span><span class="token punctuation">,</span><span class="token number">360622</span><span class="token punctuation">,</span><span class="token number">360681</span><span class="token punctuation">,</span><span class="token number">360701</span><span class="token punctuation">,</span><span class="token number">360702</span><span class="token punctuation">,</span><span class="token number">360721</span><span class="token punctuation">,</span><span class="token number">360722</span><span class="token punctuation">,</span><span class="token number">360723</span><span class="token punctuation">,</span><span class="token number">360724</span><span class="token punctuation">,</span><span class="token number">360725</span><span class="token punctuation">,</span><span class="token number">360726</span><span class="token punctuation">,</span><span class="token number">360727</span><span class="token punctuation">,</span><span class="token number">360728</span><span class="token punctuation">,</span><span class="token number">360729</span><span class="token punctuation">,</span><span class="token number">360730</span><span class="token punctuation">,</span><span class="token number">360731</span><span class="token punctuation">,</span><span class="token number">360732</span><span class="token punctuation">,</span><span class="token number">360733</span><span class="token punctuation">,</span><span class="token number">360734</span><span class="token punctuation">,</span><span class="token number">360735</span><span class="token punctuation">,</span><span class="token number">360781</span><span class="token punctuation">,</span><span class="token number">360782</span><span class="token punctuation">,</span><span class="token number">360801</span><span class="token punctuation">,</span><span class="token number">360802</span><span class="token punctuation">,</span><span class="token number">360803</span><span class="token punctuation">,</span><span class="token number">360821</span><span class="token punctuation">,</span><span class="token number">360822</span><span class="token punctuation">,</span><span class="token number">360823</span><span class="token punctuation">,</span><span class="token number">360824</span><span class="token punctuation">,</span><span class="token number">360825</span><span class="token punctuation">,</span><span class="token number">360826</span><span class="token punctuation">,</span><span class="token number">360827</span><span class="token punctuation">,</span><span class="token number">360828</span><span class="token punctuation">,</span><span class="token number">360829</span><span class="token punctuation">,</span><span class="token number">360830</span><span class="token punctuation">,</span><span class="token number">360881</span><span class="token punctuation">,</span><span class="token number">360901</span><span class="token punctuation">,</span><span class="token number">360902</span><span class="token punctuation">,</span><span class="token number">360921</span><span class="token punctuation">,</span><span class="token number">360922</span><span class="token punctuation">,</span><span class="token number">360923</span><span class="token punctuation">,</span><span class="token number">360924</span><span class="token punctuation">,</span><span class="token number">360925</span><span class="token punctuation">,</span><span class="token number">360926</span><span class="token punctuation">,</span><span class="token number">360981</span><span class="token punctuation">,</span><span class="token number">360982</span><span class="token punctuation">,</span><span class="token number">360983</span><span class="token punctuation">,</span><span class="token number">361001</span><span class="token punctuation">,</span><span class="token number">361002</span><span class="token punctuation">,</span><span class="token number">361021</span><span class="token punctuation">,</span><span class="token number">361022</span><span class="token punctuation">,</span><span class="token number">361023</span><span class="token punctuation">,</span><span class="token number">361024</span><span class="token punctuation">,</span><span class="token number">361025</span><span class="token punctuation">,</span><span class="token number">361026</span><span class="token punctuation">,</span><span class="token number">361027</span><span class="token punctuation">,</span><span class="token number">361028</span><span class="token punctuation">,</span><span class="token number">361029</span><span class="token punctuation">,</span><span class="token number">361030</span><span class="token punctuation">,</span><span class="token number">361101</span><span class="token punctuation">,</span><span class="token number">361102</span><span class="token punctuation">,</span><span class="token number">361121</span><span class="token punctuation">,</span><span class="token number">361122</span><span class="token punctuation">,</span><span class="token number">361123</span><span class="token punctuation">,</span><span class="token number">361124</span><span class="token punctuation">,</span><span class="token number">361125</span><span class="token punctuation">,</span><span class="token number">361126</span><span class="token punctuation">,</span><span class="token number">361127</span><span class="token punctuation">,</span><span class="token number">361128</span><span class="token punctuation">,</span><span class="token number">361129</span><span class="token punctuation">,</span><span class="token number">361130</span><span class="token punctuation">,</span><span class="token number">361181</span><span class="token punctuation">,</span><span class="token number">370101</span><span class="token punctuation">,</span><span class="token number">370102</span><span class="token punctuation">,</span><span class="token number">370103</span><span class="token punctuation">,</span><span class="token number">370104</span><span class="token punctuation">,</span><span class="token number">370105</span><span class="token punctuation">,</span><span class="token number">370112</span><span class="token punctuation">,</span><span class="token number">370123</span><span class="token punctuation">,</span><span class="token number">370124</span><span class="token punctuation">,</span><span class="token number">370125</span><span class="token punctuation">,</span><span class="token number">370126</span><span class="token punctuation">,</span><span class="token number">370181</span><span class="token punctuation">,</span><span class="token number">370201</span><span class="token punctuation">,</span><span class="token number">370202</span><span class="token punctuation">,</span><span class="token number">370203</span><span class="token punctuation">,</span><span class="token number">370205</span><span class="token punctuation">,</span><span class="token number">370211</span><span class="token punctuation">,</span><span class="token number">370212</span><span class="token punctuation">,</span><span class="token number">370213</span><span class="token punctuation">,</span><span class="token number">370214</span><span class="token punctuation">,</span><span class="token number">370281</span><span class="token punctuation">,</span><span class="token number">370282</span><span class="token punctuation">,</span><span class="token number">370283</span><span class="token punctuation">,</span><span class="token number">370284</span><span class="token punctuation">,</span><span class="token number">370285</span><span class="token punctuation">,</span><span class="token number">370301</span><span class="token punctuation">,</span><span class="token number">370302</span><span class="token punctuation">,</span><span class="token number">370303</span><span class="token punctuation">,</span><span class="token number">370304</span><span class="token punctuation">,</span><span class="token number">370305</span><span class="token punctuation">,</span><span class="token number">370306</span><span class="token punctuation">,</span><span class="token number">370321</span><span class="token punctuation">,</span><span class="token number">370322</span><span class="token punctuation">,</span><span class="token number">370323</span><span class="token punctuation">,</span><span class="token number">370401</span><span class="token punctuation">,</span><span class="token number">370402</span><span class="token punctuation">,</span><span class="token number">370403</span><span class="token punctuation">,</span><span class="token number">370404</span><span class="token punctuation">,</span><span class="token number">370405</span><span class="token punctuation">,</span><span class="token number">370406</span><span class="token punctuation">,</span><span class="token number">370481</span><span class="token punctuation">,</span><span class="token number">370501</span><span class="token punctuation">,</span><span class="token number">370502</span><span class="token punctuation">,</span><span class="token number">370503</span><span class="token punctuation">,</span><span class="token number">370521</span><span class="token punctuation">,</span><span class="token number">370522</span><span class="token punctuation">,</span><span class="token number">370523</span><span class="token punctuation">,</span><span class="token number">370601</span><span class="token punctuation">,</span><span class="token number">370602</span><span class="token punctuation">,</span><span class="token number">370611</span><span class="token punctuation">,</span><span class="token number">370612</span><span class="token punctuation">,</span><span class="token number">370613</span><span class="token punctuation">,</span><span class="token number">370634</span><span class="token punctuation">,</span><span class="token number">370681</span><span class="token punctuation">,</span><span class="token number">370682</span><span class="token punctuation">,</span><span class="token number">370683</span><span class="token punctuation">,</span><span class="token number">370684</span><span class="token punctuation">,</span><span class="token number">370685</span><span class="token punctuation">,</span><span class="token number">370686</span><span class="token punctuation">,</span><span class="token number">370687</span><span class="token punctuation">,</span><span class="token number">370701</span><span class="token punctuation">,</span><span class="token number">370702</span><span class="token punctuation">,</span><span class="token number">370703</span><span class="token punctuation">,</span><span class="token number">370704</span><span class="token punctuation">,</span><span class="token number">370705</span><span class="token punctuation">,</span><span class="token number">370724</span><span class="token punctuation">,</span><span class="token number">370725</span><span class="token punctuation">,</span><span class="token number">370781</span><span class="token punctuation">,</span><span class="token number">370782</span><span class="token punctuation">,</span><span class="token number">370783</span><span class="token punctuation">,</span><span class="token number">370784</span><span class="token punctuation">,</span><span class="token number">370785</span><span class="token punctuation">,</span><span class="token number">370786</span><span class="token punctuation">,</span><span class="token number">370801</span><span class="token punctuation">,</span><span class="token number">370802</span><span class="token punctuation">,</span><span class="token number">370811</span><span class="token punctuation">,</span><span class="token number">370826</span><span class="token punctuation">,</span><span class="token number">370827</span><span class="token punctuation">,</span><span class="token number">370828</span><span class="token punctuation">,</span><span class="token number">370829</span><span class="token punctuation">,</span><span class="token number">370830</span><span class="token punctuation">,</span><span class="token number">370831</span><span class="token punctuation">,</span><span class="token number">370832</span><span class="token punctuation">,</span><span class="token number">370881</span><span class="token punctuation">,</span><span class="token number">370882</span><span class="token punctuation">,</span><span class="token number">370883</span><span class="token punctuation">,</span><span class="token number">370901</span><span class="token punctuation">,</span><span class="token number">370902</span><span class="token punctuation">,</span><span class="token number">370903</span><span class="token punctuation">,</span><span class="token number">370921</span><span class="token punctuation">,</span><span class="token number">370923</span><span class="token punctuation">,</span><span class="token number">370982</span><span class="token punctuation">,</span><span class="token number">370983</span><span class="token punctuation">,</span><span class="token number">371001</span><span class="token punctuation">,</span><span class="token number">371002</span><span class="token punctuation">,</span><span class="token number">371081</span><span class="token punctuation">,</span><span class="token number">371082</span><span class="token punctuation">,</span><span class="token number">371083</span><span class="token punctuation">,</span><span class="token number">371101</span><span class="token punctuation">,</span><span class="token number">371102</span><span class="token punctuation">,</span><span class="token number">371121</span><span class="token punctuation">,</span><span class="token number">371122</span><span class="token punctuation">,</span><span class="token number">371201</span><span class="token punctuation">,</span><span class="token number">371202</span><span class="token punctuation">,</span><span class="token number">371203</span><span class="token punctuation">,</span><span class="token number">371301</span><span class="token punctuation">,</span><span class="token number">371302</span><span class="token punctuation">,</span><span class="token number">371311</span><span class="token punctuation">,</span><span class="token number">371312</span><span class="token punctuation">,</span><span class="token number">371321</span><span class="token punctuation">,</span><span class="token number">371322</span><span class="token punctuation">,</span><span class="token number">371323</span><span class="token punctuation">,</span><span class="token number">371324</span><span class="token punctuation">,</span><span class="token number">371325</span><span class="token punctuation">,</span><span class="token number">371326</span><span class="token punctuation">,</span><span class="token number">371327</span><span class="token punctuation">,</span><span class="token number">371328</span><span class="token punctuation">,</span><span class="token number">371329</span><span class="token punctuation">,</span><span class="token number">371401</span><span class="token punctuation">,</span><span class="token number">371402</span><span class="token punctuation">,</span><span class="token number">371421</span><span class="token punctuation">,</span><span class="token number">371422</span><span class="token punctuation">,</span><span class="token number">371423</span><span class="token punctuation">,</span><span class="token number">371424</span><span class="token punctuation">,</span><span class="token number">371425</span><span class="token punctuation">,</span><span class="token number">371426</span><span class="token punctuation">,</span><span class="token number">371427</span><span class="token punctuation">,</span><span class="token number">371428</span><span class="token punctuation">,</span><span class="token number">371481</span><span class="token punctuation">,</span><span class="token number">371482</span><span class="token punctuation">,</span><span class="token number">371501</span><span class="token punctuation">,</span><span class="token number">371502</span><span class="token punctuation">,</span><span class="token number">371521</span><span class="token punctuation">,</span><span class="token number">371522</span><span class="token punctuation">,</span><span class="token number">371523</span><span class="token punctuation">,</span><span class="token number">371524</span><span class="token punctuation">,</span><span class="token number">371525</span><span class="token punctuation">,</span><span class="token number">371526</span><span class="token punctuation">,</span><span class="token number">371581</span><span class="token punctuation">,</span><span class="token number">371601</span><span class="token punctuation">,</span><span class="token number">371603</span><span class="token punctuation">,</span><span class="token number">371621</span><span class="token punctuation">,</span><span class="token number">371622</span><span class="token punctuation">,</span><span class="token number">371623</span><span class="token punctuation">,</span><span class="token number">371624</span><span class="token punctuation">,</span><span class="token number">371625</span><span class="token punctuation">,</span><span class="token number">371626</span><span class="token punctuation">,</span><span class="token number">371701</span><span class="token punctuation">,</span><span class="token number">371702</span><span class="token punctuation">,</span><span class="token number">371721</span><span class="token punctuation">,</span><span class="token number">371722</span><span class="token punctuation">,</span><span class="token number">371723</span><span class="token punctuation">,</span><span class="token number">371724</span><span class="token punctuation">,</span><span class="token number">371725</span><span class="token punctuation">,</span><span class="token number">371726</span><span class="token punctuation">,</span><span class="token number">371727</span><span class="token punctuation">,</span><span class="token number">371728</span><span class="token punctuation">,</span><span class="token number">410101</span><span class="token punctuation">,</span><span class="token number">410102</span><span class="token punctuation">,</span><span class="token number">410103</span><span class="token punctuation">,</span><span class="token number">410104</span><span class="token punctuation">,</span><span class="token number">410105</span><span class="token punctuation">,</span><span class="token number">410106</span><span class="token punctuation">,</span><span class="token number">410108</span><span class="token punctuation">,</span><span class="token number">410122</span><span class="token punctuation">,</span><span class="token number">410181</span><span class="token punctuation">,</span><span class="token number">410182</span><span class="token punctuation">,</span><span class="token number">410183</span><span class="token punctuation">,</span><span class="token number">410184</span><span class="token punctuation">,</span><span class="token number">410185</span><span class="token punctuation">,</span><span class="token number">410201</span><span class="token punctuation">,</span><span class="token number">410202</span><span class="token punctuation">,</span><span class="token number">410203</span><span class="token punctuation">,</span><span class="token number">410204</span><span class="token punctuation">,</span><span class="token number">410205</span><span class="token punctuation">,</span><span class="token number">410211</span><span class="token punctuation">,</span><span class="token number">410221</span><span class="token punctuation">,</span><span class="token number">410222</span><span class="token punctuation">,</span><span class="token number">410223</span><span class="token punctuation">,</span><span class="token number">410224</span><span class="token punctuation">,</span><span class="token number">410225</span><span class="token punctuation">,</span><span class="token number">410301</span><span class="token punctuation">,</span><span class="token number">410302</span><span class="token punctuation">,</span><span class="token number">410303</span><span class="token punctuation">,</span><span class="token number">410304</span><span class="token punctuation">,</span><span class="token number">410305</span><span class="token punctuation">,</span><span class="token number">410306</span><span class="token punctuation">,</span><span class="token number">410307</span><span class="token punctuation">,</span><span class="token number">410322</span><span class="token punctuation">,</span><span class="token number">410323</span><span class="token punctuation">,</span><span class="token number">410324</span><span class="token punctuation">,</span><span class="token number">410325</span><span class="token punctuation">,</span><span class="token number">410326</span><span class="token punctuation">,</span><span class="token number">410327</span><span class="token punctuation">,</span><span class="token number">410328</span><span class="token punctuation">,</span><span class="token number">410329</span><span class="token punctuation">,</span><span class="token number">410381</span><span class="token punctuation">,</span><span class="token number">410401</span><span class="token punctuation">,</span><span class="token number">410402</span><span class="token punctuation">,</span><span class="token number">410403</span><span class="token punctuation">,</span><span class="token number">410404</span><span class="token punctuation">,</span><span class="token number">410411</span><span class="token punctuation">,</span><span class="token number">410421</span><span class="token punctuation">,</span><span class="token number">410422</span><span class="token punctuation">,</span><span class="token number">410423</span><span class="token punctuation">,</span><span class="token number">410425</span><span class="token punctuation">,</span><span class="token number">410481</span><span class="token punctuation">,</span><span class="token number">410482</span><span class="token punctuation">,</span><span class="token number">410501</span><span class="token punctuation">,</span><span class="token number">410502</span><span class="token punctuation">,</span><span class="token number">410503</span><span class="token punctuation">,</span><span class="token number">410504</span><span class="token punctuation">,</span><span class="token number">410511</span><span class="token punctuation">,</span><span class="token number">410522</span><span class="token punctuation">,</span><span class="token number">410523</span><span class="token punctuation">,</span><span class="token number">410526</span><span class="token punctuation">,</span><span class="token number">410527</span><span class="token punctuation">,</span><span class="token number">410581</span><span class="token punctuation">,</span><span class="token number">410601</span><span class="token punctuation">,</span><span class="token number">410602</span><span class="token punctuation">,</span><span class="token number">410603</span><span class="token punctuation">,</span><span class="token number">410611</span><span class="token punctuation">,</span><span class="token number">410621</span><span class="token punctuation">,</span><span class="token number">410622</span><span class="token punctuation">,</span><span class="token number">410701</span><span class="token punctuation">,</span><span class="token number">410702</span><span class="token punctuation">,</span><span class="token number">410703</span><span class="token punctuation">,</span><span class="token number">410704</span><span class="token punctuation">,</span><span class="token number">410711</span><span class="token punctuation">,</span><span class="token number">410721</span><span class="token punctuation">,</span><span class="token number">410724</span><span class="token punctuation">,</span><span class="token number">410725</span><span class="token punctuation">,</span><span class="token number">410726</span><span class="token punctuation">,</span><span class="token number">410727</span><span class="token punctuation">,</span><span class="token number">410728</span><span class="token punctuation">,</span><span class="token number">410781</span><span class="token punctuation">,</span><span class="token number">410782</span><span class="token punctuation">,</span><span class="token number">410801</span><span class="token punctuation">,</span><span class="token number">410802</span><span class="token punctuation">,</span><span class="token number">410803</span><span class="token punctuation">,</span><span class="token number">410804</span><span class="token punctuation">,</span><span class="token number">410811</span><span class="token punctuation">,</span><span class="token number">410821</span><span class="token punctuation">,</span><span class="token number">410822</span><span class="token punctuation">,</span><span class="token number">410823</span><span class="token punctuation">,</span><span class="token number">410825</span><span class="token punctuation">,</span><span class="token number">410881</span><span class="token punctuation">,</span><span class="token number">410882</span><span class="token punctuation">,</span><span class="token number">410883</span><span class="token punctuation">,</span><span class="token number">410901</span><span class="token punctuation">,</span><span class="token number">410902</span><span class="token punctuation">,</span><span class="token number">410922</span><span class="token punctuation">,</span><span class="token number">410923</span><span class="token punctuation">,</span><span class="token number">410926</span><span class="token punctuation">,</span><span class="token number">410927</span><span class="token punctuation">,</span><span class="token number">410928</span><span class="token punctuation">,</span><span class="token number">411001</span><span class="token punctuation">,</span><span class="token number">411002</span><span class="token punctuation">,</span><span class="token number">411023</span><span class="token punctuation">,</span><span class="token number">411024</span><span class="token punctuation">,</span><span class="token number">411025</span><span class="token punctuation">,</span><span class="token number">411081</span><span class="token punctuation">,</span><span class="token number">411082</span><span class="token punctuation">,</span><span class="token number">411101</span><span class="token punctuation">,</span><span class="token number">411102</span><span class="token punctuation">,</span><span class="token number">411121</span><span class="token punctuation">,</span><span class="token number">411122</span><span class="token punctuation">,</span><span class="token number">411123</span><span class="token punctuation">,</span><span class="token number">411201</span><span class="token punctuation">,</span><span class="token number">411202</span><span class="token punctuation">,</span><span class="token number">411221</span><span class="token punctuation">,</span><span class="token number">411222</span><span class="token punctuation">,</span><span class="token number">411224</span><span class="token punctuation">,</span><span class="token number">411281</span><span class="token punctuation">,</span><span class="token number">411282</span><span class="token punctuation">,</span><span class="token number">411301</span><span class="token punctuation">,</span><span class="token number">411302</span><span class="token punctuation">,</span><span class="token number">411303</span><span class="token punctuation">,</span><span class="token number">411321</span><span class="token punctuation">,</span><span class="token number">411322</span><span class="token punctuation">,</span><span class="token number">411323</span><span class="token punctuation">,</span><span class="token number">411324</span><span class="token punctuation">,</span><span class="token number">411325</span><span class="token punctuation">,</span><span class="token number">411326</span><span class="token punctuation">,</span><span class="token number">411327</span><span class="token punctuation">,</span><span class="token number">411328</span><span class="token punctuation">,</span><span class="token number">411329</span><span class="token punctuation">,</span><span class="token number">411330</span><span class="token punctuation">,</span><span class="token number">411381</span><span class="token punctuation">,</span><span class="token number">411401</span><span class="token punctuation">,</span><span class="token number">411402</span><span class="token punctuation">,</span><span class="token number">411403</span><span class="token punctuation">,</span><span class="token number">411421</span><span class="token punctuation">,</span><span class="token number">411422</span><span class="token punctuation">,</span><span class="token number">411423</span><span class="token punctuation">,</span><span class="token number">411424</span><span class="token punctuation">,</span><span class="token number">411425</span><span class="token punctuation">,</span><span class="token number">411426</span><span class="token punctuation">,</span><span class="token number">411481</span><span class="token punctuation">,</span><span class="token number">411501</span><span class="token punctuation">,</span><span class="token number">411502</span><span class="token punctuation">,</span><span class="token number">411503</span><span class="token punctuation">,</span><span class="token number">411521</span><span class="token punctuation">,</span><span class="token number">411522</span><span class="token punctuation">,</span><span class="token number">411523</span><span class="token punctuation">,</span><span class="token number">411524</span><span class="token punctuation">,</span><span class="token number">411525</span><span class="token punctuation">,</span><span class="token number">411526</span><span class="token punctuation">,</span><span class="token number">411527</span><span class="token punctuation">,</span><span class="token number">411528</span><span class="token punctuation">,</span><span class="token number">411601</span><span class="token punctuation">,</span><span class="token number">411602</span><span class="token punctuation">,</span><span class="token number">411621</span><span class="token punctuation">,</span><span class="token number">411622</span><span class="token punctuation">,</span><span class="token number">411623</span><span class="token punctuation">,</span><span class="token number">411624</span><span class="token punctuation">,</span><span class="token number">411625</span><span class="token punctuation">,</span><span class="token number">411626</span><span class="token punctuation">,</span><span class="token number">411627</span><span class="token punctuation">,</span><span class="token number">411628</span><span class="token punctuation">,</span><span class="token number">411681</span><span class="token punctuation">,</span><span class="token number">411701</span><span class="token punctuation">,</span><span class="token number">411702</span><span class="token punctuation">,</span><span class="token number">411721</span><span class="token punctuation">,</span><span class="token number">411722</span><span class="token punctuation">,</span><span class="token number">411723</span><span class="token punctuation">,</span><span class="token number">411724</span><span class="token punctuation">,</span><span class="token number">411725</span><span class="token punctuation">,</span><span class="token number">411726</span><span class="token punctuation">,</span><span class="token number">411727</span><span class="token punctuation">,</span><span class="token number">411728</span><span class="token punctuation">,</span><span class="token number">411729</span><span class="token punctuation">,</span><span class="token number">420101</span><span class="token punctuation">,</span><span class="token number">420102</span><span class="token punctuation">,</span><span class="token number">420103</span><span class="token punctuation">,</span><span class="token number">420104</span><span class="token punctuation">,</span><span class="token number">420105</span><span class="token punctuation">,</span><span class="token number">420106</span><span class="token punctuation">,</span><span class="token number">420107</span><span class="token punctuation">,</span><span class="token number">420111</span><span class="token punctuation">,</span><span class="token number">420112</span><span class="token punctuation">,</span><span class="token number">420113</span><span class="token punctuation">,</span><span class="token number">420114</span><span class="token punctuation">,</span><span class="token number">420115</span><span class="token punctuation">,</span><span class="token number">420116</span><span class="token punctuation">,</span><span class="token number">420117</span><span class="token punctuation">,</span><span class="token number">420201</span><span class="token punctuation">,</span><span class="token number">420202</span><span class="token punctuation">,</span><span class="token number">420203</span><span class="token punctuation">,</span><span class="token number">420204</span><span class="token punctuation">,</span><span class="token number">420205</span><span class="token punctuation">,</span><span class="token number">420222</span><span class="token punctuation">,</span><span class="token number">420281</span><span class="token punctuation">,</span><span class="token number">420301</span><span class="token punctuation">,</span><span class="token number">420302</span><span class="token punctuation">,</span><span class="token number">420303</span><span class="token punctuation">,</span><span class="token number">420321</span><span class="token punctuation">,</span><span class="token number">420322</span><span class="token punctuation">,</span><span class="token number">420323</span><span class="token punctuation">,</span><span class="token number">420324</span><span class="token punctuation">,</span><span class="token number">420325</span><span class="token punctuation">,</span><span class="token number">420381</span><span class="token punctuation">,</span><span class="token number">420501</span><span class="token punctuation">,</span><span class="token number">420502</span><span class="token punctuation">,</span><span class="token number">420503</span><span class="token punctuation">,</span><span class="token number">420504</span><span class="token punctuation">,</span><span class="token number">420505</span><span class="token punctuation">,</span><span class="token number">420521</span><span class="token punctuation">,</span><span class="token number">420525</span><span class="token punctuation">,</span><span class="token number">420526</span><span class="token punctuation">,</span><span class="token number">420527</span><span class="token punctuation">,</span><span class="token number">420528</span><span class="token punctuation">,</span><span class="token number">420529</span><span class="token punctuation">,</span><span class="token number">420581</span><span class="token punctuation">,</span><span class="token number">420582</span><span class="token punctuation">,</span><span class="token number">420583</span><span class="token punctuation">,</span><span class="token number">420601</span><span class="token punctuation">,</span><span class="token number">420602</span><span class="token punctuation">,</span><span class="token number">420606</span><span class="token punctuation">,</span><span class="token number">420621</span><span class="token punctuation">,</span><span class="token number">420624</span><span class="token punctuation">,</span><span class="token number">420625</span><span class="token punctuation">,</span><span class="token number">420626</span><span class="token punctuation">,</span><span class="token number">420682</span><span class="token punctuation">,</span><span class="token number">420683</span><span class="token punctuation">,</span><span class="token number">420684</span><span class="token punctuation">,</span><span class="token number">420701</span><span class="token punctuation">,</span><span class="token number">420702</span><span class="token punctuation">,</span><span class="token number">420703</span><span class="token punctuation">,</span><span class="token number">420704</span><span class="token punctuation">,</span><span class="token number">420801</span><span class="token punctuation">,</span><span class="token number">420802</span><span class="token punctuation">,</span><span class="token number">420821</span><span class="token punctuation">,</span><span class="token number">420822</span><span class="token punctuation">,</span><span class="token number">420881</span><span class="token punctuation">,</span><span class="token number">420901</span><span class="token punctuation">,</span><span class="token number">420902</span><span class="token punctuation">,</span><span class="token number">420921</span><span class="token punctuation">,</span><span class="token number">420922</span><span class="token punctuation">,</span><span class="token number">420923</span><span class="token punctuation">,</span><span class="token number">420981</span><span class="token punctuation">,</span><span class="token number">420982</span><span class="token punctuation">,</span><span class="token number">420984</span><span class="token punctuation">,</span><span class="token number">421001</span><span class="token punctuation">,</span><span class="token number">421002</span><span class="token punctuation">,</span><span class="token number">421003</span><span class="token punctuation">,</span><span class="token number">421022</span><span class="token punctuation">,</span><span class="token number">421023</span><span class="token punctuation">,</span><span class="token number">421024</span><span class="token punctuation">,</span><span class="token number">421081</span><span class="token punctuation">,</span><span class="token number">421083</span><span class="token punctuation">,</span><span class="token number">421087</span><span class="token punctuation">,</span><span class="token number">421101</span><span class="token punctuation">,</span><span class="token number">421102</span><span class="token punctuation">,</span><span class="token number">421121</span><span class="token punctuation">,</span><span class="token number">421122</span><span class="token punctuation">,</span><span class="token number">421123</span><span class="token punctuation">,</span><span class="token number">421124</span><span class="token punctuation">,</span><span class="token number">421125</span><span class="token punctuation">,</span><span class="token number">421126</span><span class="token punctuation">,</span><span class="token number">421127</span><span class="token punctuation">,</span><span class="token number">421181</span><span class="token punctuation">,</span><span class="token number">421182</span><span class="token punctuation">,</span><span class="token number">421201</span><span class="token punctuation">,</span><span class="token number">421202</span><span class="token punctuation">,</span><span class="token number">421221</span><span class="token punctuation">,</span><span class="token number">421222</span><span class="token punctuation">,</span><span class="token number">421223</span><span class="token punctuation">,</span><span class="token number">421224</span><span class="token punctuation">,</span><span class="token number">421281</span><span class="token punctuation">,</span><span class="token number">421301</span><span class="token punctuation">,</span><span class="token number">421302</span><span class="token punctuation">,</span><span class="token number">421381</span><span class="token punctuation">,</span><span class="token number">422801</span><span class="token punctuation">,</span><span class="token number">422802</span><span class="token punctuation">,</span><span class="token number">422822</span><span class="token punctuation">,</span><span class="token number">422823</span><span class="token punctuation">,</span><span class="token number">422825</span><span class="token punctuation">,</span><span class="token number">422826</span><span class="token punctuation">,</span><span class="token number">422827</span><span class="token punctuation">,</span><span class="token number">422828</span><span class="token punctuation">,</span><span class="token number">429004</span><span class="token punctuation">,</span><span class="token number">429005</span><span class="token punctuation">,</span><span class="token number">429006</span><span class="token punctuation">,</span><span class="token number">429021</span><span class="token punctuation">,</span><span class="token number">430101</span><span class="token punctuation">,</span><span class="token number">430102</span><span class="token punctuation">,</span><span class="token number">430103</span><span class="token punctuation">,</span><span class="token number">430104</span><span class="token punctuation">,</span><span class="token number">430105</span><span class="token punctuation">,</span><span class="token number">430111</span><span class="token punctuation">,</span><span class="token number">430121</span><span class="token punctuation">,</span><span class="token number">430122</span><span class="token punctuation">,</span><span class="token number">430124</span><span class="token punctuation">,</span><span class="token number">430181</span><span class="token punctuation">,</span><span class="token number">430201</span><span class="token punctuation">,</span><span class="token number">430202</span><span class="token punctuation">,</span><span class="token number">430203</span><span class="token punctuation">,</span><span class="token number">430204</span><span class="token punctuation">,</span><span class="token number">430211</span><span class="token punctuation">,</span><span class="token number">430221</span><span class="token punctuation">,</span><span class="token number">430223</span><span class="token punctuation">,</span><span class="token number">430224</span><span class="token punctuation">,</span><span class="token number">430225</span><span class="token punctuation">,</span><span class="token number">430281</span><span class="token punctuation">,</span><span class="token number">430301</span><span class="token punctuation">,</span><span class="token number">430302</span><span class="token punctuation">,</span><span class="token number">430304</span><span class="token punctuation">,</span><span class="token number">430321</span><span class="token punctuation">,</span><span class="token number">430381</span><span class="token punctuation">,</span><span class="token number">430382</span><span class="token punctuation">,</span><span class="token number">430401</span><span class="token punctuation">,</span><span class="token number">430402</span><span class="token punctuation">,</span><span class="token number">430403</span><span class="token punctuation">,</span><span class="token number">430404</span><span class="token punctuation">,</span><span class="token number">430411</span><span class="token punctuation">,</span><span class="token number">430412</span><span class="token punctuation">,</span><span class="token number">430421</span><span class="token punctuation">,</span><span class="token number">430422</span><span class="token punctuation">,</span><span class="token number">430423</span><span class="token punctuation">,</span><span class="token number">430424</span><span class="token punctuation">,</span><span class="token number">430426</span><span class="token punctuation">,</span><span class="token number">430481</span><span class="token punctuation">,</span><span class="token number">430482</span><span class="token punctuation">,</span><span class="token number">430501</span><span class="token punctuation">,</span><span class="token number">430502</span><span class="token punctuation">,</span><span class="token number">430503</span><span class="token punctuation">,</span><span class="token number">430511</span><span class="token punctuation">,</span><span class="token number">430521</span><span class="token punctuation">,</span><span class="token number">430522</span><span class="token punctuation">,</span><span class="token number">430523</span><span class="token punctuation">,</span><span class="token number">430524</span><span class="token punctuation">,</span><span class="token number">430525</span><span class="token punctuation">,</span><span class="token number">430527</span><span class="token punctuation">,</span><span class="token number">430528</span><span class="token punctuation">,</span><span class="token number">430529</span><span class="token punctuation">,</span><span class="token number">430581</span><span class="token punctuation">,</span><span class="token number">430601</span><span class="token punctuation">,</span><span class="token number">430602</span><span class="token punctuation">,</span><span class="token number">430603</span><span class="token punctuation">,</span><span class="token number">430611</span><span class="token punctuation">,</span><span class="token number">430621</span><span class="token punctuation">,</span><span class="token number">430623</span><span class="token punctuation">,</span><span class="token number">430624</span><span class="token punctuation">,</span><span class="token number">430626</span><span class="token punctuation">,</span><span class="token number">430681</span><span class="token punctuation">,</span><span class="token number">430682</span><span class="token punctuation">,</span><span class="token number">430701</span><span class="token punctuation">,</span><span class="token number">430702</span><span class="token punctuation">,</span><span class="token number">430703</span><span class="token punctuation">,</span><span class="token number">430721</span><span class="token punctuation">,</span><span class="token number">430722</span><span class="token punctuation">,</span><span class="token number">430723</span><span class="token punctuation">,</span><span class="token number">430724</span><span class="token punctuation">,</span><span class="token number">430725</span><span class="token punctuation">,</span><span class="token number">430726</span><span class="token punctuation">,</span><span class="token number">430781</span><span class="token punctuation">,</span><span class="token number">430801</span><span class="token punctuation">,</span><span class="token number">430802</span><span class="token punctuation">,</span><span class="token number">430811</span><span class="token punctuation">,</span><span class="token number">430821</span><span class="token punctuation">,</span><span class="token number">430822</span><span class="token punctuation">,</span><span class="token number">430901</span><span class="token punctuation">,</span><span class="token number">430902</span><span class="token punctuation">,</span><span class="token number">430903</span><span class="token punctuation">,</span><span class="token number">430921</span><span class="token punctuation">,</span><span class="token number">430922</span><span class="token punctuation">,</span><span class="token number">430923</span><span class="token punctuation">,</span><span class="token number">430981</span><span class="token punctuation">,</span><span class="token number">431001</span><span class="token punctuation">,</span><span class="token number">431002</span><span class="token punctuation">,</span><span class="token number">431003</span><span class="token punctuation">,</span><span class="token number">431021</span><span class="token punctuation">,</span><span class="token number">431022</span><span class="token punctuation">,</span><span class="token number">431023</span><span class="token punctuation">,</span><span class="token number">431024</span><span class="token punctuation">,</span><span class="token number">431025</span><span class="token punctuation">,</span><span class="token number">431026</span><span class="token punctuation">,</span><span class="token number">431027</span><span class="token punctuation">,</span><span class="token number">431028</span><span class="token punctuation">,</span><span class="token number">431081</span><span class="token punctuation">,</span><span class="token number">431101</span><span class="token punctuation">,</span><span class="token number">431102</span><span class="token punctuation">,</span><span class="token number">431103</span><span class="token punctuation">,</span><span class="token number">431121</span><span class="token punctuation">,</span><span class="token number">431122</span><span class="token punctuation">,</span><span class="token number">431123</span><span class="token punctuation">,</span><span class="token number">431124</span><span class="token punctuation">,</span><span class="token number">431125</span><span class="token punctuation">,</span><span class="token number">431126</span><span class="token punctuation">,</span><span class="token number">431127</span><span class="token punctuation">,</span><span class="token number">431128</span><span class="token punctuation">,</span><span class="token number">431129</span><span class="token punctuation">,</span><span class="token number">431201</span><span class="token punctuation">,</span><span class="token number">431202</span><span class="token punctuation">,</span><span class="token number">431221</span><span class="token punctuation">,</span><span class="token number">431222</span><span class="token punctuation">,</span><span class="token number">431223</span><span class="token punctuation">,</span><span class="token number">431224</span><span class="token punctuation">,</span><span class="token number">431225</span><span class="token punctuation">,</span><span class="token number">431226</span><span class="token punctuation">,</span><span class="token number">431227</span><span class="token punctuation">,</span><span class="token number">431228</span><span class="token punctuation">,</span><span class="token number">431229</span><span class="token punctuation">,</span><span class="token number">431230</span><span class="token punctuation">,</span><span class="token number">431281</span><span class="token punctuation">,</span><span class="token number">431301</span><span class="token punctuation">,</span><span class="token number">431302</span><span class="token punctuation">,</span><span class="token number">431321</span><span class="token punctuation">,</span><span class="token number">431322</span><span class="token punctuation">,</span><span class="token number">431381</span><span class="token punctuation">,</span><span class="token number">431382</span><span class="token punctuation">,</span><span class="token number">433101</span><span class="token punctuation">,</span><span class="token number">433122</span><span class="token punctuation">,</span><span class="token number">433123</span><span class="token punctuation">,</span><span class="token number">433124</span><span class="token punctuation">,</span><span class="token number">433125</span><span class="token punctuation">,</span><span class="token number">433126</span><span class="token punctuation">,</span><span class="token number">433127</span><span class="token punctuation">,</span><span class="token number">433130</span><span class="token punctuation">,</span><span class="token number">440101</span><span class="token punctuation">,</span><span class="token number">440102</span><span class="token punctuation">,</span><span class="token number">440103</span><span class="token punctuation">,</span><span class="token number">440104</span><span class="token punctuation">,</span><span class="token number">440105</span><span class="token punctuation">,</span><span class="token number">440106</span><span class="token punctuation">,</span><span class="token number">440107</span><span class="token punctuation">,</span><span class="token number">440111</span><span class="token punctuation">,</span><span class="token number">440112</span><span class="token punctuation">,</span><span class="token number">440113</span><span class="token punctuation">,</span><span class="token number">440114</span><span class="token punctuation">,</span><span class="token number">440183</span><span class="token punctuation">,</span><span class="token number">440184</span><span class="token punctuation">,</span><span class="token number">440201</span><span class="token punctuation">,</span><span class="token number">440202</span><span class="token punctuation">,</span><span class="token number">440203</span><span class="token punctuation">,</span><span class="token number">440204</span><span class="token punctuation">,</span><span class="token number">440221</span><span class="token punctuation">,</span><span class="token number">440222</span><span class="token punctuation">,</span><span class="token number">440224</span><span class="token punctuation">,</span><span class="token number">440229</span><span class="token punctuation">,</span><span class="token number">440232</span><span class="token punctuation">,</span><span class="token number">440233</span><span class="token punctuation">,</span><span class="token number">440281</span><span class="token punctuation">,</span><span class="token number">440282</span><span class="token punctuation">,</span><span class="token number">440301</span><span class="token punctuation">,</span><span class="token number">440303</span><span class="token punctuation">,</span><span class="token number">440304</span><span class="token punctuation">,</span><span class="token number">440305</span><span class="token punctuation">,</span><span class="token number">440306</span><span class="token punctuation">,</span><span class="token number">440307</span><span class="token punctuation">,</span><span class="token number">440308</span><span class="token punctuation">,</span><span class="token number">440401</span><span class="token punctuation">,</span><span class="token number">440402</span><span class="token punctuation">,</span><span class="token number">440421</span><span class="token punctuation">,</span><span class="token number">440501</span><span class="token punctuation">,</span><span class="token number">440506</span><span class="token punctuation">,</span><span class="token number">440507</span><span class="token punctuation">,</span><span class="token number">440508</span><span class="token punctuation">,</span><span class="token number">440509</span><span class="token punctuation">,</span><span class="token number">440510</span><span class="token punctuation">,</span><span class="token number">440523</span><span class="token punctuation">,</span><span class="token number">440582</span><span class="token punctuation">,</span><span class="token number">440583</span><span class="token punctuation">,</span><span class="token number">440601</span><span class="token punctuation">,</span><span class="token number">440602</span><span class="token punctuation">,</span><span class="token number">440603</span><span class="token punctuation">,</span><span class="token number">440681</span><span class="token punctuation">,</span><span class="token number">440682</span><span class="token punctuation">,</span><span class="token number">440683</span><span class="token punctuation">,</span><span class="token number">440684</span><span class="token punctuation">,</span><span class="token number">440701</span><span class="token punctuation">,</span><span class="token number">440703</span><span class="token punctuation">,</span><span class="token number">440704</span><span class="token punctuation">,</span><span class="token number">440781</span><span class="token punctuation">,</span><span class="token number">440782</span><span class="token punctuation">,</span><span class="token number">440783</span><span class="token punctuation">,</span><span class="token number">440784</span><span class="token punctuation">,</span><span class="token number">440785</span><span class="token punctuation">,</span><span class="token number">440801</span><span class="token punctuation">,</span><span class="token number">440802</span><span class="token punctuation">,</span><span class="token number">440803</span><span class="token punctuation">,</span><span class="token number">440804</span><span class="token punctuation">,</span><span class="token number">440811</span><span class="token punctuation">,</span><span class="token number">440823</span><span class="token punctuation">,</span><span class="token number">440825</span><span class="token punctuation">,</span><span class="token number">440881</span><span class="token punctuation">,</span><span class="token number">440882</span><span class="token punctuation">,</span><span class="token number">440883</span><span class="token punctuation">,</span><span class="token number">440901</span><span class="token punctuation">,</span><span class="token number">440902</span><span class="token punctuation">,</span><span class="token number">440923</span><span class="token punctuation">,</span><span class="token number">440981</span><span class="token punctuation">,</span><span class="token number">440982</span><span class="token punctuation">,</span><span class="token number">440983</span><span class="token punctuation">,</span><span class="token number">441201</span><span class="token punctuation">,</span><span class="token number">441202</span><span class="token punctuation">,</span><span class="token number">441203</span><span class="token punctuation">,</span><span class="token number">441223</span><span class="token punctuation">,</span><span class="token number">441224</span><span class="token punctuation">,</span><span class="token number">441225</span><span class="token punctuation">,</span><span class="token number">441226</span><span class="token punctuation">,</span><span class="token number">441283</span><span class="token punctuation">,</span><span class="token number">441284</span><span class="token punctuation">,</span><span class="token number">441301</span><span class="token punctuation">,</span><span class="token number">441302</span><span class="token punctuation">,</span><span class="token number">441322</span><span class="token punctuation">,</span><span class="token number">441323</span><span class="token punctuation">,</span><span class="token number">441324</span><span class="token punctuation">,</span><span class="token number">441381</span><span class="token punctuation">,</span><span class="token number">441401</span><span class="token punctuation">,</span><span class="token number">441402</span><span class="token punctuation">,</span><span class="token number">441421</span><span class="token punctuation">,</span><span class="token number">441422</span><span class="token punctuation">,</span><span class="token number">441423</span><span class="token punctuation">,</span><span class="token number">441424</span><span class="token punctuation">,</span><span class="token number">441426</span><span class="token punctuation">,</span><span class="token number">441427</span><span class="token punctuation">,</span><span class="token number">441481</span><span class="token punctuation">,</span><span class="token number">441501</span><span class="token punctuation">,</span><span class="token number">441502</span><span class="token punctuation">,</span><span class="token number">441521</span><span class="token punctuation">,</span><span class="token number">441523</span><span class="token punctuation">,</span><span class="token number">441581</span><span class="token punctuation">,</span><span class="token number">441601</span><span class="token punctuation">,</span><span class="token number">441602</span><span class="token punctuation">,</span><span class="token number">441621</span><span class="token punctuation">,</span><span class="token number">441622</span><span class="token punctuation">,</span><span class="token number">441623</span><span class="token punctuation">,</span><span class="token number">441624</span><span class="token punctuation">,</span><span class="token number">441625</span><span class="token punctuation">,</span><span class="token number">441701</span><span class="token punctuation">,</span><span class="token number">441702</span><span class="token punctuation">,</span><span class="token number">441721</span><span class="token punctuation">,</span><span class="token number">441723</span><span class="token punctuation">,</span><span class="token number">441781</span><span class="token punctuation">,</span><span class="token number">441801</span><span class="token punctuation">,</span><span class="token number">441802</span><span class="token punctuation">,</span><span class="token number">441821</span><span class="token punctuation">,</span><span class="token number">441823</span><span class="token punctuation">,</span><span class="token number">441825</span><span class="token punctuation">,</span><span class="token number">441826</span><span class="token punctuation">,</span><span class="token number">441827</span><span class="token punctuation">,</span><span class="token number">441881</span><span class="token punctuation">,</span><span class="token number">441882</span><span class="token punctuation">,</span><span class="token number">441901</span><span class="token punctuation">,</span><span class="token number">441902</span><span class="token punctuation">,</span><span class="token number">441903</span><span class="token punctuation">,</span><span class="token number">441904</span><span class="token punctuation">,</span><span class="token number">442001</span><span class="token punctuation">,</span><span class="token number">442002</span><span class="token punctuation">,</span><span class="token number">442003</span><span class="token punctuation">,</span><span class="token number">442004</span><span class="token punctuation">,</span><span class="token number">442005</span><span class="token punctuation">,</span><span class="token number">445101</span><span class="token punctuation">,</span><span class="token number">445102</span><span class="token punctuation">,</span><span class="token number">445121</span><span class="token punctuation">,</span><span class="token number">445122</span><span class="token punctuation">,</span><span class="token number">445201</span><span class="token punctuation">,</span><span class="token number">445202</span><span class="token punctuation">,</span><span class="token number">445221</span><span class="token punctuation">,</span><span class="token number">445222</span><span class="token punctuation">,</span><span class="token number">445224</span><span class="token punctuation">,</span><span class="token number">445281</span><span class="token punctuation">,</span><span class="token number">445301</span><span class="token punctuation">,</span><span class="token number">445302</span><span class="token punctuation">,</span><span class="token number">445321</span><span class="token punctuation">,</span><span class="token number">445322</span><span class="token punctuation">,</span><span class="token number">445323</span><span class="token punctuation">,</span><span class="token number">445381</span><span class="token punctuation">,</span><span class="token number">450101</span><span class="token punctuation">,</span><span class="token number">450102</span><span class="token punctuation">,</span><span class="token number">450103</span><span class="token punctuation">,</span><span class="token number">450104</span><span class="token punctuation">,</span><span class="token number">450105</span><span class="token punctuation">,</span><span class="token number">450106</span><span class="token punctuation">,</span><span class="token number">450111</span><span class="token punctuation">,</span><span class="token number">450121</span><span class="token punctuation">,</span><span class="token number">450122</span><span class="token punctuation">,</span><span class="token number">450201</span><span class="token punctuation">,</span><span class="token number">450202</span><span class="token punctuation">,</span><span class="token number">450203</span><span class="token punctuation">,</span><span class="token number">450204</span><span class="token punctuation">,</span><span class="token number">450205</span><span class="token punctuation">,</span><span class="token number">450211</span><span class="token punctuation">,</span><span class="token number">450221</span><span class="token punctuation">,</span><span class="token number">450222</span><span class="token punctuation">,</span><span class="token number">450301</span><span class="token punctuation">,</span><span class="token number">450302</span><span class="token punctuation">,</span><span class="token number">450303</span><span class="token punctuation">,</span><span class="token number">450304</span><span class="token punctuation">,</span><span class="token number">450305</span><span class="token punctuation">,</span><span class="token number">450311</span><span class="token punctuation">,</span><span class="token number">450321</span><span class="token punctuation">,</span><span class="token number">450322</span><span class="token punctuation">,</span><span class="token number">450323</span><span class="token punctuation">,</span><span class="token number">450324</span><span class="token punctuation">,</span><span class="token number">450325</span><span class="token punctuation">,</span><span class="token number">450326</span><span class="token punctuation">,</span><span class="token number">450327</span><span class="token punctuation">,</span><span class="token number">450328</span><span class="token punctuation">,</span><span class="token number">450329</span><span class="token punctuation">,</span><span class="token number">450330</span><span class="token punctuation">,</span><span class="token number">450331</span><span class="token punctuation">,</span><span class="token number">450332</span><span class="token punctuation">,</span><span class="token number">450401</span><span class="token punctuation">,</span><span class="token number">450403</span><span class="token punctuation">,</span><span class="token number">450404</span><span class="token punctuation">,</span><span class="token number">450411</span><span class="token punctuation">,</span><span class="token number">450421</span><span class="token punctuation">,</span><span class="token number">450422</span><span class="token punctuation">,</span><span class="token number">450423</span><span class="token punctuation">,</span><span class="token number">450481</span><span class="token punctuation">,</span><span class="token number">450501</span><span class="token punctuation">,</span><span class="token number">450502</span><span class="token punctuation">,</span><span class="token number">450503</span><span class="token punctuation">,</span><span class="token number">450512</span><span class="token punctuation">,</span><span class="token number">450521</span><span class="token punctuation">,</span><span class="token number">450601</span><span class="token punctuation">,</span><span class="token number">450602</span><span class="token punctuation">,</span><span class="token number">450603</span><span class="token punctuation">,</span><span class="token number">450621</span><span class="token punctuation">,</span><span class="token number">450681</span><span class="token punctuation">,</span><span class="token number">450701</span><span class="token punctuation">,</span><span class="token number">450702</span><span class="token punctuation">,</span><span class="token number">450703</span><span class="token punctuation">,</span><span class="token number">450721</span><span class="token punctuation">,</span><span class="token number">450722</span><span class="token punctuation">,</span><span class="token number">450801</span><span class="token punctuation">,</span><span class="token number">450802</span><span class="token punctuation">,</span><span class="token number">450803</span><span class="token punctuation">,</span><span class="token number">450821</span><span class="token punctuation">,</span><span class="token number">450881</span><span class="token punctuation">,</span><span class="token number">450901</span><span class="token punctuation">,</span><span class="token number">450902</span><span class="token punctuation">,</span><span class="token number">450921</span><span class="token punctuation">,</span><span class="token number">450922</span><span class="token punctuation">,</span><span class="token number">450923</span><span class="token punctuation">,</span><span class="token number">450924</span><span class="token punctuation">,</span><span class="token number">450981</span><span class="token punctuation">,</span><span class="token number">452101</span><span class="token punctuation">,</span><span class="token number">452122</span><span class="token punctuation">,</span><span class="token number">452123</span><span class="token punctuation">,</span><span class="token number">452124</span><span class="token punctuation">,</span><span class="token number">452126</span><span class="token punctuation">,</span><span class="token number">452127</span><span class="token punctuation">,</span><span class="token number">452128</span><span class="token punctuation">,</span><span class="token number">452129</span><span class="token punctuation">,</span><span class="token number">452130</span><span class="token punctuation">,</span><span class="token number">452131</span><span class="token punctuation">,</span><span class="token number">452132</span><span class="token punctuation">,</span><span class="token number">452133</span><span class="token punctuation">,</span><span class="token number">452201</span><span class="token punctuation">,</span><span class="token number">452223</span><span class="token punctuation">,</span><span class="token number">452224</span><span class="token punctuation">,</span><span class="token number">452225</span><span class="token punctuation">,</span><span class="token number">452226</span><span class="token punctuation">,</span><span class="token number">452227</span><span class="token punctuation">,</span><span class="token number">452228</span><span class="token punctuation">,</span><span class="token number">452229</span><span class="token punctuation">,</span><span class="token number">452230</span><span class="token punctuation">,</span><span class="token number">452231</span><span class="token punctuation">,</span><span class="token number">452402</span><span class="token punctuation">,</span><span class="token number">452424</span><span class="token punctuation">,</span><span class="token number">452427</span><span class="token punctuation">,</span><span class="token number">452428</span><span class="token punctuation">,</span><span class="token number">452601</span><span class="token punctuation">,</span><span class="token number">452622</span><span class="token punctuation">,</span><span class="token number">452623</span><span class="token punctuation">,</span><span class="token number">452624</span><span class="token punctuation">,</span><span class="token number">452625</span><span class="token punctuation">,</span><span class="token number">452626</span><span class="token punctuation">,</span><span class="token number">452627</span><span class="token punctuation">,</span><span class="token number">452628</span><span class="token punctuation">,</span><span class="token number">452629</span><span class="token punctuation">,</span><span class="token number">452630</span><span class="token punctuation">,</span><span class="token number">452631</span><span class="token punctuation">,</span><span class="token number">452632</span><span class="token punctuation">,</span><span class="token number">452701</span><span class="token punctuation">,</span><span class="token number">452702</span><span class="token punctuation">,</span><span class="token number">452723</span><span class="token punctuation">,</span><span class="token number">452724</span><span class="token punctuation">,</span><span class="token number">452725</span><span class="token punctuation">,</span><span class="token number">452726</span><span class="token punctuation">,</span><span class="token number">452727</span><span class="token punctuation">,</span><span class="token number">452728</span><span class="token punctuation">,</span><span class="token number">452729</span><span class="token punctuation">,</span><span class="token number">452730</span><span class="token punctuation">,</span><span class="token number">452731</span><span class="token punctuation">,</span><span class="token number">460101</span><span class="token punctuation">,</span><span class="token number">460102</span><span class="token punctuation">,</span><span class="token number">460103</span><span class="token punctuation">,</span><span class="token number">460104</span><span class="token punctuation">,</span><span class="token number">460105</span><span class="token punctuation">,</span><span class="token number">460106</span><span class="token punctuation">,</span><span class="token number">460107</span><span class="token punctuation">,</span><span class="token number">460125</span><span class="token punctuation">,</span><span class="token number">460126</span><span class="token punctuation">,</span><span class="token number">460127</span><span class="token punctuation">,</span><span class="token number">460128</span><span class="token punctuation">,</span><span class="token number">460130</span><span class="token punctuation">,</span><span class="token number">460131</span><span class="token punctuation">,</span><span class="token number">460133</span><span class="token punctuation">,</span><span class="token number">460134</span><span class="token punctuation">,</span><span class="token number">460135</span><span class="token punctuation">,</span><span class="token number">460136</span><span class="token punctuation">,</span><span class="token number">460137</span><span class="token punctuation">,</span><span class="token number">460138</span><span class="token punctuation">,</span><span class="token number">460139</span><span class="token punctuation">,</span><span class="token number">460201</span><span class="token punctuation">,</span><span class="token number">460202</span><span class="token punctuation">,</span><span class="token number">460203</span><span class="token punctuation">,</span><span class="token number">460204</span><span class="token punctuation">,</span><span class="token number">460301</span><span class="token punctuation">,</span><span class="token number">500101</span><span class="token punctuation">,</span><span class="token number">500102</span><span class="token punctuation">,</span><span class="token number">500103</span><span class="token punctuation">,</span><span class="token number">500104</span><span class="token punctuation">,</span><span class="token number">500105</span><span class="token punctuation">,</span><span class="token number">500106</span><span class="token punctuation">,</span><span class="token number">500107</span><span class="token punctuation">,</span><span class="token number">500108</span><span class="token punctuation">,</span><span class="token number">500109</span><span class="token punctuation">,</span><span class="token number">500110</span><span class="token punctuation">,</span><span class="token number">500111</span><span class="token punctuation">,</span><span class="token number">500112</span><span class="token punctuation">,</span><span class="token number">500113</span><span class="token punctuation">,</span><span class="token number">500114</span><span class="token punctuation">,</span><span class="token number">500221</span><span class="token punctuation">,</span><span class="token number">500222</span><span class="token punctuation">,</span><span class="token number">500223</span><span class="token punctuation">,</span><span class="token number">500224</span><span class="token punctuation">,</span><span class="token number">500225</span><span class="token punctuation">,</span><span class="token number">500226</span><span class="token punctuation">,</span><span class="token number">500227</span><span class="token punctuation">,</span><span class="token number">500228</span><span class="token punctuation">,</span><span class="token number">500229</span><span class="token punctuation">,</span><span class="token number">500230</span><span class="token punctuation">,</span><span class="token number">500231</span><span class="token punctuation">,</span><span class="token number">500232</span><span class="token punctuation">,</span><span class="token number">500233</span><span class="token punctuation">,</span><span class="token number">500234</span><span class="token punctuation">,</span><span class="token number">500235</span><span class="token punctuation">,</span><span class="token number">500236</span><span class="token punctuation">,</span><span class="token number">500237</span><span class="token punctuation">,</span><span class="token number">500238</span><span class="token punctuation">,</span><span class="token number">500240</span><span class="token punctuation">,</span><span class="token number">500241</span><span class="token punctuation">,</span><span class="token number">500242</span><span class="token punctuation">,</span><span class="token number">500243</span><span class="token punctuation">,</span><span class="token number">500381</span><span class="token punctuation">,</span><span class="token number">500382</span><span class="token punctuation">,</span><span class="token number">500383</span><span class="token punctuation">,</span><span class="token number">500384</span><span class="token punctuation">,</span><span class="token number">510101</span><span class="token punctuation">,</span><span class="token number">510103</span><span class="token punctuation">,</span><span class="token number">510104</span><span class="token punctuation">,</span><span class="token number">510105</span><span class="token punctuation">,</span><span class="token number">510106</span><span class="token punctuation">,</span><span class="token number">510107</span><span class="token punctuation">,</span><span class="token number">510108</span><span class="token punctuation">,</span><span class="token number">510112</span><span class="token punctuation">,</span><span class="token number">510113</span><span class="token punctuation">,</span><span class="token number">510121</span><span class="token punctuation">,</span><span class="token number">510122</span><span class="token punctuation">,</span><span class="token number">510123</span><span class="token punctuation">,</span><span class="token number">510124</span><span class="token punctuation">,</span><span class="token number">510125</span><span class="token punctuation">,</span><span class="token number">510129</span><span class="token punctuation">,</span><span class="token number">510131</span><span class="token punctuation">,</span><span class="token number">510132</span><span class="token punctuation">,</span><span class="token number">510181</span><span class="token punctuation">,</span><span class="token number">510182</span><span class="token punctuation">,</span><span class="token number">510183</span><span class="token punctuation">,</span><span class="token number">510184</span><span class="token punctuation">,</span><span class="token number">510301</span><span class="token punctuation">,</span><span class="token number">510302</span><span class="token punctuation">,</span><span class="token number">510303</span><span class="token punctuation">,</span><span class="token number">510304</span><span class="token punctuation">,</span><span class="token number">510311</span><span class="token punctuation">,</span><span class="token number">510321</span><span class="token punctuation">,</span><span class="token number">510322</span><span class="token punctuation">,</span><span class="token number">510401</span><span class="token punctuation">,</span><span class="token number">510402</span><span class="token punctuation">,</span><span class="token number">510403</span><span class="token punctuation">,</span><span class="token number">510411</span><span class="token punctuation">,</span><span class="token number">510421</span><span class="token punctuation">,</span><span class="token number">510422</span><span class="token punctuation">,</span><span class="token number">510501</span><span class="token punctuation">,</span><span class="token number">510502</span><span class="token punctuation">,</span><span class="token number">510503</span><span class="token punctuation">,</span><span class="token number">510504</span><span class="token punctuation">,</span><span class="token number">510521</span><span class="token punctuation">,</span><span class="token number">510522</span><span class="token punctuation">,</span><span class="token number">510524</span><span class="token punctuation">,</span><span class="token number">510525</span><span class="token punctuation">,</span><span class="token number">510601</span><span class="token punctuation">,</span><span class="token number">510603</span><span class="token punctuation">,</span><span class="token number">510623</span><span class="token punctuation">,</span><span class="token number">510626</span><span class="token punctuation">,</span><span class="token number">510681</span><span class="token punctuation">,</span><span class="token number">510682</span><span class="token punctuation">,</span><span class="token number">510683</span><span class="token punctuation">,</span><span class="token number">510701</span><span class="token punctuation">,</span><span class="token number">510703</span><span class="token punctuation">,</span><span class="token number">510704</span><span class="token punctuation">,</span><span class="token number">510710</span><span class="token punctuation">,</span><span class="token number">510722</span><span class="token punctuation">,</span><span class="token number">510723</span><span class="token punctuation">,</span><span class="token number">510724</span><span class="token punctuation">,</span><span class="token number">510725</span><span class="token punctuation">,</span><span class="token number">510726</span><span class="token punctuation">,</span><span class="token number">510727</span><span class="token punctuation">,</span><span class="token number">510781</span><span class="token punctuation">,</span><span class="token number">510801</span><span class="token punctuation">,</span><span class="token number">510802</span><span class="token punctuation">,</span><span class="token number">510811</span><span class="token punctuation">,</span><span class="token number">510812</span><span class="token punctuation">,</span><span class="token number">510821</span><span class="token punctuation">,</span><span class="token number">510822</span><span class="token punctuation">,</span><span class="token number">510823</span><span class="token punctuation">,</span><span class="token number">510824</span><span class="token punctuation">,</span><span class="token number">510901</span><span class="token punctuation">,</span><span class="token number">510902</span><span class="token punctuation">,</span><span class="token number">510921</span><span class="token punctuation">,</span><span class="token number">510922</span><span class="token punctuation">,</span><span class="token number">510923</span><span class="token punctuation">,</span><span class="token number">511001</span><span class="token punctuation">,</span><span class="token number">511002</span><span class="token punctuation">,</span><span class="token number">511011</span><span class="token punctuation">,</span><span class="token number">511024</span><span class="token punctuation">,</span><span class="token number">511025</span><span class="token punctuation">,</span><span class="token number">511028</span><span class="token punctuation">,</span><span class="token number">511101</span><span class="token punctuation">,</span><span class="token number">511102</span><span class="token punctuation">,</span><span class="token number">511111</span><span class="token punctuation">,</span><span class="token number">511112</span><span class="token punctuation">,</span><span class="token number">511113</span><span class="token punctuation">,</span><span class="token number">511123</span><span class="token punctuation">,</span><span class="token number">511124</span><span class="token punctuation">,</span><span class="token number">511126</span><span class="token punctuation">,</span><span class="token number">511129</span><span class="token punctuation">,</span><span class="token number">511132</span><span class="token punctuation">,</span><span class="token number">511133</span><span class="token punctuation">,</span><span class="token number">511181</span><span class="token punctuation">,</span><span class="token number">511301</span><span class="token punctuation">,</span><span class="token number">511302</span><span class="token punctuation">,</span><span class="token number">511303</span><span class="token punctuation">,</span><span class="token number">511304</span><span class="token punctuation">,</span><span class="token number">511321</span><span class="token punctuation">,</span><span class="token number">511322</span><span class="token punctuation">,</span><span class="token number">511323</span><span class="token punctuation">,</span><span class="token number">511324</span><span class="token punctuation">,</span><span class="token number">511325</span><span class="token punctuation">,</span><span class="token number">511381</span><span class="token punctuation">,</span><span class="token number">511401</span><span class="token punctuation">,</span><span class="token number">511402</span><span class="token punctuation">,</span><span class="token number">511421</span><span class="token punctuation">,</span><span class="token number">511422</span><span class="token punctuation">,</span><span class="token number">511423</span><span class="token punctuation">,</span><span class="token number">511424</span><span class="token punctuation">,</span><span class="token number">511425</span><span class="token punctuation">,</span><span class="token number">511501</span><span class="token punctuation">,</span><span class="token number">511502</span><span class="token punctuation">,</span><span class="token number">511521</span><span class="token punctuation">,</span><span class="token number">511522</span><span class="token punctuation">,</span><span class="token number">511523</span><span class="token punctuation">,</span><span class="token number">511524</span><span class="token punctuation">,</span><span class="token number">511525</span><span class="token punctuation">,</span><span class="token number">511526</span><span class="token punctuation">,</span><span class="token number">511527</span><span class="token punctuation">,</span><span class="token number">511528</span><span class="token punctuation">,</span><span class="token number">511529</span><span class="token punctuation">,</span><span class="token number">511601</span><span class="token punctuation">,</span><span class="token number">511602</span><span class="token punctuation">,</span><span class="token number">511621</span><span class="token punctuation">,</span><span class="token number">511622</span><span class="token punctuation">,</span><span class="token number">511623</span><span class="token punctuation">,</span><span class="token number">511681</span><span class="token punctuation">,</span><span class="token number">511701</span><span class="token punctuation">,</span><span class="token number">511702</span><span class="token punctuation">,</span><span class="token number">511721</span><span class="token punctuation">,</span><span class="token number">511722</span><span class="token punctuation">,</span><span class="token number">511723</span><span class="token punctuation">,</span><span class="token number">511724</span><span class="token punctuation">,</span><span class="token number">511725</span><span class="token punctuation">,</span><span class="token number">511781</span><span class="token punctuation">,</span><span class="token number">511801</span><span class="token punctuation">,</span><span class="token number">511802</span><span class="token punctuation">,</span><span class="token number">511821</span><span class="token punctuation">,</span><span class="token number">511822</span><span class="token punctuation">,</span><span class="token number">511823</span><span class="token punctuation">,</span><span class="token number">511824</span><span class="token punctuation">,</span><span class="token number">511825</span><span class="token punctuation">,</span><span class="token number">511826</span><span class="token punctuation">,</span><span class="token number">511827</span><span class="token punctuation">,</span><span class="token number">511901</span><span class="token punctuation">,</span><span class="token number">511902</span><span class="token punctuation">,</span><span class="token number">511921</span><span class="token punctuation">,</span><span class="token number">511922</span><span class="token punctuation">,</span><span class="token number">511923</span><span class="token punctuation">,</span><span class="token number">512001</span><span class="token punctuation">,</span><span class="token number">512002</span><span class="token punctuation">,</span><span class="token number">512021</span><span class="token punctuation">,</span><span class="token number">512022</span><span class="token punctuation">,</span><span class="token number">512081</span><span class="token punctuation">,</span><span class="token number">513221</span><span class="token punctuation">,</span><span class="token number">513222</span><span class="token punctuation">,</span><span class="token number">513223</span><span class="token punctuation">,</span><span class="token number">513224</span><span class="token punctuation">,</span><span class="token number">513225</span><span class="token punctuation">,</span><span class="token number">513226</span><span class="token punctuation">,</span><span class="token number">513227</span><span class="token punctuation">,</span><span class="token number">513228</span><span class="token punctuation">,</span><span class="token number">513229</span><span class="token punctuation">,</span><span class="token number">513230</span><span class="token punctuation">,</span><span class="token number">513231</span><span class="token punctuation">,</span><span class="token number">513232</span><span class="token punctuation">,</span><span class="token number">513233</span><span class="token punctuation">,</span><span class="token number">513321</span><span class="token punctuation">,</span><span class="token number">513322</span><span class="token punctuation">,</span><span class="token number">513323</span><span class="token punctuation">,</span><span class="token number">513324</span><span class="token punctuation">,</span><span class="token number">513325</span><span class="token punctuation">,</span><span class="token number">513326</span><span class="token punctuation">,</span><span class="token number">513327</span><span class="token punctuation">,</span><span class="token number">513328</span><span class="token punctuation">,</span><span class="token number">513329</span><span class="token punctuation">,</span><span class="token number">513330</span><span class="token punctuation">,</span><span class="token number">513331</span><span class="token punctuation">,</span><span class="token number">513332</span><span class="token punctuation">,</span><span class="token number">513333</span><span class="token punctuation">,</span><span class="token number">513334</span><span class="token punctuation">,</span><span class="token number">513335</span><span class="token punctuation">,</span><span class="token number">513336</span><span class="token punctuation">,</span><span class="token number">513337</span><span class="token punctuation">,</span><span class="token number">513338</span><span class="token punctuation">,</span><span class="token number">513401</span><span class="token punctuation">,</span><span class="token number">513422</span><span class="token punctuation">,</span><span class="token number">513423</span><span class="token punctuation">,</span><span class="token number">513424</span><span class="token punctuation">,</span><span class="token number">513425</span><span class="token punctuation">,</span><span class="token number">513426</span><span class="token punctuation">,</span><span class="token number">513427</span><span class="token punctuation">,</span><span class="token number">513428</span><span class="token punctuation">,</span><span class="token number">513429</span><span class="token punctuation">,</span><span class="token number">513430</span><span class="token punctuation">,</span><span class="token number">513431</span><span class="token punctuation">,</span><span class="token number">513432</span><span class="token punctuation">,</span><span class="token number">513433</span><span class="token punctuation">,</span><span class="token number">513434</span><span class="token punctuation">,</span><span class="token number">513435</span><span class="token punctuation">,</span><span class="token number">513436</span><span class="token punctuation">,</span><span class="token number">513437</span><span class="token punctuation">,</span><span class="token number">520101</span><span class="token punctuation">,</span><span class="token number">520102</span><span class="token punctuation">,</span><span class="token number">520103</span><span class="token punctuation">,</span><span class="token number">520111</span><span class="token punctuation">,</span><span class="token number">520112</span><span class="token punctuation">,</span><span class="token number">520113</span><span class="token punctuation">,</span><span class="token number">520114</span><span class="token punctuation">,</span><span class="token number">520121</span><span class="token punctuation">,</span><span class="token number">520122</span><span class="token punctuation">,</span><span class="token number">520123</span><span class="token punctuation">,</span><span class="token number">520181</span><span class="token punctuation">,</span><span class="token number">520201</span><span class="token punctuation">,</span><span class="token number">520203</span><span class="token punctuation">,</span><span class="token number">520221</span><span class="token punctuation">,</span><span class="token number">520222</span><span class="token punctuation">,</span><span class="token number">520301</span><span class="token punctuation">,</span><span class="token number">520302</span><span class="token punctuation">,</span><span class="token number">520321</span><span class="token punctuation">,</span><span class="token number">520322</span><span class="token punctuation">,</span><span class="token number">520323</span><span class="token punctuation">,</span><span class="token number">520324</span><span class="token punctuation">,</span><span class="token number">520325</span><span class="token punctuation">,</span><span class="token number">520326</span><span class="token punctuation">,</span><span class="token number">520327</span><span class="token punctuation">,</span><span class="token number">520328</span><span class="token punctuation">,</span><span class="token number">520329</span><span class="token punctuation">,</span><span class="token number">520330</span><span class="token punctuation">,</span><span class="token number">520381</span><span class="token punctuation">,</span><span class="token number">520382</span><span class="token punctuation">,</span><span class="token number">520401</span><span class="token punctuation">,</span><span class="token number">520402</span><span class="token punctuation">,</span><span class="token number">520421</span><span class="token punctuation">,</span><span class="token number">520422</span><span class="token punctuation">,</span><span class="token number">520423</span><span class="token punctuation">,</span><span class="token number">520424</span><span class="token punctuation">,</span><span class="token number">520425</span><span class="token punctuation">,</span><span class="token number">522201</span><span class="token punctuation">,</span><span class="token number">522222</span><span class="token punctuation">,</span><span class="token number">522223</span><span class="token punctuation">,</span><span class="token number">522224</span><span class="token punctuation">,</span><span class="token number">522225</span><span class="token punctuation">,</span><span class="token number">522226</span><span class="token punctuation">,</span><span class="token number">522227</span><span class="token punctuation">,</span><span class="token number">522228</span><span class="token punctuation">,</span><span class="token number">522229</span><span class="token punctuation">,</span><span class="token number">522230</span><span class="token punctuation">,</span><span class="token number">522301</span><span class="token punctuation">,</span><span class="token number">522322</span><span class="token punctuation">,</span><span class="token number">522323</span><span class="token punctuation">,</span><span class="token number">522324</span><span class="token punctuation">,</span><span class="token number">522325</span><span class="token punctuation">,</span><span class="token number">522326</span><span class="token punctuation">,</span><span class="token number">522327</span><span class="token punctuation">,</span><span class="token number">522328</span><span class="token punctuation">,</span><span class="token number">522401</span><span class="token punctuation">,</span><span class="token number">522422</span><span class="token punctuation">,</span><span class="token number">522423</span><span class="token punctuation">,</span><span class="token number">522424</span><span class="token punctuation">,</span><span class="token number">522425</span><span class="token punctuation">,</span><span class="token number">522426</span><span class="token punctuation">,</span><span class="token number">522427</span><span class="token punctuation">,</span><span class="token number">522428</span><span class="token punctuation">,</span><span class="token number">522601</span><span class="token punctuation">,</span><span class="token number">522622</span><span class="token punctuation">,</span><span class="token number">522623</span><span class="token punctuation">,</span><span class="token number">522624</span><span class="token punctuation">,</span><span class="token number">522625</span><span class="token punctuation">,</span><span class="token number">522626</span><span class="token punctuation">,</span><span class="token number">522627</span><span class="token punctuation">,</span><span class="token number">522628</span><span class="token punctuation">,</span><span class="token number">522629</span><span class="token punctuation">,</span><span class="token number">522630</span><span class="token punctuation">,</span><span class="token number">522631</span><span class="token punctuation">,</span><span class="token number">522632</span><span class="token punctuation">,</span><span class="token number">522633</span><span class="token punctuation">,</span><span class="token number">522634</span><span class="token punctuation">,</span><span class="token number">522635</span><span class="token punctuation">,</span><span class="token number">522636</span><span class="token punctuation">,</span><span class="token number">522701</span><span class="token punctuation">,</span><span class="token number">522702</span><span class="token punctuation">,</span><span class="token number">522722</span><span class="token punctuation">,</span><span class="token number">522723</span><span class="token punctuation">,</span><span class="token number">522725</span><span class="token punctuation">,</span><span class="token number">522726</span><span class="token punctuation">,</span><span class="token number">522727</span><span class="token punctuation">,</span><span class="token number">522728</span><span class="token punctuation">,</span><span class="token number">522729</span><span class="token punctuation">,</span><span class="token number">522730</span><span class="token punctuation">,</span><span class="token number">522731</span><span class="token punctuation">,</span><span class="token number">522732</span><span class="token punctuation">,</span><span class="token number">530101</span><span class="token punctuation">,</span><span class="token number">530102</span><span class="token punctuation">,</span><span class="token number">530103</span><span class="token punctuation">,</span><span class="token number">530111</span><span class="token punctuation">,</span><span class="token number">530112</span><span class="token punctuation">,</span><span class="token number">530113</span><span class="token punctuation">,</span><span class="token number">530121</span><span class="token punctuation">,</span><span class="token number">530122</span><span class="token punctuation">,</span><span class="token number">530124</span><span class="token punctuation">,</span><span class="token number">530125</span><span class="token punctuation">,</span><span class="token number">530126</span><span class="token punctuation">,</span><span class="token number">530127</span><span class="token punctuation">,</span><span class="token number">530128</span><span class="token punctuation">,</span><span class="token number">530129</span><span class="token punctuation">,</span><span class="token number">530181</span><span class="token punctuation">,</span><span class="token number">530301</span><span class="token punctuation">,</span><span class="token number">530302</span><span class="token punctuation">,</span><span class="token number">530321</span><span class="token punctuation">,</span><span class="token number">530322</span><span class="token punctuation">,</span><span class="token number">530323</span><span class="token punctuation">,</span><span class="token number">530324</span><span class="token punctuation">,</span><span class="token number">530325</span><span class="token punctuation">,</span><span class="token number">530326</span><span class="token punctuation">,</span><span class="token number">530328</span><span class="token punctuation">,</span><span class="token number">530381</span><span class="token punctuation">,</span><span class="token number">530401</span><span class="token punctuation">,</span><span class="token number">530402</span><span class="token punctuation">,</span><span class="token number">530421</span><span class="token punctuation">,</span><span class="token number">530422</span><span class="token punctuation">,</span><span class="token number">530423</span><span class="token punctuation">,</span><span class="token number">530424</span><span class="token punctuation">,</span><span class="token number">530425</span><span class="token punctuation">,</span><span class="token number">530426</span><span class="token punctuation">,</span><span class="token number">530427</span><span class="token punctuation">,</span><span class="token number">530428</span><span class="token punctuation">,</span><span class="token number">530501</span><span class="token punctuation">,</span><span class="token number">530502</span><span class="token punctuation">,</span><span class="token number">530521</span><span class="token punctuation">,</span><span class="token number">530522</span><span class="token punctuation">,</span><span class="token number">530523</span><span class="token punctuation">,</span><span class="token number">530524</span><span class="token punctuation">,</span><span class="token number">532101</span><span class="token punctuation">,</span><span class="token number">532122</span><span class="token punctuation">,</span><span class="token number">532123</span><span class="token punctuation">,</span><span class="token number">532124</span><span class="token punctuation">,</span><span class="token number">532125</span><span class="token punctuation">,</span><span class="token number">532126</span><span class="token punctuation">,</span><span class="token number">532127</span><span class="token punctuation">,</span><span class="token number">532128</span><span class="token punctuation">,</span><span class="token number">532129</span><span class="token punctuation">,</span><span class="token number">532130</span><span class="token punctuation">,</span><span class="token number">532131</span><span class="token punctuation">,</span><span class="token number">532301</span><span class="token punctuation">,</span><span class="token number">532322</span><span class="token punctuation">,</span><span class="token number">532323</span><span class="token punctuation">,</span><span class="token number">532324</span><span class="token punctuation">,</span><span class="token number">532325</span><span class="token punctuation">,</span><span class="token number">532326</span><span class="token punctuation">,</span><span class="token number">532327</span><span class="token punctuation">,</span><span class="token number">532328</span><span class="token punctuation">,</span><span class="token number">532329</span><span class="token punctuation">,</span><span class="token number">532331</span><span class="token punctuation">,</span><span class="token number">532501</span><span class="token punctuation">,</span><span class="token number">532502</span><span class="token punctuation">,</span><span class="token number">532522</span><span class="token punctuation">,</span><span class="token number">532523</span><span class="token punctuation">,</span><span class="token number">532524</span><span class="token punctuation">,</span><span class="token number">532525</span><span class="token punctuation">,</span><span class="token number">532526</span><span class="token punctuation">,</span><span class="token number">532527</span><span class="token punctuation">,</span><span class="token number">532528</span><span class="token punctuation">,</span><span class="token number">532529</span><span class="token punctuation">,</span><span class="token number">532530</span><span class="token punctuation">,</span><span class="token number">532531</span><span class="token punctuation">,</span><span class="token number">532532</span><span class="token punctuation">,</span><span class="token number">532621</span><span class="token punctuation">,</span><span class="token number">532622</span><span class="token punctuation">,</span><span class="token number">532623</span><span class="token punctuation">,</span><span class="token number">532624</span><span class="token punctuation">,</span><span class="token number">532625</span><span class="token punctuation">,</span><span class="token number">532626</span><span class="token punctuation">,</span><span class="token number">532627</span><span class="token punctuation">,</span><span class="token number">532628</span><span class="token punctuation">,</span><span class="token number">532701</span><span class="token punctuation">,</span><span class="token number">532722</span><span class="token punctuation">,</span><span class="token number">532723</span><span class="token punctuation">,</span><span class="token number">532724</span><span class="token punctuation">,</span><span class="token number">532725</span><span class="token punctuation">,</span><span class="token number">532726</span><span class="token punctuation">,</span><span class="token number">532727</span><span class="token punctuation">,</span><span class="token number">532728</span><span class="token punctuation">,</span><span class="token number">532729</span><span class="token punctuation">,</span><span class="token number">532730</span><span class="token punctuation">,</span><span class="token number">532801</span><span class="token punctuation">,</span><span class="token number">532822</span><span class="token punctuation">,</span><span class="token number">532823</span><span class="token punctuation">,</span><span class="token number">532901</span><span class="token punctuation">,</span><span class="token number">532922</span><span class="token punctuation">,</span><span class="token number">532923</span><span class="token punctuation">,</span><span class="token number">532924</span><span class="token punctuation">,</span><span class="token number">532925</span><span class="token punctuation">,</span><span class="token number">532926</span><span class="token punctuation">,</span><span class="token number">532927</span><span class="token punctuation">,</span><span class="token number">532928</span><span class="token punctuation">,</span><span class="token number">532929</span><span class="token punctuation">,</span><span class="token number">532930</span><span class="token punctuation">,</span><span class="token number">532931</span><span class="token punctuation">,</span><span class="token number">532932</span><span class="token punctuation">,</span><span class="token number">533102</span><span class="token punctuation">,</span><span class="token number">533103</span><span class="token punctuation">,</span><span class="token number">533122</span><span class="token punctuation">,</span><span class="token number">533123</span><span class="token punctuation">,</span><span class="token number">533124</span><span class="token punctuation">,</span><span class="token number">533221</span><span class="token punctuation">,</span><span class="token number">533222</span><span class="token punctuation">,</span><span class="token number">533223</span><span class="token punctuation">,</span><span class="token number">533224</span><span class="token punctuation">,</span><span class="token number">533321</span><span class="token punctuation">,</span><span class="token number">533323</span><span class="token punctuation">,</span><span class="token number">533324</span><span class="token punctuation">,</span><span class="token number">533325</span><span class="token punctuation">,</span><span class="token number">533421</span><span class="token punctuation">,</span><span class="token number">533422</span><span class="token punctuation">,</span><span class="token number">533423</span><span class="token punctuation">,</span><span class="token number">533521</span><span class="token punctuation">,</span><span class="token number">533522</span><span class="token punctuation">,</span><span class="token number">533523</span><span class="token punctuation">,</span><span class="token number">533524</span><span class="token punctuation">,</span><span class="token number">533525</span><span class="token punctuation">,</span><span class="token number">533526</span><span class="token punctuation">,</span><span class="token number">533527</span><span class="token punctuation">,</span><span class="token number">533528</span><span class="token punctuation">,</span><span class="token number">540101</span><span class="token punctuation">,</span><span class="token number">540102</span><span class="token punctuation">,</span><span class="token number">540121</span><span class="token punctuation">,</span><span class="token number">540122</span><span class="token punctuation">,</span><span class="token number">540123</span><span class="token punctuation">,</span><span class="token number">540124</span><span class="token punctuation">,</span><span class="token number">540125</span><span class="token punctuation">,</span><span class="token number">540126</span><span class="token punctuation">,</span><span class="token number">540127</span><span class="token punctuation">,</span><span class="token number">542121</span><span class="token punctuation">,</span><span class="token number">542122</span><span class="token punctuation">,</span><span class="token number">542123</span><span class="token punctuation">,</span><span class="token number">542124</span><span class="token punctuation">,</span><span class="token number">542125</span><span class="token punctuation">,</span><span class="token number">542126</span><span class="token punctuation">,</span><span class="token number">542127</span><span class="token punctuation">,</span><span class="token number">542128</span><span class="token punctuation">,</span><span class="token number">542129</span><span class="token punctuation">,</span><span class="token number">542132</span><span class="token punctuation">,</span><span class="token number">542133</span><span class="token punctuation">,</span><span class="token number">542221</span><span class="token punctuation">,</span><span class="token number">542222</span><span class="token punctuation">,</span><span class="token number">542223</span><span class="token punctuation">,</span><span class="token number">542224</span><span class="token punctuation">,</span><span class="token number">542225</span><span class="token punctuation">,</span><span class="token number">542226</span><span class="token punctuation">,</span><span class="token number">542227</span><span class="token punctuation">,</span><span class="token number">542228</span><span class="token punctuation">,</span><span class="token number">542229</span><span class="token punctuation">,</span><span class="token number">542231</span><span class="token punctuation">,</span><span class="token number">542232</span><span class="token punctuation">,</span><span class="token number">542233</span><span class="token punctuation">,</span><span class="token number">542301</span><span class="token punctuation">,</span><span class="token number">542322</span><span class="token punctuation">,</span><span class="token number">542323</span><span class="token punctuation">,</span><span class="token number">542324</span><span class="token punctuation">,</span><span class="token number">542325</span><span class="token punctuation">,</span><span class="token number">542326</span><span class="token punctuation">,</span><span class="token number">542327</span><span class="token punctuation">,</span><span class="token number">542328</span><span class="token punctuation">,</span><span class="token number">542329</span><span class="token punctuation">,</span><span class="token number">542330</span><span class="token punctuation">,</span><span class="token number">542331</span><span class="token punctuation">,</span><span class="token number">542332</span><span class="token punctuation">,</span><span class="token number">542333</span><span class="token punctuation">,</span><span class="token number">542334</span><span class="token punctuation">,</span><span class="token number">542335</span><span class="token punctuation">,</span><span class="token number">542336</span><span class="token punctuation">,</span><span class="token number">542337</span><span class="token punctuation">,</span><span class="token number">542338</span><span class="token punctuation">,</span><span class="token number">542421</span><span class="token punctuation">,</span><span class="token number">542422</span><span class="token punctuation">,</span><span class="token number">542423</span><span class="token punctuation">,</span><span class="token number">542424</span><span class="token punctuation">,</span><span class="token number">542425</span><span class="token punctuation">,</span><span class="token number">542426</span><span class="token punctuation">,</span><span class="token number">542427</span><span class="token punctuation">,</span><span class="token number">542428</span><span class="token punctuation">,</span><span class="token number">542429</span><span class="token punctuation">,</span><span class="token number">542430</span><span class="token punctuation">,</span><span class="token number">542521</span><span class="token punctuation">,</span><span class="token number">542522</span><span class="token punctuation">,</span><span class="token number">542523</span><span class="token punctuation">,</span><span class="token number">542524</span><span class="token punctuation">,</span><span class="token number">542525</span><span class="token punctuation">,</span><span class="token number">542526</span><span class="token punctuation">,</span><span class="token number">542527</span><span class="token punctuation">,</span><span class="token number">542621</span><span class="token punctuation">,</span><span class="token number">542622</span><span class="token punctuation">,</span><span class="token number">542623</span><span class="token punctuation">,</span><span class="token number">542624</span><span class="token punctuation">,</span><span class="token number">542625</span><span class="token punctuation">,</span><span class="token number">542626</span><span class="token punctuation">,</span><span class="token number">542627</span><span class="token punctuation">,</span><span class="token number">610101</span><span class="token punctuation">,</span><span class="token number">610102</span><span class="token punctuation">,</span><span class="token number">610103</span><span class="token punctuation">,</span><span class="token number">610104</span><span class="token punctuation">,</span><span class="token number">610111</span><span class="token punctuation">,</span><span class="token number">610112</span><span class="token punctuation">,</span><span class="token number">610113</span><span class="token punctuation">,</span><span class="token number">610114</span><span class="token punctuation">,</span><span class="token number">610115</span><span class="token punctuation">,</span><span class="token number">610121</span><span class="token punctuation">,</span><span class="token number">610122</span><span class="token punctuation">,</span><span class="token number">610124</span><span class="token punctuation">,</span><span class="token number">610125</span><span class="token punctuation">,</span><span class="token number">610126</span><span class="token punctuation">,</span><span class="token number">610201</span><span class="token punctuation">,</span><span class="token number">610202</span><span class="token punctuation">,</span><span class="token number">610203</span><span class="token punctuation">,</span><span class="token number">610221</span><span class="token punctuation">,</span><span class="token number">610222</span><span class="token punctuation">,</span><span class="token number">610301</span><span class="token punctuation">,</span><span class="token number">610302</span><span class="token punctuation">,</span><span class="token number">610303</span><span class="token punctuation">,</span><span class="token number">610321</span><span class="token punctuation">,</span><span class="token number">610322</span><span class="token punctuation">,</span><span class="token number">610323</span><span class="token punctuation">,</span><span class="token number">610324</span><span class="token punctuation">,</span><span class="token number">610326</span><span class="token punctuation">,</span><span class="token number">610327</span><span class="token punctuation">,</span><span class="token number">610328</span><span class="token punctuation">,</span><span class="token number">610329</span><span class="token punctuation">,</span><span class="token number">610330</span><span class="token punctuation">,</span><span class="token number">610331</span><span class="token punctuation">,</span><span class="token number">610401</span><span class="token punctuation">,</span><span class="token number">610402</span><span class="token punctuation">,</span><span class="token number">610403</span><span class="token punctuation">,</span><span class="token number">610404</span><span class="token punctuation">,</span><span class="token number">610422</span><span class="token punctuation">,</span><span class="token number">610423</span><span class="token punctuation">,</span><span class="token number">610424</span><span class="token punctuation">,</span><span class="token number">610425</span><span class="token punctuation">,</span><span class="token number">610426</span><span class="token punctuation">,</span><span class="token number">610427</span><span class="token punctuation">,</span><span class="token number">610428</span><span class="token punctuation">,</span><span class="token number">610429</span><span class="token punctuation">,</span><span class="token number">610430</span><span class="token punctuation">,</span><span class="token number">610431</span><span class="token punctuation">,</span><span class="token number">610481</span><span class="token punctuation">,</span><span class="token number">610501</span><span class="token punctuation">,</span><span class="token number">610502</span><span class="token punctuation">,</span><span class="token number">610521</span><span class="token punctuation">,</span><span class="token number">610522</span><span class="token punctuation">,</span><span class="token number">610523</span><span class="token punctuation">,</span><span class="token number">610524</span><span class="token punctuation">,</span><span class="token number">610525</span><span class="token punctuation">,</span><span class="token number">610526</span><span class="token punctuation">,</span><span class="token number">610527</span><span class="token punctuation">,</span><span class="token number">610528</span><span class="token punctuation">,</span><span class="token number">610581</span><span class="token punctuation">,</span><span class="token number">610582</span><span class="token punctuation">,</span><span class="token number">610601</span><span class="token punctuation">,</span><span class="token number">610602</span><span class="token punctuation">,</span><span class="token number">610621</span><span class="token punctuation">,</span><span class="token number">610622</span><span class="token punctuation">,</span><span class="token number">610623</span><span class="token punctuation">,</span><span class="token number">610624</span><span class="token punctuation">,</span><span class="token number">610625</span><span class="token punctuation">,</span><span class="token number">610626</span><span class="token punctuation">,</span><span class="token number">610627</span><span class="token punctuation">,</span><span class="token number">610628</span><span class="token punctuation">,</span><span class="token number">610629</span><span class="token punctuation">,</span><span class="token number">610630</span><span class="token punctuation">,</span><span class="token number">610631</span><span class="token punctuation">,</span><span class="token number">610632</span><span class="token punctuation">,</span><span class="token number">610701</span><span class="token punctuation">,</span><span class="token number">610702</span><span class="token punctuation">,</span><span class="token number">610721</span><span class="token punctuation">,</span><span class="token number">610722</span><span class="token punctuation">,</span><span class="token number">610723</span><span class="token punctuation">,</span><span class="token number">610724</span><span class="token punctuation">,</span><span class="token number">610725</span><span class="token punctuation">,</span><span class="token number">610726</span><span class="token punctuation">,</span><span class="token number">610727</span><span class="token punctuation">,</span><span class="token number">610728</span><span class="token punctuation">,</span><span class="token number">610729</span><span class="token punctuation">,</span><span class="token number">610730</span><span class="token punctuation">,</span><span class="token number">610801</span><span class="token punctuation">,</span><span class="token number">610802</span><span class="token punctuation">,</span><span class="token number">610821</span><span class="token punctuation">,</span><span class="token number">610822</span><span class="token punctuation">,</span><span class="token number">610823</span><span class="token punctuation">,</span><span class="token number">610824</span><span class="token punctuation">,</span><span class="token number">610825</span><span class="token punctuation">,</span><span class="token number">610826</span><span class="token punctuation">,</span><span class="token number">610827</span><span class="token punctuation">,</span><span class="token number">610828</span><span class="token punctuation">,</span><span class="token number">610829</span><span class="token punctuation">,</span><span class="token number">610830</span><span class="token punctuation">,</span><span class="token number">610831</span><span class="token punctuation">,</span><span class="token number">610901</span><span class="token punctuation">,</span><span class="token number">610902</span><span class="token punctuation">,</span><span class="token number">610921</span><span class="token punctuation">,</span><span class="token number">610922</span><span class="token punctuation">,</span><span class="token number">610923</span><span class="token punctuation">,</span><span class="token number">610924</span><span class="token punctuation">,</span><span class="token number">610925</span><span class="token punctuation">,</span><span class="token number">610926</span><span class="token punctuation">,</span><span class="token number">610927</span><span class="token punctuation">,</span><span class="token number">610928</span><span class="token punctuation">,</span><span class="token number">610929</span><span class="token punctuation">,</span><span class="token number">612501</span><span class="token punctuation">,</span><span class="token number">612522</span><span class="token punctuation">,</span><span class="token number">612523</span><span class="token punctuation">,</span><span class="token number">612524</span><span class="token punctuation">,</span><span class="token number">612525</span><span class="token punctuation">,</span><span class="token number">612526</span><span class="token punctuation">,</span><span class="token number">612527</span><span class="token punctuation">,</span><span class="token number">620101</span><span class="token punctuation">,</span><span class="token number">620102</span><span class="token punctuation">,</span><span class="token number">620103</span><span class="token punctuation">,</span><span class="token number">620104</span><span class="token punctuation">,</span><span class="token number">620105</span><span class="token punctuation">,</span><span class="token number">620111</span><span class="token punctuation">,</span><span class="token number">620121</span><span class="token punctuation">,</span><span class="token number">620122</span><span class="token punctuation">,</span><span class="token number">620123</span><span class="token punctuation">,</span><span class="token number">620201</span><span class="token punctuation">,</span><span class="token number">620301</span><span class="token punctuation">,</span><span class="token number">620302</span><span class="token punctuation">,</span><span class="token number">620321</span><span class="token punctuation">,</span><span class="token number">620401</span><span class="token punctuation">,</span><span class="token number">620402</span><span class="token punctuation">,</span><span class="token number">620403</span><span class="token punctuation">,</span><span class="token number">620421</span><span class="token punctuation">,</span><span class="token number">620422</span><span class="token punctuation">,</span><span class="token number">620423</span><span class="token punctuation">,</span><span class="token number">620501</span><span class="token punctuation">,</span><span class="token number">620502</span><span class="token punctuation">,</span><span class="token number">620503</span><span class="token punctuation">,</span><span class="token number">620521</span><span class="token punctuation">,</span><span class="token number">620522</span><span class="token punctuation">,</span><span class="token number">620523</span><span class="token punctuation">,</span><span class="token number">620524</span><span class="token punctuation">,</span><span class="token number">620525</span><span class="token punctuation">,</span><span class="token number">622101</span><span class="token punctuation">,</span><span class="token number">622102</span><span class="token punctuation">,</span><span class="token number">622103</span><span class="token punctuation">,</span><span class="token number">622123</span><span class="token punctuation">,</span><span class="token number">622124</span><span class="token punctuation">,</span><span class="token number">622125</span><span class="token punctuation">,</span><span class="token number">622126</span><span class="token punctuation">,</span><span class="token number">622201</span><span class="token punctuation">,</span><span class="token number">622222</span><span class="token punctuation">,</span><span class="token number">622223</span><span class="token punctuation">,</span><span class="token number">622224</span><span class="token punctuation">,</span><span class="token number">622225</span><span class="token punctuation">,</span><span class="token number">622226</span><span class="token punctuation">,</span><span class="token number">622301</span><span class="token punctuation">,</span><span class="token number">622322</span><span class="token punctuation">,</span><span class="token number">622323</span><span class="token punctuation">,</span><span class="token number">622326</span><span class="token punctuation">,</span><span class="token number">622421</span><span class="token punctuation">,</span><span class="token number">622424</span><span class="token punctuation">,</span><span class="token number">622425</span><span class="token punctuation">,</span><span class="token number">622426</span><span class="token punctuation">,</span><span class="token number">622427</span><span class="token punctuation">,</span><span class="token number">622428</span><span class="token punctuation">,</span><span class="token number">622429</span><span class="token punctuation">,</span><span class="token number">622621</span><span class="token punctuation">,</span><span class="token number">622623</span><span class="token punctuation">,</span><span class="token number">622624</span><span class="token punctuation">,</span><span class="token number">622625</span><span class="token punctuation">,</span><span class="token number">622626</span><span class="token punctuation">,</span><span class="token number">622627</span><span class="token punctuation">,</span><span class="token number">622628</span><span class="token punctuation">,</span><span class="token number">622629</span><span class="token punctuation">,</span><span class="token number">622630</span><span class="token punctuation">,</span><span class="token number">622701</span><span class="token punctuation">,</span><span class="token number">622722</span><span class="token punctuation">,</span><span class="token number">622723</span><span class="token punctuation">,</span><span class="token number">622724</span><span class="token punctuation">,</span><span class="token number">622725</span><span class="token punctuation">,</span><span class="token number">622726</span><span class="token punctuation">,</span><span class="token number">622727</span><span class="token punctuation">,</span><span class="token number">622801</span><span class="token punctuation">,</span><span class="token number">622821</span><span class="token punctuation">,</span><span class="token number">622822</span><span class="token punctuation">,</span><span class="token number">622823</span><span class="token punctuation">,</span><span class="token number">622824</span><span class="token punctuation">,</span><span class="token number">622825</span><span class="token punctuation">,</span><span class="token number">622826</span><span class="token punctuation">,</span><span class="token number">622827</span><span class="token punctuation">,</span><span class="token number">622901</span><span class="token punctuation">,</span><span class="token number">622921</span><span class="token punctuation">,</span><span class="token number">622922</span><span class="token punctuation">,</span><span class="token number">622923</span><span class="token punctuation">,</span><span class="token number">622924</span><span class="token punctuation">,</span><span class="token number">622925</span><span class="token punctuation">,</span><span class="token number">622926</span><span class="token punctuation">,</span><span class="token number">622927</span><span class="token punctuation">,</span><span class="token number">623001</span><span class="token punctuation">,</span><span class="token number">623021</span><span class="token punctuation">,</span><span class="token number">623022</span><span class="token punctuation">,</span><span class="token number">623023</span><span class="token punctuation">,</span><span class="token number">623024</span><span class="token punctuation">,</span><span class="token number">623025</span><span class="token punctuation">,</span><span class="token number">623026</span><span class="token punctuation">,</span><span class="token number">623027</span><span class="token punctuation">,</span><span class="token number">630101</span><span class="token punctuation">,</span><span class="token number">630102</span><span class="token punctuation">,</span><span class="token number">630103</span><span class="token punctuation">,</span><span class="token number">630104</span><span class="token punctuation">,</span><span class="token number">630105</span><span class="token punctuation">,</span><span class="token number">630121</span><span class="token punctuation">,</span><span class="token number">630122</span><span class="token punctuation">,</span><span class="token number">630123</span><span class="token punctuation">,</span><span class="token number">632121</span><span class="token punctuation">,</span><span class="token number">632122</span><span class="token punctuation">,</span><span class="token number">632123</span><span class="token punctuation">,</span><span class="token number">632126</span><span class="token punctuation">,</span><span class="token number">632127</span><span class="token punctuation">,</span><span class="token number">632128</span><span class="token punctuation">,</span><span class="token number">632221</span><span class="token punctuation">,</span><span class="token number">632222</span><span class="token punctuation">,</span><span class="token number">632223</span><span class="token punctuation">,</span><span class="token number">632224</span><span class="token punctuation">,</span><span class="token number">632321</span><span class="token punctuation">,</span><span class="token number">632322</span><span class="token punctuation">,</span><span class="token number">632323</span><span class="token punctuation">,</span><span class="token number">632324</span><span class="token punctuation">,</span><span class="token number">632521</span><span class="token punctuation">,</span><span class="token number">632522</span><span class="token punctuation">,</span><span class="token number">632523</span><span class="token punctuation">,</span><span class="token number">632524</span><span class="token punctuation">,</span><span class="token number">632525</span><span class="token punctuation">,</span><span class="token number">632621</span><span class="token punctuation">,</span><span class="token number">632622</span><span class="token punctuation">,</span><span class="token number">632623</span><span class="token punctuation">,</span><span class="token number">632624</span><span class="token punctuation">,</span><span class="token number">632625</span><span class="token punctuation">,</span><span class="token number">632626</span><span class="token punctuation">,</span><span class="token number">632721</span><span class="token punctuation">,</span><span class="token number">632722</span><span class="token punctuation">,</span><span class="token number">632723</span><span class="token punctuation">,</span><span class="token number">632724</span><span class="token punctuation">,</span><span class="token number">632725</span><span class="token punctuation">,</span><span class="token number">632726</span><span class="token punctuation">,</span><span class="token number">632801</span><span class="token punctuation">,</span><span class="token number">632802</span><span class="token punctuation">,</span><span class="token number">632821</span><span class="token punctuation">,</span><span class="token number">632822</span><span class="token punctuation">,</span><span class="token number">632823</span><span class="token punctuation">,</span><span class="token number">640101</span><span class="token punctuation">,</span><span class="token number">640102</span><span class="token punctuation">,</span><span class="token number">640103</span><span class="token punctuation">,</span><span class="token number">640111</span><span class="token punctuation">,</span><span class="token number">640121</span><span class="token punctuation">,</span><span class="token number">640122</span><span class="token punctuation">,</span><span class="token number">640201</span><span class="token punctuation">,</span><span class="token number">640202</span><span class="token punctuation">,</span><span class="token number">640203</span><span class="token punctuation">,</span><span class="token number">640204</span><span class="token punctuation">,</span><span class="token number">640221</span><span class="token punctuation">,</span><span class="token number">640222</span><span class="token punctuation">,</span><span class="token number">640223</span><span class="token punctuation">,</span><span class="token number">640301</span><span class="token punctuation">,</span><span class="token number">640302</span><span class="token punctuation">,</span><span class="token number">640321</span><span class="token punctuation">,</span><span class="token number">640322</span><span class="token punctuation">,</span><span class="token number">640323</span><span class="token punctuation">,</span><span class="token number">640324</span><span class="token punctuation">,</span><span class="token number">640381</span><span class="token punctuation">,</span><span class="token number">640382</span><span class="token punctuation">,</span><span class="token number">642221</span><span class="token punctuation">,</span><span class="token number">642222</span><span class="token punctuation">,</span><span class="token number">642223</span><span class="token punctuation">,</span><span class="token number">642224</span><span class="token punctuation">,</span><span class="token number">642225</span><span class="token punctuation">,</span><span class="token number">642226</span><span class="token punctuation">,</span><span class="token number">650101</span><span class="token punctuation">,</span><span class="token number">650102</span><span class="token punctuation">,</span><span class="token number">650103</span><span class="token punctuation">,</span><span class="token number">650104</span><span class="token punctuation">,</span><span class="token number">650105</span><span class="token punctuation">,</span><span class="token number">650106</span><span class="token punctuation">,</span><span class="token number">650107</span><span class="token punctuation">,</span><span class="token number">650108</span><span class="token punctuation">,</span><span class="token number">650121</span><span class="token punctuation">,</span><span class="token number">650201</span><span class="token punctuation">,</span><span class="token number">650202</span><span class="token punctuation">,</span><span class="token number">650203</span><span class="token punctuation">,</span><span class="token number">650204</span><span class="token punctuation">,</span><span class="token number">650205</span><span class="token punctuation">,</span><span class="token number">652101</span><span class="token punctuation">,</span><span class="token number">652122</span><span class="token punctuation">,</span><span class="token number">652123</span><span class="token punctuation">,</span><span class="token number">652201</span><span class="token punctuation">,</span><span class="token number">652222</span><span class="token punctuation">,</span><span class="token number">652223</span><span class="token punctuation">,</span><span class="token number">652301</span><span class="token punctuation">,</span><span class="token number">652302</span><span class="token punctuation">,</span><span class="token number">652303</span><span class="token punctuation">,</span><span class="token number">652323</span><span class="token punctuation">,</span><span class="token number">652324</span><span class="token punctuation">,</span><span class="token number">652325</span><span class="token punctuation">,</span><span class="token number">652327</span><span class="token punctuation">,</span><span class="token number">652328</span><span class="token punctuation">,</span><span class="token number">652701</span><span class="token punctuation">,</span><span class="token number">652722</span><span class="token punctuation">,</span><span class="token number">652723</span><span class="token punctuation">,</span><span class="token number">652801</span><span class="token punctuation">,</span><span class="token number">652822</span><span class="token punctuation">,</span><span class="token number">652823</span><span class="token punctuation">,</span><span class="token number">652824</span><span class="token punctuation">,</span><span class="token number">652825</span><span class="token punctuation">,</span><span class="token number">652826</span><span class="token punctuation">,</span><span class="token number">652827</span><span class="token punctuation">,</span><span class="token number">652828</span><span class="token punctuation">,</span><span class="token number">652829</span><span class="token punctuation">,</span><span class="token number">652901</span><span class="token punctuation">,</span><span class="token number">652922</span><span class="token punctuation">,</span><span class="token number">652923</span><span class="token punctuation">,</span><span class="token number">652924</span><span class="token punctuation">,</span><span class="token number">652925</span><span class="token punctuation">,</span><span class="token number">652926</span><span class="token punctuation">,</span><span class="token number">652927</span><span class="token punctuation">,</span><span class="token number">652928</span><span class="token punctuation">,</span><span class="token number">652929</span><span class="token punctuation">,</span><span class="token number">653001</span><span class="token punctuation">,</span><span class="token number">653022</span><span class="token punctuation">,</span><span class="token number">653023</span><span class="token punctuation">,</span><span class="token number">653024</span><span class="token punctuation">,</span><span class="token number">653101</span><span class="token punctuation">,</span><span class="token number">653121</span><span class="token punctuation">,</span><span class="token number">653122</span><span class="token punctuation">,</span><span class="token number">653123</span><span class="token punctuation">,</span><span class="token number">653124</span><span class="token punctuation">,</span><span class="token number">653125</span><span class="token punctuation">,</span><span class="token number">653126</span><span class="token punctuation">,</span><span class="token number">653127</span><span class="token punctuation">,</span><span class="token number">653128</span><span class="token punctuation">,</span><span class="token number">653129</span><span class="token punctuation">,</span><span class="token number">653130</span><span class="token punctuation">,</span><span class="token number">653131</span><span class="token punctuation">,</span><span class="token number">653201</span><span class="token punctuation">,</span><span class="token number">653221</span><span class="token punctuation">,</span><span class="token number">653222</span><span class="token punctuation">,</span><span class="token number">653223</span><span class="token punctuation">,</span><span class="token number">653224</span><span class="token punctuation">,</span><span class="token number">653225</span><span class="token punctuation">,</span><span class="token number">653226</span><span class="token punctuation">,</span><span class="token number">653227</span><span class="token punctuation">,</span><span class="token number">654001</span><span class="token punctuation">,</span><span class="token number">654101</span><span class="token punctuation">,</span><span class="token number">654121</span><span class="token punctuation">,</span><span class="token number">654122</span><span class="token punctuation">,</span><span class="token number">654123</span><span class="token punctuation">,</span><span class="token number">654124</span><span class="token punctuation">,</span><span class="token number">654125</span><span class="token punctuation">,</span><span class="token number">654126</span><span class="token punctuation">,</span><span class="token number">654127</span><span class="token punctuation">,</span><span class="token number">654128</span><span class="token punctuation">,</span><span class="token number">654201</span><span class="token punctuation">,</span><span class="token number">654202</span><span class="token punctuation">,</span><span class="token number">654221</span><span class="token punctuation">,</span><span class="token number">654223</span><span class="token punctuation">,</span><span class="token number">654224</span><span class="token punctuation">,</span><span class="token number">654225</span><span class="token punctuation">,</span><span class="token number">654226</span><span class="token punctuation">,</span><span class="token number">654301</span><span class="token punctuation">,</span><span class="token number">654321</span><span class="token punctuation">,</span><span class="token number">654322</span><span class="token punctuation">,</span><span class="token number">654323</span><span class="token punctuation">,</span><span class="token number">654324</span><span class="token punctuation">,</span><span class="token number">654325</span><span class="token punctuation">,</span><span class="token number">654326</span><span class="token punctuation">,</span><span class="token number">659001</span><span class="token punctuation">,</span><span class="token number">710101</span><span class="token punctuation">,</span><span class="token number">710102</span><span class="token punctuation">,</span><span class="token number">710103</span><span class="token punctuation">,</span><span class="token number">810101</span><span class="token punctuation">,</span><span class="token number">810102</span><span class="token punctuation">,</span><span class="token number">810103</span><span class="token punctuation">,</span><span class="token number">910101</span><span class="token punctuation">,</span><span class="token number">910102</span><span class="token punctuation">,</span><span class="token number">910103</span>
</code></pre> 
<h5><a id="pomxml_3484"></a>pom.xml</h5> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
  <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.lihaoze<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.apache.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdk.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdk.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.reporting.outputEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.reporting.outputEncoding</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.test.failure.ignore</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.test.failure.ignore</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.test.skip</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.test.skip</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- junit-jupiter-api --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.junit.jupiter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit-jupiter-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.9.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- junit-jupiter-engine --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.junit.jupiter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit-jupiter-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.9.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.18.26<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-slf4j-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.20.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>31.1-jre<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- commons-pool2 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-pool2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.11.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.janeluo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ikanalyzer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2012_u6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.binarywang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>java-testdata-generator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.11.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">&gt;</span></span>${project.artifactId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--&lt;outputDirectory&gt;../package&lt;/outputDirectory&gt;--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.11.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 设置编译字符编码 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoding</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 设置编译jdk版本 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">&gt;</span></span>${jdk.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>${jdk.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-clean-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-resources-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 编译级别 --&gt;</span>
      <span class="token comment">&lt;!-- 打包的时候跳过测试junit begin --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-surefire-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.22.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>skip</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>skip</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<h5><a id="_3613"></a>工具类</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>lihaozhe<span class="token punctuation">.</span>mock</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>binarywang<span class="token punctuation">.</span>tools<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">ChineseIDCardNumberGenerator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>binarywang<span class="token punctuation">.</span>tools<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">ChineseMobileNumberGenerator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>binarywang<span class="token punctuation">.</span>tools<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">ChineseNameGenerator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>binarywang<span class="token punctuation">.</span>tools<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>base<span class="token punctuation">.</span></span><span class="token class-name">GenericGenerator</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ListIterator</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author 李昊哲
 * @version 1.0.0
 * @create 2023/4/25 20:18
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MockTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> provinceCodes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"11"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"12"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"13"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"14"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"15"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"21"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"22"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"23"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"31"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"32"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"33"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"34"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"35"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"36"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"37"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"41"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"42"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"43"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"44"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"45"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"46"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"51"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"52"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"53"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"54"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"61"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"62"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"63"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"64"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"65"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"71"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"81"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provinceCodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"91"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> suffix <span class="token operator">=</span> <span class="token string">".csv"</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rcs <span class="token operator">=</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToString</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"region_code.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> codes <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>rcs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ChineseNameGenerator</span> nameGenerator <span class="token operator">=</span> <span class="token class-name">ChineseNameGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">GenericGenerator</span> idCardGenerator <span class="token operator">=</span> <span class="token class-name">ChineseIDCardNumberGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ChineseMobileNumberGenerator</span> mobileNumberGenerator <span class="token operator">=</span> <span class="token class-name">ChineseMobileNumberGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringBuilder</span> content <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> idCard <span class="token operator">=</span> idCardGenerator<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>idCard<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"82"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>codes<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>idCard<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                content<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>idCard<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                content<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>nameGenerator<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                content<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>mobileNumberGenerator<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>idCard<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> content<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                content<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> content<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> suffix <span class="token operator">=</span> <span class="token string">".csv"</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readLines</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"22.csv"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> file<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> content <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> city_code <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>city_code <span class="token operator">+</span> suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span>content <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">,</span><span class="token string">"UTF-8"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_3721"></a>创建数据库</h4> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /chap07
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> pt location <span class="token string">'/chap07'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">use</span> chap07<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_3735"></a>内部分区表</h4> 
<h5><a id="_3737"></a>创建内部分区表</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> partition_1<span class="token punctuation">(</span>
    id_card string<span class="token punctuation">,</span>
    real_name string<span class="token punctuation">,</span>
    mobile string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>province_code string<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_3750"></a>导入数据</h5> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/11.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'11'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/12.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'12'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/13.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'13'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/14.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/15.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'15'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/21.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/22.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/23.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/31.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/32.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'32'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/33.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'33'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/34.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'34'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/35.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'35'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/36.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/37.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'37'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/41.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'41'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/42.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'42'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/43.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'43'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/44.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'44'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/45.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'45'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/46.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'46'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/51.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'51'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/52.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'52'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/53.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'53'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/54.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'54'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/61.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'61'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/62.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'62'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/63.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'63'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/64.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/65.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'65'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/71.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'71'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/81.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'81'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/91.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_1  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'91'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_3788"></a>外部分区表</h4> 
<h5><a id="_3790"></a>创建外部分区表关联目录</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /partition/partition_2
</code></pre> 
<h5><a id="_3796"></a>创建外部分区表</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> partition_2<span class="token punctuation">(</span>
    id_card string<span class="token punctuation">,</span>
    real_name string<span class="token punctuation">,</span>
    mobile string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>province_code string<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/partition/partition_2'</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_3810"></a>导入数据</h5> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/11.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'11'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/12.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'12'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/13.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'13'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/14.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/15.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'15'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/21.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/22.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/23.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/31.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/32.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'32'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/33.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'33'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/34.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'34'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/35.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'35'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/36.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/37.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'37'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/41.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'41'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/42.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'42'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/43.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'43'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/44.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'44'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/45.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'45'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/46.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'46'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/51.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'51'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/52.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'52'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/53.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'53'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/54.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'54'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/61.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'61'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/62.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'62'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/63.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'63'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/64.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/65.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'65'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/71.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'71'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/81.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'81'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/region/91.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_2  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'91'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_3848"></a>多重内部分区表</h4> 
<h5><a id="_3850"></a>创建内部多重内部分区表</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> partition_3<span class="token punctuation">(</span>
    id_card string<span class="token punctuation">,</span>
    real_name string<span class="token punctuation">,</span>
    mobile string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>province_code string<span class="token punctuation">,</span>city_code string<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_3863"></a>导入数据</h5> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2101.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2101'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2102.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2102'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2103.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2103'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2104.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2104'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2105.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2105'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2106.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2106'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2107.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2107'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2108.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2108'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2109.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2109'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2110.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2110'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2111.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2111'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2112.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2112'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2113.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2113'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2114.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2114'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2201.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2201'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2202.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2202'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2203.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2203'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2204.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2204'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2205.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2205'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2206.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2206'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2207.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2207'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2208.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2208'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2224.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2224'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2301.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2301'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2302.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2302'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2303.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2303'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2304.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2304'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2305.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2305'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2306.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2306'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2307.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2307'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2308.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2308'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2309.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2309'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2310.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2310'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2311.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2311'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2312.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_3  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2312'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_3903"></a>多重外部分区表</h4> 
<h5><a id="_3905"></a>创建多重外部分区表关联目录</h5> 
<pre><code class="prism language-bash">hdfs dfs <span class="token parameter variable">-mkdir</span> <span class="token parameter variable">-p</span> /partition/partition_4
</code></pre> 
<h5><a id="_3911"></a>创建多重外部分区表</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> partition_4<span class="token punctuation">(</span>
    id_card string<span class="token punctuation">,</span>
    real_name string<span class="token punctuation">,</span>
    mobile string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>province_code string<span class="token punctuation">,</span>city_code string<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/partition/partition_4'</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="_3925"></a>导入数据</h5> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2101.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2101'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2102.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2102'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2103.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2103'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2104.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2104'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2105.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2105'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2106.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2106'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2107.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2107'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2108.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2108'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2109.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2109'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2110.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2110'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2111.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2111'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2112.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2112'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2113.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2113'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/21/2114.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'21'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2114'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2201.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2201'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2202.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2202'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2203.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2203'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2204.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2204'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2205.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2205'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2206.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2206'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2207.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2207'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2208.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2208'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/22/2224.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'22'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2224'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2301.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2301'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2302.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2302'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2303.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2303'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2304.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2304'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2305.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2305'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2306.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2306'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2307.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2307'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2308.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2308'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2309.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2309'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2310.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2310'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2311.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2311'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/data/dongbei/23/2312.csv'</span> overwrite <span class="token keyword">into</span> <span class="token keyword">table</span> partition_4  <span class="token keyword">partition</span><span class="token punctuation">(</span>province_code<span class="token operator">=</span><span class="token string">'23'</span><span class="token punctuation">,</span>city_code<span class="token operator">=</span><span class="token string">'2312'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_3965"></a>动态分区</h4> 
<pre><code class="prism language-bash">-- 动态分区功能总开关（默认true，开启）
<span class="token builtin class-name">set</span> <span class="token assign-left variable">hive.exec.dynamic.partition</span><span class="token operator">=</span>true<span class="token punctuation">;</span>

-- 严格模式和非严格模式
-- 动态分区的模式，默认strict（严格模式），要求必须指定至少一个分区为静态分区，
-- nonstrict（非严格模式）允许所有的分区字段都使用动态分区。
<span class="token builtin class-name">set</span> <span class="token assign-left variable">hive.exec.dynamic.partition.mode</span><span class="token operator">=</span>nonstrict<span class="token punctuation">;</span>

-- 一条insert语句可同时创建的最大的分区个数，默认为1000。
<span class="token builtin class-name">set</span> <span class="token assign-left variable">hive.exec.max.dynamic.partitions</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>

-- 单个Mapper或者Reducer可同时创建的最大的分区个数，默认为100。
<span class="token builtin class-name">set</span> <span class="token assign-left variable">hive.exec.max.dynamic.partitions.pernode</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>

-- 一条insert语句可以创建的最大的文件个数，默认100000。
<span class="token builtin class-name">set</span> <span class="token assign-left variable">hive.exec.max.created.files</span><span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">;</span>

-- 当查询结果为空时且进行动态分区时，是否抛出异常，默认false。
<span class="token builtin class-name">set</span> <span class="token assign-left variable">hive.error.on.empty.partition</span><span class="token operator">=</span>false<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>创建动态分区表</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> emp_partition_dynamic <span class="token punctuation">(</span>
	emp_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'员工ID'</span><span class="token punctuation">,</span>
	emp_name string <span class="token keyword">comment</span> <span class="token string">'员工姓名'</span><span class="token punctuation">,</span>
    emp_job string <span class="token keyword">comment</span> <span class="token string">'员工岗位'</span><span class="token punctuation">,</span>
    emp_salary <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'员工薪资'</span>
<span class="token punctuation">)</span> partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>dept_id <span class="token keyword">int</span><span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile
 location <span class="token string">'/partition/dynamic/emp'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token punctuation">.</span><span class="token keyword">mode</span><span class="token operator">=</span>nonstrict<span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>partitions<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>partitions<span class="token punctuation">.</span>pernode<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>created<span class="token punctuation">.</span>files<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span>error<span class="token punctuation">.</span><span class="token keyword">on</span><span class="token punctuation">.</span>empty<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">-- 执行动态分区插入</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> emp_partition_dynamic
 <span class="token keyword">select</span> emp_id<span class="token punctuation">,</span> emp_name<span class="token punctuation">,</span> emp_job<span class="token punctuation">,</span> emp_salary<span class="token punctuation">,</span> nvl<span class="token punctuation">(</span>dept_id<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">from</span> chap03<span class="token punctuation">.</span>emp<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>创建动态分区表</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> partition_dynamic<span class="token punctuation">(</span>
    id_card string<span class="token punctuation">,</span>
    real_name string<span class="token punctuation">,</span>
    mobile string<span class="token punctuation">,</span>
    location string<span class="token punctuation">,</span>
    gender string
<span class="token punctuation">)</span>partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span>province_code string<span class="token punctuation">,</span>city_code string<span class="token punctuation">)</span>
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token punctuation">.</span><span class="token keyword">mode</span><span class="token operator">=</span>nonstrict<span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>partitions<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>partitions<span class="token punctuation">.</span>pernode<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>created<span class="token punctuation">.</span>files<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span>error<span class="token punctuation">.</span><span class="token keyword">on</span><span class="token punctuation">.</span>empty<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> overwrite <span class="token keyword">table</span> partition_dynamic
    <span class="token keyword">select</span> id_card<span class="token punctuation">,</span> real_name<span class="token punctuation">,</span> mobile<span class="token punctuation">,</span>
           substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> location<span class="token punctuation">,</span>
           substr<span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> gender<span class="token punctuation">,</span>
           province_code<span class="token punctuation">,</span>city_code
    <span class="token keyword">from</span> partition_3<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_4051"></a>分桶</h3> 
<blockquote> 
 <p>数据抽样 提高join查询效率</p> 
</blockquote> 
<ol><li>创建普通表并导入数据</li><li>开启分桶</li><li>查询普通表将，将查询结果插入桶</li><li>从桶中查询数据</li></ol> 
<h4><a id="_4060"></a>创建普通表并导入数据</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> bucket_source<span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'/root/bucket_source.txt'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> bucket_source<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_4070"></a>开启分桶</h4> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span>enforce<span class="token punctuation">.</span>bucketing<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_4076"></a>创建桶表</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> bucket_tb<span class="token punctuation">(</span>
   id <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token keyword">clustered</span> <span class="token keyword">by</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token number">4</span> buckets<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_4084"></a>载入数据到桶表</h4> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span>enforce<span class="token punctuation">.</span>bucketing<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">table</span> bucket_tb <span class="token keyword">select</span> id <span class="token keyword">from</span> bucket_source <span class="token keyword">where</span> id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- 数据抽样</span>
<span class="token comment">-- tablesample(bucket x out of y on id);</span>
<span class="token comment">-- 注意：y&gt;=x</span>
<span class="token comment">-- y：表示把桶表中的数据随机分为多少桶</span>
<span class="token comment">-- x: 表示取出第几桶的数据</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">1</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">2</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">3</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> bucket_tb tablesample<span class="token punctuation">(</span>bucket <span class="token number">4</span> <span class="token keyword">out</span> <span class="token keyword">of</span> <span class="token number">4</span> <span class="token keyword">on</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_4106"></a>视图</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建视图</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> people_view <span class="token keyword">as</span>
     <span class="token keyword">select</span> id_card<span class="token punctuation">,</span> real_name<span class="token punctuation">,</span> mobile<span class="token punctuation">,</span>
           substr<span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> gender<span class="token punctuation">,</span>
           substr<span class="token punctuation">(</span>id_card<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> location
    <span class="token keyword">from</span> partition_3<span class="token punctuation">;</span>
    
<span class="token comment">-- 查找视图</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token operator">like</span> <span class="token string">'people*'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看视图结构</span>
<span class="token keyword">describe</span> formatted people_view<span class="token punctuation">;</span>

<span class="token comment">-- 从视图中查询数据</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> people_view <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_4126"></a>存储与压缩</h3> 
<h4><a id="_4128"></a>压缩</h4> 
<table><thead><tr><th>压缩格式</th><th>算法</th><th>文件后缀名</th><th>是否可切分</th><th>编码解码</th></tr></thead><tbody><tr><td>deflate</td><td>deflate</td><td>.deflate</td><td>否</td><td>org.apache.hadoop.io.compress.DefaultCodec</td></tr><tr><td>gzip</td><td>deflate</td><td>.gz</td><td>否</td><td>org.apache.hadoop.io.compress.GzipCodec</td></tr><tr><td>biz2</td><td>biz2</td><td>.bz2</td><td>是</td><td>org.apache.hadoop.io.compress.BZip2Codec</td></tr><tr><td>lzo</td><td>lzo</td><td>.lzo</td><td>是</td><td>com.hadoop.compression.lzo.LzopCodec</td></tr><tr><td>snappy</td><td>snappy</td><td>.snappy</td><td>否</td><td>org.apache.hadoop.io.compress.SnappyCodec</td></tr></tbody></table> 
<h4><a id="_4138"></a>文件格式</h4> 
<blockquote> 
 <p>行式存储与列式存储</p> 
 <p>hive表中的数据选择一个合适的文件格式，对于高性能查询是比较有益的。</p> 
 <p>行式存储 text file、sequence file</p> 
 <p>列式存储 ORC 、Parquet</p> 
</blockquote> 
<h5><a id="text_file_4148"></a>text file</h5> 
<blockquote> 
 <p>hive 默认采用 text file 文件存储格式</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user01 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> textfile<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>compress<span class="token punctuation">.</span>output<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> mapred<span class="token punctuation">.</span>output<span class="token punctuation">.</span>compression<span class="token punctuation">.</span>codec<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>GzipCodec<span class="token punctuation">;</span>
<span class="token keyword">set</span> mapred<span class="token punctuation">.</span>output<span class="token punctuation">.</span>compress<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> io<span class="token punctuation">.</span>compression<span class="token punctuation">.</span>codecs<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>GzipCodec<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user01 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李哲'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="sequence_file_4170"></a>sequence file</h5> 
<blockquote> 
 <p>sequence file 文件时 Hadoop 用来存储二进制形式的 key : value 键值对而设计的一种平面文件 flatmap</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user02 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> sequencefile<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>compress<span class="token punctuation">.</span>output<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>output<span class="token punctuation">.</span>fileoutputformat<span class="token punctuation">.</span>compress<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>output<span class="token punctuation">.</span>fileoutputformat<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>codec<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>DeflateCodec<span class="token punctuation">;</span>
<span class="token keyword">set</span> io<span class="token punctuation">.</span>seqfile<span class="token punctuation">.</span>compression<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token operator">=</span>BLOCK<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user02 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李哲'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="ORC_4192"></a>ORC</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user03 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> orc
 tblproperties<span class="token punctuation">(</span><span class="token string">"orc.compress"</span><span class="token operator">=</span><span class="token string">"NONE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user03 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> orc
 tblproperties<span class="token punctuation">(</span><span class="token string">"orc.compress"</span><span class="token operator">=</span><span class="token string">"ZLIB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user03 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> orc
 tblproperties<span class="token punctuation">(</span><span class="token string">"orc.compress"</span><span class="token operator">=</span><span class="token string">"SNAPPY"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user03 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李哲'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="Parquet_4222"></a>Parquet</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user04 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> parquet
 tblproperties<span class="token punctuation">(</span><span class="token string">"parquet.compression"</span><span class="token operator">=</span><span class="token string">"uncompressed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user03 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李哲'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="rcfile_4236"></a>rcfile</h5> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user05 <span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span>real_name string<span class="token punctuation">)</span> 
 <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
 <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span>
 stored <span class="token keyword">as</span> rcfile<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>compress<span class="token punctuation">.</span>output<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>output<span class="token punctuation">.</span>fileoutputformat<span class="token punctuation">.</span>compress<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>output<span class="token punctuation">.</span>fileoutputformat<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>codec<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>DeflateCodec<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user05 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'李昊哲'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李哲'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_4255"></a>变量</h3> 
<h4><a id="hive__4257"></a>hive 中变量和属性命名空间</h4> 
<table><thead><tr><th>命名空间</th><th>权限</th><th>描述</th></tr></thead><tbody><tr><td>hivevar</td><td>读写</td><td>用户自定义变量</td></tr><tr><td>hiveconf</td><td>读写</td><td>hive相关配置属性</td></tr><tr><td>system</td><td>读写</td><td>java定义额配置属性</td></tr><tr><td>env</td><td>只读</td><td>shell环境定义的环境变量</td></tr></tbody></table> 
<h4><a id="_4266"></a>语法</h4> 
<blockquote> 
 <p>Java对这个除<code>env</code>命名空间内容具有可读可写权利；</p> 
 <p>而<code>env</code>命名空间，对环境变量只提供可读权限。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/a3/af/urdsQ5PN_o.png" alt="hive变量"></p> 
<blockquote> 
 <p>配置行为所有属性。</p> 
 <p>指定hive.cli.print.current.db属性</p> 
 <p>开启这个属性可以在CLI提示符前打印出当前所在的数据库名</p> 
 <p>默认数据库名是default，这个属性的默认值是false</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/c1/d9/taIzDP1W_o.png" alt="hive变量"></p> 
<h4><a id="SET_4285"></a>SET</h4> 
<blockquote> 
 <p>用来显示或修改变量值；还可以给变量赋予新的值。</p> 
 <p>前缀hivevar:是可选的，–hivevar 和 --define 标记是相同的。</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token comment"># 操作系统环境下 定义变量</span>
hive <span class="token parameter variable">--define</span> <span class="token assign-left variable">slogan</span><span class="token operator">=</span>勿忘国耻
</code></pre> 
<blockquote> 
 <p>hive 命令行 查看变量</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> slogan<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hivevar:slogan<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>hive 命令行 定义修改变量</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hivevar:slogan<span class="token operator">=</span>铭记历史<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hivevar:slogan<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> slogan<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/52/0d/uCl8AuIv_o.png" alt="hive变量"></p> 
<h4><a id="_4323"></a>引用变量</h4> 
<blockquote> 
 <p>定义变量</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> hivevar:userId<span class="token operator">=</span>user_id<span class="token punctuation">;</span>
<span class="token keyword">set</span> hivevar:userName<span class="token operator">=</span>user_name<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>引用变量</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> t_user<span class="token punctuation">(</span>${userId} <span class="token keyword">int</span><span class="token punctuation">,</span> ${userName} string<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>查找表</p> 
</blockquote> 
<pre><code>show tables;
</code></pre> 
<blockquote> 
 <p>查看表信息</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">describe</span> t_user<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>删除表</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> t_user
</code></pre> 
<p><img src="https://images2.imgbox.com/1a/e8/bLwla0Z0_o.png" alt="hive变量"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f2fc3994db0af61a8221dcd6ff855c13/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">node16.17.0安装教程(win)支持其他版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/68035450a131662c104380e65c4493bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">How to design a database storage model for the community version of the water information system</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>