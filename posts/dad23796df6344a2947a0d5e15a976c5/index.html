<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>水果数据集(Fruit-Dataset )&#43;水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2) - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="水果数据集(Fruit-Dataset )&#43;水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2)" />
<meta property="og:description" content="水果数据集(Fruit-Dataset )&#43;水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2) 目录
水果数据集(Fruit-Dataset )&#43;水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2)
1. 前言
2. Fruit-Dataset水果数据集
（1）Fruit-Dataset
（2）Fruits 360蔬果数据集
（3）自定义数据集
3. 水果分类识别模型训练
（1）项目安装
（2）准备Train和Test数据
（3）配置文件：​config.yaml​
（4）开始训练
（5）可视化训练过程
（6）一些优化建议
（7） 一些运行错误处理方法：
cannot import name &#39;load_state_dict_from_url&#39; 4. 水果分类识别模型测试效果
5.项目源码下载
1. 前言 本项目将采用深度学习的方法，搭建一个水果分类识别的训练和测试系统，实现一个简单的水果图像分类识别系统。目前，基于ResNet18的水果分类识别，支持262种水果分类识别，在水果数据集Fruit-Dataset上，训练集的Accuracy在95%左右，测试集的Accuracy在83%左右，骨干网络，可支持googlenet, resnet[18,34,50], inception_v3，mobilenet_v2等常用模型。如果想进一步提高准确率，可以尝试：
最重要的： 清洗数据集，水果数据集Fruits-Dataset，部分数据是通过网上爬取的，存在部分错误的图片，尽管鄙人已经清洗一部分了，但还是建议你，训练前，再次清洗数据集，不然会影响模型的识别的准确率。减少种类：Fruit-Dataset共有262种类水果，可以剔除部分不常见的水果使用不同backbone模型，比如resnet50或者更深的模型增加数据增强： 已经支持： 随机裁剪，随机翻转，随机旋转，颜色变换等数据增强方式，可以尝试诸如mixup，CutMix等更复杂的数据增强方式样本均衡： 建议进行样本均衡处理调超参： 比如学习率调整策略，优化器（SGD,Adam等）损失函数： 目前训练代码已经支持：交叉熵，LabelSmoothing，可以尝试FocalLoss等损失函数 【源码下载】Fruit-Dataset水果数据集&#43;水果分类识别训练代码
【尊重原创，转载请注明出处】https://panjinquan.blog.csdn.net/article/details/126411788
2. Fruit-Dataset水果数据集 （1）Fruit-Dataset 这里分享一个水果数据集Fruit -Dataset，该数据集包含 262 种不同种类的水果，包含常见的苹果(apple )，香蕉(banana )等种类，总共有225,640 张水果图像，可满足深度学习水果种类分类识别的需求。 Fruit-Dataset包含的262种水果，分别是：
abiu, acai, acerola, ackee, alligator apple, ambarella, apple, apricot, araza, avocado, bael, banana, barbadine, barberry, bayberry, beach plum, bearberry, bell pepper, betel nut, bignay, bilimbi, bitter gourd, black berry, black cherry, black currant, black mullberry, black sapote, blueberry, bolwarra, bottle gourd, brazil nut, bread fruit, buddha s hand, buffaloberry, burdekin plum, burmese grape, caimito, camu camu, canistel, cantaloupe, cape gooseberry, carambola, cardon, cashew, cedar bay cherry, cempedak, ceylon gooseberry, che, chenet, cherimoya, cherry, chico, chokeberry, clementine, cloudberry, cluster fig, cocoa bean, coconut, coffee, common buckthorn, corn kernel, cornelian cherry, crab apple, cranberry, crowberry, cupuacu, custard apple, damson, date, desert fig, desert lime, dewberry, dragonfruit, durian, eggplant, elderberry, elephant apple, emblic, entawak, etrog, feijoa, fibrous satinash, fig, finger lime, galia melon, gandaria, genipap, goji, gooseberry, goumi, grape, grapefruit, greengage, grenadilla, guanabana, guarana, guava, guavaberry, hackberry, hard kiwi, hawthorn, hog plum, honeyberry, honeysuckle, horned melon, illawarra plum, indian almond, indian strawberry, ita palm, jaboticaba, jackfruit, jalapeno, jamaica cherry, jambul, japanese raisin, jasmine, jatoba, jocote, jostaberry, jujube, juniper berry, kaffir lime, kahikatea, kakadu plum, keppel, kiwi, kumquat, kundong, kutjera, lablab, langsat, lapsi, lemon, lemon aspen, leucaena, lillipilli, lime, lingonberry, loganberry, longan, loquat, lucuma, lulo, lychee, mabolo, macadamia, malay apple, mamey apple, mandarine, mango, mangosteen, manila tamarind, marang, mayhaw, maypop, medlar, melinjo, melon pear, midyim, miracle fruit, mock strawberry, monkfruit, monstera deliciosa, morinda, mountain papaya, mountain soursop, mundu, muskmelon, myrtle, nance, nannyberry, naranjilla, native cherry, native gooseberry, nectarine, neem, nungu, nutmeg, oil palm, old world sycomore, olive, orange, oregon grape, otaheite apple, papaya, passion fruit, pawpaw, pea, peanut, pear, pequi, persimmon, pigeon plum, pigface, pili nut, pineapple, pineberry, pitomba, plumcot, podocarpus, pomegranate, pomelo, prikly pear, pulasan, pumpkin, pupunha, purple apple berry, quandong, quince, rambutan, rangpur, raspberry, red mulberry, redcurrant, riberry, ridged gourd, rimu, rose hip, rose myrtle, rose-leaf bramble, saguaro, salak, salal, salmonberry, sandpaper fig, santol, sapodilla, saskatoon, sea buckthorn, sea grape, snowberry, soncoya, strawberry, strawberry guava, sugar apple, surinam cherry, sycamore fig, tamarillo, tangelo, tanjong, taxus baccata, tayberry, texas persimmon, thimbleberry, tomato, toyon, ugli fruit, vanilla, velvet tamarind, watermelon, wax gourd, white aspen, white currant, white mulberry, white sapote, wineberry, wongi, yali pear, yellow plum, yuzu, zigzag vine, zucchini Fruit-Dataset数据说明： 一个目录名代表一个标签，每个目录中该标签下的所有图像数据（图像有编号，但可能缺少数字。同一种水果的不同品种一般存放在同一个目录下（例如：青苹果、黄苹果和红苹果）。数据集中存在的水果图像可以包含水果在其生命的所有阶段，也可以包含水果切片。图像包含至少 50% 的水果信息。图像的背景可以是任何东西：单色背景、人手、水果的自然栖息地、树叶等。没有重复的图像，但有一些图像（具有相同标签）具有高度相似性。图像可能包含小水印。部分不常见的水果，数据较难采集，只有 50~100 张图像，实际工程中，可以丢弃以获得更好的平衡和更少的种类。 水果数据集Fruit-Dataset，水果数据集Fruit-Dataset，部分数据是通过网上爬取的，存在部分错误的图片，尽管鄙人已经清洗一部分了，但还是建议你，训练前，再次清洗数据集，不然会影响模型的识别的准确率。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/dad23796df6344a2947a0d5e15a976c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-13T16:53:57+08:00" />
<meta property="article:modified_time" content="2023-03-13T16:53:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">水果数据集(Fruit-Dataset )&#43;水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="Fruit-Dataset%E6%B0%B4%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86%2B%E6%B0%B4%E6%9E%9C%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E8%AE%AD%E7%BB%83%E4%BB%A3%E7%A0%81(%E6%94%AF%E6%8C%81googlenet%2C%20resnet%2C%20inception_v3%2C%20mobilenet_v2)" style="text-align:center;">水果数据集(Fruit-Dataset )+水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2)</h2> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="Fruit-Dataset%E6%B0%B4%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86%2B%E6%B0%B4%E6%9E%9C%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E8%AE%AD%E7%BB%83%E4%BB%A3%E7%A0%81(%E6%94%AF%E6%8C%81googlenet%2C%20resnet%2C%20inception_v3%2C%20mobilenet_v2)-toc" style="margin-left:0px;"><a href="#Fruit-Dataset%E6%B0%B4%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86%2B%E6%B0%B4%E6%9E%9C%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E8%AE%AD%E7%BB%83%E4%BB%A3%E7%A0%81%28%E6%94%AF%E6%8C%81googlenet%2C%20resnet%2C%20inception_v3%2C%20mobilenet_v2%29" rel="nofollow">水果数据集(Fruit-Dataset )+水果分类识别训练代码(支持googlenet, resnet, inception_v3, mobilenet_v2)</a></p> 
<p id="1.%20%E5%89%8D%E8%A8%80-toc" style="margin-left:40px;"><a href="#1.%20%E5%89%8D%E8%A8%80" rel="nofollow">1. 前言</a></p> 
<p id="2.%20Fruit-Dataset%E6%B0%B4%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86-toc" style="margin-left:40px;"><a href="#2.%20Fruit-Dataset%E6%B0%B4%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86" rel="nofollow">2. Fruit-Dataset水果数据集</a></p> 
<p id="%EF%BC%881%EF%BC%89%20Fruit-Dataset-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%20Fruit-Dataset" rel="nofollow">（1）Fruit-Dataset</a></p> 
<p id="%EF%BC%882%EF%BC%89Fruits%20360%E8%94%AC%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86-toc" style="margin-left:80px;"><a href="#%EF%BC%882%EF%BC%89Fruits%20360%E8%94%AC%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86" rel="nofollow">（2）Fruits 360蔬果数据集</a></p> 
<p id="%EF%BC%883%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86" rel="nofollow">（3）自定义数据集</a></p> 
<p id="3.%20%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83-toc" style="margin-left:40px;"><a href="#3.%20%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83" rel="nofollow">3. 水果分类识别模型训练</a></p> 
<p id="%EF%BC%881%EF%BC%89%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6%E8%AF%B4%E6%98%8E-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6%E8%AF%B4%E6%98%8E" rel="nofollow">（1）项目安装</a></p> 
<p id="%EF%BC%881%EF%BC%89%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE" rel="nofollow">（2）准备Train和Test数据</a></p> 
<p id="%EF%BC%883%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%9Aconfig.yaml-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%9Aconfig.yaml" rel="nofollow">（3）配置文件：​config.yaml​</a></p> 
<p id="%EF%BC%883%EF%BC%89%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83" rel="nofollow">（4）开始训练</a></p> 
<p id="%EF%BC%883%EF%BC%89%20%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B-toc" style="margin-left:80px;"><a href="#%EF%BC%883%EF%BC%89%20%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B" rel="nofollow">（5）可视化训练过程</a></p> 
<p id="%EF%BC%885%EF%BC%89%E4%B8%80%E4%BA%9B%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE-toc" style="margin-left:80px;"><a href="#%EF%BC%885%EF%BC%89%E4%B8%80%E4%BA%9B%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE" rel="nofollow">（6）一些优化建议</a></p> 
<p id="%EF%BC%887%EF%BC%89%20%E4%B8%80%E4%BA%9B%E8%BF%90%E8%A1%8C%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%EF%BC%887%EF%BC%89%20%E4%B8%80%E4%BA%9B%E8%BF%90%E8%A1%8C%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%EF%BC%9A" rel="nofollow">（7） 一些运行错误处理方法：</a></p> 
<p id="cannot%20import%20name%20'load_state_dict_from_url'%C2%A0-toc" style="margin-left:80px;"><a href="#cannot%20import%20name%20'%20rel=">cannot import name 'load_state_dict_from_url' </a></p> 
<p id="4.%20%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C-toc" style="margin-left:40px;"><a href="#4.%20%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C" rel="nofollow">4. 水果分类识别模型测试效果</a></p> 
<p id="5.%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD-toc" style="margin-left:40px;"><a href="#5.%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD" rel="nofollow">5.项目源码下载</a></p> 
<hr> 
<h3 id="1.%20%E5%89%8D%E8%A8%80">1. 前言</h3> 
<p>本项目将采用深度学习的方法，搭建一个水果分类识别的训练和测试系统，实现一个简单的水果<strong>图像分类识别系统</strong>。目前，基于ResNet18的水果分类识别，<strong>支持<span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">262种</span></span></span>水果分类识别</strong>，在水果数据集Fruit-Dataset上，训练集的Accuracy在95%左右，测试集的Accuracy在83%左右，骨干网络，可支持googlenet, resnet[18,34,50], inception_v3，mobilenet_v2等常用模型。如果想进一步提高准确率，可以尝试：</p> 
<p class="img-center"><img alt="" height="350" src="https://images2.imgbox.com/d5/fd/jSWwOK8k_o.png" width="572"></p> 
<blockquote> 
 <ol><li><strong>最重要的</strong>： 清洗数据集，水果数据集Fruits-Dataset，部分数据是通过网上爬取的，存在部分错误的图片，尽管鄙人已经清洗一部分了，但还是建议你，训练前，再次清洗数据集，不然会影响模型的识别的准确率。</li><li>减少种类：Fruit-Dataset共有262种类水果，可以剔除部分不常见的水果</li><li>使用不同backbone模型，比如resnet50或者更深的模型</li><li>增加数据增强： 已经支持：<strong> 随机裁剪，随机翻转，随机旋转，颜色变换</strong>等数据增强方式，可以尝试诸如<strong>mixup，CutMix</strong>等更复杂的数据增强方式</li><li>样本均衡： 建议进行样本均衡处理</li><li>调超参： 比如学习率调整策略，优化器（SGD,Adam等）</li><li>损失函数： 目前训练代码已经支持：交叉熵，LabelSmoothing，可以尝试FocalLoss等损失函数</li></ol> 
</blockquote> 
<p>【源码下载】<a href="https://mp.weixin.qq.com/s/NUdeFfPpxKT0Oi9XThVi3g" rel="nofollow" title="Fruit-Dataset水果数据集+水果分类识别训练代码">Fruit-Dataset水果数据集+水果分类识别训练代码</a></p> 
<p>【尊重原创，转载请注明出处】<a href="https://panjinquan.blog.csdn.net/article/details/126411788" rel="nofollow" title="https://panjinquan.blog.csdn.net/article/details/126411788">https://panjinquan.blog.csdn.net/article/details/126411788</a></p> 
<h3 id="2.%20Fruit-Dataset%E6%B0%B4%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86" style="margin-left:0px;">2. Fruit-Dataset水果数据集</h3> 
<h4 id="%EF%BC%881%EF%BC%89%20Fruit-Dataset">（1）Fruit-Dataset</h4> 
<div style="margin-left:0;"> 
 <span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">这里分享一个水果数据集</span></span></span>Fruit 
 <span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">-Dataset，该数据集包含 262 种不同种类的水果，包含常见的苹果(</span></span></span>apple 
 <span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">)，香蕉(</span></span></span>banana 
 <span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">)等种类，总共有225,640 张水果图像，可满足深度学习水果种类分类识别的需求。</span></span></span> 
</div> 
<div style="margin-left:0;"> 
 <table border="1" cellpadding="1" cellspacing="1" style="width:700px;"><tbody><tr><td style="width:378px;"><img alt="" class="left" height="350" src="https://images2.imgbox.com/77/09/n07Px9y6_o.png" width="572"></td><td style="width:320px;"><img alt="" height="350" src="https://images2.imgbox.com/27/7a/DFCYWxga_o.png" width="540"></td></tr><tr><td style="width:378px;"><img alt="" height="558" src="https://images2.imgbox.com/9a/b5/DWZpP0eu_o.png" width="693"></td><td style="width:320px;"><img alt="" height="609" src="https://images2.imgbox.com/a6/49/69pe5tIn_o.png" width="699"></td></tr></tbody></table> 
 <p> Fruit-Dataset包含的<span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">262种</span></span></span>水果，分别是：</p> 
</div> 
<blockquote> 
 <div style="margin-left:0;">
   abiu, acai, acerola, ackee, alligator apple, ambarella, apple, apricot, araza, avocado, bael, banana, barbadine, barberry, bayberry, beach plum, bearberry, bell pepper, betel nut, bignay, bilimbi, bitter gourd, black berry, black cherry, black currant, black mullberry, black sapote, blueberry, bolwarra, bottle gourd, brazil nut, bread fruit, buddha s hand, buffaloberry, burdekin plum, burmese grape, caimito, camu camu, canistel, cantaloupe, cape gooseberry, carambola, cardon, cashew, cedar bay cherry, cempedak, ceylon gooseberry, che, chenet, cherimoya, cherry, chico, chokeberry, clementine, cloudberry, cluster fig, cocoa bean, coconut, coffee, common buckthorn, corn kernel, cornelian cherry, crab apple, cranberry, crowberry, cupuacu, custard apple, damson, date, desert fig, desert lime, dewberry, dragonfruit, durian, eggplant, elderberry, elephant apple, emblic, entawak, etrog, feijoa, fibrous satinash, fig, finger lime, galia melon, gandaria, genipap, goji, gooseberry, goumi, grape, grapefruit, greengage, grenadilla, guanabana, guarana, guava, guavaberry, hackberry, hard kiwi, hawthorn, hog plum, honeyberry, honeysuckle, horned melon, illawarra plum, indian almond, indian strawberry, ita palm, jaboticaba, jackfruit, jalapeno, jamaica cherry, jambul, japanese raisin, jasmine, jatoba, jocote, jostaberry, jujube, juniper berry, kaffir lime, kahikatea, kakadu plum, keppel, kiwi, kumquat, kundong, kutjera, lablab, langsat, lapsi, lemon, lemon aspen, leucaena, lillipilli, lime, lingonberry, loganberry, longan, loquat, lucuma, lulo, lychee, mabolo, macadamia, malay apple, mamey apple, mandarine, mango, mangosteen, manila tamarind, marang, mayhaw, maypop, medlar, melinjo, melon pear, midyim, miracle fruit, mock strawberry, monkfruit, monstera deliciosa, morinda, mountain papaya, mountain soursop, mundu, muskmelon, myrtle, nance, nannyberry, naranjilla, native cherry, native gooseberry, nectarine, neem, nungu, nutmeg, oil palm, old world sycomore, olive, orange, oregon grape, otaheite apple, papaya, passion fruit, pawpaw, pea, peanut, pear, pequi, persimmon, pigeon plum, pigface, pili nut, pineapple, pineberry, pitomba, plumcot, podocarpus, pomegranate, pomelo, prikly pear, pulasan, pumpkin, pupunha, purple apple berry, quandong, quince, rambutan, rangpur, raspberry, red mulberry, redcurrant, riberry, ridged gourd, rimu, rose hip, rose myrtle, rose-leaf bramble, saguaro, salak, salal, salmonberry, sandpaper fig, santol, sapodilla, saskatoon, sea buckthorn, sea grape, snowberry, soncoya, strawberry, strawberry guava, sugar apple, surinam cherry, sycamore fig, tamarillo, tangelo, tanjong, taxus baccata, tayberry, texas persimmon, thimbleberry, tomato, toyon, ugli fruit, vanilla, velvet tamarind, watermelon, wax gourd, white aspen, white currant, white mulberry, white sapote, wineberry, wongi, yali pear, yellow plum, yuzu, zigzag vine, zucchini 
 </div> 
</blockquote> 
<div style="margin-left:0;"> 
 <span style="color:#000000;"><span style="background-color:#ffffff;"><span style="color:#5f6368;">Fruit-Dataset数据</span></span></span>说明： 
</div> 
<div style="margin-left:0;"> 
 <blockquote> 
  <ul><li>一个目录名代表一个标签，每个目录中该标签下的所有图像数据（图像有编号，但可能缺少数字。</li><li>同一种水果的不同品种一般存放在同一个目录下（例如：青苹果、黄苹果和红苹果）。</li><li>数据集中存在的水果图像可以包含水果在其生命的所有阶段，也可以包含水果切片。</li><li>图像包含至少 50% 的水果信息。</li><li>图像的背景可以是任何东西：单色背景、人手、水果的自然栖息地、树叶等。</li><li>没有重复的图像，但有一些图像（具有相同标签）具有高度相似性。</li><li>图像可能包含小水印。</li><li>部分不常见的水果，数据较难采集，只有 50~100 张图像，实际工程中，可以丢弃以获得更好的平衡和更少的种类。</li></ul> 
 </blockquote> 
</div> 
<p><span style="color:#fe2c24;">水果数据集<span style="background-color:#ffffff;">Fruit-Dataset</span>，水果数据集Fruit-Dataset，部分数据是通过网上爬取的，存在部分错误的图片，尽管鄙人已经清洗一部分了，但还是建议你，训练前，再次清洗数据集，不然会影响模型的识别的准确率。</span></p> 
<h4 id="%EF%BC%882%EF%BC%89Fruits%20360%E8%94%AC%E6%9E%9C%E6%95%B0%E6%8D%AE%E9%9B%86">（2）Fruits 360蔬果数据集</h4> 
<p>Fruits 360蔬果数据集包含131种不同的水果和蔬菜，共含有90483张图片，其中</p> 
<ul><li>训练集⼤⼩：67692张图像（每张图像⼀个⽔果），</li><li>测试集⼤⼩：22688张图像（每张图像⼀个⽔果）</li><li>⽂件名格式：图像索引_100.jpg（例如32_100.jpg）或r_图像索引_100.jpg（例如r_32_100.jpg）或r2_图像索引_100.jpg或r3_图像索引_100.jpg。“ r”代表旋转的⽔果。“ r2”表⽰⽔果绕第三轴旋转。“100”来⾃图像尺⼨（100x100像素）。同⼀⽔果（例如苹果）的不同品种被存储为属于不同类别。</li></ul> 
<p><img alt="" height="253" src="https://images2.imgbox.com/85/30/qEwR5D5d_o.png" width="493"></p> 
<p></p> 
<p><img alt="" src="https://images2.imgbox.com/af/21/9DE1fwPB_o.png"></p> 
<p> 具体有以下种类：</p> 
<blockquote> 
 <p>Apples (different varieties: Crimson Snow, Golden, Golden-Red, Granny Smith, Pink Lady, Red, Red Delicious), Apricot, Avocado, Avocado ripe, Banana (Yellow, Red, Lady Finger), Beetroot Red, Blueberry, Cactus fruit, Cantaloupe (2 varieties), Carambula, Cauliflower, Cherry (different varieties, Rainier), Cherry Wax (Yellow, Red, Black), Chestnut, Clementine, Cocos, Dates, Eggplant, Ginger Root, Granadilla, Grape (Blue, Pink, White (different varieties)), Grapefruit (Pink, White), Guava, Hazelnut, Huckleberry, Kiwi, Kaki, Kohlrabi, Kumsquats, Lemon (normal, Meyer), Lime, Lychee, Mandarine, Mango (Green, Red), Mangostan, Maracuja, Melon Piel de Sapo, Mulberry, Nectarine (Regular, Flat), Nut (Forest, Pecan), Onion (Red, White), Orange, Papaya, Passion fruit, Peach (different varieties), Pepino, Pear (different varieties, Abate, Forelle, Kaiser, Monster, Red, Williams), Pepper (Red, Green, Yellow), Physalis (normal, with Husk), Pineapple (normal, Mini), Pitahaya Red, Plum (different varieties), Pomegranate, Pomelo Sweetie, Potato (Red, Sweet, White), Quince, Rambutan, Raspberry, Redcurrant, Salak, Strawberry (normal, Wedge), Tamarillo, Tangelo, Tomato (different varieties, Maroon, Cherry Red, Yellow), Walnut.</p> 
</blockquote> 
<p>Fruits 360蔬果数据集<span style="color:#fe2c24;">的图片质量特别高，很干净，几乎每张图片的水果背景都是白色的（可能是被抠出背景了），而且存在很多旋转拍照角度的高度相似的图片。因此这种水果数据集，不太符合实际业务需求，毕竟实际应用中，我们不太可能将图片抠除背景再进行水果识别，这识别成本太高了。</span></p> 
<h4 id="%EF%BC%883%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E9%9B%86">（3）自定义数据集</h4> 
<p>如果需要新增类别数据，或者需要自定数据集进行训练，可以如下进行处理：</p> 
<ul><li>Train和Test数据集，要求相同类别的图片，放在同一个文件夹下；且子目录文件夹命名为类别名称，如</li></ul> 
<p><img alt="" height="352" src="https://images2.imgbox.com/12/53/6swO6NTh_o.png" width="317"></p> 
<ul><li>类别文件：一行一个列表：​class_name.txt​ <pre> (最后一行,请多回车一行)</pre> </li></ul> 
<pre><code class="language-bash">A
B
C
D

</code></pre> 
<ul><li>修改配置文件的数据路径：​config.yaml​</li></ul> 
<pre><code class="language-bash">train_data: # 可添加多个数据集
  - 'data/dataset/train1' 
  - 'data/dataset/train2'
test_data: 'data/dataset/test'
class_name: 'data/dataset/class_name.txt'
...
...</code></pre> 
<hr> 
<h3 id="3.%20%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83">3. 水果分类识别模型训练</h3> 
<p>考虑到Fruits 360蔬果数据集比较简单，且不合适用于实际应用中，因此本项目以Fruit-Dataset水果数据集为训练样本。</p> 
<h4 id="%EF%BC%881%EF%BC%89%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6%E8%AF%B4%E6%98%8E">（1）项目安装</h4> 
<p>整套工程基本框架结构如下：</p> 
<pre><code class="language-bash">.
├── classifier                 # 训练模型相关工具
├── configs                    # 训练配置文件
├── data                       # 训练数据
├── libs           
├── demo.py              # 模型推理demo
├── README.md            # 项目工程说明文档
├── requirements.txt     # 项目相关依赖包
└── train.py             # 训练文件</code></pre> 
<p>   项目依赖python包请参考requirements.txt，使用pip安装即可：</p> 
<pre><code class="language-bash">numpy==1.16.3
matplotlib==3.1.0
Pillow==6.0.0
easydict==1.9
opencv-contrib-python==4.5.2.52
opencv-python==4.5.1.48
pandas==1.1.5
PyYAML==5.3.1
scikit-image==0.17.2
scikit-learn==0.24.0
scipy==1.5.4
seaborn==0.11.2
tensorboard==2.5.0
tensorboardX==2.1
torch==1.7.1+cu110
torchvision==0.8.2+cu110
tqdm==4.55.1
xmltodict==0.12.0
basetrainer
pybaseutils==0.6.5</code></pre> 
<p> 项目安装教程请参考（<strong>初学者入门，麻烦先看完下面教程，配置好开发环境</strong>）：</p> 
<blockquote> 
 <ul><li><a href="https://blog.csdn.net/guyuealian/article/details/129163343" title="项目开发使用教程和常见问题和解决方法">项目开发使用教程和常见问题和解决方法</a></li><li><strong>视频教程：</strong><a href="https://www.bilibili.com/video/BV1sY411c7JS/?spm_id_from=333.999.0.0" rel="nofollow" title="1 手把手教你安装CUDA和cuDNN(1)">1 手把手教你安装CUDA和cuDNN(1)</a></li><li><strong>视频教程：</strong><a href="https://www.bilibili.com/video/BV1q5411d7GD/?spm_id_from=333.999.0.0" rel="nofollow" title="2 手把手教你安装CUDA和cuDNN(2)">2 手把手教你安装CUDA和cuDNN(2)</a></li><li><strong>视频教程：</strong><a href="https://www.bilibili.com/video/BV18Y411c7Qt/?spm_id_from=333.999.0.0" rel="nofollow" title="3 如何用Anaconda创建pycharm环境">3 如何用Anaconda创建pycharm环境</a></li><li><strong>视频教程：</strong><a href="https://www.bilibili.com/video/BV1SY4y1z7eS/?spm_id_from=333.999.0.0" rel="nofollow" title="4 如何在pycharm中使用Anaconda创建的python环境">4 如何在pycharm中使用Anaconda创建的python环境</a></li></ul> 
</blockquote> 
<h4 id="%EF%BC%881%EF%BC%89%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE">（2）准备Train和Test数据</h4> 
<p>下载水果分类数据集，Train和Test数据集，要求相同类别的图片，放在同一个文件夹下；且子目录文件夹命名为类别名称。</p> 
<p>数据增强方式主要采用：<strong> 随机裁剪，随机翻转，随机旋转，颜色变换</strong>等处理方式</p> 
<pre><code class="language-python">import numbers
import random
import PIL.Image as Image
import numpy as np
from torchvision import transforms


def image_transform(input_size, rgb_mean=[0.5, 0.5, 0.5], rgb_std=[0.5, 0.5, 0.5], trans_type="train"):
    """
    不推荐使用：RandomResizedCrop(input_size), # bug:目标容易被crop掉
    :param input_size: [w,h]
    :param rgb_mean:
    :param rgb_std:
    :param trans_type:
    :return::
    """
    if trans_type == "train":
        transform = transforms.Compose([
            transforms.Resize([int(128 * input_size[1] / 112), int(128 * input_size[0] / 112)]),
            transforms.RandomHorizontalFlip(),  # 随机左右翻转
            # transforms.RandomVerticalFlip(), # 随机上下翻转
            transforms.ColorJitter(brightness=0.5, contrast=0.5, saturation=0.5, hue=0.1),
            transforms.RandomRotation(degrees=5),
            transforms.RandomCrop([input_size[1], input_size[0]]),
            transforms.ToTensor(),
            transforms.Normalize(mean=rgb_mean, std=rgb_std),
        ])
    elif trans_type == "val" or trans_type == "test":
        transform = transforms.Compose([
            transforms.Resize([input_size[1], input_size[0]]),
            # transforms.CenterCrop([input_size[1], input_size[0]]),
            # transforms.Resize(input_size),
            transforms.ToTensor(),
            transforms.Normalize(mean=rgb_mean, std=rgb_std),
        ])
    else:
        raise Exception("transform_type ERROR:{}".format(trans_type))
    return transform</code></pre> 
<p>修改配置文件数据路径：​config.yaml​</p> 
<pre><code class="language-bash"># 训练数据集，可支持多个数据集
train_data:
  - '/path/to/Fruit-Dataset/train'
# 测试数据集
test_data: '/path/to/Fruit-Dataset/test'
# 类别文件
class_name: '/path/to/Fruit-Dataset/class_name.txt'</code></pre> 
<h4 id="%EF%BC%883%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%9Aconfig.yaml">（3）配置文件：​config.yaml​</h4> 
<blockquote> 
 <ul><li>目前支持的backbone有：googlenet,resnet[18,34,50],inception_v3,mobilenet_v2等， 其他backbone可以自定义添加</li><li>训练参数可以通过(configs/config.yaml)配置文件进行设置</li></ul> 
</blockquote> 
<p> 配置文件：​config.yaml​说明如下：</p> 
<pre><code class="language-bash"># 训练数据集，可支持多个数据集
train_data:
  - '/path/to/Fruit-Dataset/train'
# 测试数据集
test_data: '/path/to/Fruit-Dataset/test'
# 类别文件
class_name: '/path/to/Fruit-Dataset/class_name.txt'
train_transform: "train"       # 训练使用的数据增强方法
test_transform: "val"          # 测试使用的数据增强方法
work_dir: "work_space/"        # 保存输出模型的目录
net_type: "resnet18"           # 骨干网络,支持：resnet18/50,mobilenet_v2,googlenet,inception_v3
width_mult: 1.0
input_size: [ 224,224 ]        # 模型输入大小
rgb_mean: [ 0.5, 0.5, 0.5 ]    # for normalize inputs to [-1, 1],Sequence of means for each channel.
rgb_std: [ 0.5, 0.5, 0.5 ]     # for normalize,Sequence of standard deviations for each channel.
batch_size: 32
lr: 0.01                       # 初始学习率
optim_type: "SGD"              # 选择优化器，SGD,Adam
loss_type: "CrossEntropyLoss"  # 选择损失函数：支持CrossEntropyLoss,LabelSmoothing
momentum: 0.9                  # SGD momentum
num_epochs: 100                # 训练循环次数
num_warn_up: 3                 # warn-up次数
num_workers: 8                 # 加载数据工作进程数
weight_decay: 0.0005           # weight_decay，默认5e-4
scheduler: "multi-step"        # 学习率调整策略
milestones: [ 20,50,80 ]       # 下调学习率方式
gpu_id: [ 0 ]                  # GPU ID
log_freq: 50                   # LOG打印频率
progress: True                 # 是否显示进度条
pretrained: False              # 是否使用pretrained模型
finetune: False                # 是否进行finetune</code></pre> 
<p></p> 
<table><thead><tr><th><strong>参数</strong></th><th><strong>类型</strong></th><th><strong>参考值</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><strong>train_data</strong></td><td>str, list</td><td>-</td><td>训练数据文件，可支持多个文件</td></tr><tr><td><strong>test_data</strong></td><td>str, list</td><td>-</td><td>测试数据文件，可支持多个文件</td></tr><tr><td><strong>class_name</strong></td><td>str</td><td>-</td><td>类别文件</td></tr><tr><td><strong>work_dir</strong></td><td>str</td><td>work_space</td><td>训练输出工作空间</td></tr><tr><td><strong>net_type</strong></td><td>str</td><td>resnet18</td><td> <pre>backbone类型,{resnet18/50,mobilenet_v2,googlenet,inception_v3}</pre> </td></tr><tr><td><strong>input_size</strong></td><td>list</td><td>[128,128]</td><td>模型输入大小[W,H]</td></tr><tr><td><strong>batch_size</strong></td><td>int</td><td>32</td><td>batch size</td></tr><tr><td><strong>lr</strong></td><td>float</td><td>0.1</td><td>初始学习率大小</td></tr><tr><td><strong>optim_type</strong></td><td>str</td><td>SGD</td><td>优化器，{SGD,Adam}</td></tr><tr><td><strong>loss_type</strong></td><td>str</td><td>CELoss</td><td>损失函数</td></tr><tr><td><strong>scheduler</strong></td><td>str</td><td>multi-step</td><td>学习率调整策略，{multi-step,cosine}</td></tr><tr><td><strong>milestones</strong></td><td>list</td><td>[30,80,100]</td><td>降低学习率的节点，仅仅scheduler=multi-step有效</td></tr><tr><td><strong>momentum</strong></td><td>float</td><td>0.9</td><td>SGD动量因子</td></tr><tr><td><strong>num_epochs</strong></td><td>int</td><td>120</td><td>循环训练的次数</td></tr><tr><td><strong>num_warn_up</strong></td><td>int</td><td>3</td><td>warn_up的次数</td></tr><tr><td><strong>num_workers</strong></td><td>int</td><td>12</td><td>DataLoader开启线程数</td></tr><tr><td><strong>weight_decay</strong></td><td>float</td><td>5e-4</td><td>权重衰减系数</td></tr><tr><td><strong>gpu_id</strong></td><td>list</td><td>[ 0 ]</td><td>指定训练的GPU卡号，可指定多个</td></tr><tr><td><strong>log_freq</strong></td><td>in</td><td>20</td><td>显示LOG信息的频率</td></tr><tr><td><strong>finetune</strong></td><td>str</td><td>model.pth</td><td>finetune的模型</td></tr><tr><td><strong>progress</strong></td><td>bool</td><td>True</td><td>是否显示进度条</td></tr><tr><td><strong>distributed</strong></td><td>bool</td><td>False</td><td>是否使用分布式训练</td></tr></tbody></table> 
<h4 id="%EF%BC%883%EF%BC%89%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83">（4）开始训练</h4> 
<p>整套训练代码非常简单操作，用户只需要将相同类别的数据放在同一个目录下，并填写好对应的数据路径，即可开始训练了。</p> 
<pre><code class="language-bash">python train.py -c configs/config.yaml 
</code></pre> 
<h4 id="%EF%BC%883%EF%BC%89%20%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B">（5）可视化训练过程</h4> 
<pre>训练过程可视化工具是使用Tensorboard，使用方法，在终端输入：
</pre> 
<pre><code class="language-bash"># 基本方法
tensorboard --logdir=path/to/log/
# 例如
tensorboard --logdir=work_space/mobilenet_v2_1.0_CrossEntropyLoss/log

</code></pre> 
<p>可视化效果 </p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td>​<img alt="" height="173" src="https://images2.imgbox.com/f9/54/FyxhTncs_o.png" width="350"></td><td><img alt="" height="251" src="https://images2.imgbox.com/6b/41/hRbxBgMd_o.png" width="350">​</td></tr><tr><td>​<img alt="" height="240" src="https://images2.imgbox.com/52/9d/SL4nKUrp_o.png" width="339"></td><td>​<img alt="" height="242" src="https://images2.imgbox.com/c3/f3/dpXtgEit_o.png" width="339"></td></tr><tr><td>​<img alt="" height="243" src="https://images2.imgbox.com/a5/59/FCRvM2hN_o.png" width="339"></td><td><img alt="" height="243" src="https://images2.imgbox.com/87/46/1c0s2kO5_o.png" width="337">​</td></tr></tbody></table> 
<h4 id="%EF%BC%885%EF%BC%89%E4%B8%80%E4%BA%9B%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE">（6）一些优化建议</h4> 
<p>训练完成后，在水果数据集Fruit-Dataset上，训练集的Accuracy在95%左右，测试集的Accuracy在83%左右，骨干网络，可支持googlenet, resnet[18,34,50], inception_v3，mobilenet_v2等常用模型。如果想进一步提高准确率，可以尝试：</p> 
<blockquote> 
 <ol><li><strong>最重要的</strong>： 清洗数据集，水果数据集Fruit-Dataset，部分数据是通过网上爬取的，存在部分错误的图片，尽管鄙人已经清洗一部分了，但还是建议你，训练前，再次清洗数据集，不然会影响模型的识别的准确率。</li><li>使用不同backbone模型，比如resnet50或者更深的模型</li><li>增加数据增强： 已经支持：<strong> 随机裁剪，随机翻转，随机旋转，颜色变换</strong>等数据增强方式，可以尝试诸如<strong>mixup，CutMix</strong>等更复杂的数据增强方式</li><li>样本均衡： 建议进行样本均衡处理</li><li>调超参： 比如学习率调整策略，优化器（SGD,Adam等）</li><li>损失函数： 目前训练代码已经支持：交叉熵，LabelSmoothing，可以尝试FocalLoss等损失函数</li></ol> 
</blockquote> 
<h4 id="%EF%BC%887%EF%BC%89%20%E4%B8%80%E4%BA%9B%E8%BF%90%E8%A1%8C%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%EF%BC%9A">（7） 一些运行错误处理方法：</h4> 
<ul><li> <h4><span style="color:#fe2c24;"><strong>项目不要出现含有中文字符的目录文件或路径，否则会出现很多异常</strong>！！！！！！！！</span></h4> </li><li> <h4 id="cannot%20import%20name%20'load_state_dict_from_url'%C2%A0">cannot import name 'load_state_dict_from_url' </h4> </li></ul> 
<blockquote> 
 <p>由于一些版本升级，会导致部分接口函数不能使用，请确保版本对应</p> 
 <p>torch==1.7.1</p> 
 <p>torchvision==0.8.2</p> 
</blockquote> 
<p>或者将对应python文件将</p> 
<pre><code class="language-bash">from torchvision.models.resnet import model_urls, load_state_dict_from_url
</code></pre> 
<p>修改为：</p> 
<pre><code class="language-python">from torch.hub import load_state_dict_from_url
model_urls = {
    'mobilenet_v2': 'https://download.pytorch.org/models/mobilenet_v2-b0353104.pth',
    'resnet18': 'https://download.pytorch.org/models/resnet18-5c106cde.pth',
    'resnet34': 'https://download.pytorch.org/models/resnet34-333f7ec4.pth',
    'resnet50': 'https://download.pytorch.org/models/resnet50-19c8e357.pth',
    'resnet101': 'https://download.pytorch.org/models/resnet101-5d3b4d8f.pth',
    'resnet152': 'https://download.pytorch.org/models/resnet152-b121ed2d.pth',
    'resnext50_32x4d': 'https://download.pytorch.org/models/resnext50_32x4d-7cdf4587.pth',
    'resnext101_32x8d': 'https://download.pytorch.org/models/resnext101_32x8d-8ba56ff5.pth',
    'wide_resnet50_2': 'https://download.pytorch.org/models/wide_resnet50_2-95faca4d.pth',
    'wide_resnet101_2': 'https://download.pytorch.org/models/wide_resnet101_2-32ee1156.pth',
}
</code></pre> 
<hr> 
<h3 id="4.%20%E5%9E%83%E5%9C%BE%E5%88%86%E7%B1%BB%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C">4. 水果分类识别模型测试效果</h3> 
<p> demo.py文件用于推理和测试模型的效果，填写好配置文件，模型文件以及测试图片即可运行测试了</p> 
<pre><code class="language-python">def get_parser():
    # 配置文件
    config_file = "data/pretrained/resnet18_1.0_CrossEntropyLoss_20220826100725/config.yaml"
    # 模型文件
    model_file = "data/pretrained/resnet18_1.0_CrossEntropyLoss_20220826100725/model/best_model_098_83.5305.pth"
    # 待测试图片目录
    image_dir = "data/test_images/fruit"
    parser = argparse.ArgumentParser(description="Inference Argument")
    parser.add_argument("-c", "--config_file", help="configs file", default=config_file, type=str)
    parser.add_argument("-m", "--model_file", help="model_file", default=model_file, type=str)
    parser.add_argument("--device", help="cuda device id", default="cuda:0", type=str)
    parser.add_argument("--image_dir", help="image file or directory", default=image_dir, type=str)
    return parser
</code></pre> 
<pre><code class="language-python">#!/usr/bin/env bash
# Usage:
# python demo.py  -c "path/to/config.yaml" -m "path/to/model.pth" --image_dir "path/to/image_dir"

python demo.py   -c "data/pretrained/resnet18_1.0_CrossEntropyLoss_20220826100725/config.yaml" -m "data/pretrained/resnet18_1.0_CrossEntropyLoss_20220826100725/model/best_model_098_83.5305.pth" --image_dir "data/test_images/fruit"</code></pre> 
<p>运行测试结果： </p> 
<p><img alt="" height="243" src="https://images2.imgbox.com/b1/78/A9UilrPT_o.png" width="712"></p> 
<p></p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> <p style="text-align:center;"></p> <p style="text-align:center;"></p> <p class="img-center"><img alt="" height="255" src="https://images2.imgbox.com/cb/03/5WVPLiJf_o.png" width="403"></p> <p style="text-align:center;">pred_index:['apple'],pred_score:[0.9730666]</p> </td><td> <p style="text-align:center;"></p> <p class="img-center"><img alt="" height="253" src="https://images2.imgbox.com/0a/6b/F0jqpIt4_o.png" width="399"></p> <p style="text-align:center;"> pred_index:['apple'],pred_score:[0.8644004]</p> </td></tr><tr><td> <p style="text-align:center;"></p> <p class="img-center"><img alt="" height="254" src="https://images2.imgbox.com/e4/d9/gyU7zccV_o.png" width="401"></p> <p style="text-align:center;"> pred_index:['banana'],pred_score:[0.9996606]</p> <p style="text-align:center;"></p> </td><td> <p style="text-align:center;"></p> <p class="img-center"><img alt="" height="254" src="https://images2.imgbox.com/3d/23/jXIjlA4A_o.png" width="400"></p> <p style="text-align:center;"> pred_index:['banana'],pred_score:[0.99923694]</p> </td></tr></tbody></table> 
<hr> 
<h3 id="5.%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD">5.项目源码下载</h3> 
<p>整套项目源码内容包含：<a href="https://mp.weixin.qq.com/s/NUdeFfPpxKT0Oi9XThVi3g" rel="nofollow" title="Fruit-Dataset水果数据集+水果分类识别训练代码">Fruit-Dataset水果数据集+水果分类识别训练代码</a></p> 
<blockquote> 
 <ul><li>Fruit-Dataset水果数据集: 该数据集包含 262 种不同种类的水果，包含常见的苹果(apple)，香蕉(banana)等种类，总共有225,640 张水果图像，可满足深度学习水果种类分类识别的需求</li><li>Fruits 360蔬果数据集: 包含131种不同的水果和蔬菜，共含有90483张图片</li><li>支持自定义数据集训练</li><li>整套水果分类训练代码和测试代码（Pytorch版本）, 支持的backbone骨干网络模型有：googlenet,resnet[18,34,50],inception_v3,mobilenet_v2等， 其他backbone可以自定义添加</li></ul> 
</blockquote> 
<p> 【源码下载】<a href="https://mp.weixin.qq.com/s/NUdeFfPpxKT0Oi9XThVi3g" rel="nofollow" title="Fruit-Dataset水果数据集+水果分类识别训练代码">Fruit-Dataset水果数据集+水果分类识别训练代码</a></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/845e9874b1c848c423da050fde0fc5a2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">与C知道的第一次亲密接触</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b0719330bd8576081994b0a18831a5f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pg_dump的一些小技巧</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>