<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>K-means原理与算法改进及其python实现 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="K-means原理与算法改进及其python实现" />
<meta property="og:description" content="K-means入门学习 一、算法概述二、算法思想三、算法实现步骤四、算法图解五、算法优缺点六、k-means算法python实现6.1 sklearn聚类6.2 各省份消费数据聚类6.3 常规方法python实现 七、相关参数调整八、优化算法K-means&#43;&#43;8.1 kmeans不足之处8.2 kmeans&#43;&#43;8.3 层次聚类 一、算法概述 K-means聚类算法也称k均值聚类算法，是集简单和经典于一身的基于距离的聚类算法。它采用距离作为相似性的评价指标，即认为两个对象的距离越近，其相似度就越大。该算法认为类簇是由距离靠近的对象组成的，因此把得到紧凑且独立的簇作为最终目标。
K-Means算法主要解决的问题如下图所示。我们可以看到，在图的左边有一些点，我们可以看出来有三个点群，但是我们怎么才能将三个点群分为图右边的三个集群，这就是k-means算法能够解决的问题。
二、算法思想 K-means聚类算法是一种迭代求解的聚类分析算法，其步骤是随机选取K个对象作为初始的聚类中心，然后计算每个对象与各个种子聚类中心之间的距离，把每个对象分配给距离它最近的聚类中心。聚类中心以及分配给它们的对象就代表一个聚类。每分配一个样本，聚类的聚类中心会根据聚类中现有的对象被重新计算。这个过程将不断重复直到满足某个终止条件。终止条件可以是没有（或最小数目）对象被重新分配给不同的聚类，没有（或最小数目）聚类中心再发生变化，误差平方和局部最小。
三、算法实现步骤 指定需要划分的簇的个数K值（类的个数）;随机地选择K个数据对象作为初始的聚类中心（不一定要是我们的样本点，可以随机生成）计算其余的各个数据对象到这K个初始聚类中心的距离，把数据对象划归到距离它最近的那个中心所处在的簇类中调整新类并且重新计算出新类的中心（每个新集合质心）循环步骤三和四，看中心是否收敛（不变），如果收敛或达到迭代次数则停止循环 流程图如下：
四、算法图解 首先随机选择三个聚类中心；然后重复调整聚类中心位置；最终收敛，形成三个簇。
五、算法优缺点 优点：
对处理大数据集，该算法是相对高效率的。原理比较简单，实现也是很容易，收敛速度快。当结果簇是密集的，而簇与簇之间区别明显时, 它的效果较好。主要需要调参的参数仅仅是簇数k。 缺点：
要求用户必须事先给出要生成的簇的数目K。K值需要预先给定，很多情况下K值的估计是非常困难的。K-Means算法对初始选取的质心点是敏感的，不同的随机种子点得到的聚类结果完全不同 ，对结果影响很大。对噪音和异常点比较的敏感。用来检测异常值。采用迭代方法，可能只能得到局部的最优解，而无法得到全局的最优解。 六、k-means算法python实现 6.1 sklearn聚类 make_blobs函数是为聚类产生数据集，产生一个数据集和相应的标签
make_blobs方法：
sklearn.datasets.make_blobs(n_samples=100,n_features=2,centers=3, cluster_std=1.0,center_box=(-10.0,10.0),shuffle=True,random_state=None)
n_samples：表示数据样本点个数,默认值100
n_features：是每个样本的特征（或属性）数，也表示数据的维度，默认值是2
centers：表示类别数（标签的种类数），默认值3
cluster_std：表示每个类别的方差，例如我们希望生成2类数据，其中一类比另一类具有更大的方差，可以将cluster_std设置为[1.0,3.0]，浮点数或者浮点数序列，默认值1.0
center_box：中心确定之后的数据边界，默认值(-10.0, 10.0)
shuffle：将数据进行洗乱，默认值是True
random_state：官网解释是随机生成器的种子，可以固定生成的数据，给定数之后，每次生成的数据集就是固定的。若不给定值，则由于随机性将导致每次运行程序所获得的的结果可能有所不同。在使用数据生成器练习机器学习算法练习或python练习时建议给定数值。生成数据 from sklearn.cluster import KMeans from sklearn.datasets import make_blobs import matplotlib.pyplot as plt #参数： # n_samples=100 样本数量 # n_features=2 特征数量 # centers=3 中心点 #返回值： # X_train: 测试集 # y_train： 特征值 X_train,y_train = make_blobs(n_samples=100, n_features=2, centers=3) plt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0a63aafa0a90964c7e192e44f8a21f61/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-12T11:59:42+08:00" />
<meta property="article:modified_time" content="2022-08-12T11:59:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">K-means原理与算法改进及其python实现</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>K-means入门学习</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、算法概述</a></li><li><a href="#_6" rel="nofollow">二、算法思想</a></li><li><a href="#_8" rel="nofollow">三、算法实现步骤</a></li><li><a href="#_18" rel="nofollow">四、算法图解</a></li><li><a href="#_22" rel="nofollow">五、算法优缺点</a></li><li><a href="#kmeanspython_36" rel="nofollow">六、k-means算法python实现</a></li><li><ul><li><a href="#61_sklearn_37" rel="nofollow">6.1 sklearn聚类</a></li><li><a href="#62__83" rel="nofollow">6.2 各省份消费数据聚类</a></li><li><a href="#63_python_179" rel="nofollow">6.3 常规方法python实现</a></li></ul> 
  </li><li><a href="#_296" rel="nofollow">七、相关参数调整</a></li><li><a href="#Kmeans_355" rel="nofollow">八、优化算法K-means++</a></li><li><ul><li><a href="#81_kmeans_356" rel="nofollow">8.1 kmeans不足之处</a></li><li><a href="#82_kmeans_358" rel="nofollow">8.2 kmeans++</a></li><li><a href="#83__403" rel="nofollow">8.3 层次聚类</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、算法概述</h2> 
<p>K-means聚类算法也称k均值聚类算法，是集简单和经典于一身的基于距离的聚类算法。它采用距离作为相似性的评价指标，即认为两个对象的距离越近，其相似度就越大。该算法认为类簇是由距离靠近的对象组成的，因此把得到紧凑且独立的簇作为最终目标。</p> 
<p>K-Means算法主要解决的问题如下图所示。我们可以看到，在图的左边有一些点，我们可以看出来有三个点群，但是我们怎么才能将三个点群分为图右边的三个集群，这就是k-means算法能够解决的问题。<br> <img src="https://images2.imgbox.com/3c/97/GtQN2omq_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_6"></a>二、算法思想</h2> 
<p><code>K-means</code>聚类算法是一种迭代求解的聚类分析算法，其步骤是随机选取K个对象作为初始的聚类中心，然后计算每个对象与各个种子聚类中心之间的距离，把每个对象分配给距离它最近的聚类中心。聚类中心以及分配给它们的对象就代表一个聚类。每分配一个样本，聚类的聚类中心会根据聚类中现有的对象被重新计算。这个过程将不断重复直到满足某个终止条件。终止条件可以是没有（或最小数目）对象被重新分配给不同的聚类，没有（或最小数目）聚类中心再发生变化，误差平方和局部最小。</p> 
<h2><a id="_8"></a>三、算法实现步骤</h2> 
<ol><li>指定需要划分的簇的个数K值（类的个数）;</li><li>随机地选择K个数据对象作为初始的聚类中心（不一定要是我们的样本点，可以随机生成）</li><li>计算其余的各个数据对象到这K个初始聚类中心的距离，把数据对象划归到距离它最近的那个中心所处在的簇类中</li><li>调整新类并且重新计算出新类的中心（每个新集合质心）</li><li>循环步骤三和四，看中心是否收敛（不变），如果收敛或达到迭代次数则停止循环</li></ol> 
<p>流程图如下：<br> <img src="https://images2.imgbox.com/0a/37/RPXLEeqh_o.png" alt="在这里插入图片描述" width="400"></p> 
<h2><a id="_18"></a>四、算法图解</h2> 
<p>首先随机选择三个聚类中心；然后重复调整聚类中心位置；最终收敛，形成三个簇。<br> <img src="https://images2.imgbox.com/d9/63/DLV7cAMw_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_22"></a>五、算法优缺点</h2> 
<p><strong>优点</strong>：</p> 
<ol><li>对处理大数据集，该算法是相对高效率的。</li><li>原理比较简单，实现也是很容易，收敛速度快。</li><li>当结果簇是密集的，而簇与簇之间区别明显时, 它的效果较好。</li><li>主要需要调参的参数仅仅是簇数k。</li></ol> 
<p><strong>缺点</strong>：</p> 
<ol><li>要求用户必须事先给出要生成的簇的数目K。</li><li>K值需要预先给定，很多情况下K值的估计是非常困难的。</li><li>K-Means算法对初始选取的质心点是敏感的，不同的随机种子点得到的聚类结果完全不同 ，对结果影响很大。</li><li>对噪音和异常点比较的敏感。用来检测异常值。</li><li>采用迭代方法，可能只能得到局部的最优解，而无法得到全局的最优解。</li></ol> 
<h2><a id="kmeanspython_36"></a>六、k-means算法python实现</h2> 
<h3><a id="61_sklearn_37"></a>6.1 sklearn聚类</h3> 
<ol><li><code>make_blobs</code>函数是为聚类产生数据集，产生一个数据集和相应的标签<br> <strong>make_blobs方法</strong>：<br> <code>sklearn.datasets.make_blobs(n_samples=100,n_features=2,centers=3, cluster_std=1.0,center_box=(-10.0,10.0),shuffle=True,random_state=None)</code><br> <strong>n_samples</strong>：表示数据样本点个数,默认值100<br> <strong>n_features</strong>：是每个样本的特征（或属性）数，也表示数据的维度，默认值是2<br> <strong>centers</strong>：表示类别数（标签的种类数），默认值3<br> <strong>cluster_std</strong>：表示每个类别的方差，例如我们希望生成2类数据，其中一类比另一类具有更大的方差，可以将cluster_std设置为[1.0,3.0]，浮点数或者浮点数序列，默认值1.0<br> <strong>center_box</strong>：中心确定之后的数据边界，默认值(-10.0, 10.0)<br> <strong>shuffle</strong>：将数据进行洗乱，默认值是True<br> <strong>random_state</strong>：官网解释是随机生成器的种子，可以固定生成的数据，给定数之后，每次生成的数据集就是固定的。若不给定值，则由于随机性将导致每次运行程序所获得的的结果可能有所不同。在使用数据生成器练习机器学习算法练习或python练习时建议给定数值。</li><li>生成数据</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment">#参数：</span>
<span class="token comment"># n_samples=100  样本数量</span>
<span class="token comment"># n_features=2   特征数量</span>
<span class="token comment"># centers=3      中心点</span>
<span class="token comment">#返回值：</span>
<span class="token comment"># X_train:  测试集</span>
<span class="token comment"># y_train： 特征值</span>
X_train<span class="token punctuation">,</span>y_train <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>y_train<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>数据展示：<br> <img src="https://images2.imgbox.com/9b/6b/PNq5XBod_o.png" alt="在这里插入图片描述"><br> 3. 建立模型训练</p> 
<pre><code class="prism language-python"><span class="token comment">#参数</span>
<span class="token comment"># n_clusters  将预测结果分为几簇</span>
kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 获取模型</span>
kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>  <span class="token comment">#这里不需要给他答案 只把要分类的数据给他 即可</span>
</code></pre> 
<ol start="4"><li>预测</li></ol> 
<pre><code class="prism language-python">predict_y <span class="token operator">=</span> kmeans<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>predict_y<span class="token punctuation">)</span>  <span class="token comment">#预测结果</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>预测结果：<br> <img src="https://images2.imgbox.com/9a/ce/wT32D3HD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="62__83"></a>6.2 各省份消费数据聚类</h3> 
<ol><li>导入数据</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'data.xlsx'</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">"人均消费（元）"</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> 
<p>数据显示：</p> 
<pre><code class="prism language-python">      食品     衣着   家庭设备  医疗    交通     娱乐      居住    杂项
<span class="token number">0</span>   <span class="token number">2959.19</span>  <span class="token number">730.79</span>  <span class="token number">749.41</span>  <span class="token number">513.34</span>  <span class="token number">467.87</span>  <span class="token number">1141.82</span>   <span class="token number">478.42</span>  <span class="token number">457.64</span>
<span class="token number">1</span>   <span class="token number">2459.77</span>  <span class="token number">495.47</span>  <span class="token number">697.33</span>  <span class="token number">302.87</span>  <span class="token number">284.19</span>   <span class="token number">735.97</span>   <span class="token number">570.84</span>  <span class="token number">305.08</span>
<span class="token number">2</span>   <span class="token number">1495.63</span>  <span class="token number">515.90</span>  <span class="token number">362.37</span>  <span class="token number">285.32</span>  <span class="token number">272.95</span>   <span class="token number">540.58</span>   <span class="token number">364.91</span>  <span class="token number">188.63</span>
<span class="token number">3</span>   <span class="token number">1406.33</span>  <span class="token number">477.77</span>  <span class="token number">290.15</span>  <span class="token number">208.57</span>  <span class="token number">201.50</span>   <span class="token number">414.72</span>   <span class="token number">281.84</span>  <span class="token number">212.10</span>
<span class="token number">4</span>   <span class="token number">1303.97</span>  <span class="token number">524.29</span>  <span class="token number">254.83</span>  <span class="token number">192.17</span>  <span class="token number">249.81</span>   <span class="token number">463.09</span>   <span class="token number">287.87</span>  <span class="token number">192.96</span>
<span class="token number">5</span>   <span class="token number">1730.84</span>  <span class="token number">553.90</span>  <span class="token number">246.91</span>  <span class="token number">279.81</span>  <span class="token number">239.18</span>   <span class="token number">445.20</span>   <span class="token number">330.24</span>  <span class="token number">163.86</span>
<span class="token number">6</span>   <span class="token number">1561.86</span>  <span class="token number">492.42</span>  <span class="token number">200.49</span>  <span class="token number">218.36</span>  <span class="token number">220.69</span>   <span class="token number">459.62</span>   <span class="token number">360.48</span>  <span class="token number">147.76</span>
<span class="token number">7</span>   <span class="token number">1410.11</span>  <span class="token number">510.71</span>  <span class="token number">211.88</span>  <span class="token number">277.11</span>  <span class="token number">224.65</span>   <span class="token number">376.82</span>   <span class="token number">317.61</span>  <span class="token number">152.85</span>
<span class="token number">8</span>   <span class="token number">3712.31</span>  <span class="token number">550.74</span>  <span class="token number">893.37</span>  <span class="token number">346.93</span>  <span class="token number">527.00</span>  <span class="token number">1034.98</span>   <span class="token number">720.33</span>  <span class="token number">462.03</span>
<span class="token number">9</span>   <span class="token number">2207.58</span>  <span class="token number">449.37</span>  <span class="token number">572.40</span>  <span class="token number">211.92</span>  <span class="token number">302.09</span>   <span class="token number">585.23</span>   <span class="token number">429.77</span>  <span class="token number">252.54</span>
<span class="token number">10</span>  <span class="token number">2629.16</span>  <span class="token number">557.32</span>  <span class="token number">689.73</span>  <span class="token number">435.69</span>  <span class="token number">514.66</span>   <span class="token number">795.87</span>   <span class="token number">575.76</span>  <span class="token number">323.36</span>
<span class="token number">11</span>  <span class="token number">1844.78</span>  <span class="token number">430.29</span>  <span class="token number">271.28</span>  <span class="token number">126.33</span>  <span class="token number">250.56</span>   <span class="token number">513.18</span>   <span class="token number">314.00</span>  <span class="token number">151.39</span>
<span class="token number">12</span>  <span class="token number">2709.46</span>  <span class="token number">428.11</span>  <span class="token number">334.12</span>  <span class="token number">160.77</span>  <span class="token number">405.14</span>   <span class="token number">461.67</span>   <span class="token number">535.13</span>  <span class="token number">232.29</span>
<span class="token number">13</span>  <span class="token number">1563.78</span>  <span class="token number">303.65</span>  <span class="token number">233.81</span>  <span class="token number">107.90</span>  <span class="token number">209.70</span>   <span class="token number">393.99</span>   <span class="token number">509.39</span>  <span class="token number">160.12</span>
<span class="token number">14</span>  <span class="token number">1675.75</span>  <span class="token number">613.32</span>  <span class="token number">550.71</span>  <span class="token number">219.79</span>  <span class="token number">272.59</span>   <span class="token number">599.43</span>   <span class="token number">371.62</span>  <span class="token number">211.84</span>
<span class="token number">15</span>  <span class="token number">1427.65</span>  <span class="token number">431.79</span>  <span class="token number">288.55</span>  <span class="token number">208.14</span>  <span class="token number">217.00</span>   <span class="token number">337.76</span>   <span class="token number">421.31</span>  <span class="token number">165.32</span>
<span class="token number">16</span>  <span class="token number">1942.23</span>  <span class="token number">512.27</span>  <span class="token number">401.39</span>  <span class="token number">206.06</span>  <span class="token number">321.29</span>   <span class="token number">697.22</span>   <span class="token number">492.60</span>  <span class="token number">226.45</span>
<span class="token number">17</span>  <span class="token number">1783.43</span>  <span class="token number">511.88</span>  <span class="token number">282.84</span>  <span class="token number">201.01</span>  <span class="token number">237.60</span>   <span class="token number">617.74</span>   <span class="token number">523.52</span>  <span class="token number">182.52</span>
<span class="token number">18</span>  <span class="token number">3055.17</span>  <span class="token number">353.23</span>  <span class="token number">564.56</span>  <span class="token number">356.27</span>  <span class="token number">811.88</span>   <span class="token number">873.06</span>  <span class="token number">1082.82</span>  <span class="token number">420.81</span>
<span class="token number">19</span>  <span class="token number">2033.87</span>  <span class="token number">300.82</span>  <span class="token number">338.65</span>  <span class="token number">157.78</span>  <span class="token number">329.06</span>   <span class="token number">621.74</span>   <span class="token number">587.02</span>  <span class="token number">218.27</span>
<span class="token number">20</span>  <span class="token number">2057.86</span>  <span class="token number">186.44</span>  <span class="token number">202.72</span>  <span class="token number">171.79</span>  <span class="token number">329.65</span>   <span class="token number">477.17</span>   <span class="token number">312.93</span>  <span class="token number">279.19</span>
<span class="token number">21</span>  <span class="token number">2303.29</span>  <span class="token number">589.99</span>  <span class="token number">516.21</span>  <span class="token number">236.55</span>  <span class="token number">403.92</span>   <span class="token number">730.05</span>   <span class="token number">438.41</span>  <span class="token number">225.80</span>
<span class="token number">22</span>  <span class="token number">1974.28</span>  <span class="token number">507.76</span>  <span class="token number">344.79</span>  <span class="token number">203.21</span>  <span class="token number">240.24</span>   <span class="token number">575.10</span>   <span class="token number">430.36</span>  <span class="token number">223.46</span>
<span class="token number">23</span>  <span class="token number">1673.82</span>  <span class="token number">437.75</span>  <span class="token number">461.61</span>  <span class="token number">153.32</span>  <span class="token number">254.66</span>   <span class="token number">445.59</span>   <span class="token number">346.11</span>  <span class="token number">191.48</span>
<span class="token number">24</span>  <span class="token number">2194.25</span>  <span class="token number">537.01</span>  <span class="token number">369.07</span>  <span class="token number">249.54</span>  <span class="token number">290.84</span>   <span class="token number">561.91</span>   <span class="token number">407.70</span>  <span class="token number">330.95</span>
<span class="token number">25</span>  <span class="token number">2646.61</span>  <span class="token number">839.70</span>  <span class="token number">204.44</span>  <span class="token number">209.11</span>  <span class="token number">379.30</span>   <span class="token number">371.04</span>   <span class="token number">269.59</span>  <span class="token number">389.33</span>
<span class="token number">26</span>  <span class="token number">1472.95</span>  <span class="token number">390.89</span>  <span class="token number">447.95</span>  <span class="token number">259.51</span>  <span class="token number">230.61</span>   <span class="token number">490.90</span>   <span class="token number">469.10</span>  <span class="token number">191.34</span>
<span class="token number">27</span>  <span class="token number">1525.57</span>  <span class="token number">472.98</span>  <span class="token number">328.90</span>  <span class="token number">219.86</span>  <span class="token number">206.65</span>   <span class="token number">449.69</span>   <span class="token number">249.66</span>  <span class="token number">228.19</span>
<span class="token number">28</span>  <span class="token number">1654.69</span>  <span class="token number">437.77</span>  <span class="token number">258.78</span>  <span class="token number">303.00</span>  <span class="token number">244.93</span>   <span class="token number">479.53</span>   <span class="token number">288.56</span>  <span class="token number">236.51</span>
<span class="token number">29</span>  <span class="token number">1375.46</span>  <span class="token number">480.89</span>  <span class="token number">273.84</span>  <span class="token number">317.32</span>  <span class="token number">251.08</span>   <span class="token number">424.75</span>   <span class="token number">228.73</span>  <span class="token number">195.93</span>
<span class="token number">30</span>  <span class="token number">1608.82</span>  <span class="token number">536.05</span>  <span class="token number">432.46</span>  <span class="token number">235.82</span>  <span class="token number">250.28</span>   <span class="token number">541.30</span>   <span class="token number">344.85</span>  <span class="token number">214.40</span>
</code></pre> 
<ol start="2"><li>建立模型并训练数据</li></ol> 
<pre><code class="prism language-python">k<span class="token operator">=</span><span class="token number">3</span>
model <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span> k<span class="token punctuation">,</span>init<span class="token operator">=</span><span class="token string">'k-means++'</span><span class="token punctuation">)</span>
clf <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
predict_y <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>聚类结果</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>predict_y<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>predict_y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>predict_y<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>结果显示：</p> 
<pre><code class="prism language-python"><span class="token number">2</span>      河北
<span class="token number">3</span>      山西
<span class="token number">4</span>     内蒙古
<span class="token number">5</span>      辽宁
<span class="token number">6</span>      吉林
<span class="token number">7</span>     黑龙江
<span class="token number">11</span>     安徽
<span class="token number">13</span>     江西
<span class="token number">14</span>     山东
<span class="token number">15</span>     河南
<span class="token number">17</span>     湖北
<span class="token number">23</span>     贵州
<span class="token number">26</span>     陕西
<span class="token number">27</span>     甘肃
<span class="token number">28</span>     青海
<span class="token number">29</span>     宁夏
<span class="token number">30</span>     新疆
Name<span class="token punctuation">:</span> 省份<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token number">1</span>     天津
<span class="token number">9</span>     江苏
<span class="token number">10</span>    浙江
<span class="token number">12</span>    福建
<span class="token number">16</span>    湖南
<span class="token number">19</span>    广西
<span class="token number">20</span>    海南
<span class="token number">21</span>    重庆
<span class="token number">22</span>    四川
<span class="token number">24</span>    云南
<span class="token number">25</span>    西藏
Name<span class="token punctuation">:</span> 省份<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token number">0</span>     北京
<span class="token number">8</span>     上海
<span class="token number">18</span>    广东
Name<span class="token punctuation">:</span> 省份<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
</code></pre> 
<h3><a id="63_python_179"></a>6.3 常规方法python实现</h3> 
<p><strong>各城市消费水平聚类</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment">#%%</span>
<span class="token comment"># 计算欧拉距离</span>
<span class="token keyword">def</span> <span class="token function">calcDis</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> centroids<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    clalist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> data <span class="token keyword">in</span> dataSet<span class="token punctuation">:</span>
        diff <span class="token operator">=</span> np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> centroids
        squaredDiff <span class="token operator">=</span> diff <span class="token operator">**</span> <span class="token number">2</span>  <span class="token comment"># 平方</span>
        squaredDist <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>squaredDiff<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 和  (axis=1表示行)</span>
        distance <span class="token operator">=</span> squaredDist <span class="token operator">**</span> <span class="token number">0.5</span>  <span class="token comment"># 开根号</span>
        clalist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>distance<span class="token punctuation">)</span>
    clalist <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>clalist<span class="token punctuation">)</span>  <span class="token comment"># 返回一个每个点到质点的距离len(dateSet)*k的数组</span>
    <span class="token keyword">return</span> clalist


<span class="token comment"># 计算质心</span>
<span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> centroids<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 计算样本到质心的距离</span>
    clalist <span class="token operator">=</span> calcDis<span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> centroids<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
    <span class="token comment"># 分组并计算新的质心</span>
    minDistIndices <span class="token operator">=</span> np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>clalist<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># axis=1 表示求出每行的最小值的下标</span>
    newCentroids <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dataSet<span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>
        minDistIndices<span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># DataFramte(dataSet)对DataSet分组，groupby(min)按照min进行统计分类，mean()对分类结果求均值</span>
    newCentroids <span class="token operator">=</span> newCentroids<span class="token punctuation">.</span>values

    <span class="token comment"># 计算变化量</span>
    changed <span class="token operator">=</span> newCentroids <span class="token operator">-</span> centroids

    <span class="token keyword">return</span> changed<span class="token punctuation">,</span> newCentroids


<span class="token comment"># 使用k-means分类</span>
<span class="token keyword">def</span> <span class="token function">kmeans</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 随机取质心</span>
    <span class="token comment"># random.sample（list类型数据）</span>
    centroids <span class="token operator">=</span> random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">)</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span>

    <span class="token comment"># 更新质心 直到变化量全为0</span>
    changed<span class="token punctuation">,</span> newCentroids <span class="token operator">=</span> classify<span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> centroids<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
    <span class="token keyword">while</span> np<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span>changed <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        changed<span class="token punctuation">,</span> newCentroids <span class="token operator">=</span> classify<span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> newCentroids<span class="token punctuation">,</span> k<span class="token punctuation">)</span>

    centroids <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>newCentroids<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># tolist()将矩阵转换成列表 sorted()排序</span>

    <span class="token comment"># 根据质心计算每个集群</span>
    cluster <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    clalist <span class="token operator">=</span> calcDis<span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> centroids<span class="token punctuation">,</span> k<span class="token punctuation">)</span>  <span class="token comment"># 调用欧拉距离</span>
    minDistIndices <span class="token operator">=</span> np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>clalist<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cluster<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>minDistIndices<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># enymerate()可同时遍历索引和遍历元素</span>
        cluster<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>dataSet<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> centroids<span class="token punctuation">,</span> cluster<span class="token punctuation">,</span> minDistIndices


<span class="token comment"># 创建数据集</span>
<span class="token keyword">def</span> <span class="token function">createDataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">r"data.xlsx"</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">"人均消费（元）"</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> df<span class="token punctuation">,</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    df<span class="token punctuation">,</span>dataSet <span class="token operator">=</span> createDataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>
    centroids<span class="token punctuation">,</span> cluster<span class="token punctuation">,</span> minDist <span class="token operator">=</span> kmeans<span class="token punctuation">(</span>dataSet<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'质心为：%s'</span> <span class="token operator">%</span> centroids<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'集群为：%s'</span> <span class="token operator">%</span> cluster<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>minDist <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>minDist <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>minDist <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<p>聚类结果：</p> 
<pre><code class="prism language-python"><span class="token number">2</span>      河北
<span class="token number">3</span>      山西
<span class="token number">4</span>     内蒙古
<span class="token number">5</span>      辽宁
<span class="token number">6</span>      吉林
<span class="token number">7</span>     黑龙江
<span class="token number">11</span>     安徽
<span class="token number">13</span>     江西
<span class="token number">14</span>     山东
<span class="token number">15</span>     河南
<span class="token number">17</span>     湖北
<span class="token number">23</span>     贵州
<span class="token number">26</span>     陕西
<span class="token number">27</span>     甘肃
<span class="token number">28</span>     青海
<span class="token number">29</span>     宁夏
<span class="token number">30</span>     新疆
Name<span class="token punctuation">:</span> 省份<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token number">1</span>     天津
<span class="token number">9</span>     江苏
<span class="token number">12</span>    福建
<span class="token number">16</span>    湖南
<span class="token number">19</span>    广西
<span class="token number">20</span>    海南
<span class="token number">21</span>    重庆
<span class="token number">22</span>    四川
<span class="token number">24</span>    云南
<span class="token number">25</span>    西藏
Name<span class="token punctuation">:</span> 省份<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token number">0</span>     北京
<span class="token number">8</span>     上海
<span class="token number">10</span>    浙江
<span class="token number">18</span>    广东
Name<span class="token punctuation">:</span> 省份<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
</code></pre> 
<h2><a id="_296"></a>七、相关参数调整</h2> 
<p>以下程序来源链接: <a href="https://blog.csdn.net/PyRookie/article/details/81915078">K均值算法</a></p> 
<ol><li>标准差<code>cluster_std</code>不相同</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># cluster_std 各个中心的标准差</span>
X_train<span class="token punctuation">,</span>y_train <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> cluster_std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">,</span><span class="token number">3.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#参数</span>
<span class="token comment"># n_clusters  将预测结果分为几簇</span>
kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 获取模型</span>
kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span> 
predict_y <span class="token operator">=</span> kmeans<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>y_train<span class="token punctuation">)</span> <span class="token comment"># 原结果</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>predict_y<span class="token punctuation">)</span>  <span class="token comment">#预测结果</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>原始数据：<br> <img src="https://images2.imgbox.com/fc/a9/jh3eguWt_o.png" alt="在这里插入图片描述"><br> 聚类结果：<br> <img src="https://images2.imgbox.com/79/e7/T6Q9CnBX_o.png" alt="在这里插入图片描述"><br> 2. 样本数量不同</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token comment"># cluster_std 各个中心的标准差</span>
X_train<span class="token punctuation">,</span>y_train <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 创建训练集</span>
X1 <span class="token operator">=</span> X_train<span class="token punctuation">[</span>y_train<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment"># X1中的这些点 目标值都是0</span>
X2 <span class="token operator">=</span> X_train<span class="token punctuation">[</span>y_train<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>  <span class="token comment"># X2中的这些点 目标值都是1</span>
X3 <span class="token operator">=</span> X_train<span class="token punctuation">[</span>y_train<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>   <span class="token comment"># X3中的这些点 目标值都是2</span>

<span class="token comment"># 将三个合为一个训练集</span>
X_train <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>X1<span class="token punctuation">,</span>X2<span class="token punctuation">,</span>X3<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 创建结果集</span>
<span class="token comment"># 前500个为0  再来100个1  再来10个2</span>
y_train <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">500</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">10</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>y_train<span class="token punctuation">)</span> <span class="token comment"># 原结果</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#参数</span>
<span class="token comment"># n_clusters  将预测结果分为几簇</span>
kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 获取模型</span>
kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
predict_y <span class="token operator">=</span> kmeans<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>predict_y<span class="token punctuation">)</span>  <span class="token comment">#预测结果</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>原始数据：<br> <img src="https://images2.imgbox.com/31/af/R7SCNDwd_o.png" alt="在这里插入图片描述"><br> 聚类结果：</p> 
<p><img src="https://images2.imgbox.com/c9/a5/mCPmYykr_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Kmeans_355"></a>八、优化算法K-means++</h2> 
<h3><a id="81_kmeans_356"></a>8.1 kmeans不足之处</h3> 
<p>从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         K 
        
       
         m 
        
       
         e 
        
       
         a 
        
       
         n 
        
       
         s 
        
       
      
        Kmeans 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">K</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span></span>聚类算法的原理可知，在正式聚类之前首先需要完成的就是初始化<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>个簇中心。使得收敛情况严重依赖于簇中心的初始化状况。如果在初始化过程中很不巧的将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>个（或大多数）簇中心都初始化了到同一个簇中，那么在这种情况下聚类算法很大程度上都不会收敛到全局最小值。也就是说，当簇中心初始化的位置不得当时，聚类结果将会出现严重的错误。</p> 
<h3><a id="82_kmeans_358"></a>8.2 kmeans++</h3> 
<p>k-means++算法选择初始聚类中心的基本原则是：<code>初始的聚类中心之间的相互距离要尽可能的远</code>。<br> <strong>算法描述如下</strong>：<br> （只对K-means算法“初始化K个聚类中心” 这一步进行了优化）</p> 
<ol><li>随机选取一个样本作为第一个聚类中心；</li><li>计算每个样本与当前已有聚类中心的最短距离（即与最近一个聚类中心的距离），这个值越大，表示被选取作为聚类中心的概率较大；最后，用轮盘法（依据概率大小来进行抽选）选出下一个聚类中心；</li><li>重复步骤二，直到选出K个聚类中心。选出初始点后，就继续使用标准的K-means算法了。<br> <strong>程序实现</strong>：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_cent</span><span class="token punctuation">(</span>points<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    kmeans++的初始化聚类中心的方法
    :param points: 样本
    :param k: 聚类中心的个数
    :return: 初始化后的聚类中心
    '''</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>points<span class="token punctuation">)</span>
    cluster_centers <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
    <span class="token comment"># 1、随机选择一个样本点作为第一个聚类中心</span>
    index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    cluster_centers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>points<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 复制函数，修改cluster_centers，不会影响points</span>
 
    <span class="token comment"># 2、初始化一个距离序列</span>
    d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span>
 
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sum_all <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 3、对每一个样本找到最近的聚类中心点</span>
            d<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nearest<span class="token punctuation">(</span>points<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> cluster_centers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># 4、将所有的最短距离相加</span>
            sum_all <span class="token operator">+=</span> d<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        <span class="token comment"># 5、取得sum_all之间的随机值</span>
        sum_all <span class="token operator">*=</span> random<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 6、获得距离最远的样本点作为聚类中心点</span>
        <span class="token keyword">for</span> j<span class="token punctuation">,</span> di <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># enumerate()函数用于将一个可遍历的数据对象（如列表、元组或字符串）组合为一个索引序列，同事列出数据和数据下标一般用在for循环中</span>
            sum_all <span class="token operator">-=</span> di
            <span class="token keyword">if</span> sum_all <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            cluster_centers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>points<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> cluster_centers
</code></pre> 
<h3><a id="83__403"></a>8.3 层次聚类</h3> 
<p>参考来源：数学建模清风老师课件</p> 
<p><strong>层次聚类的算法流程</strong>：</p> 
<ol><li>将每个对象看作一类，计算两两之间的最小距离；</li><li>将距离最小的两个类合并成一个新类；</li><li>重新计算新类与所有类之间的距离；</li><li>重复二三两步，直到所有类最后合并成一类；</li></ol> 
<p><strong>算法图解</strong><br> <img src="https://images2.imgbox.com/cc/f6/sAT26uDe_o.png" alt="在这里插入图片描述"><br> <strong>程序实现</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># 调包</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>cluster<span class="token punctuation">.</span>hierarchy <span class="token keyword">as</span> shc <span class="token comment"># 层次聚类</span>
<span class="token comment"># 防止中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
<span class="token comment"># 加载数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'data.xlsx'</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">"人均消费（元）"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 绘图</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'省份消费数据聚类树状图'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>
dend <span class="token operator">=</span> shc<span class="token punctuation">.</span>dendrogram<span class="token punctuation">(</span>shc<span class="token punctuation">.</span>linkage<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'食品'</span><span class="token punctuation">,</span><span class="token string">'衣着'</span><span class="token punctuation">,</span><span class="token string">'家庭设备'</span><span class="token punctuation">,</span><span class="token string">'医疗'</span><span class="token punctuation">,</span><span class="token string">'交通'</span><span class="token punctuation">,</span><span class="token string">'娱乐'</span><span class="token punctuation">,</span><span class="token string">'居住'</span><span class="token punctuation">,</span><span class="token string">'杂项'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
method<span class="token operator">=</span><span class="token string">'ward'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>labels<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'省份'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span>color_threshold<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'树状图.png'</span><span class="token punctuation">)</span> <span class="token comment"># 保存图片</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><strong>聚类树状图</strong>：<br> <img src="https://images2.imgbox.com/21/0f/Mqio9YQF_o.png" alt="在这里插入图片描述"></p> 
<p>本文为学习过程记录，根据学习情况继续更新。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/038134c0a52aee94dc6fba89865a89a2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">常见限流算法（固定or滑动窗口、漏桶、令牌桶）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c382c083447ebd502b6b80168e983bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux上wireshark抓包权限不足问题解决</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>