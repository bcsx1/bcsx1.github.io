<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>牛客网SQL训练4—SQL进阶挑战 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="牛客网SQL训练4—SQL进阶挑战" />
<meta property="og:description" content="文章目录 一、增删改操作1. 插入记录2. 更新记录3. 删除记录 二、表与索引操作1. 表的创建、修改与删除2. 索引的创建、删除 三、聚合分组查询1. 聚合函数2. 分组查询 四、多表查询1. 嵌套子查询2. 合并查询3. 连接查询 五、窗口函数1. 专用窗口函数2. 聚合窗口函数 六、其他常用操作1. 空值处理2. 高级条件语句3. 限量查询4. 文本转换函数 一、增删改操作 1. 插入记录 【题目1：插入记录 (一)】
--输入： drop table if EXISTS exam_record; CREATE TABLE IF NOT EXISTS exam_record ( id int PRIMARY KEY AUTO_INCREMENT COMMENT &#39;自增ID&#39;, uid int NOT NULL COMMENT &#39;用户ID&#39;, exam_id int NOT NULL COMMENT &#39;试卷ID&#39;, start_time datetime NOT NULL COMMENT &#39;开始时间&#39;, submit_time datetime COMMENT &#39;提交时间&#39;, score tinyint COMMENT &#39;得分&#39; )CHARACTER SET utf8 COLLATE utf8_general_ci; TRUNCATE exam_record; 插入记录的方式汇总：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/8f68caa8209fab6006d5ab0cd310d9c1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-28T20:31:03+08:00" />
<meta property="article:modified_time" content="2023-12-28T20:31:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">牛客网SQL训练4—SQL进阶挑战</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">一、增删改操作</a></li><li><ul><li><a href="#1__4" rel="nofollow">1. 插入记录</a></li><li><a href="#2__111" rel="nofollow">2. 更新记录</a></li><li><a href="#3__191" rel="nofollow">3. 删除记录</a></li></ul> 
  </li><li><a href="#_298" rel="nofollow">二、表与索引操作</a></li><li><ul><li><a href="#1__299" rel="nofollow">1. 表的创建、修改与删除</a></li><li><a href="#2__407" rel="nofollow">2. 索引的创建、删除</a></li></ul> 
  </li><li><a href="#_487" rel="nofollow">三、聚合分组查询</a></li><li><ul><li><a href="#1__488" rel="nofollow">1. 聚合函数</a></li><li><a href="#2__675" rel="nofollow">2. 分组查询</a></li></ul> 
  </li><li><a href="#_847" rel="nofollow">四、多表查询</a></li><li><ul><li><a href="#1__848" rel="nofollow">1. 嵌套子查询</a></li><li><a href="#2__1134" rel="nofollow">2. 合并查询</a></li><li><a href="#3__1303" rel="nofollow">3. 连接查询</a></li></ul> 
  </li><li><a href="#_1629" rel="nofollow">五、窗口函数</a></li><li><ul><li><a href="#1__1630" rel="nofollow">1. 专用窗口函数</a></li><li><a href="#2__2147" rel="nofollow">2. 聚合窗口函数</a></li></ul> 
  </li><li><a href="#_2342" rel="nofollow">六、其他常用操作</a></li><li><ul><li><a href="#1__2343" rel="nofollow">1. 空值处理</a></li><li><a href="#2__2472" rel="nofollow">2. 高级条件语句</a></li><li><a href="#3__2882" rel="nofollow">3. 限量查询</a></li><li><a href="#4__3049" rel="nofollow">4. 文本转换函数</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_3"></a>一、增删改操作</h2> 
<h3><a id="1__4"></a>1. 插入记录</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：插入记录 (一)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> exam_record<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/de/30/QW7ukyFP_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>插入记录的方式汇总：</strong><br> <strong>1. 普通插入</strong>（全字段）：INSERT INTO table_name VALUES (value1, value2, …)<br>  普通插入（限定字段）：INSERT INTO table_name (column1, column2, …) VALUES (value1, value2, …)<br>  多条一次性插入：INSERT INTO table_name (column1, column2, …) VALUES (value1_1, value1_2, …), (value2_1, value2_2, …), …<br> <strong>2. 从另一个表导入</strong>：INSERT INTO table_name SELECT * FROM table_name2 [WHERE key=value]<br> <strong>3. 带更新的插入</strong>：REPLACE INTO table_name VALUES (value1, value2, …) （注意这种原理是检测到主键或唯一性索引键重复就删除原记录后重新插入）</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token comment">-- 因为id为自增，所以插入两条数据除自增id列以外的列</span>
<span class="token comment">-- 提交时间可以让它自己计算</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">values</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">9001</span><span class="token punctuation">,</span><span class="token string">'2021-09-01 22:11:12'</span><span class="token punctuation">,</span><span class="token string">'2021-09-01 22:11:12'</span><span class="token operator">+</span><span class="token keyword">interval</span> <span class="token number">50</span> <span class="token keyword">minute</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">9002</span><span class="token punctuation">,</span><span class="token string">'2021-09-04 07:01:02'</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2a/2f/nx8EAzBS_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：插入记录 (二)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record_before_2021 <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> exam_record_before_2021<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:00:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-09-02 09:00:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:30:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d3/b4/mzb7d2Nu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 第一列为自增主键列，不能直接复制过去</span>
<span class="token comment">-- 只复制2021年之前的记录 &amp; 只复制已完成了的试题作答纪录：用提交时间</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> exam_record_before_2021<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span>
<span class="token keyword">select</span> uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score <span class="token keyword">from</span> exam_record
<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token string">'2021'</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/80/f9/44C5HLQD_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：插入记录 (三)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> examination_info <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长(分钟数)'</span><span class="token punctuation">,</span>
release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_bin<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/19/48/arK2S8Fu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">replace</span> <span class="token keyword">into</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">values</span>
<span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span><span class="token string">'SQL'</span><span class="token punctuation">,</span><span class="token string">'hard'</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token string">'2021-01-01 00:00:00'</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f1/f3/cHPzzwA3_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="2__111"></a>2. 更新记录</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：更新记录 (一)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> examination_info <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_bin<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'python'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'Python'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'PYTHON'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7d/8c/z9FxwsDj_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>修改记录的方式汇总：</strong><br> <strong>1. 设置为新值</strong>：UPDATE table_name SET column_name=new_value [, column_name2=new_value2] [WHERE column_name3=value3]<br> <strong>2. 根据已有值替换</strong>：UPDATE table_name SET key1=replace(key1, ‘查找内容’, ‘替换成内容’) [WHERE column_name3=value3]</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">update</span> examination_info
<span class="token keyword">set</span> tag<span class="token operator">=</span><span class="token string">'Python'</span>
<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'PYTHON'</span>
<span class="token punctuation">;</span>
<span class="token comment">-- 方法2</span>
<span class="token keyword">update</span> examination_info
<span class="token keyword">set</span> tag<span class="token operator">=</span><span class="token keyword">replace</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string">'PYTHON'</span><span class="token punctuation">,</span><span class="token string">'Python'</span><span class="token punctuation">)</span>
<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'PYTHON'</span>
<span class="token punctuation">;</span>

<span class="token comment">-- 思维扩展：第二种方式不仅可用于整体替换，还能做子串替换，例如要实现将tag中所有的PYTHON替换为Python（如CPYTHON=&gt;CPython），可写作：</span>
<span class="token keyword">update</span> examination_info
<span class="token keyword">set</span> tag <span class="token operator">=</span> <span class="token keyword">replace</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string">"PYTHON"</span><span class="token punctuation">,</span> <span class="token string">"Python"</span><span class="token punctuation">)</span>
<span class="token keyword">where</span> tag <span class="token operator">like</span> <span class="token string">"%PYTHON%"</span><span class="token punctuation">;</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1a/15/UyPXbiQc_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：更新记录 (二)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/67/fa/acT0tLb5_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 未完成：分数为null</span>
<span class="token keyword">update</span> exam_record
<span class="token keyword">set</span> submit_time<span class="token operator">=</span><span class="token string">'2099-01-01 00:00:00'</span><span class="token punctuation">,</span>score<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token string">'2021-09-01'</span> <span class="token operator">and</span> score <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3f/21/oJep4taw_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="3__191"></a>3. 删除记录</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：删除记录 (一)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span> exam_id<span class="token punctuation">,</span> start_time<span class="token punctuation">,</span> submit_time<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 22:11:12'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 23:16:12'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:06:00'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:05:58'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:05:01'</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:15:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 19:05:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-09 07:01:02'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/21/ae/RiyN7UML_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>删除记录的方式汇总</strong>：<br> <strong>1. 根据条件删除</strong>：DELETE FROM tb_name [WHERE options] [ [ ORDER BY fields ] LIMIT n ]<br> <strong>2. 全部删除</strong>（表清空，包含自增计数器重置）：TRUNCATE TABLE tb_name</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token comment">-- 时间差：TIMESTAMPDIFF(interval, time_start, time_end)可计算time_start-time_end的时间差，单位以指定的interval为准，</span>
<span class="token comment">-- 常用可选：SECOND 秒</span>
<span class="token comment">-- 		 MINUTE 分钟（返回秒数差除以60的整数部分）</span>
<span class="token comment">-- 		 HOUR 小时（返回秒数差除以3600的整数部分）</span>
<span class="token comment">-- 		 DAY 天数（返回秒数差除以3600*24的整数部分）</span>
<span class="token comment">-- 		 MONTH 月数</span>
<span class="token comment">-- 		 YEAR 年数</span>

<span class="token keyword">delete</span> <span class="token keyword">from</span> exam_record
<span class="token keyword">where</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">minute</span><span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">5</span> <span class="token operator">and</span> score<span class="token operator">&lt;</span><span class="token number">60</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/07/37/VuBWf1Ov_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：删除记录 (二)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span> exam_id<span class="token punctuation">,</span> start_time<span class="token punctuation">,</span> submit_time<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 22:11:12'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 23:16:12'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:06:00'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:05:01'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:06:58'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-09 07:01:02'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4b/5e/qvEkeXiZ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> exam_record
<span class="token keyword">where</span> submit_time <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">minute</span><span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">5</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> start_time
<span class="token keyword">limit</span> <span class="token number">3</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/60/f7/1ZArbTxE_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：删除记录 (三)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span> exam_id<span class="token punctuation">,</span> start_time<span class="token punctuation">,</span> submit_time<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 22:11:12'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 23:16:12'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:06:00'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/12/RlQabWIa_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">truncate</span> <span class="token keyword">table</span> exam_record<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/cd/R3OGze9r_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h2><a id="_298"></a>二、表与索引操作</h2> 
<h3><a id="1__299"></a>1. 表的创建、修改与删除</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：创建一张新表】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> user_info_vip<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/11/07/3xlmstJX_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>表的创建、修改与删除</strong>：<br> <strong>1.1 直接创建表</strong><br> CREATE TABLE [IF NOT EXISTS] tb_name – 不存在才创建，存在就跳过<br> (column_name1 data_type1 – 列名和类型必选<br> [ PRIMARY KEY – 可选的约束，主键<br> | FOREIGN KEY – 外键，引用其他表的键值<br> | AUTO_INCREMENT – 自增ID<br> | COMMENT comment – 列注释（评论）<br> | DEFAULT default_value – 默认值<br> | UNIQUE – 唯一性约束，不允许两条记录该列值相同<br> | NOT NULL – 该列非空<br> ], …<br> ) [CHARACTER SET charset] – 字符集编码<br> [COLLATE collate_value] – 列排序和比较时的规则（是否区分大小写等）<br> <strong>1.2 从另一张表复制表结构创建表</strong>：<br> CREATE TABLE tb_name LIKE tb_name_old<br> <strong>1.3 从另一张表的查询结果创建表</strong>：<br> CREATE TABLE tb_name AS SELECT * FROM tb_name_old WHERE options<br> <strong>2.1 修改表：ALTER TABLE 表名 修改选项</strong><br> 选项集合：<br> { ADD COLUMN &lt;列名&gt; &lt;类型&gt; [first|after 字段名] – 增加列<br> | CHANGE COLUMN &lt;旧列名&gt; &lt;新列名&gt; &lt;新列类型&gt; – 修改列名<br> | MODIFY COLUMN &lt;列名&gt; &lt;新类型&gt; [新约束] – 修改列类型或约束<br> | MODIFY COLUMN &lt;列名&gt; &lt;新类型&gt; first – 将某一列放到第一列<br> | DROP COLUMN &lt;列名&gt; – 删除列<br> | RENAME TO &lt;新表名&gt; – 修改表名<br> | CHARACTER SET &lt;字符集名&gt; – 修改字符集<br> | COLLATE &lt;校对规则名&gt; } – 修改校对规则（比较和排序时用到）<br> <strong>3.1 删除表</strong>：DROP TABLE [IF EXISTS] 表名1 [ ,表名2]。</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> user_info_vip<span class="token punctuation">(</span>
id     			<span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>  		<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> 		<span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span>
<span class="token punctuation">,</span>uid   			<span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>  		<span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>         		<span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span>
<span class="token punctuation">,</span>nick_name   	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>      								<span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span>
<span class="token punctuation">,</span>achievement	<span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>     	<span class="token keyword">DEFAULT</span> <span class="token number">0</span> 						<span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span>
<span class="token punctuation">,</span><span class="token keyword">level</span>			<span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>						   					<span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span>
<span class="token punctuation">,</span>job			<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>					  					<span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span>
<span class="token punctuation">,</span>register_time	<span class="token keyword">DATETIME</span>		<span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span>		<span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token keyword">COMMENT</span> <span class="token operator">=</span> <span class="token string">'优质用户信息表'</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/10/3BykWauL_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：修改表】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> user_info <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
<span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
register_time <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/20/a7/z9hWzzfg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 易出错的地方:当想要设置default的值为数字0时,前面必须加上&lt;列类型&gt;为INT,否则会报default的错误</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> user_info <span class="token keyword">add</span> <span class="token keyword">column</span> school <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token keyword">after</span> <span class="token keyword">level</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> user_info change job profession <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> user_info <span class="token keyword">modify</span> <span class="token keyword">column</span> achievement <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/30/6c/3weTFobM_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：删除表】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">EXISTS</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record_2010 <span class="token punctuation">(</span><span class="token operator">LIKE</span> exam_record<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record_2012 <span class="token punctuation">(</span><span class="token operator">LIKE</span> exam_record<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record_2013 <span class="token punctuation">(</span><span class="token operator">LIKE</span> exam_record<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record_2014 <span class="token punctuation">(</span><span class="token operator">LIKE</span> exam_record<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> exam_record_2015 <span class="token punctuation">(</span><span class="token operator">LIKE</span> exam_record<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/24/02/nqqTNW5V_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> 
exam_record_2011<span class="token punctuation">,</span> 
exam_record_2012<span class="token punctuation">,</span> 
exam_record_2013<span class="token punctuation">,</span> 
exam_record_2014<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b3/61/ueeA1b11_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="2__407"></a>2. 索引的创建、删除</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：创建索引】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> examination_info <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_bin<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/74/18/HD64aI9d_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>索引创建、删除与使用</strong>：<br> <strong>1.1 create方式创建索引</strong>：<br> CREATE<br> [UNIQUE – 唯一索引<br> | FULLTEXT – 全文索引<br> ] INDEX index_name ON table_name – 不指定唯一或全文时默认普通索引<br> (column1[(length) [DESC|ASC]] [,column2,…]) – 可以对多列建立组合索引<br> <strong>1.2 alter方式创建索引</strong>：<br> ALTER TABLE tb_name ADD [UNIQUE | FULLTEXT] [INDEX] index_content(content) – 主键索引<br> <strong>2.1 drop方式删除索引</strong>：<br> DROP INDEX &lt;索引名&gt; ON &lt;表名&gt;<br> <strong>2.2 alter方式删除索引</strong>：<br> ALTER TABLE &lt;表名&gt; DROP INDEX &lt;索引名&gt;<br> <strong>3.1 索引的使用</strong>：<br> (1)索引使用时满足最左前缀匹配原则，即对于组合索引(col1, col2)，在不考虑引擎优化时，条件必须是col1在前col2在后，或者只使用col1，索引才会生效；<br> (2)索引不包含有NULL值的列<br> (3)一个查询只使用一次索引，where中如果使用了索引，order by就不会使用<br> (4)like做字段比较时只有前缀确定时才会使用索引<br> (5)在列上进行运算后不会使用索引，如year(start_time)&lt;2020不会使用start_time上的索引<br> <strong>3.2 不同索引的区别</strong>：<br> (1)主键索引： 它是一种特殊的唯一索引，不允许有空值。一般是在建表的时候指定了主键，就会创建主键索引， CREATE INDEX不能用来创建主键索引，使用 ALTER TABLE来代替。<br> (2)唯一索引：与普通索引类似，不同的就是：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须一。<br> (3)普通索引：这是最基本的索引，它没有任何限制。<br> (4)全文索引：FULLTEXT索引用于全文搜索。只有InnoDB和 MyISAM存储引擎支持 FULLTEXT索引和仅适用于 CHAR， VARCHAR和 TEXT列。</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> 			idx_duration 		<span class="token keyword">ON</span> examination_info<span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> 	uniq_idx_exam_id 	<span class="token keyword">ON</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> FULLTEXT <span class="token keyword">INDEX</span> 	full_idx_tag 		<span class="token keyword">ON</span> examination_info<span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/55/43/jtF4FIU6_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：删除索引】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> examination_info <span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
exam_id <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长(分钟数)'</span><span class="token punctuation">,</span>
release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_bin<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_duration <span class="token keyword">ON</span> examination_info<span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> uniq_idx_exam_id <span class="token keyword">ON</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> examination_info <span class="token keyword">ADD</span> FULLTEXT full_idx_tag<span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/0c/rz3uSMIX_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1：</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> uniq_idx_exam_id <span class="token keyword">ON</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> full_idx_tag <span class="token keyword">ON</span> examination_info<span class="token punctuation">;</span>

<span class="token comment">-- 方法2：</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> examination_info <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> uniq_idx_exam_id<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> examination_info <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> full_idx_tag<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/de/ef/rrLCXGT9_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h2><a id="_487"></a>三、聚合分组查询</h2> 
<h3><a id="1__488"></a>1. 聚合函数</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：SQL类别高难度试卷得分的截断平均值】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:30:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:31:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-02-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4a/9c/jzKIOfcP_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	tag	
	<span class="token punctuation">,</span>difficulty	
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum_score<span class="token operator">-</span>max_score<span class="token operator">-</span>min_score<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>score_cnt<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> clip_avg_score
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			tag
			<span class="token punctuation">,</span>difficulty
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> score_cnt 
			<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> sum_score
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> max_score
			<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> min_score
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id
					<span class="token punctuation">,</span>uid
					<span class="token punctuation">,</span>score
				<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						exam_id
						<span class="token punctuation">,</span>tag 
						<span class="token punctuation">,</span>difficulty
					<span class="token keyword">from</span> examination_info
					<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'SQL'</span> <span class="token operator">and</span> difficulty<span class="token operator">=</span><span class="token string">'hard'</span>
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
		<span class="token keyword">group</span> <span class="token keyword">by</span> tag<span class="token punctuation">,</span>difficulty
<span class="token punctuation">)</span> a1
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/06/boEpGjRR_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：统计作答次数】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:30:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:31:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-02-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/23/pJDMySil_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	<span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> total_pv	
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span> complete_pv	
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> <span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span>exam_id<span class="token operator">=</span><span class="token boolean">null</span><span class="token punctuation">,</span>exam_id<span class="token punctuation">)</span><span class="token punctuation">)</span> complete_exam_cnt
<span class="token keyword">from</span> exam_record
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9f/a0/C5M50Nzs_o.png" alt="在这里插入图片描述"></p> 
<br> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：得分不小于平均分的最低分(这题有bug,运行不通过)】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/25/4a/iNfu74oV_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	<span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> min_score_over_avg
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			score  		
			<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  avg_score
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id
					<span class="token punctuation">,</span>score
				<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						exam_id
						<span class="token punctuation">,</span>tag
					<span class="token keyword">from</span> examination_info
					<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'SQL'</span>
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
<span class="token punctuation">)</span> a1
<span class="token keyword">where</span> score<span class="token operator">&gt;=</span>avg_score
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e7/60/YWtKIyET_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="2__675"></a>2. 分组查询</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：平均活跃天数和月活人数】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1007</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-09-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/57/3b/Gtn7DrYO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
	<span class="token keyword">month</span>
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>day_m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> avg_active_days
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> mau
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span>
			date_format<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span> <span class="token keyword">month</span>
			<span class="token punctuation">,</span>uid 
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> day_m
		<span class="token keyword">from</span> exam_record
		<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
		<span class="token keyword">group</span> <span class="token keyword">by</span> date_format<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>uid
<span class="token punctuation">)</span> a 
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">month</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/29/18/elfD3I5B_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：月总刷题数和日均刷题数】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> practice_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  practice_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    question_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'题目ID'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> practice_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>question_id<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 11:41:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:20:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/75/MIi1hU0n_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 使用 WITH ROLLUP，此函数是对聚合函数进行求和，注意 with rollup是对 group by 后的第一个字段，进行分组计算。</span>
<span class="token keyword">select</span> 
	ifnull<span class="token punctuation">(</span>submit_month<span class="token punctuation">,</span><span class="token string">'2021汇总'</span><span class="token punctuation">)</span> submit_month
	<span class="token punctuation">,</span>month_q_cnt
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>avg_day_q_cnt<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> avg_day_q_cnt
<span class="token keyword">from</span> <span class="token punctuation">(</span>
			<span class="token keyword">select</span> 
				date_format<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span> submit_month
				<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>question_id<span class="token punctuation">)</span>  month_q_cnt
				<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>question_id<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token punctuation">(</span>last_day<span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> avg_day_q_cnt
			<span class="token keyword">from</span> practice_record
			<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
			<span class="token keyword">group</span> <span class="token keyword">by</span> date_format<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span>
			<span class="token keyword">with rollup</span> 	
<span class="token punctuation">)</span> a 
<span class="token keyword">order</span> <span class="token keyword">by</span> submit_month
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/18/ef/kmUSLCUJ_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：未完成试卷数大于1的有效用户】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/bf/qFtfVqZU_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 对于每条作答tag，用:连接日期和tag：concat_ws(':', date(start_time), tag)</span>
<span class="token comment">-- 对于一个人（组内）的多条作答，用;连接去重后的作答记录：group_concat(distinct concat_ws(':', date(start_time), tag) SEPARATOR ';')</span>
<span class="token keyword">select</span>
	uid
	<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> incomplete_cnt
	<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> complete_cnt   
	<span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span><span class="token keyword">distinct</span> concat_ws<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">,</span> <span class="token keyword">date</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span> SEPARATOR <span class="token string">';'</span><span class="token punctuation">)</span> detail
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span>
			uid 
			<span class="token punctuation">,</span>exam_id
			<span class="token punctuation">,</span>submit_time
			<span class="token punctuation">,</span>start_time
		<span class="token keyword">from</span> exam_record
		<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span>
					exam_id 
					<span class="token punctuation">,</span>tag 
				<span class="token keyword">from</span> examination_info
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
<span class="token keyword">group</span> <span class="token keyword">by</span> uid
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">1</span>
<span class="token operator">and</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">5</span>
<span class="token operator">and</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> incomplete_cnt <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7e/0e/TRo82NjY_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h2><a id="_847"></a>四、多表查询</h2> 
<h3><a id="1__848"></a>1. 嵌套子查询</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：月均完成试卷数不小于3的用户爱作答的类别】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-07-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 13:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 15:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3c/d7/pElZIOsK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
	tag
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> tag_cnt
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span>
			uid 
			<span class="token punctuation">,</span>exam_id
			<span class="token punctuation">,</span>submit_time
			<span class="token punctuation">,</span>start_time
		<span class="token keyword">from</span> exam_record
<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span>
					exam_id 
					<span class="token punctuation">,</span>tag 
				<span class="token keyword">from</span> examination_info
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
<span class="token keyword">where</span> uid <span class="token operator">in</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span>
					uid
				<span class="token keyword">from</span> exam_record
				<span class="token keyword">where</span> submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
				<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> 
				<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">3</span>
			 <span class="token punctuation">)</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> tag
<span class="token keyword">order</span> <span class="token keyword">by</span> tag_cnt <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c0/6f/1qhH60tC_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：试卷发布当天作答人数和平均分】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1号'</span><span class="token punctuation">,</span> <span class="token number">3100</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">2100</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客5号'</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'牛客6号'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:41:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 13:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 13:41:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 15:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/12/ad/q5qs2DOx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	c<span class="token punctuation">.</span>exam_id	
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> b<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> uv	
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> avg_score
<span class="token keyword">from</span><span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span><span class="token keyword">level</span>		
		<span class="token keyword">from</span> user_info
		<span class="token keyword">where</span> <span class="token keyword">level</span><span class="token operator">&gt;</span><span class="token number">5</span>
<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
			<span class="token keyword">select</span> 
				uid
				<span class="token punctuation">,</span>exam_id
				<span class="token punctuation">,</span>score
				<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> start_time
			<span class="token keyword">from</span> exam_record
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
<span class="token keyword">join</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span>
			exam_id
			<span class="token punctuation">,</span>tag
			<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>release_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> release_time
		<span class="token keyword">from</span> examination_info
		<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'SQL'</span>
<span class="token punctuation">)</span> c <span class="token keyword">on</span> b<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>c<span class="token punctuation">.</span>exam_id
<span class="token keyword">where</span> start_time<span class="token operator">=</span>release_time
<span class="token keyword">group</span> <span class="token keyword">by</span> c<span class="token punctuation">.</span>exam_id
<span class="token keyword">order</span> <span class="token keyword">by</span> uv <span class="token keyword">desc</span><span class="token punctuation">,</span>avg_score <span class="token keyword">asc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/82/09/J2Kul2Oh_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：作答试卷得分大于过80的人的用户等级分布】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1号'</span><span class="token punctuation">,</span> <span class="token number">3100</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">2100</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客5号'</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'牛客6号'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:41:01'</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 13:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 13:41:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 15:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8c/11/EU0Cb54Q_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	<span class="token keyword">level</span>
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span> level_cnt
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			a<span class="token punctuation">.</span>exam_id
			<span class="token punctuation">,</span>a<span class="token punctuation">.</span>tag
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>uid
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>score
			<span class="token punctuation">,</span>c<span class="token punctuation">.</span><span class="token keyword">level</span>
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span>
					exam_id
					<span class="token punctuation">,</span>tag
				<span class="token keyword">from</span> examination_info
				<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'SQL'</span>
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span>exam_id
						<span class="token punctuation">,</span>score
					<span class="token keyword">from</span> exam_record
					<span class="token keyword">where</span> score<span class="token operator">&gt;</span><span class="token number">80</span>
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
		<span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span><span class="token keyword">level</span>		
				<span class="token keyword">from</span> user_info
		<span class="token punctuation">)</span> c <span class="token keyword">on</span> b<span class="token punctuation">.</span>uid<span class="token operator">=</span>c<span class="token punctuation">.</span>uid
<span class="token punctuation">)</span> a1
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">level</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> level_cnt <span class="token keyword">desc</span><span class="token punctuation">,</span><span class="token keyword">level</span> <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/55/a6/dbUTZsvZ_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="2__1134"></a>2. 合并查询</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：每个题目和每份试卷被作答的人数和次数】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> practice_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  practice_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    question_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'题目ID'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> practice_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>question_id<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 11:41:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:20:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:41:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/af/be/Nc5Cuz5b_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 先UNION后ORDER BY时，只需要在最后一个SELECT语句中包含ORDER BY；</span>
<span class="token keyword">select</span> 
	exam_id tid
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span> uv 
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> pv
<span class="token keyword">from</span> exam_record 
<span class="token keyword">group</span> <span class="token keyword">by</span> exam_id
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> 
	question_id tid
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span> uv 
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> pv
<span class="token keyword">from</span> practice_record 
<span class="token keyword">group</span> <span class="token keyword">by</span> question_id
<span class="token keyword">order</span> <span class="token keyword">by</span> uv <span class="token keyword">desc</span><span class="token punctuation">,</span>pv <span class="token keyword">desc</span>
<span class="token comment">-- 先ORDER BY后UNION时，由于优先级问题，需要将子查询用括号括起来，且ORDER BY后面必须有 LIMIT`；</span>
<span class="token comment">#-- 题目答案：</span>
<span class="token keyword">select</span> 
	tid
	<span class="token punctuation">,</span>uv
	<span class="token punctuation">,</span>pv
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			exam_id tid
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span> uv 
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> pv
		<span class="token keyword">from</span> exam_record 
		<span class="token keyword">group</span> <span class="token keyword">by</span> exam_id
		<span class="token keyword">order</span> <span class="token keyword">by</span> uv <span class="token keyword">desc</span><span class="token punctuation">,</span>pv <span class="token keyword">desc</span>
<span class="token punctuation">)</span> a 
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> 
	tid
	<span class="token punctuation">,</span>uv
	<span class="token punctuation">,</span>pv
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			question_id tid
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span> uv 
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> pv
		<span class="token keyword">from</span> practice_record 
		<span class="token keyword">group</span> <span class="token keyword">by</span> question_id
		<span class="token keyword">order</span> <span class="token keyword">by</span> uv <span class="token keyword">desc</span><span class="token punctuation">,</span>pv <span class="token keyword">desc</span>
<span class="token punctuation">)</span> b 
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/42/60/JU2hB1YR_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：分别满足两个活动的人】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>


<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:51'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/bd/fmWM9oio_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid 
	<span class="token punctuation">,</span><span class="token string">'activity1'</span> activity
<span class="token keyword">from</span> exam_record
<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token keyword">having</span> <span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">85</span>
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span>
	uid
	<span class="token punctuation">,</span><span class="token string">'activity2'</span> activity
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span>exam_id
			<span class="token punctuation">,</span>start_time
			<span class="token punctuation">,</span>submit_time
			<span class="token punctuation">,</span>score 
		<span class="token keyword">from</span> exam_record 
		<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
		<span class="token operator">and</span> score<span class="token operator">&gt;</span><span class="token number">80</span>
<span class="token punctuation">)</span> a  <span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id
					<span class="token punctuation">,</span>difficulty
					<span class="token punctuation">,</span>duration
				<span class="token keyword">from</span> examination_info
				<span class="token keyword">where</span> difficulty<span class="token operator">=</span><span class="token string">'hard'</span>
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
<span class="token keyword">where</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">second</span><span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">)</span><span class="token operator">&lt;=</span>duration<span class="token operator">*</span><span class="token number">30</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> uid
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/32/9a/4iS74wDT_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="3__1303"></a>3. 连接查询</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：满足条件的用户的试卷完成数和题目练习数】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">,</span>practice_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> practice_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    question_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'题目ID'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1号'</span><span class="token punctuation">,</span> <span class="token number">3100</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">2300</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号'</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客5号'</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'牛客6号'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> practice_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>question_id<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 11:41:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:20:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:58:01'</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:51'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:02'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/14/5a/KkePmmRE_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	a<span class="token punctuation">.</span>uid
	<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>exam_cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> exam_cnt
	<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>question_cnt<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> question_cnt
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token comment">-- 红名大佬2021年试卷总完成次数</span>
		<span class="token keyword">select</span> 
			uid	
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span> exam_cnt	
		<span class="token keyword">from</span> exam_record 
		<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
		<span class="token operator">and</span> uid <span class="token operator">in</span> <span class="token punctuation">(</span>
						<span class="token comment">-- 高难度SQL试卷得分平均值大于80并且是7级的红名大佬</span>
						<span class="token keyword">select</span> 
							c<span class="token punctuation">.</span>uid
						<span class="token keyword">from</span> <span class="token punctuation">(</span>
								<span class="token comment">-- 高难度SQL试卷</span>
								<span class="token keyword">select</span> 
									exam_id
								<span class="token keyword">from</span> examination_info
								<span class="token keyword">where</span> difficulty<span class="token operator">=</span><span class="token string">'hard'</span>
								<span class="token operator">and</span> tag<span class="token operator">=</span><span class="token string">'SQL'</span> 
						<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
									<span class="token keyword">select</span> 
										uid
										<span class="token punctuation">,</span>exam_id
										<span class="token punctuation">,</span>score
									<span class="token keyword">from</span> exam_record
						<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
						<span class="token keyword">join</span> <span class="token punctuation">(</span>
								<span class="token comment">-- 7级的红名大佬</span>
								<span class="token keyword">select</span> 
									uid 
								<span class="token keyword">from</span> user_info
								<span class="token keyword">where</span> <span class="token keyword">level</span><span class="token operator">=</span><span class="token number">7</span>
						<span class="token punctuation">)</span> c <span class="token keyword">on</span> b<span class="token punctuation">.</span>uid<span class="token operator">=</span>c<span class="token punctuation">.</span>uid 
						<span class="token keyword">group</span> <span class="token keyword">by</span> c<span class="token punctuation">.</span>uid 
						<span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">80</span>
					<span class="token punctuation">)</span> 
		<span class="token keyword">group</span> <span class="token keyword">by</span> uid
<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token comment">-- 红名大佬2021年试卷总完成次数</span>
				<span class="token keyword">select</span> 
					 uid
					 <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span> question_cnt
				<span class="token keyword">from</span> practice_record
				<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
				<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
<span class="token keyword">order</span> <span class="token keyword">by</span> exam_cnt <span class="token keyword">asc</span><span class="token punctuation">,</span>question_cnt <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/61/e5/2Cktyqc5_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：每个6/7级用户活跃情况】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">,</span>practice_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> practice_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    question_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'题目ID'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1号'</span><span class="token punctuation">,</span> <span class="token number">3100</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">2300</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号'</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客5号'</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'牛客6号'</span><span class="token punctuation">,</span> <span class="token number">2600</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> practice_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>question_id<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 11:41:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-04 19:58:01'</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-03 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 19:48:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token string">'2020-08-01 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:02'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:21:59'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-09-01 13:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-09-01 13:41:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/40/6a/wL03HxrF_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 活跃天数考虑跨天的情况</span>
<span class="token keyword">select</span> 
	a<span class="token punctuation">.</span>uid 											<span class="token comment">-- 每个6/7级用户</span>
	<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>e<span class="token punctuation">.</span>active_d<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> 	act_month_total			<span class="token comment">-- 总活跃月份数</span>
	<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>d<span class="token punctuation">.</span>active_d<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> 	act_days_2021			<span class="token comment">-- 2021年活跃天数</span>
	<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>b<span class="token punctuation">.</span>active_d<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> 	act_days_2021_exam		<span class="token comment">-- 2021年试卷作答活跃天数</span>
	<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>c<span class="token punctuation">.</span>active_d<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>   act_days_2021_question	<span class="token comment">-- 2021年答题作答活跃天数</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token comment">-- 每个6/7级用户</span>
		<span class="token keyword">select</span>
			uid 
		<span class="token keyword">from</span> user_info
		<span class="token keyword">where</span> <span class="token keyword">level</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'6'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token comment">-- 2021年试卷作答活跃天数</span>
				<span class="token keyword">select</span> 
					uid 
					<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>active_d<span class="token punctuation">)</span> active_d
				<span class="token keyword">from</span> <span class="token punctuation">(</span>
						<span class="token keyword">select</span> 
							uid 
							<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> active_d 
						<span class="token keyword">from</span> exam_record
						<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
						<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
						<span class="token keyword">union</span> 
						<span class="token keyword">select</span> 
							uid 
							<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> active_d 
						<span class="token keyword">from</span> exam_record
						<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
						<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> 
				<span class="token punctuation">)</span> bb
				<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid 
<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
			<span class="token comment">-- 2021年答题作答活跃天数</span>
			<span class="token keyword">select</span> 
				uid 
				<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>active_d<span class="token punctuation">)</span> active_d
			<span class="token keyword">from</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> active_d
					<span class="token keyword">from</span> practice_record
					<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> 
			<span class="token punctuation">)</span> cc 
			<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token punctuation">)</span> c <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>c<span class="token punctuation">.</span>uid
<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
			<span class="token comment">-- 2021年活跃天数</span>
	  		<span class="token keyword">select</span> 
	  			uid 
	  			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>active_d<span class="token punctuation">)</span> active_d
	  		<span class="token keyword">from</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> active_d 
					<span class="token keyword">from</span> exam_record
					<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
					<span class="token keyword">union</span> 
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> active_d 
					<span class="token keyword">from</span> exam_record
					<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> 
					<span class="token keyword">union</span> 
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> active_d
					<span class="token keyword">from</span> practice_record
					<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> 
			<span class="token punctuation">)</span> dd 
			<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token punctuation">)</span> d <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>d<span class="token punctuation">.</span>uid
<span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
			<span class="token keyword">select</span> 
				uid 
				<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>active_d<span class="token punctuation">)</span> active_d
			<span class="token keyword">from</span> <span class="token punctuation">(</span>
					<span class="token comment">-- 2021年活跃天数</span>
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> active_d 
					<span class="token keyword">from</span> exam_record
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
					<span class="token keyword">union</span> 
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> active_d 
					<span class="token keyword">from</span> exam_record
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> 
					<span class="token keyword">union</span> 
					<span class="token keyword">select</span> 
						uid 
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> active_d
					<span class="token keyword">from</span> practice_record
					<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> 
			<span class="token punctuation">)</span> ee 
			<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token punctuation">)</span> e <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>e<span class="token punctuation">.</span>uid
<span class="token keyword">order</span> <span class="token keyword">by</span> act_month_total <span class="token keyword">desc</span><span class="token punctuation">,</span>act_days_2021	<span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/95/be/9jp2c54h_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h2><a id="_1629"></a>五、窗口函数</h2> 
<h3><a id="1__1630"></a>1. 专用窗口函数</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：每类试卷得分前3名】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:51'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:02'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/50/TaXmKTLy_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	tag
	<span class="token punctuation">,</span>uid 
	<span class="token punctuation">,</span>ranking 
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			tag  
			<span class="token punctuation">,</span>uid	
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> max_score   <span class="token comment">-- 获取各个科目每个用户得分的最大值</span>
			<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> min_score 	<span class="token comment">-- 获取各个科目每个用户得分的最小值</span>
			<span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> tag <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>uid <span class="token keyword">desc</span><span class="token punctuation">)</span> ranking 
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id 
					<span class="token punctuation">,</span>uid 
					<span class="token punctuation">,</span>score
				<span class="token keyword">from</span> exam_record 
		<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
						<span class="token keyword">select</span> 
							exam_id 
							<span class="token punctuation">,</span>tag 
						<span class="token keyword">from</span> examination_info 
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
		<span class="token keyword">group</span> <span class="token keyword">by</span> tag<span class="token punctuation">,</span>uid
<span class="token punctuation">)</span> a1
<span class="token keyword">where</span> ranking <span class="token operator">&lt;=</span><span class="token number">3</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f7/a0/pKCp9X4S_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：第二快/慢用时之差大于试卷时长一半的试卷】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 06:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:51:01'</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:59:01'</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:51'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:02'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:12:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 14:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-08 15:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/90/5f/gXpJQXQy_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> 
	exam_id 
	<span class="token punctuation">,</span>duration
	<span class="token punctuation">,</span>release_time
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			a<span class="token punctuation">.</span>exam_id
			<span class="token punctuation">,</span>diff
			<span class="token punctuation">,</span>duration
			<span class="token punctuation">,</span>duration<span class="token operator">*</span><span class="token number">30</span>  duration_half   
			<span class="token punctuation">,</span>release_time
			<span class="token punctuation">,</span>nth_value<span class="token punctuation">(</span>diff<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> exam_id <span class="token keyword">order</span> <span class="token keyword">by</span> diff <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">unbounded</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">unbounded</span> <span class="token keyword">following</span><span class="token punctuation">)</span> fast_two  
			<span class="token punctuation">,</span>nth_value<span class="token punctuation">(</span>diff<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> exam_id <span class="token keyword">order</span> <span class="token keyword">by</span> diff <span class="token keyword">desc</span> <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token keyword">unbounded</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">unbounded</span> <span class="token keyword">following</span><span class="token punctuation">)</span> low_two
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id
					<span class="token punctuation">,</span>duration
					<span class="token punctuation">,</span>release_time
				<span class="token keyword">from</span> examination_info
		<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
						<span class="token keyword">select</span> 
							exam_id
							<span class="token punctuation">,</span>start_time
							<span class="token punctuation">,</span>submit_time
							<span class="token punctuation">,</span>timestampdiff<span class="token punctuation">(</span><span class="token keyword">second</span><span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">)</span> diff
						<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
<span class="token punctuation">)</span> a1
<span class="token keyword">where</span> low_two<span class="token operator">-</span>fast_two<span class="token operator">&gt;</span>duration_half
<span class="token keyword">order</span> <span class="token keyword">by</span> exam_id <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/e8/6zO5asFn_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：连续两次作答试卷的最大时间窗】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:21:02'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 10:31:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 10:51:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0f/99/WnhQwDQu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid
	<span class="token punctuation">,</span>days_window
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span>exam_cnt<span class="token operator">/</span>diff_days<span class="token operator">*</span>days_window<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>  avg_exam_cnt
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 							
			uid 
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>exam_id<span class="token punctuation">)</span>  exam_cnt  <span class="token comment">-- 此人作答的总试卷数</span>
			<span class="token punctuation">,</span>datediff<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>  diff_days    <span class="token comment">-- 最早一次作答和最晚一次作答的相差天数</span>
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>next_start_time<span class="token punctuation">,</span>start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>  days_window  <span class="token comment">-- 两次作答的最大时间窗</span>
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> <span class="token keyword">distinct</span> 
					uid
					<span class="token punctuation">,</span>exam_id
					<span class="token punctuation">,</span><span class="token keyword">date</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> start_time
					<span class="token punctuation">,</span>lead<span class="token punctuation">(</span><span class="token keyword">date</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> uid <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">date</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">)</span> next_start_time   <span class="token comment">-- 将连续的下次作答时间拼上</span>
				<span class="token keyword">from</span> exam_record
				<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
				<span class="token operator">and</span> uid <span class="token operator">in</span> <span class="token punctuation">(</span>
								<span class="token comment">-- 2021年至少有两天作答过试卷的人</span>
								<span class="token keyword">select</span> 
									uid
								<span class="token keyword">from</span> exam_record
								<span class="token keyword">where</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021'</span>
								<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
								<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> <span class="token keyword">date</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">2</span>
							<span class="token punctuation">)</span> 
		<span class="token punctuation">)</span> a
		<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
<span class="token punctuation">)</span> a1 
<span class="token keyword">order</span> <span class="token keyword">by</span> days_window <span class="token keyword">desc</span><span class="token punctuation">,</span>avg_exam_cnt <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ed/9f/6jldUTvw_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目4</strong></font>：近三个月未完成试卷数为0的用户完成情况】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 10:21:02'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-06-06 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-06 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-06 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-06 10:21:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 10:31:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 10:51:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-08-01 09:51:11'</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-01 09:31:00'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-07-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-07-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0c/1c/DNuxZeUu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span>  exam_complete_cnt
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span>start_time
			<span class="token punctuation">,</span>submit_time
			<span class="token punctuation">,</span>score
			<span class="token punctuation">,</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> uid <span class="token keyword">order</span> <span class="token keyword">by</span> substr<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> rn 
		<span class="token keyword">from</span> exam_record
<span class="token punctuation">)</span> a
<span class="token keyword">where</span> rn<span class="token operator">&lt;=</span><span class="token number">3</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> uid
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span> 
<span class="token keyword">order</span> <span class="token keyword">by</span> exam_complete_cnt <span class="token keyword">desc</span><span class="token punctuation">,</span>uid <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b1/48/3KbnpmQe_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目5</strong></font>：未完成率较高的50%用户近二个月答卷情况】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>level<span class="token punctuation">`</span></span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">3200</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">2200</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'PYTHON'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:59:01'</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:20:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:43:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-03-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-05-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/57/bb/Yczz7CV0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 题目解释中说“1001、1002、1003分别排在1.0、0.5、0.0的位置”，有意让我们用percent_rank，实际cume_dist更常用</span>
<span class="token keyword">select</span> 
	uid  
	<span class="token punctuation">,</span>start_month
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span>  total_cnt
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span> complete_cnt
<span class="token keyword">from</span><span class="token punctuation">(</span>
		<span class="token comment">-- 有试卷作答记录的近三个月</span>
		<span class="token keyword">select</span> 
			a<span class="token punctuation">.</span>uid
			<span class="token punctuation">,</span>a<span class="token punctuation">.</span>start_time
			<span class="token punctuation">,</span>a<span class="token punctuation">.</span>submit_time
			<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>a<span class="token punctuation">.</span>start_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span> start_month 
			<span class="token punctuation">,</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>uid <span class="token keyword">order</span> <span class="token keyword">by</span> date_format<span class="token punctuation">(</span>a<span class="token punctuation">.</span>start_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> dr
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span>start_time
					<span class="token punctuation">,</span>submit_time
				<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token comment">-- 6级和7级用户</span>
					<span class="token keyword">select</span> 
						uid 
					<span class="token keyword">from</span> user_info
					<span class="token keyword">where</span> <span class="token keyword">level</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'6'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">)</span>
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
		<span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token comment">-- SQL试卷上未完成率较高的50%用户</span>
				<span class="token keyword">select</span> 
					uid
				<span class="token keyword">from</span> <span class="token punctuation">(</span>
						<span class="token keyword">select</span> 
							uid
							<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 	incomplete_cnt    <span class="token comment">-- 未完成试卷数</span>
							<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> 					total_cnt		  <span class="token comment">-- 试卷总数</span>
							<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> incomplete_rate    <span class="token comment">-- 未完成试卷率</span>
							<span class="token comment">-- ,cume_dist() over(order by sum(if(submit_time is null,1,0))/count(start_time) desc) ct  </span>
							<span class="token punctuation">,</span>percent_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> pr <span class="token comment">-- 未完成试卷率百分比</span>
						<span class="token keyword">from</span> <span class="token punctuation">(</span>
								<span class="token keyword">select</span> 
									exam_id
								<span class="token keyword">from</span> examination_info
								<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'SQL'</span>
						<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
									<span class="token keyword">select</span> 
										exam_id
										<span class="token punctuation">,</span>uid 
										<span class="token punctuation">,</span>start_time
										<span class="token punctuation">,</span>submit_time
									<span class="token keyword">from</span> exam_record
						<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
						<span class="token keyword">group</span> <span class="token keyword">by</span> uid 
				<span class="token punctuation">)</span> a1
				<span class="token keyword">where</span> pr<span class="token operator">&lt;=</span><span class="token number">0.5</span>
		<span class="token punctuation">)</span> c <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>c<span class="token punctuation">.</span>uid
<span class="token punctuation">)</span> a1
<span class="token keyword">where</span> dr<span class="token operator">&lt;=</span><span class="token number">3</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>start_month
<span class="token keyword">order</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>start_month
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/87/dd/BlHUQTD6_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目6</strong></font>：试卷完成数同比2020年的增长率及排名变化】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'PYTHON'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-08-02 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-04-01 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-04-01 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-04-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-04-01 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-01-20 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-01-20 10:10:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-03-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-03-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-04-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-04-02 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 12:20:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:20:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:43:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:59:01'</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-01-01 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-01-01 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-03-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/00/a5/uhVmxIpD_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">#第三步：取出所有需要的字段，并计算排名变化（2021-2020年，无需取绝对值）</span>
<span class="token keyword">select</span> 
	tag
	<span class="token punctuation">,</span>exam_cnt_20
	<span class="token punctuation">,</span>exam_cnt_21
	<span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>exam_cnt_21<span class="token operator">/</span>exam_cnt_20<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span> growth_rate
	<span class="token punctuation">,</span>exam_cnt_rank_20
	<span class="token punctuation">,</span>exam_cnt_rank_21
<span class="token comment">-- 	,exam_cnt_21-exam_cnt_20 rank_delta</span>
	<span class="token punctuation">,</span>cast<span class="token punctuation">(</span>exam_cnt_rank_21 <span class="token keyword">as</span> signed<span class="token punctuation">)</span> <span class="token operator">-</span> cast<span class="token punctuation">(</span>exam_cnt_rank_20 <span class="token keyword">as</span> signed<span class="token punctuation">)</span> rank_delta   <span class="token comment">-- 将value转换成INT(有符号的整数)格式</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token comment">#第二步：计算growth_rate</span>
		<span class="token keyword">select</span> 
			tag
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token string">'2020'</span><span class="token punctuation">,</span>exam_cnt<span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> exam_cnt_20
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token string">'2021'</span><span class="token punctuation">,</span>exam_cnt<span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> exam_cnt_21
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token string">'2020'</span><span class="token punctuation">,</span>exam_cnt_rank<span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> exam_cnt_rank_20
			<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">year</span><span class="token operator">=</span><span class="token string">'2021'</span><span class="token punctuation">,</span>exam_cnt_rank<span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> exam_cnt_rank_21
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
			     <span class="token comment">#第一步：找到所有tag在2020，2021上半年的完成数和排名</span>
					<span class="token keyword">select</span> 
						tag
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">year</span>
						<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">)</span> exam_cnt
						<span class="token punctuation">,</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> substr<span class="token punctuation">(</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> exam_cnt_rank
					<span class="token keyword">from</span> <span class="token punctuation">(</span>
								<span class="token keyword">select</span> 
									exam_id
									<span class="token punctuation">,</span>tag
								<span class="token keyword">from</span> examination_info
					<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>					
											<span class="token keyword">select</span> 
												exam_id
												<span class="token punctuation">,</span>start_time
												<span class="token punctuation">,</span>submit_time
											<span class="token keyword">from</span> exam_record 
											<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-01-01'</span> <span class="token operator">and</span> <span class="token string">'2021-06-30'</span>
					<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
					<span class="token keyword">group</span> <span class="token keyword">by</span> tag<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
					<span class="token keyword">union</span> <span class="token keyword">all</span>
					<span class="token keyword">select</span> 
						tag
						<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>c<span class="token punctuation">.</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">year</span>
						<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>submit_time<span class="token punctuation">)</span> exam_cnt
						<span class="token punctuation">,</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> substr<span class="token punctuation">(</span>c<span class="token punctuation">.</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>submit_time<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> exam_cnt_rank
					<span class="token keyword">from</span> <span class="token punctuation">(</span>
								<span class="token keyword">select</span> 
									exam_id
									<span class="token punctuation">,</span>tag
								<span class="token keyword">from</span> examination_info
					<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>					
										<span class="token keyword">select</span> 
											exam_id
											<span class="token punctuation">,</span>start_time
											<span class="token punctuation">,</span>submit_time
										<span class="token keyword">from</span> exam_record 
										<span class="token keyword">where</span> substr<span class="token punctuation">(</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2020-01-01'</span> <span class="token operator">and</span> <span class="token string">'2020-06-30'</span>
					<span class="token punctuation">)</span> c <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>c<span class="token punctuation">.</span>exam_id
					<span class="token keyword">group</span> <span class="token keyword">by</span> tag<span class="token punctuation">,</span>substr<span class="token punctuation">(</span>c<span class="token punctuation">.</span>submit_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
		<span class="token punctuation">)</span> a1
		<span class="token keyword">group</span> <span class="token keyword">by</span> tag
<span class="token punctuation">)</span> a2
<span class="token keyword">where</span> exam_cnt_20 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> exam_cnt_21 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>  <span class="token comment"># 第四步：筛选出2020和2021年均有完成记录的tag，并按题目要求排序</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> growth_rate <span class="token keyword">desc</span><span class="token punctuation">,</span>exam_cnt_rank_21 <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c8/40/a07ZBoQl_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="2__2147"></a>2. 聚合窗口函数</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：对试卷得分做min-max归一化】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_bin<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'PYTHON'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9005</span><span class="token punctuation">,</span> <span class="token string">'WEB'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9006</span><span class="token punctuation">,</span> <span class="token string">'PYTHON'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9007</span><span class="token punctuation">,</span> <span class="token string">'web'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9008</span><span class="token punctuation">,</span> <span class="token string">'Web'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9009</span><span class="token punctuation">,</span> <span class="token string">'WEB'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9010</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:43:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9005</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/17/diDnvD8P_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid
	<span class="token punctuation">,</span>exam_id
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>min_max<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> avg_new_score		<span class="token comment">#归一化后分数平均值</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span>exam_id
			<span class="token punctuation">,</span>score
			<span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span>min_score<span class="token operator">=</span>max_score<span class="token punctuation">,</span>score<span class="token punctuation">,</span><span class="token punctuation">(</span>score<span class="token operator">-</span>min_score<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>max_score<span class="token operator">-</span>min_score<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span> min_max   <span class="token comment">#归一化后缩放到[0,100]区间</span>
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					b<span class="token punctuation">.</span>uid
					<span class="token punctuation">,</span>b<span class="token punctuation">.</span>exam_id
					<span class="token punctuation">,</span>b<span class="token punctuation">.</span>score
					<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> b<span class="token punctuation">.</span>exam_id<span class="token punctuation">)</span> min_score   <span class="token comment">#求每类试卷的得分最小值</span>
					<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> b<span class="token punctuation">.</span>exam_id<span class="token punctuation">)</span> max_score   <span class="token comment">#求每类试卷的得分最大值</span>
				<span class="token keyword">from</span> <span class="token punctuation">(</span>
						<span class="token keyword">select</span> 
							exam_id
							<span class="token punctuation">,</span>difficulty
						<span class="token keyword">from</span> examination_info
						<span class="token keyword">where</span> difficulty <span class="token operator">=</span><span class="token string">'hard'</span>		<span class="token comment">#难度为hard</span>
				<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
							<span class="token keyword">select</span> 
								uid
								<span class="token punctuation">,</span>exam_id
								<span class="token punctuation">,</span>score
							<span class="token keyword">from</span> exam_record
				<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
				<span class="token keyword">where</span> b<span class="token punctuation">.</span>score <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>    			<span class="token comment">#得分不为null</span>
		<span class="token punctuation">)</span> a1
<span class="token punctuation">)</span> a2
<span class="token keyword">group</span> <span class="token keyword">by</span> uid<span class="token punctuation">,</span>exam_id
<span class="token keyword">order</span> <span class="token keyword">by</span> exam_id<span class="token punctuation">,</span>avg_new_score <span class="token keyword">desc</span>						<span class="token comment">#按照试卷ID升序，评价分降序排序</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7a/a5/CSjLPAXK_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：每份试卷每月作答数和截止当月的作答总数】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:10:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:59:01'</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:20:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:43:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-03-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/4d/7Lm8G5yD_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	exam_id
	<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span> start_month 
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> month_cnt                  <span class="token comment">#每份试卷每月作答数</span>
	<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> exam_id <span class="token keyword">order</span> <span class="token keyword">by</span> date_format<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> cum_exam_cnt   <span class="token comment">#每份试卷截止当月的作答总数</span>
<span class="token keyword">from</span> exam_record
<span class="token keyword">group</span> <span class="token keyword">by</span> exam_id<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/ce/gstfOHmt_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：每月及截止当月的答题情况】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:10:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-03-01 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-05-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:59:01'</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:20:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:43:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-03-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f3/ea/PUpUO93j_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
	start_month
	<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> uid<span class="token punctuation">)</span> 	mau    					<span class="token comment">#月活用户数</span>
	<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>new_day<span class="token punctuation">)</span> 				month_add_uv		<span class="token comment">#新增用户数</span>
	<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>new_day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> start_month<span class="token punctuation">)</span>   <span class="token comment">#截止当月的单月最大新增用户数 </span>
	<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>new_day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> start_month<span class="token punctuation">)</span>   <span class="token comment">#截止当月的累积用户数</span>
<span class="token keyword">from</span><span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span>exam_id
			<span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span><span class="token string">'%Y%m'</span><span class="token punctuation">)</span> start_month
			<span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span>new_user_day<span class="token operator">=</span>start_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> new_day      <span class="token comment">#若用户的登录时间等于首次登录时间则定义为新用户，新用户被标记为1，其他标记为0</span>
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span>exam_id
					<span class="token punctuation">,</span>start_time
					<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> uid<span class="token punctuation">)</span> new_user_day   <span class="token comment">#每一个用户的首次登录日期</span>
				<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> a
<span class="token punctuation">)</span> a1
<span class="token keyword">group</span> <span class="token keyword">by</span> start_month
<span class="token keyword">order</span> <span class="token keyword">by</span> start_month
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/02/a0/fAHG8TO2_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h2><a id="_2342"></a>六、其他常用操作</h2> 
<h3><a id="1__2343"></a>1. 空值处理</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：统计有未完成状态的试卷的未完成数和未完成率0级用户高难度试卷的平均用时和平均得分】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入；</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:30:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/21/8b/wJ8V6veC_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	exam_id
	<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> incomplete_cnt   <span class="token comment">#未完成数</span>
	<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>  incomplete_rate <span class="token comment">#未完成率</span>
<span class="token keyword">from</span> exam_record
<span class="token keyword">group</span> <span class="token keyword">by</span> exam_id
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">1</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/eb/9e/BDcBGb7K_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：0级用户高难度试卷的平均用时和平均得分】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1号'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">2100</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'easy'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/f2/Uys6xzNA_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> avg_score      			<span class="token comment">#考试平均得分</span>
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>diff_m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> avg_time_took				<span class="token comment">#考试平均用时</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			a<span class="token punctuation">.</span>uid
			<span class="token punctuation">,</span>c<span class="token punctuation">.</span>exam_id
			<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>timestampdiff<span class="token punctuation">(</span><span class="token keyword">minute</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span>start_time<span class="token punctuation">,</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">)</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>duration<span class="token punctuation">)</span> diff_m   <span class="token comment">#未完成的默认试卷最大考试时长</span>
			<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span>b<span class="token punctuation">.</span>score<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> score     <span class="token comment">#未完成的默认试卷0分处理</span>
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span><span class="token keyword">level</span>
				<span class="token keyword">from</span> user_info
				<span class="token keyword">where</span> <span class="token identifier"><span class="token punctuation">`</span>level<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">'0'</span>      <span class="token comment">#每个0级用户</span>
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span>exam_id
						<span class="token punctuation">,</span>start_time
						<span class="token punctuation">,</span>submit_time
						<span class="token punctuation">,</span>score
					<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid 
		<span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id
					<span class="token punctuation">,</span>difficulty
					<span class="token punctuation">,</span>duration
				<span class="token keyword">from</span> examination_info
				<span class="token keyword">where</span> difficulty<span class="token operator">=</span><span class="token string">'hard'</span>    <span class="token comment">#所有的高难度试卷</span>
		<span class="token punctuation">)</span> c <span class="token keyword">on</span> b<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>c<span class="token punctuation">.</span>exam_id
<span class="token punctuation">)</span> a1
<span class="token keyword">group</span> <span class="token keyword">by</span> uid
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/25/c0/HzQL6NU7_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="2__2472"></a>2. 高级条件语句</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：筛选限定昵称成就值活跃日期的用户】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">,</span>practice_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> practice_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    question_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'题目ID'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1号'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'进击的3号'</span><span class="token punctuation">,</span> <span class="token number">2200</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客5号'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> practice_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>question_id<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-08-02 11:41:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:20:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 19:38:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-02-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-02-01 11:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-01 11:31:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-02-01 11:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-01 11:31:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f8/a7/CjJNVbdB_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
	a<span class="token punctuation">.</span>uid
	<span class="token punctuation">,</span>a<span class="token punctuation">.</span>nick_name
	<span class="token punctuation">,</span>a<span class="token punctuation">.</span>achievement
<span class="token keyword">from</span><span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span>nick_name
			<span class="token punctuation">,</span>achievement
		<span class="token keyword">from</span> user_info
		<span class="token keyword">where</span> nick_name <span class="token operator">like</span> <span class="token string">'牛客%号'</span>							<span class="token comment">#昵称以『牛客』开头『号』结尾、成就值在1200~2500之间</span>
		<span class="token operator">and</span> achievement <span class="token operator">between</span> <span class="token string">'1200'</span> <span class="token operator">and</span> <span class="token string">'2500'</span>
<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
			<span class="token keyword">select</span>  
				uid
			<span class="token keyword">from</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span>start_time
						<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> uid<span class="token punctuation">)</span> max_time    <span class="token comment">#最近一次活跃答题在2021年9月</span>
					<span class="token keyword">from</span> exam_record
			<span class="token punctuation">)</span> a
			<span class="token keyword">where</span> substr<span class="token punctuation">(</span>max_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021-09'</span>
			<span class="token keyword">group</span> <span class="token keyword">by</span> uid
			<span class="token keyword">union</span> 
			<span class="token keyword">select</span>  
				uid
			<span class="token keyword">from</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span>submit_time
						<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> uid<span class="token punctuation">)</span> max_time    <span class="token comment">#最近一次活跃作答试卷在2021年9月</span>
					<span class="token keyword">from</span> practice_record
			<span class="token punctuation">)</span> a
			<span class="token keyword">where</span> substr<span class="token punctuation">(</span>max_time<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2021-09'</span>
			<span class="token keyword">group</span> <span class="token keyword">by</span> uid
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/30/RAurxW6G_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：筛选昵称规则和试卷规则的作答记录】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">1900</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">2200</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客555号'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'666666'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'c#'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:59:02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-02-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-08-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-02-01 11:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-01 11:31:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 11:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 11:31:01'</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:21:01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ff/f3/enXhdpny_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>RLIKE后面可以跟正则表达式</strong><br> <strong>正则表达式" ^ [0-9]+$ "的意思</strong>：<br> <strong>1、字符^</strong><br> 意义：表示匹配的字符必须在最前边。<br> 例如：^A不匹配“an A”中的‘A’，但匹配“An A”中最前面的‘A’。<br> <strong>2、字符$</strong><br> 意义：与^类似，匹配最末的字符。<br> 例如：t$不匹配“eater”中的‘t’，但匹配“eat”中的‘t’。<br> <strong>3、字符[0-9]</strong><br> 意义：字符列表，匹配列出中的任一个字符。你可以通过连字符-指出字符范围。<br> 例如：[abc]跟[a-c]一样。它们匹配“brisket”中的‘b’和“ache”中的‘c’。<br> <strong>4、字符+</strong><br> 意义：匹配+号前面的字符1次及以上。等价于{1,}。<br> 例如：a+匹配“candy”中的‘a’和“caaaaaaandy”中的所有‘a’。</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	b<span class="token punctuation">.</span>uid	
	<span class="token punctuation">,</span>b<span class="token punctuation">.</span>exam_id
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> avg_score
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid
			<span class="token punctuation">,</span>nick_name
		<span class="token keyword">from</span> user_info
		<span class="token keyword">where</span> <span class="token punctuation">(</span>nick_name <span class="token operator">rlike</span> <span class="token string">'^牛客[0-9]+号$'</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span>nick_name <span class="token operator">rlike</span> <span class="token string">'^[0-9]+$'</span><span class="token punctuation">)</span>  <span class="token comment">#昵称以"牛客"+纯数字+"号"或者纯数字组成</span>
<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
			<span class="token keyword">select</span> 
				uid
				<span class="token punctuation">,</span>exam_id
				<span class="token punctuation">,</span>score
				<span class="token punctuation">,</span>submit_time
			<span class="token keyword">from</span> exam_record
			<span class="token keyword">where</span> submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>         <span class="token comment"># 已完成的试卷</span>
<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
<span class="token keyword">join</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			exam_id
			<span class="token punctuation">,</span>tag 
		<span class="token keyword">from</span> examination_info    
		<span class="token keyword">where</span> tag <span class="token operator">rlike</span> <span class="token string">'^[cC]'</span>       <span class="token comment"># 字母c开头的试卷类别（如C,C++,c#等）</span>
<span class="token punctuation">)</span> c <span class="token keyword">on</span> b<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>c<span class="token punctuation">.</span>exam_id
<span class="token keyword">group</span> <span class="token keyword">by</span> b<span class="token punctuation">.</span>uid<span class="token punctuation">,</span>b<span class="token punctuation">.</span>exam_id
<span class="token keyword">order</span> <span class="token keyword">by</span> b<span class="token punctuation">.</span>uid<span class="token punctuation">,</span>avg_score
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/32/b2/vTuJ1cXm_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：根据指定记录是否存在输出不同情况】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客555号'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'666666'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'2021-09-03 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-05-05 18:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-02-06 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-07 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9f/8d/vzXi0zbi_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">with</span> t1 <span class="token keyword">as</span><span class="token punctuation">(</span>
			<span class="token keyword">select</span> 
				a<span class="token punctuation">.</span>uid
				<span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token keyword">level</span>
				<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span>                 			total_cnt													<span class="token comment">#每个用户的答题数</span>
				<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span>  	incomplete_cnt    								<span class="token comment">#每个用户的未完成数</span>
				<span class="token punctuation">,</span>ifnull<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">count</span><span class="token punctuation">(</span>submit_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  incomplete_rate  <span class="token comment">#每个用户的未完成率</span>
			<span class="token keyword">from</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span><span class="token keyword">level</span>
					<span class="token keyword">from</span> user_info
			<span class="token punctuation">)</span> a <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token punctuation">(</span>
							<span class="token keyword">select</span> 
								uid
								<span class="token punctuation">,</span>exam_id
								<span class="token punctuation">,</span>start_time
								<span class="token punctuation">,</span>submit_time
							<span class="token keyword">from</span> exam_record
			<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
			<span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token keyword">level</span>
<span class="token punctuation">)</span> <span class="token comment">#命名为t1的子查询</span>

<span class="token keyword">select</span> 
	uid	
	<span class="token punctuation">,</span>incomplete_cnt	
	<span class="token punctuation">,</span>incomplete_rate
<span class="token keyword">from</span> t1
<span class="token keyword">where</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> uid <span class="token keyword">from</span> t1 <span class="token keyword">where</span> <span class="token keyword">level</span><span class="token operator">=</span><span class="token string">'0'</span> <span class="token operator">and</span> incomplete_cnt<span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">)</span>     <span class="token comment">#出现level=0且存在incomplete_cnt&gt;2时</span>
<span class="token operator">and</span> <span class="token keyword">level</span><span class="token operator">=</span><span class="token string">'0'</span> 																														<span class="token comment">#输出level=0的用户未完成数和未完成率</span>
<span class="token keyword">union</span> <span class="token keyword">all</span> 
<span class="token keyword">select</span> 
	uid	
	<span class="token punctuation">,</span>incomplete_cnt	
	<span class="token punctuation">,</span>incomplete_rate
<span class="token keyword">from</span> t1
<span class="token keyword">where</span> <span class="token operator">not</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> uid <span class="token keyword">from</span> t1 <span class="token keyword">where</span> <span class="token keyword">level</span><span class="token operator">=</span><span class="token string">'0'</span> <span class="token operator">and</span> incomplete_cnt<span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#没出现level=0且存在incomplete_cnt&gt;2时</span>
<span class="token operator">and</span> total_cnt<span class="token operator">&gt;=</span><span class="token number">1</span>																													<span class="token comment">#输出所有有作答记录的用户的未完成数和未完成率</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> incomplete_rate
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/31/mZj87pe8_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目4</strong></font>：各用户等级的不同得分表现占比】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客555号'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'666666'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-05-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-02-02 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-02 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-06-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-05 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'2021-09-03 12:01:01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b6/6a/sztCaZhE_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	<span class="token keyword">level</span>
	<span class="token punctuation">,</span>score_grade
	<span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span>score_grade<span class="token punctuation">)</span><span class="token operator">/</span>total_cnt<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>  ratio <span class="token comment"># 各得分等级占比</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span>
			a<span class="token punctuation">.</span>uid
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>exam_id
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>submit_time
			<span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token keyword">level</span>
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>score_grade
			<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>score_grade<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token punctuation">)</span> total_cnt  <span class="token comment">#各等级完成试卷总数</span>
		<span class="token keyword">from</span> <span class="token punctuation">(</span> 
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span><span class="token keyword">level</span> 
				<span class="token keyword">from</span> user_info
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span>exam_id
						<span class="token punctuation">,</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;=</span><span class="token number">90</span> <span class="token keyword">then</span> <span class="token string">'优'</span>
							  <span class="token keyword">when</span> score<span class="token operator">&gt;=</span><span class="token number">75</span> <span class="token keyword">then</span> <span class="token string">'良'</span>
							  <span class="token keyword">when</span> score<span class="token operator">&gt;=</span><span class="token number">60</span> <span class="token keyword">then</span> <span class="token string">'中'</span>
							  <span class="token keyword">when</span> score<span class="token operator">&lt;</span><span class="token number">60</span>  <span class="token keyword">then</span> <span class="token string">'差'</span> 
							  <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span> score_grade   <span class="token comment"># 优良中差四个得分等级</span>
						<span class="token punctuation">,</span>submit_time
						<span class="token punctuation">,</span>score
					<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid	
		<span class="token keyword">where</span> submit_time <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>		        				<span class="token comment"># 在完成过的试卷中</span>
<span class="token punctuation">)</span> a1
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">level</span><span class="token punctuation">,</span>score_grade
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">level</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>ratio <span class="token keyword">desc</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4f/30/n0LO9efm_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="3__2882"></a>3. 限量查询</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：注册时间最早的三个人】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token keyword">level</span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客555号'</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-11 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'666666'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/9e/bR0b3B8H_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid	
	<span class="token punctuation">,</span>nick_name	
	<span class="token punctuation">,</span>register_time	
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			uid	
			<span class="token punctuation">,</span>nick_name	
			<span class="token punctuation">,</span>register_time
			<span class="token punctuation">,</span>row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> register_time<span class="token punctuation">)</span> rn
		<span class="token keyword">from</span> user_info
<span class="token punctuation">)</span> a
<span class="token keyword">where</span> rn<span class="token operator">&lt;=</span><span class="token number">3</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0b/b5/v59OZ1DT_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：注册当天就完成了试卷的名单三页】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>user_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> exam_record <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    start_time <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'开始时间'</span><span class="token punctuation">,</span>
    submit_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'提交时间'</span><span class="token punctuation">,</span>
    score <span class="token keyword">tinyint</span> <span class="token keyword">COMMENT</span> <span class="token string">'得分'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>level<span class="token punctuation">`</span></span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客555号'</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'牛客6号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1007</span><span class="token punctuation">,</span> <span class="token string">'牛客7号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1008</span><span class="token punctuation">,</span> <span class="token string">'牛客8号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1009</span><span class="token punctuation">,</span> <span class="token string">'牛客9号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1010</span><span class="token punctuation">,</span> <span class="token string">'牛客10号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1011</span><span class="token punctuation">,</span> <span class="token string">'666666'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> exam_record<span class="token punctuation">(</span>uid<span class="token punctuation">,</span>exam_id<span class="token punctuation">,</span>start_time<span class="token punctuation">,</span>submit_time<span class="token punctuation">,</span>score<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 09:21:59'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-20 10:10:01'</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 19:30:01'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:11:01'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:32:00'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1007</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 19:40:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1008</span><span class="token punctuation">,</span> <span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:20:01'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1008</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:31:01'</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1010</span><span class="token punctuation">,</span> <span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:11:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 12:41:01'</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1011</span><span class="token punctuation">,</span> <span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:01:01'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 10:31:01'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/95/b5/BqbPqtXd_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid
	<span class="token punctuation">,</span><span class="token keyword">level</span>
	<span class="token punctuation">,</span>register_time 
	<span class="token punctuation">,</span>max_score
<span class="token keyword">from</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> 
			b<span class="token punctuation">.</span>uid
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>exam_id
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>submit_time
			<span class="token punctuation">,</span>a<span class="token punctuation">.</span>register_time
			<span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token keyword">level</span>
			<span class="token punctuation">,</span>b<span class="token punctuation">.</span>score
			<span class="token punctuation">,</span>d<span class="token punctuation">.</span>max_score
		<span class="token keyword">from</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span><span class="token keyword">level</span>
					<span class="token punctuation">,</span>job
					<span class="token punctuation">,</span> register_time
				<span class="token keyword">from</span> user_info
				<span class="token keyword">where</span> job<span class="token operator">=</span><span class="token string">'算法'</span>					<span class="token comment">#求职方向为算法工程师</span>
		<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
					<span class="token keyword">select</span> 
						uid
						<span class="token punctuation">,</span>exam_id
						<span class="token punctuation">,</span>submit_time
						<span class="token punctuation">,</span>score
					<span class="token keyword">from</span> exam_record
		<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>b<span class="token punctuation">.</span>uid
		<span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					exam_id
					<span class="token punctuation">,</span>tag
				<span class="token keyword">from</span> examination_info
				<span class="token keyword">where</span> tag<span class="token operator">=</span><span class="token string">'算法'</span>					<span class="token comment">#算法类试卷</span>
		<span class="token punctuation">)</span> c <span class="token keyword">on</span> b<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>c<span class="token punctuation">.</span>exam_id
		<span class="token keyword">join</span> <span class="token punctuation">(</span>
				<span class="token keyword">select</span> 
					uid
					<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>  max_score		<span class="token comment">#参加过的所有考试最高得分</span>
				<span class="token keyword">from</span> exam_record
				<span class="token keyword">group</span> <span class="token keyword">by</span> uid
		<span class="token punctuation">)</span> d <span class="token keyword">on</span> a<span class="token punctuation">.</span>uid<span class="token operator">=</span>d<span class="token punctuation">.</span>uid
		<span class="token keyword">where</span> <span class="token keyword">date</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>register_time<span class="token punctuation">)</span><span class="token operator">=</span><span class="token keyword">date</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>submit_time<span class="token punctuation">)</span>   <span class="token comment">#注册当天就完成了算法类试卷</span>
<span class="token punctuation">)</span> a1
<span class="token keyword">order</span> <span class="token keyword">by</span> max_score <span class="token keyword">desc</span>
<span class="token keyword">LIMIT</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span>												  <span class="token comment">#展示7-9行</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/05/d5/Zds3ZKAt_o.png" alt="在这里插入图片描述"><br> <br></p> 
<h3><a id="4__3049"></a>4. 文本转换函数</h3> 
<p>【<font color="#DB7093"><strong>题目1</strong></font>：修复串列了的记录】</p> 
<pre><code class="prism language-sql"><span class="token comment">--输入：</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> examination_info<span class="token punctuation">,</span>exam_record<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> examination_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    exam_id <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'试卷ID'</span><span class="token punctuation">,</span>
    tag <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'类别标签'</span><span class="token punctuation">,</span>
    difficulty <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'难度'</span><span class="token punctuation">,</span>
    duration <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'时长'</span><span class="token punctuation">,</span>
    release_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'发布时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> examination_info<span class="token punctuation">(</span>exam_id<span class="token punctuation">,</span>tag<span class="token punctuation">,</span>difficulty<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>release_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">9001</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'hard'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9003</span><span class="token punctuation">,</span> <span class="token string">'SQL'</span><span class="token punctuation">,</span> <span class="token string">'medium'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9004</span><span class="token punctuation">,</span> <span class="token string">'算法,medium,80'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3a/ab/xtgwEkHG_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	exam_id	
	<span class="token punctuation">,</span>substring_index<span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> tag	
	<span class="token punctuation">,</span>substring_index<span class="token punctuation">(</span>substring_index<span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> difficulty	
	<span class="token punctuation">,</span>substring_index<span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> duration
<span class="token keyword">from</span> examination_info
<span class="token keyword">where</span> tag <span class="token operator">like</span> <span class="token string">'%,%'</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/66/d1/R7t47is7_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目2</strong></font>：对过长的昵称截取处理】<br> <img src="https://images2.imgbox.com/59/4f/mQuPgSXE_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>获取字符串长度</strong><br> <strong>LENTH</strong>：获取字符串的字节数量，一个中文字符通常不止占用一个字节<br> <strong>CHAR_LENTH</strong>：获取字符数量，不管汉字、字母、数字都算一个字符</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
	uid	
	<span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span>char_length<span class="token punctuation">(</span>nick_name<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">13</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>nick_name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nick_name<span class="token punctuation">)</span> nick_name
<span class="token keyword">from</span> user_info
<span class="token keyword">where</span> char_length<span class="token punctuation">(</span>nick_name<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">10</span>
<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0f/6f/OAumwIsA_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>【<font color="#DB7093"><strong>题目3</strong></font>：大小写混乱时的筛选统计】</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> user_info<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_info <span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'自增ID'</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'昵称'</span><span class="token punctuation">,</span>
    achievement <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'成就值'</span><span class="token punctuation">,</span>
    <span class="token keyword">level</span> <span class="token keyword">int</span> <span class="token keyword">COMMENT</span> <span class="token string">'用户等级'</span><span class="token punctuation">,</span>
    job <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'职业方向'</span><span class="token punctuation">,</span>
    register_time <span class="token keyword">datetime</span> <span class="token keyword">COMMENT</span> <span class="token string">'注册时间'</span>
<span class="token punctuation">)</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> user_info<span class="token punctuation">(</span>uid<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>nick_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>achievement<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>level<span class="token punctuation">`</span></span><span class="token punctuation">,</span>job<span class="token punctuation">,</span>register_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'牛客1'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'牛客2号'</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'牛客3号♂'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'牛客4号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'牛客5678901234号'</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-01 10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'牛客67890123456789号'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'算法'</span><span class="token punctuation">,</span> <span class="token string">'2020-01-02 11:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a8/78/GHgmqerl_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">with</span> t_tag_count <span class="token keyword">as</span> <span class="token punctuation">(</span>
						<span class="token keyword">select</span> 
							tag
							<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>start_time<span class="token punctuation">)</span> answer_cnt
						<span class="token keyword">from</span> <span class="token punctuation">(</span>
										<span class="token keyword">select</span> 
											exam_id
											<span class="token punctuation">,</span>tag
										<span class="token keyword">from</span> examination_info
						<span class="token punctuation">)</span> a <span class="token keyword">join</span> <span class="token punctuation">(</span>
												<span class="token keyword">select</span> 
													exam_id
													<span class="token punctuation">,</span>start_time
												<span class="token keyword">from</span> exam_record
						<span class="token punctuation">)</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>exam_id<span class="token operator">=</span>b<span class="token punctuation">.</span>exam_id
						<span class="token keyword">group</span> <span class="token keyword">by</span> tag
<span class="token punctuation">)</span> 	
							
<span class="token keyword">select</span> 
	a<span class="token punctuation">.</span>tag
	<span class="token punctuation">,</span>b<span class="token punctuation">.</span>answer_cnt
<span class="token keyword">from</span> t_tag_count  a
<span class="token keyword">join</span> t_tag_count  b
<span class="token keyword">on</span> upper<span class="token punctuation">(</span>a<span class="token punctuation">.</span>tag<span class="token punctuation">)</span> <span class="token operator">=</span> b<span class="token punctuation">.</span>tag <span class="token operator">and</span> a<span class="token punctuation">.</span>tag <span class="token operator">!=</span> b<span class="token punctuation">.</span>tag <span class="token operator">and</span> a<span class="token punctuation">.</span>answer_cnt <span class="token operator">&lt;</span> <span class="token number">3</span>
<span class="token punctuation">;</span>				
</code></pre> 
<p><img src="https://images2.imgbox.com/99/7b/3ob5HZfD_o.png" alt="在这里插入图片描述"><br> <br></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ea4d6d3e40140232182ee85d11e7b6f1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;面向对象（OOP）编程-多线程详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b6f9be632a4eaf96c6e8013cfb6011c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">留言板（Mybatis连接数据库版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>