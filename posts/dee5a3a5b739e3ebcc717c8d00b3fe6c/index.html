<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第十四届华中杯大学生数学建模挑战赛A题Python解答共51批（附文件源码链接）需者自取 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="第十四届华中杯大学生数学建模挑战赛A题Python解答共51批（附文件源码链接）需者自取" />
<meta property="og:description" content="问题重述：
A 题 分拣系统优化问题 某电商公司配送中心的工作流程分为统计汇总、转运上架、按订单分拣、核对打包等 步骤。其中，分拣环节操作复杂，耗时较长，其效率是影响配送中心整体性能的关键因素。 首先，系统统计汇总出当天全部待配送订单所包含的所有货品及相应数量。然后，转运工 将这些货品由仓库转运至分拣处，并放置到货架上，等待分拣。上架时，一个货架中仅放 置同一种货品。为简化问题，不考虑货架的容积和载重限制，即每个货架能够放置的货品 件数没有限制。最后，分拣工按任务单依次分拣出每一个订单包含的货品。 例如，某天共有 5 个订单，订单的信息如表 1 （原始数据文件格式见附件 1 格式说明） 所示。 表 1 ：订单信息示例 订单编号 所含货品种类及相应数量 D0001 P0001 × 2, P0002 × 1, P0003 × 1, P0004 × 1 D0002 P0003 × 1, P0004 × 1, P0005 × 1, P0006 × 3 D0003 P0001 × 1, P0003 × 1, P0005 × 1, P0007 × 1 D0004 P0002 × 1, P0004 × 1, P0006 × 1, P0008 × 3 D0005 P0001 × 1, P0003 × 2, P0004 × 1, P0007 × 1 系统统计出这 5 个订单共包含 8 种 26 件货品，分别为 4 件 P0001 、 2 件 P0002 、 5 件 P0003 、 4 件 P0004 、 2 件 P0005 、 4 件 P0006 、 2 件 P0007 和 3 件 P0008 。转运工将这些货 品分别放置在 8 个货架上。分拣工根据任务单上的订单信息，依次分拣出每一个订单的货 品。 随着该公司业务量不断增长，未来有可能出现当天待配送订单所含货品种类数大于当 前货架数量 的情况（假设任何一个订单所含货品种类数均小于货架数量 ）。但是， 由于受到场地和成本的限制，很难直接增加货架。该公司希望在你们团队的协助下解决该 问题，并尝试提高分拣效率。具体解决如下问题。 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/dee5a3a5b739e3ebcc717c8d00b3fe6c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-31T13:28:26+08:00" />
<meta property="article:modified_time" content="2022-08-31T13:28:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第十四届华中杯大学生数学建模挑战赛A题Python解答共51批（附文件源码链接）需者自取</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>问题重述：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<div> 
 <span style="color:#000000;"><strong>A </strong></span> 
 <span style="color:#000000;"><strong>题</strong></span> 
 <span style="color:#000000;"><strong>分拣系统优化问题 </strong></span> 
</div> 
<div> 
 <span style="color:#000000;">某电商公司配送中心的工作流程分为统计汇总、转运上架、按订单分拣、核对打包等 </span> 
</div> 
<div> 
 <span style="color:#000000;">步骤。其中，分拣环节操作复杂，耗时较长，其效率是影响配送中心整体性能的关键因素。 </span> 
</div> 
<div> 
 <span style="color:#000000;">首先，系统统计汇总出当天全部待配送订单所包含的所有货品及相应数量。然后，转运工 </span> 
</div> 
<div> 
 <span style="color:#000000;">将这些货品由仓库转运至分拣处，并放置到货架上，等待分拣。上架时，一个货架中仅放 </span> 
</div> 
<div> 
 <span style="color:#000000;">置同一种货品。为简化问题，不考虑货架的容积和载重限制，即每个货架能够放置的货品 </span> 
</div> 
<div> 
 <span style="color:#000000;">件数没有限制。最后，分拣工按任务单依次分拣出每一个订单包含的货品。 </span> 
</div> 
<div> 
 <span style="color:#000000;">例如，某天共有 </span> 
 <span style="color:#000000;">5 </span> 
 <span style="color:#000000;">个订单，订单的信息如表 </span> 
 <span style="color:#000000;">1</span> 
 <span style="color:#000000;">（原始数据文件格式见附件 </span> 
 <span style="color:#000000;">1 </span> 
 <span style="color:#000000;">格式说明） </span> 
</div> 
<div> 
 <span style="color:#000000;">所示。 </span> 
</div> 
<div> 
 <span style="color:#000000;"><strong>表 </strong></span> 
 <span style="color:#000000;"><strong>1</strong></span> 
 <span style="color:#000000;"><strong>：订单信息示例 </strong></span> 
</div> 
<div> 
 <span style="color:#000000;">订单编号 </span> 
</div> 
<div> 
 <span style="color:#000000;">所含货品种类及相应数量 </span> 
</div> 
<div> 
 <span style="color:#000000;">D0001 </span> 
</div> 
<div> 
 <span style="color:#000000;">P0001</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">2, P0002</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0003</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0004</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1 </span> 
</div> 
<div> 
 <span style="color:#000000;">D0002 </span> 
</div> 
<div> 
 <span style="color:#000000;">P0003</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0004</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0005</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0006</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">3 </span> 
</div> 
<div> 
 <span style="color:#000000;">D0003 </span> 
</div> 
<div> 
 <span style="color:#000000;">P0001</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0003</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0005</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0007</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1 </span> 
</div> 
<div> 
 <span style="color:#000000;">D0004 </span> 
</div> 
<div> 
 <span style="color:#000000;">P0002</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0004</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0006</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0008</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">3 </span> 
</div> 
<div> 
 <span style="color:#000000;">D0005 </span> 
</div> 
<div> 
 <span style="color:#000000;">P0001</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0003</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">2, P0004</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1, P0007</span> 
 <span style="color:#000000;">×</span> 
 <span style="color:#000000;">1 </span> 
</div> 
<div> 
 <span style="color:#000000;">系统统计出这 </span> 
 <span style="color:#000000;">5 </span> 
 <span style="color:#000000;">个订单共包含 </span> 
 <span style="color:#000000;">8 </span> 
 <span style="color:#000000;">种 </span> 
 <span style="color:#000000;">26 </span> 
 <span style="color:#000000;">件货品，分别为 </span> 
 <span style="color:#000000;">4 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0001</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">2 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0002</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">5 </span> 
 <span style="color:#000000;">件 </span> 
</div> 
<div> 
 <span style="color:#000000;">P0003</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">4 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0004</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">2 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0005</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">4 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0006</span> 
 <span style="color:#000000;">、</span> 
 <span style="color:#000000;">2 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0007 </span> 
 <span style="color:#000000;">和 </span> 
 <span style="color:#000000;">3 </span> 
 <span style="color:#000000;">件 </span> 
 <span style="color:#000000;">P0008</span> 
 <span style="color:#000000;">。转运工将这些货 </span> 
</div> 
<div> 
 <span style="color:#000000;">品分别放置在 </span> 
 <span style="color:#000000;">8 </span> 
 <span style="color:#000000;">个货架上。分拣工根据任务单上的订单信息，依次分拣出每一个订单的货 </span> 
</div> 
<div> 
 <span style="color:#000000;">品。 </span> 
</div> 
<div> 
 <span style="color:#000000;">随着该公司业务量不断增长，未来有可能出现当天待配送订单所含货品种类数大于当 </span> 
</div> 
<div> 
 <span style="color:#000000;">前货架数量 </span> 
</div> 
<div> 
 <span style="color:#000000;">的情况（假设任何一个订单所含货品种类数均小于货架数量 </span> 
</div> 
<div> 
 <span style="color:#000000;">）。但是， </span> 
</div> 
<div> 
 <span style="color:#000000;">由于受到场地和成本的限制，很难直接增加货架。该公司希望在你们团队的协助下解决该 </span> 
</div> 
<div> 
 <span style="color:#000000;">问题，并尝试提高分拣效率。具体解决如下问题。</span> 
</div> 
<div></div> 
<div></div> 
<div></div> 
<div></div> 
<div> 
 <span style="color:#000000;">1. </span> 
 <span style="color:#000000;"><strong>设计分批算法</strong></span> 
 <span style="color:#000000;">：将当日订单分为多个批次。要求每个批次的订单所含货品种类数均不 </span> 
</div> 
<div> 
 <span style="color:#000000;">超过 </span> 
</div> 
<div> 
 <span style="color:#000000;">，且批次越少越好（相应转运次数也越少，效率越高）。针对附件 </span> 
 <span style="color:#000000;">1 </span> 
 <span style="color:#000000;">中的订单 </span> 
</div> 
<div> 
 <span style="color:#000000;">信息，应用你们的算法，计算当货架数量 </span> 
</div> 
<div> 
 <span style="color:#000000;">时最少的批次数，给出每批订单数 </span> 
</div> 
<div> 
 <span style="color:#000000;">量、货品种类数、分批方案等结果，并将完整原始分批方案按指定格式输出到文件 </span> 
</div> 
<div> 
 <span style="color:#000000;">result1.csv </span> 
 <span style="color:#000000;">中，格式要求见附件 </span> 
 <span style="color:#000000;">2</span> 
 <span style="color:#000000;">。</span> 
</div> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>问题一解题思路（其他思路在链接里）</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第一步：</strong></strong>根据附件的订单信息，提取每个订单的货品种类数存入列表df_pv_list中，提取每个订单的编号存入列表orderno_list中，这两个列表中的元素个数一致，且每个订单编号对应的货品种类数在两个列表中的索引一致。例如，列表df_pv_list的第一个元素df_pv_list[0] =’D0001’对应的货品种类数，应为列表orderno_list的第一个元素orderno_list[0]=19种，即两个列表的索引值相互关联或者说完全一一对应。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第二步</strong></strong>：根据附件的订单信息，创建一个‘键’由订单号组成，‘值’由订单号对应的的货品种类列表组成的字典dic。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第三步：</strong></strong>从列表df_pv_list中获取一个最大值，即max_values = max(df_pv_list),通过index()方法得到max_values对应的索引值，即index_values = df_pv_list.index(max_values)，由于列表df_pv_list与列表orderno_list的索引值相对应，可以得到对应的订单编号orderno_max = orderno_list[index_values]。由订单编号orderno_max从字典dic中获取该订单编号对应的货品种类依次存入batch_s列表中，并统计其中货品种类个数n。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第四步</strong></strong>：用pop()方法将max_values从列表df_pv_list中移除，即df_pv_list.pop(index_values)，由于在列表df_pv_list中max_values可能不止一个，为了保证列表df_pv_list和列表orderno_list元素严格一一对应，此处移除只能用pop()方法，根据索引值去移除元素。再将订单编号orderno_max从列表orderno_list中移除，即orderno_list.remove(orderno_max)，此处移除操作可以使用remove()方法，因为列表orderno_list中的元素唯一，可以根据值去移除。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第五步：</strong></strong>使用循环逐个从列表orderno_list取出订单编号，将取出来的订单编号作为‘键’从字典dic中得到每个订单对应的货品种类列表，再嵌套循环将每个订单对应的货品种类列表里的每个元素与列表batch_s里的每个元素相比较，设置计数器count，表示每个订单对应的货品种类与列表batch_s里的货品种类相同的件数。如果有相等的元素对count进行加1操作。将所有count值存入列表num_com中，注意：列表df_pv_list，列表orderno_list与列表num_com的数据是严格一一对应的，即相同索引从三个列表取的值是一一对应的。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第六步</strong></strong>：判断n是否小于200，若是，则获取最大货品相同的件数max_num_com = max(num_com)，获取对应的索引max_num_com_index = num_comt.index(max_num_com)，获取对应的订单编号orderno_m = orderno_list[max_num_com_index]，将获取的订单编号作为‘键’从字典dic中得到每个订单对应的货品种类列表，求其列表长度得到货品种类数num，用货品种类数num减去列表num_com对应的货品相同件数得到不相同件数，即num_none = num - num_com[max_num_com_index]，并将该货品列表里的每个元素与batch_s列表中的元素一一比较，将不同的元素加入进batch_s列表中，再重新统计batch_s列表中的货品种数n。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>第七步：</strong></strong>创建批次列表batch_list(在第四步，执行移除操作之前应将订单orderno_max添加到该列表中)。将max_values赋给n，比较n是否小于200，若小于，将订单编号存入列表batch_list中，即batch_list.append(orderno_m)，执行n =n +num_none操作。再将列表df_pv_list中对应的值移除，即df_pv_list.pop(max_num_com_index)，将列表orderno_list中对应的值移除，即orderno_list.remove(orderno_m)，将列表num_com设置为空；重复第五步至第七步操作直到n大于等于200；若大于，批次操作完成，打印出batch_list列表信息，将列表num_com设置为空，将列表batch_s设置为空，重复执行第三步至第七步操作。每次重复执行第三步至第七步操作时，都需判断列表df_pv_list和列表orderno_list列表是否为空。若为空，则所有订单都已处理完成，将保存在列表batch_list中的数据依批次打印出来即可，再将其输出至result1.csv文件中。否则继续执行重复操作。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>分批算法Python实现：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建每个订单的货品种类数量列表df_pv_list</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建每个订单编号列表orderno_list</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建每个订单与之对应的货品种类列表的字典dic</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建每批次列表batch_list</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建总批次列表sum_batch_list</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建每批次货品种类数列表batch_s</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建总批次货品种类数列表sum_batch_s</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建订单的货品种类的相同数列表num_com</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<ol><li style="text-align:justify;"><strong><strong>定义getMax_per_batch_info(n)方法，有1个形参，用来传入每批货品种类的值n。该方法的功能为经计算后返回列表batch_s货品种类数和batch_s货品列表，共返回两个值。</strong></strong></li><li style="text-align:justify;"><strong><strong>定义get_num_com(i_l_m)方法，有1个形参，分别以getMax_per_bath_info()方法返回的batch_s值作为实参传入。该方法功能为计算其他订单与batch_s列表中货品种类相同的件数，并将其结果存入num_com列表中。</strong></strong></li><li style="text-align:justify;"><strong><strong>定义get_bath_info(n,num_com)方法，有2个形参，将getMax_per_batch_info(n)方法的返回值n作为实参传入。该方法有2个while循环，判断n是否小于200，若小于，则将最大相同件数订单的货品种类不存在于batch_s列表中货品种类依次存入batch_s列表中，判断batch_s列表长度是否大于200，若大于，跳出循环；若小于，则继续调用getMax_per_batch_info(n)方法和get_num_com(i_l_m)方法；直至列表batch_s中货品种类数等于200，循环结束。输出批次信息并保存至batch_list列表中，并将已经处理的订单从列表orderno_list列表中移除。</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>        4、主程序为利用for循环调用以上三个方法，每循环1次应得到1个批次结果，将每次循环得到的结果存入sun_bacth_list列表中，最后将最终结果转换为DataFrame结构数据，输入到result1.csv文件中。应有判断语句，判断orderno_list列表是否为空，若为空，则结束程序；否则，继续执行。、</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>python代码如下：</strong></strong></p> 
<pre><code class="language-python">'''
设计分批算法：将当日订单分为多个批次。要求每个批次的订单所含货品种类数均不
超过 ，且批次越少越好（相应转运次数也越少，效率越高）。针对附件 1 中的订单
信息，应用你们的算法，计算当货架数量 时最少的批次数，给出每批订单数
量、货品种类数、分批方案等结果，并将完整原始分批方案按指定格式输出到文件
result1.csv 中
'''

import pandas as pd

#将数据读取进来
df = pd.read_csv(r'D:\Pycharm\pythonProject\data.csv')
#将原始数据csv文件处理一下，生存OrderNoSum.csv(已放入了附件中)，用来获取每个订单编号
df1 = pd.read_csv(r'D:\Pycharm\pythonProject\OrderNoSum.csv')
orderno_list = []
for i in df1['OrderNo'].values:
    orderno_list.append(i)
#统计每个订单的货品种类数量
df_pv = df.groupby('OrderNo')['ItemNo'].count()
#将每个订单的货品种类数量存入列表中
df_pv_list=[]  #923个值
for i in df_pv.values:
    df_pv_list.append(i)
#获取每个订单货品的编号与其种类数量相对
itemno_list = df['ItemNo'].values
#将每个订单的货品种类改成键值对的形式
dic = {}
sum_x = 0
dic.setdefault('{}'.format(orderno_list[0]),'{}'.format(list(itemno_list[0:df_pv_list[0]])))
for i in range(1,923):
    sum_x = sum_x + df_pv_list[i-1]
    dic.setdefault('{}'.format(orderno_list[i]),'{}'.format(list(itemno_list[sum_x:(sum_x+df_pv_list[i])])))
#每批次订单所含货品种类数列表
def getMax_per_batch_info(n):
    if df_pv_list == []:
        print('df_pv_list为空，数据已全部处理。')
        if orderno_list == []:
            print('orderno_list为空，订单已全部处理。')
            return

    #获取货品种类数最大的值
    if batch_s == []:
        max_values = max(df_pv_list)
        #df_pv_list.remove(max_values)
        # #获取货品种类数最大的值的索引
        index_values = df_pv_list.index(max_values)
        # #获取订单编号
        orderno_max = orderno_list[index_values]
        #将订单编号放入批次列表中
        batch_list.append(orderno_max)
        # #从dic中获取订单对应的货品
        item_list_max = eval(dic[orderno_max])
        #将货品加入每批次订单所含货品种类数列表
        for i in item_list_max:
            if i in batch_s:
                n=n
            else:
                batch_s.append(i)
                n=n+1
        df_pv_list.pop(index_values)
        orderno_list.remove(orderno_max)

    else:
        n = n
    return [batch_s,n]
def get_num_com(i_l_m):
    for x in orderno_list:
        count = 0
        for j in eval(dic[x]):
            for i in i_l_m:
                if j == i:
                    count = count + 1
                    break
        num_com.append(count)
    return num_com

def get_batch_info(n,num_com):
    while n &lt; N:
        max_num_com = max(num_com)
        #获取最大重叠率的索引
        max_num_com_index = num_com.index(max_num_com)
        #获取最大相同种类数的的订单编号
        orderno_m = orderno_list[max_num_com_index]
        num = len(eval(dic[orderno_m]))
        #非重叠货品种类数量
        num_com_num = num_com[max_num_com_index]
        num_none = num - num_com[max_num_com_index]
        #批次总的货品种类数(不能大于200)
        n = n + num_none
        #print(n)
        while n &gt; N:
            #print('n&gt;N')
            orderno_list_copy = orderno_list[:]
            while True:
                n = n - num_none
                orderno_list_copy.remove(orderno_m)
                num_com.pop(max_num_com_index)
                if num_com == []:
                    break
                max_num_com = max(num_com)
                max_num_com_index = num_com.index(max_num_com)
                orderno_m = orderno_list_copy[max_num_com_index]
                num = len(eval(dic[orderno_m]))
                num_com_num = num_com[max_num_com_index]
                num_none = num - num_com[max_num_com_index]
                n = n + num_none
                if n&gt;N:
                    orderno_list_copy = orderno_list_copy[:]
                    continue
                else:
                    break
            break
        if num_com == []:
            break
        else:
            # 将货品加入列表中
            for i in eval(dic[orderno_m]):
                if i in batch_s:
                    continue
                else:
                    batch_s.append(i)
            # 将订单编号放入批次列表中
            batch_list.append(orderno_m)

            df_pv_list.pop(max_num_com_index)
            orderno_list.remove(orderno_m)
            break
    return n




#主程序
sum_batch_s =[]
# 相同货品种类数列表
num_com  = []
#批次列表
batch_list = []
#总的批次列表
sum_batch_list = []
N = 200

for i in range(1,80):
    if df_pv_list == []:
        if orderno_list == []:
            break
    # 每批次订单所含货品种类数列表
    batch_list = []
    num_com = []
    batch_s = []
    n=0
    arg_list = getMax_per_batch_info(n)
    if arg_list == None:
        print('数据已全部处理。')
        break
    else:
        b=get_num_com(arg_list[0])
        n = get_batch_info(arg_list[1],b)



    while True:
        num_com = []
        arg_list = getMax_per_batch_info(n)
        if arg_list == None:
            sum_batch_list.append(batch_list)
            sum_batch_s.append(batch_s)
            print('数据已全部处理。')
            break
        else:
            b = get_num_com(arg_list[0])
            n = get_batch_info(arg_list[1], b)
            if n &lt; N:
                continue
            else:
                sum_batch_list.append(batch_list)
                sum_batch_s.append(batch_s)
                break
print('正在统计最终结果，请稍等片刻。。。。。。。。。。')

OrderNo_list = []
GroupNo_list = []
for i in range(0,51):
    for j in sum_batch_list[i]:
        OrderNo_list.append(j)
        GroupNo_list.append(i+1)


#保存数据
result1_dic = {'OrderNo':OrderNo_list,
               'GroupNo':GroupNo_list}
result1_df = pd.DataFrame(result1_dic,index=None)
result1_df.reset_index(drop=True)
result1_df.to_csv(r'D:\Pycharm\pythonProject\result1.csv')

print('第一问给出结果如下：')

for i in range(51):
    print('第{}批订单数为:'.format(i+1),len(sum_batch_list[i]),'货品种类数为:',len(sum_batch_s[i]))
    print('分批方案为:',sum_batch_list[i])
    print('----------------------------------------------------------------')
    print()

print('总批数：',len(sum_batch_s))
print()
print('result1.csv文件已生成')
print('程序到此结束')</code></pre> 
<p>部分运行结果：</p> 
<p>第1批订单数为: 22 货品种类数为: 200<br> 分批方案为: ['D0148', 'D0613', 'D0674', 'D0246', 'D0726', 'D0337', 'D0497', 'D0581', 'D0601', 'D0391', 'D0352', 'D0630', 'D0747', 'D0912', 'D0294', 'D0496', 'D0423', 'D0539', 'D0776', 'D0384', 'D0903', 'D0210']<br> ----------------------------------------------------------------</p> 
<p>第2批订单数为: 8 货品种类数为: 200<br> 分批方案为: ['D0189', 'D0233', 'D0149', 'D0164', 'D0211', 'D0270', 'D0036', 'D0106']<br> ----------------------------------------------------------------</p> 
<p>第3批订单数为: 20 货品种类数为: 200<br> 分批方案为: ['D0174', 'D0089', 'D0218', 'D0580', 'D0466', 'D0426', 'D0281', 'D0443', 'D0403', 'D0513', 'D0375', 'D0784', 'D0868', 'D0906', 'D0488', 'D0764', 'D0861', 'D0490', 'D0234', 'D0646']<br> ----------------------------------------------------------------</p> 
<p>第4批订单数为: 20 货品种类数为: 200<br> 分批方案为: ['D0145', 'D0409', 'D0468', 'D0190', 'D0320', 'D0670', 'D0505', 'D0882', 'D0474', 'D0413', 'D0591', 'D0540', 'D0498', 'D0572', 'D0825', 'D0486', 'D0612', 'D0433', 'D0401', 'D0116']<br> ----------------------------------------------------------------</p> 
<p>第5批订单数为: 10 货品种类数为: 200<br> 分批方案为: ['D0203', 'D0708', 'D0412', 'D0187', 'D0769', 'D0117', 'D0717', 'D0232', 'D0766', 'D0102']<br> ----------------------------------------------------------------</p> 
<p>第6批订单数为: 13 货品种类数为: 200<br> 分批方案为: ['D0028', 'D0046', 'D0707', 'D0815', 'D0259', 'D0898', 'D0870', 'D0173', 'D0705', 'D0219', 'D0178', 'D0381', 'D0354']<br> ----------------------------------------------------------------</p> 
<p>第7批订单数为: 6 货品种类数为: 200<br> 分批方案为: ['D0283', 'D0458', 'D0006', 'D0744', 'D0553', 'D0063']<br> ----------------------------------------------------------------</p> 
<p>第8批订单数为: 30 货品种类数为: 200<br> 分批方案为: ['D0133', 'D0767', 'D0481', 'D0741', 'D0060', 'D0194', 'D0678', 'D0340', 'D0142', 'D0147', 'D0397', 'D0792', 'D0891', 'D0894', 'D0475', 'D0899', 'D0386', 'D0851', 'D0830', 'D0399', 'D0878', 'D0166', 'D0460', 'D0544', 'D0042', 'D0019', 'D0043', 'D0550', 'D0800', 'D0078']<br> ----------------------------------------------------------------<br>  </p> 
<p>注意：代码里面的data.csv文件为官网上题目里的附带文件，我改成了data,csv名字；OrderNoSum.csv文件是经过data.csv文件处理的文件，将它与data.csv放在同一目录下。</p> 
<p>第1问至第3问相关文件和源码放这了：<br> 链接:https://pan.baidu.com/s/1NZcem6rJjoU-lPMU_QSfqw <br> 提取码:8833</p> 
<p></p> 
<p>答案不一定准确，有错误或者不恰当的地方请指出！一起学习进步！！</p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e9b39a0e7342a93437c441459817e03/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Zookeeper leader选举源码分析(超详细)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/422e61325ee3c6e7a576de7e7debd378/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【SkyWalking问题】skywalking.StatusRuntimeException: UNAVAILABLE，拒绝连接: /x.xxx.xxx.xx:11800</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>