<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>内存取证-Volatility安装使用以及一些CTF比赛题目 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="内存取证-Volatility安装使用以及一些CTF比赛题目" />
<meta property="og:description" content="一 、简介 Volatility是一款开源内存取证框架，能够对导出的内存镜像进行分析，通过获取内核数据结构，使用插件获取内存的详细情况以及系统的运行状态。
本文涉及附件下载：
链接：https://pan.baidu.com/s/1r0t5k4gFmiu12KHbZolKnA?pwd=6666 提取码：6666 二 、安装Volatility Volatility2.6需要python2，pip安装模块也需要2版本，具体命令根据实际情况调整。
下载源码 https://github.com/volatilityfoundation/volatility 解压 unzip volatility-master.zip 安装依赖 crypto pip2 install pycryptodome #如果安装失败，可使用以下命令切换国内源 pip2 install pycryptodome -i https://pypi.tuna.tsinghua.edu.cn/simple distorm3 https://github.com/vext01/distorm3 #下载解压后使用python2 setup.py install进行编译 可选插件 Distorm3（反编译库）：pip install distorm3 Yara（恶意软件分类工具）：pip install yara PyCrypto（加密工具集）：pip install pycrypto PIL（图片处理库）：pip install pil OpenPyxl（读写excel文件）：pip install openpyxl ujson（JSON解析）：pip install ujson 安装Volatility 在解压后的Volatility目录下进行编译
python2 setup.py install 输入vol.py进行测试
三 、安装插件 安装mimikatz，将mimikatz.py复制到volatility-master/volatility/plugins/目录下，使用时需要添加参数--plugins=./volatility-master/volatility/plugins。 2.运行时可能会出现如下错误，这是因为没有安装construct 模块：
Volatility Foundation Volatility Framework 2.6 *** Failed to import volatility." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/b2de3fc3e7d46b115985c0ff6c11bf76/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-08T15:42:49+08:00" />
<meta property="article:modified_time" content="2022-04-08T15:42:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">内存取证-Volatility安装使用以及一些CTF比赛题目</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="__0"></a>一 、简介</h2> 
<p><a href="https://www.volatilityfoundation.org/" rel="nofollow">Volatility</a>是一款开源内存取证框架，能够对导出的内存镜像进行分析，通过获取内核数据结构，使用插件获取内存的详细情况以及系统的运行状态。</p> 
<p>本文涉及附件下载：</p> 
<pre><code class="prism language-txt">链接：https://pan.baidu.com/s/1r0t5k4gFmiu12KHbZolKnA?pwd=6666 
提取码：6666 
</code></pre> 
<h2><a id="_Volatility_10"></a>二 、安装Volatility</h2> 
<p><strong>Volatility2.6需要python2，pip安装模块也需要2版本，具体命令根据实际情况调整。</strong></p> 
<ol><li>下载源码</li></ol> 
<pre><code>https://github.com/volatilityfoundation/volatility
</code></pre> 
<ol start="2"><li>解压</li></ol> 
<pre><code class="prism language-sh">unzip volatility-master.zip
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/de/M6zfMju7_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>安装依赖</li></ol> 
<ul><li>crypto</li></ul> 
<pre><code class="prism language-sh">pip2 install pycryptodome
#如果安装失败，可使用以下命令切换国内源
pip2 install pycryptodome -i https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre> 
<p><img src="https://images2.imgbox.com/b2/42/nOpY74mK_o.png" alt="在这里插入图片描述"></p> 
<ul><li>distorm3</li></ul> 
<pre><code>https://github.com/vext01/distorm3
#下载解压后使用python2 setup.py install进行编译
</code></pre> 
<p><img src="https://images2.imgbox.com/10/c2/UMGtQuxa_o.png" alt="在这里插入图片描述"></p> 
<ul><li>可选插件</li></ul> 
<pre><code>Distorm3（反编译库）：pip install distorm3
Yara（恶意软件分类工具）：pip install yara
PyCrypto（加密工具集）：pip install pycrypto
PIL（图片处理库）：pip install pil
OpenPyxl（读写excel文件）：pip install openpyxl
ujson（JSON解析）：pip install ujson
</code></pre> 
<ol start="4"><li>安装Volatility</li></ol> 
<p>在解压后的Volatility目录下进行编译</p> 
<pre><code class="prism language-sh">python2 setup.py install
</code></pre> 
<p><img src="https://images2.imgbox.com/c1/6f/dZC6xjO7_o.png" alt="在这里插入图片描述"></p> 
<p>输入<code>vol.py</code>进行测试<br> <img src="https://images2.imgbox.com/5b/67/zHlIVG7Z_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="__63"></a>三 、安装插件</h2> 
<ol><li>安装mimikatz，将<code>mimikatz.py</code>复制到volatility-master/volatility/plugins/目录下，使用时需要添加参数<code>--plugins=./volatility-master/volatility/plugins</code>。</li></ol> 
<p>2.运行时可能会出现如下错误，这是因为没有安装construct 模块：</p> 
<pre><code class="prism language-sh">Volatility Foundation Volatility Framework 2.6
*** Failed to import volatility.plugins.mimikatz (ImportError: No module named construct)
ERROR   : volatility.debug    : You must specify something to do (try -h)
</code></pre> 
<ol start="3"><li>安装construct模块。</li></ol> 
<pre><code class="prism language-sh">pip install construct 
</code></pre> 
<h2><a id="__79"></a>四 、工具介绍</h2> 
<p>输入<code>vol.py --help</code>可查看帮助。</p> 
<pre><code class="prism language-txt">Volatility Foundation Volatility Framework 2.6
用法： Volatility - 内存取证分析平台

Options:
  -h, --help            列出所有可用选项及其默认值
                        默认值可以在配置文件中设置
                        (/etc/volatilityrc)
  --conf-file=/home/kali/.volatilityrc
                        基于用户的配置文件
  -d, --debug           调试Volatility
  --plugins=PLUGINS     要使用的其他插件目录（冒号分隔）
  --info                打印所有注册对象的信息
  --cache-directory=/home/kali/.cache/volatility
                        存放缓存文件的目录
  --cache               使用缓存
  --tz=TZ               设置 (Olson) 时区以使用 pytz（如果已安装）或 tzset 显示时间戳
  -f FILENAME, --filename=FILENAME
                        打开图像时使用的文件名
  --profile=WinXPSP2x86
                        要加载的配置文件的名称（使用 --info 查看支持的配置文件列表）
  -l LOCATION, --location=LOCATION
                        从中加载地址空间的 URN 位置
  -w, --write           启用写支持
  --dtb=DTB             DTB 地址
  --shift=SHIFT         Mac KASLR 移位地址
  --output=text         以这种格式输出（支持特定于模块，请参阅下面的模块输出选项）
  --output-file=OUTPUT_FILE
                        在此文件中写入输出
  -v, --verbose         详细信息
  -g KDBG, --kdbg=KDBG  指定一个 KDBG 虚拟地址（注意：对于 64 位 Windows 8 及更高版本，这是 KdCopyDataBlock 的地址）
  --force               强制使用可疑配置文件
  -k KPCR, --kpcr=KPCR  指定特定的 KPCR 地址
  --cookie=COOKIE       指定 nt!ObHeaderCookie 的地址（仅适用于 Windows 10）

	支持的插件命令:

		amcache        	查看AmCache应用程序痕迹信息
		apihooks       	检测内核及进程的内存空间中的API hook
		atoms          	列出会话及窗口站atom表
		atomscan       	Atom表的池扫描(Pool scanner)
		auditpol       	列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息
		bigpools       	使用BigPagePoolScanner转储大分页池(big page pools)
		bioskbd        	从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)
		cachedump      	获取内存中缓存的域帐号的密码哈希
		callbacks      	打印全系统通知例程
		clipboard      	提取Windows剪贴板中的内容
		cmdline        	显示进程命令行参数
		cmdscan        	提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）
		connections    	打印系统打开的网络连接(仅支持Windows XP 和2003)
		connscan       	打印TCP连接信息
		consoles       	提取执行的命令行历史记录（扫描_CONSOLE_INFORMATION信息）
		crashinfo      	提取崩溃转储信息
		deskscan       	tagDESKTOP池扫描(Poolscaner)
		devicetree     	显示设备树信息
		dlldump        	从进程地址空间转储动态链接库
		dlllist        	打印每个进程加载的动态链接库列表
		driverirp      	IRP hook驱动检测
		drivermodule   	关联驱动对象至内核模块
		driverscan     	驱动对象池扫描
		dumpcerts      	提取RAS私钥及SSL公钥
		dumpfiles      	提取内存中映射或缓存的文件
		dumpregistry   	转储内存中注册表信息至磁盘
		editbox        	查看Edit编辑控件信息 (Listbox正在实验中)
		envars         	显示进程的环境变量
		eventhooks     	打印Windows事件hook详细信息
		evtlogs        	提取Windows事件日志（仅支持XP/2003)
		filescan       	提取文件对象（file objects）池信息
		gahti          	转储用户句柄（handle）类型信息
		gditimers      	打印已安装的GDI计时器(timers)及回调(callbacks)
		gdt            	显示全局描述符表(Global Deor Table)
		getservicesids 	获取注册表中的服务名称并返回SID信息
		getsids        	打印每个进程的SID信息
		handles        	打印每个进程打开的句柄的列表
		hashdump       	转储内存中的Windows帐户密码哈希(LM/NTLM)
		hibinfo        	转储休眠文件信息
		hivedump       	打印注册表配置单元信息
		hivelist       	打印注册表配置单元列表
		hivescan       	注册表配置单元池扫描
		hpakextract    	从HPAK文件（Fast Dump格式）提取物理内存数据
		hpakinfo       	查看HPAK文件属性及相关信息
		idt            	显示中断描述符表(Interrupt Deor Table)
		iehistory      	重建IE缓存及访问历史记录
		imagecopy      	将物理地址空间导出原生DD镜像文件
		imageinfo      	查看/识别镜像信息
		impscan        	扫描对导入函数的调用
		joblinks       	打印进程任务链接信息
		kdbgscan       	搜索和转储潜在KDBG值
		kpcrscan       	搜索和转储潜在KPCR值
		ldrmodules     	检测未链接的动态链接DLL
		lsadump        	从注册表中提取LSA密钥信息（已解密）
		machoinfo      	转储Mach-O 文件格式信息
		malfind        	查找隐藏的和插入的代码
		mbrparser      	扫描并解析潜在的主引导记录(MBR)
		memdump        	转储进程的可寻址内存
		memmap         	打印内存映射
		messagehooks   	桌面和窗口消息钩子的线程列表
		mftparser      	扫描并解析潜在的MFT条目
		moddump        	转储内核驱动程序到可执行文件的示例
		modscan        	内核模块池扫描
		modules        	打印加载模块的列表
		multiscan      	批量扫描各种对象
		mutantscan     	对互斥对象池扫描
		notepad        	查看记事本当前显示的文本
		objtypescan    	扫描窗口对象类型对象
		patcher        	基于页面扫描的补丁程序内存
		poolpeek       	可配置的池扫描器插件
		printkey       	打印注册表项及其子项和值
		privs          	显示进程权限
		procdump       	进程转储到一个可执行文件示例
		pslist         	按照EPROCESS列表打印所有正在运行的进程
		psscan         	进程对象池扫描
		pstree         	以树型方式打印进程列表
		psxview        	查找带有隐藏进程的所有进程列表
		qemuinfo       	转储 Qemu 信息
		raw2dmp        	将物理内存原生数据转换为windbg崩溃转储格式
		screenshot     	基于GDI Windows的虚拟屏幕截图保存
		servicediff    	Windows服务列表(ala Plugx)
		sessions       	_MM_SESSION_SPACE的详细信息列表(用户登录会话)
		shellbags      	打印Shellbags信息
		shimcache      	解析应用程序兼容性Shim缓存注册表项
		shutdowntime   	从内存中的注册表信息获取机器关机时间
		sockets        	打印已打开套接字列表
		sockscan       	TCP套接字对象池扫描
		ssdt           	显示SSDT条目
		strings        	物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)
		svcscan        	Windows服务列表扫描
		symlinkscan    	符号链接对象池扫描
		thrdscan       	线程对象池扫描
		threads        	调查_ETHREAD 和_KTHREADs
		timeliner      	创建内存中的各种痕迹信息的时间线
		timers         	打印内核计时器及关联模块的DPC
		truecryptmaster	Recover 	恢复TrueCrypt 7.1a主密钥
		truecryptpassphrase		查找并提取TrueCrypt密码
		truecryptsummary	TrueCrypt摘要信息
		unloadedmodules	打印卸载的模块信息列表
		userassist     	打印注册表中UserAssist相关信息
		userhandles    	转储用户句柄表
		vaddump        	转储VAD数据为文件
		vadinfo        	转储VAD信息
		vadtree        	以树形方式显示VAD树信息
		vadwalk        	显示遍历VAD树
		vboxinfo       	转储Virtualbox信息（虚拟机）
		verinfo        	打印PE镜像中的版本信息
		vmwareinfo     	转储VMware VMSS/VMSN 信息
		volshell       	内存镜像中的shell
		windows        	打印桌面窗口(详细信息)
		wintree        	Z顺序打印桌面窗口树
		wndscan        	池扫描窗口站
		yarascan       	以Yara签名扫描进程或内核内存
</code></pre> 
<p>输入<code>vol.py --info</code>可查看插件。</p> 
<pre><code class="prism language-txt">Volatility Foundation Volatility Framework 2.6

Profiles
--------
VistaSP0x64           - Windows Vista SP0 x64 的配置文件
VistaSP0x86           - Windows Vista SP0 x86 的配置文件
VistaSP1x64           - Windows Vista SP1 x64 的配置文件
VistaSP1x86           - Windows Vista SP1 x86 的配置文件
VistaSP2x64           - Windows Vista SP1 x86 的配置文件
VistaSP2x86           - Windows Vista SP2 x64 的配置文件 
Win10x64              - Windows 10 x64 的配置文件 
Win10x64_10586        - Windows 10 x64 的配置文件 (10.0.10586.306 / 2016-04-23)
Win10x64_14393        - Windows 10 x64 的配置文件 (10.0.14393.0 / 2016-07-16)
Win10x86              - Windows 10 x86 的配置文件
Win10x86_10586        - Windows 10 x86 的配置文件 (10.0.10586.420 / 2016-05-28)
Win10x86_14393        - Windows 10 x86 的配置文件 (10.0.14393.0 / 2016-07-16)
Win2003SP0x86         - Windows 2003 SP0 x86 的配置文件
Win2003SP1x64         - Windows 2003 SP0 x86 的配置文件
Win2003SP1x86         - Windows 2003 SP1 x86 的配置文件 
Win2003SP2x64         - Windows 2003 SP1 x86 的配置文件 
Win2003SP2x86         - Windows 2003 SP2 x86 的配置文件 
Win2008R2SP0x64       - Windows 2008 R2 SP0 x64 的配置文件
Win2008R2SP1x64       - Windows 2008 R2 SP1 x64 的配置文件
Win2008R2SP1x64_23418 - Windows 2008 R2 SP1 x64 的配置文件 (6.1.7601.23418 / 2016-04-09)
Win2008SP1x64         - Windows 2008 SP1 x64 的配置文件
Win2008SP1x86         - Windows 2008 SP1 x86 的配置文件
Win2008SP2x64         - Windows 2008 SP2 x64 的配置文件
Win2008SP2x86         - Windows 2008 SP2 x86 的配置文件
Win2012R2x64          - Windows Server 2012 R2 x64 的配置文件
Win2012R2x64_18340    - Windows Server 2012 R2 x64 的配置文件 (6.3.9600.18340 / 2016-05-13)
Win2012x64            - Windows Server 2012 x64 的配置文件
Win2016x64_14393      - Windows Server 2016 x64 的配置文件 (10.0.14393.0 / 2016-07-16)
Win7SP0x64            - Windows 7 SP0 x64 的配置文件
Win7SP0x86            - Windows 7 SP0 x86 的配置文件
Win7SP1x64            - Windows 7 SP1 x64 的配置文件
Win7SP1x64_23418      - Windows 7 SP1 x64 的配置文件 (6.1.7601.23418 / 2016-04-09)
Win7SP1x86            - Windows 7 SP1 x86 的配置文件
Win7SP1x86_23418      - Windows 7 SP1 x86 的配置文件 (6.1.7601.23418 / 2016-04-09)
Win81U1x64            - Windows 8.1 更新 1 x64 的配置文件
Win81U1x86            - Windows 8.1 更新 1 x86 的配置文件
Win8SP0x64            - Windows 8 x64 的配置文件
Win8SP0x86            - Windows 8 x86 的配置文件
Win8SP1x64            - Windows 8.1 x64 的配置文件
Win8SP1x64_18340      - Windows 8.1 x64 的配置文件 (6.3.9600.18340 / 2016-05-13)
Win8SP1x86            - Windows 8.1 x86 的配置文件
WinXPSP1x64           - Windows XP SP1 x64 的配置文件
WinXPSP2x64           - Windows XP SP2 x64 的配置文件
WinXPSP2x86           - Windows XP SP2 x86 的配置文件
WinXPSP3x86           - Windows XP SP3 x86 的配置文件


Address Spaces
--------------
AMD64PagedMemory              - 标准 AMD 64 位地址空间
ArmAddressSpace               - ARM 处理器的地址空间
FileAddressSpace              - 这是一个直接文件 AS.
HPAKAddressSpace              - 此 AS 支持 HPAK 格式
IA32PagedMemory               - 标准 IA-32 分页地址空间
IA32PagedMemoryPae            - 此类实现 IA-32 PAE 分页地址空间
LimeAddressSpace              - Lime 的地址空间
LinuxAMD64PagedMemory         - Linux 特定的 AMD 64 位地址空间
MachOAddressSpace             - mach-o 文件的地址空间以支持 atc-ny 内存读取器
OSXPmemELF                    - 这个 AS 支持 VirtualBox ELF64 coredump 格式
QemuCoreDumpElf               - 这个 AS 支持 Qemu ELF32 和 ELF64 核心转储格式
VMWareAddressSpace            - 此 AS 支持 VMware 快照 (VMSS) 和保存状态 (VMSS) 文件 
VMWareMetaAddressSpace        - 此 AS 支持带有 VMSN/VMSS 元数据的 VMEM 格式 
VirtualBoxCoreDumpElf64       - 这个 AS 支持 VirtualBox ELF64 coredump 格式
Win10AMD64PagedMemory         - Windows 10 特定的 AMD 64 位地址空间
WindowsAMD64PagedMemory       - Windows 特定的 AMD 64 位地址空间
WindowsCrashDumpSpace32       - 这个 AS 支持 windows 崩溃转储格式
WindowsCrashDumpSpace64       - 此 AS 支持 windows Crash Dump 格式
WindowsCrashDumpSpace64BitMap - 此 AS 支持 Windows BitMap Crash Dump 格式
WindowsHiberFileSpace32       - 这是 Windows 休眠文件的休眠地址空间


Plugins
-------
amcache                    - 打印 AmCache 信息 
apihooks                   - 检测进程和内核内存中的 API 挂钩 
atoms                      - 打印会话和窗口站原子表
atomscan                   - 原子表的池扫描器
auditpol                   - 从 HKLM\SECURITY\Policy\PolAdtEv 打印出审计策略 
bigpools                   - 使用 BigPagePoolScanner 转储大页面池 
bioskbd                    - 从实模式内存中读取键盘缓冲区
cachedump                  - 从内存中转储缓存的域哈希
callbacks                  - 打印系统范围的通知例程
clipboard                  - 提取 Windows 剪贴板的内容
cmdline                    - 显示进程命令行参数
cmdscan                    - 通过扫描 _COMMAND_HISTORY 来提取命令历史记录
connections                - 打印打开的连接列表 [仅限 Windows XP 和 2003]
connscan                   - 用于 tcp 连接的池扫描器
consoles                   - 通过扫描 _CONSOLE_INFORMATION 提取命令历史记录
crashinfo                  - 转储崩溃转储信息
deskscan                   - tagDESKTOP（台式机）的 Poolscaner
devicetree                 - 显示设备树
dlldump                    - 从进程地址空间转储 DLL
dlllist                    - 打印每个进程加载的 dll 列表
driverirp                  - 驱动程序 IRP 挂钩检测
drivermodule               - 将驱动程序对象关联到内核模块
driverscan                 - 驱动程序对象的池扫描器
dumpcerts                  - 转储 RSA 私有和公共 SSL 密钥
dumpfiles                  - 提取内存映射和缓存文件
dumpregistry               - 将注册表文件转储到磁盘
editbox                    - 显示有关编辑控件的信息（列表框实验）
envars                     - 显示进程环境变量
eventhooks                 - 在 Windows 事件挂钩上打印详细信息
evtlogs                    - 提取 Windows 事件日志（仅限 XP/2003）
filescan                   - 文件对象的池扫描器
gahti                      - 转储 USER 句柄类型信息
gditimers                  - 打印已安装的 GDI 计时器和回调
gdt                        - 显示全局描述符表
getservicesids             - 获取 Registry 中的服务名称并返回计算的 SID
getsids                    - 打印拥有每个进程的 SID
handles                    - 打印每个进程的打开句柄列表
hashdump                   - 从内存中转储密码哈希 (LM/NTLM)
hibinfo                    - 转储休眠文件信息
hivedump                   - 打印注册表
hivelist                   - 打印注册表配置单元列表
hivescan                   - 注册表配置单元的池扫描程序
hpakextract                - 从 HPAK 文件中提取物理内存 
hpakinfo                   - 有关 HPAK 文件的信息 
idt                        - 显示中断描述符表 
iehistory                  - 重建 Internet Explorer 缓存/历史 
imagecopy                  - 将物理地址空间复制为原始 DD 映像
imageinfo                  - 识别图像的信息 
impscan                    - 扫描对导入函数的调用
joblinks                   - 打印进程作业链接信息 
kdbgscan                   - 搜索和转储潜在的 KDBG 值 
kpcrscan                   - 搜索和转储潜在的 KPCR 值
ldrmodules                 - 检测未链接的 DLL 
limeinfo                   - 转储 Lime 文件格式信息
linux_apihooks             - 检查用户态 apihooks 
linux_arp                  - 打印 ARP 表 
linux_aslr_shift           - 自动检测 Linux ASLR shift 
linux_banner               - 打印 Linux 横幅信息
linux_bash                 - 从 bash 进程内存中恢复 bash 历史记录
linux_bash_env             - 恢复进程的动态环境变量
linux_bash_hash            - 从 bash 进程内存中恢复 bash 哈希表 
linux_check_afinfo         - 验证网络协议的操作函数指针
linux_check_creds          - 检查是否有进程共享凭证结构
linux_check_evt_arm        - 检查异常向量表以查找系统调用表挂钩 
linux_check_fop            - 检查 rootkit 修改的文件操作结构
linux_check_idt            - 检查 IDT 是否已被更改
linux_check_inline_kernel  - 检查内联内核挂钩
linux_check_modules        - 将模块列表与 sysfs 信息进行比较（如果可用）
linux_check_syscall        - 检查系统调用表是否已更改
linux_check_syscall_arm    - 检查系统调用表是否已更改
linux_check_tty            - 检查 tty 设备的钩子
linux_cpuinfo              - 打印每个活动处理器的信息 
linux_dentry_cache         - 从 dentry 缓存中收集文件 
linux_dmesg                - 收集 dmesg 缓冲区
linux_dump_map             - 将选定的内存映射写入磁盘
linux_dynamic_env          - 恢复进程的动态环境变量
linux_elfs                 - 在进程映射中查找 ELF 二进制文件 
linux_enumerate_files      - 列出文件系统缓存引用的文件 
linux_find_file            - 列出并从内存中恢复文件 
linux_getcwd               - 列出每个进程的当前工作目录 
linux_hidden_modules       - 雕刻内存以查找隐藏的内核模块 
linux_ifconfig             - 收集活动接口 
linux_info_regs            - 就像 GDB 中的“信息寄存器”。 它打印出所有
linux_iomem                - 提供类似于 /proc/iomem 的输出
linux_kernel_opened_files  - 列出从内核中打开的文件 
linux_keyboard_notifiers   - 解析键盘通知器调用链 
linux_ldrmodules           - 将 proc 映射的输出与 libdl 中的库列表进行比较
linux_library_list         - 列出加载到进程中的库 
linux_librarydump          - 将进程内存中的共享库转储到磁盘 
linux_list_raw             - 列出具有混杂套接字的应用程序 
linux_lsmod                - 收集加载的内核模块 
linux_lsof                 - 列出文件描述符及其路径 
linux_malfind              - 寻找可疑的进程映射 
linux_memmap               - 转储 linux 任务的内存映射 
linux_moddump              - 提取加载的内核模块 
linux_mount                - 收集挂载的 fs/devices
linux_mount_cache          - 从 kmem_cache收集挂载的 fs/devices
linux_netfilter            - 列出 Netfilter 钩子
linux_netscan              - 雕刻网络连接结构 
linux_netstat              - 列出打开的套接字 
linux_pidhashtable         - 通过 PID 哈希表枚举进程 
linux_pkt_queues           - 将每个进程的数据包队列写入磁盘
linux_plthook              - 扫描 ELF 二进制文件的 PLT 以获取非需要图像的挂钩
linux_proc_maps            - 收集进程内存映射 
linux_proc_maps_rb         - 通过映射红黑树为 linux 收集进程映射
linux_procdump             - 将进程的可执行映像转储到磁盘 
linux_process_hollow       - 检查进程空心的迹象 
linux_psaux                - 收集进程以及完整的命令行和开始时间 
linux_psenv                - 收集进程及其静态环境变量 
linux_pslist               - 通过遍历 task_struct-&gt;task 列表来收集活动任务
linux_pslist_cache         - 从 kmem_cache 收集任务
linux_psscan               - 扫描进程的物理内存
linux_pstree               - 显示进程之间的父/子关系
linux_psxview              - 使用各种进程列表查找隐藏进程
linux_recover_filesystem   - 从内存中恢复整个缓存文件系统
linux_route_cache          - 从内存中恢复路由缓存 
linux_sk_buff_cache        - 从 sk_buff kmem_cache 中恢复数据包
linux_slabinfo             - 在运行的机器上模拟 /proc/slabinfo
linux_strings              - 将物理偏移量与虚拟地址匹配（可能需要一段时间，非常冗长）
linux_threads              - 打印进程的线程 
linux_tmpfs                - 从内存中恢复 tmpfs 文件系统
linux_truecrypt_passphrase - 恢复缓存的 Truecrypt 密码
linux_vma_cache            - 从 vm_area_struct 缓存中收集 VMA 
linux_volshell             - 内存映像中的 Shell 
linux_yarascan             - Linux 内存映像中的 shell
lsadump                    - 从注册表中转储（解密的）LSA 机密
mac_adium                  - 列出 Adium 消息
mac_apihooks               - 检查进程中的 API 挂钩
mac_apihooks_kernel        - 检查系统调用和内核函数是否被挂钩 
mac_arp                    - 打印 arp 表
mac_bash                   - 从 bash 进程内存中恢复 bash 历史记录
mac_bash_env               - 恢复 bash 的环境变量
mac_bash_hash              - 从 bash 进程内存中恢复 bash 哈希表
mac_calendar               - 从 Calendar.app 获取日历事件
mac_check_fop              - 验证文件操作指针 
mac_check_mig_table        - 列出内核 MIG 表中的整体
mac_check_syscall_shadow   - 查找影子系统调用表 
mac_check_syscalls         - 检查系统调用表条目是否被挂钩 
mac_check_sysctl           - 检查未知的 sysctl 处理程序
mac_check_trap_table       - 检查 mach 陷阱表条目是否被钩住
mac_compressed_swap        - 打印 Mac OS X VM 压缩器统计数据并转储所有压缩页面
mac_contacts               - 从 Contacts.app 获取联系人姓名 
mac_dead_procs             - 打印终止/取消分配的进程
mac_dead_sockets           - 打印终止/取消分配的网络套接字
mac_dead_vnodes            - 列出释放的 vnode 结构
mac_devfs                  - 列出文件缓存中的文件 
mac_dmesg                  - 打印内核调试缓冲区 
mac_dump_file              - 转储指定文件 
mac_dump_maps              - 转储进程的内存范围，可选地包括压缩交换中的页面 
mac_dyld_maps              - 从 dyld 数据结构中获取进程的内存映射
mac_find_aslr_shift        - 查找 10.8+ 图像的 ASLR 移位值
mac_get_profile            - 自动检测 Mac 配置文件
mac_ifconfig               - 列出所有设备的网络接口信息 
mac_interest_handlers      - 列出 IOKit 兴趣处理程序 
mac_ip_filters             - 报告任何挂钩的 IP 过滤器
mac_kernel_classes         - 列出内核中加载的 c++ 类
mac_kevents                - 显示进程的父/子关系
mac_keychaindump           - 恢复可能的钥匙串密钥。 使用chainbreaker打开相关的keychain文件
mac_ldrmodules             - 将 proc 映射的输出与 libdl 中的库列表进行比较
mac_librarydump            - 转储进程的可执行文件 
mac_list_files             - 列出文件缓存中的文件 
mac_list_kauth_listeners   - 列出 Kauth Scope 监听器 
mac_list_kauth_scopes      - 列出 Kauth 范围及其状态
mac_list_raw               - 列出具有混杂套接字的应用程序 
mac_list_sessions          - 枚举会话 
mac_list_zones             - 打印活动区域 
mac_lsmod                  - 列出加载的内核模块 
mac_lsmod_iokit            - 列出通过 IOkit 加载的内核模块
mac_lsmod_kext_map         - 列出加载的内核模块 
mac_lsof                   - 列出每个进程打开的文件 
mac_machine_info           - 打印有关样本的机器信息 
mac_malfind                - 寻找可疑的进程映射 
mac_memdump                - 将可寻址内存页转储到文件中 
mac_moddump                - 将指定的内核扩展写入磁盘 
mac_mount                  - 打印挂载的设备信息 
mac_netstat                - 列出每个进程的活动网络连接 
mac_network_conns          - 列出来自内核网络结构的网络连接 
mac_notesapp               - 查找 Notes 消息的内容
mac_notifiers              - 检测将钩子添加到 I/O 工具包中的 rootkit（例如 LogKext）
mac_orphan_threads         - 列出不映射回已知模块/进程的线程
mac_pgrp_hash_table        - 遍历进程组哈希表 
mac_pid_hash_table         - 遍历 pid 哈希表
mac_print_boot_cmdline     - 打印内核启动参数 
mac_proc_maps              - 获取进程的内存映射 
mac_procdump               - 转储进程的可执行文件 
mac_psaux                  - 在用户区打印带有参数的进程 (**argv)
mac_psenv                  - 在用户空间打印带有环境的进程 (**envp)
mac_pslist                 - 列出正在运行的进程 
mac_pstree                 - 显示进程的父/子关系
mac_psxview                - 使用各种进程列表查找隐藏进程 
mac_recover_filesystem     - 恢复缓存的文件系统 
mac_route                  - 打印路由表 
mac_socket_filters         - 报告套接字过滤器 
mac_strings                - 将物理偏移量与虚拟地址匹配（可能需要一段时间，非常冗长）
mac_tasks                  - 列出活动任务 
mac_threads                - 列出进程线程 
mac_threads_simple         - 列出线程及其开始时间和优先级 
mac_timers                 - 报告内核驱动程序设置的定时器 
mac_trustedbsd             - 列出恶意的trustedbsd 策略
mac_version                - 打印 Mac 版本
mac_vfsevents              - 列出过滤文件系统事件的进程 
mac_volshell               - 内存映像中的外壳 
mac_yarascan               - 扫描内存中的 yara 签名 
machoinfo                  - 转储 Mach-O 文件格式信息
malfind                    - 查找隐藏和注入的代码 
mbrparser                  - 扫描并解析潜在的主引导记录 (MBR)
memdump                    - 转储进程的可寻址内存 
memmap                     - 打印内存映射 
messagehooks               - 列出桌面和线程窗口消息挂钩 
mftparser                  - 扫描并解析潜在的 MFT 条目
moddump                    - 将内核驱动程序转储到可执行文件示例 
modscan                    - 内核模块的池扫描器 
modules                    - 打印加载模块的列表 
multiscan                  - 一次扫描各种对象 
mutantscan                 - 互斥对象的池扫描器 
netscan                    - 扫描 Vista（或更高版本）图像的连接和套接字 
notepad                    - 列出当前显示的记事本文本 
objtypescan                - 扫描 Windows 对象类型对象
patcher                    - 基于页面扫描修补内存 
poolpeek                   - 可配置的池扫描器插件 
pooltracker                - 显示池标签使用的摘要 
printkey                   - 打印注册表项及其子项和值 
privs                      - 显示进程权限 
procdump                   - 将进程转储到可执行文件示例 
pslist                     - 按照 EPROCESS 列表打印所有正在运行的进程
psscan                     - 进程对象的池扫描器 
pstree                     - 将进程列表打印为树 
psxview                    - 使用各种进程列表查找隐藏进程 
qemuinfo                   - 转储 Qemu 信息
raw2dmp                    - 将物理内存样本转换为 windbg 故障转储
screenshot                 - 保存基于 GDI 窗口的伪截图
servicediff                - 列出 Windows 服务（ala Plugx）
sessions                   - 列出 _MM_SESSION_SPACE 的详细信息（用户登录会话）
shellbags                  - 打印 ShellBags 信息
shimcache                  - 解析应用程序兼容性 Shim Cache 注册表项
shutdowntime               - 从注册表打印机器的 ShutdownTime
sockets                    - 打印打开的套接字列表 
sockscan                   - tcp 套接字对象的池扫描器
ssdt                       - 显示 SSDT 条目
strings                    - 将物理偏移量与虚拟地址匹配（可能需要一段时间，非常冗长）
svcscan                    - 扫描 Windows 服务
symlinkscan                - 符号链接对象的池扫描器 
thrdscan                   - 线程对象的池扫描器 
threads                    - 调查 _ETHREAD 和 _KTHREADs
timeliner                  - 从内存中的各种工件创建时间线 
timers                     - 打印内核定时器和相关的模块 DPC
truecryptmaster            - 恢复 TrueCrypt 7.1a 主密钥
truecryptpassphrase        - TrueCrypt 缓存密码短语查找器
truecryptsummary           - TrueCrypt 总结
unloadedmodules            - 打印已卸载模块的列表 
userassist                 - 打印 userassist 注册表项和信息
userhandles                - 转储 USER 句柄表
vaddump                    - 将 vad 部分转储到文件中
vadinfo                    - 转储 VAD 信息
vadtree                    - 遍历 VAD 树并以树格式显示
vadwalk                    - 走 VAD 树
vboxinfo                   - 转储 virtualbox 信息 
verinfo                    - 从 PE 图像中打印出版本信息
vmwareinfo                 - 转储 VMware VMSS/VMSN 信息
volshell                   - 内存映像中的 Shell
win10cookie                - 查找 Windows 10 的 ObHeaderCookie 值 
windows                    - 打印桌面窗口（详细信息）
wintree                    - 打印Z顺序桌面Windows树
wndscan                    - 用于窗口站的池扫描仪
yarascan                   - 使用 Yara 签名扫描进程或内核内存


Scanner Checks
--------------
CheckPoolSize          - 检查池块大小
CheckPoolType          - 检查池类型
KPCRScannerCheck       - 检查自引用指针以查找KPCR
MultiPrefixFinderCheck - 每页检查多个字符串，在偏移处完成
MultiStringFinderCheck - 每页检查多个字符串
PoolTagCheck           - 此扫描程序检查池标记的出现
</code></pre> 
<h2><a id="__594"></a>五 、使用方法</h2> 
<ol><li>系统基本信息</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw imageinfo
</code></pre> 
<p><img src="https://images2.imgbox.com/7c/d3/Gs3IP9qa_o.png" alt="在这里插入图片描述"><br> 一般 <strong>profile</strong> 使用 <strong>Suggested Profile(s)</strong> 第一个结果作为值，但是也不一定，视具体情况修改。</p> 
<ol start="2"><li>进程命令行参数</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 cmdscan
vol.py -f memory.raw --profile=Win7SP1x64 cmdline
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/5a/O0hACS8o_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/84/8a/DEY4B22b_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>进程信息</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 pslist
vol.py -f memory.raw --profile=Win7SP1x64 pstree
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/48/ihLmWbAT_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5a/d9/PaNPeGm3_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-zNhyu3v2-1648872939995)(/upload/2022/04/image-d216d84885d643278ced1aee3b1a4497.png)]"></p> 
<ol start="4"><li>动态库列表</li></ol> 
<pre><code class="prism language-sh">#可使用-p参数指定PID号
vol.py -f memory.img --profile=Win2003SP1x86 dlllist
vol.py -f memory.img --profile=Win2003SP1x86 ldrmodules
vol.py -f memory.img --profile=Win2003SP1x86 malfind
</code></pre> 
<p><img src="https://images2.imgbox.com/33/22/NwBjCOPe_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dd/95/1MMFTJVr_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c5/ac/wxhUP68D_o.png" alt="在这里插入图片描述"></p> 
<ol start="5"><li>用户名密码信息</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 hashdump
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/c1/EoNWI9G7_o.png" alt="在这里插入图片描述"></p> 
<ol start="6"><li>注册表项</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 printkey
</code></pre> 
<p><img src="https://images2.imgbox.com/c8/c4/aJuZL1zB_o.png" alt="在这里插入图片描述"></p> 
<ol start="7"><li>注册表数据</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 hivelist
vol.py -f memory.raw --profile=Win7SP1x64 hivedump -o 0xfffff8a001cce010(注册表Volatility地址)
</code></pre> 
<p><img src="https://images2.imgbox.com/0c/a5/KlwpvgXf_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ce/b2/h0AiYc8c_o.png" alt="在这里插入图片描述"></p> 
<ol start="8"><li>网络连接状态</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 netscan
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/de/7wsfuOvG_o.png" alt="在这里插入图片描述"></p> 
<ol start="9"><li>服务运行状态</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 svcscan
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/f8/NvQCw9LH_o.png" alt="在这里插入图片描述"></p> 
<ol start="10"><li>进程环境变量</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 envars
</code></pre> 
<p><img src="https://images2.imgbox.com/7d/fe/xOrx08bL_o.png" alt="在这里插入图片描述"></p> 
<ol start="11"><li>进程缓存的文件</li></ol> 
<pre><code class="prism language-sh">vol.py -f memory.raw --profile=Win7SP1x64 filescan
</code></pre> 
<p><img src="https://images2.imgbox.com/fb/33/0qCAZnyU_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="__684"></a>六 、取证赛题</h2> 
<h3><a id="1_Suspicion_686"></a>1. Suspicion</h3> 
<ol><li> <p>先通过<code>vol.py -f mem.vmem imageinfo</code>获取基本信息。<br> <img src="https://images2.imgbox.com/44/bc/jE4VZw57_o.png" alt="在这里插入图片描述"><br> 发现profile是WinXPSP2x86。</p> </li><li> <p>使用<code>vol.py -f mem.vmem --profile=WinXPSP2x86 pslist</code>查看进程。<br> <img src="https://images2.imgbox.com/ca/a5/Ywx7pXCO_o.png" alt="在这里插入图片描述"><br> 发现存在<strong>TrueCrypt.exe</strong>进程，<strong>TrueCrypt.exe</strong>是一款加密程序，所以猜测<strong>Suspicion</strong>是加密后的结果。</p> </li><li> <p>使用命令<code>vol.py -f mem.vmem --profile=WinXPSP2x86 memdump -p 2012 -D ./</code>（-p是PID -D是转储路径）将进程转储出来得到<strong>2012.dmp</strong>。<br> <img src="https://images2.imgbox.com/4e/c8/Z3hsMnHc_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用**Elcomsoft(Elcomsoft Forensic Disk Decryptor,EFDD)**进行破解。<br> <img src="https://images2.imgbox.com/95/6d/dd0SINLZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/32/37/Wd54lnI6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/03/CwTIx3eo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a8/43/h1rZwqyJ_o.png" alt="在这里插入图片描述"><br> 将解密后的内存文件进行挂载。<br> <img src="https://images2.imgbox.com/2e/34/hILU6NNM_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/40/b9/PvpKxXfz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4f/7d/GjymCQKJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/20/6d/uMaT8DOW_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h3><a id="2_2020_passwd_713"></a>2. [湖湘杯2020] passwd</h3> 
<ol><li> <p>使用<code>vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw imageinfo</code>获取基本信息，得到profile是Win7SP1x86_23418。<br> <img src="https://images2.imgbox.com/ff/eb/diXSb4gT_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</code>获取hash值。<br> <img src="https://images2.imgbox.com/a3/aa/0R2f2qU8_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将用户CTF的hash拿到网站<a href="https://crackstation.net/" rel="nofollow">https://crackstation.net/</a>在线破解。<br> <img src="https://images2.imgbox.com/aa/57/phD80rWf_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h3><a id="3_NEWSCTF2021_veryezdump_727"></a>3. [NEWSCTF2021] very-ez-dump</h3> 
<ol><li> <p>查看镜像信息，profile为Win7SP1x64<br> <img src="https://images2.imgbox.com/7b/7e/hpSXwidj_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查看cmd执行的命令，发现添加了一个用户<strong>mumuzi</strong>，密码**(ljmmz)ovo**。<br> <img src="https://images2.imgbox.com/71/5b/kOI6Tr0f_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查找一下flag关键词，发现<strong>flag.zip</strong>，转储下来。<br> <img src="https://images2.imgbox.com/63/16/en67sKK2_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将后缀改为zip并解压，密码**(ljmmz)ovo**。<br> <img src="https://images2.imgbox.com/ab/19/Ac4dyyJu_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h3><a id="4__745"></a>4. 福莱格殿下</h3> 
<ol><li> <p><code>vol.py -f zy.raw imageinfo</code>查看profile为WinXPSP2x86。<br> <img src="https://images2.imgbox.com/49/f1/QEiMYFi5_o.png" alt="在这里插入图片描述"></p> </li><li> <p><code>vol.py -f zy.raw --profile=WinXPSP2x86 pslist</code>查看进程信息，发现可疑进程<strong>smss.exe</strong>。<br> <img src="https://images2.imgbox.com/54/bc/remLs0F8_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将<strong>smss.exe</strong>转储出来<br> <img src="https://images2.imgbox.com/3f/0e/mX1SlrtY_o.png" alt="在这里插入图片描述"></p> </li><li> <p>搜索一下flag关键词，发现<strong>flag.jpg</strong>和<strong>flag.png</strong>。</p> </li></ol> 
<pre><code class="prism language-sh">┌──(kali㉿kali)-[~]
└─$ strings -e l 536.dmp|grep flag
flag.jpg
flag.png
flag.jpg
flag.jpg
flag.jpg
flag.jpg
flag.png
flag.png
flag.png
flag.jpg
flag.jpg
flag.png
flag.lnk
flag.jpg
\flag.jpg*C:\Documents and Settings\Administrator\
flag.png
flag.jpg
flag.lnk
notiflag.exe
\Documents and Settings\Administrator\Recent\flag.lnk
flag.png
flag.jpg
flag.png
flag.png
flag.jpg
flag.lnk
flag.jpg
flag.lnk
flag.jpg
flag.png
\flag.jpg
\flag.jpg
\flag.png
\flag.jpg
\flag.png
\flag.jpg
\flag.png
\flag.jpg
\flag.png
\flag.jpg
\flag.png
flag.png
 1\flag.jpg
\flag.jpg
flag.jpg
\flag.jpg
flag.png
flag.lnk
flag.png
\flag.jpg.jpg
\flag.png
 1\flag.jpg
\Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\flag.lnk
\flag.jpg
\flag.jpg
flag.jpg
\flag.jpg
\flag.jpg
\Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\flag.lnk
\flag.png
 1\flag.png
\flag.jpg
\flag.png
flag.png
flag.jpg
usbflags
usbflags
usbflags
usbflags\vvvvpppprrrr
usbflags
</code></pre> 
<ol start="5"><li> <p>使用<code>vol.py -f zy.raw --profile=WinXPSP2x86 iehistory</code>获取浏览器历史记录，看大佬博客这里是有<strong>hint.txt</strong>的，不知道什么我这里没显示。<br> <img src="https://images2.imgbox.com/73/15/gZzntTI0_o.png" alt="在这里插入图片描述"></p> </li><li> <p>搜索hint文件并转储出来，得到文件<strong>file.None.0x821231b8.dat</strong>。<br> <img src="https://images2.imgbox.com/2e/93/szKLN5QT_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/09/f7/OEImisT3_o.png" alt="在这里插入图片描述"></p> </li><li> <p>搜索<strong>fl4g</strong>文件并转储出来，修改后缀为zip并解压得到<strong>flag.jpg</strong>和<strong>flag.png</strong>。<br> <img src="https://images2.imgbox.com/15/be/F43fKJci_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/76/f2/mcW34KCo_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用StegSlove将两张图片进行异或，得到二维码，需要先打开<strong>flag.png</strong>。<br> <img src="https://images2.imgbox.com/99/c3/lcq6ncuI_o.png" alt="在这里插入图片描述"></p> </li><li> <p>扫码得到一个链接，访问得到flag。<br> <img src="https://images2.imgbox.com/f7/53/cmNhsyp3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/60/62/HwAVwos7_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h3><a id="5_HDCTF__858"></a>5. [HDCTF] 你能发现什么蛛丝马迹吗？</h3> 
<ol><li> <p>查看镜像基本信息，这里需要指定profile为Win2003SP2x86。<br> <img src="https://images2.imgbox.com/31/89/mdfEwMEb_o.png" alt="在这里插入图片描述"></p> </li><li> <p>搜索flag关键词，发现存在<strong>flag.png</strong>，将其转储出来。<br> <img src="https://images2.imgbox.com/fa/ed/e4TJrUJS_o.png" alt="在这里插入图片描述"></p> </li><li> <p>发现图片是个二维码，扫描得到<code>jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4=</code>。<br> <img src="https://images2.imgbox.com/86/f4/l1c17kwt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查看一下Windows窗口程序，flag.png是由explorer.exe中的图片查看器打开的。<br> <img src="https://images2.imgbox.com/fe/d0/KAril9KE_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将explorer.exe转储下来看看。<br> <img src="https://images2.imgbox.com/0c/ed/34EW6lDO_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用foremost分离文件。<br> <img src="https://images2.imgbox.com/dd/c5/Ov6ZO43f_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8b/64/g16nblxj_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Yc6N0IZW-1648872940034)(/upload/2022/04/image-6331aae197f947f3bd5a1c7f6408c693.png)]"></p> </li><li> <p>发现图片中有key和iv，那么应该是aes加密。</p> </li></ol> 
<pre><code class="prism language-txt">密文：jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4=
key: Th1s_1s_K3y00000
iv: 1234567890123456
</code></pre> 
<p>按照已有的信息进行解密。<br> <img src="https://images2.imgbox.com/00/d0/MuIChiCd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6_OtterCTF_895"></a>6. OtterCTF</h3> 
<h4><a id="1_What_the_password_897"></a>1. What the password?</h4> 
<p><strong>you got a sample of rick’s PC’s memory. can you get his user password?（你得到了瑞克电脑内存的样本，你能得到他的用户密码吗？）</strong></p> 
<ol><li> <p>使用<code>vol.py -f OtterCTF.vmem imageinfo</code>获取基本信息，profilr为Win7SP1x64。<br> <img src="https://images2.imgbox.com/e8/6f/K0NA8fyI_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>vol.py -f OtterCTF.vmem --profile=Win7SP1x64 hashdump</code>来获取密码的LM和NTML，然后使用彩虹表进行破解。这里需要与<strong>mimikatz</strong>插件。<br> <img src="https://images2.imgbox.com/6f/54/xGNrhk1C_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>vol.py --plugins=./volatility-master/volatility/plugins -f OtterCTF.vmem --profile=Win7SP1x64 mimikatz</code>进行破解。<br> <img src="https://images2.imgbox.com/79/2b/FVaUkoYp_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code class="prism language-txt">CTF{MortyIsReallyAnOtter}
</code></pre> 
<h4><a id="2_General_Info_917"></a>2. General Info</h4> 
<p><strong>Let’s start easy - whats the PC’s name and IP address?（让我们从简单的开始–电脑的名称和IP地址是什么？）</strong></p> 
<ol><li> <p>使用<code>netscan</code>查看ip地址。<br> <img src="https://images2.imgbox.com/81/5f/8jQO4mF2_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>hivelist</code>查看注册表。<br> <img src="https://images2.imgbox.com/32/ba/gSqihn6A_o.png" alt="在这里插入图片描述"><br> 有system，进行查看。<br> <img src="https://images2.imgbox.com/c6/a1/yFpLYr72_o.png" alt="在这里插入图片描述"><br> 跟着一直解析，最后看到主机名。<br> <img src="https://images2.imgbox.com/de/85/4Lggo35F_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code class="prism language-txt">CTF{WIN-LO6FAF3DTFE}
CTF{192.168.202.131}
</code></pre> 
<h4><a id="3_Play_Time_937"></a>3. Play Time</h4> 
<p><strong>Rick just loves to play some good old videogames. can you tell which game is he playing? whats the IP address of the server?（瑞克只是喜欢玩一些好的老式电子游戏，你能告诉他在玩哪个游戏吗？ 服务器的IP地址是什么？）</strong></p> 
<ol><li>使用<code>netscan</code>直接查看到游戏名与IP。<br> <img src="https://images2.imgbox.com/5c/e5/GExwH4Gv_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code class="prism language-txt">CTF{LunarMS.exe}
CTF{77.102.199.102}
</code></pre> 
<h4><a id="4_Name_Game_949"></a>4. Name Game</h4> 
<p><strong>We know that the account was logged in to a channel called Lunar-3. what is the account name?（我们知道该账户登录了一个名为Lunar-3的频道。什么是账户名称？）</strong></p> 
<ol><li>尝试搜索Lunar-3及其前后的内容。<br> <img src="https://images2.imgbox.com/e1/43/oUxD3RUS_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code class="prism language-txt">CTF{0tt3r8r33z3}
</code></pre> 
<h4><a id="5_Name_Game_2_960"></a>5. Name Game 2</h4> 
<p><strong>From a little research we found that the username of the logged on character is always after this signature: <code>0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2}</code> What’s rick’s character’s name?（通过一点研究，我们发现，登录的字符的用户名总是在这个签名之后。<code>0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2}</code> 瑞克的角色叫什么名字？）</strong></p> 
<ol><li> <p>将<strong>LunarMS.exe</strong>转储出来。<br> <img src="https://images2.imgbox.com/6d/c2/OiqiOBIh_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>hexdump -C 708.dmp | grep "5a 0c 00" -A 3 -B 3</code>进行搜索。<br> <img src="https://images2.imgbox.com/7e/c6/KRqCwkTv_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>CTF{M0rtyL0L}
</code></pre> 
<h4><a id="6_Silly_Rick_977"></a>6. Silly Rick</h4> 
<p><strong>Silly rick always forgets his email’s password, so he uses a Stored Password Services online to store his password. He always copy and paste the password so he will not get it wrong. whats rick’s email password?（愚蠢的瑞克总是忘记他的电子邮件的密码，所以他使用在线存储密码服务来存储他的密码。他总是复制和粘贴密码，这样他就不会弄错。里克的电子邮件密码是什么？）</strong></p> 
<ol><li>查看粘贴板。<br> <img src="https://images2.imgbox.com/25/27/YYoEjsCr_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code>CTF{M@il_Pr0vid0rs}
</code></pre> 
<h4><a id="7_Hide_And_Seek_989"></a>7. Hide And Seek</h4> 
<p><strong>The reason that we took rick’s PC memory dump is because there was a malware infection. Please find the malware process name (including the extension)（我们提取瑞克的电脑内存转储的原因是有一个恶意软件感染。请找到恶意软件的进程名称（包括扩展名））</strong></p> 
<ol><li> <p>查看进程树，发现一个异常的进程，PPID比PID还大。<br> <img src="https://images2.imgbox.com/1f/eb/KtYLheUN_o.png" alt="在这里插入图片描述"></p> </li><li> <p>查看一下这个进程的DLL，发现程序是在temp目录下执行的，那这个应该就是恶意软件进程了。<br> <img src="https://images2.imgbox.com/d8/3d/VcplwkmA_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>CTF{vmware-tray.exe}
</code></pre> 
<h4><a id="8__Path_To_Glory_1005"></a>8. Path To Glory</h4> 
<p><strong>How did the malware got to rick’s PC? It must be one of rick old illigal habits…（恶意软件是如何进入里克的电脑的？这一定是瑞克的一个老习惯…）</strong></p> 
<ol><li> <p><code>vol.py -f OtterCTF.vmem --profile=Win7SP1x64 filescan | grep Rick</code>过滤出Rick相关的文件，发现一个种子文件比较可疑。<br> <img src="https://images2.imgbox.com/63/74/5PtGsMG1_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将可疑文件转储，然后查看字符串。<br> <img src="https://images2.imgbox.com/83/e9/jKDIZael_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>CTF{M3an_T0rren7_4_R!cke}
</code></pre> 
<h4><a id="9__Path_To_Glory_1021"></a>9. Path To Glory</h4> 
<p><strong>Continue the search after the the way that malware got in.（在恶意软件进入后继续搜索。）</strong></p> 
<ol><li> <p>先将所有的chrome进程转储下来。<br> <img src="https://images2.imgbox.com/4a/01/Fi0u7XIh_o.png" alt="在这里插入图片描述"></p> </li><li> <p>搜索download.exe.torren。<br> <img src="https://images2.imgbox.com/39/e8/FbfMnAK7_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>CTF{Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@inYear}
</code></pre> 
<h4><a id="10_Bit_4_Bit_1037"></a>10. Bit 4 Bit</h4> 
<p><strong>We’ve found out that the malware is a ransomware. Find the attacker’s bitcoin address.（我们发现这个恶意软件是勒索软件。找到攻击者的比特币地址。）</strong></p> 
<ol><li> <p>将恶意软件转储出来。<br> <img src="https://images2.imgbox.com/34/41/NVJSFtOi_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用IDA Pro进行分析。<br> <img src="https://images2.imgbox.com/32/50/imDXSxUc_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>CTF{1MmpEmebJkqXG8nQv4cjJSmxZQFVmFo63M}
</code></pre> 
<h4><a id="11_Graphics_For_The_Weak_1053"></a>11. Graphic’s For The Weak</h4> 
<p><strong>There’s something fishy in the malware’s graphics.（恶意软件的图形中有些可疑。）</strong></p> 
<ol><li>使用dnspy逆向文件，查看图片。<br> <img src="https://images2.imgbox.com/19/78/aRjKEPMC_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code>CTF{S0_Just_M0v3_Socy}
</code></pre> 
<h4><a id="12_Recovery_1065"></a>12. Recovery</h4> 
<p><strong>Rick got to have his files recovered! What is the random password used to encrypt the files?（里克得把他的档案找回来！用于加密文件的随机密码是什么？）</strong></p> 
<ol><li> <p>在form1中有一个sendpassword函数，但是并没有发送，使用的是<code>computerName</code>+<code>userName</code>。<br> <img src="https://images2.imgbox.com/11/21/MInIeAzi_o.png" alt="在这里插入图片描述"></p> </li><li> <p>猜测就是第二题总拿到的主机名<code>WIN-LO6FAF3DTFE</code>加上用户名<code>Rick</code>，使用strings进行搜索一下。<br> <img src="https://images2.imgbox.com/6e/1c/Z5iKz77Y_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>CTF{aDOBofVYUNVnmp7}
</code></pre> 
<h4><a id="13_Recovery_1081"></a>13. Recovery</h4> 
<p><strong>Now that you extracted the password from the memory, could you decrypt rick’s files?（既然你从内存中提取了密码，你能解密瑞克的文件吗？）</strong></p> 
<ol><li> <p>找到flag.txt在桌面，将其转储出来。<br> <img src="https://images2.imgbox.com/3e/ff/8d4IZoQ8_o.png" alt="在这里插入图片描述"></p> </li><li> <p>百度后知道这个恶意软件就是<code>HiddenTear勒索软件</code>，先使用<code>HiddenTear Bruteforcer</code>爆破出密钥，再使用<code>HiddenTearDecrypter</code>进行解密。</p> </li><li> <p>先将文件末尾多余的0删除掉，并将后缀修改为<code>.png.locked</code>。<br> <img src="https://images2.imgbox.com/6e/63/4TmX3kWp_o.png" alt="在这里插入图片描述"></p> </li><li> <p>打开<code>HiddenTear Bruteforcer</code>，点击<code>Browse Sample</code>选择文件，然后点击<code>Start Bruteforce</code>进行爆破（这一步其实可以省略，因为上一题已经拿到密钥了<code>aDOBofVYUNVnmp7</code>）。<br> <img src="https://images2.imgbox.com/26/12/W5XDl1Jp_o.png" alt="在这里插入图片描述"></p> </li><li> <p>打开<code>HiddenTearDecrypter</code>，填写密钥，<code>Select Directory</code>选择加密文件的目录，点击<code>Decrypt</code>解密文件。<br> <img src="https://images2.imgbox.com/23/6e/ouCdRTnN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d5/9e/KXDRCrdC_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-iSIWGUUE-1648872940049)(/upload/2022/04/image-55abed80941642a98cd1031f0855dbd9.png)]"></p> </li></ol> 
<pre><code>CTF{Im_Th@_B3S7_RicK_0f_Th3m_4ll}
</code></pre> 
<h3><a id="7_BMZCTF_1106"></a>7. [BMZCTF]内存取证三项</h3> 
<p><strong>题目描述：一天下午小白出去吃饭，临走之前还不忘锁了电脑，这时同寝室的小黑想搞点事情，懂点黑客和社工知识的小黑经过多次尝试获得了密码成功进入电脑，于是便悄悄在电脑上动起手脚了，便在桌面上写着什么，想给小白一个惊喜，同时还传送着小白的机密文件，正巧这时小白刚好回来，两人都吓了一跳，小黑也不管自己在电脑上留下的操作急忙离开电脑，故作淡定的说：“我就是随便看看”。</strong><br> <strong>1.小黑写的啥，据说是flag？</strong><br> <strong>2.那么问题来了，小白的密码是啥？</strong><br> <strong>3.小黑发送的机密文件里面到底是什么</strong></p> 
<ol><li>先查看基本信息，profile为WinXPSP2x86。<br> <img src="https://images2.imgbox.com/f7/9f/EkHRybD3_o.png" alt="在这里插入图片描述"></li><li>查看一下记事本，发现一串十六进制数。<br> <img src="https://images2.imgbox.com/12/7f/1eQW2NwZ_o.png" alt="在这里插入图片描述"></li><li>转换成ASCII。<br> <img src="https://images2.imgbox.com/15/f7/y9euKpn9_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code class="prism language-txt">flag{W3lec0me_7o_For3n5ics}
</code></pre> 
<ol start="4"><li>查看一下命令行，发现使用nc下载了一个压缩包。<br> <img src="https://images2.imgbox.com/f8/6a/gM6gjJHZ_o.png" alt="在这里插入图片描述"></li><li>将压缩包找到并转储出来。<br> <img src="https://images2.imgbox.com/70/7a/r1EoIcFa_o.png" alt="在这里插入图片描述"></li><li>根据压缩包名字，猜的解压密码是生日，一共八位数字，如：<code>20010101</code>。使用john爆破一下试试。<br> <img src="https://images2.imgbox.com/b6/df/39xmrddz_o.png" alt="在这里插入图片描述"></li><li>john跑出密码<code>19950101</code>，打开压缩包得到flag。<br> <img src="https://images2.imgbox.com/2a/1b/CuiOa13n_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code>密码：19950101
flag{Thi5_Is_s3cr3t!}
</code></pre> 
<h3><a id="8__1136"></a>8. [长安杯]朴实无华的取证</h3> 
<ol><li>查看profile为WinXPSP2x86。<br> <img src="https://images2.imgbox.com/00/6f/14es4OFP_o.png" alt="在这里插入图片描述"></li><li>查看进程发现有记事本。<br> <img src="https://images2.imgbox.com/08/80/NUovzaDU_o.png" alt="在这里插入图片描述"></li><li>记事本中有一个密码，暂时不知道干什么的。<br> <img src="https://images2.imgbox.com/90/0a/k3QG8B0m_o.png" alt="在这里插入图片描述"></li><li>搜索文件，发现<code>flag.zip</code>和<code>flag.png</code>，将这两个文件dump出来。<br> <img src="https://images2.imgbox.com/ee/06/E859nbLH_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/f1/b7/67NDSkNE_o.png" alt="在这里插入图片描述"></li><li>压缩包需要密码，使用之前发现的<code>20211209</code>进行解压，得到一个脚本，看了下应该是加密脚本。</li></ol> 
<pre><code class="prism language-c"><span class="token comment">//幼儿园水平的加密（部分）</span>
<span class="token keyword">void</span> <span class="token function">Encrypt</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'w'</span><span class="token punctuation">)</span>
			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token char">'x'</span><span class="token punctuation">)</span>
			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'a'</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token char">'y'</span><span class="token punctuation">)</span>
			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'b'</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token char">'z'</span><span class="token punctuation">)</span>
			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'c'</span><span class="token punctuation">;</span>	
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token char">'_'</span><span class="token punctuation">)</span>
			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'|'</span><span class="token punctuation">;</span>
		str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">32</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="6"><li><code>flag.png</code>中有一串字符。<br> <img src="https://images2.imgbox.com/3a/82/5iAlA3Bp_o.png" alt="在这里插入图片描述"></li><li>很明显是之前的加密脚本加密之后的文本，写脚本进行解密得到flag。</li></ol> 
<pre><code class="prism language-python">strs <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>strs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'d'</span> <span class="token operator">&lt;=</span> strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token string">'z'</span><span class="token punctuation">:</span>
        strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">match</span> j<span class="token punctuation">:</span>
        <span class="token keyword">case</span> <span class="token string">'a'</span><span class="token punctuation">:</span>
            strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'x'</span>
        <span class="token keyword">case</span> <span class="token string">'b'</span><span class="token punctuation">:</span>
            strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'y'</span>
        <span class="token keyword">case</span> <span class="token string">'c'</span><span class="token punctuation">:</span>
            strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'z'</span>
        <span class="token keyword">case</span> <span class="token string">'|'</span><span class="token punctuation">:</span>
            strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'_'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>strs<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-txt">cazy{Xian_will_certainly_succeed_in_fighting_the_epidemic}
</code></pre> 
<h3><a id="9__1191"></a>9. [陇剑杯]内存分析</h3> 
<h4><a id="1______________flagxxxx_1193"></a>1. 虚拟机的密码是_____________。（密码中为flag{xxxx}，含有空格，提交时不要去掉）</h4> 
<ol><li>直接<code>mimikatz</code>抓到密码。<br> <img src="https://images2.imgbox.com/2c/21/pxwcHt9v_o.png" alt="在这里插入图片描述"></li><li>也可以使用<code>lsadump</code>。<br> <img src="https://images2.imgbox.com/3d/21/hJokVuhb_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code class="prism language-txt">flag{W31C0M3_T0_THiS_34SY_F0R3NSiCX}
</code></pre> 
<h4><a id="2______________flagflagxxx_1203"></a>2. 虚拟机中有一个某品牌手机的备份文件，文件里的图片里的字符串为_____________。（解题过程中需要用到上一题答案中flag{}内的内容进行处理。本题的格式也是flag{xxx}，含有空格，提交时不要去掉）</h4> 
<ol><li>扫描一下桌面的文件，发现一个<code>HUAWEI P40_2021-aa-bb xx.yy.zz.exe</code>。<br> <img src="https://images2.imgbox.com/12/f6/2FD2BBOt_o.png" alt="在这里插入图片描述"></li><li>题目说和手机有关，应该就是这个，dump下来打开。<br> <img src="https://images2.imgbox.com/ce/25/mEuZO4Fj_o.png" alt="在这里插入图片描述"></li><li>修改文件名后，发现是个exe自解压文件，双击得到文件夹。<br> <img src="https://images2.imgbox.com/95/78/IZmdVuaD_o.png" alt="在这里插入图片描述"></li><li>经过上网搜索后，得知是华为的备份加密，直接用工具<a href="https://github.com/RealityNet/kobackupdec"> kobackupdec</a>梭哈。</li></ol> 
<pre><code>py -3 kobackupdec.py W31C0M3_T0_THiS_34SY_F0R3NSiCX "E:\Bnessy\Desktop\HUAWEI P40_2021-aa-bb xx.yy.zz" ./HW
</code></pre> 
<p><img src="https://images2.imgbox.com/3a/b7/QntBvlXA_o.png" alt="在这里插入图片描述"><br> 5. 将<code>HW\storage\MediaTar\images\images0.tar</code>解压得到flag。<br> <img src="https://images2.imgbox.com/d3/94/0HaaBHoq_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="10_Administrator_s_secret_1218"></a>10. [安洵杯]Administrator 's_secret</h3> 
<ol><li>先查看下基本信息。<br> <img src="https://images2.imgbox.com/ad/b1/SeUt5aKm_o.png" alt="在这里插入图片描述"></li><li><code>pslist</code>看一下有什么进程，这里发现有个 <strong>CnCrypt.exe</strong> ， <strong>CnCrypt</strong>是一款磁盘加密软件 。<br> <img src="https://images2.imgbox.com/19/02/ar6UkXT7_o.png" alt="在这里插入图片描述"></li><li>上面进程中还看到有 <strong>cmd.exe</strong> ，那就看下cmd命令，发现有个 <strong>flag.ccx</strong> 文件，并且提示 <strong>flag.ccx</strong> 的密码就是 <strong>Administrator</strong> 的密码。<br> <img src="https://images2.imgbox.com/e6/05/JF73d0IH_o.png" alt="在这里插入图片描述"></li><li><strong>mimikatz</strong> 抓取到密码<code>ABCabc123</code>。<br> <img src="https://images2.imgbox.com/a5/6b/VM7KQLDo_o.png" alt="在这里插入图片描述"></li><li><code>filescan</code>找到 <strong>flag.ccx</strong> 并dump下来。<br> <img src="https://images2.imgbox.com/90/7f/HpFs3h46_o.png" alt="在这里插入图片描述"></li><li>使用 <strong>CnCrypt</strong> 进行解密。<br> <img src="https://images2.imgbox.com/5f/25/iNv7pciG_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/51/ad/BtTLhan6_o.png" alt="在这里插入图片描述"></li><li>解密并挂载得到flag。<br> <img src="https://images2.imgbox.com/ea/d3/F2IEvRUf_o.png" alt="在这里插入图片描述"></li></ol> 
<pre><code>flag{now_you_see_my_secret}
</code></pre> 
<h3><a id="11_Easy_dump_1238"></a>11. [护网杯]Easy_dump</h3> 
<ol><li> <p>先查看基本信息。<br> <img src="https://images2.imgbox.com/bb/34/SqReolEQ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>看下进程信息，发现有 <strong>notepad.exe(记事本)</strong> 。<br> <img src="https://images2.imgbox.com/60/a0/8OWjN4Bd_o.png" alt="在这里插入图片描述"></p> </li><li> <p>把进程dump下来，看下有没有和flag有关的内容。<br> <img src="https://images2.imgbox.com/13/ce/dM6rgGEo_o.png" alt="在这里插入图片描述"></p> </li><li> <p>提示说有一张jpg图片，搜索一下。<br> <img src="https://images2.imgbox.com/70/14/dmgUFgdw_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将图片保存下来。<br> <img src="https://images2.imgbox.com/91/f2/k6C2UxxY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6f/bf/6AL5SC6q_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用binwalk分析一下，发现zip文件。<br> <img src="https://images2.imgbox.com/8e/d4/SHRqhNZm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>foremost进行分离。<br> <img src="https://images2.imgbox.com/a6/19/GqPEFBeH_o.png" alt="在这里插入图片描述"><br> 得到一个压缩包<br> <img src="https://images2.imgbox.com/41/8e/8cqL6IPS_o.png" alt="在这里插入图片描述"><br> 解压后得到一个img文件<br> <img src="https://images2.imgbox.com/4b/38/sbE3pGL7_o.png" alt="在这里插入图片描述"></p> </li><li> <p>binwalk继续分析，分离出hint.txt文件。<br> <img src="https://images2.imgbox.com/a3/45/vSB6hB39_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/80/de/C0fKzngg_o.png" alt="在这里插入图片描述"></p> </li><li> <p>看起来像坐标，使用gnuplot绘制一下得到一个二维码。<br> <img src="https://images2.imgbox.com/8c/66/ZzIt2K5O_o.png" alt="在这里插入图片描述"></p> </li><li> <p>扫描得到提示<code>Here is the vigenere key: aeolus, but i deleted the encrypted message。</code>。<br> <img src="https://images2.imgbox.com/b7/27/Vjr5KFzg_o.png" alt="在这里插入图片描述"></p> </li><li> <p>知道了两点，第一是维吉尼亚密码，第二是文件被删除了，这里使用<code>testdisk</code>恢复文件。<br> <img src="https://images2.imgbox.com/e7/cf/UaX3dqLu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6b/23/ODD2zv7h_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/04/b8/wprWDIEX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5b/88/5cjzl02U_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/46/cb/e8tHpclW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/63/88/yJuRuUqE_o.png" alt="在这里插入图片描述"><br> 按小写c选择，然后按大写C保存到当前目录<br> <img src="https://images2.imgbox.com/6a/59/Zckt5iWT_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用<code>vim -r</code>恢复文件。<br> <img src="https://images2.imgbox.com/19/f2/plcKIQdG_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6d/7e/AUez5OWS_o.png" alt="在这里插入图片描述"></p> </li><li> <p><code>yise!dmsx_tthv_arr_didvi </code>应该就是密文了，使用之前拿到的密钥<code>aeolus</code>进行解密。<br> <img src="https://images2.imgbox.com/35/fb/Ck9BORSb_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<pre><code>flag{yeet!just_find_and_solve}
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b316b984128c79f09e8fbb78da83cf7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue-移动端适配rem、vw、vh</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/711a4ce4fc1b8c367bc6e86cebfdd16c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">阻塞IO与非阻塞IO的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>