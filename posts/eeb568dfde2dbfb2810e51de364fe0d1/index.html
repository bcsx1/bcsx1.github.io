<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32应用(九)编码器及其测速原理、L298N电机驱动控制编码器电机 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32应用(九)编码器及其测速原理、L298N电机驱动控制编码器电机" />
<meta property="og:description" content="文章目录 1.L298N电机驱动1.1 产品参数1.2 实物图和接线 2.编码器2.1 编码器简介2.2 常用编码器分类2.3 霍尔编码器实物图接线！！！！2.4 编码器倍频原理 3.控制编码器电机（PWM模式）3.1 电机介绍3.2 M法测速（很重要！！！！）3.3 工程配置3.4 代码编写3.5 接线3.6 实验效果 4.控制编码器电机（编码器模式）4.1 工程配置4.2 实物连接和连线解释4.3 代码编写4.4 接线4.5 实验效果 1.L298N电机驱动 1.1 产品参数 1.2 实物图和接线 l298n电机驱动模块 电机正反转 电机调速
听完这个视频，这个小玩意你就会了。
1.当驱动电压(板子标识为VCC输入，实际可以接受的输入范围是7-12V。一般都是使用航模电池或买电池盒。
在电机驱动，单片机，编码器电机三者使用的过程中，一定要把三者的GND连在一起，也就是共地！！！
2.编码器 【电工知识】编码器是干什么用的，这下终于明白了！
2.1 编码器简介 编码器， 是将信号或数据进行编制、转换为可用以通讯、传输和存储的信号形式的设备。编码器把角位移或直线位移转换成电信号。是工业中常用的电机定位设备，可以精确的测试电机的角位移和旋转位置。 编码器最直接的作用就是可以测量位移，知道位移了就可以计算得到速度了。
简单点，编码器是用来测速的。放在电机上，可以解算出电机的转速。
2.2 常用编码器分类 按输出信号分：增量式和绝对式
它们存着最大的区别：在增量编码器的情况下，位置是从零位标记开始计算的脉冲数量确定的，而绝对型编码器的位置是由输出代码的读数确定的。绝对型编码器并不与实际的位置分离。如果电源再次接通，那么位置读数仍是当前的、有效的，不像增量编码器那样，必须去寻找零位标记。
绝对式掉电不丢失读数值，增量式会丢失。
按传感技术分：光电式和霍尔式（激光式、磁式、感应式、电容式等）
1.光电式：就像下图里的一样。当光线透过齿轮盘时，接收器会计数一次，并再传送给CPU。不同的转速，自然在相同时间内的计数值不一样。进而达到测速的功能。（个人理解）
2.霍尔式
【Arduino 101】霍尔编码器与闭环控制（白话）
霍尔编码器是由霍尔码盘和霍尔元件组成。霍尔码盘是在一定直径的圆板上等分地布置有不同的磁极。霍尔码盘与电动机同轴，电动机旋转时，霍尔元件检测输出若干脉冲信号，为判断转向，一般输出两组存在一定相位差的方波信号 （通常相差90°，我们称为AB相）。
测速还是计算相同时间内的脉冲数，而判断转向呢？
可以看到下图，当顺时针旋转时，A相处在下降沿时，B相是高电平。A相处在上升沿时，B相是低电平；当逆时针旋转时，（即把上面的波形从右向左看）A相处在下降沿时，B相是低电平。A相处在上升沿时，B相是高电平。进而判断正反转。
2.3 霍尔编码器实物图接线！！！！ 编码器单片机A相接单片机的脉冲检测接口B相接单片机的脉冲检测接口&#43;5V&#43;5VGNDGND 编码器电机驱动M&#43;接电机驱动的输出OUT1M-接电机驱动的输出OUT2 单片机电机驱动会根据两个方法来说明IN1/IN2/ENA 2.4 编码器倍频原理 编码器计数原理与电机测速原理
3.控制编码器电机（PWM模式） 3.1 电机介绍 GB37520 电机为减速电机。即电机头部有一个减速器，电机转动带动减速器里的齿轮后再通过减速器的输出轴输出相应的转速。比如减速比是 1： 30，表示电机转动 30圈，电机的减速器转动一圈。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/eeb568dfde2dbfb2810e51de364fe0d1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-16T15:00:03+08:00" />
<meta property="article:modified_time" content="2021-08-16T15:00:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32应用(九)编码器及其测速原理、L298N电机驱动控制编码器电机</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1L298N_1" rel="nofollow">1.L298N电机驱动</a></li><li><ul><li><a href="#11__3" rel="nofollow">1.1 产品参数</a></li><li><a href="#12__7" rel="nofollow">1.2 实物图和接线</a></li></ul> 
  </li><li><a href="#2_23" rel="nofollow">2.编码器</a></li><li><ul><li><a href="#21__26" rel="nofollow">2.1 编码器简介</a></li><li><a href="#22__31" rel="nofollow">2.2 常用编码器分类</a></li><li><a href="#23__55" rel="nofollow">2.3 霍尔编码器实物图接线！！！！</a></li><li><a href="#24__75" rel="nofollow">2.4 编码器倍频原理</a></li></ul> 
  </li><li><a href="#3PWM_91" rel="nofollow">3.控制编码器电机（PWM模式）</a></li><li><ul><li><a href="#31__92" rel="nofollow">3.1 电机介绍</a></li><li><a href="#32_M_96" rel="nofollow">3.2 M法测速（很重要！！！！）</a></li><li><a href="#33__110" rel="nofollow">3.3 工程配置</a></li><li><a href="#34__123" rel="nofollow">3.4 代码编写</a></li><li><a href="#35__172" rel="nofollow">3.5 接线</a></li><li><a href="#36__177" rel="nofollow">3.6 实验效果</a></li></ul> 
  </li><li><a href="#4_183" rel="nofollow">4.控制编码器电机（编码器模式）</a></li><li><ul><li><a href="#41__189" rel="nofollow">4.1 工程配置</a></li><li><a href="#42__211" rel="nofollow">4.2 实物连接和连线解释</a></li><li><a href="#43__219" rel="nofollow">4.3 代码编写</a></li><li><a href="#44__326" rel="nofollow">4.4 接线</a></li><li><a href="#45__334" rel="nofollow">4.5 实验效果</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1L298N_1"></a>1.L298N电机驱动</h2> 
<h3><a id="11__3"></a>1.1 产品参数</h3> 
<p><img src="https://images2.imgbox.com/c5/fd/IwlzGGiW_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12__7"></a>1.2 实物图和接线</h3> 
<p><a href="https://www.bilibili.com/video/BV1Xt411372X?from=search&amp;seid=327420988233423607" rel="nofollow">l298n电机驱动模块 电机正反转 电机调速</a></p> 
<p><strong>听完这个视频，这个小玩意你就会了。</strong><br> <img src="https://images2.imgbox.com/a6/79/kzO6kFgq_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/11/f8/XpcZURMR_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>1.当驱动电压(板子标识为VCC输入，实际可以接受的输入范围是7-12V。一般都是使用航模电池或买电池盒。</p> 
</blockquote> 
<p><strong>在电机驱动，单片机，编码器电机三者使用的过程中，一定要把三者的GND连在一起，也就是共地！！！</strong></p> 
<h2><a id="2_23"></a>2.编码器</h2> 
<p><a href="https://www.bilibili.com/video/BV1cv411z7ag?from=search&amp;seid=183456746879237247" rel="nofollow">【电工知识】编码器是干什么用的，这下终于明白了！<br> </a></p> 
<h3><a id="21__26"></a>2.1 编码器简介</h3> 
<p>编码器， 是将信号或数据进行编制、转换为可用以通讯、传输和存储的信号形式的设备。编码器把角位移或直线位移转换成电信号。是工业中常用的电机定位设备，可以精确的测试电机的角位移和旋转位置。 编码器最直接的作用就是可以测量位移，知道位移了就可以计算得到速度了。</p> 
<blockquote> 
 <p>简单点，<strong>编码器是用来测速的</strong>。放在电机上，可以解算出<strong>电机的转速</strong>。</p> 
</blockquote> 
<h3><a id="22__31"></a>2.2 常用编码器分类</h3> 
<p><strong>按输出信号分：增量式和绝对式</strong></p> 
<p>它们存着最大的区别：在增量编码器的情况下，位置是从零位标记开始计算的脉冲数量确定的，而绝对型编码器的位置是由输出代码的读数确定的。<strong>绝对型编码器</strong>并不与实际的位置分离。如果<strong>电源再次接通</strong>，那么<strong>位置读数仍是当前的</strong>、有效的，不像增量编码器那样，必须去寻找零位标记。</p> 
<blockquote> 
 <p><strong>绝对式掉电不丢失读数值，增量式会丢失。</strong></p> 
</blockquote> 
<p><strong>按传感技术分：光电式和霍尔式（激光式、磁式、感应式、电容式等）</strong></p> 
<p>1.光电式：就像下图里的一样。当光线透过齿轮盘时，接收器会计数一次，并再传送给CPU。不同的转速，自然在相同时间内的计数值不一样。进而达到测速的功能。（个人理解）</p> 
<p><img src="https://images2.imgbox.com/87/32/B0IS3WXq_o.png" alt="在这里插入图片描述"></p> 
<p>2.霍尔式<br> <a href="https://www.bilibili.com/video/BV1ap4y1H7e4?from=search&amp;seid=183456746879237247" rel="nofollow">【Arduino 101】霍尔编码器与闭环控制（白话）</a><br> 霍尔编码器是由霍尔码盘和霍尔元件组成。霍尔码盘是在一定直径的圆板上等分地布置有不同的磁极。霍尔码盘与电动机同轴，电动机旋转时，霍尔元件检测输出若干脉冲信号，为判断转向，一般输出两组存在一定相位差的方波信号 <strong>（通常相差90°，我们称为AB相）</strong>。</p> 
<p>测速还是计算相同时间内的脉冲数，而判断转向呢？</p> 
<p>可以看到下图，当顺时针旋转时，A相处在下降沿时，B相是高电平。A相处在上升沿时，B相是低电平；当逆时针旋转时，（即<strong>把上面的波形从右向左看</strong>）A相处在下降沿时，B相是低电平。A相处在上升沿时，B相是高电平。进而判断正反转。</p> 
<p><img src="https://images2.imgbox.com/85/de/tegh22KU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23__55"></a>2.3 霍尔编码器实物图接线！！！！</h3> 
<p><img src="https://images2.imgbox.com/60/20/UV6NuWtV_o.png" alt="在这里插入图片描述"></p> 
<table><thead><tr><th>编码器</th><th>单片机</th></tr></thead><tbody><tr><td>A相</td><td>接单片机的脉冲检测接口</td></tr><tr><td>B相</td><td>接单片机的脉冲检测接口</td></tr><tr><td>+5V</td><td>+5V</td></tr><tr><td>GND</td><td>GND</td></tr></tbody></table> 
<table><thead><tr><th>编码器</th><th>电机驱动</th></tr></thead><tbody><tr><td>M+</td><td>接电机驱动的输出OUT1</td></tr><tr><td>M-</td><td>接电机驱动的输出OUT2</td></tr></tbody></table> 
<table><thead><tr><th>单片机</th><th>电机驱动</th></tr></thead><tbody><tr><td>会根据两个方法来说明</td><td>IN1</td></tr><tr><td>/</td><td>IN2</td></tr><tr><td>/</td><td>ENA</td></tr></tbody></table> 
<h3><a id="24__75"></a>2.4 编码器倍频原理</h3> 
<p><a href="https://blog.csdn.net/hbsyaaa/article/details/113784920?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162907796416780271542180%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=162907796416780271542180&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-2-113784920.first_rank_v2_pc_rank_v29&amp;utm_term=130%E7%BC%96%E7%A0%81%E5%99%A8%E7%94%B5%E6%9C%BA%E9%80%9F%E5%BA%A6%E8%AE%A1%E7%AE%97&amp;spm=1018.2226.3001.4187">编码器计数原理与电机测速原理</a><br> <img src="https://images2.imgbox.com/8a/b7/dLKPJQp3_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a7/fc/bsrZXvTN_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3PWM_91"></a>3.控制编码器电机（PWM模式）</h2> 
<h3><a id="31__92"></a>3.1 电机介绍</h3> 
<p>GB37520 电机为减速电机。即电机头部有一个减速器，电机转动带动减速器里的齿轮后再通过减速器的输出轴输出相应的转速。比如<strong>减速比</strong>是 1： 30，<strong>表示电机转动 30圈，电机的减速器转动一圈。</strong><br> <img src="https://images2.imgbox.com/9d/50/lE03sIST_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/90/d5/klBneF6q_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32_M_96"></a>3.2 M法测速（很重要！！！！）</h3> 
<p><img src="https://images2.imgbox.com/28/13/qYTOh83E_o.png" alt="在这里插入图片描述"></p> 
<ul><li>T0是自行设定的时间。</li><li>M0是在设定时间内的脉冲数。</li><li>C是单圈总脉冲数。(<strong>直流电机轴旋转一圈</strong>在霍尔传感器每个引脚有 <strong>13个脉冲信号</strong>输出。)</li></ul> 
<blockquote> 
 <p>这里的磁环是固定在直流电机转轴上的，与减速电机的输出轴是不一样的。减速电机的输出轴是经过减速齿轮变换后的，之前有介绍到该电机的减速比为：1:30， 所以， 如果减速电机输出轴旋转一圈，实际上可以检测到的编码器每相脉冲数量为：13*30=390 个。 再通过单片机的编码器接口4 倍频就是 1560个脉冲信号， 这在我们计算实际位移和速度非常有用。</p> 
</blockquote> 
<p>算出来的n是直流电机的转速，正常来说可以使用了，但我使用的是减速电机。要想得到真正输出轴的转速，还需要<strong>除减速比</strong>。</p> 
<h3><a id="33__110"></a>3.3 工程配置</h3> 
<p>1.开启PWM的通道1，2作为L298N的输入1，2<br> <img src="https://images2.imgbox.com/77/88/y1IyYNq9_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>此时的计数值1000，可以理解为最大输出电压数字量是1000。如果我的供电电压是12V，并在程序中设置PWM的输出值为800。则驱动电机的电压为9.6V。 <strong>在电机控制中，电压越大，电机转速越快，而通过PWM输出不同的模拟电压，便可以使电机达到不同的输出转速。</strong></p> 
</blockquote> 
<p>2.开启GPIO中断，并打开NVIC选项卡设置中断优先级<br> <img src="https://images2.imgbox.com/d3/96/RArlmJo6_o.png" alt="在这里插入图片描述"><br> 编码器自带了上拉电阻，所以无需外部上拉，可以直接连接到单片机I0读取。（我点上拉了，不过也没关系）<br> <img src="https://images2.imgbox.com/25/90/e4AlTbhz_o.png" alt="在这里插入图片描述"><br> 3.开启串口，检验效果<br> <img src="https://images2.imgbox.com/39/13/hSHkACCc_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="34__123"></a>3.4 代码编写</h3> 
<pre><code class="prism language-cpp"><span class="token comment">/* USER CODE BEGIN PV */</span>
<span class="token keyword">int32_t</span> Sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int32_t</span> Last_sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//计算脉冲数目</span>
<span class="token keyword">float</span> V_rotate<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//转子速度(圈/ms),电机速度等于转子/减速比</span>
<span class="token keyword">float</span> V_Set<span class="token punctuation">;</span>		<span class="token comment">//设定速度</span>
<span class="token keyword">float</span> V_Out<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//减速电机速度</span>
<span class="token comment">/* USER CODE END PV */</span>


<span class="token comment">/* USER CODE BEGIN 0 */</span>
<span class="token keyword">int</span> <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">,</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">uint8_t</span> ch<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>c<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">HAL_UART_Transmit</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>huart1<span class="token punctuation">,</span>ch<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0xFFFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int8_t</span> a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//检测是否进入中断</span>
<span class="token keyword">void</span> <span class="token function">HAL_GPIO_EXTI_Callback</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token comment">//外部中断</span>
<span class="token punctuation">{<!-- --></span>
	a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment">/******一倍频*******/</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>GPIO_Pin<span class="token operator">==</span>GPIO_PIN_1<span class="token punctuation">)</span><span class="token comment">//编码器计数，检测到PF1(A相)跳变沿</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">HAL_GPIO_ReadPin</span><span class="token punctuation">(</span>GPIOF<span class="token punctuation">,</span>GPIO_PIN_2<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//PF2(B相)高电平正转</span>
			Sum<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>  
			Sum<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* USER CODE END 0 */</span>

<span class="token comment">/* USER CODE BEGIN 2 */</span>
<span class="token function">HAL_TIM_PWM_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span>TIM_CHANNEL_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">HAL_TIM_PWM_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span>TIM_CHANNEL_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* USER CODE END 2 */</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">__HAL_TIM_SetCompare</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span>TIM_CHANNEL_1<span class="token punctuation">,</span><span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Last_sum<span class="token operator">=</span>Sum<span class="token punctuation">;</span>
	<span class="token function">HAL_Delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	V_rotate<span class="token operator">=</span><span class="token punctuation">(</span>Sum<span class="token operator">-</span>Last_sum<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1.30f</span><span class="token punctuation">;</span> <span class="token comment">//转速(圈/s)</span>
	V_Out<span class="token operator">=</span>V_rotate<span class="token operator">/</span><span class="token number">30</span><span class="token punctuation">;</span><span class="token comment">//电机速度单位(转/秒)</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"V_Out is %f\r\n"</span><span class="token punctuation">,</span>V_Out<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="35__172"></a>3.5 接线</h3> 
<p><img src="https://images2.imgbox.com/55/3c/KmtUv231_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="36__177"></a>3.6 实验效果</h3> 
<p><img src="https://images2.imgbox.com/b8/b3/sdAwbAKS_o.png" alt="在这里插入图片描述"><br> 可以看到输出的效果还是很好的。没有效果的看看是不是少接线了。</p> 
<h2><a id="4_183"></a>4.控制编码器电机（编码器模式）</h2> 
<p><strong>参考博客：</strong><a href="https://blog.csdn.net/lzzzzzzm/article/details/119416134?spm=1001.2014.3001.5501">STM32 Cubemax(六) —— STM32利用定时器编码器模式处理带编码器直流电机</a></p> 
<blockquote> 
 <p>这里可以延续上面的工程内容，需要修改以下几个方面。</p> 
</blockquote> 
<h3><a id="41__189"></a>4.1 工程配置</h3> 
<p>1.修改定时器TIM1为编码器模式<br> <img src="https://images2.imgbox.com/bc/f5/PvXtOLt0_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这里的分配系数表示的对计数值分频，如果你这里写了3=4-1，那后面speed算的时候就不用除以4了。编码器模式默认四倍频。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/cd/66/s3L7t5jN_o.png" alt="在这里插入图片描述"><br> <strong>编码器上的AB相应该接编码器对应的引脚。</strong> 编码器模式就相当于一个专门计数的工具，当编码器的码盘转动时，A，B相输出矩形波脉冲，进入PE9和PE11进行计数（数脉冲）。</p> 
<p>2.修改GPIO引脚和模式<br> <img src="https://images2.imgbox.com/99/fb/FzLdh7jL_o.png" alt="在这里插入图片描述"><br> 3.开启TIM2_CHANNEL1<br> <img src="https://images2.imgbox.com/ac/c9/D9DdX5Em_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/19/aa/QThiMMzn_o.png" alt="在这里插入图片描述"></p> 
<p>4.开启一个10ms定时器来写中断函数<br> <img src="https://images2.imgbox.com/54/63/i8umHI0o_o.png" alt="在这里插入图片描述"><br> 5.不要忘记开中断<br> <img src="https://images2.imgbox.com/fc/2b/xotm4o8M_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这里注意一下,最好编码器的更新中断定时器,要比10ms定时器的优先级高,可以防止在更新中打被打断。</p> 
</blockquote> 
<h3><a id="42__211"></a>4.2 实物连接和连线解释</h3> 
<p><img src="https://images2.imgbox.com/a7/10/M16dVfLq_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>电机驱动的输入IN1和IN2接输出GPIO，PE12和PE10，单片机输出的PWM信号接到电机驱动的ENA（使能端A，上下都行）。这样的话一路PWM通过IN1，IN2的状态来控制PWM输出信号输出到OUT1还是OUT2，进而控制正反转。</strong></p> 
</blockquote> 
<h3><a id="43__219"></a>4.3 代码编写</h3> 
<p>0.基本函数测试</p> 
<pre><code class="prism language-cpp"><span class="token function">HAL_TIM_Encoder_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span> TIM_CHANNEL_ALL<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打开定时器的encoder模式</span>
Direction <span class="token operator">=</span> <span class="token function">__HAL_TIM_IS_TIM_COUNTING_DOWN</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//可以获得当前电机的转向</span>
enc1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">__HAL_TIM_GET_COUNTER</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取encoder编码器的计数值</span>
</code></pre> 
<blockquote> 
 <p>如果debug模式下enc1读数为0或为最大20000，建议接串口，用串口输出数据。</p> 
</blockquote> 
<p>1.在阅读上面的博客完成配置后<br> <strong>motor.h：</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__MOTOR_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__MOTOR_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"main.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"tim.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"PID.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RR</span> <span class="token expression"><span class="token number">30u</span>    </span><span class="token comment">//电机减速比</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RELOADVALUE</span> <span class="token expression"><span class="token function">__HAL_TIM_GetAutoreload</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">)</span>    </span><span class="token comment">//获取自动装载值,本例中为20000</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">COUNTERNUM</span> <span class="token expression"><span class="token function">__HAL_TIM_GetCounter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">)</span>        </span><span class="token comment">//获取编码器定时器中的计数值</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">IN1</span><span class="token expression"><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOE<span class="token punctuation">,</span>GPIO_PIN_12<span class="token punctuation">,</span><span class="token punctuation">(</span>GPIO_PinState<span class="token punctuation">)</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>    </span><span class="token comment">//IN1</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">IN2</span><span class="token expression"><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token function">HAL_GPIO_WritePin</span><span class="token punctuation">(</span>GPIOE<span class="token punctuation">,</span>GPIO_PIN_10<span class="token punctuation">,</span><span class="token punctuation">(</span>GPIO_PinState<span class="token punctuation">)</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>    </span><span class="token comment">//IN2</span></span>

<span class="token comment">//电机结构体</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_Motor</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int32_t</span> lastAngle<span class="token punctuation">;</span>        <span class="token comment">//上10ms转过的角度</span>
	<span class="token keyword">int32_t</span> totalAngle<span class="token punctuation">;</span>       <span class="token comment">//总的角度</span>
	<span class="token keyword">int16_t</span> loopNum<span class="token punctuation">;</span>          <span class="token comment">//防超上限</span>
	<span class="token keyword">float</span> speed<span class="token punctuation">;</span>              <span class="token comment">//电机输出轴目前转速,单位为RPM</span>
	<span class="token keyword">float</span> set<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Motor<span class="token punctuation">;</span>

<span class="token keyword">extern</span> Motor motor<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Motor_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">HAL_TIM_PeriodElapsedCallback</span><span class="token punctuation">(</span>TIM_HandleTypeDef <span class="token operator">*</span>htim<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Clockwise_rotation</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Counterclockwise_rotation</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre> 
<p><strong>motor.c：</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"motor.h"</span></span>

Motor motor<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Motor_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">HAL_TIM_Encoder_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span> TIM_CHANNEL_ALL<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//开启编码器定时器</span>
  <span class="token function">__HAL_TIM_ENABLE_IT</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span>TIM_IT_UPDATE<span class="token punctuation">)</span><span class="token punctuation">;</span>         	 <span class="token comment">//开启编码器定时器更新中断,防溢出处理</span>
	<span class="token function">HAL_TIM_Base_Start_IT</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim6<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">//开启10ms定时器中断</span>
	<span class="token function">HAL_TIM_PWM_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim2<span class="token punctuation">,</span> TIM_CHANNEL_1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//开启PWM</span>
	<span class="token function">__HAL_TIM_SET_COUNTER</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//编码器定时器初始值设定为10000</span>
	motor<span class="token punctuation">.</span>loopNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                                   <span class="token comment">//防溢出</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">HAL_TIM_PeriodElapsedCallback</span><span class="token punctuation">(</span>TIM_HandleTypeDef <span class="token operator">*</span>htim<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>htim<span class="token operator">-&gt;</span>Instance<span class="token operator">==</span>htim6<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span>		         <span class="token comment">//10ms中断</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int16_t</span> pluse <span class="token operator">=</span> COUNTERNUM <span class="token operator">-</span> RELOADVALUE<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>											
		motor<span class="token punctuation">.</span>totalAngle <span class="token operator">=</span> pluse <span class="token operator">+</span> motor<span class="token punctuation">.</span>loopNum <span class="token operator">*</span> RELOADVALUE<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>  
		motor<span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>motor<span class="token punctuation">.</span>totalAngle <span class="token operator">-</span> motor<span class="token punctuation">.</span>lastAngle<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">*</span>RR<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6000</span><span class="token punctuation">;</span>			<span class="token comment">//进行速度计算,根据前文所说的,4倍频,编码器13位,减速比30,再乘以6000即为每分钟输出轴多少转</span>
		motor<span class="token punctuation">.</span>lastAngle <span class="token operator">=</span> motor<span class="token punctuation">.</span>totalAngle<span class="token punctuation">;</span>         <span class="token comment">//更新转过的圈数</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>htim<span class="token operator">-&gt;</span>Instance <span class="token operator">==</span> htim1<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span>      <span class="token comment">//如果是编码器更新中断,即10ms内,脉冲数超过了计数范围,需要进行处理</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>COUNTERNUM <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">)</span>	motor<span class="token punctuation">.</span>loopNum<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>COUNTERNUM <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">)</span>	motor<span class="token punctuation">.</span>loopNum<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token function">__HAL_TIM_SetCounter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim1<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//重新设定初始值			</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Clockwise_rotation</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">IN1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">IN2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">__HAL_TIM_SetCompare</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim2<span class="token punctuation">,</span>TIM_CHANNEL_1<span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Counterclockwise_rotation</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">IN1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">IN2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">__HAL_TIM_SetCompare</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim2<span class="token punctuation">,</span>TIM_CHANNEL_1<span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">IN1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">IN2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>关于这两行代码的理解</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">int16_t</span> pluse <span class="token operator">=</span> COUNTERNUM <span class="token operator">-</span> RELOADVALUE<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>											
		motor<span class="token punctuation">.</span>totalAngle <span class="token operator">=</span> pluse <span class="token operator">+</span> motor<span class="token punctuation">.</span>loopNum <span class="token operator">*</span> RELOADVALUE<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>  
</code></pre> 
<p><img src="https://images2.imgbox.com/97/5a/8yueyt05_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="44__326"></a>4.4 接线</h3> 
<p><img src="https://images2.imgbox.com/69/9d/byDOOynS_o.png" alt="|单片机| 电机驱动 ||--|--||PE10|IN1 ||PE12|IN2  ||TIM2_CHANNEL1|ENA  |"></p> 
<p><strong>而且编码器上的AB相也应该接编码器对应的引脚。</strong></p> 
<h3><a id="45__334"></a>4.5 实验效果</h3> 
<p>这里我们波动编码器上的磁盘，可以看到Angle在发生变化。</p> 
<p><img src="https://images2.imgbox.com/bd/bd/G5Fl63iX_o.png" alt="在这里插入图片描述"></p> 
<p>至此，你肯定对电机驱动和编码器，以及简单的操控电机有所了解。后续博客会更新经典控制算法PID的原理和代码。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c4ecfbc9044460bfdd8e7a758d2948e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">泛型(参数化类型)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ccfc0c424c0c35492c7ff966a8ae046b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">rocketmq 安装部署</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>