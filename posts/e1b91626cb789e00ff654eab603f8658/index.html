<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python】人工智能-机器学习——不调库手撕深度网络分类问题 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Python】人工智能-机器学习——不调库手撕深度网络分类问题" />
<meta property="og:description" content="1. 作业内容描述 1.1 背景 数据集大小150该数据有4个属性，分别如下 Sepal.Length：花萼长度(cm)Sepal.Width：花萼宽度单位(cm)Petal.Length：花瓣长度(cm)Petal.Width：花瓣宽度(cm)category：类别（Iris Setosa\Iris Versicolour\Iris Virginica) 1.2 要求 在不调用机器学习库的情况下，使用神经网络模型来预测一个花所属的种类。
2. 作业已完成部分和未完成部分 该作业已经全部完成，没有未完成的部分。全部代码我已经放在GitHub上和colab上了，可以点击下面的链接进行跳转。
GitHub For DNNColab For DNN 3. 作业运行结果截图 最后得出使用深度神经网络的模型预测的准确率为 95.555 % 95.555\% 95.555%
4. 核心代码和步骤 4.1 第一步将数据集读入 4.1.1 原始的数据集 data.txt 部分截图： 稍微进行改动一下（添加了属性列并将格式转换为.csv）
4.1.2 修改后的数据集 data.csv 部分截图 4.1.3 将 data.csv 读入并且将其存入标识符 df 中，定义数据集的筛选条件 expr_1;expr_2;expr_3 expr_1: 用于赛选 Category 属性列为 iris-setosa 的类 sql 语句expr_2: 用于赛选 Category 属性列为 Iris-versicolor 的类 sql 语句expr_3: 用于赛选 Category 属性列为 Iris-virginica 的类 sql 语句" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/e1b91626cb789e00ff654eab603f8658/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-14T12:29:57+08:00" />
<meta property="article:modified_time" content="2023-12-14T12:29:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python】人工智能-机器学习——不调库手撕深度网络分类问题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1__0"></a>1. 作业内容描述</h2> 
<h3><a id="11__1"></a>1.1 背景</h3> 
<ul><li>数据集大小150</li><li>该数据有4个属性，分别如下 
  <ul><li>Sepal.Length：花萼长度(cm)</li><li>Sepal.Width：花萼宽度单位(cm)</li><li>Petal.Length：花瓣长度(cm)</li><li>Petal.Width：花瓣宽度(cm)</li><li>category：类别（Iris Setosa\Iris Versicolour\Iris Virginica)</li></ul> </li></ul> 
<h3><a id="12__9"></a>1.2 要求</h3> 
<p>在不调用机器学习库的情况下，使用神经网络模型来预测一个花所属的种类。</p> 
<h2><a id="2__15"></a>2. 作业已完成部分和未完成部分</h2> 
<p>该作业已经全部完成，没有未完成的部分。全部代码我已经放在GitHub上和colab上了，可以点击下面的链接进行跳转。</p> 
<table><thead><tr><th><img src="https://images2.imgbox.com/38/0f/HzuXz0NB_o.png" alt="在这里插入图片描述" width="120" height="60"></th><th><img src="https://images2.imgbox.com/62/93/p7zH7aKl_o.png" alt="Value" width="120" height="120"></th></tr></thead><tbody><tr><td><a href="https://github.com/hiddenSharp429/DNN-Python">GitHub For DNN</a></td><td><a href="https://colab.research.google.com/drive/1gbArpy5Oy0RGYPrAepD5FcR81HeDmYXz?usp=sharing" rel="nofollow">Colab For DNN</a></td></tr></tbody></table> 
<h2><a id="3__22"></a>3. 作业运行结果截图</h2> 
<p>最后得出使用深度神经网络的模型预测的准确率为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         95.555 
        
       
         % 
        
       
      
        95.555\% 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8056em; vertical-align: -0.0556em;"></span><span class="mord">95.555%</span></span></span></span></span></p> 
<p><img src="https://images2.imgbox.com/c9/0a/u8csr5Ss_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4__27"></a>4. 核心代码和步骤</h2> 
<h3><a id="41__28"></a>4.1 第一步将数据集读入</h3> 
<h4><a id="411__datatxt__29"></a>4.1.1 原始的数据集 data.txt 部分截图：</h4> 
<p><img src="https://images2.imgbox.com/45/32/l8IPBHfV_o.png" alt="在这里插入图片描述" width="300" height="300"><br> 稍微进行改动一下（添加了属性列并将格式转换为.csv）</p> 
<h4><a id="412__datacsv__32"></a>4.1.2 修改后的数据集 data.csv 部分截图</h4> 
<p><img src="https://images2.imgbox.com/92/96/kjVvhOV0_o.png" alt="在这里插入图片描述" width="300" height="300"></p> 
<h4><a id="413__datacsv__df__expr_1expr_2expr_3_34"></a>4.1.3 将 data.csv 读入并且将其存入标识符 df 中，定义数据集的筛选条件 expr_1;expr_2;expr_3</h4> 
<ul><li>expr_1: 用于赛选 Category 属性列为 iris-setosa 的类 sql 语句</li><li>expr_2: 用于赛选 Category 属性列为 Iris-versicolor 的类 sql 语句</li><li>expr_3: 用于赛选 Category 属性列为 Iris-virginica 的类 sql 语句<br> 用上面定义的筛选条件筛选出数据集中三个类别的数据，并分别存入对应的标识符中。</li><li>Iris_setosa_dataframe：所属类别为 Iris-setosa 的全部数据</li><li>Iris_versicolor_dataframe：所属类别为 Iris-versicolor 的全部数据</li><li>Iris_virginica_dataframe：所属类别为 Iris-virginica 的全部数据</li></ul> 
<h4><a id="414__43"></a>4.1.4 代码部分</h4> 
<p><strong>In[1]:</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"data.csv"</span><span class="token punctuation">)</span> <span class="token comment"># 读取全部列表数据</span>

expr_1 <span class="token operator">=</span> <span class="token string">"Category == 'Iris-setosa'"</span> <span class="token comment"># 用于赛选Category属性列为iris-setosa的类sql语句</span>
expr_2 <span class="token operator">=</span> <span class="token string">"Category == 'Iris-versicolor'"</span> <span class="token comment"># 用于赛选Category属性列为Iris-versicolor的类sql语句</span>
expr_3 <span class="token operator">=</span> <span class="token string">"Category == 'Iris-virginica'"</span> <span class="token comment"># 用于赛选Category属性列为Iris-virginica的类sql语句</span>

Iris_setosa_dataframe <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span>expr_1<span class="token punctuation">)</span>
Iris_versicolor_dataframe <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span>expr_2<span class="token punctuation">)</span>
Iris_virginica_dataframe <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span>expr_3<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Iris_setosa_dataframe is:\n"</span><span class="token punctuation">,</span>Iris_setosa_dataframe<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Iris_versicolor_dataframe is\n"</span><span class="token punctuation">,</span>Iris_versicolor_dataframe<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Iris_virginica_dataframe is\n"</span><span class="token punctuation">,</span>Iris_virginica_dataframe<span class="token punctuation">)</span>
</code></pre> 
<br> 
<p><strong>out[1]:</strong></p> 
<pre><code>Iris_setosa_dataframe is:
Sepal.Length Sepal.Width Petal.Length Petal.Width Category
0 5.1 3.5 1.4 0.2 Iris-setosa
1 4.9 3.0 1.4 0.2 Iris-setosa
2 4.7 3.2 1.3 0.2 Iris-setosa
3 4.6 3.1 1.5 0.2 Iris-setosa
4 5.0 3.6 1.4 0.2 Iris-setosa
5 5.4 3.9 1.7 0.4 Iris-setosa
6 4.6 3.4 1.4 0.3 Iris-setosa
7 5.0 3.4 1.5 0.2 Iris-setosa
8 4.4 2.9 1.4 0.2 Iris-setosa
9 4.9 3.1 1.5 0.1 Iris-setosa
10 5.4 3.7 1.5 0.2 Iris-setosa
11 4.8 3.4 1.6 0.2 Iris-setosa
12 4.8 3.0 1.4 0.1 Iris-setosa
13 4.3 3.0 1.1 0.1 Iris-setosa
14 5.8 4.0 1.2 0.2 Iris-setosa
15 5.7 4.4 1.5 0.4 Iris-setosa
16 5.4 3.9 1.3 0.4 Iris-setosa
17 5.1 3.5 1.4 0.3 Iris-setosa
18 5.7 3.8 1.7 0.3 Iris-setosa
19 5.1 3.8 1.5 0.3 Iris-setosa
20 5.4 3.4 1.7 0.2 Iris-setosa
21 5.1 3.7 1.5 0.4 Iris-setosa
22 4.6 3.6 1.0 0.2 Iris-setosa
23 5.1 3.3 1.7 0.5 Iris-setosa
24 4.8 3.4 1.9 0.2 Iris-setosa
25 5.0 3.0 1.6 0.2 Iris-setosa
26 5.0 3.4 1.6 0.4 Iris-setosa
27 5.2 3.5 1.5 0.2 Iris-setosa
28 5.2 3.4 1.4 0.2 Iris-setosa
29 4.7 3.2 1.6 0.2 Iris-setosa
30 4.8 3.1 1.6 0.2 Iris-setosa
31 5.4 3.4 1.5 0.4 Iris-setosa
32 5.2 4.1 1.5 0.1 Iris-setosa
33 5.5 4.2 1.4 0.2 Iris-setosa
34 4.9 3.1 1.5 0.1 Iris-setosa
35 5.0 3.2 1.2 0.2 Iris-setosa
36 5.5 3.5 1.3 0.2 Iris-setosa
37 4.9 3.1 1.5 0.1 Iris-setosa
38 4.4 3.0 1.3 0.2 Iris-setosa
39 5.1 3.4 1.5 0.2 Iris-setosa
40 5.0 3.5 1.3 0.3 Iris-setosa
41 4.5 2.3 1.3 0.3 Iris-setosa
42 4.4 3.2 1.3 0.2 Iris-setosa
43 5.0 3.5 1.6 0.6 Iris-setosa
44 5.1 3.8 1.9 0.4 Iris-setosa
45 4.8 3.0 1.4 0.3 Iris-setosa
46 5.1 3.8 1.6 0.2 Iris-setosa
47 4.6 3.2 1.4 0.2 Iris-setosa
48 5.3 3.7 1.5 0.2 Iris-setosa
49 5.0 3.3 1.4 0.2 Iris-setosa
Iris_versicolor_dataframe is
Sepal.Length Sepal.Width Petal.Length Petal.Width Category
50 7.0 3.2 4.7 1.4 Iris-versicolor
51 6.4 3.2 4.5 1.5 Iris-versicolor
52 6.9 3.1 4.9 1.5 Iris-versicolor
53 5.5 2.3 4.0 1.3 Iris-versicolor
54 6.5 2.8 4.6 1.5 Iris-versicolor
55 5.7 2.8 4.5 1.3 Iris-versicolor
56 6.3 3.3 4.7 1.6 Iris-versicolor
57 4.9 2.4 3.3 1.0 Iris-versicolor
58 6.6 2.9 4.6 1.3 Iris-versicolor
59 5.2 2.7 3.9 1.4 Iris-versicolor
60 5.0 2.0 3.5 1.0 Iris-versicolor
61 5.9 3.0 4.2 1.5 Iris-versicolor
62 6.0 2.2 4.0 1.0 Iris-versicolor
63 6.1 2.9 4.7 1.4 Iris-versicolor
64 5.6 2.9 3.6 1.3 Iris-versicolor
65 6.7 3.1 4.4 1.4 Iris-versicolor
66 5.6 3.0 4.5 1.5 Iris-versicolor
67 5.8 2.7 4.1 1.0 Iris-versicolor
68 6.2 2.2 4.5 1.5 Iris-versicolor
69 5.6 2.5 3.9 1.1 Iris-versicolor
70 5.9 3.2 4.8 1.8 Iris-versicolor
71 6.1 2.8 4.0 1.3 Iris-versicolor
72 6.3 2.5 4.9 1.5 Iris-versicolor
73 6.1 2.8 4.7 1.2 Iris-versicolor
74 6.4 2.9 4.3 1.3 Iris-versicolor
75 6.6 3.0 4.4 1.4 Iris-versicolor
76 6.8 2.8 4.8 1.4 Iris-versicolor
77 6.7 3.0 5.0 1.7 Iris-versicolor
78 6.0 2.9 4.5 1.5 Iris-versicolor
79 5.7 2.6 3.5 1.0 Iris-versicolor
80 5.5 2.4 3.8 1.1 Iris-versicolor
81 5.5 2.4 3.7 1.0 Iris-versicolor
82 5.8 2.7 3.9 1.2 Iris-versicolor
83 6.0 2.7 5.1 1.6 Iris-versicolor
84 5.4 3.0 4.5 1.5 Iris-versicolor
85 6.0 3.4 4.5 1.6 Iris-versicolor
86 6.7 3.1 4.7 1.5 Iris-versicolor
87 6.3 2.3 4.4 1.3 Iris-versicolor
88 5.6 3.0 4.1 1.3 Iris-versicolor
89 5.5 2.5 4.0 1.3 Iris-versicolor
90 5.5 2.6 4.4 1.2 Iris-versicolor
91 6.1 3.0 4.6 1.4 Iris-versicolor
92 5.8 2.6 4.0 1.2 Iris-versicolor
93 5.0 2.3 3.3 1.0 Iris-versicolor
94 5.6 2.7 4.2 1.3 Iris-versicolor
95 5.7 3.0 4.2 1.2 Iris-versicolor
96 5.7 2.9 4.2 1.3 Iris-versicolor
97 6.2 2.9 4.3 1.3 Iris-versicolor
98 5.1 2.5 3.0 1.1 Iris-versicolor
99 5.7 2.8 4.1 1.3 Iris-versicolor
Iris_virginica_dataframe is
Sepal.Length Sepal.Width Petal.Length Petal.Width Category
100 6.3 3.3 6.0 2.5 Iris-virginica
101 5.8 2.7 5.1 1.9 Iris-virginica
102 7.1 3.0 5.9 2.1 Iris-virginica
103 6.3 2.9 5.6 1.8 Iris-virginica
104 6.5 3.0 5.8 2.2 Iris-virginica
105 7.6 3.0 6.6 2.1 Iris-virginica
106 4.9 2.5 4.5 1.7 Iris-virginica
107 7.3 2.9 6.3 1.8 Iris-virginica
108 6.7 2.5 5.8 1.8 Iris-virginica
109 7.2 3.6 6.1 2.5 Iris-virginica
110 6.5 3.2 5.1 2.0 Iris-virginica
111 6.4 2.7 5.3 1.9 Iris-virginica
112 6.8 3.0 5.5 2.1 Iris-virginica
113 5.7 2.5 5.0 2.0 Iris-virginica
114 5.8 2.8 5.1 2.4 Iris-virginica
115 6.4 3.2 5.3 2.3 Iris-virginica
116 6.5 3.0 5.5 1.8 Iris-virginica
117 7.7 3.8 6.7 2.2 Iris-virginica
118 7.7 2.6 6.9 2.3 Iris-virginica
119 6.0 2.2 5.0 1.5 Iris-virginica
120 6.9 3.2 5.7 2.3 Iris-virginica
121 5.6 2.8 4.9 2.0 Iris-virginica
122 7.7 2.8 6.7 2.0 Iris-virginica
123 6.3 2.7 4.9 1.8 Iris-virginica
124 6.7 3.3 5.7 2.1 Iris-virginica
125 7.2 3.2 6.0 1.8 Iris-virginica
126 6.2 2.8 4.8 1.8 Iris-virginica
127 6.1 3.0 4.9 1.8 Iris-virginica
128 6.4 2.8 5.6 2.1 Iris-virginica
129 7.2 3.0 5.8 1.6 Iris-virginica
130 7.4 2.8 6.1 1.9 Iris-virginica
131 7.9 3.8 6.4 2.0 Iris-virginica
132 6.4 2.8 5.6 2.2 Iris-virginica
133 6.3 2.8 5.1 1.5 Iris-virginica
134 6.1 2.6 5.6 1.4 Iris-virginica
135 7.7 3.0 6.1 2.3 Iris-virginica
136 6.3 3.4 5.6 2.4 Iris-virginica
137 6.4 3.1 5.5 1.8 Iris-virginica
138 6.0 3.0 4.8 1.8 Iris-virginica
139 6.9 3.1 5.4 2.1 Iris-virginica
140 6.7 3.1 5.6 2.4 Iris-virginica
141 6.9 3.1 5.1 2.3 Iris-virginica
142 5.8 2.7 5.1 1.9 Iris-virginica
143 6.8 3.2 5.9 2.3 Iris-virginica
144 6.7 3.3 5.7 2.5 Iris-virginica
145 6.7 3.0 5.2 2.3 Iris-virginica
146 6.3 2.5 5.0 1.9 Iris-virginica
147 6.5 3.0 5.2 2.0 Iris-virginica
148 6.2 3.4 5.4 2.3 Iris-virginica
149 5.9 3.0 5.1 1.8 Iris-virginica
</code></pre> 
<h3><a id="42__225"></a>4.2 第二步数据集按照测试集和训练集分类</h3> 
<br> 人为规定训练集占比 0.7，数据集为 0.3 下面将定义一个名为 `get_train_and_test_dataframe` 的函数，并返回训练集和测试集的 DataFrame。 
<br> 
<br> 
<p><strong>In[2]:</strong></p> 
<pre><code class="prism language-python">total_record<span class="token punctuation">,</span> attribute_rows <span class="token operator">=</span> df<span class="token punctuation">.</span>shape <span class="token comment"># 获取总记录条数和其属性列</span>

train_data_rate <span class="token operator">=</span> <span class="token number">0.7</span> <span class="token comment"># 训练集占数据集的比例，即70%</span>
test_data_rate <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> train_data_rate <span class="token comment"># 测试集与训练集为互补集</span>

<span class="token keyword">def</span> <span class="token function">get_train_and_test_dataframe</span><span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> df3<span class="token punctuation">,</span> train_data_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>
    train_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建一个空的dataframe</span>
    test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建一个空的dataframe</span>
    df_array <span class="token operator">=</span> <span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> df3<span class="token punctuation">]</span> <span class="token comment"># 将各个df子集存入一个列表用于变量</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        item_df_record_num<span class="token punctuation">,</span> _ <span class="token operator">=</span> df_array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>shape <span class="token comment"># 获取每个df子集的记录总条数</span>
        item_df_train_record_num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>item_df_record_num<span class="token operator">*</span> train_data_rate<span class="token punctuation">)</span> <span class="token comment"># 计算每个df子集的训练数据总记录条数</span>

        <span class="token comment"># 随机从df子集中抽取数量为 itemDf_trainRecordNum 的记录作为训练集</span>
        train_records <span class="token operator">=</span> df_array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>sample<span class="token punctuation">(</span>item_df_train_record_num<span class="token punctuation">)</span>

        <span class="token comment"># 子集中除去被选出为测试集的其余记录作为测试集</span>
        test_records <span class="token operator">=</span> df_array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">~</span>df_array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">.</span>isin<span class="token punctuation">(</span>train_records<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">]</span>

        <span class="token comment"># 将每个子集中的训练集添加到trainDf中</span>
        train_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>train_df<span class="token punctuation">,</span> train_records<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># 将每个子集中的测试集添加到testDf中</span>
        test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>test_df<span class="token punctuation">,</span> test_records<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> train_df<span class="token punctuation">,</span> test_df
</code></pre> 
<br> 
<br> 
<p><strong>In[3]:</strong></p> 
<pre><code class="prism language-python">
train_data<span class="token punctuation">,</span> test_data <span class="token operator">=</span> get_train_and_test_dataframe<span class="token punctuation">(</span>Iris_setosa_dataframe<span class="token punctuation">,</span> Iris_versicolor_dataframe<span class="token punctuation">,</span> Iris_virginica_dataframe<span class="token punctuation">,</span> train_data_rate<span class="token punctuation">)</span>
</code></pre> 
<br> 
<h3><a id="43__276"></a>4.3 第三步定义深度神经网络和其所需的函数法</h3> 
<h4><a id="431__277"></a>4.3.1 简介</h4> 
<ul><li>该深度神经网络具有两个隐藏层，这两个隐藏层的大小分别为 5 和 4</li><li>除此之外输入层有四个特征值，输出层有三个输出类别，</li><li>大致过程为：用训练集来训练各层的权重 <code>w</code> 和偏移常量 <code>b</code>，单次训练的大小是整个训练集的大小即 105*5, 训练完成后使用测试集的单个测试记录来进行模型评估。</li></ul> 
<p>整个该深度神经网络的形状如下图所示。<br> <img src="https://images2.imgbox.com/be/ed/JvWFg9Hl_o.png" alt="在这里插入图片描述" width="400" height="600"></p> 
<h4><a id="432__284"></a>4.3.2 作用</h4> 
<p>能够通过输入层输入的四个特征值，经过已经训练好的参数进行一层一层的传播，从而在输出<br> 层输出一个所属各个类别概率的列表。</p> 
<h4><a id="433__288"></a>4.3.3 接口说明</h4> 
<p>需要传入下面几个参数:</p> 
<ul><li>X_train: 训练集的特征集</li><li>Y_train: 训练集的结果集（所属类别的哑变量）</li><li>hidden_sizes: 隐藏层的层数以及其对应大小</li><li>num_epochs: 训练次数</li><li>learning_rate：学习效率</li></ul> 
<h4><a id="434__295"></a>4.3.4 返回参数说明</h4> 
<ol><li>trained_parameters：已经训练好的参数</li><li>loss_history：损失函数的变化历史</li></ol> 
<h4><a id="435__299"></a>4.3.5 代码部分</h4> 
<p><strong>In[4]:</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 定义激活函数sigomid</span>
<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 定义softmax函数</span>
<span class="token keyword">def</span> <span class="token function">softmax</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    exp_z <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>z <span class="token operator">-</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> exp_z <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>exp_z<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 初始化参数</span>
<span class="token keyword">def</span> <span class="token function">initialize_parameters</span><span class="token punctuation">(</span>input_size<span class="token punctuation">,</span> hidden_sizes<span class="token punctuation">,</span> output_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sizes <span class="token operator">=</span> <span class="token punctuation">[</span>input_size<span class="token punctuation">]</span> <span class="token operator">+</span> hidden_sizes <span class="token operator">+</span> <span class="token punctuation">[</span>output_size<span class="token punctuation">]</span> <span class="token comment"># 使用列表拼接，将输入层的大小，隐藏层大小列表，输出层大小全部放入一个列表里</span>
    parameters <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token comment"># 定义一个空的参数字典</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sizes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 从1循环到sizes的大小减一</span>
        parameters<span class="token punctuation">[</span><span class="token string">'W'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>sizes<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.01</span> <span class="token comment"># 随机生成每层的权重矩阵</span>
        parameters<span class="token punctuation">[</span><span class="token string">'b'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 初始化每层的偏移矩阵</span>

    <span class="token keyword">return</span> parameters

<span class="token comment"># 前向传播</span>
<span class="token keyword">def</span> <span class="token function">forward_propagation</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cache <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'A0'</span><span class="token punctuation">:</span> X<span class="token punctuation">}</span>
    <span class="token comment"># print("init cache:", cache)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        cache<span class="token punctuation">[</span><span class="token string">'Z'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">'W'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> parameters<span class="token punctuation">[</span><span class="token string">'b'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>
        cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>cache<span class="token punctuation">[</span><span class="token string">'Z'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># 输出层不使用sigmoid激活函数</span>
    cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">'W'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> parameters<span class="token punctuation">[</span><span class="token string">'b'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    cache<span class="token punctuation">[</span><span class="token string">'O'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> softmax<span class="token punctuation">(</span>cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># print('final cache:', cache)</span>
    <span class="token keyword">return</span> cache

<span class="token comment"># 计算交叉熵损失</span>
<span class="token keyword">def</span> <span class="token function">compute_loss</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span> Y_hat<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> Y<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 获取Y的样本数</span>
    epsilon <span class="token operator">=</span> <span class="token number">1e-8</span>  <span class="token comment"># 微小常数，用于数值稳定性，防止出现0的情况</span>
    loss <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>Y <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>Y_hat <span class="token operator">+</span> epsilon<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 将总损失除以样本数m，得到平均损失。负号表示最小化损失。</span>
    <span class="token keyword">return</span> loss

<span class="token comment"># 反向传播</span>
<span class="token keyword">def</span> <span class="token function">backward_propagation</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> parameters<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 获取样本数</span>

    grads <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>  <span class="token comment"># 初始化梯度字典</span>

    <span class="token comment"># 计算输出层的梯度</span>
    dZ_last <span class="token operator">=</span> cache<span class="token punctuation">[</span><span class="token string">'O'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-</span> Y  <span class="token comment"># 计算输出层激活值的梯度</span>
    grads<span class="token punctuation">[</span><span class="token string">'dW'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span> dZ_last<span class="token punctuation">)</span>  <span class="token comment"># 计算输出层权重的梯度</span>
    grads<span class="token punctuation">[</span><span class="token string">'db'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dZ_last<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 计算输出层偏差的梯度</span>

    dZ <span class="token operator">=</span> dZ_last  <span class="token comment"># 初始化激活值梯度</span>

    <span class="token comment"># 循环计算隐藏层的梯度</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        dA <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">'W'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>  <span class="token comment"># 计算上一层激活值的梯度</span>
        dZ <span class="token operator">=</span> dA <span class="token operator">*</span> cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 计算当前层激活值的梯度</span>
        grads<span class="token punctuation">[</span><span class="token string">'dW'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>cache<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span> dZ<span class="token punctuation">)</span>  <span class="token comment"># 计算当前层权重的梯度</span>
        grads<span class="token punctuation">[</span><span class="token string">'db'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 计算当前层偏差的梯度</span>

    <span class="token keyword">return</span> grads  <span class="token comment"># 返回计算得到的梯度字典</span>



<span class="token comment"># 更新参数</span>
<span class="token keyword">def</span> <span class="token function">update_parameters</span><span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> grads<span class="token punctuation">,</span> learning_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        parameters<span class="token punctuation">[</span><span class="token string">'W'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> learning_rate <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token string">'dW'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>
        parameters<span class="token punctuation">[</span><span class="token string">'b'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">-=</span> learning_rate <span class="token operator">*</span> grads<span class="token punctuation">[</span><span class="token string">'db'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token keyword">return</span> parameters

<span class="token comment"># 模型训练</span>
<span class="token keyword">def</span> <span class="token function">train_neural_network</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> hidden_sizes<span class="token punctuation">,</span> num_epochs<span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    input_size <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 训练集的特征数量（有多少个属性列）</span>
    output_size <span class="token operator">=</span> Y<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 期望输出（预测）的所属类型的个数（有多少个类型）</span>

    parameters <span class="token operator">=</span> initialize_parameters<span class="token punctuation">(</span>input_size<span class="token punctuation">,</span> hidden_sizes<span class="token punctuation">,</span> output_size<span class="token punctuation">)</span> <span class="token comment"># 初始化权重w和偏移量b</span>

    loss_history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 定义空列表来记录损失函数的状态</span>

    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 前向传播</span>
        cache <span class="token operator">=</span> forward_propagation<span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span>
        Y_hat <span class="token operator">=</span> cache<span class="token punctuation">[</span><span class="token string">'O'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

        <span class="token comment"># 计算损失</span>
        loss <span class="token operator">=</span> compute_loss<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> Y_hat<span class="token punctuation">)</span>
        loss_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>

        <span class="token comment"># 反向传播</span>
        grads <span class="token operator">=</span> backward_propagation<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> parameters<span class="token punctuation">,</span> cache<span class="token punctuation">)</span>

        <span class="token comment"># 更新参数</span>
        parameters <span class="token operator">=</span> update_parameters<span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> grads<span class="token punctuation">,</span> learning_rate<span class="token punctuation">)</span>

        <span class="token comment"># 打印损失</span>
        <span class="token keyword">if</span> epoch <span class="token operator">%</span> <span class="token number">2000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token punctuation">}</span></span><span class="token string">, Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>loss<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>


    <span class="token keyword">return</span> parameters<span class="token punctuation">,</span> loss_history
</code></pre> 
<h3><a id="44__414"></a>4.4 第四步定义验证和打印函数</h3> 
<h4><a id="441__415"></a>4.4.1 简介</h4> 
<p><code>verify</code>函数是每次循环测试记录时需要调用的，可以用来打印结果和验证是否预测正确。</p> 
<h4><a id="442__417"></a>4.4.2 入口参数说明</h4> 
<ul><li>index：测试记录在数据集中的索引</li><li>p_catagory：该测试记录经过贝叶斯分类后返回的结果（属于各类别的概率）</li><li>real_category：该测试记录真实所属类别</li><li>record_num：已经遍历测试记录的数量</li><li>correct_num：已经遍历测试记录并且预测结果为正确的数量</li><li>correct_rate：该模型的正确率</li></ul> 
<h4><a id="443__425"></a>4.4.3 返回参数说明</h4> 
<ul><li>correct_num：同上</li><li>correct_rate：同上</li></ul> 
<h4><a id="444__429"></a>4.4.4 代码部分</h4> 
<p><strong>In[5]:</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> p_catagory<span class="token punctuation">,</span> real_category<span class="token punctuation">,</span> record_num<span class="token punctuation">,</span> correct_num<span class="token punctuation">,</span> correct_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试结果已出，该测试记录所属类别的概率为\n"</span><span class="token punctuation">,</span>p_category<span class="token punctuation">)</span> <span class="token comment"># 打印该记录所对应类别的概率</span>
    max_probability <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>p_category<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 获取最大的概率值</span>

    <span class="token keyword">for</span> key<span class="token punctuation">,</span> key_value <span class="token keyword">in</span> p_category<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 寻找概率最大的类别</span>
        <span class="token keyword">if</span> key_value <span class="token operator">==</span> max_probability<span class="token punctuation">:</span> <span class="token comment">## 找到概率最大的类别</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span></span><span class="token string">记录的预测最可能的所属类别为:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span></span><span class="token string">记录的真实属性为:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>real_category<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> key <span class="token operator">==</span> real_category<span class="token punctuation">:</span> <span class="token comment">## 查看预测的类别和真实的类别是否一样</span>
                correct_num <span class="token operator">=</span> correct_num <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 若一样则correct_num++</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------------------------"</span><span class="token punctuation">)</span>

    correct_rate <span class="token operator">=</span> correct_num <span class="token operator">/</span> record_num <span class="token comment"># 计算新的正确率</span>
    <span class="token keyword">return</span> correct_num<span class="token punctuation">,</span> correct_rate
</code></pre> 
<h3><a id="45__450"></a>4.5 第五步将训练集数据放入深度神经网络中训练</h3> 
<p><strong>In[6]:</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 提取训练集特征和标签</span>
X_train <span class="token operator">=</span> train_data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
Y_train <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token string">'Category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values

<span class="token comment"># 训练神经网络</span>
trained_parameters<span class="token punctuation">,</span> loss_history <span class="token operator">=</span> train_neural_network<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> hidden_sizes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> num_epochs<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.09</span><span class="token punctuation">)</span>

<span class="token comment"># 展示loss的折线图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>loss_history<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Loss Over Epochs'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Epoch'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<br> 
<br> 
<p><strong>out[6]:</strong></p> 
<pre><code>Epoch 0, Loss: 1.0986374636813678
Epoch 2000, Loss: 1.0986098115977763
Epoch 4000, Loss: 1.0985974991821654
Epoch 6000, Loss: 1.0979638994470924
Epoch 8000, Loss: 0.3051250142896731
Epoch 10000, Loss: 0.09047674524698732
Epoch 12000, Loss: 0.06427539824439313
Epoch 14000, Loss: 0.05738894582331716
Epoch 16000, Loss: 0.05422622522965926
Epoch 18000, Loss: 0.052323171513319895
Epoch 20000, Loss: 0.050989527225192836
Epoch 22000, Loss: 0.04995500647173487
Epoch 24000, Loss: 0.04908545311867662
Epoch 26000, Loss: 0.048302169206777316
Epoch 28000, Loss: 0.04755683502388777
Epoch 30000, Loss: 0.04682381035782021
Epoch 32000, Loss: 0.04609479360679712
Epoch 34000, Loss: 0.045371734234237376
Epoch 36000, Loss: 0.04466000953822288
Epoch 38000, Loss: 0.043963956316713244
Epoch 40000, Loss: 0.04328524335321981
Epoch 42000, Loss: 0.042623351179843484
Epoch 44000, Loss: 0.041976754101067736
Epoch 46000, Loss: 0.04134382847704943
Epoch 48000, Loss: 0.040723316848883334
Epoch 50000, Loss: 0.040114532246993004
Epoch 52000, Loss: 0.03951746513256648
Epoch 54000, Loss: 0.03893284700966053
Epoch 56000, Loss: 0.038362146671127625
Epoch 58000, Loss: 0.0378074459549261
Epoch 60000, Loss: 0.037271164594935534
Epoch 62000, Loss: 0.03675567096214186
Epoch 64000, Loss: 0.036262888491245114
Epoch 66000, Loss: 0.0357940258522333
Epoch 68000, Loss: 0.03534949830432913
Epoch 70000, Loss: 0.03492901608330322
Epoch 72000, Loss: 0.034531761988498534
Epoch 74000, Loss: 0.034156583734556774
Epoch 76000, Loss: 0.033802158226160436
Epoch 78000, Loss: 0.03346711379140615
Epoch 80000, Loss: 0.03315011215846706
Epoch 82000, Loss: 0.03284989755621375
Epoch 84000, Loss: 0.03256532097901557
Epoch 86000, Loss: 0.03229534661051307
Epoch 88000, Loss: 0.03219234060425748
Epoch 90000, Loss: 0.03201415844578465
Epoch 92000, Loss: 0.03182184539911233
Epoch 94000, Loss: 0.03163239691494281
Epoch 96000, Loss: 0.031446408554093044
Epoch 98000, Loss: 0.031264326953139694
</code></pre> 
<p><img src="https://images2.imgbox.com/29/bb/KgFyFPaf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="46__526"></a>4.6 第六步将测试集数据放入神经网络中验证是否正确</h3> 
<p><strong>In[7]:</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 提取测试集特征和标签</span>
X_test <span class="token operator">=</span> test_data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
Y_test <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token string">'Category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values

<span class="token comment"># 初始化参数</span>
correct_rate <span class="token operator">=</span> <span class="token number">0</span>
correct_num <span class="token operator">=</span> <span class="token number">0</span>
record_num <span class="token operator">=</span> <span class="token number">0</span>
class_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Iris-setosa'</span><span class="token punctuation">,</span> <span class="token string">'Iris-versicolor'</span><span class="token punctuation">,</span> <span class="token string">'Iris-virginica'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> index<span class="token punctuation">,</span> record <span class="token keyword">in</span> test_data<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    record_num <span class="token operator">=</span> record_num <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment"># 所遍历的测试记录条数+1</span>

    Category <span class="token operator">=</span> record<span class="token punctuation">[</span><span class="token string">'Category'</span><span class="token punctuation">]</span> <span class="token comment"># 获取当前测试记录的真实所属类别</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'记录:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span></span><span class="token string">, 所属类别:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>Category<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

    record_x <span class="token operator">=</span> <span class="token punctuation">[</span>record<span class="token punctuation">[</span><span class="token string">'Sepal.Length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> record<span class="token punctuation">[</span><span class="token string">'Sepal.Width'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> record<span class="token punctuation">[</span><span class="token string">'Petal.Length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> record<span class="token punctuation">[</span><span class="token string">'Petal.Width'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 将当前测试记录的所有特征值合并成一个列表</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>record_x<span class="token punctuation">)</span>

    record_x_cache <span class="token operator">=</span> forward_propagation<span class="token punctuation">(</span>record_x<span class="token punctuation">,</span> trained_parameters<span class="token punctuation">)</span> <span class="token comment"># 调用深度神经网络进行测试，返回一个字典</span>
    result_y <span class="token operator">=</span> record_x_cache<span class="token punctuation">[</span><span class="token string">'O'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>trained_parameters<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 用result_y来接收输出层的数据，具体形式是一个概率数组</span>
    p_category <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>label<span class="token punctuation">:</span> value <span class="token keyword">for</span> label<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>class_labels<span class="token punctuation">,</span> result_y<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment"># 将概率数组拓广到字典，即原本的概率列表变成一个概率字典（键值对）</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p_category<span class="token punctuation">)</span>

    correct_num<span class="token punctuation">,</span> correct_rate <span class="token operator">=</span> verify<span class="token punctuation">(</span>index<span class="token punctuation">,</span> p_category<span class="token punctuation">,</span> Category<span class="token punctuation">,</span> record_num<span class="token punctuation">,</span> correct_num<span class="token punctuation">,</span> correct_rate<span class="token punctuation">)</span> <span class="token comment"># 更新正确条数和正确率</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'该模型的预测准确率为:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>correct_rate<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

</code></pre> 
<br> 
<br> 
<p><strong>out[7]:</strong></p> 
<pre><code>记录:9, 所属类别:Iris-setosa
[4.9, 3.1, 1.5, 0.1]
{'Iris-setosa': 0.9994073024809125, 'Iris-versicolor': 0.0005926974101059076, 'Iris-virginica': 1.089814284856423e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9994073024809125, 'Iris-versicolor': 0.0005926974101059076, 'Iris-virginica': 1.089814284856423e-10}
第9记录的预测最可能的所属类别为:Iris-setosa
第9记录的真实属性为:Iris-setosa
-------------------------
记录:10, 所属类别:Iris-setosa
[5.4, 3.7, 1.5, 0.2]
{'Iris-setosa': 0.9994194567509896, 'Iris-versicolor': 0.0005805431416654768, 'Iris-virginica': 1.0734484569031509e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9994194567509896, 'Iris-versicolor': 0.0005805431416654768, 'Iris-virginica': 1.0734484569031509e-10}
第10记录的预测最可能的所属类别为:Iris-setosa
第10记录的真实属性为:Iris-setosa
-------------------------
记录:13, 所属类别:Iris-setosa
[4.3, 3.0, 1.1, 0.1]
{'Iris-setosa': 0.9994344552564192, 'Iris-versicolor': 0.0005655446415884805, 'Iris-virginica': 1.0199248245814307e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9994344552564192, 'Iris-versicolor': 0.0005655446415884805, 'Iris-virginica': 1.0199248245814307e-10}
第13记录的预测最可能的所属类别为:Iris-setosa
第13记录的真实属性为:Iris-setosa
-------------------------
记录:14, 所属类别:Iris-setosa
[5.8, 4.0, 1.2, 0.2]
{'Iris-setosa': 0.9993839003436563, 'Iris-versicolor': 0.0006160995360430794, 'Iris-virginica': 1.203005937453023e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9993839003436563, 'Iris-versicolor': 0.0006160995360430794, 'Iris-virginica': 1.203005937453023e-10}
第14记录的预测最可能的所属类别为:Iris-setosa
第14记录的真实属性为:Iris-setosa
-------------------------
记录:15, 所属类别:Iris-setosa
[5.7, 4.4, 1.5, 0.4]
{'Iris-setosa': 0.9993971683516336, 'Iris-versicolor': 0.0006028315327860123, 'Iris-virginica': 1.1558054531504385e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9993971683516336, 'Iris-versicolor': 0.0006028315327860123, 'Iris-virginica': 1.1558054531504385e-10}
第15记录的预测最可能的所属类别为:Iris-setosa
第15记录的真实属性为:Iris-setosa
-------------------------
记录:16, 所属类别:Iris-setosa
[5.4, 3.9, 1.3, 0.4]
{'Iris-setosa': 0.9993562667737085, 'Iris-versicolor': 0.0006437330976151712, 'Iris-virginica': 1.28676261460329e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9993562667737085, 'Iris-versicolor': 0.0006437330976151712, 'Iris-virginica': 1.28676261460329e-10}
第16记录的预测最可能的所属类别为:Iris-setosa
第16记录的真实属性为:Iris-setosa
-------------------------
记录:23, 所属类别:Iris-setosa
[5.1, 3.3, 1.7, 0.5]
{'Iris-setosa': 0.9992156354832021, 'Iris-versicolor': 0.000784364351532988, 'Iris-virginica': 1.652649064805943e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9992156354832021, 'Iris-versicolor': 0.000784364351532988, 'Iris-virginica': 1.652649064805943e-10}
第23记录的预测最可能的所属类别为:Iris-setosa
第23记录的真实属性为:Iris-setosa
-------------------------
记录:26, 所属类别:Iris-setosa
[5.0, 3.4, 1.6, 0.4]
{'Iris-setosa': 0.9993422506434927, 'Iris-versicolor': 0.0006577492281176229, 'Iris-virginica': 1.2838960352069869e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9993422506434927, 'Iris-versicolor': 0.0006577492281176229, 'Iris-virginica': 1.2838960352069869e-10}
第26记录的预测最可能的所属类别为:Iris-setosa
第26记录的真实属性为:Iris-setosa
-------------------------
记录:28, 所属类别:Iris-setosa
[5.2, 3.4, 1.4, 0.2]
{'Iris-setosa': 0.9994022919498919, 'Iris-versicolor': 0.0005977079379210146, 'Iris-virginica': 1.1218683099221791e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9994022919498919, 'Iris-versicolor': 0.0005977079379210146, 'Iris-virginica': 1.1218683099221791e-10}
第28记录的预测最可能的所属类别为:Iris-setosa
第28记录的真实属性为:Iris-setosa
-------------------------
记录:37, 所属类别:Iris-setosa
[4.9, 3.1, 1.5, 0.1]
{'Iris-setosa': 0.9994073024809125, 'Iris-versicolor': 0.0005926974101059076, 'Iris-virginica': 1.089814284856423e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9994073024809125, 'Iris-versicolor': 0.0005926974101059076, 'Iris-virginica': 1.089814284856423e-10}
第37记录的预测最可能的所属类别为:Iris-setosa
第37记录的真实属性为:Iris-setosa
-------------------------
记录:41, 所属类别:Iris-setosa
[4.5, 2.3, 1.3, 0.3]
{'Iris-setosa': 0.9990698970091187, 'Iris-versicolor': 0.0009301027868999484, 'Iris-virginica': 2.03981361107607e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9990698970091187, 'Iris-versicolor': 0.0009301027868999484, 'Iris-virginica': 2.03981361107607e-10}
第41记录的预测最可能的所属类别为:Iris-setosa
第41记录的真实属性为:Iris-setosa
-------------------------
记录:43, 所属类别:Iris-setosa
[5.0, 3.5, 1.6, 0.6]
{'Iris-setosa': 0.9992318991352795, 'Iris-versicolor': 0.0007681007014263888, 'Iris-virginica': 1.6329400930324945e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9992318991352795, 'Iris-versicolor': 0.0007681007014263888, 'Iris-virginica': 1.6329400930324945e-10}
第43记录的预测最可能的所属类别为:Iris-setosa
第43记录的真实属性为:Iris-setosa
-------------------------
记录:44, 所属类别:Iris-setosa
[5.1, 3.8, 1.9, 0.4]
{'Iris-setosa': 0.9993864980408808, 'Iris-versicolor': 0.0006135018444908369, 'Iris-virginica': 1.146282328612296e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9993864980408808, 'Iris-versicolor': 0.0006135018444908369, 'Iris-virginica': 1.146282328612296e-10}
第44记录的预测最可能的所属类别为:Iris-setosa
第44记录的真实属性为:Iris-setosa
-------------------------
记录:45, 所属类别:Iris-setosa
[4.8, 3.0, 1.4, 0.3]
{'Iris-setosa': 0.9993337339145498, 'Iris-versicolor': 0.0006662659548606306, 'Iris-virginica': 1.3058942609729524e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.9993337339145498, 'Iris-versicolor': 0.0006662659548606306, 'Iris-virginica': 1.3058942609729524e-10}
第45记录的预测最可能的所属类别为:Iris-setosa
第45记录的真实属性为:Iris-setosa
-------------------------
记录:46, 所属类别:Iris-setosa
[5.1, 3.8, 1.6, 0.2]
{'Iris-setosa': 0.999441154585264, 'Iris-versicolor': 0.0005588453143751629, 'Iris-virginica': 1.0036090050646012e-10}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.999441154585264, 'Iris-versicolor': 0.0005588453143751629, 'Iris-virginica': 1.0036090050646012e-10}
第46记录的预测最可能的所属类别为:Iris-setosa
第46记录的真实属性为:Iris-setosa
-------------------------
记录:52, 所属类别:Iris-versicolor
[6.9, 3.1, 4.9, 1.5]
{'Iris-setosa': 0.00034673300859923385, 'Iris-versicolor': 0.9996312297167484, 'Iris-virginica': 2.203727465222196e-05}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.00034673300859923385, 'Iris-versicolor': 0.9996312297167484, 'Iris-virginica': 2.203727465222196e-05}
第52记录的预测最可能的所属类别为:Iris-versicolor
第52记录的真实属性为:Iris-versicolor
-------------------------
记录:57, 所属类别:Iris-versicolor
[4.9, 2.4, 3.3, 1.0]
{'Iris-setosa': 0.0011225847462562426, 'Iris-versicolor': 0.998874153393992, 'Iris-virginica': 3.261859751878275e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.0011225847462562426, 'Iris-versicolor': 0.998874153393992, 'Iris-virginica': 3.261859751878275e-06}
第57记录的预测最可能的所属类别为:Iris-versicolor
第57记录的真实属性为:Iris-versicolor
-------------------------
记录:60, 所属类别:Iris-versicolor
[5.0, 2.0, 3.5, 1.0]
{'Iris-setosa': 0.000699627908179903, 'Iris-versicolor': 0.9992955250491328, 'Iris-virginica': 4.8470426874968965e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.000699627908179903, 'Iris-versicolor': 0.9992955250491328, 'Iris-virginica': 4.8470426874968965e-06}
第60记录的预测最可能的所属类别为:Iris-versicolor
第60记录的真实属性为:Iris-versicolor
-------------------------
记录:67, 所属类别:Iris-versicolor
[5.8, 2.7, 4.1, 1.0]
{'Iris-setosa': 0.0006969336614828119, 'Iris-versicolor': 0.9992982666461563, 'Iris-virginica': 4.799692360888943e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.0006969336614828119, 'Iris-versicolor': 0.9992982666461563, 'Iris-virginica': 4.799692360888943e-06}
第67记录的预测最可能的所属类别为:Iris-versicolor
第67记录的真实属性为:Iris-versicolor
-------------------------
记录:70, 所属类别:Iris-versicolor
[5.9, 3.2, 4.8, 1.8]
{'Iris-setosa': 8.092532228554832e-07, 'Iris-versicolor': 0.04124258002202099, 'Iris-virginica': 0.9587566107247563}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 8.092532228554832e-07, 'Iris-versicolor': 0.04124258002202099, 'Iris-virginica': 0.9587566107247563}
第70记录的预测最可能的所属类别为:Iris-virginica
第70记录的真实属性为:Iris-versicolor
-------------------------
记录:75, 所属类别:Iris-versicolor
[6.6, 3.0, 4.4, 1.4]
{'Iris-setosa': 0.0004904963785951448, 'Iris-versicolor': 0.9995006634330806, 'Iris-virginica': 8.840188324211333e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.0004904963785951448, 'Iris-versicolor': 0.9995006634330806, 'Iris-virginica': 8.840188324211333e-06}
第75记录的预测最可能的所属类别为:Iris-versicolor
第75记录的真实属性为:Iris-versicolor
-------------------------
记录:76, 所属类别:Iris-versicolor
[6.8, 2.8, 4.8, 1.4]
{'Iris-setosa': 0.0003802333354495639, 'Iris-versicolor': 0.9996035606243237, 'Iris-virginica': 1.6206040226774196e-05}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.0003802333354495639, 'Iris-versicolor': 0.9996035606243237, 'Iris-virginica': 1.6206040226774196e-05}
第76记录的预测最可能的所属类别为:Iris-versicolor
第76记录的真实属性为:Iris-versicolor
-------------------------
记录:78, 所属类别:Iris-versicolor
[6.0, 2.9, 4.5, 1.5]
{'Iris-setosa': 0.00021263981498677786, 'Iris-versicolor': 0.9996074531085687, 'Iris-virginica': 0.000179907076444516}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.00021263981498677786, 'Iris-versicolor': 0.9996074531085687, 'Iris-virginica': 0.000179907076444516}
第78记录的预测最可能的所属类别为:Iris-versicolor
第78记录的真实属性为:Iris-versicolor
-------------------------
记录:79, 所属类别:Iris-versicolor
[5.7, 2.6, 3.5, 1.0]
{'Iris-setosa': 0.0014117930910004294, 'Iris-versicolor': 0.9985851980770214, 'Iris-virginica': 3.0088319782903333e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.0014117930910004294, 'Iris-versicolor': 0.9985851980770214, 'Iris-virginica': 3.0088319782903333e-06}
第79记录的预测最可能的所属类别为:Iris-versicolor
第79记录的真实属性为:Iris-versicolor
-------------------------
记录:81, 所属类别:Iris-versicolor
[5.5, 2.4, 3.7, 1.0]
{'Iris-setosa': 0.0008627167806437697, 'Iris-versicolor': 0.9991333416086959, 'Iris-virginica': 3.941610660265416e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.0008627167806437697, 'Iris-versicolor': 0.9991333416086959, 'Iris-virginica': 3.941610660265416e-06}
第81记录的预测最可能的所属类别为:Iris-versicolor
第81记录的真实属性为:Iris-versicolor
-------------------------
记录:84, 所属类别:Iris-versicolor
[5.4, 3.0, 4.5, 1.5]
{'Iris-setosa': 4.914358190106048e-05, 'Iris-versicolor': 0.881793576222092, 'Iris-virginica': 0.11815728019600699}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 4.914358190106048e-05, 'Iris-versicolor': 0.881793576222092, 'Iris-virginica': 0.11815728019600699}
第84记录的预测最可能的所属类别为:Iris-versicolor
第84记录的真实属性为:Iris-versicolor
-------------------------
记录:89, 所属类别:Iris-versicolor
[5.5, 2.5, 4.0, 1.3]
{'Iris-setosa': 0.00043234470441415025, 'Iris-versicolor': 0.999555742853914, 'Iris-virginica': 1.1912441671869986e-05}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.00043234470441415025, 'Iris-versicolor': 0.999555742853914, 'Iris-virginica': 1.1912441671869986e-05}
第89记录的预测最可能的所属类别为:Iris-versicolor
第89记录的真实属性为:Iris-versicolor
-------------------------
记录:94, 所属类别:Iris-versicolor
[5.6, 2.7, 4.2, 1.3]
{'Iris-setosa': 0.00033893326798138754, 'Iris-versicolor': 0.9996339971676897, 'Iris-virginica': 2.7069564329036698e-05}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.00033893326798138754, 'Iris-versicolor': 0.9996339971676897, 'Iris-virginica': 2.7069564329036698e-05}
第94记录的预测最可能的所属类别为:Iris-versicolor
第94记录的真实属性为:Iris-versicolor
-------------------------
记录:95, 所属类别:Iris-versicolor
[5.7, 3.0, 4.2, 1.2]
{'Iris-setosa': 0.00047520993314104494, 'Iris-versicolor': 0.9995150352793134, 'Iris-virginica': 9.754787545568637e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.00047520993314104494, 'Iris-versicolor': 0.9995150352793134, 'Iris-virginica': 9.754787545568637e-06}
第95记录的预测最可能的所属类别为:Iris-versicolor
第95记录的真实属性为:Iris-versicolor
-------------------------
记录:99, 所属类别:Iris-versicolor
[5.7, 2.8, 4.1, 1.3]
{'Iris-setosa': 0.00048434746193381145, 'Iris-versicolor': 0.9995065789295492, 'Iris-virginica': 9.073608517006889e-06}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 0.00048434746193381145, 'Iris-versicolor': 0.9995065789295492, 'Iris-virginica': 9.073608517006889e-06}
第99记录的预测最可能的所属类别为:Iris-versicolor
第99记录的真实属性为:Iris-versicolor
-------------------------
记录:101, 所属类别:Iris-virginica
[5.8, 2.7, 5.1, 1.9]
{'Iris-setosa': 6.230993565240641e-08, 'Iris-versicolor': 0.004904991357197354, 'Iris-virginica': 0.995094946332867}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 6.230993565240641e-08, 'Iris-versicolor': 0.004904991357197354, 'Iris-virginica': 0.995094946332867}
第101记录的预测最可能的所属类别为:Iris-virginica
第101记录的真实属性为:Iris-virginica
-------------------------
记录:104, 所属类别:Iris-virginica
[6.5, 3.0, 5.8, 2.2]
{'Iris-setosa': 3.1285347946103443e-09, 'Iris-versicolor': 0.0004093612664117814, 'Iris-virginica': 0.9995906356050535}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 3.1285347946103443e-09, 'Iris-versicolor': 0.0004093612664117814, 'Iris-virginica': 0.9995906356050535}
第104记录的预测最可能的所属类别为:Iris-virginica
第104记录的真实属性为:Iris-virginica
-------------------------
记录:105, 所属类别:Iris-virginica
[7.6, 3.0, 6.6, 2.1]
{'Iris-setosa': 4.518643270279261e-09, 'Iris-versicolor': 0.0005552351498570809, 'Iris-virginica': 0.9994447603314996}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 4.518643270279261e-09, 'Iris-versicolor': 0.0005552351498570809, 'Iris-virginica': 0.9994447603314996}
第105记录的预测最可能的所属类别为:Iris-virginica
第105记录的真实属性为:Iris-virginica
-------------------------
记录:108, 所属类别:Iris-virginica
[6.7, 2.5, 5.8, 1.8]
{'Iris-setosa': 8.268626469165646e-08, 'Iris-versicolor': 0.006206423895269242, 'Iris-virginica': 0.993793493418466}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 8.268626469165646e-08, 'Iris-versicolor': 0.006206423895269242, 'Iris-virginica': 0.993793493418466}
第108记录的预测最可能的所属类别为:Iris-virginica
第108记录的真实属性为:Iris-virginica
-------------------------
记录:111, 所属类别:Iris-virginica
[6.4, 2.7, 5.3, 1.9]
{'Iris-setosa': 9.976341957164077e-09, 'Iris-versicolor': 0.0010721415234597504, 'Iris-virginica': 0.9989278485001982}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 9.976341957164077e-09, 'Iris-versicolor': 0.0010721415234597504, 'Iris-virginica': 0.9989278485001982}
第111记录的预测最可能的所属类别为:Iris-virginica
第111记录的真实属性为:Iris-virginica
-------------------------
记录:117, 所属类别:Iris-virginica
[7.7, 3.8, 6.7, 2.2]
{'Iris-setosa': 1.3832457944150949e-08, 'Iris-versicolor': 0.0014048982490742054, 'Iris-virginica': 0.9985950879184678}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 1.3832457944150949e-08, 'Iris-versicolor': 0.0014048982490742054, 'Iris-virginica': 0.9985950879184678}
第117记录的预测最可能的所属类别为:Iris-virginica
第117记录的真实属性为:Iris-virginica
-------------------------
记录:122, 所属类别:Iris-virginica
[7.7, 2.8, 6.7, 2.0]
{'Iris-setosa': 1.0114546252578506e-08, 'Iris-versicolor': 0.001083446341577254, 'Iris-virginica': 0.9989165435438766}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 1.0114546252578506e-08, 'Iris-versicolor': 0.001083446341577254, 'Iris-virginica': 0.9989165435438766}
第122记录的预测最可能的所属类别为:Iris-virginica
第122记录的真实属性为:Iris-virginica
-------------------------
记录:126, 所属类别:Iris-virginica
[6.2, 2.8, 4.8, 1.8]
{'Iris-setosa': 1.211053511352366e-06, 'Iris-versicolor': 0.05826189317047926, 'Iris-virginica': 0.9417368957760094}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 1.211053511352366e-06, 'Iris-versicolor': 0.05826189317047926, 'Iris-virginica': 0.9417368957760094}
第126记录的预测最可能的所属类别为:Iris-virginica
第126记录的真实属性为:Iris-virginica
-------------------------
记录:128, 所属类别:Iris-virginica
[6.4, 2.8, 5.6, 2.1]
{'Iris-setosa': 3.5398422692944902e-09, 'Iris-versicolor': 0.0004535013010799169, 'Iris-virginica': 0.9995464951590779}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 3.5398422692944902e-09, 'Iris-versicolor': 0.0004535013010799169, 'Iris-virginica': 0.9995464951590779}
第128记录的预测最可能的所属类别为:Iris-virginica
第128记录的真实属性为:Iris-virginica
-------------------------
记录:129, 所属类别:Iris-virginica
[7.2, 3.0, 5.8, 1.6]
{'Iris-setosa': 2.9681892387650685e-06, 'Iris-versicolor': 0.12000192448513033, 'Iris-virginica': 0.8799951073256309}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 2.9681892387650685e-06, 'Iris-versicolor': 0.12000192448513033, 'Iris-virginica': 0.8799951073256309}
第129记录的预测最可能的所属类别为:Iris-virginica
第129记录的真实属性为:Iris-virginica
-------------------------
记录:134, 所属类别:Iris-virginica
[6.1, 2.6, 5.6, 1.4]
{'Iris-setosa': 5.6707124370751285e-05, 'Iris-versicolor': 0.9231303912341395, 'Iris-virginica': 0.0768129016414897}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 5.6707124370751285e-05, 'Iris-versicolor': 0.9231303912341395, 'Iris-virginica': 0.0768129016414897}
第134记录的预测最可能的所属类别为:Iris-versicolor
第134记录的真实属性为:Iris-virginica
-------------------------
记录:135, 所属类别:Iris-virginica
[7.7, 3.0, 6.1, 2.3]
{'Iris-setosa': 4.027193249103518e-10, 'Iris-versicolor': 7.550066584932601e-05, 'Iris-virginica': 0.9999244989314313}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 4.027193249103518e-10, 'Iris-versicolor': 7.550066584932601e-05, 'Iris-virginica': 0.9999244989314313}
第135记录的预测最可能的所属类别为:Iris-virginica
第135记录的真实属性为:Iris-virginica
-------------------------
记录:137, 所属类别:Iris-virginica
[6.4, 3.1, 5.5, 1.8]
{'Iris-setosa': 8.799431580711186e-07, 'Iris-versicolor': 0.04410462329103846, 'Iris-virginica': 0.9558944967658034}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 8.799431580711186e-07, 'Iris-versicolor': 0.04410462329103846, 'Iris-virginica': 0.9558944967658034}
第137记录的预测最可能的所属类别为:Iris-virginica
第137记录的真实属性为:Iris-virginica
-------------------------
记录:142, 所属类别:Iris-virginica
[5.8, 2.7, 5.1, 1.9]
{'Iris-setosa': 6.230993565240641e-08, 'Iris-versicolor': 0.004904991357197354, 'Iris-virginica': 0.995094946332867}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 6.230993565240641e-08, 'Iris-versicolor': 0.004904991357197354, 'Iris-virginica': 0.995094946332867}
第142记录的预测最可能的所属类别为:Iris-virginica
第142记录的真实属性为:Iris-virginica
-------------------------
记录:144, 所属类别:Iris-virginica
[6.7, 3.3, 5.7, 2.5]
{'Iris-setosa': 3.840864653692801e-10, 'Iris-versicolor': 7.252557578190236e-05, 'Iris-virginica': 0.9999274740401316}
测试结果已出，该测试记录所属类别的概率为
 {'Iris-setosa': 3.840864653692801e-10, 'Iris-versicolor': 7.252557578190236e-05, 'Iris-virginica': 0.9999274740401316}
第144记录的预测最可能的所属类别为:Iris-virginica
第144记录的真实属性为:Iris-virginica
-------------------------
该模型的预测准确率为:0.9555555555555556
</code></pre> 
<hr> 
<h2><a id="5__929"></a>5. 结束语</h2> 
<p>如果有疑问欢迎大家留言讨论，你如果觉得这篇文章对你有帮助可以给我一个免费的赞吗？我们之间的交流是我最大的动力！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/acd2835f112c78ec4de9632bf6292eff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Linux】Firewalld防火墙新增端口、开启、查看等</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7cdb962d05620bf89d6fec8326890048/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">光线追踪器实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>