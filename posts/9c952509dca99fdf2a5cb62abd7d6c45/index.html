<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pytorch深度学习入门（5）之-Torchaudio音频加载 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pytorch深度学习入门（5）之-Torchaudio音频加载" />
<meta property="og:description" content="Torchaudio简介 Torchaudio是一个用于处理音频数据的Python库，它是基于PyTorch的扩展库，提供了丰富的音频处理功能和一系列预处理方法，方便用户在音频领域进行机器学习和深度学习的研究。具体来说，Torchaudio提供了从音频文件的读取到加载，音频变换和增强，以及音频数据可视化的整套工具。此外，Torchaudio还集成了一些常见的音频数据集，方便用户快速获取和处理音频数据。
在安装方面，首先需要安装PyTorch，可以通过pip install torch命令来安装最新版本。然后，可以使用pip install torchaudio命令来安装Torchaudio库。
Torchaudio的读取音频文件功能通过torchaudio.load方法实现，该方法返回一个包含音频数据的waveform张量和采样率。同时，Torchaudio提供了一些常用的音频变换和增强方法，如时域混响、频域滤波等，方便用户对音频数据进行处理和增强。
总之，Torchaudio是PyTorch在音频处理领域的强大扩展，它提供了丰富的音频处理功能和预处理方法，方便用户在音频领域进行机器学习和深度学习的研究。
本教程展示如何使用 TorchAudio 的基本 I/O API 来检查音频数据、将其加载到 PyTorch Tensors 中并保存 PyTorch Tensors。
首先查看Torchaudio版本是否正确，建议使用2.1以上版本
import torch import torchaudio print(torch.__version__) print(torchaudio.__version__) 输出：
2.1.1 2.1.0 准备
首先，我们导入模块并下载本教程中使用的音频资源。
请使用以下命令安装所需的包，使用pip安装：
pip install boto3 import io import os import tarfile import tempfile import boto3 import matplotlib.pyplot as plt import requests from botocore import UNSIGNED from botocore.config import Config from IPython.display import Audio from torchaudio.utils import download_asset SAMPLE_GSM = download_asset(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/9c952509dca99fdf2a5cb62abd7d6c45/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-30T11:08:08+08:00" />
<meta property="article:modified_time" content="2023-11-30T11:08:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pytorch深度学习入门（5）之-Torchaudio音频加载</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Torchaudio_0"></a>Torchaudio简介</h2> 
<p>Torchaudio是一个用于处理音频数据的Python库，它是基于PyTorch的扩展库，提供了丰富的音频处理功能和一系列预处理方法，方便用户在音频领域进行机器学习和深度学习的研究。具体来说，Torchaudio提供了从音频文件的读取到加载，音频变换和增强，以及音频数据可视化的整套工具。此外，Torchaudio还集成了一些常见的音频数据集，方便用户快速获取和处理音频数据。</p> 
<p>在安装方面，首先需要安装PyTorch，可以通过pip install torch命令来安装最新版本。然后，可以使用pip install torchaudio命令来安装Torchaudio库。</p> 
<p>Torchaudio的读取音频文件功能通过torchaudio.load方法实现，该方法返回一个包含音频数据的waveform张量和采样率。同时，Torchaudio提供了一些常用的音频变换和增强方法，如时域混响、频域滤波等，方便用户对音频数据进行处理和增强。</p> 
<p>总之，Torchaudio是PyTorch在音频处理领域的强大扩展，它提供了丰富的音频处理功能和预处理方法，方便用户在音频领域进行机器学习和深度学习的研究。<br> 本教程展示如何使用 TorchAudio 的基本 I/O API 来检查音频数据、将其加载到 PyTorch Tensors 中并保存 PyTorch Tensors。<br> 首先查看Torchaudio版本是否正确，建议使用2.1以上版本</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torchaudio

<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>torchaudio<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python"><span class="token number">2.1</span><span class="token number">.1</span>
<span class="token number">2.1</span><span class="token number">.0</span>
</code></pre> 
<p>准备<br> 首先，我们导入模块并下载本教程中使用的音频资源。</p> 
<p>请使用以下命令安装所需的包，使用pip安装：</p> 
<pre><code class="prism language-python">pip install boto3
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> io
<span class="token keyword">import</span> os
<span class="token keyword">import</span> tarfile
<span class="token keyword">import</span> tempfile

<span class="token keyword">import</span> boto3
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> botocore <span class="token keyword">import</span> UNSIGNED
<span class="token keyword">from</span> botocore<span class="token punctuation">.</span>config <span class="token keyword">import</span> Config
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Audio
<span class="token keyword">from</span> torchaudio<span class="token punctuation">.</span>utils <span class="token keyword">import</span> download_asset

SAMPLE_GSM <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/steam-train-whistle-daniel_simon.gsm"</span><span class="token punctuation">)</span>
SAMPLE_WAV <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span><span class="token punctuation">)</span>
SAMPLE_WAV_8000 <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042-8000hz.wav"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">_hide_seek</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">_wrapper</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>obj <span class="token operator">=</span> obj

        <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>read<span class="token punctuation">(</span>n<span class="token punctuation">)</span>

    <span class="token keyword">return</span> _wrapper<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">  <span class="token number">0</span><span class="token operator">%</span><span class="token operator">|</span>          <span class="token operator">|</span> <span class="token number">0.00</span><span class="token operator">/</span><span class="token number">7</span><span class="token punctuation">.</span>99k <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token operator">&lt;</span>?<span class="token punctuation">,</span> ?B<span class="token operator">/</span>s<span class="token punctuation">]</span>
<span class="token number">100</span><span class="token operator">%</span><span class="token operator">|</span><span class="token comment">##########| 7.99k/7.99k [00:00&lt;00:00, 7.62MB/s]</span>

  <span class="token number">0</span><span class="token operator">%</span><span class="token operator">|</span>          <span class="token operator">|</span> <span class="token number">0.00</span><span class="token operator">/</span><span class="token number">53</span><span class="token punctuation">.</span>2k <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token operator">&lt;</span>?<span class="token punctuation">,</span> ?B<span class="token operator">/</span>s<span class="token punctuation">]</span>
<span class="token number">100</span><span class="token operator">%</span><span class="token operator">|</span><span class="token comment">##########| 53.2k/53.2k [00:00&lt;00:00, 49.1MB/s]</span>
</code></pre> 
<p>查询音频元数据<br> 函数torchaudio.info()获取音频元数据。您可以提供类似路径的对象或类似文件的对象。</p> 
<pre><code class="prism language-python">metadata <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span>
AudioMetaData<span class="token punctuation">(</span>sample_rate<span class="token operator">=</span><span class="token number">16000</span><span class="token punctuation">,</span> num_frames<span class="token operator">=</span><span class="token number">54400</span><span class="token punctuation">,</span> num_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>PCM_S<span class="token punctuation">)</span>
</code></pre> 
<p>在哪里</p> 
<p>sample_rate是音频的采样率</p> 
<p>num_channels是通道数</p> 
<p>num_frames是每个通道的帧数</p> 
<p>bits_per_sample是位深度</p> 
<p>encoding是示例编码格式</p> 
<p>encoding可以采用以下值之一：</p> 
<p>“PCM_S”：有符号整数线性 PCM</p> 
<p>“PCM_U”: 无符号整数线性 PCM</p> 
<p>“PCM_F”：浮点线性PCM</p> 
<p>“FLAC”：Flac，免费无损音频编解码器</p> 
<p>“ULAW”：Mu-law，[维基百科]</p> 
<p>“ALAW”：A-law [维基百科]</p> 
<p>“MP3”：MP3、MPEG-1 音频第三层</p> 
<p>“VORBIS”: OGG Vorbis [ xiph.org ]</p> 
<p>“AMR_NB”：自适应多速率[维基百科]</p> 
<p>“AMR_WB”：自适应多速率宽带[维基百科]</p> 
<p>“OPUS”: 作品 [ opus-codec.org ]</p> 
<p>“GSM”：GSM-FR [维基百科]</p> 
<p>“HTK”：单通道16位PCM</p> 
<p>"UNKNOWN"以上都不是</p> 
<p>笔记</p> 
<p>bits_per_sample可以0用于具有压缩和/或可变比特率的格式（例如 MP3）。</p> 
<p>num_frames可以用于0GSM-FR 格式。</p> 
<pre><code class="prism language-python">metadata <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>SAMPLE_GSM<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span>
AudioMetaData<span class="token punctuation">(</span>sample_rate<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> num_frames<span class="token operator">=</span><span class="token number">39680</span><span class="token punctuation">,</span> num_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>GSM<span class="token punctuation">)</span>
</code></pre> 
<p>查询类文件对象<br> torchaudio.info()适用于类似文件的对象。</p> 
<pre><code class="prism language-python">url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/torchaudio/tutorial-assets/steam-train-whistle-daniel_simon.wav"</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    metadata <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">AudioMetaData<span class="token punctuation">(</span>sample_rate<span class="token operator">=</span><span class="token number">44100</span><span class="token punctuation">,</span> num_frames<span class="token operator">=</span><span class="token number">109368</span><span class="token punctuation">,</span> num_channels<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>PCM_S<span class="token punctuation">)</span>
</code></pre> 
<p>传递类似文件的对象时，info不会读取所有底层数据；相反，它只从头开始读取部分数据。因此，对于给定的音频格式，它可能无法检索正确的元数据，包括格式本身。在这种情况下，您可以传递format参数来指定音频的格式。</p> 
<h2><a id="_153"></a>加载音频数据</h2> 
<p>要加载音频数据，您可以使用torchaudio.load().</p> 
<p>该函数接受类似路径的对象或类似文件的对象作为输入。</p> 
<p>返回值是波形 ( Tensor) 和采样率 ( int) 的元组。</p> 
<p>默认情况下，生成的张量对象具有dtype=torch.float32，其值范围为。[-1.0, 1.0]</p> 
<p>有关支持的格式列表，请参阅torchaudio 文档。</p> 
<pre><code class="prism language-python">waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">plot_waveform</span><span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>
    waveform <span class="token operator">=</span> waveform<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

    num_channels<span class="token punctuation">,</span> num_frames <span class="token operator">=</span> waveform<span class="token punctuation">.</span>shape
    time_axis <span class="token operator">=</span> torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_frames<span class="token punctuation">)</span> <span class="token operator">/</span> sample_rate

    figure<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>num_channels<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> num_channels <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        axes <span class="token operator">=</span> <span class="token punctuation">[</span>axes<span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>time_axis<span class="token punctuation">,</span> waveform<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> num_channels <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Channel </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    figure<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"waveform"</span><span class="token punctuation">)</span>
plot_waveform<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/80/I7X0vJFR_o.png" alt="波形"></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">plot_specgram</span><span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"Spectrogram"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    waveform <span class="token operator">=</span> waveform<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

    num_channels<span class="token punctuation">,</span> num_frames <span class="token operator">=</span> waveform<span class="token punctuation">.</span>shape

    figure<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>num_channels<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> num_channels <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        axes <span class="token operator">=</span> <span class="token punctuation">[</span>axes<span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> Fs<span class="token operator">=</span>sample_rate<span class="token punctuation">)</span><span class="token comment">#specgram函数生成语谱图，也就是经过傅里叶变换生成频谱图</span>
        <span class="token keyword">if</span> num_channels <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Channel </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    figure<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span>
</code></pre> 
<p>生成时频图，采样滑动窗口对音频数据进行傅里叶变换，因此反映了时间与频率分布的情况<br> <img src="https://images2.imgbox.com/0c/2d/3t163Q4d_o.png" alt="频谱图"></p> 
<pre><code class="prism language-python">Audio<span class="token punctuation">(</span>waveform<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rate<span class="token operator">=</span>sample_rate<span class="token punctuation">)</span>
</code></pre> 
<p>从网络文件对象加载<br> I/O 函数支持类文件对象。这允许从本地文件系统内外的位置获取和解码音频数据。以下示例说明了这一点。</p> 
<pre><code class="prism language-python"><span class="token comment"># Load audio data as HTTP request</span>
url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/torchaudio/tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"HTTP datasource"</span><span class="token punctuation">)</span>
</code></pre> 
<p>HTTP数据源<br> <img src="https://images2.imgbox.com/af/6a/CfrSvhzJ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># Load audio from tar file</span>
tar_path <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/VOiCES_devkit.tar.gz"</span><span class="token punctuation">)</span>
tar_item <span class="token operator">=</span> <span class="token string">"VOiCES_devkit/source-16k/train/sp0307/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
<span class="token keyword">with</span> tarfile<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>tar_path<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tarfile_<span class="token punctuation">:</span>
    fileobj <span class="token operator">=</span> tarfile_<span class="token punctuation">.</span>extractfile<span class="token punctuation">(</span>tar_item<span class="token punctuation">)</span>
    waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fileobj<span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"TAR file"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/49/c0/56iK5llN_o.png" alt="在这里插入图片描述"><br> 输出：</p> 
<pre><code class="prism language-python">  <span class="token number">0</span><span class="token operator">%</span><span class="token operator">|</span>          <span class="token operator">|</span> <span class="token number">0.00</span><span class="token operator">/</span>110k <span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token operator">&lt;</span>?<span class="token punctuation">,</span> ?B<span class="token operator">/</span>s<span class="token punctuation">]</span>
<span class="token number">100</span><span class="token operator">%</span><span class="token operator">|</span><span class="token comment">##########| 110k/110k [00:00&lt;00:00, 76.0MB/s]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># Load audio from S3</span>
bucket <span class="token operator">=</span> <span class="token string">"pytorch-tutorial-assets"</span>
key <span class="token operator">=</span> <span class="token string">"VOiCES_devkit/source-16k/train/sp0307/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
client <span class="token operator">=</span> boto3<span class="token punctuation">.</span>client<span class="token punctuation">(</span><span class="token string">"s3"</span><span class="token punctuation">,</span> config<span class="token operator">=</span>Config<span class="token punctuation">(</span>signature_version<span class="token operator">=</span>UNSIGNED<span class="token punctuation">)</span><span class="token punctuation">)</span>
response <span class="token operator">=</span> client<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span>Bucket<span class="token operator">=</span>bucket<span class="token punctuation">,</span> Key<span class="token operator">=</span>key<span class="token punctuation">)</span>
waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">[</span><span class="token string">"Body"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"From S3"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a8/44/xeYr136T_o.png" alt="来自S3"></p> 
<p>切片技巧<br> 提供num_frames和frame_offset参数将解码限制为输入的相应段。</p> 
<p>使用普通张量切片（即 ）可以实现相同的结果 。然而，提供和论证更为有效。waveform[:, frame_offset:frame_offset+num_frames]num_framesframe_offset</p> 
<p>这是因为一旦完成对请求帧的解码，该函数将结束数据采集和解码。当音频数据通过网络传输时，这是有利的，因为一旦获取了必要的数据量，数据传输就会停止。</p> 
<p>下面的例子说明了这一点。</p> 
<pre><code class="prism language-python"><span class="token comment"># Illustration of two different decoding methods.</span>
<span class="token comment"># The first one will fetch all the data and decode them, while</span>
<span class="token comment"># the second one will stop fetching data once it completes decoding.</span>
<span class="token comment"># The resulting waveforms are identical.</span>

frame_offset<span class="token punctuation">,</span> num_frames <span class="token operator">=</span> <span class="token number">16000</span><span class="token punctuation">,</span> <span class="token number">16000</span>  <span class="token comment"># Fetch and decode the 1 - 2 seconds</span>

url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/torchaudio/tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Fetching all the data..."</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    waveform1<span class="token punctuation">,</span> sample_rate1 <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">)</span>
    waveform1 <span class="token operator">=</span> waveform1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> frame_offset <span class="token punctuation">:</span> frame_offset <span class="token operator">+</span> num_frames<span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - Fetched </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes"</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Fetching until the requested frames are available..."</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    waveform2<span class="token punctuation">,</span> sample_rate2 <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>
        _hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">,</span> frame_offset<span class="token operator">=</span>frame_offset<span class="token punctuation">,</span> num_frames<span class="token operator">=</span>num_frames
    <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - Fetched </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes"</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Checking the resulting waveform ... "</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>waveform1 <span class="token operator">==</span> waveform2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"matched!"</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">Fetching <span class="token builtin">all</span> the data<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token operator">-</span> Fetched <span class="token number">108844</span> <span class="token builtin">bytes</span>
Fetching until the requested frames are available<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token operator">-</span> Fetched <span class="token number">108844</span> <span class="token builtin">bytes</span>
Checking the resulting waveform <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> matched!
</code></pre> 
<h2><a id="_302"></a>将音频保存到文件</h2> 
<p>要将音频数据保存为常见应用程序可解释的格式，您可以使用torchaudio.save().</p> 
<p>该函数接受类似路径的对象或类似文件的对象。</p> 
<p>当传递类似文件的对象时，您还需要提供参数，format 以便函数知道应该使用哪种格式。对于类似路径的对象，该函数将从扩展名推断格式。如果要保存到没有扩展名的文件，则需要提供 argument format。</p> 
<p>保存WAV格式的数据时，Tensor的默认编码float32是32位浮点PCM。您可以提供参数encoding并 bits_per_sample更改此行为。例如，要将数据保存在 16 位有符号整数 PCM 中，您可以执行以下操作。</p> 
<p>以较低位深度的编码保存数据会减少生成的文件大小，但也会降低精度。</p> 
<pre><code class="prism language-python">waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">inspect_file</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Source:"</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - File size: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>保存时不带任何编码选项。该函数将选择所提供的数据适合的编码</p> 
<pre><code class="prism language-python"><span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tempdir<span class="token punctuation">:</span>
    path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>tempdir<span class="token punctuation">}</span></span><span class="token string">/save_example_default.wav"</span></span>
    torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span>
    inspect_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
Source<span class="token punctuation">:</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>tmph9zhvqey<span class="token operator">/</span>save_example_default<span class="token punctuation">.</span>wav
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
 <span class="token operator">-</span> File size<span class="token punctuation">:</span> <span class="token number">108878</span> <span class="token builtin">bytes</span>
 <span class="token operator">-</span> AudioMetaData<span class="token punctuation">(</span>sample_rate<span class="token operator">=</span><span class="token number">16000</span><span class="token punctuation">,</span> num_frames<span class="token operator">=</span><span class="token number">54400</span><span class="token punctuation">,</span> num_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>PCM_S<span class="token punctuation">)</span>
</code></pre> 
<p>另存为 16 位有符号整数 Linear PCM 生成的文件占用一半存储空间但会损失精度</p> 
<pre><code class="prism language-python"><span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tempdir<span class="token punctuation">:</span>
    path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>tempdir<span class="token punctuation">}</span></span><span class="token string">/save_example_PCM_S16.wav"</span></span>
    torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"PCM_S"</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
    inspect_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
Source<span class="token punctuation">:</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>tmpnjohn05p<span class="token operator">/</span>save_example_PCM_S16<span class="token punctuation">.</span>wav
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
 <span class="token operator">-</span> File size<span class="token punctuation">:</span> <span class="token number">108878</span> <span class="token builtin">bytes</span>
 <span class="token operator">-</span> AudioMetaData<span class="token punctuation">(</span>sample_rate<span class="token operator">=</span><span class="token number">16000</span><span class="token punctuation">,</span> num_frames<span class="token operator">=</span><span class="token number">54400</span><span class="token punctuation">,</span> num_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>PCM_S<span class="token punctuation">)</span>
</code></pre> 
<p>torchaudio.save()还可以处理其他格式。仅举几例：</p> 
<pre><code class="prism language-python">formats <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"flac"</span><span class="token punctuation">,</span>
    <span class="token comment"># "vorbis",</span>
    <span class="token comment"># "sph",</span>
    <span class="token comment"># "amb",</span>
    <span class="token comment"># "amr-nb",</span>
    <span class="token comment"># "gsm",</span>
<span class="token punctuation">]</span>
waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV_8000<span class="token punctuation">)</span>
<span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tempdir<span class="token punctuation">:</span>
    <span class="token keyword">for</span> <span class="token builtin">format</span> <span class="token keyword">in</span> formats<span class="token punctuation">:</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>tempdir<span class="token punctuation">}</span></span><span class="token string">/save_example.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">format</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
        torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token builtin">format</span><span class="token punctuation">)</span>
        inspect_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
</code></pre> 
<p>输出</p> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
Source<span class="token punctuation">:</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>tmpt4f0mdkn<span class="token operator">/</span>save_example<span class="token punctuation">.</span>flac
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
 <span class="token operator">-</span> File size<span class="token punctuation">:</span> <span class="token number">45262</span> <span class="token builtin">bytes</span>
 <span class="token operator">-</span> AudioMetaData<span class="token punctuation">(</span>sample_rate<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> num_frames<span class="token operator">=</span><span class="token number">27200</span><span class="token punctuation">,</span> num_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>FLAC<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_388"></a>保存到类似文件的对象</h3> 
<p>与其他 I/O 功能类似，您可以将音频保存到类似文件的对象。保存到类似文件的对象时，format需要参数。</p> 
<pre><code class="prism language-python">waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>

<span class="token comment"># Saving to bytes buffer</span>
buffer_ <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>
torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>buffer_<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"wav"</span><span class="token punctuation">)</span>

buffer_<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>buffer_<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python"><span class="token string">b'RIFFF\xa9\x01\x00WAVEfmt '</span>
</code></pre> 
<h2><a id="_407"></a>完整代码</h2> 
<pre><code class="prism language-python">

<span class="token keyword">import</span> torch
<span class="token keyword">import</span> torchaudio

<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>torchaudio<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>


<span class="token keyword">import</span> io
<span class="token keyword">import</span> os
<span class="token keyword">import</span> tarfile
<span class="token keyword">import</span> tempfile

<span class="token keyword">import</span> boto3
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> botocore <span class="token keyword">import</span> UNSIGNED
<span class="token keyword">from</span> botocore<span class="token punctuation">.</span>config <span class="token keyword">import</span> Config
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Audio
<span class="token keyword">from</span> torchaudio<span class="token punctuation">.</span>utils <span class="token keyword">import</span> download_asset

SAMPLE_GSM <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/steam-train-whistle-daniel_simon.gsm"</span><span class="token punctuation">)</span>
SAMPLE_WAV <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span><span class="token punctuation">)</span>
SAMPLE_WAV_8000 <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042-8000hz.wav"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">_hide_seek</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">_wrapper</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>obj <span class="token operator">=</span> obj

        <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>read<span class="token punctuation">(</span>n<span class="token punctuation">)</span>

    <span class="token keyword">return</span> _wrapper<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>


metadata <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span>

metadata <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>SAMPLE_GSM<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span>


url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/torchaudio/tutorial-assets/steam-train-whistle-daniel_simon.wav"</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    metadata <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span>

waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
<span class="token keyword">def</span> <span class="token function">plot_waveform</span><span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span><span class="token punctuation">:</span>
    waveform <span class="token operator">=</span> waveform<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

    num_channels<span class="token punctuation">,</span> num_frames <span class="token operator">=</span> waveform<span class="token punctuation">.</span>shape
    time_axis <span class="token operator">=</span> torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_frames<span class="token punctuation">)</span> <span class="token operator">/</span> sample_rate

    figure<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>num_channels<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> num_channels <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        axes <span class="token operator">=</span> <span class="token punctuation">[</span>axes<span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>time_axis<span class="token punctuation">,</span> waveform<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> num_channels <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Channel </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    figure<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"waveform"</span><span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
plot_waveform<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
<span class="token keyword">def</span> <span class="token function">plot_specgram</span><span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"Spectrogram"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    waveform <span class="token operator">=</span> waveform<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

    num_channels<span class="token punctuation">,</span> num_frames <span class="token operator">=</span> waveform<span class="token punctuation">.</span>shape

    figure<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>num_channels<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> num_channels <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        axes <span class="token operator">=</span> <span class="token punctuation">[</span>axes<span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> Fs<span class="token operator">=</span>sample_rate<span class="token punctuation">)</span>
        <span class="token keyword">if</span> num_channels <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            axes<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Channel </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    figure<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span>title<span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
Audio<span class="token punctuation">(</span>waveform<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rate<span class="token operator">=</span>sample_rate<span class="token punctuation">)</span>

<span class="token comment"># Load audio data as HTTP request</span>
url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/torchaudio/tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"HTTP datasource"</span><span class="token punctuation">)</span>

<span class="token comment">######################################################################</span>
<span class="token comment">#</span>

<span class="token comment"># Load audio from tar file</span>
tar_path <span class="token operator">=</span> download_asset<span class="token punctuation">(</span><span class="token string">"tutorial-assets/VOiCES_devkit.tar.gz"</span><span class="token punctuation">)</span>
tar_item <span class="token operator">=</span> <span class="token string">"VOiCES_devkit/source-16k/train/sp0307/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
<span class="token keyword">with</span> tarfile<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>tar_path<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tarfile_<span class="token punctuation">:</span>
    fileobj <span class="token operator">=</span> tarfile_<span class="token punctuation">.</span>extractfile<span class="token punctuation">(</span>tar_item<span class="token punctuation">)</span>
    waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>fileobj<span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"TAR file"</span><span class="token punctuation">)</span>

<span class="token comment">######################################################################</span>
<span class="token comment">#</span>

<span class="token comment"># Load audio from S3</span>
bucket <span class="token operator">=</span> <span class="token string">"pytorch-tutorial-assets"</span>
key <span class="token operator">=</span> <span class="token string">"VOiCES_devkit/source-16k/train/sp0307/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
client <span class="token operator">=</span> boto3<span class="token punctuation">.</span>client<span class="token punctuation">(</span><span class="token string">"s3"</span><span class="token punctuation">,</span> config<span class="token operator">=</span>Config<span class="token punctuation">(</span>signature_version<span class="token operator">=</span>UNSIGNED<span class="token punctuation">)</span><span class="token punctuation">)</span>
response <span class="token operator">=</span> client<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span>Bucket<span class="token operator">=</span>bucket<span class="token punctuation">,</span> Key<span class="token operator">=</span>key<span class="token punctuation">)</span>
waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">[</span><span class="token string">"Body"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_specgram<span class="token punctuation">(</span>waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">"From S3"</span><span class="token punctuation">)</span>


frame_offset<span class="token punctuation">,</span> num_frames <span class="token operator">=</span> <span class="token number">16000</span><span class="token punctuation">,</span> <span class="token number">16000</span>  <span class="token comment"># Fetch and decode the 1 - 2 seconds</span>

url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/torchaudio/tutorial-assets/Lab41-SRI-VOiCES-src-sp0307-ch127535-sg0042.wav"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Fetching all the data..."</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    waveform1<span class="token punctuation">,</span> sample_rate1 <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>_hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">)</span>
    waveform1 <span class="token operator">=</span> waveform1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> frame_offset <span class="token punctuation">:</span> frame_offset <span class="token operator">+</span> num_frames<span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - Fetched </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes"</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Fetching until the requested frames are available..."</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
    waveform2<span class="token punctuation">,</span> sample_rate2 <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>
        _hide_seek<span class="token punctuation">(</span>response<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">,</span> frame_offset<span class="token operator">=</span>frame_offset<span class="token punctuation">,</span> num_frames<span class="token operator">=</span>num_frames
    <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - Fetched </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>raw<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes"</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Checking the resulting waveform ... "</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>waveform1 <span class="token operator">==</span> waveform2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"matched!"</span><span class="token punctuation">)</span>

waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>


<span class="token keyword">def</span> <span class="token function">inspect_file</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Source:"</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - File size: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f" - </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>torchaudio<span class="token punctuation">.</span>info<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
<span class="token comment"># Save without any encoding option.</span>
<span class="token comment"># The function will pick up the encoding which</span>
<span class="token comment"># the provided data fit</span>
<span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tempdir<span class="token punctuation">:</span>
    path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>tempdir<span class="token punctuation">}</span></span><span class="token string">/save_example_default.wav"</span></span>
    torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">)</span>
    inspect_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
<span class="token comment"># Save as 16-bit signed integer Linear PCM</span>
<span class="token comment"># The resulting file occupies half the storage but loses precision</span>
<span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tempdir<span class="token punctuation">:</span>
    path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>tempdir<span class="token punctuation">}</span></span><span class="token string">/save_example_PCM_S16.wav"</span></span>
    torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"PCM_S"</span><span class="token punctuation">,</span> bits_per_sample<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
    inspect_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>


<span class="token comment">######################################################################</span>
<span class="token comment"># :py:func:`torchaudio.save` can also handle other formats.</span>
<span class="token comment"># To name a few:</span>
<span class="token comment">#</span>

formats <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"flac"</span><span class="token punctuation">,</span>
    <span class="token comment"># "vorbis",</span>
    <span class="token comment"># "sph",</span>
    <span class="token comment"># "amb",</span>
    <span class="token comment"># "amr-nb",</span>
    <span class="token comment"># "gsm",</span>
<span class="token punctuation">]</span>

<span class="token comment">######################################################################</span>
<span class="token comment">#</span>
waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV_8000<span class="token punctuation">)</span>
<span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> tempdir<span class="token punctuation">:</span>
    <span class="token keyword">for</span> <span class="token builtin">format</span> <span class="token keyword">in</span> formats<span class="token punctuation">:</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>tempdir<span class="token punctuation">}</span></span><span class="token string">/save_example.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">format</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
        torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>path<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token builtin">format</span><span class="token punctuation">)</span>
        inspect_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

<span class="token comment">######################################################################</span>
<span class="token comment"># Saving to file-like object</span>
<span class="token comment"># --------------------------</span>
<span class="token comment">#</span>
<span class="token comment"># Similar to the other I/O functions, you can save audio to file-like</span>
<span class="token comment"># objects. When saving to a file-like object, argument ``format`` is</span>
<span class="token comment"># required.</span>
<span class="token comment">#</span>


waveform<span class="token punctuation">,</span> sample_rate <span class="token operator">=</span> torchaudio<span class="token punctuation">.</span>load<span class="token punctuation">(</span>SAMPLE_WAV<span class="token punctuation">)</span>

<span class="token comment"># Saving to bytes buffer</span>
buffer_ <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>
torchaudio<span class="token punctuation">.</span>save<span class="token punctuation">(</span>buffer_<span class="token punctuation">,</span> waveform<span class="token punctuation">,</span> sample_rate<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"wav"</span><span class="token punctuation">)</span>

buffer_<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>buffer_<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/01d5312ddc5da495070fe43b377076a7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">docker安装mysql</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/288cadbfd1de9e9237723fe8f19cf404/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CAD/CASS高程点内插插件（可依据：图面高程点、两端高程点、图面等高线、图面三角网），均支持两种内插模式：逐个内插、线性内插。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>