<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android笔记（二十一）：Room组件实现Android应用的持久化处理 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android笔记（二十一）：Room组件实现Android应用的持久化处理" />
<meta property="og:description" content="一、Room组件概述 Room是Android JetPack架构组件之一，是一个持久处理的库。Room提供了在SQLite数据库上提供抽象层，使之实现数据访问。
（1）实体类（Entity）：映射并封装了数据库对应的数据表中对应的结构化数据。实体定义了数据库中的数据表。实体类中的数据域与表的列一一对应。
（2）数据访问对象（Data Access Object，DAO）：在DAO中定义了访问数据库的常见的操作（例如插入、删除、修改和检索等），以达到实现创建映射数据表的实体类对象，以及对该实体类对象实例的属性值进行设置和获取的目的。
（3）数据库（Room Database）：表示对数据库基本信息的描述，包括数据库的版本、名称、包含的实体类和提供的DAO对象实例。Room组件中的所有的数据库必须扩展为RoomDatabase抽象类，从而实现对实际SQLite数据库的封装。
二、Room组件的配置 在移动应用所在的模块对应的build.gradle中需要进行如下配置:
(1) 增加插件 Groovy DSL：
plugins { …… id &#39;kotlin-kapt&#39; } Kotlin DSL:
plugins{ ... id(&#34;kotlin-kapt&#34;) } kotlin-kapt实现标注（注解）处理
(2)增加标注处理的配置 Groovy DSL定义：
android { …… defaultConfig { …… //增加标注处理,增加Schema保存的路径 javaCompileOptions{ annotationProcessorOptions{//定义标注处理器选项 arguments &#43;=[ &#34;room.schemaLocation&#34;:&#34;$projectDir/schemas&#34;.toString(), &#34;room.incremental&#34;:&#34;true&#34;, &#34;room.expandProjection&#34;:&#34;true&#34; ] } } } Kotlin DSL定义：
android { …… defaultConfig { …… //增加标注处理 javaCompileOptions{ annotationProcessorOptions{ //定义标注处理器选项 arguments &#43;=mapOf( &#34;room.schemaLocation&#34; to &#34;$projectDir/schemas&#34;.toString(), &#34;room.incremental&#34; to &#34;true&#34;, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/13792bc6eb5bf68c6aafaf23e05b07ab/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-25T23:54:31+08:00" />
<meta property="article:modified_time" content="2023-12-25T23:54:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android笔记（二十一）：Room组件实现Android应用的持久化处理</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Room_0"></a>一、Room组件概述</h2> 
<p>Room是Android JetPack架构组件之一，是一个持久处理的库。Room提供了在SQLite数据库上提供抽象层，使之实现数据访问。<br> <img src="https://images2.imgbox.com/a5/f7/Cx2q9nHL_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>（1）实体类（Entity）：映射并封装了数据库对应的数据表中对应的结构化数据。实体定义了数据库中的数据表。实体类中的数据域与表的列一一对应。<br> （2）数据访问对象（Data Access Object，DAO）：在DAO中定义了访问数据库的常见的操作（例如插入、删除、修改和检索等），以达到实现创建映射数据表的实体类对象，以及对该实体类对象实例的属性值进行设置和获取的目的。<br> （3）数据库（Room Database）：表示对数据库基本信息的描述，包括数据库的版本、名称、包含的实体类和提供的DAO对象实例。Room组件中的所有的数据库必须扩展为RoomDatabase抽象类，从而实现对实际SQLite数据库的封装。</p> 
</blockquote> 
<h2><a id="Room_8"></a>二、Room组件的配置</h2> 
<p>在移动应用所在的模块对应的build.gradle中需要进行如下配置:</p> 
<h3><a id="1__11"></a>(1) 增加插件</h3> 
<p>Groovy DSL：</p> 
<pre><code class="prism language-c">plugins <span class="token punctuation">{<!-- --></span>
	   ……
    id <span class="token char">'kotlin-kapt'</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Kotlin DSL:</p> 
<pre><code class="prism language-kotlin">plugins<span class="token punctuation">{<!-- --></span>
<span class="token operator">..</span><span class="token punctuation">.</span>
  <span class="token function">id</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"kotlin-kapt"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>kotlin-kapt实现标注（注解）处理</p> 
<h3><a id="2_30"></a>(2)增加标注处理的配置</h3> 
<p>Groovy DSL定义：</p> 
<pre><code class="prism language-c">android <span class="token punctuation">{<!-- --></span>
   ……
    defaultConfig <span class="token punctuation">{<!-- --></span>
       ……
        <span class="token comment">//增加标注处理,增加Schema保存的路径</span>
        javaCompileOptions<span class="token punctuation">{<!-- --></span>
            annotationProcessorOptions<span class="token punctuation">{<!-- --></span><span class="token comment">//定义标注处理器选项</span>
                arguments <span class="token operator">+=</span><span class="token punctuation">[</span>
                        <span class="token string">"room.schemaLocation"</span><span class="token operator">:</span><span class="token string">"$projectDir/schemas"</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"room.incremental"</span><span class="token operator">:</span><span class="token string">"true"</span><span class="token punctuation">,</span>
                        <span class="token string">"room.expandProjection"</span><span class="token operator">:</span><span class="token string">"true"</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Kotlin DSL定义：</p> 
<pre><code class="prism language-kotlin">android <span class="token punctuation">{<!-- --></span>
   ……
    defaultConfig <span class="token punctuation">{<!-- --></span>
       ……
        <span class="token comment">//增加标注处理</span>
        javaCompileOptions<span class="token punctuation">{<!-- --></span>
            annotationProcessorOptions<span class="token punctuation">{<!-- --></span>
                <span class="token comment">//定义标注处理器选项</span>
                arguments <span class="token operator">+=</span><span class="token function">mapOf</span><span class="token punctuation">(</span>
                    <span class="token string-literal singleline"><span class="token string">"room.schemaLocation"</span></span> <span class="token keyword">to</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">projectDir</span></span><span class="token string">/schemas"</span></span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string-literal singleline"><span class="token string">"room.incremental"</span></span> <span class="token keyword">to</span> <span class="token string-literal singleline"><span class="token string">"true"</span></span><span class="token punctuation">,</span>
                <span class="token string-literal singleline"><span class="token string">"room.expandProjection"</span></span> <span class="token keyword">to</span> <span class="token string-literal singleline"><span class="token string">"true"</span></span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="3_70"></a>(3)增加相关依赖</h3> 
<p>Groovy DSL定义</p> 
<pre><code class="prism language-c">    def room_version <span class="token operator">=</span> <span class="token string">"2.5.0"</span>
    implementation<span class="token string">"androidx.room:room-runtime:$room_version"</span>
    <span class="token comment">// 注释处理工具</span>
    annotationProcessor <span class="token string">"androidx.room:room-compiler:$room_version"</span>
    <span class="token comment">// Kotlin注释处理工具(kapt)</span>
    kapt<span class="token string">"androidx.room:room-compiler:$room_version"</span>
    <span class="token comment">// kotlin扩展和协同程序对Room的支持</span>
    implementation <span class="token string">"androidx.room:room-ktx:$room_version"</span>

</code></pre> 
<p>如果在处理数据库是需要采用rxJava3来实现异步处理，这时还需要增加RxJava3库</p> 
<pre><code class="prism language-c">    <span class="token comment">//增加RxJava库的依赖</span>
    implementation <span class="token string">"io.reactivex.rxjava3:rxjava:3.0.7"</span>
    <span class="token comment">//增加在Android对RxJava库的支持</span>
    implementation 'io<span class="token punctuation">.</span>reactivex<span class="token punctuation">.</span>rxjava3<span class="token operator">:</span>rxandroid<span class="token operator">:</span><span class="token number">3.0</span><span class="token number">.0</span>'
    <span class="token comment">// RxJava3</span>
    implementation <span class="token string">"androidx.room:room-rxjava3:$room_version"</span>
</code></pre> 
<p>Kotlin DSL定义依赖：</p> 
<pre><code class="prism language-kotlin">    <span class="token keyword">val</span> room_version <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"2.5.0"</span></span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"androidx.room:room-runtime:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">room_version</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token function">annotationProcessor</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"androidx.room:room-compiler:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">room_version</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token function">kapt</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"androidx.room:room-compiler:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">room_version</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment">// kotlin扩展和协同程序对Room的支持</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"androidx.room:room-ktx:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">room_version</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token comment">// RxJava2</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"androidx.room:room-rxjava2:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">room_version</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token comment">// RxJava3</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"androidx.room:room-rxjava3:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">room_version</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token comment">//增加RxJava库的依赖</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"io.reactivex.rxjava3:rxjava:3.0.7"</span></span><span class="token punctuation">)</span>
    <span class="token comment">//增加在Android对RxJava库的支持</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"io.reactivex.rxjava3:rxandroid:3.0.0"</span></span><span class="token punctuation">)</span>
</code></pre> 
<p>如果在构建模块的过程中，出现了java版本不兼容的情况，可以调整：</p> 
<pre><code class="prism language-kotlin">android<span class="token punctuation">{<!-- --></span>
<span class="token operator">..</span><span class="token punctuation">.</span>
    compileOptions <span class="token punctuation">{<!-- --></span>
        sourceCompatibility <span class="token operator">=</span> JavaVersion<span class="token punctuation">.</span>VERSION_17
        targetCompatibility <span class="token operator">=</span> JavaVersion<span class="token punctuation">.</span>VERSION_17
    <span class="token punctuation">}</span>
    kotlinOptions <span class="token punctuation">{<!-- --></span>
        jvmTarget <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"17"</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="Room_126"></a>三、Room组件实现数据库的处理</h2> 
<p>新建一个项目，实现对多位学生的信息写入数据库并执行检索和CRUD操作。</p> 
<h3><a id="31__129"></a>3.1 创建实体类</h3> 
<p>映射并封装了数据库对应的数据表中对应的结构化数据。实体定义了数据库中的数据表。实体类中的数据域与表的列一一对应。</p> 
<pre><code class="prism language-c">@<span class="token function">Entity</span><span class="token punctuation">(</span>tableName <span class="token operator">=</span> <span class="token string">"students"</span><span class="token punctuation">)</span>
data class <span class="token function">Student</span><span class="token punctuation">(</span>@<span class="token function">PrimaryKey</span><span class="token punctuation">(</span>autoGenerate <span class="token operator">=</span> true<span class="token punctuation">)</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span> <span class="token string">"studentId"</span><span class="token punctuation">)</span> val id<span class="token operator">:</span>Long<span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span> <span class="token string">"studentNo"</span><span class="token punctuation">)</span> val no<span class="token operator">:</span>String<span class="token operator">?</span><span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span> <span class="token string">"studentName"</span><span class="token punctuation">)</span> val name<span class="token operator">:</span>String<span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span> <span class="token string">"studentScore"</span><span class="token punctuation">)</span> val score<span class="token operator">:</span>Int<span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"studentGrade"</span><span class="token punctuation">)</span> val grade<span class="token operator">:</span>String<span class="token operator">?</span>
                   <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    @Ignore
    <span class="token function">constructor</span><span class="token punctuation">(</span>no<span class="token operator">:</span>String<span class="token punctuation">,</span>name<span class="token operator">:</span>String<span class="token punctuation">,</span>score<span class="token operator">:</span>Int<span class="token punctuation">,</span>grade<span class="token operator">:</span>String<span class="token punctuation">)</span><span class="token operator">:</span>
            <span class="token function">this</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>no<span class="token punctuation">,</span>name<span class="token punctuation">,</span>score<span class="token punctuation">,</span>grade<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>定义的实体类Student与数据表students对应。通过标注@Entity(tableName = “students”)来指定实体类对应的数据表。并对实体类的属性定义通过标注@ColumnInfo，对应于数据表students中的各个字段，并通过@PrimaryKey标注来指定数据表的关键字。</p> 
<blockquote> 
 <p>注意：Room只能识别和使用一个构造器，如果存在多个构造器可以使用@Ignore让Room忽略这个构造器。因此在上述代码中constructor定义的辅助构造器增加了标注@Ignore。</p> 
</blockquote> 
<h3><a id="32_DAO_150"></a>3.2 创建数据访问对象DAO</h3> 
<p>在数据访问对象DAO是一个接口，定义了对指定数据表希望能执行的CRUD操作。</p> 
<pre><code class="prism language-c">@Dao
interface StudentDAO <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 插入记录
     */</span>
    @Insert
    fun <span class="token function">insertStudent</span><span class="token punctuation">(</span>student<span class="token operator">:</span>Student<span class="token punctuation">)</span><span class="token operator">:</span>Long

    <span class="token comment">/**
     * 删除记录
     */</span>
    @Update
    fun <span class="token function">updateStudent</span><span class="token punctuation">(</span>student<span class="token operator">:</span>Student<span class="token punctuation">)</span>

    <span class="token comment">/**
     * 删除记录
     */</span>
    @Delete
    fun <span class="token function">deleteStudent</span><span class="token punctuation">(</span>student<span class="token operator">:</span>Student<span class="token punctuation">)</span>

    <span class="token comment">/**
     * 检索所有的记录
     */</span>
    @<span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"select * from students"</span><span class="token punctuation">)</span>
    fun <span class="token function">queryAllStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>List<span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span>

    <span class="token comment">/**
     * 检索指定学号的学生记录
     */</span>
    @<span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"select * from students where studentNo = :no"</span><span class="token punctuation">)</span>
    fun <span class="token function">queryStudentByNo</span><span class="token punctuation">(</span>no<span class="token operator">:</span>String<span class="token punctuation">)</span><span class="token operator">:</span>Student

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="33__189"></a>3.3 创建数据库</h3> 
<p>必须定义一个RoomDatabase的抽象子类来表示对数据库基本信息的描述，包括数据库的版本、名称、包含的实体类和提供的DAO对象实例。通过数据库类来达到对实际SQLite数据库的封装。</p> 
<pre><code class="prism language-c">@<span class="token function">Database</span><span class="token punctuation">(</span>entities <span class="token operator">=</span> <span class="token punctuation">[</span>Student<span class="token operator">::</span>class<span class="token punctuation">]</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
abstract class StudentDatabase <span class="token operator">:</span> <span class="token function">RoomDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    abstract fun <span class="token function">studentDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> StudentDAO

    companion object<span class="token punctuation">{<!-- --></span>
        private var instance<span class="token operator">:</span> StudentDatabase<span class="token operator">?</span> <span class="token operator">=</span> null
        <span class="token comment">/**
         * 单例模式创建为一个StudentDatabase对象实例
         */</span>
        @Synchronized
        fun <span class="token function">getInstance</span><span class="token punctuation">(</span>context<span class="token operator">:</span> Context<span class="token punctuation">)</span><span class="token operator">:</span> StudentDatabase <span class="token punctuation">{<!-- --></span>
            instance<span class="token operator">?</span><span class="token punctuation">.</span>let<span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> it
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> Room<span class="token punctuation">.</span><span class="token function">databaseBuilder</span><span class="token punctuation">(</span>
                context<span class="token punctuation">,</span>
                StudentDatabase<span class="token operator">::</span>class<span class="token punctuation">.</span>java<span class="token punctuation">,</span>
                <span class="token string">"studentDB.db"</span>
            <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>@Database标注表示抽象的类对应数据库，内部包括的数据表由标注内部的属性entities指定。如果数据库包括多个数据表，entitites可以指定多个实体类的类对象。<br> 在上述的代码中，采用了单例模式，使得在整个移动应用中只有一个数据库的对象实例，在获取这个唯一实例时，只有一个线程可以访问，因此在getInstance方法中设置标注@Synchronized。在这个方法指定创建的数据库名是studentDB.db</p> 
<h3><a id="34__219"></a>3.4 定义并配置应用类</h3> 
<p>因为在应用中需要获取上下文，因此定义应用类，并在AndroidManifest进行配置，使之易于获取applicationContext上下文对象。</p> 
<h4><a id="341_222"></a>3.4.1定义应用类</h4> 
<pre><code class="prism language-c">class MainApp<span class="token operator">:</span> <span class="token function">Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    @<span class="token function">SuppressLint</span><span class="token punctuation">(</span><span class="token string">"StaticFieldLeaked"</span><span class="token punctuation">)</span>
    companion object<span class="token punctuation">{<!-- --></span>
        lateinit var context<span class="token operator">:</span> Context
    <span class="token punctuation">}</span>

    override fun <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        context <span class="token operator">=</span> applicationContext
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="342_AndroidManifestxml_237"></a>3.4.2 在AndroidManifest.xml配置应用类</h4> 
<p>在AndroidManifest.xml中需要在application元素中指定已定义的应用类MainApp，类似如下代码</p> 
<pre><code class="prism language-c"> <span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>   
 <span class="token operator">&lt;</span>manifest xmlns<span class="token operator">:</span>android<span class="token operator">=</span><span class="token string">"http://schemas.android.com/apk/res/android"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>application  android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">".MainApp"</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">/</span>application<span class="token operator">&gt;</span>    
<span class="token operator">&lt;</span><span class="token operator">/</span>manifest<span class="token operator">&gt;</span>  
</code></pre> 
<h3><a id="35__247"></a>3.5 测试数据库的访问</h3> 
<p>在MainActivity中定义对数据库的测试代码。</p> 
<pre><code class="prism language-c">class MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    override fun <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        setContent <span class="token punctuation">{<!-- --></span>
                    <span class="token function">testDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 测试数据库
     */</span>
    fun <span class="token function">testDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Observable<span class="token punctuation">.</span>create<span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span> emitter <span class="token operator">-&gt;</span>
            <span class="token comment">//获得Dao对象</span>
            val dao <span class="token operator">=</span> StudentDatabase<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>MainApp<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">studentDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">//插入记录,测试数据库版本，将下列注释取消</span>
            dao<span class="token punctuation">.</span><span class="token function">insertStudent</span><span class="token punctuation">(</span><span class="token function">Student</span><span class="token punctuation">(</span><span class="token string">"6001013"</span><span class="token punctuation">,</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token string">"良好"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">//检索记录</span>
            val students <span class="token operator">=</span> dao<span class="token punctuation">.</span><span class="token function">queryAllStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>student in students<span class="token punctuation">)</span>
                emitter<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">subscribeOn</span><span class="token punctuation">(</span>Schedulers<span class="token punctuation">.</span><span class="token function">io</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//指定被观察者的线程处理I/O 操作</span>
            <span class="token punctuation">.</span><span class="token function">observeOn</span><span class="token punctuation">(</span>AndroidSchedulers<span class="token punctuation">.</span><span class="token function">mainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//指定观察者的线程为主线程</span>
            <span class="token punctuation">.</span>subscribe <span class="token punctuation">{<!-- --></span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Ch10_05"</span><span class="token punctuation">,</span> <span class="token string">"${it}"</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="Room_279"></a>四、Room组件实现数据库的迁移</h2> 
<p>移动应用的需求的变化，也会导致数据库不断地升级。在数据库升级时，会希望保留原有的数据。因此，Room提供了数据库迁移的方式来解决数据库的升级。</p> 
<p>Room库提供了<strong>Migration 类</strong>实现数据库增量迁移。每个 Migration 子类提供了<strong>Migration.migrate()</strong> 函数实现新旧版本数据库之间的迁移路径。当移动应用需要升级数据库时，Room 库会利用一个或多个 Migration 子类运行 migrate() 函数，在运行时将数据库迁移到最新版本。</p> 
<p>在上述的模块的基础上，要求修改数据库中数据表students的结构，增加一个新的字studentAddress，这时需要修改上述代码来完成具体的功能。</p> 
<h3><a id="41__287"></a>4.1 修改实体类</h3> 
<p>修改实体类Student，增加一个属性address，并映射数据表students的字段studentAddress,代码如下：</p> 
<pre><code class="prism language-c">@<span class="token function">Entity</span><span class="token punctuation">(</span>tableName <span class="token operator">=</span> <span class="token string">"students"</span><span class="token punctuation">)</span>
data class <span class="token function">Student</span><span class="token punctuation">(</span>@<span class="token function">PrimaryKey</span><span class="token punctuation">(</span>autoGenerate <span class="token operator">=</span> true<span class="token punctuation">)</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"studentId"</span><span class="token punctuation">)</span> val id<span class="token operator">:</span>Long<span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"studentNo"</span><span class="token punctuation">)</span> val no<span class="token operator">:</span>String<span class="token operator">?</span><span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"studentName"</span><span class="token punctuation">)</span> val name<span class="token operator">:</span>String<span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"studentScore"</span><span class="token punctuation">)</span> val score<span class="token operator">:</span>Int<span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"studentGrade"</span><span class="token punctuation">)</span> val grade<span class="token operator">:</span>String<span class="token operator">?</span><span class="token punctuation">,</span>
                   @<span class="token function">ColumnInfo</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"studentAddress"</span><span class="token punctuation">)</span> val address<span class="token operator">:</span>String<span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

    @Ignore
    <span class="token function">constructor</span><span class="token punctuation">(</span>no<span class="token operator">:</span>String<span class="token punctuation">,</span>name<span class="token operator">:</span>String<span class="token punctuation">,</span>score<span class="token operator">:</span>Int<span class="token punctuation">,</span>grade<span class="token operator">:</span>String<span class="token punctuation">,</span>address<span class="token operator">:</span>String<span class="token punctuation">)</span><span class="token operator">:</span>
            <span class="token function">this</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>no<span class="token punctuation">,</span>name<span class="token punctuation">,</span>score<span class="token punctuation">,</span>grade<span class="token punctuation">,</span>address<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="42__305"></a>4.2 修改数据库</h3> 
<p>因为数据表变化，这时需要修改数据库，变更数据库的版本为2。定义Migration对象，指定数据库迁移是从版本1迁移到版本2，并覆盖migrate的方法，执行具体迁移的操作。</p> 
<pre><code class="prism language-c">@<span class="token function">Database</span><span class="token punctuation">(</span>entities <span class="token operator">=</span> <span class="token punctuation">[</span>Student<span class="token operator">::</span>class<span class="token punctuation">]</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
abstract class StudentDatabase <span class="token operator">:</span> <span class="token function">RoomDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    abstract fun <span class="token function">studentDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> StudentDAO
    companion object<span class="token punctuation">{<!-- --></span>
        private var instance<span class="token operator">:</span> StudentDatabase<span class="token operator">?</span> <span class="token operator">=</span> null
        <span class="token comment">//数据库从版本1迁移到版本2</span>
        val MIGRATION_1_2 <span class="token operator">=</span> object <span class="token operator">:</span> <span class="token function">Migration</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//迁移方法定义</span>
            override fun <span class="token function">migrate</span><span class="token punctuation">(</span>database<span class="token operator">:</span> SupportSQLiteDatabase<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
           <span class="token comment">//修改数据表students，增加一个新的字段address，数据类型为TEXT字符串</span>
           database<span class="token punctuation">.</span><span class="token function">execSQL</span><span class="token punctuation">(</span><span class="token string">"ALTER TABLE students ADD COLUMN studentAddress TEXT"</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * 单例模式创建为一个StudentDatabase对象实例
         */</span>
        @Synchronized
        fun <span class="token function">getInstance</span><span class="token punctuation">(</span>context<span class="token operator">:</span>Context<span class="token punctuation">)</span><span class="token operator">:</span>StudentDatabase<span class="token punctuation">{<!-- --></span>
            instance<span class="token operator">?</span><span class="token punctuation">.</span>let<span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> it
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> Room<span class="token punctuation">.</span><span class="token function">databaseBuilder</span><span class="token punctuation">(</span>
                context<span class="token punctuation">,</span>
                StudentDatabase<span class="token operator">::</span>class<span class="token punctuation">.</span>java<span class="token punctuation">,</span>
                <span class="token string">"studentDB.db"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addMigrations</span><span class="token punctuation">(</span>MIGRATION_1_2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>apply<span class="token punctuation">{<!-- --></span>
                    instance <span class="token operator">=</span> this
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上述代码的getInstance返回数据库对象时，通过调用addMigrations进行处理迁移的操作。</p> 
<h3><a id="43__344"></a>4.3 修改测试代码</h3> 
<p>在上述修改的前提基础上，因数据库的变更，测试代码也进行修改，代码如下：</p> 
<pre><code class="prism language-c">class MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    override fun <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        setContent <span class="token punctuation">{<!-- --></span>
                      <span class="token function">testDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/**
     * 数据库版本2的测试函数
     */</span>
    fun <span class="token function">testDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        Observable<span class="token punctuation">.</span>create<span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span> emitter <span class="token operator">-&gt;</span>
            <span class="token comment">//获得Dao对象</span>
            val dao <span class="token operator">=</span> StudentDatabase<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>MainApp<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">studentDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">//插入记录</span>
            dao<span class="token punctuation">.</span><span class="token function">insertStudent</span><span class="token punctuation">(</span><span class="token function">Student</span><span class="token punctuation">(</span><span class="token string">"6001015"</span><span class="token punctuation">,</span><span class="token string">"王五"</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token string">"良好"</span><span class="token punctuation">,</span><span class="token string">"江西省南昌红谷大道999号"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">//检索记录</span>
            val students <span class="token operator">=</span> dao<span class="token punctuation">.</span><span class="token function">queryAllStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>student in students<span class="token punctuation">)</span>
                emitter<span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">subscribeOn</span><span class="token punctuation">(</span>Schedulers<span class="token punctuation">.</span><span class="token function">io</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//指定被观察者的线程处理I/O 操作</span>
         <span class="token punctuation">.</span><span class="token function">observeOn</span><span class="token punctuation">(</span>AndroidSchedulers<span class="token punctuation">.</span><span class="token function">mainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//指定观察者的线程为主线程</span>
         <span class="token punctuation">.</span>subscribe<span class="token punctuation">{<!-- --></span> it<span class="token operator">:</span> Student <span class="token operator">-&gt;</span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"TAG"</span><span class="token punctuation">,</span><span class="token string">"${it}"</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_377"></a>参考文献</h2> 
<p><strong>陈轶《Android移动应用开发（微课版）》[M] 北京：清华大学出版社 2022 P407-P419</strong></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/773ab25c42ca5fafda9abb6fea2c3f9f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">实践:使用gittee授权第三方社交登录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4a115d6c31f7ac9736cdd3120a8403e9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">鸿蒙开发中的坑（持续更新……）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>