<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL高可用InnoDB Cluster - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL高可用InnoDB Cluster" />
<meta property="og:description" content="InnoDB Cluster InnoDB Cluster是MySQL官方推出的一个全栈高可用解决方案。
InnoDB Cluster包含3个核心组件
MySQL Group Replication（MGR组复制）
MySQL Shell（MySQL高级客户端）
MySQL Router（MySQL路由）
MySQL Shell安装与配置 1、安装MySQL Shell [root@node01 ~]# wget https://downloads.mysql.com/archives/get/p/43/file/mysql-shell-8.0.33-linux-glibc2.12-x86-64bit.tar.gz [root@node01 ~]# tar -xf mysql-shell-8.0.33-linux-glibc2.12-x86-64bit.tar.gz -C /usr/local [root@node01 ~]# ln -s /usr/local/mysql-shell-8.0.33-linux-glibc2.12-x86-64bit/ /usr/local/mysqlsh [root@node01 ~]# mysqlsh --help MySQL Shell 8.0.33 Usage examples: $ mysqlsh --login-path=server1 --sql $ mysqlsh root@localhost/schema $ mysqlsh mysqlx://root@some.server:3307/world_x $ mysqlsh --uri root@localhost --py -f sample.py sample param $ mysqlsh root@targethost:33070 -s world_x -f sample.js $ mysqlsh -- util check-for-server-upgrade root@localhost --output-format=JSON 2、使用MySQL Shell root@localhost [(none)]&gt; create user &#39;root&#39;@&#39;%&#39; identified by &#39;oracle&#39;; Query OK, 0 rows affected (0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/d6b5e9474df77cd1f7aecb6cd59814cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-18T18:58:50+08:00" />
<meta property="article:modified_time" content="2023-09-18T18:58:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL高可用InnoDB Cluster</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>InnoDB Cluster</h2> 
<blockquote> 
 <p>InnoDB Cluster是MySQL官方推出的一个全栈高可用解决方案。</p> 
 <p>InnoDB Cluster包含3个核心组件</p> 
 <p>MySQL Group Replication（MGR组复制）</p> 
 <p>MySQL Shell（MySQL高级客户端）</p> 
 <p>MySQL Router（MySQL路由）</p> 
</blockquote> 
<h2> MySQL Shell安装与配置</h2> 
<pre><code>1、安装MySQL Shell
[root@node01 ~]# wget https://downloads.mysql.com/archives/get/p/43/file/mysql-shell-8.0.33-linux-glibc2.12-x86-64bit.tar.gz
[root@node01 ~]# tar -xf mysql-shell-8.0.33-linux-glibc2.12-x86-64bit.tar.gz -C /usr/local
[root@node01 ~]# ln -s /usr/local/mysql-shell-8.0.33-linux-glibc2.12-x86-64bit/ /usr/local/mysqlsh
[root@node01 ~]# mysqlsh --help
MySQL Shell 8.0.33


Usage examples:
$ mysqlsh --login-path=server1 --sql
$ mysqlsh root@localhost/schema
$ mysqlsh mysqlx://root@some.server:3307/world_x
$ mysqlsh --uri root@localhost --py -f sample.py sample param
$ mysqlsh root@targethost:33070 -s world_x -f sample.js
$ mysqlsh -- util check-for-server-upgrade root@localhost --output-format=JSON

2、使用MySQL Shell
root@localhost [(none)]&gt; create user 'root'@'%' identified by 'oracle';
Query OK, 0 rows affected (0.07 sec)
root@localhost [(none)]&gt; grant all privileges on *.* to 'root'@'%';
Query OK, 0 rows affected (0.01 sec)
[root@node01 ~]# mysql -hnode01 -uroot -p
root@node01 [(none)]&gt; 

[root@node01 ~]# mysqlsh --mysql -hnode01 --port 3306 -uroot -poracle
MySQL Shell 8.0.33

Copyright (c) 2016, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
Other names may be trademarks of their respective owners.

Type '\help' or '\?' for help; '\quit' to exit.
WARNING: Using a password on the command line interface can be insecure.
Creating a Classic session to 'root@node01:3306'
Fetching schema names for auto-completion... Press ^C to stop.
Your MySQL connection id is 62
Server version: 8.0.33 MySQL Community Server - GPL
No default schema selected; type \use &lt;schema&gt; to set one.
 MySQL  node01:3306 ssl  JS &gt; 

 MySQL  node01:3306 ssl  JS &gt; session
&lt;ClassicSession:root@node01:3306&gt;

 MySQL  node01:3306 ssl  JS &gt; \py
Switching to Python mode...
 MySQL  node01:3306 ssl  Py &gt; \js
Switching to JavaScript mode...

 MySQL  node01:3306 ssl  JS &gt; \sql
Switching to SQL mode... Commands end with ;
Fetching global names for auto-completion... Press ^C to stop.
 MySQL  node01:3306 ssl  SQL &gt; 
 
root@node01 ~]# mysqlsh --mysqlx -hnode01 --port 33060 -uroot -poracle
MySQL Shell 8.0.33

Copyright (c) 2016, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
Other names may be trademarks of their respective owners.

Type '\help' or '\?' for help; '\quit' to exit.
WARNING: Using a password on the command line interface can be insecure.
Creating an X protocol session to 'root@node01:33060'
Fetching schema names for auto-completion... Press ^C to stop.
Your MySQL connection id is 63 (X protocol)
Server version: 8.0.33 MySQL Community Server - GPL
No default schema selected; type \use &lt;schema&gt; to set one.
 MySQL  node01:33060+ ssl  JS &gt; session
&lt;Session:root@node01:33060&gt;
 MySQL  node01:33060+ ssl  JS &gt; </code></pre> 
<h2>MySQL Router安装与配置</h2> 
<pre><code>1、安装MySQL Router
[root@node01 ~]# wget https://downloads.mysql.com/archives/get/p/41/file/mysql-router-8.0.33-linux-glibc2.12-x86_64.tar.xz
[root@node01 ~]# tar -xvf mysql-router-8.0.33-linux-glibc2.12-x86_64.tar.xz -C /usr/local/
[root@node01 ~]# ln -s /usr/local/mysql-router-8.0.33-linux-glibc2.12-x86_64/ /usr/local/mysqlrouter
[root@node01 ~]# mysqlrouter --help
MySQL Router  Ver 8.0.33 for Linux on x86_64 (MySQL Community - GPL)
Copyright (c) 2015, 2023, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Configuration read from the following files in the given order (enclosed
in parentheses means not available for reading):
  (/usr/local/mysql-router-8.0.33-linux-glibc2.12-x86_64/bin/.././mysqlrouter.conf)
  (/usr/local/mysql-router-8.0.33-linux-glibc2.12-x86_64/bin/.././mysqlrouter.ini)
  (/root/.mysqlrouter.conf)
  (/root/.mysqlrouter.ini)
# Examples

Bootstrap for use with InnoDB cluster into system-wide installation

    sudo mysqlrouter --bootstrap root@clusterinstance01 --user=mysqlrouter

Start router

    sudo mysqlrouter --user=mysqlrouter

Bootstrap for use with InnoDb cluster in a self-contained directory

    mysqlrouter --bootstrap root@clusterinstance01 -d myrouter

Start router                     

    myrouter/start.sh  

2、配置MySQL Router
root@node01 [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 66d72c0c-4634-11ee-a0bc-000c29004cdf | 192.168.6.101 |        3306 | ONLINE       | PRIMARY     |
| 9844cd81-4634-11ee-87f2-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | SECONDARY   |
| a3dac279-4634-11ee-9220-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | SECONDARY   |
+--------------------------------------+---------------+-------------+--------------+-------------+
3 rows in set (0.00 sec)

使用bootstrap的方式初始化MySQL Router的前提条件是MGR搭建成功，MySQL Shell已装好且InnoDB Cluster配置成功
[root@node01 ~]# mysqlrouter --bootstrap root@192.168.6.101:3306 --user=mysql --directory=/data/myrouter/6446 --conf-use-sockets --report-host='192.168.6.101'
Please enter MySQL password for root: 
Error: Expected MySQL Server '192.168.6.101:3306' to contain the metadata of MySQL InnoDB Cluster, but the schema does not exist.
Checking version of the metadata schema failed with: Error executing MySQL query "SELECT * FROM mysql_innodb_cluster_metadata.schema_version": Unknown database 'mysql_innodb_cluster_metadata' (1049)

See https://dev.mysql.com/doc/mysql-shell/en/deploying-production-innodb-cluster.html for instructions on setting up a MySQL Server to act as an InnoDB Cluster Metadata server</code></pre> 
<h2>InnoDB Cluster集群规划</h2> 
<table><tbody><tr><td> <p>IP</p> </td><td> <p>主机名</p> </td><td> <p>高可用</p> </td><td> <p>角色</p> </td><td> <p>MySQL版本</p> </td><td> <p>server-id</p> </td><td> <p>端口</p> </td></tr><tr><td> <p>192.168.6.101</p> </td><td> <p>node01</p> </td><td> <p>读写</p> </td><td> <p>Primary</p> </td><td> <p>8.0.33</p> </td><td> <p>1001</p> </td><td> <p>6446</p> </td></tr><tr><td> <p>192.168.6.102</p> </td><td> <p>node02</p> </td><td> <p>只读</p> </td><td> <p>Secondary</p> </td><td> <p>8.0.33</p> </td><td> <p>1002</p> </td><td> <p>6447</p> </td></tr><tr><td> <p>192.168.6.103</p> </td><td> <p>node03</p> </td><td> <p>只读</p> </td><td> <p>Secondary</p> </td><td> <p>8.0.33</p> </td><td> <p>1003</p> </td><td> <p>6447</p> </td></tr></tbody></table> 
<h2> 初始化MySQL</h2> 
<pre><code>1、准备安装环境
关闭防火墙
[root@node01 ~]# systemctl stop firewalld
[root@node01 ~]# systemctl disablefirewalld

关闭selinux
[root@node01 ~]# sed -n '/SELINUX=enforcing/c SELINUX=disabled' /etc/sysconfig/selinux 
SELINUX=disabled

2、准备安装包
[root@node01 ~]# id mysql
uid=54321(mysql) gid=54321(mysql) groups=54321(mysql)
[root@node01 ~]# tar -xvf mysql-8.0.33-linux-glibc2.12-x86_64.tar.xz -C /usr/local/
[root@node01 ~]# ln -s /usr/local/cluster/mysql-8.0.33-linux-glibc2.12-x86_64/ /usr/local/mysql

3、创建数据目录
[root@node01 ~]# mkdir -p /data/mysql/3306/data
[root@node01 ~]# chown -R mysql:mysql /data/mysql/3306/data

4、修改配置文件
[root@node01 ~]# vim /etc/my.cnf
[client]
port=3306
socket=/data/mysql/3306/data/mysql.sock

[mysql]
prompt="\\u@\\h [\\d]&gt; "

[mysqld]
basedir=/usr/local/mysql
datadir=/data/mysql/3306/data
user=mysql
port=3306
pid-file=/data/mysql/3306/data/mysql.pid
socket=/data/mysql/3306/data/mysql.sock
log-error=/data/mysql/3306/data/mysql.err
log-timestamps=system
skip-name-resolve
report-host="192.168.6.101"
report-port=3306
disabled-storage-engines="MyISAM,BLACKHOLE,FEDERATED,ARCHIVE,MEMORY"

#gtid
server-id=1001
log-bin=mysql-bin
binlog-format=row
log-slave-updates=on
gtid-mode=on
enforce-gtid-consistency=on
master-info-repository=table
relay-log-info-repository=table
binlog-transaction-dependency-tracking=writeset
transaction-write-set-extraction=xxhash64
#mult-thread repl
slave-parallel-type=logical_clock
slave-preserve-commit-order=on
slave-parallel-workers=4

node02的配置文件修改的部分
report-host="192.168.6.102"
server-id=1002

node03的配置文件修改的部分
report-host="192.168.6.103"
server-id=1003

5、初始化实例
[root@node01 ~]# /usr/local/mysql/bin/mysqld --defaults-file=/etc/my.cnf --user=mysql --initialize-insecure

6、启动实例
[root@node01 ~]# /usr/local/mysql/bin/mysqld_safe --defaults-file=/etc/my.cnf &amp;</code></pre> 
<h2>配置实例</h2> 
<pre><code>1、创建超级管理员账号，3个节点都要创建
root@localhost [(none)]&gt; set session sql_log_bin=0;
root@localhost [(none)]&gt; create user 'root'@'%' identified by 'oracle';
root@localhost [(none)]&gt; grant all privileges on *.* to 'root'@'%';
root@localhost [(none)]&gt; set session sql_log_bin=1;

2、配置node01
[root@node01 ~]# mysqlsh --mysql -hnode01 --port 3306 -uroot -poracle
MySQL Shell 8.0.33

Copyright (c) 2016, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
Other names may be trademarks of their respective owners.

Type '\help' or '\?' for help; '\quit' to exit.
WARNING: Using a password on the command line interface can be insecure.
Creating a Classic session to 'root@node01:3306'
Fetching schema names for auto-completion... Press ^C to stop.
Your MySQL connection id is 10
Server version: 8.0.33 MySQL Community Server - GPL
No default schema selected; type \use &lt;schema&gt; to set one.
mysql-js&gt; session
&lt;ClassicSession:root@node01:3306&gt;

mysql-js&gt; dba.configureInstance('root:oracle@192.168.6.101:3306',{clusterAdmin:'cluster_admin',clusterAdminPassword:'cluster_pass'})
Configuring local MySQL instance listening at port 3306 for use in an InnoDB cluster...
ERROR: The account 'root'@'%' is missing privileges required to manage an InnoDB cluster: 
GRANT CLONE_ADMIN, CONNECTION_ADMIN, CREATE USER, EXECUTE, FILE, GROUP_REPLICATION_ADMIN, PERSIST_RO_VARIABLES_ADMIN, PROCESS, RELOAD, REPLICATION CLIENT, REPLICATION SLAVE, REPLICATION_APPLIER, REPLICATION_SLAVE_ADMIN, ROLE_ADMIN, SELECT, SHUTDOWN, SYSTEM_VARIABLES_ADMIN ON *.* TO 'root'@'%' WITH GRANT OPTION;
GRANT DELETE, INSERT, UPDATE ON mysql.* TO 'root'@'%' WITH GRANT OPTION;
GRANT ALTER, ALTER ROUTINE, CREATE, CREATE ROUTINE, CREATE TEMPORARY TABLES, CREATE VIEW, DELETE, DROP, EVENT, EXECUTE, INDEX, INSERT, LOCK TABLES, REFERENCES, SHOW VIEW, TRIGGER, UPDATE ON mysql_innodb_cluster_metadata.* TO 'root'@'%' WITH GRANT OPTION;
GRANT ALTER, ALTER ROUTINE, CREATE, CREATE ROUTINE, CREATE TEMPORARY TABLES, CREATE VIEW, DELETE, DROP, EVENT, EXECUTE, INDEX, INSERT, LOCK TABLES, REFERENCES, SHOW VIEW, TRIGGER, UPDATE ON mysql_innodb_cluster_metadata_bkp.* TO 'root'@'%' WITH GRANT OPTION;
GRANT ALTER, ALTER ROUTINE, CREATE, CREATE ROUTINE, CREATE TEMPORARY TABLES, CREATE VIEW, DELETE, DROP, EVENT, EXECUTE, INDEX, INSERT, LOCK TABLES, REFERENCES, SHOW VIEW, TRIGGER, UPDATE ON mysql_innodb_cluster_metadata_previous.* TO 'root'@'%' WITH GRANT OPTION;
For more information, see the online documentation.
Dba.configureInstance: The account 'root'@'%' is missing privileges required to manage an InnoDB cluster. (RuntimeError)

授权需要添加with grant option

root@localhost [(none)]&gt; grant all privileges on *.* to 'root'@'%' with grant option;

mysql-js&gt; dba.configureInstance('root:oracle@192.168.6.101:3306',{clusterAdmin:'cluster_admin',clusterAdminPassword:'cluster_pass'})
Configuring local MySQL instance listening at port 3306 for use in an InnoDB cluster...

This instance reports its own address as 192.168.6.101:3306
Assuming full account name 'cluster_admin'@'%' for cluster_admin

applierWorkerThreads will be set to the default value of 4.

The instance '192.168.6.101:3306' is valid to be used in an InnoDB cluster.

Creating user cluster_admin@%.
Account cluster_admin@% was successfully created.

The instance '192.168.6.101:3306' is already ready to be used in an InnoDB cluster.

Successfully enabled parallel appliers.

2、配置node02
[root@node02 ~]# mysqlsh --mysql -hnode02 --port 3306 -uroot -poracle
MySQL Shell 8.0.33

Copyright (c) 2016, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
Other names may be trademarks of their respective owners.

Type '\help' or '\?' for help; '\quit' to exit.
WARNING: Using a password on the command line interface can be insecure.
Creating a Classic session to 'root@node02:3306'
Fetching schema names for auto-completion... Press ^C to stop.
Your MySQL connection id is 8
Server version: 8.0.33 MySQL Community Server - GPL
No default schema selected; type \use &lt;schema&gt; to set one.
 MySQL  node02:3306 ssl  JS &gt; dba.configureInstance('root:oracle@192.168.6.102:3306',{clusterAdmin:'cluster_admin',clusterAdminPassword:'cluster_pass'})
Configuring local MySQL instance listening at port 3306 for use in an InnoDB cluster...

This instance reports its own address as 192.168.6.102:3306
Assuming full account name 'cluster_admin'@'%' for cluster_admin

applierWorkerThreads will be set to the default value of 4.

The instance '192.168.6.102:3306' is valid to be used in an InnoDB cluster.

Creating user cluster_admin@%.
Account cluster_admin@% was successfully created.

The instance '192.168.6.102:3306' is already ready to be used in an InnoDB cluster.

Successfully enabled parallel appliers.

3、配置node03
[root@node03 ~]# mysqlsh --mysql -hnode03 --port 3306 -uroot -poracle
MySQL Shell 8.0.33

Copyright (c) 2016, 2023, Oracle and/or its affiliates.
Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
Other names may be trademarks of their respective owners.

Type '\help' or '\?' for help; '\quit' to exit.
WARNING: Using a password on the command line interface can be insecure.
Creating a Classic session to 'root@node03:3306'
Fetching schema names for auto-completion... Press ^C to stop.
Your MySQL connection id is 9
Server version: 8.0.33 MySQL Community Server - GPL
No default schema selected; type \use &lt;schema&gt; to set one.
 MySQL  node03:3306 ssl  JS &gt; dba.configureInstance('root:oracle@192.168.6.103:3306',{clusterAdmin:'cluster_admin',clusterAdminPassword:'cluster_pass'})
Configuring local MySQL instance listening at port 3306 for use in an InnoDB cluster...

This instance reports its own address as 192.168.6.103:3306
Assuming full account name 'cluster_admin'@'%' for cluster_admin

applierWorkerThreads will be set to the default value of 4.

The instance '192.168.6.103:3306' is valid to be used in an InnoDB cluster.

Creating user cluster_admin@%.
Account cluster_admin@% was successfully created.

The instance '192.168.6.103:3306' is already ready to be used in an InnoDB cluster.

Successfully enabled parallel appliers.</code></pre> 
<h2>创建InnoDB Cluster</h2> 
<pre><code>
1、创建cluster，在node01上面执行
[root@node01 ~]# mysqlsh --mysql -hnode01 --port 3306 -uroot -poracle
mysql-js&gt; shell.connect('cluster_admin:cluster_pass@192.168.6.101:3306')
Creating a session to 'cluster_admin@192.168.6.101:3306'
Fetching schema names for auto-completion... Press ^C to stop.
Closing old connection...
Your MySQL connection id is 11
Server version: 8.0.33 MySQL Community Server - GPL
No default schema selected; type \use &lt;schema&gt; to set one.
&lt;ClassicSession:cluster_admin@192.168.6.101:3306&gt;

mysql-js&gt; dba.createCluster('cluster01',{disableClone:false})
A new InnoDB Cluster will be created on instance '192.168.6.101:3306'.

Validating instance configuration at 192.168.6.101:3306...

This instance reports its own address as 192.168.6.101:3306

Instance configuration is suitable.
NOTE: Group Replication will communicate with other members using '192.168.6.101:3306'. Use the localAddress option to override.

* Checking connectivity and SSL configuration...

Creating InnoDB Cluster 'cluster01' on '192.168.6.101:3306'...

Adding Seed Instance...
Cluster successfully created. Use Cluster.addInstance() to add MySQL instances.
At least 3 instances are needed for the cluster to be able to withstand up to
one server failure.

&lt;Cluster:cluster01&gt;

2、创建Cluster对象
mysql-js&gt; cluster = dba.getCluster('cluster01')
&lt;Cluster:cluster01&gt;

3、添加node02
mysql-js&gt; cluster.addInstance('cluster_admin:cluster_pass@192.168.6.102:3306')

WARNING: A GTID set check of the MySQL instance at '192.168.6.102:3306' determined that it contains transactions that do not originate from the cluster, which must be discarded before it can join the cluster.

192.168.6.102:3306 has the following errant GTIDs that do not exist in the cluster:
2dba3c9d-47cb-11ee-915d-000c297a8cee:1-3

WARNING: Discarding these extra GTID events can either be done manually or by completely overwriting the state of 192.168.6.102:3306 with a physical snapshot from an existing cluster member. To use this method by default, set the 'recoveryMethod' option to 'clone'.

Having extra GTID events is not expected, and it is recommended to investigate this further and ensure that the data can be removed prior to choosing the clone recovery method.

Please select a recovery method [C]lone/[A]bort (default Abort): C

Validating instance configuration at 192.168.6.102:3306...

This instance reports its own address as 192.168.6.102:3306

Instance configuration is suitable.
NOTE: Group Replication will communicate with other members using '192.168.6.102:3306'. Use the localAddress option to override.

* Checking connectivity and SSL configuration...
A new instance will be added to the InnoDB Cluster. Depending on the amount of
data on the cluster this might take from a few seconds to several hours.

Adding instance to the cluster...

Monitoring recovery process of the new cluster member. Press ^C to stop monitoring and let it continue in background.
Clone based state recovery is now in progress.

NOTE: A server restart is expected to happen as part of the clone process. If the
server does not support the RESTART command or does not come back after a
while, you may need to manually start it back.

* Waiting for clone to finish...
NOTE: 192.168.6.102:3306 is being cloned from 192.168.6.101:3306
** Stage DROP DATA: Completed
** Clone Transfer  
    FILE COPY  ############################################################  100%  Completed
    PAGE COPY  ############################################################  100%  Completed
    REDO COPY  ############################################################  100%  Completed

NOTE: 192.168.6.102:3306 is shutting down...

The instance '192.168.6.102:3306' was successfully added to the cluster.

4、添加nod03
mysql-js&gt; cluster.addInstance('cluster_admin:cluster_pass@192.168.6.103:3306')

5、查看集群状态
mysql-js&gt; cluster.status()
{
    "clusterName": "cluster01", 
    "defaultReplicaSet": {
        "name": "default", 
        "primary": "192.168.6.101:3306", 
        "ssl": "REQUIRED", 
        "status": "OK", 
        "statusText": "Cluster is ONLINE and can tolerate up to ONE failure.", 
        "topology": {
            "192.168.6.101:3306": {
                "address": "192.168.6.101:3306", 
                "memberRole": "PRIMARY", 
                "mode": "R/W", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }, 
            "192.168.6.102:3306": {
                "address": "192.168.6.102:3306", 
                "memberRole": "SECONDARY", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }, 
            "192.168.6.103:3306": {
                "address": "192.168.6.103:3306", 
                "memberRole": "SECONDARY", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }
        }, 
        "topologyMode": "Single-Primary"
    }, 
    "groupInformationSourceMember": "192.168.6.101:3306"
}</code></pre> 
<h2>部署MySQL Router</h2> 
<pre><code>1、创建目录
[root@node01 ~]# mkdir -p /data/myrouter/6446

2、初始化router
[root@node01 ~]# mysqlrouter --bootstrap cluster_admin@192.168.6.101:3306 --user=mysql --directory=/data/myrouter/6446 --conf-use-sockets --report-host='192.168.6.101'
Please enter MySQL password for cluster_admin: cluster_pass
# Bootstrapping MySQL Router instance at '/data/myrouter/6446'...

- Creating account(s) (only those that are needed, if any)
- Verifying account (using it to run SQL queries that would be run by Router)
- Storing account in keyring
- Adjusting permissions of generated files
- Creating configuration /data/myrouter/6446/mysqlrouter.conf

# MySQL Router configured for the InnoDB Cluster 'cluster01'

After this MySQL Router has been started with the generated configuration

    $ mysqlrouter -c /data/myrouter/6446/mysqlrouter.conf

InnoDB Cluster 'cluster01' can be reached by connecting to:

## MySQL Classic protocol

- Read/Write Connections: 192.168.6.101:6446, /data/myrouter/6446/mysql.sock
- Read/Only Connections:  192.168.6.101:6447, /data/myrouter/6446/mysqlro.sock

## MySQL X protocol

- Read/Write Connections: 192.168.6.101:6448, /data/myrouter/6446/mysqlx.sock
- Read/Only Connections:  192.168.6.101:6449, /data/myrouter/6446/mysqlxro.sock</code></pre> 
<h2>启动MySQL Router</h2> 
<pre><code>[root@node01 ~]# ll -h /data/myrouter/6446/start.sh 
-rwx------ 1 mysql mysql 387 Sep  1 18:00 /data/myrouter/6446/start.sh

[root@node01 ~]# /data/myrouter/6446/start.sh
[root@node01 ~]# PID 1836 written to '/data/myrouter/6446/mysqlrouter.pid'
stopping to log to the console. Continuing to log to filelog

[root@node01 ~]# cat /data/myrouter/6446/mysqlrouter.pid
1836
 
[root@node01 ~]# netstat -ntlup | grep mysqlrouter
tcp        0      0 0.0.0.0:8443            0.0.0.0:*               LISTEN      1836/mysqlrouter    
tcp        0      0 0.0.0.0:6446            0.0.0.0:*               LISTEN      1836/mysqlrouter    
tcp        0      0 0.0.0.0:6447            0.0.0.0:*               LISTEN      1836/mysqlrouter    
tcp        0      0 0.0.0.0:6448            0.0.0.0:*               LISTEN      1836/mysqlrouter    
tcp        0      0 0.0.0.0:6449            0.0.0.0:*               LISTEN      1836/mysqlrouter    </code></pre> 
<h2>测试MySQL Router</h2> 
<pre><code class="language-bash">1、高可用
当Primary节点宕机，集群是否还提供写服务

2、读写分离
读操作的负载均衡

3、首先测试读操作的负载均衡连接6447端口
[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1002 |
+-------------+
[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1003 |
+-------------+
[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1002 |
+-------------+
[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1003 |
+-------------+

可以看到读操作实现了负载均衡

测试高可用连接6446端口，只连接node01节点
[root@node01 ~]# mysql -hnode01 -P 6446 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1001 |
+-------------+

[root@node01 ~]# mysql -hnode01 -P 6446 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1001 |
+-------------+

4、模拟primary节点故障

[root@node01 ~]# /usr/local/mysql/support-files/mysql.server status
 SUCCESS! MySQL running (1111)
[root@node01 ~]# /usr/local/mysql/support-files/mysql.server stop
Shutting down MySQL....... SUCCESS! 

此时Primary节点切换到了node02节点，node01已经从集群中剔除了
root@localhost [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 2dba3c9d-47cb-11ee-915d-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | PRIMARY     |
| 2ddaa8db-47cb-11ee-a248-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | SECONDARY   |
+--------------------------------------+---------------+-------------+--------------+-------------+
2 rows in set (0.00 sec)

[root@node01 ~]# mysql -hnode01 -P 6446 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1002 |
+-------------+

[root@node01 ~]# mysql -hnode01 -P 6446 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1002 |
+-------------+

恢复node01，可以看到node01添加到集群中了，成为了Secondary节点
[root@node01 ~]# /usr/local/mysql/support-files/mysql.server start
Starting MySQL. SUCCESS! 

root@localhost [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 2dba3c9d-47cb-11ee-915d-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | PRIMARY     |
| 2ddaa8db-47cb-11ee-a248-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | SECONDARY   |
| 2fafbd0f-47cb-11ee-9e21-000c29004cdf | 192.168.6.101 |        3306 | ONLINE       | SECONDARY   |
+--------------------------------------+---------------+-------------+--------------+-------------+
3 rows in set (0.00 sec)


读操作负载均衡

[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1001 |
+-------------+

[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1003 |
+-------------+

[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1001 |
+-------------+

[root@node01 ~]# mysql -hnode01 -P 6447 -uroot -poracle -e "select @@server_id"
mysql: [Warning] Using a password on the command line interface can be insecure.
+-------------+
| @@server_id |
+-------------+
|        1003 |
+-------------+</code></pre> 
<h2>单主模式切换新的Primary</h2> 
<pre><code class="language-bash">1、节点状态
root@localhost [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 2dba3c9d-47cb-11ee-915d-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | PRIMARY     |
| 2ddaa8db-47cb-11ee-a248-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | SECONDARY   |
| 2fafbd0f-47cb-11ee-9e21-000c29004cdf | 192.168.6.101 |        3306 | ONLINE       | SECONDARY   |
+--------------------------------------+---------------+-------------+--------------+-------------+
3 rows in set (0.00 sec)

mysql-js&gt; cluster.status()
{
    "clusterName": "cluster01", 
    "defaultReplicaSet": {
        "name": "default", 
        "primary": "192.168.6.102:3306", 
        "ssl": "REQUIRED", 
        "status": "OK", 
        "statusText": "Cluster is ONLINE and can tolerate up to ONE failure.", 
        "topology": {
            "192.168.6.101:3306": {
                "address": "192.168.6.101:3306", 
                "memberRole": "SECONDARY", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }, 
            "192.168.6.102:3306": {
                "address": "192.168.6.102:3306", 
                "memberRole": "PRIMARY", 
                "mode": "R/W", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }, 
            "192.168.6.103:3306": {
                "address": "192.168.6.103:3306", 
                "memberRole": "SECONDARY", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }
        }, 
        "topologyMode": "Single-Primary"
    }, 
    "groupInformationSourceMember": "192.168.6.102:3306"
}


2、当前primary是node2，切换成node03
mysql-js&gt; cluster.setPrimaryInstance('192.168.6.103:3306')
Setting instance '192.168.6.103:3306' as the primary instance of cluster 'cluster01'...

Instance '192.168.6.101:3306' remains SECONDARY.
Instance '192.168.6.102:3306' was switched from PRIMARY to SECONDARY.
Instance '192.168.6.103:3306' was switched from SECONDARY to PRIMARY.

The instance '192.168.6.103:3306' was successfully elected as primary.

root@localhost [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 2dba3c9d-47cb-11ee-915d-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | SECONDARY   |
| 2ddaa8db-47cb-11ee-a248-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | PRIMARY     |
| 2fafbd0f-47cb-11ee-9e21-000c29004cdf | 192.168.6.101 |        3306 | ONLINE       | SECONDARY   |
+--------------------------------------+---------------+-------------+--------------+-------------+
3 rows in set (0.00 sec)

mysql-js&gt; cluster.status()
{
    "clusterName": "cluster01", 
    "defaultReplicaSet": {
        "name": "default", 
        "primary": "192.168.6.103:3306", 
        "ssl": "REQUIRED", 
        "status": "OK", 
        "statusText": "Cluster is ONLINE and can tolerate up to ONE failure.", 
        "topology": {
            "192.168.6.101:3306": {
                "address": "192.168.6.101:3306", 
                "memberRole": "SECONDARY", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }, 
            "192.168.6.102:3306": {
                "address": "192.168.6.102:3306", 
                "memberRole": "SECONDARY", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }, 
            "192.168.6.103:3306": {
                "address": "192.168.6.103:3306", 
                "memberRole": "PRIMARY", 
                "mode": "R/W", 
                "readReplicas": {}, 
                "replicationLag": "applier_queue_applied", 
                "role": "HA", 
                "status": "ONLINE", 
                "version": "8.0.33"
            }
        }, 
        "topologyMode": "Single-Primary"
    }, 
    "groupInformationSourceMember": "192.168.6.103:3306"
}</code></pre> 
<h2>单主模式切换到多主模式</h2> 
<pre><code>mysql-js&gt; cluster.switchToMultiPrimaryMode()
Switching cluster 'cluster01' to Multi-Primary mode...

Instance '192.168.6.103:3306' remains PRIMARY.
Instance '192.168.6.102:3306' was switched from SECONDARY to PRIMARY.
Instance '192.168.6.101:3306' was switched from SECONDARY to PRIMARY.

The cluster successfully switched to Multi-Primary mode.

root@localhost [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 2dba3c9d-47cb-11ee-915d-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | PRIMARY     |
| 2ddaa8db-47cb-11ee-a248-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | PRIMARY     |
| 2fafbd0f-47cb-11ee-9e21-000c29004cdf | 192.168.6.101 |        3306 | ONLINE       | PRIMARY     |
+--------------------------------------+---------------+-------------+--------------+-------------+
3 rows in set (0.00 sec)</code></pre> 
<h2>多主模式切换到单主模式</h2> 
<pre><code class="language-bash">mysql-js&gt; cluster.switchToSinglePrimaryMode('192.168.6.101:3306')
Switching cluster 'cluster01' to Single-Primary mode...

Instance '192.168.6.101:3306' remains PRIMARY.
Instance '192.168.6.102:3306' was switched from PRIMARY to SECONDARY.
Instance '192.168.6.103:3306' was switched from PRIMARY to SECONDARY.

WARNING: Existing connections that expected a R/W connection must be disconnected, i.e. instances that became SECONDARY.

The cluster successfully switched to Single-Primary mode.


root@localhost [(none)]&gt; select member_id,member_host,member_port,member_state,member_role from performance_schema.replication_group_members;
+--------------------------------------+---------------+-------------+--------------+-------------+
| member_id                            | member_host   | member_port | member_state | member_role |
+--------------------------------------+---------------+-------------+--------------+-------------+
| 2dba3c9d-47cb-11ee-915d-000c297a8cee | 192.168.6.102 |        3306 | ONLINE       | SECONDARY   |
| 2ddaa8db-47cb-11ee-a248-000c296e813f | 192.168.6.103 |        3306 | ONLINE       | SECONDARY   |
| 2fafbd0f-47cb-11ee-9e21-000c29004cdf | 192.168.6.101 |        3306 | ONLINE       | PRIMARY     |
+--------------------------------------+---------------+-------------+--------------+-------------+
3 rows in set (0.00 sec)</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6014fc093c5d548e36b5b14020e5810c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unity一个好用的文本下划线插件，可实现点击事件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e798294bf05bc5ba214689596fecff25/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">线性表---单链表</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>