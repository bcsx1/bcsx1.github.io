<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>实战10 角色管理 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="实战10 角色管理" />
<meta property="og:description" content="目录
1、角色后端接口
2、角色列表查询
2.1 效果图
2.2页面原型代码
2.3 角色api代码 role.js
2.4 查询角色列表代码
4、 新增和编辑角色
5、删除角色
6、分配权限
6.1 分配权限思路
6.2 分配权限回显接口
6.3 分配权限回显前端实现
6.4分配权限后端接口
6.4.1 RolePermissionDTO​
6.4.2 RoleMapper
6.4.3 RoleMapper.xml
6.4.4 RoleService
6.4.5 RoleServiceImp
6.4.6 RoleController
6.5分配权限回显前端实现
1、角色后端接口 package com.cizhu.vo.query; import com.cizhu.entity.Permission; import lombok.Data; @Data public class RoleQueryVo extends Permission { private Long pageNo = 1L;//当前页码 private Long pageSize = 10L;//每页显示数量 private Long userId;//用户ID } package com.cizhu.mapper; import com.cizhu.entity.Role; import com.baomidou.mybatisplus.core.mapper.BaseMapper; import org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/38e249dcd92ff45a94a4869140b5b7ec/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-26T16:55:32+08:00" />
<meta property="article:modified_time" content="2023-12-26T16:55:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">实战10 角色管理</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1%E3%80%81%E8%A7%92%E8%89%B2%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3-toc" style="margin-left:0px;"><a href="#1%E3%80%81%E8%A7%92%E8%89%B2%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3" rel="nofollow">1、角色后端接口</a></p> 
<p id="2%E3%80%81%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86-toc" style="margin-left:0px;"><a href="#2%E3%80%81%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86" rel="nofollow">2、角色列表查询</a></p> 
<p id="2.1%20%E6%95%88%E6%9E%9C%E5%9B%BE-toc" style="margin-left:40px;"><a href="#2.1%20%E6%95%88%E6%9E%9C%E5%9B%BE" rel="nofollow">2.1 效果图</a></p> 
<p id="2.2%E9%A1%B5%E9%9D%A2%E5%8E%9F%E5%9E%8B%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#2.2%E9%A1%B5%E9%9D%A2%E5%8E%9F%E5%9E%8B%E4%BB%A3%E7%A0%81" rel="nofollow">2.2页面原型代码</a></p> 
<p id="2.3%20%E8%A7%92%E8%89%B2api%E4%BB%A3%E7%A0%81%20role.js-toc" style="margin-left:40px;"><a href="#2.3%20%E8%A7%92%E8%89%B2api%E4%BB%A3%E7%A0%81%20role.js" rel="nofollow">2.3 角色api代码 role.js</a></p> 
<p id="2.4%20%E6%9F%A5%E8%AF%A2%E8%A7%92%E8%89%B2%E5%88%97%E8%A1%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#2.4%20%E6%9F%A5%E8%AF%A2%E8%A7%92%E8%89%B2%E5%88%97%E8%A1%A8%E4%BB%A3%E7%A0%81" rel="nofollow">2.4 查询角色列表代码</a></p> 
<p id="2.5%20%E6%96%B0%E5%A2%9E%E5%92%8C%E7%BC%96%E8%BE%91%E8%A7%92%E8%89%B2-toc" style="margin-left:0px;"><a href="#2.5%20%E6%96%B0%E5%A2%9E%E5%92%8C%E7%BC%96%E8%BE%91%E8%A7%92%E8%89%B2" rel="nofollow">4、 新增和编辑角色</a></p> 
<p id="%C2%A02.6%C2%A0%E5%88%A0%E9%99%A4%E8%A7%92%E8%89%B2-toc" style="margin-left:0px;"><a href="#%C2%A02.6%C2%A0%E5%88%A0%E9%99%A4%E8%A7%92%E8%89%B2" rel="nofollow">5、删除角色</a></p> 
<p id="2.7%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90-toc" style="margin-left:0px;"><a href="#2.7%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90" rel="nofollow">6、分配权限</a></p> 
<p id="2.7.1%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E6%80%9D%E8%B7%AF-toc" style="margin-left:40px;"><a href="#2.7.1%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E6%80%9D%E8%B7%AF" rel="nofollow">6.1 分配权限思路</a></p> 
<p id="2.7.2%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E6%8E%A5%E5%8F%A3-toc" style="margin-left:40px;"><a href="#2.7.2%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E6%8E%A5%E5%8F%A3" rel="nofollow">6.2 分配权限回显接口</a></p> 
<p id="%C2%A02.7.3%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-toc" style="margin-left:40px;"><a href="#%C2%A02.7.3%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0" rel="nofollow">6.3 分配权限回显前端实现</a></p> 
<p id="2.7.4%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3-toc" style="margin-left:40px;"><a href="#2.7.4%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3" rel="nofollow">6.4分配权限后端接口</a></p> 
<p id="6.4.1%20RolePermissionDTO%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:80px;"><a href="#6.4.1%20RolePermissionDTO%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">6.4.1 RolePermissionDTO​</a></p> 
<p id="6.4.2%C2%A0RoleMapper-toc" style="margin-left:80px;"><a href="#6.4.2%C2%A0RoleMapper" rel="nofollow">6.4.2 RoleMapper</a></p> 
<p id="6.4.3%C2%A0RoleMapper.xml-toc" style="margin-left:80px;"><a href="#6.4.3%C2%A0RoleMapper.xml" rel="nofollow">6.4.3 RoleMapper.xml</a></p> 
<p id="6.4.4%20RoleService-toc" style="margin-left:80px;"><a href="#6.4.4%20RoleService" rel="nofollow">6.4.4 RoleService</a></p> 
<p id="6.4.5%C2%A0RoleServiceImp-toc" style="margin-left:80px;"><a href="#6.4.5%C2%A0RoleServiceImp" rel="nofollow">6.4.5 RoleServiceImp</a></p> 
<p id="%C2%A06.4.6%C2%A0RoleController-toc" style="margin-left:80px;"><a href="#%C2%A06.4.6%C2%A0RoleController" rel="nofollow"> 6.4.6 RoleController</a></p> 
<p id="2.7.5%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-toc" style="margin-left:40px;"><a href="#2.7.5%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0" rel="nofollow">6.5分配权限回显前端实现</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="1%E3%80%81%E8%A7%92%E8%89%B2%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3">1、角色后端接口</h2> 
<pre><code>package com.cizhu.vo.query;

import com.cizhu.entity.Permission;
import lombok.Data;

@Data
public class RoleQueryVo extends Permission {
    private Long pageNo = 1L;//当前页码
    private Long pageSize = 10L;//每页显示数量
    private Long userId;//用户ID
}</code></pre> 
<pre><code>package com.cizhu.mapper;

import com.cizhu.entity.Role;
import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import org.apache.ibatis.annotations.Delete;
import org.apache.ibatis.annotations.Select;

import java.util.List;

/**
 * &lt;p&gt;
 *  Mapper 接口
 * &lt;/p&gt;
 *
 * @author cizhu
 * @since 2023-12-14
 */
public interface RoleMapper extends BaseMapper&lt;Role&gt; {

    @Select("select count(1) from sys_user_role where role_id = #{roleId}")
    int getRoleCountByRoleId(Long roleId);

    @Delete("delete from sys_role_permission where role_id = #{roleId}")
    void deleteRolePermissionByRoleId(Long roleId);

    /**
     * 保存角色权限关系
     * @param roleId
     * @param permissionIds
     * @return
     */
    int saveRolePermission(Long roleId, List&lt;Long&gt; permissionIds);

    /**
     * 根据用户ID查询该用户拥有的角色ID
     * @param userId
     * @return
     */
    @Select("select role_id from `sys_user_role` where user_id = #{userId}")
    List&lt;Long&gt; findRoleIdByUserId(Long userId);

}
</code></pre> 
<pre><code>package com.cizhu.service;

import com.baomidou.mybatisplus.core.metadata.IPage;
import com.cizhu.entity.Role;
import com.baomidou.mybatisplus.extension.service.IService;
import com.cizhu.vo.query.RoleQueryVo;

import java.util.List;

/**
 * &lt;p&gt;
 *  服务类
 * &lt;/p&gt;
 *
 * @author cizhu
 * @since 2023-12-14
 */
public interface IRoleService extends IService&lt;Role&gt; {

    /**
     * 根据用户查询角色列表
     * @param page
     * @param roleQueryVo
     * @return
     */
    IPage&lt;Role&gt; findRoleListByUserId(IPage&lt;Role&gt; page, RoleQueryVo roleQueryVo);

    /***
     * 检查该角色是否已被使用
     * @param id:
     * @return boolean
     */
    boolean hasRoleCount(Long id);

    /***
     * 删除角色
     * @param id:
     * @return boolean
     */
    boolean deleteRoleById(Long id);

    /**
     * 保存角色权限关系
     * @param roleId
     * @param permissionIds
     * @return
     */
    boolean saveRolePermission(Long roleId, List&lt;Long&gt; permissionIds);

    /**
     * 根据用户ID查询该用户拥有的角色ID
     * @param userId
     * @return
     */
    List&lt;Long&gt; findRoleIdByUserId(Long userId);
}
</code></pre> 
<pre><code>package com.cizhu.service.impl;

import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
import com.baomidou.mybatisplus.core.metadata.IPage;
import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import com.cizhu.entity.Role;
import com.cizhu.entity.User;
import com.cizhu.mapper.RoleMapper;
import com.cizhu.mapper.UserMapper;
import com.cizhu.service.IPermissionService;
import com.cizhu.service.IRoleService;
import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
import com.cizhu.utils.Result;
import com.cizhu.vo.query.RoleQueryVo;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.util.ObjectUtils;
import org.springframework.web.bind.annotation.*;

import javax.annotation.Resource;
import java.util.List;

/**
 * &lt;p&gt;
 *  服务实现类
 * &lt;/p&gt;
 *
 * @author cizhu
 * @since 2023-12-14
 */
@Service
@Transactional
public class RoleServiceImpl extends ServiceImpl&lt;RoleMapper, Role&gt; implements IRoleService {
    @Resource
    private UserMapper userMapper;

    /**
     * 根据用户查询角色列表
     *
     * @param page
     * @param roleQueryVo
     * @return
     */
    @Override
    public IPage&lt;Role&gt; findRoleListByUserId(IPage&lt;Role&gt; page, RoleQueryVo roleQueryVo) {
        //创建条件构造器
        QueryWrapper&lt;Role&gt; queryWrapper = new QueryWrapper&lt;Role&gt;();
        //角色名称
        queryWrapper.like(!ObjectUtils.isEmpty(roleQueryVo.getRoleName()),"role_name",roleQueryVo.getRoleName());
        //排序
        queryWrapper.orderByAsc("id");
        //根据用户ID查询用户信息
        User user = userMapper.selectById(roleQueryVo.getUserId());
        //如果用户不为空、且不是管理员，则只能查询自己创建的角色
        if(user!=null &amp;&amp; !ObjectUtils.isEmpty(user.getIsAdmin()) &amp;&amp; user.getIsAdmin() !=1){
            queryWrapper.eq("create_user",roleQueryVo.getUserId());
        }
        return baseMapper.selectPage(page,queryWrapper);
    }

    /***
     * 检查该角色是否已被使用
     * @param id :
     * @return boolean
     */
    @Override
    public boolean hasRoleCount(Long id) {
        return baseMapper.getRoleCountByRoleId(id) &gt; 0 ;
    }

    /***
     * 删除角色
     * @param id :
     * @return boolean
     */
    @Override
    public boolean deleteRoleById(Long id) {
        // 删除角色权限关系
        baseMapper.deleteRolePermissionByRoleId(id);
        // 删除角色
        return baseMapper.deleteById(id) &gt; 0 ;
    }

    /**
     * 保存角色权限关系
     *
     * @param roleId
     * @param permissionIds
     * @return
     */
    @Override
    public boolean saveRolePermission(Long roleId, List&lt;Long&gt; permissionIds) {
        //删除该角色对应的权限信息
        baseMapper.deleteRolePermissionByRoleId(roleId);
        //保存角色权限
        return baseMapper.saveRolePermission(roleId,permissionIds)&gt;0;
    }

    /**
     * 根据用户ID查询该用户拥有的角色ID
     *
     * @param userId
     * @return
     */
    @Override
    public List&lt;Long&gt; findRoleIdByUserId(Long userId) {
        return baseMapper.findRoleIdByUserId(userId);
    }
}
</code></pre> 
<pre><code>package com.cizhu.controller;


import com.baomidou.mybatisplus.core.metadata.IPage;
import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import com.cizhu.dto.RolePermissionDTO;
import com.cizhu.entity.Role;
import com.cizhu.service.IPermissionService;
import com.cizhu.service.IRoleService;
import com.cizhu.utils.Result;
import com.cizhu.vo.query.RolePermissionVo;
import com.cizhu.vo.query.RoleQueryVo;
import org.springframework.web.bind.annotation.*;

import javax.annotation.Resource;

/**
 * &lt;p&gt;
 *  前端控制器
 * &lt;/p&gt;
 *
 * @author cizhu
 * @since 2023-12-14
 */
@RestController
@RequestMapping("/api/role")
public class RoleController {
    @Resource
    private IRoleService roleService;

    @Resource
    private IPermissionService permissionService;

    /**
     * 分页查询角色列表
     * @param roleQueryVo
     * @return
     */
    @GetMapping("/list")
    public Result list(RoleQueryVo roleQueryVo){
        //创建分页对象
        IPage&lt;Role&gt; page = new Page&lt;Role&gt;(roleQueryVo.getPageNo(),roleQueryVo.getPageSize());
        //调用分页查询方法
        roleService.findRoleListByUserId(page,roleQueryVo);
        //返回数据
        return Result.ok(page);
    }

    /**
     * 添加角色
     * @param role
     * @return
     */
    @PostMapping("/add")
    public Result add(@RequestBody Role role){
        if(roleService.save(role)){
            return Result.ok().message("角色添加成功");
        }
        return Result.error().message("角色添加失败");
    }

    /**
     * 修改角色
     * @param role
     * @return
     */
    @PutMapping("/update")
    public Result update(@RequestBody Role role){
        if(roleService.updateById(role)){
            return Result.ok().message("角色修改成功");
        }
        return Result.error().message("角色修改失败");
    }

    /**
     * 删除角色
     * @param id
     * @return
     */
    @DeleteMapping("/delete/{id}")
    public Result delete(@PathVariable Long id){
        if(roleService.deleteRoleById(id)){
            return Result.ok().message("角色删除成功");
        }
        return Result.error().message("角色删除失败");
    }

    /**
     * 检查该角色是否已被使用
     * @param id
     * @return
     */
    @GetMapping("/check/{id}")
    public Result check(@PathVariable Long id){
        //检查该角色是否已被使用
        if(roleService.hasRoleCount(id)){
            return Result.exist().message("该角色已分配给其他用户使用，无法删除");
        }
        return Result.ok();
    }

    /**
     * 分配权限-查询权限树数据
     * @param userId
     * @param roleId
     * @return
     */
    @GetMapping("/getAssignPermissionTree")
    public Result getAssignPermissionTree(Long userId, Long roleId) {
        //调用查询权限树数据的方法
        RolePermissionVo permissionTree = permissionService.findPermissionTree(userId, roleId);
        //返回数据
        return Result.ok(permissionTree);
    }

    /**
     * 分配权限-保存权限数据
     *
     * @param rolePermissionDTO
     * @return
     */
    @PostMapping("/saveRoleAssign")
    public Result saveRoleAssign(@RequestBody RolePermissionDTO rolePermissionDTO) {
        if (roleService.saveRolePermission(rolePermissionDTO.getRoleId(),
                rolePermissionDTO.getList())) {
            return Result.ok().message("权限分配成功");
        } else {
            return Result.error().message("权限分配失败");
        }
    }

}

</code></pre> 
<h2 id="2%E3%80%81%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86">2、角色列表查询</h2> 
<h3 id="2.1%20%E6%95%88%E6%9E%9C%E5%9B%BE">2.1 效果图</h3> 
<p><img alt="" height="684" src="https://images2.imgbox.com/a0/ab/KIGMyRvQ_o.png" width="1200"></p> 
<h3 id="2.2%E9%A1%B5%E9%9D%A2%E5%8E%9F%E5%9E%8B%E4%BB%A3%E7%A0%81">2.2页面原型代码</h3> 
<pre><code>&lt;template&gt;
  &lt;el-main&gt;
    &lt;!-- 查询条件 --&gt;
    &lt;el-form :model="searchModel" ref="searchForm" label-width="80px" :inline="true" size="small"&gt;
      &lt;el-form-item&gt;
        &lt;el-input v-model="searchModel.roleName" placeholder="请输入角色名称"/&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item&gt;
        &lt;el-button type="primary" icon="el-icon-search" @click="search(pageNo,pageSize)"&gt;查询&lt;/el-button&gt;
        &lt;el-button icon="el-icon-refresh-right" @click="resetValue()"&gt;重置&lt;/el-button&gt;
        &lt;el-button type="success" icon="el-icon-plus" @click="openAddWindow()"&gt;新增&lt;/el-button&gt;
      &lt;/el-form-item&gt;
    &lt;/el-form&gt;
    &lt;!-- 数据表格 --&gt;
    &lt;el-table :data="roleList" :height="tableHeight" border stripe style="width: 100%; margin-bottom: 10px"&gt;
      &lt;el-table-column prop="roleCode" label="角色编码" width="160" align="center"&gt;&lt;/el-table-column&gt;
      &lt;el-table-column prop="roleName" label="角色名称"&gt;&lt;/el-table-column&gt;
      &lt;el-table-column prop="remark" label="角色备注"&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label="操作" align="center" width="290"&gt;
        &lt;template slot-scope="scope"&gt;
          &lt;el-button icon="el-icon-edit" type="primary" size="small" @click="handleEdit(scope.row)"&gt;编辑&lt;/el-button&gt;
          &lt;el-button icon="el-icon-delete" type="danger" size="small" @click="handleDelete(scope.row)"&gt;删除&lt;/el-button&gt;
          &lt;el-button icon="el-icon-setting" type="primary" size="small" @click="assignRole(scope.row)"&gt;分配权限&lt;/el-button&gt;
        &lt;/template&gt;
      &lt;/el-table-column&gt;
    &lt;/el-table&gt;
    &lt;!-- 分页工具栏 --&gt;
    &lt;el-pagination
    background
    @size-change="handleSizeChange"
    @current-change="handleCurrentChange"
    :current-page="pageNo"
    :page-sizes="[10, 20, 30, 40, 50]"
    :page-size="10"
    layout="total, sizes, prev, pager, next, jumper"
    :total="total"&gt;
    &lt;/el-pagination&gt;
    &lt;!-- 添加和修改角色窗口 --&gt;
    &lt;system-dialog
    :title="roleDialog.title"
    :visible="roleDialog.visible"
    :width="roleDialog.width"
    :height="roleDialog.height"
    @onClose="onClose"
    @onConfirm="onConfirm"&gt;
      &lt;div slot="content"&gt;
        &lt;el-form :model="role" ref="roleForm" :rules="rules" label-width="80px" :inline="false" size="small"&gt;
          &lt;el-form-item label="角色编码" prop="roleCode"&gt;
            &lt;el-input v-model="role.roleCode"&gt;&lt;/el-input&gt;
          &lt;/el-form-item&gt;
          &lt;el-form-item label="角色名称" prop="roleName"&gt;
            &lt;el-input v-model="role.roleName"&gt;&lt;/el-input&gt;
          &lt;/el-form-item&gt;
          &lt;el-form-item label="角色描述"&gt;
            &lt;el-input type="textarea" v-model="role.remark" :rows="5"&gt;&lt;/el-input&gt;
          &lt;/el-form-item&gt;
        &lt;/el-form&gt;
      &lt;/div&gt;
    &lt;/system-dialog&gt;

    &lt;!-- 分配权限树窗口 --&gt;
    &lt;system-dialog
    :title="assignDialog.title"
    :visible="assignDialog.visible"
    :width="assignDialog.width"
    :height="assignDialog.height"
    @onClose="onAssignClose"
    @onConfirm="onAssignConfirm"&gt;
      &lt;div slot="content"&gt;
        &lt;el-tree ref="assignTree" :data="assignTreeData" node-key="id"
          :props="defaultProps" empty-text="暂无数据" :show-checkbox="true"
          :highlight-current="true" default-expand-all&gt;&lt;/el-tree&gt;
      &lt;/div&gt;
    &lt;/system-dialog&gt;
  &lt;/el-main&gt;
&lt;/template&gt;</code></pre> 
<h3 id="2.3%20%E8%A7%92%E8%89%B2api%E4%BB%A3%E7%A0%81%20role.js">2.3 角色api代码 role.js</h3> 
<pre><code>import http from '@/utils/request'

export function getRoutes() {
  // return request({
  //   url: '/vue-element-admin/routes',
  //   method: 'get'
  // })
}

/**
* 查询角色列表
* @returns
*/
export async function getRoles(params) {
  return await http.get("/api/role/list", params)
}

/**
 * 新增角色
 * @param {*} data 
 * @returns 
 */
export async function addRole(data) {
  return await http.post("/api/role/add", data)
}

/**
 * 修改角色
 * @param {*} data 
 * @returns 
 */
export async function updateRole(data) {
  return await http.put("/api/role/update", data)
}

/**
* 查询角色是否已被使用
* @returns
*/
export async function checkRole(params) {
  return await http.getRestApi("/api/role/check", params)
}

/**
 * 删除角色
 * @param {*} id 
 */
export async function deleteRole(params) {
  return await http.delete("/api/role/delete", params)
}

/**
 * 查询分配权限树列表
* @returns
 */
export async function getAssignTree(params) {
  return await http.get("/api/role/getAssignPermissionTree", params)
}


/**
* 分配权限
* @returns
*/
export async function assignSave(params) {
  return await http.post("/api/role/saveRoleAssign", params)
}
</code></pre> 
<h3 id="2.4%20%E6%9F%A5%E8%AF%A2%E8%A7%92%E8%89%B2%E5%88%97%E8%A1%A8%E4%BB%A3%E7%A0%81" style="background-color:transparent;">2.4 查询角色列表代码</h3> 
<pre><code>&lt;script&gt;
//导入role.js脚本
import {getRoles, addRole, updateRole, deleteRole, checkRole, getAssignTree, assignSave} from '@/api/role';
// 导入对话框组件
import SystemDialog from '@/components/system/SystemDialog.vue'
//导入末级节点脚本
import leafUtils from '@/utils/leaf'

export default {
  name: 'roleList',
  //注册组件
  components:{ SystemDialog },
  data() {
    return {
      //查询条件
      searchModel: {
        roleName: '',
        pageNo:1,
        pageSize:10,
        userId:this.$store.getters.userId //用户ID
      },
      roleList: [], //数据列表
      tableHeight: 0, //表格高度
      pageNo: 1, //当前页码
      pageSize: 10, //每页显示数量
      total: 0, //总数量
      rules: {
        roleCode: [{ required: true, trigger: 'blur', message: '请输入角色编码' }],
        roleName: [{ required: true, trigger: 'blur', message: '请输入角色名称' }]
      },
      //添加和修改角色窗口属性
      roleDialog: {
        title: '',
        visible: false,
        height: 230,
        width: 500
      },
      //角色对象
      role: {
        id:"",
        roleCode:"",
        roleName:"",
        remark:"",
        createUser:this.$store.getters.userId
      },
      //分配权限窗口属性
      assignDialog: {
        title: '',
        visible: false,
        height: 450,
        width: 300
      },
      roleId: '', //角色ID
      assignTreeData: [], //树节点数据
      //树节点属性
      defaultProps: {
        children: 'children',
        label: 'label'
      }
    }
  },
  created() {
    //调用查询角色列表的方法
    this.search();
  },
  mounted() {
    this.$nextTick(() =&gt; {
      this.tableHeight = window.innerHeight - 220
    })
  },
  methods: {
    /**
    * 查询
    */
    async search(pageNo=1,pageSize=10) {
      this.searchModel.pageNo = pageNo
      this.searchModel.pageSize = pageSize
      let res = await getRoles(this.searchModel)
      if (res.success){
        //console.log(res)
        this.roleList = res.data.records
        this.total = res.data.total
      }
    },
    /**
    * 每页显示数量发生变化
    */
    handleSizeChange(size){
      this.pageSize = size
      // 查询数据
      this.search(this.pageNo, size)
    },
    /**
    * 显示第几页
    */
    handleCurrentChange(page){
      this.pageNo = page
      // 查询数据
      this.search(page, this.pageSize)
    },
    /**
     * 重置查询条件
     */
    resetValue(){
      //重置查询条件
      this.searchModel.roleName = ""
      this.search()
    },</code></pre> 
<p>获取当前用户ID store/user.js</p> 
<pre><code>import { login, logout, getInfo } from '@/api/user'
import { getToken, setToken, removeToken, setTokenTime } from '@/utils/auth'
import router, { resetRouter } from '@/router'

const state = {
  token: getToken(),  // 获取token信息
  name: '',
  avatar: '',
  introduction: '',
  roles: []
}

const mutations = {
  SET_TOKEN: (state, token) =&gt; {
    state.token = token
  },
  SET_INTRODUCTION: (state, introduction) =&gt; {
    state.introduction = introduction
  },
  SET_NAME: (state, name) =&gt; {
    state.name = name
  },
  SET_AVATAR: (state, avatar) =&gt; {
    state.avatar = avatar
  },
  SET_ROLES: (state, roles) =&gt; {
    state.roles = roles
  },
  SET_USERUID: (state, userId) =&gt; {
    state.userId = userId
  },
}

const actions = {
  // user login
  login({ commit }, userInfo) {
    const { username, password } = userInfo
    return new Promise((resolve, reject) =&gt; {
      login({ username: username.trim(), password: password }).then(response =&gt; {
        const { token, expireTime } = response
        commit('SET_TOKEN', token)
        setToken(token)
        // 设置token过期时间
        setTokenTime(expireTime)
        resolve()
      }).catch(error =&gt; {
        reject(error)
      })
    })
  },

  // get user info
  getInfo({ commit, state }) {
    return new Promise((resolve, reject) =&gt; {
      getInfo(state.token).then(response =&gt; {
        const { data } = response

        if (!data) {
          reject('Verification failed, please Login again.')
        }

        // 从后端反馈的data数据中解构出用户相关信息
        const { roles, name, avatar, introduction, id } = data

        // roles must be a non-empty array
        if (!roles || roles.length &lt;= 0) {
          reject('getInfo: roles must be a non-null array!')
        }

        commit('SET_ROLES', roles)
        commit('SET_NAME', name)
        commit('SET_AVATAR', avatar)
        commit('SET_INTRODUCTION', introduction)
        commit('SET_USERUID', id)
        //将权限字段保存到sessionStorage中
        sessionStorage.setItem("codeList",JSON.stringify(roles));
        resolve(data)
      }).catch(error =&gt; {
        reject(error)
      })
    })
  },

  // user logout
  logout({ commit, state, dispatch }) {
    return new Promise((resolve, reject) =&gt; {
      logout(state.token).then(() =&gt; {
        commit('SET_TOKEN', '')
        commit('SET_ROLES', [])
        removeToken()
        resetRouter()

        // reset visited views and cached views
        // to fixed https://github.com/PanJiaChen/vue-element-admin/issues/2485
        dispatch('tagsView/delAllViews', null, { root: true })

        resolve()
      }).catch(error =&gt; {
        reject(error)
      })
    })
  },

  // remove token
  resetToken({ commit }) {
    return new Promise(resolve =&gt; {
      commit('SET_TOKEN', '')
      commit('SET_ROLES', [])
      removeToken()
      resolve()
    })
  },

  // dynamically modify permissions
  async changeRoles({ commit, dispatch }, role) {
    const token = role + '-token'

    commit('SET_TOKEN', token)
    setToken(token)

    const { roles } = await dispatch('getInfo')

    resetRouter()

    // generate accessible routes map based on roles
    const accessRoutes = await dispatch('permission/generateRoutes', roles, { root: true })
    // dynamically add accessible routes
    router.addRoutes(accessRoutes)

    // reset visited views and cached views
    dispatch('tagsView/delAllViews', null, { root: true })
  }
}

export default {
  namespaced: true,
  state,
  mutations,
  actions
}
</code></pre> 
<p><img alt="" height="652" src="https://images2.imgbox.com/30/ad/QSf2EHm6_o.png" width="1200"></p> 
<h2 id="2.5%20%E6%96%B0%E5%A2%9E%E5%92%8C%E7%BC%96%E8%BE%91%E8%A7%92%E8%89%B2">4、 新增和编辑角色</h2> 
<pre><code>   /**
    * 打开添加窗口
    */
    openAddWindow() {
      //清空表单数据
      this.$resetForm("roleForm",this.role);
      this.roleDialog.title = '新增角色'//设置窗口标题
      this.roleDialog.visible = true//显示窗口
    },
    /**
    * 窗口取消事件
    */
    onClose() {
      this.roleDialog.visible = false
    },
    /**
    * 窗口确认事件
    */
    onConfirm() {
      //表单验证
      this.$refs.roleForm.validate(async (valid)=&gt;{
        // 验证通过
        if (valid) {
          let res = null
          // 判断是新增还是修改操作(role.id是否为空)
          if (this.role.id === ""){
              // 发送新增角色请求
              res = await addRole(this.role)
          }else{
              // 发送修改角色请求
              res = await updateRole(this.role)
          }
          if (res.success){
            // 提示成功
            this.$message.success(res.message)
            // 刷新数据
            //this.search(this.pageNo, this.pageSize)
            window.location.reload();
            //关闭窗口
            this.roleDialog.visible = false;
          }else{
            this.$message.error(res.message)
          }
        }
      });
    },
    /**
     * 编辑角色
     */
    handleEdit(row){
      //数据回显
      this.$objCopy(row, this.role); //将当前编辑的数据复制到role对象中
      //设置窗口标题
      this.roleDialog.title = "编辑角色";
      //显示编辑角色窗口
      this.roleDialog.visible = true;
    }</code></pre> 
<h2 id="%C2%A02.6%C2%A0%E5%88%A0%E9%99%A4%E8%A7%92%E8%89%B2" style="background-color:transparent;"> 5、删除角色</h2> 
<pre><code> /**
     * 删除角色
     */
    async handleDelete(row){
      //查询角色是否已被使用
      let result = await checkRole({ id: row.id })
      //判断是否可以删除
      if (!result.success) {
        //提示不能删除
        this.$message.warning(result.message);
      } else {
        //确认是否删除
        let confirm = await this.$myconfirm("确定要删除该数据吗?")
        if (confirm) {
          //发送删除请求
          let res = await deleteRole({ id: row.id })
          //判断是否成功
          if (res.success) {
            //成功提示
            this.$message.success(res.message)
            //刷新
            this.search(this.pageNo, this.pageSize)
          } else {
            //失败提示
            this.$message.error(res.message)
          }
        }
      }
    },</code></pre> 
<h2 id="2.7%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90">6、分配权限</h2> 
<h3 id="2.7.1%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E6%80%9D%E8%B7%AF">6.1 分配权限思路</h3> 
<p><img alt="" height="346" src="https://images2.imgbox.com/1a/5e/C4ItjrVn_o.png" width="1200"></p> 
<h3 id="2.7.2%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E6%8E%A5%E5%8F%A3">6.2 分配权限回显接口</h3> 
<p><img alt="" height="266" src="https://images2.imgbox.com/e0/f7/3yf4Idgu_o.png" width="1160"></p> 
<p><img alt="" height="244" src="https://images2.imgbox.com/cf/da/jVrRKZGP_o.png" width="1106"></p> 
<p><img alt="" height="740" src="https://images2.imgbox.com/6f/da/xODQW7GS_o.png" width="1102"></p> 
<p> PermissionService</p> 
<pre><code>    /**
     * 查询分配权限树列表
     * @param userId
     * @param roleId
     * @return
     */
    RolePermissionVo findPermissionTree(Long userId, Long roleId);</code></pre> 
<p>PermissionServiceImp</p> 
<pre><code>   /**
         * 查询分配权限树列表
         *
         * @param userId
         * @param roleId
         * @return
         */
        @Override
        public RolePermissionVo findPermissionTree(Long userId, Long roleId) {
            // 1.查询当前用户信息
            User user = userService.getById(userId);
            List&lt;Permission&gt; list = null;

            //2.判断当前用户角色，如果是管理员，则查询所有权限；如果不是管理员，则只查询自己所拥有的的权限
            if (!ObjectUtils.isEmpty(user) &amp;&amp; user.getIsAdmin() == 1){
                //查询所有权限
                list = baseMapper.selectList(null);
            }else{
                //根据用户ID查询
                list = baseMapper.findPermissionListByUserId(userId);
            }
            //3.组装成树数据
            List&lt;Permission&gt; permissionList = MenuTree.makeMenuTree(list, 0L);
            //4.查询要分配角色的原有权限
            List&lt;Permission&gt; rolePermissions = baseMapper.findPermissionListByRoleId(roleId);
            //5.找出该角色存在的数据
            List&lt;Long&gt; listIds = new ArrayList&lt;Long&gt;();
            Optional.ofNullable(list).orElse(new ArrayList&lt;&gt;())
                    .stream().filter(item -&gt; item != null)
                    .forEach(item -&gt; {
                        Optional.ofNullable(rolePermissions).orElse(new ArrayList&lt;&gt;()).stream()
                                .filter(Objects::nonNull).forEach(obj -&gt; {
                                    // 判断两者的权限id是否一致
                                    if(item.getId().equals(obj.getId())){
                                        listIds.add(obj.getId());
                                        return;
                                    }
                                });
                    });
            //创建
            RolePermissionVo vo = new RolePermissionVo();
            vo.setPermissionList(permissionList);
            vo.setCheckList(listIds.toArray());
            return vo;
        }</code></pre> 
<p> RoleController</p> 
<p><img alt="" height="514" src="https://images2.imgbox.com/e0/bc/rX6EjNiI_o.png" width="1140"></p> 
<h3 id="%C2%A02.7.3%20%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0"> 6.3 分配权限回显前端实现</h3> 
<pre><code>/**
     * 分配权限
     */
    async assignRole(row){
      this.roleId = row.id
      // 构建查询参数
      let params = {
        roleId: row.id,   // 角色id
        userId: this.$store.getters.userId  // 用户id
      }
      // 发送查询分配权限菜单请求
      let res = await getAssignTree(params)
      if (res.success){
        //获取当前登录用户所拥有的所有菜单权限
        let {permissionList} = res.data
        //获取当前被分配角色的已经拥有的菜单权限
        let { checkList } = res.data
        //判断当前菜单是否是最后一级
        let { setLeaf } = leafUtils()
        //设置权限菜单列表
        let newPermissionList = setLeaf(permissionList)
        //设置树节点菜单数据
        this.assignTreeData = newPermissionList
        //将回调延迟到下次DOM更新循环之后执行,在修改数据之后立即使用它,然后等待DOM更新。
        this.$nextTick(() =&gt; {
          //获取树菜单的节点数据
          let nodes = this.$refs.assignTree.children
          //设置子节点
          this.setChild(nodes, checkList)
        })
      }
      //显示窗口
      this.assignDialog.visible = true
      //设置窗口标题
      this.assignDialog.title = `给【${row.roleName}】分配权限`
    },
    /**
    * 设置子节点
    */
    setChild(childNodes, checkList) {
      //判断是否存在子节点
      if (childNodes &amp;&amp; childNodes.length &gt; 0){
        //循环所有权限
        for (let i=0; i&lt; childNodes.length; i++) {
          //根据data或key获取树组件中的node节点
          let node = this.$refs.assignTree.getNode(childNodes[i])
          //判断使用已经拥有对应的角色权限数据
          if (checkList &amp;&amp; checkList.length &gt; 0) {
            //循环遍历已有的权限集合
            for (let j = 0; j &lt; checkList.length; j++) {
              //找到已经存在的菜单权限节点
              if (checkList[j] == childNodes[i].id) {
                //如果节点是展开状态，则将树节点选中
                if (childNodes[i].open) {
                  this.$refs.assignTree.setChecked(node, true)
                  break
                }
              }
            }
          }

          //如果存在子节点，则递归选中
          if (childNodes[i].children) {
            this.setChild(childNodes[i].children, checkList)
          }
        }
      }
    },
    /**
    * 分配权限窗口取消事件
    */
    onAssignClose() {
      this.assignDialog.visible = false
    },
</code></pre> 
<h3 id="2.7.4%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3">6.4分配权限后端接口</h3> 
<h4 id="6.4.1%20RolePermissionDTO%E2%80%8B%E7%BC%96%E8%BE%91">6.4.1 RolePermissionDTO<img alt="" height="274" src="https://images2.imgbox.com/d3/a5/lefhBXrc_o.png" width="1200"></h4> 
<h4 id="6.4.2%C2%A0RoleMapper">6.4.2 RoleMapper</h4> 
<p><img alt="" height="460" src="https://images2.imgbox.com/0f/36/2K2QlDMF_o.png" width="1044"></p> 
<h4 id="6.4.3%C2%A0RoleMapper.xml">6.4.3 RoleMapper.xml</h4> 
<h4 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="200" src="https://images2.imgbox.com/e2/b8/yE2qCXTG_o.png" width="1050"></h4> 
<h4 id="6.4.4%20RoleService">6.4.4 RoleService</h4> 
<pre><code>    /**
     * 保存角色权限关系
     * @param roleId
     * @param permissionIds
     * @return
     */
    boolean saveRolePermission(Long roleId, List&lt;Long&gt; permissionIds);
</code></pre> 
<h4 id="6.4.5%C2%A0RoleServiceImp">6.4.5 RoleServiceImp</h4> 
<pre><code>    /**
     * 保存角色权限关系
     *
     * @param roleId
     * @param permissionIds
     * @return
     */
    @Override
    public boolean saveRolePermission(Long roleId, List&lt;Long&gt; permissionIds) {
        //删除该角色对应的权限信息
        baseMapper.deleteRolePermissionByRoleId(roleId);
        //保存角色权限
        return baseMapper.saveRolePermission(roleId,permissionIds)&gt;0;
    }</code></pre> 
<h4 id="%C2%A06.4.6%C2%A0RoleController"> 6.4.6 RoleController</h4> 
<pre><code>
    /**
     * 分配权限-保存权限数据
     *
     * @param rolePermissionDTO
     * @return
     */
    @PostMapping("/saveRoleAssign")
    public Result saveRoleAssign(@RequestBody RolePermissionDTO rolePermissionDTO) {
        if (roleService.saveRolePermission(rolePermissionDTO.getRoleId(),
                rolePermissionDTO.getList())) {
            return Result.ok().message("权限分配成功");
        } else {
            return Result.error().message("权限分配失败");
        }
    }
</code></pre> 
<h3 id="2.7.5%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%9B%9E%E6%98%BE%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0">6.5分配权限回显前端实现</h3> 
<pre><code>    /**
    * 分配权限窗口确认事件
    */
    async onAssignConfirm() {
      //获取选中的节点key
      let ids = this.$refs.assignTree.getCheckedKeys()
      //获取选中节点的父节点id
      let pids = this.$refs.assignTree.getHalfCheckedKeys()
      //组装选中的节点ID数据
      let listId = ids.concat(pids)
      //组装参数
      let params = {
        roleId: this.roleId,
        list: listId
      }
      //发送请求
      let res = await assignSave(params)
      //判断是否成功
      if (res.success) {
        //关闭窗口
        this.assignDialog.visible = false
        //提示成功
        this.$message.success(res.message)
      } else {
        //提示失败
        this.$message.error(res.data)
      }
    }</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/accc6730e2e570f0b3c25924729a2e9b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ppt美化的的几个小技巧</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/822b08abc5b2b565d576069f1ac4dd06/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">麒麟SP1 2203版本密码重置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>