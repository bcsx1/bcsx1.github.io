<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MongoDB介绍/安装/使用/SpringBoot内操作 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MongoDB介绍/安装/使用/SpringBoot内操作" />
<meta property="og:description" content="MongoDB介绍/安装/使用/Spring操作 MongoDBMongoDB介绍简介特点对比MySQL数据库结构语法数据类型 安装和连接创建操作删除操作更新操作读取操作正常查询分页查询排序高级查询比较查询逻辑查询模糊查询 数组 -- $push添加元素删除元素修改元素通过索引修改通过元素修改 Spring Data MongoDB准备环境配置连接参数domainMongoRepositorySpring Data方法命名规范TestMongoTemplate条件查询API方法API使用 MongoDB MongoDB介绍 简介 MongoDB是一个基于分布式文件存储的数据库。由C&#43;&#43;语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案。
MongoDB是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。它支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是它支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。
2019 数据库最受欢迎排行榜 (baidu.com)
特点 高性能易部署易使用非常方便的存储数据 对比MySQL MongoDBMysql数据库模型非关系型关系型存储方式虚拟内存 &#43; 持久化不同存储引擎有不同的存储方式查询语句独特的MongoDB查询方式传统SQL语句架构特点可以通过副本集，以及分片来实现高可用常见也有单点，M-S，MHA，MMM，Cluster等架构数据处理方式基于内存，将热数据存在物理内存中，从而达到高速读写不同的引擎拥有其自己的特点成熟度新兴数据库，成熟度低拥有较为成熟的体系，成熟度较高广泛度NoSQL数据库中，MongoDB是较为完善的DB之一，使用人群也在不断增长开源数据库的份额在不断增加，MySQL的份额也在不断增长 目前环境下，只要对事务要求不高的业务都能被MongoDB所取代，属于及其热门的NoSQL数据库
数据库结构 MongoDB属于NoSQL数据库，自然也是没有表相关的概念的，该数据库存储使用的是集合，集合中存储的是文档（树状结构数据）
语法 show dbs --查询所有数据库 use 数据库名 --创建并且选中数据库，数据库已经存在则直接选中 db --查询当前选择的数据库 db.dropDatabase() --删除当前选中的数据库 show collections --查询当前库中的集合 db.createCollection(&#34;集合名&#34;) --创建集合 db.集合名.drop() --删除集合 注意： db.集合名 == db.getCollection(&#34;集合名&#34;) 数据类型 String（字符串）: mongodb中的字符串是UTF-8有效的 Integer（整数）: 存储数值。整数可以是32位或64位，具体取决于您的服务器 Boolean（布尔）: 存储布尔(true/false)值 Double（双精度）: 存储浮点值 Arrays（数组）: 将数组或列表或多个值存储到⼀个键中 Timestamp（时间戳）: 存储时间戳 Object（对象）: 嵌⼊式⽂档 Null （空值）: 存储Null值 Symbol（符号）: 与字符串相同，⽤于具有特定符号类型的语⾔ Date（⽇期）: 以UNIX时间格式存储当前⽇期或时间 Object ID（对象ID） : 存储⽂档ID Binary data（⼆进制数据）: 存储⼆进制数据 Code（代码）: 将JavaScript代码存储到⽂档中 Regular expression（正则表达式）: 存储正则表达式 安装和连接 懒得重新安一遍，直接找个安装教程" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/1347eb73a65cb1c987eb5c2e72e3d838/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-01T18:20:30+08:00" />
<meta property="article:modified_time" content="2023-01-01T18:20:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MongoDB介绍/安装/使用/SpringBoot内操作</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>MongoDB介绍/安装/使用/Spring操作</h4> 
 <ul><li><a href="#MongoDB_1" rel="nofollow">MongoDB</a></li><li><ul><li><a href="#MongoDB_5" rel="nofollow">MongoDB介绍</a></li><li><ul><li><a href="#_7" rel="nofollow">简介</a></li><li><a href="#_15" rel="nofollow">特点</a></li><li><a href="#MySQL_22" rel="nofollow">对比MySQL</a></li><li><a href="#_36" rel="nofollow">数据库结构</a></li><li><a href="#_43" rel="nofollow">语法</a></li><li><a href="#_57" rel="nofollow">数据类型</a></li></ul> 
   </li><li><a href="#_76" rel="nofollow">安装和连接</a></li><li><a href="#_82" rel="nofollow">创建操作</a></li><li><a href="#_119" rel="nofollow">删除操作</a></li><li><a href="#_175" rel="nofollow">更新操作</a></li><li><a href="#_233" rel="nofollow">读取操作</a></li><li><ul><li><a href="#_240" rel="nofollow">正常查询</a></li><li><a href="#_250" rel="nofollow">分页查询</a></li><li><a href="#_276" rel="nofollow">排序</a></li><li><a href="#_290" rel="nofollow">高级查询</a></li><li><ul><li><a href="#_292" rel="nofollow">比较查询</a></li><li><a href="#_358" rel="nofollow">逻辑查询</a></li><li><a href="#_382" rel="nofollow">模糊查询</a></li></ul> 
    </li><li><a href="#__push_410" rel="nofollow">数组 -- $push</a></li><li><ul><li><a href="#_412" rel="nofollow">添加元素</a></li><li><a href="#_425" rel="nofollow">删除元素</a></li><li><a href="#_442" rel="nofollow">修改元素</a></li><li><ul><li><a href="#_444" rel="nofollow">通过索引修改</a></li><li><a href="#_451" rel="nofollow">通过元素修改</a></li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#Spring_Data_MongoDB_460" rel="nofollow">Spring Data MongoDB</a></li><li><ul><li><a href="#_462" rel="nofollow">准备环境</a></li><li><a href="#_493" rel="nofollow">配置连接参数</a></li><li><a href="#domain_504" rel="nofollow">domain</a></li><li><a href="#MongoRepository_521" rel="nofollow">MongoRepository</a></li><li><a href="#Spring_Data_539" rel="nofollow">Spring Data方法命名规范</a></li><li><a href="#Test_568" rel="nofollow">Test</a></li><li><a href="#MongoTemplate_670" rel="nofollow">MongoTemplate</a></li><li><ul><li><a href="#_674" rel="nofollow">条件查询</a></li><li><a href="#API_697" rel="nofollow">API方法</a></li><li><a href="#API_704" rel="nofollow">API使用</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="MongoDB_1"></a>MongoDB</h2> 
<p><img src="https://images2.imgbox.com/f4/f7/2Hm6849b_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="MongoDB_5"></a>MongoDB介绍</h3> 
<h4><a id="_7"></a>简介</h4> 
<p><strong>MongoDB</strong>是一个基于分布式文件存储的数据库。由C++语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案。</p> 
<p><strong>MongoD</strong>B是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。它支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是它支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。</p> 
<p><a href="https://baijiahao.baidu.com/s?id=1628146397605671081&amp;wfr=spider&amp;for=pc" rel="nofollow">2019 数据库最受欢迎排行榜 (baidu.com)</a></p> 
<h4><a id="_15"></a>特点</h4> 
<ul><li>高性能</li><li>易部署</li><li>易使用</li><li>非常方便的存储数据</li></ul> 
<h4><a id="MySQL_22"></a>对比MySQL</h4> 
<table><thead><tr><th></th><th>MongoDB</th><th>Mysql</th></tr></thead><tbody><tr><td>数据库模型</td><td>非关系型</td><td>关系型</td></tr><tr><td>存储方式</td><td>虚拟内存 + 持久化</td><td>不同存储引擎有不同的存储方式</td></tr><tr><td>查询语句</td><td>独特的MongoDB查询方式</td><td>传统SQL语句</td></tr><tr><td>架构特点</td><td>可以通过副本集，以及分片来实现高可用</td><td>常见也有单点，M-S，MHA，MMM，Cluster等架构</td></tr><tr><td>数据处理方式</td><td>基于内存，将热数据存在物理内存中，从而达到高速读写</td><td>不同的引擎拥有其自己的特点</td></tr><tr><td>成熟度</td><td>新兴数据库，成熟度低</td><td>拥有较为成熟的体系，成熟度较高</td></tr><tr><td>广泛度</td><td>NoSQL数据库中，MongoDB是较为完善的DB之一，使用人群也在不断增长</td><td>开源数据库的份额在不断增加，MySQL的份额也在不断增长</td></tr></tbody></table> 
<p>目前环境下，只要对事务要求不高的业务都能被MongoDB所取代，属于及其热门的NoSQL数据库</p> 
<h4><a id="_36"></a>数据库结构</h4> 
<p>MongoDB属于NoSQL数据库，自然也是没有表相关的概念的，该数据库存储使用的是集合，集合中存储的是文档（树状结构数据）</p> 
<p><img src="https://images2.imgbox.com/ec/ec/i8hsVbSb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_43"></a>语法</h4> 
<pre><code class="prism language-sql"><span class="token keyword">show</span> dbs <span class="token comment">--查询所有数据库</span>
<span class="token keyword">use</span> 数据库名 <span class="token comment">--创建并且选中数据库，数据库已经存在则直接选中</span>
db <span class="token comment">--查询当前选择的数据库</span>
db<span class="token punctuation">.</span>dropDatabase<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">--删除当前选中的数据库</span>
<span class="token keyword">show</span> collections <span class="token comment">--查询当前库中的集合</span>
db<span class="token punctuation">.</span>createCollection<span class="token punctuation">(</span><span class="token string">"集合名"</span><span class="token punctuation">)</span> <span class="token comment">--创建集合</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span><span class="token keyword">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">--删除集合</span>
注意：
db<span class="token punctuation">.</span>集合名 <span class="token operator">=</span><span class="token operator">=</span> db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">"集合名"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_57"></a>数据类型</h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">String（字符串）</span><span class="token punctuation">:</span> mongodb中的字符串是UTF<span class="token punctuation">-</span>8有效的
<span class="token key atrule">Integer（整数）</span><span class="token punctuation">:</span> 存储数值。整数可以是32位或64位，具体取决于您的服务器
<span class="token key atrule">Boolean（布尔）</span><span class="token punctuation">:</span> 存储布尔(true/false)值
<span class="token key atrule">Double（双精度）</span><span class="token punctuation">:</span> 存储浮点值
<span class="token key atrule">Arrays（数组）</span><span class="token punctuation">:</span> 将数组或列表或多个值存储到⼀个键中
<span class="token key atrule">Timestamp（时间戳）</span><span class="token punctuation">:</span> 存储时间戳
<span class="token key atrule">Object（对象）</span><span class="token punctuation">:</span> 嵌⼊式⽂档
<span class="token key atrule">Null （空值）</span><span class="token punctuation">:</span> 存储Null值
<span class="token key atrule">Symbol（符号）</span><span class="token punctuation">:</span> 与字符串相同，⽤于具有特定符号类型的语⾔
<span class="token key atrule">Date（⽇期）</span><span class="token punctuation">:</span> 以UNIX时间格式存储当前⽇期或时间
<span class="token key atrule">Object ID（对象ID）</span> <span class="token punctuation">:</span> 存储⽂档ID
<span class="token key atrule">Binary data（⼆进制数据）</span><span class="token punctuation">:</span> 存储⼆进制数据
<span class="token key atrule">Code（代码）</span><span class="token punctuation">:</span> 将JavaScript代码存储到⽂档中
<span class="token key atrule">Regular expression（正则表达式）</span><span class="token punctuation">:</span> 存储正则表达式
</code></pre> 
<h3><a id="_76"></a>安装和连接</h3> 
<p>懒得重新安一遍，直接找个安装教程</p> 
<p><a href="https://www.cnblogs.com/zhoulifeng/p/9429597.html" rel="nofollow">MongoDB安装配置教程 - 小周sri的码农 - 博客园 (cnblogs.com)</a></p> 
<h3><a id="_82"></a>创建操作</h3> 
<p>创建或插入操作会将新文档添加到集合中，如果该集合当前不存在，则插入操作将创建该集合</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>insertOne<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/67/03/BYfo8vlQ_o.png" alt="在这里插入图片描述"></p> 
<ul><li><u><mark>db.集合名.insertOne(…)</mark></u>3.2版本中的新功能</li><li><u><mark>db.集合名.insertMany(…)</mark></u>3.2版本中的新功能</li></ul> 
<p>当操作成功时，集合会给文档生成一个<code>_id</code>字段，该字段就是文档的主键，也能在插入数据时自己指定该字段的值，但是不建议这样做</p> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span>
    {
        id:<span class="token number">1</span><span class="token punctuation">,</span> 
        name:<span class="token string">"czh"</span><span class="token punctuation">,</span> 
        age:<span class="token number">21</span>
    }
<span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>insertmany<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
        {id:<span class="token number">3</span><span class="token punctuation">,</span> name:<span class="token string">"ly"</span><span class="token punctuation">,</span> age:<span class="token number">23</span>}<span class="token punctuation">,</span>
        {id:<span class="token number">4</span><span class="token punctuation">,</span> name:<span class="token string">"wgq"</span><span class="token punctuation">,</span> age:<span class="token number">21</span>}
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_119"></a>删除操作</h3> 
<p>删除操作从集合中删除文档。MongDB提供一下删除集合文档的方法：</p> 
<p><img src="https://images2.imgbox.com/50/5f/Tgmn6KCW_o.png" alt="在这里插入图片描述"></p> 
<ul><li><u><mark>db.collection.deleteOne(…)</mark></u>3.2版中的新功能</li><li><u><mark>db.collection.deleteMany(…)</mark></u>3.2版中的新功能</li></ul> 
<p>在MongoDB中，删除操作的目标是单个<u>collection</u>。MongoDB中的所有写操作都是单个文档级别的<strong>原子操作</strong></p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>
	<span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>，
    {
        justOne: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span>，
        writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>
    }
<span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>query</strong> :（可选）删除的文档的条件</li><li><strong>justOne</strong> : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值false，则删除所有匹配条件的文档</li><li><strong>writeConcern</strong> :（可选）抛出异常的级别</li></ul> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>deleteOne<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>deleteMany<span class="token punctuation">(</span>{}<span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p><mark>注意：</mark></p> 
 <ol><li> <p><strong>deleteOne()</strong> – 删除第一条满足条件的数据</p> </li><li> <p><strong>remove()</strong> – 删除所有满足条件的数据，和<code>deleteMany()</code>等价</p> </li><li> <p>要使用自动生成的<code>_id</code>进行删除时，需要封装成ObjectId类</p> <pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>deleteOne<span class="token punctuation">(</span>{_id:ObjectId<span class="token punctuation">(</span><span class="token string">"6224308aa569000058005895"</span><span class="token punctuation">)</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ol> 
</blockquote> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>deleteMany<span class="token punctuation">(</span>{}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//传个空删除全部记录</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>deleteMant<span class="token punctuation">(</span>{age:<span class="token number">23</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//删除年龄为23的用户</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>{age: <span class="token number">23</span>}<span class="token punctuation">)</span> <span class="token comment">//删除所有年龄为23的用户</span>
</code></pre> 
<h3><a id="_175"></a>更新操作</h3> 
<p>修改集合中已经存在的文档。MongDB提供了一下方法来更新集合的文档：</p> 
<p><img src="https://images2.imgbox.com/9b/11/vyDcjoAs_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>
	<span class="token operator">&lt;</span>query<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token operator">&lt;</span><span class="token keyword">update</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    {
    	upsert: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    	multi: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    	writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>
    }
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>参数说明：</strong></p> 
<ul><li><strong>query</strong> : update的查询条件，类似sql update查询内where后面的</li><li><strong>update</strong> : update的对象和一些更新的操作符（如$ ，$ inc…）等，也可以理解为sql update查询内set后面的</li><li><strong>upsert</strong> : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew，true为插入，默认是false，不插入。</li><li><strong>multi</strong> : 可选，mongodb 默认是false，只更新找到的第一条记录，如果这个参数为true，就把按条件查出来多条记录全部更新</li><li><strong>writeConcern</strong> :可选，抛出异常的级别</li></ul> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>updateOne<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>updateMany<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><mark>注意：</mark></p> 
 <p>把 <strong>$ set</strong> 改成 <strong>$ unset</strong>,在把字段设为空值，<strong>表示删除该字段</strong>，而不是修改该字段为空值</p> 
</blockquote> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>
    {age:<span class="token number">21</span>}<span class="token punctuation">,</span> 
    {$<span class="token keyword">set</span>{sex:<span class="token string">"男"</span>}}
<span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>
    {<!-- -->{age:<span class="token number">21</span>}<span class="token punctuation">,</span> 
    ${unset{sex:<span class="token string">""</span>}} <span class="token comment">//删除sex字段</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>updateOne<span class="token punctuation">(</span>
    {name:<span class="token string">"czh"</span>}<span class="token punctuation">,</span> 
    {$<span class="token keyword">set</span>:{name:<span class="token string">"lenovo"</span>}}
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_233"></a>读取操作</h3> 
<p>读取操作从 集合中检索文档; 即查询集合以获取文档。MongoDB提供了以下方法来从集合中读取文档：</p> 
<p><img src="https://images2.imgbox.com/98/06/NCJXW2Vh_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_240"></a>正常查询</h4> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{}<span class="token punctuation">,</span>{}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><mark>注意：</mark></p> 
 <p>第一个<code>{ }</code>，中填条件，第二个<code>{ }</code>填显示的列 –<strong>1</strong>（显示），<strong>0</strong>（不显示）</p> 
</blockquote> 
<h4><a id="_250"></a>分页查询</h4> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><mark>注意：</mark></p> 
 <p><strong>skip</strong>相当于MySQL中分页查询的**（currentPage-1）<em>pageSize</em>*</p> 
 <p><strong>limit</strong>相当于MySQL中的<strong>每页查询几条数据</strong></p> 
 <pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//第一页</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//第二页</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//第三页</span>
</code></pre> 
</blockquote> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//查询全部</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">"czh"</span><span class="token punctuation">,</span> age:<span class="token number">21</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_276"></a>排序</h4> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><mark>注意：</mark></p> 
 <p><strong>sort</strong>中的参数<strong>1</strong>为升序，<strong>-1</strong>为降序</p> 
 <pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{age:<span class="token number">1</span><span class="token punctuation">,</span> id:<span class="token operator">-</span><span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> 
</blockquote> 
<h4><a id="_290"></a>高级查询</h4> 
<h5><a id="_292"></a>比较查询</h5> 
<p><strong>比较操作符</strong></p> 
<ul><li><code>&gt;</code>大于 – <mark>$gt</mark></li><li><code>&lt;</code>小于 – <mark>$lt</mark></li><li><code>&gt;=</code>大于等于 – <mark>$gte</mark></li><li><code>&lt;=</code>小于等于 – <mark>$lte</mark></li><li><code>!=</code>不等于 – <mark>$ne</mark></li><li>集合运算符 – <mark>$ in</mark> ,如：<code>{name: {$in: ["czh", "ly"]}}</code></li><li>判断存在 – <mark>$ exists</mark>,如：<code>{name: {$exists:true}}</code></li></ul> 
<p><strong>大于/大于等于</strong></p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{字段名:{$gt:数字}}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//大于</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{字段名:{$gte:数字}}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//大于等于</span>
</code></pre> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$gt:<span class="token number">20</span>}}<span class="token punctuation">)</span> <span class="token comment">//查询年龄大于20的用户</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$gte:<span class="token number">20</span>}}<span class="token punctuation">)</span> <span class="token comment">//查询年龄大于等于20的用户</span>
</code></pre> 
<p><strong>小于/小于等于</strong></p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{字段名:{$lt:数字}}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//小于</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{字段名:{$lte:数字}}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//小于等于</span>
</code></pre> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$lt:<span class="token number">20</span>}}<span class="token punctuation">)</span> <span class="token comment">//查询年龄小于20的用户</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$lte:<span class="token number">20</span>}}<span class="token punctuation">)</span> <span class="token comment">//查询年龄小于等于20的用户</span>
</code></pre> 
<p><strong>不等于</strong></p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{字段名:{$ne:数字}}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//不等于</span>
</code></pre> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$ne:<span class="token number">20</span>}}<span class="token punctuation">)</span> <span class="token comment">//查询年龄不等于20的用户</span>
</code></pre> 
<p><strong>集合运算：in</strong></p> 
<p>和MySQL中的<strong>in</strong>效果一样</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{字段名:{$<span class="token operator">in</span>:<span class="token punctuation">[</span>元素<span class="token number">1</span><span class="token punctuation">,</span> 元素<span class="token number">2</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//查询在这个集合中的所有元素</span>
</code></pre> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:{$<span class="token operator">in</span>:<span class="token punctuation">[</span><span class="token string">"czh"</span><span class="token punctuation">,</span> <span class="token string">"ly"</span><span class="token punctuation">]</span>}}<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_358"></a>逻辑查询</h5> 
<ul><li><code>&amp;&amp;</code>与 – <mark>$and</mark></li><li><code>||</code>或 – <mark>$or</mark></li><li><code>!</code>非 – <mark>$not</mark></li></ul> 
<p><strong>$and</strong></p> 
<p>普通sql语句：<mark>select * from users where age &gt;= 20 and age &lt;= 30</mark></p> 
<p>比较查询：<mark>db.users.find({age:{$gte:20, $lte:30}})</mark></p> 
<p>逻辑查询：<code>db.users.find({$and:[{age:{$gte:20}}, {age:{$lte:30}}]})</code></p> 
<p><strong>$or</strong></p> 
<p>语法与and相同</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">or</span>:<span class="token punctuation">[</span>{age:{$gte:<span class="token number">20</span>}}<span class="token punctuation">,</span> {age:{$lte:<span class="token number">30</span>}}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>

db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">or</span>:<span class="token punctuation">[</span>{age:<span class="token number">20</span>}<span class="token punctuation">,</span> {age:<span class="token number">21</span>}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_382"></a>模糊查询</h5> 
<p><strong>对应SQL语句：</strong></p> 
<ul><li> <p><code>regex</code> —&gt; <mark>like</mark></p> </li><li> <p><code>{name:/xx/} </code>–&gt; <mark>%xx%</mark></p> </li><li> <p><code>{name:/^xx/}</code> —&gt; <mark>xx%</mark></p> </li><li> <p><code>{name:/xx$/}</code> —&gt; <mark>%xx</mark></p> </li><li> <p><code>{name:/xx/i}</code> —&gt; <mark>忽略大小写</mark></p> </li></ul> 
<p>例：</p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:{$regex:<span class="token operator">/</span>z<span class="token operator">/</span>}}<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:{$regex:<span class="token operator">/</span><span class="token operator">^</span>cz<span class="token operator">/</span>}}<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:{$regex:<span class="token operator">/</span>zh$<span class="token operator">/</span>}}<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:{$regex:<span class="token operator">/</span>w<span class="token operator">/</span>i}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>练习：查询名字中带有”治“，并且年龄在20到30岁之间的用户</strong></p> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">and</span>:<span class="token punctuation">[</span>{name:{$regex:<span class="token operator">/</span>治<span class="token operator">/</span>}}<span class="token punctuation">,</span> {age:{$gte:<span class="token number">20</span><span class="token punctuation">,</span> $lte:<span class="token number">30</span>}}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="__push_410"></a>数组 – $push</h4> 
<h5><a id="_412"></a>添加元素</h5> 
<blockquote> 
 <p><mark>$push</mark> --&gt; 可以重复添加</p> 
 <p><mark>$addToSet</mark> --&gt; 不重复</p> 
</blockquote> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$push:{hobby:<span class="token string">"java"</span>}}<span class="token punctuation">)</span> <span class="token comment">//添加一个元素</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$push:{hobby:{$each:<span class="token punctuation">[</span><span class="token string">"vue"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"c++"</span><span class="token punctuation">]</span>}}}<span class="token punctuation">)</span> <span class="token comment">//循环添加多个元素</span>

db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$addToSet:{hobby:<span class="token string">"java"</span>}}<span class="token punctuation">)</span> <span class="token comment">//若存在，不添加</span>
</code></pre> 
<h5><a id="_425"></a>删除元素</h5> 
<blockquote> 
 <p><strong>$pop --&gt; 类似弹栈</strong></p> 
 <blockquote> 
  <p><strong>1</strong> – 删除最后一个元素</p> 
  <p><strong>-1</strong> – 删除第一个元素</p> 
 </blockquote> 
 <p><strong>$pull --&gt; 删除指定的元素</strong></p> 
</blockquote> 
<pre><code class="prism language-sql">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$pop:{hobby:<span class="token number">1</span>}}<span class="token punctuation">)</span> <span class="token comment">//删除最后一个元素</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$pop:{hobby:<span class="token operator">-</span><span class="token number">1</span>}}<span class="token punctuation">)</span> <span class="token comment">//删除第一个元素</span>

db<span class="token punctuation">.</span>users<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$pull:{hobby:<span class="token string">"c"</span>}}<span class="token punctuation">)</span> <span class="token comment">//删除数组中”c“元素</span>
</code></pre> 
<h5><a id="_442"></a>修改元素</h5> 
<h6><a id="_444"></a>通过索引修改</h6> 
<pre><code class="prism language-sql"><span class="token comment">//把用户名为qwe的hobby的第三个元素修改为java</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span>}<span class="token punctuation">,</span> {$<span class="token keyword">set</span>:{<!-- --><span class="token string">"hobby.2"</span>:<span class="token string">"java"</span>}}<span class="token punctuation">)</span>
</code></pre> 
<h6><a id="_451"></a>通过元素修改</h6> 
<pre><code class="prism language-sql"><span class="token comment">//把用户名为qwe的hobby中的vue改为linux</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">"qwe"</span><span class="token punctuation">,</span> hobby:<span class="token string">"vue"</span>}<span class="token punctuation">,</span> {$<span class="token keyword">set</span>:{<!-- --><span class="token string">"hobby.$"</span>:<span class="token string">"linux"</span>}}<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p><mark>这里的<code>$</code>表示前面的<strong>vue</strong></mark></p> 
</blockquote> 
<h3><a id="Spring_Data_MongoDB_460"></a>Spring Data MongoDB</h3> 
<h4><a id="_462"></a>准备环境</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.3.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- lombok --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Spring boot data mongodb --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-mongodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="_493"></a>配置连接参数</h4> 
<pre><code class="prism language-properties"># application.properties
# 配置数据库连接
spring.data.mongodb.uri=mongodb://127.0.0.1:27017/数据库名

# 配置MongoTemplate的执行日志
logging.level.org.springframework.data.mongodb.core=DEBUG
</code></pre> 
<h4><a id="domain_504"></a>domain</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">)</span> <span class="token comment">//设置文档所在的集合</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Users</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> _id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="MongoRepository_521"></a>MongoRepository</h4> 
<p>该接口对MongoDB数据的常用操作进行了封装，我们只需要写个接口去继承该接口就能直接拥有CRUD等基本操作，再学习一下<u><strong>JPA</strong>的方法命名规范</u>，可以毫不费力的完成各种高级操作</p> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 自定义一个接口继承MongoRepository
 * 泛型1：domain类型
 * 泛型2：文档主键类型
 * 贴上@Repository注解，底层回创建出动态代理对象，交给Spring管理
 */</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMongoRepository</span> <span class="token keyword">extends</span> <span class="token class-name">MongoRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">,</span> <span class="token class-name">ObjectId</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//使用Spring Data命名规范做高级查询</span>
    <span class="token class-name">Users</span> <span class="token function">findByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="Spring_Data_539"></a>Spring Data方法命名规范</h4> 
<table><thead><tr><th align="center">关键字</th><th align="center">例子</th><th align="center">JPQL</th></tr></thead><tbody><tr><td align="center">And</td><td align="center">findByNameAndAge(String name, Integer age)</td><td align="center">where name=? and age=?</td></tr><tr><td align="center">Or</td><td align="center">findByNameOrAge(String name, String age)</td><td align="center">where name=? or age=?</td></tr><tr><td align="center">Is</td><td align="center">findByName(String name)</td><td align="center">where name=?</td></tr><tr><td align="center">Between</td><td align="center">findByAgeBetween(Integer min, Integer max)</td><td align="center">where age between ? and ?</td></tr><tr><td align="center">LessThan</td><td align="center">findByAgeLessThan(Integer age)</td><td align="center">where age&lt;?</td></tr><tr><td align="center">GreaterThan</td><td align="center">findByAgeGreaterThan(Integer age)</td><td align="center">where age&gt;?</td></tr><tr><td align="center">LessThanEqual</td><td align="center">findByAgeLessThanEqual(Integer age)</td><td align="center">where age&lt;=?</td></tr><tr><td align="center">GreaterThanEqual</td><td align="center">findByAgeGreaterThanEqual(Integer age)</td><td align="center">where age&gt;=?</td></tr><tr><td align="center">After</td><td align="center">等同于GreaterThan</td><td align="center"></td></tr><tr><td align="center">Before</td><td align="center">等同于LessThan</td><td align="center"></td></tr><tr><td align="center">IsNull</td><td align="center">findByNameIsNull()</td><td align="center">where name is null</td></tr><tr><td align="center">IsNotNull</td><td align="center">findByNameIsNotNull()</td><td align="center">where name is not null</td></tr><tr><td align="center">Like</td><td align="center">findByNameLike(String name)</td><td align="center">where name like ?</td></tr><tr><td align="center">NotLike</td><td align="center">findByNameNotLike(String name)</td><td align="center">where name not like ?</td></tr><tr><td align="center">StartingWith</td><td align="center">findByNameStartingWith(String name)</td><td align="center">where name like ‘?%’</td></tr><tr><td align="center">EndingWith</td><td align="center">findByNameEndingWith(String name)</td><td align="center">where name like ‘%?’</td></tr><tr><td align="center">Containing</td><td align="center">findByNameContaining(String name)</td><td align="center">where name like ‘%?%’</td></tr><tr><td align="center">OrderByXx[desc]</td><td align="center">findByIdOrderByXx[Desc](Long id)</td><td align="center">where id=? order by Xx [Desc]</td></tr><tr><td align="center">Not</td><td align="center">findByNameNot(String name)</td><td align="center">where name !=?</td></tr><tr><td align="center">In</td><td align="center">findByIdIn(List ids)</td><td align="center">where id in (…)</td></tr><tr><td align="center">NotIn</td><td align="center">findByIdNotIn(List ids)</td><td align="center">where id not in (…)</td></tr><tr><td align="center">True</td><td align="center">findByXxTrue()</td><td align="center">where Xx = true</td></tr><tr><td align="center">False</td><td align="center">findByXxFalse()</td><td align="center">where Xx = false</td></tr><tr><td align="center">IgnoreCase</td><td align="center">findByNameIgnoreCase(String name)</td><td align="center">where name=?（忽略大小写）</td></tr></tbody></table> 
<h4><a id="Test_568"></a>Test</h4> 
<p>在测试类中注入<code>UserMongoRepository</code></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">UserMongoRepository</span> repository<span class="token punctuation">;</span>
</code></pre> 
<ul><li> <p><strong>插入/更新一个文档</strong></p> <pre><code class="prism language-Java">@Test
public void testSaveOrUpdate() {
    Users users = new Users();
    users.set_id(null);
    users.setId(5L);
    users.setName("珊迪");
    users.setAge(18);
    repository.save(users);
}
</code></pre> <p>日志：</p> <pre><code class="prism language-json">Inserting Document containing fields<span class="token operator">:</span> 
<span class="token punctuation">[</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> _class<span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token literal-property property">collection</span><span class="token operator">:</span> users
</code></pre> </li><li> <p><strong>删除一个文档</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    repository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectId</span><span class="token punctuation">(</span><span class="token string">"63b05590920e000023000c27"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>日志：</p> <pre><code class="prism language-json">Remove using query<span class="token operator">:</span>
<span class="token punctuation">{<!-- --></span> <span class="token string-property property">"_id"</span> <span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"$oid"</span> <span class="token operator">:</span> <span class="token string">"63b05590920e000023000c27"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> 
<span class="token keyword">in</span> <span class="token literal-property property">collection</span><span class="token operator">:</span> users
</code></pre> </li><li> <p><strong>查询一个文档</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">&gt;</span></span> optional <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectId</span><span class="token punctuation">(</span><span class="token string">"63b05590920e000023000c25"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    optional<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>日志：</p> <pre><code class="prism language-json">findOne using query<span class="token operator">:</span> 
<span class="token punctuation">{<!-- --></span> <span class="token string-property property">"_id"</span> <span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token string-property property">"$oid"</span> <span class="token operator">:</span> <span class="token string">"63b05590920e000023000c25"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> fields<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span> <span class="token keyword">in</span> db<span class="token punctuation">.</span>collection<span class="token operator">:</span> czh20<span class="token punctuation">.</span>users
</code></pre> </li><li> <p><strong>根据姓名查询一个文档</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testByName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Users</span> u <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findByName</span><span class="token punctuation">(</span><span class="token string">"海绵宝宝"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>日志：</p> <pre><code class="prism language-json">find using query<span class="token operator">:</span>
<span class="token punctuation">{<!-- --></span> <span class="token string-property property">"name"</span> <span class="token operator">:</span> <span class="token string">"海绵宝宝"</span> <span class="token punctuation">}</span> fields<span class="token operator">:</span> Document<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">}</span> 
<span class="token keyword">for</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token keyword">class</span> <span class="token class-name">cn<span class="token punctuation">.</span>czh20<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>Users</span> <span class="token keyword">in</span> <span class="token literal-property property">collection</span><span class="token operator">:</span> users
</code></pre> </li><li> <p><strong>查询所有文档</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>日志：</p> <pre><code class="prism language-json">find using query<span class="token operator">:</span> 
<span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span> fields<span class="token operator">:</span> Document<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">}</span> 
<span class="token keyword">for</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token keyword">class</span> <span class="token class-name">cn<span class="token punctuation">.</span>czh20<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>Users</span> <span class="token keyword">in</span> <span class="token literal-property property">collection</span><span class="token operator">:</span> users
</code></pre> </li></ul> 
<h4><a id="MongoTemplate_670"></a>MongoTemplate</h4> 
<p>该对象有Spring Boot完成了自动装配，存入Spring容器中，我们直接注入就可以使用了，依靠该对象能完成任何MongoDB的操作，一般和MongoRepository分工合作，多数用于复杂的高级查询以及底层操作</p> 
<h5><a id="_674"></a>条件查询</h5> 
<p>Query对象用于封装查询条件，配合Criteria一起使用，来完成各种条件的描述</p> 
<pre><code class="prism language-java"><span class="token comment">//一个Criteria对象可以理解为是一个限定条件</span>
<span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token class-name">Object</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置一个等值条件</span>
<span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">orOperator</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置一组或的逻辑条件</span>

<span class="token comment">//模糊查询</span>
<span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span><span class="token class-name">String</span> regex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//使用正则表达式匹配查询</span>
注意：<span class="token class-name">Criteria</span>对象可以由其静态方法和构造器获取
<span class="token class-name">Criteria</span>封装了所有对条件的描述，常见的方法有：
lt <span class="token operator">/</span> lte <span class="token operator">/</span> gt <span class="token operator">/</span> gte <span class="token operator">/</span> ne <span class="token operator">/</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>最后通过Query对象的addCriteria把条件封装到Query对象中</p> 
<pre><code class="prism language-java"><span class="token class-name">Query</span>对象<span class="token punctuation">.</span><span class="token function">addCriteria</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span> criteria<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加查询条件</span>
<span class="token class-name">Query</span>对象<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//分页查询</span>
</code></pre> 
<h5><a id="API_697"></a>API方法</h5> 
<pre><code class="prism language-java"><span class="token comment">//根据条件查询集合中的文档</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Query</span> query<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">,</span> <span class="token class-name">String</span> collectionName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="API_704"></a>API使用</h5> 
<p>在测试类中注入<code>MongoTemplate</code></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">MongoTemplate</span> template<span class="token punctuation">;</span>
</code></pre> 
<ul><li> <p><strong>分页查询文档，显示第二页，每页显示2条数据，按照id升序排列</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQuery1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//创建查询对象</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置分页信息</span>
    query<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置排序规则</span>
    query<span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Sort</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Direction</span><span class="token punctuation">.</span><span class="token constant">ASC</span><span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Users</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">"users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p><strong>查询所有name为派大星或者age&lt;20的文档</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQuery2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//构建限制条件 {"$or": [{"name": "派大星"}, {"age": {"$lt":20}}]}</span>
    <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Criteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orOperator</span><span class="token punctuation">(</span>
            <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">"派大星"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//创建查询对象</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加限制条件</span>
    query<span class="token punctuation">.</span><span class="token function">addCriteria</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Users</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">"users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p><strong>查询所有name含有"海"并且 1&lt;=age&lt;=20的文档</strong></p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQuery3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//构建查询条件</span>
    <span class="token comment">// db.users.find({"$and": [{"name": {"$regex": ".*海.*"}},{"age": {$gte": 1,"$lte": 20}}]})</span>
    <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Criteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">andOperator</span><span class="token punctuation">(</span>
            <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span><span class="token string">".*海.*"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gte</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lte</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//创建查询对象</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加限制条件</span>
    query<span class="token punctuation">.</span><span class="token function">addCriteria</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Users</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">"users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> </li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/50a2e04ae4e4157c1ee1408219e78f7d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SHELL脚本 遍历文件夹下所有文件以及子文件夹</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a93c6e1d0e6346850fc688b200a6c6a7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">已安装成功的Python包，无法被IDE解析的解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>