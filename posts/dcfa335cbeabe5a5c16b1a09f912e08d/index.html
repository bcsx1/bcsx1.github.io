<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Introduction to the AMQP 0-9-1 Model - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Introduction to the AMQP 0-9-1 Model" />
<meta property="og:description" content="About This Guide This guide explains the AMQP 0-9-1 model used by RabbitMQ. The original version was written and kindly contributed by Michael Klishin and edited by Chris Duncan.
High-level Overview of AMQP 0-9-1 and the AMQP Model What is AMQP? AMQP (Advanced Message Queuing Protocol) is a networking protocol that enables conforming client applications to communicate with conforming messaging middleware brokers.
Brokers and Their Role brokers 从producers（产生消息的应用）接收消息然后转发给consumers（处理消息的应用）。
AMQP 0-9-1 Model in Brief AMQP 0-9-1 模型的世界观：生产者产生消息，并发送到交换机--可以类比邮局或者邮箱。交换机根据绑定规则将消息分发到队列。要么由AMQP broker将消息递送到订阅队列的消费者，要么由消费者按需主动的从队列中获取。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/dcfa335cbeabe5a5c16b1a09f912e08d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-10-25T00:39:20+08:00" />
<meta property="article:modified_time" content="2011-10-25T00:39:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Introduction to the AMQP 0-9-1 Model</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="iteye-blog-content-contain" style="font-size:14px;"> 
 <p> </p> 
 <div class="docToc" style="border:1px solid #e4e4e4;"> 
  <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;color:#ff6600;font-size:1.2em;"> </h4> 
 </div> 
 <div class="docSection"> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">About This Guide</h3> 
  <p style="clear:left;">This guide explains the AMQP 0-9-1 model used by RabbitMQ. The <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://bit.ly/amqp-model-explained" rel="nofollow">original version</a> was written and kindly contributed by <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://twitter.com/michaelklishin" rel="nofollow">Michael Klishin</a> and edited by <a style="color:#444444;text-decoration:none;font-weight:bold;" href="https://twitter.com/celldee" rel="nofollow">Chris Duncan</a>.</p> 
 </div> 
 <div class="docSection"> 
  <a id="highlevel-overview" name="highlevel-overview"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">High-level Overview of AMQP 0-9-1 and the AMQP Model</h3> 
  <div class="docSubsection"> 
   <a id="what-is-amqp" name="what-is-amqp"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">What is AMQP?</h4> 
   <p style="clear:left;">AMQP (Advanced Message Queuing Protocol) is a networking protocol that enables conforming client applications to communicate with conforming messaging middleware brokers.</p> 
  </div> 
  <div class="docSubsection"> 
   <a id="brokers-role" name="brokers-role"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Brokers and Their Role</h4> 
   <p style="clear:left;">brokers 从producers（产生消息的应用）接收消息然后转发给consumers（处理消息的应用）。</p> 
  </div> 
  <div class="docSubsection"> 
   <a id="amqp-model" name="amqp-model"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">AMQP 0-9-1 Model in Brief</h4> 
   <p style="clear:left;">AMQP 0-9-1 模型的世界观：生产者产生消息，并发送到交换机--可以类比邮局或者邮箱。交换机根据绑定规则将消息分发到队列。要么由AMQP broker将消息递送到订阅队列的消费者，要么由消费者按需主动的从队列中获取。</p> 
   <p style="clear:left;"><img src="https://images2.imgbox.com/4f/62/zy5AUBQw_o.png" alt="Publish path from publisher to consumer via                              exchange and queue"></p> 
   <p style="clear:left;">When publishing a message, producers may specify various <em>message attributes</em> (message meta-data). Some of this meta-data may be used by the broker, however, the rest of it is completely opaque to the broker and is only used by applications that receive the message.</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">网络的不可靠导致应用可能不能正常的处理消息，为此AMQP模型引入了“消息应答”的概念：当消息递送到消费者后，消费者通知broker；应答可以是自动的或者由应用的开发者自行来决定。当启用应答机制后，broker只有在收到应答后才从队列中删除消息。</p> 
   <p style="clear:left;">某些情况下，例如消息因找不到路由规则而无法被转发，则处理方式包括返还给生产者、丢弃或者暂存到“死信队列”。 生产者通过在发送消息的时候设置参数来决定如何处理这些问题。</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">队列、交换机、绑定，这些都是 AMQP模型中的实体。</p> 
   <p style="clear:left;"> </p> 
  </div> 
  <div class="docSubsection"> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">AMQP is a Programmable Protocol</h4> 
   <p style="clear:left;">AMQP 0-9-1 is a programmable protocol in the sense that AMQP entities and routing schemes are defined by applications themselves, not a broker administrator. Accordingly, provision is made for protocol operations that declare queues and exchanges, define bindings between them, subscribe to queues and so on.</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">这给应用程序开发者带来了极大的自由，但同时他们也应该注意到潜在的定义冲突。实际上，定义冲突很少发生，一旦发生通常意味着错误的配置。应用定义了所需要的AMQP实体好必要的路由schema，并可能在不需要的时候删除它们。</p> 
   <p style="clear:left;"> </p> 
  </div> 
 </div> 
 <div class="docSection"> 
  <a id="exchanges" name="exchanges"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Exchanges and Exchange Types</h3> 
  <p style="clear:left;"><em> </em></p> 
  <p style="clear:left;">Exchanges是一种AMQP实体，它是消息的发送对象。它接收消息并路由给零个或者多个queue。所使用的路由机制，依赖于exchange的类型和规则，又叫binds。 AMQP 0-9-1提供了四种exchange类型：</p> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;"> </p> 
  <table border="0" cellspacing="0" cellpadding="0"><tbody><tr style="vertical-align:top;"><th style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">Name</th><th style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">Default pre-declared names</th></tr><tr style="vertical-align:top;"><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">Direct exchange</td><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">(Empty string) and amq.direct</td></tr><tr style="vertical-align:top;"><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">Fanout exchange</td><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">amq.fanout</td></tr><tr style="vertical-align:top;"><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">Topic exchange</td><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">amq.topic</td></tr><tr style="vertical-align:top;"><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">Headers exchange</td><td style="border-bottom-color:#e4e4e4;border-bottom-width:1px;border-bottom-style:solid;border-right-color:#e4e4e4;border-right-width:1px;border-right-style:solid;text-align:left;">amq.match (and amq.headers in RabbitMQ)</td></tr></tbody></table> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">除了类型，exchanges还定义了一些属性，最重要的属性包括：</p> 
  <ul class="plain" style="margin-left:10px;"><li style="background-image:none;margin-left:10px;">Name</li><li style="background-image:none;margin-left:10px;">Durability (exchanges survive broker restart)</li><li style="background-image:none;margin-left:10px;">Auto-delete (exchange is deleted when all queues have finished using it)</li><li style="background-image:none;margin-left:10px;">Arguments (these are broker-dependent)</li></ul> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">Exchanges可以是durable或transient。前者当broker重启后仍然有效，而后者当broker重启后即消失。并非所有场景和用例都需要durable的exchange。</p> 
  <p style="clear:left;"> </p> 
  <div class="docSubsection"> 
   <a id="exchange-default" name="exchange-default"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Default Exchange</h4> 
   <p style="clear:left;">broker预定义了一个默认的交换机，它是一个direct类型的无名交换机。它有一个特殊的属性从而非常适用于简单的应用场景：每个队列创建后，自动以队列名称作为key绑定到此交换机上。</p> 
   <p style="clear:left;">例如，假设你定义了一个名为 "search-indexing-online"的queue，broker会以 "search-indexing-online"为routing key，将此queue绑定到默认的exchange上。因而，若一个message以 "search-indexing-online"为routing key发布到默认的exchange，就会被路由到此queue。换句话说，默认的exchange看上去可以直接将消息路由到队列，其实并非如此（有一个自动的绑定动作）</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;"> </p> 
  </div> 
  <div class="docSubsection"> 
   <a id="exchange-direct" name="exchange-direct"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Direct Exchange</h4> 
   <p style="clear:left;">A direct exchange delivers messages to queues based on the message routing key. A direct exchange is ideal for the unicast routing of messages (although they can be used for multicast routing as well). Here is how it works:</p> 
   <ul><li style="background-position:1px 12px;">A queue binds to the exchange with a routing key K</li><li style="background-position:1px 12px;">When a new message with routing key R arrives at the direct exchange, the exchange routes it to the queue if K = R</li></ul> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">direct exchanges最适用于以RR的方式在多个worker之间分发任务。在AMQP 0.9.1模型中，有一点非常重要：消息是在多个消费者之间进行负载均衡的，而并非在多个队列之间。</p> 
  </div> 
  <div class="docSubsection"> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">A direct exchange can be represented graphically as follows:<img src="https://images2.imgbox.com/73/4f/Z8o776ru_o.png" alt="exchange delivering messages to  queues based on routing key"></p> 
  </div> 
  <div class="docSubsection"> 
   <a id="exchange-fanout" name="exchange-fanout"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Fanout Exchange</h4> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">fanout exchange，将消息路由给所有绑定到它的queue，路由key被完全忽略。如果有N个queue绑定到fanout exchange上，当一个消息发布到该exchange，在会为每个queue拷贝一份消息并递送给它。Fanout exchange非常适合广播消息。</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">Because a fanout exchange delivers a copy of a message to every queue bound to it, its use cases are quite similar:</p> 
   <ul><li style="background-position:1px 12px;">Massively multi-player online (MMO) games can use it for leaderboard updates or other global events</li><li style="background-position:1px 12px;">Sport news sites can use fanout exchanges for distributing score updates to mobile clients in near real-time</li><li style="background-position:1px 12px;">Distributed systems can broadcast various state and configuration updates</li><li style="background-position:1px 12px;">Group chats can distribute messages between participants using a fanout exchange (although AMQP does not have a built-in concept of presence, so XMPP may be a better choice)</li></ul> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">A fanout exchange can be represented graphically as follows:<img src="https://images2.imgbox.com/46/d9/qPp50eJd_o.png" alt="exchange delivering messages to three queues"></p> 
  </div> 
  <div class="docSubsection"> 
   <a id="exchange-topic" name="exchange-topic"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Topic Exchange</h4> 
   <p style="clear:left;">Topic exchanges根据路由key和绑定模式来转发消息到一个或多个queue，它适合于多播类型的消息。</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">topic exchanges 有大量的使用场景。当涉及到多个消费者/应用需要选择性的接收消息时，就可以考虑topic exchange。</p> 
   <p style="clear:left;">实例场景：</p> 
   <ul><li style="background-position:1px 12px;">Distributing data relevant to specific geographic location, for example, points of sale</li><li style="background-position:1px 12px;">Background task processing done by multiple workers, each capable of handling specific set of tasks</li><li style="background-position:1px 12px;">Stocks price updates (and updates on other kinds of financial data)</li><li style="background-position:1px 12px;">股票价格变动</li><li style="background-position:1px 12px;">News updates that involve categorization or tagging (for example, only for a particular sport or team)</li><li style="background-position:1px 12px;">Orchestration of services of different kinds in the cloud</li><li style="background-position:1px 12px;">Distributed architecture/OS-specific software builds or packaging where each builder can handle only one architecture or OS</li></ul> 
   <p style="clear:left;"> </p> 
  </div> 
  <div class="docSubsection"> 
   <a id="exchange-headers" name="exchange-headers"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Headers Exchange</h4> 
   <p style="clear:left;">A headers exchange is designed to for routing on multiple attributes that are more easily expressed as message headers than a routing key. Headers exchanges ignore the routing key attribute. Instead, the attributes used for routing are taken from the headers attribute. A message is considered matching if the value of the header equals the value specified upon binding.</p> 
   <p style="clear:left;">It is possible to bind a queue to a headers exchange using more than one header for matching. In this case, the broker needs one more piece of information from the application developer, namely, should it consider messages with any of the headers matching, or all of them? This is what the "x-match" binding argument is for. When the "x-match" argument is set to "any", just one matching header value is sufficient. Alternatively, setting "x-match" to "all" mandates that all the values must match.</p> 
   <p style="clear:left;">Headers exchanges can be looked upon as "direct exchanges on steroids". Because they route based on header values, they can be used as direct exchanges where the routing key does not have to be a string; it could be an integer or a hash (dictionary) for example.</p> 
   <p style="clear:left;"> </p> 
  </div> 
 </div> 
 <div class="docSection"> 
  <a id="queues" name="queues"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Queues</h3> 
  <p style="clear:left;">AMQP中的queue，同其它消息队列或者任务队列中的queue的概念非常相似：它们存储消息，这些消息最终将提供给作为消费者的应用。Queue共享了exchanges的一些属性，但也具有自己额外的属性：</p> 
  <p style="clear:left;"> </p> 
  <ul class="plain" style="margin-left:10px;"><li style="background-image:none;margin-left:10px;">Name</li><li style="background-image:none;margin-left:10px;">Durable (the queue will survive a broker restart)</li><li style="background-image:none;margin-left:10px;">Exclusive (used by only one connection and the queue will be deleted when that connection closes)</li><li style="background-image:none;margin-left:10px;">Auto-delete (queue is deleted when last consumer unsubscribes)</li><li style="background-image:none;margin-left:10px;">Arguments (some brokers use it to implement additional features like message TTL)</li></ul> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">首先要定义Queue然后才能使用。定义Queue会创建它。如果一个queue已经存在且属性完全一样，则定义Queue的操作不起作用。如果queue名称一样，但属性不一样，则会抛出一个channel级别的异常，异常代号为406 (<span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">PRECONDITION_FAILED</span>) 。</p> 
  <p style="clear:left;"> </p> 
  <div class="docSubsection"> 
   <a id="queue-names" name="queue-names"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Queue Names</h4> 
   <p style="clear:left;">Applications may pick queue names or ask the broker to generate a name for them. Queue names may be up to 255 bytes of UTF-8 characters. To ask an AMQP broker to generate a unique queue name for you, pass an empty string as the queue name argument: The same generated name may be obtained by subsequent methods in the same channel by using the empty string where a queue name is expected. This works because the channel remembers the last server-generated queue name.</p> 
   <p style="clear:left;">Queue names starting with "amq." are reserved for internal use by the broker. Attempts to declare a queue with a name that violates this rule will result in a channel-level exception with reply code 403 (<span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">ACCESS_REFUSED</span>).</p> 
  </div> 
  <div class="docSubsection"> 
   <a id="queue-durability" name="queue-durability"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Queue Durability</h4> 
   <p style="clear:left;">Durable queues are persisted to disk and thus survive broker restarts. Queues that are not durable are called transient. Not all scenarios and use cases mandate queues to be durable.</p> 
   <p style="clear:left;">Note that only durable queues can be bound to durable exchanges. This guarantees that it is possible to restore bindings on broker restart.</p> 
   <p style="clear:left;">Durability of a queue does not make <em>messages</em> that are routed to that queue durable. If broker is taken down and then brought back up, durable queue will be re-declared during broker startup, however, only <em>persistent</em> messages will be recovered.</p> 
  </div> 
 </div> 
 <div class="docSection"> 
  <a id="bindings" name="bindings"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Bindings</h3> 
  <p style="clear:left;">Bindings are rules that exchanges use (among other things) to route messages to queues. To instruct an exchange E to route messages to a queue Q, Q has to be <em>bound</em> to E. Bindings may have an optional <em>routing key</em> attribute used by some exchange types. The purpose of the routing key is to select certain messages published to an exchange to be routed the bound queue. In other words, the routing key acts like a filter.</p> 
  <p style="clear:left;">To draw an analogy:</p> 
  <ul><li style="background-position:1px 12px;">Queue is like your destination in New York city</li><li style="background-position:1px 12px;">Exchange is like JFK airport</li><li style="background-position:1px 12px;">Bindings are routes from JFK to your destination. There can be zero or many ways to reach it</li></ul> 
  <p style="clear:left;">Having this layer of indirection enables routing scenarios that are impossible or very hard to implement using publishing directly to queues and also eliminates certain amount of duplicated work application developers have to do.</p> 
  <p style="clear:left;">If AMQP message cannot be routed to any queue (for example, because there are no bindings for the exchange it was published to) it is either dropped or returned to the publisher, depending on message attributes the publisher has set.</p> 
 </div> 
 <div class="docSection"> 
  <a id="consumers" name="consumers"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Consumers</h3> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">仅仅把消息保存在queue中是没有意义的，必须有应用来消费它们。AMQP提供了两种方式让应用来消费消息：</p> 
  <ul><li style="background-position:1px 12px;">推送消息到消费者 ("push API")</li><li style="background-position:1px 12px;">消费者主动来拉消息 ("pull API")</li></ul> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">使用"push API"，应用必须标明想从哪个queue 获取消息。此时，我们说queue上注册了一个消费者，或者说一个消费者订阅了一个queue。可以在一个queue上注册多个消费者，也可以注册一个排他性的消费者（当它在消费的时候，不允许其它消费者来获取消息）。</p> 
  <p style="clear:left;">每个消费者都有一个唯一的consumer tag，可用于取消订阅消息。consumer tag 实质是一个字符串。</p> 
  <div class="docSubsection"> 
   <a id="message-acknowledge" name="message-acknowledge"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Message Acknowledgements</h4> 
   <p style="clear:left;">消费者，可能在偶然情况下，处理消息失败，或者有时候它会异常退出。在网络故障情况下，也可能导致问题。这带来一个问题：什么情况下，broker可以确信能从queue中删除一个消息？ AMQP规范提供了两种选择：</p> 
   <ul><li style="background-position:1px 12px;">当broker将消息发送到一个应用（通过 <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.deliver</span> 或 <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.get-ok</span> 操作)</li><li style="background-position:1px 12px;">当收到消费者的应答后（通过 <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.ack</span> AMQP method).</li></ul> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">前者称作自动应答模型，后者称作显示应答模型。采用后一种模型，消费者需要决定何时发送应答。可以在收到消息后立刻应答，也可以在将消息持续化到存储系统但尚没有处理时，或者是在处理结束后。</p> 
   <p style="clear:left;"> </p> 
   <p style="clear:left;">如果消费者挂掉了，来不及应答，broker可以讲消息投递给其它消费者，或者等待其它消费者注册上来再重新投递。</p> 
  </div> 
  <div class="docSubsection"> 
   <a id="messages-reject" name="messages-reject"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Rejecting Messages</h4> 
   <p style="clear:left;">When a consumer application receives a message, processing of that message may or may not succeed. An application can indicate to the broker that message processing has failed (or cannot be accomplished at the time) by rejecting a message. When rejecting a message, an application can ask the broker to discard or requeue it. When there is only one consumer on a queue, make sure you do not create infinite message delivery loops by rejecting and requeueing a message from the same consumer over and over again.</p> 
  </div> 
  <div class="docSubsection"> 
   <a id="messages-nack" name="messages-nack"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Negative Acknowledgements</h4> 
   <p style="clear:left;">Messages are rejected with the <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.reject</span> AMQP method. There is one limitation that <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.reject</span> has: there is no way to reject multiple messages as you can do with acknowledgements. However, if you are using RabbitMQ, then there is a solution. RabbitMQ provides an AMQP 0-9-1 extension known as <em>negative acknowledgements</em> or <em>nacks</em>. For more information, please refer to the <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/extensions.html#negative-acknowledgements" rel="nofollow">Rabbit-specific extensions</a>.</p> 
  </div> 
  <div class="docSubsection"> 
   <a id="messages-prefetch" name="messages-prefetch"></a> 
   <h4 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.2em;">Prefetching Messages</h4> 
   <p style="clear:left;">For cases when multiple consumers share a queue, it is useful to be able to specify how many messages each consumer can be sent at once before sending the next acknowledgement. This can be used as a simple load balancing technique or to improve throughput if messages tend to be published in batches. For example, if a producing application sends messages every minute because of the nature of the work it is doing.</p> 
   <p style="clear:left;">Note that RabbitMQ only supports channel-level prefetch-count, not connection or size based prefetching.</p> 
  </div> 
 </div> 
 <div class="docSection"> 
  <a id="messages" name="messages"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Message Attributes and Payload</h3> 
  <p style="clear:left;">Messages in the AMQP model have <em>attributes</em>. Some attributes are so common that the AMQP 0-9-1 specification defines them and application developers do not have to think about the exact attribute name. Some examples are</p> 
  <ul class="plain" style="margin-left:10px;"><li style="background-image:none;margin-left:10px;">Content type</li><li style="background-image:none;margin-left:10px;">Content encoding</li><li style="background-image:none;margin-left:10px;">Routing key</li><li style="background-image:none;margin-left:10px;">Delivery mode (persistent or not)</li><li style="background-image:none;margin-left:10px;">Message priority</li><li style="background-image:none;margin-left:10px;">Message publishing timestamp</li><li style="background-image:none;margin-left:10px;">Expiration period</li><li style="background-image:none;margin-left:10px;">Producer application id</li></ul> 
  <p style="clear:left;">Some attributes are used by AMQP brokers, but most are open to interpretation by applications that receive them. Some attributes are optional and known as <em>headers</em>. They are similar to X-Headers in HTTP. Message attributes are set when a message is published.</p> 
  <p style="clear:left;">AMQP messages also have a <em>payload</em> (the data that they carry), which AMQP brokers treat as an opaque byte array. The broker will not inspect or modify the payload. It is possible for messages to contain only attributes and no payload. It is common to use serialisation formats like JSON, Thrift, Protocol Buffers and MessagePack to serialize structured data in order to publish it as the message payload. AMQP peers typically use the "content-type" and "content-encoding" fields to communicate this information, but this is by convention only.</p> 
  <p style="clear:left;">Messages may be published as persistent, which makes AMQP broker persist them to disk. If the server is restarted the system ensures that received persistent messages are not lost. Simply publishing message to a durable exchange or the fact that queue(s) they are routed to is durable doesn't make messages persistent: it all depends on persistence mode of the messages itself. Publishing messages as persistent affects performance (just like with data stores, durability comes at a certain cost in performance).</p> 
 </div> 
 <div class="docSection"> 
  <a id="acknowledgements" name="acknowledgements"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Message Acknowledgements</h3> 
  <p style="clear:left;">Since networks are unreliable and applications fail, it is often necessary to have some kind of processing acknowledgement. Sometimes it is only necessary to acknowledge the fact that a message has been received. Sometimes acknowledgements mean that a message was validated and processed by a consumer, for example, verified as having mandatory data and persisted to a data store or indexed.</p> 
  <p style="clear:left;">This situation is very common, so AMQP 0-9-1 has a built-in feature called <em>message acknowledgements</em> (sometimes referred to as <em>acks</em>) that consumers use to confirm message delivery and/or processing. If an application crashes (AMQP broker notices this when connection is closed), if an acknowledgement for a message was expected but not received by the AMQP broker, the message is re-queued (and possibly immediately delivered to another consumer, if any exists).</p> 
  <p style="clear:left;">Having acknowledgements built into the protocol helps developers to build more robust software.</p> 
 </div> 
 <div class="docSection"> 
  <a id="amqp-methods" name="amqp-methods"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">AMQP 0-9-1 Methods</h3> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">AMQP 0-9-1由一组methods组成。方法是一种操作（类似于HTTP 方法），而跟 OOP完全无关。方法被组合成类。类是方法逻辑上的组合。</p> 
  <p style="clear:left;">下面看看 exchange class （一组跟exchanges相关的操作），它包含了以下操作：</p> 
  <p style="clear:left;"> </p> 
  <ul class="plain" style="margin-left:10px;"><li style="background-image:none;margin-left:10px;"><span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare</span></li><li style="background-image:none;margin-left:10px;"><span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare-ok</span></li><li style="background-image:none;margin-left:10px;"><span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.delete</span></li><li style="background-image:none;margin-left:10px;"><span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.delete-ok</span></li></ul> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">（注意，RabbitMQ针对exchange class，定义了自己的扩展的方法，本文不予讨论）。</p> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">The operations above form logical pairs: <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare</span> and <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare-ok</span>, <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.delete</span> and <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.delete-ok</span>. These operations are "requests" (sent by clients) and "responses" (sent by brokers in response to the aforementioned "requests").</p> 
  <p style="clear:left;">As an example, the client asks the broker to declare a new exchange using the <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare</span> method:</p> 
  <p style="clear:left;"><img src="https://images2.imgbox.com/88/07/5cuRjEMr_o.png" alt="exchange.declare"></p> 
  <p style="clear:left;">As shown on the diagram above, <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare</span> carries several <em>parameters</em>. They enable the client to specify exchange name, type, durability flag and so on.</p> 
  <p style="clear:left;">If the operation succeeds, the broker responds with the <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare-ok</span> method:</p> 
  <p style="clear:left;"><img src="https://images2.imgbox.com/24/e0/nsu3XHKs_o.png" alt="exchange.declare-ok"></p> 
  <p style="clear:left;"><span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">exchange.declare-ok</span> does not carry any parameters except for the channel number (channels will be described later in this guide).</p> 
  <p style="clear:left;">The sequence of events is very similar for another method pair on the AMQP <em>queue</em> class: <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">queue.declare</span> and <span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">queue.declare-ok</span>:</p> 
  <p style="clear:left;"><img src="https://images2.imgbox.com/0e/93/1cZYlrDK_o.png" alt="queue.declare"></p> 
  <p style="clear:left;"><img src="https://images2.imgbox.com/21/2e/IE4RKSWB_o.png" alt="queue.declare-ok"></p> 
  <p style="clear:left;">Not all AMQP methods have counterparts. Some (<span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.publish</span> being the most widely used one) do not have corresponding "response" methods and some others (<span class="code" style="color:#333333;font-family:'Courier New', Courier, monospace;font-size:small;">basic.get</span>, for example) have more than one possible "response".</p> 
 </div> 
 <div class="docSection"> 
  <a id="amqp-connections" name="amqp-connections"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Connections</h3> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;">APMQ的连接通常要保持一段时间。它是一种应用层协议，底层采用TCP来保证可靠性。AMQP连接需要身份认证，且可通过TLS(SSL)来保护安全。若应用不再需要连接到一个AMQP broker，则它应该优雅的关闭连接，而不是粗暴的直接关闭底层的TCP连接。</p> 
  <p style="clear:left;"> </p> 
 </div> 
 <div class="docSection"> 
  <a id="amqp-channels" name="amqp-channels"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Channels</h3> 
  <p style="clear:left;">有些应用需要与一个broker建立多个连接。但是，同时维持大量TCP连接是不明智的，那样会耗费系统资源，同时也对防火墙配置带来麻烦。 AMQP连接是可复用的，可以把channels看做“共享单条TCP连接的轻量级连接”。</p> 
  <p style="clear:left;">对于使用多线程/多进程的应用，通常是为每个线程/进程打开一个channel，而不是在它们之间共享channel.</p> 
  <p style="clear:left;">在一个channel内的通信，是与其它channel内的通信完全隔离的。因此，每个AMQP操作消息都携带一个channel number，指定了该操作作用于哪个channel。</p> 
  <p style="clear:left;"> </p> 
  <p style="clear:left;"> </p> 
 </div> 
 <div class="docSection"> 
  <a id="amqp-vhosts" name="amqp-vhosts"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">Virtual Hosts</h3> 
  <p style="clear:left;">为了让一个broker能提供多个隔离的“环境”（一组用户、exchanges，queues等等），AMQP提供了虚拟主机的概念。这个跟web server的虚拟主机的概念很相似，可以为AMQP实体提供完全隔离的环境。AMQP客户端负责在创建AMQP连接的过程中指定所使用的虚拟主机。</p> 
  <p style="clear:left;"> </p> 
 </div> 
 <div class="docSection"> 
  <a id="amqp-extensibility" name="amqp-extensibility"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">AMQP is Extensible</h3> 
  <p style="clear:left;">AMQP 0-9-1 has several extension points:</p> 
  <ul><li style="background-position:1px 12px;"> <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/devtools.html#miscellaneous" rel="nofollow">Custom exchange types</a> let developers implement routing schemes that exchange types provided out-of-the-box do not cover well, for example, geodata-based routing.</li><li style="background-position:1px 12px;">Declaration of exchanges and queues can include additional attributes that the broker can use. For example, <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/extensions.html#queue-ttl" rel="nofollow">per-queue message TTL</a> in RabbitMQ is implemented this way.</li><li style="background-position:1px 12px;">Broker-specific extensions to the protocol. See, for example, <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/extensions.html" rel="nofollow">extensions that RabbitMQ implements</a>.</li><li style="background-position:1px 12px;"> <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/amqp-0-9-1-quickref.html#class.confirm" rel="nofollow">New AMQP 0-9-1 method classes</a> can be introduced.</li><li style="background-position:1px 12px;">Brokers can be extended with <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/plugins.html" rel="nofollow">additional plugins</a>, for example, the <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/management.html" rel="nofollow">RabbitMQ management</a> frontend and HTTP API are implemented as a plugin.</li></ul> 
  <p style="clear:left;">These features make the AMQP 0-9-1 Model even more flexible and applicable to a very broad range of problems.</p> 
 </div> 
 <div class="docSection"> 
  <a id="amqp-clients" name="amqp-clients"></a> 
  <h3 class="docHeading" style="font-family:Helvetica, Arial, sans-serif;margin-left:0px;color:#ff6600;font-size:1.7em;">AMQP 0-9-1 Clients Ecosystem</h3> 
  <p style="clear:left;">There are <a style="color:#444444;text-decoration:none;font-weight:bold;" href="http://www.rabbitmq.com/devtools.html" rel="nofollow">many AMQP 0-9-1 clients</a> for many popular programming languages and platforms. Some of them follow AMQP terminology closely and only provide implementation of AMQP methods. Some others have additional features, convenience methods and abstractions. Some of the clients are asynchronous (non-blocking), some are synchronous (blocking), some support both models. Some clients support vendor-specific extensions (for example, RabbitMQ-specific extensions).</p> 
  <p style="clear:left;">Because one of the main AMQP goals is interoperability, it is a good idea for developers to understand protocol operations and not limit themselves to terminology of a particular client library. This way communicating with developers using different libraries will be significantly easier.</p> 
 </div> 
 <p> </p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/10f747c84347facec2e293c8c98af9ff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android4.0 SDK功能详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/02910bbb0cdc1e716bebd6dc834d0808/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">安装python package到指定目录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>