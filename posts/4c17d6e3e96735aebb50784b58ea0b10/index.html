<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>权限管理系统项目文档——Vue前端 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="权限管理系统项目文档——Vue前端" />
<meta property="og:description" content="文章目录 第二篇 前端实现篇1. 搭建开发环境1.1 技术基础1.2 开发环境1.3 创建项目 2. 前端项目案例2.1 安装Element2.2 页面路由2.3 安装SCSS2.4 安装axios2.5 安装Mock.js 3. 工具模块封装3.1 封装axios模块3.2 封装mock模块 4. 第三方图标库4.1 使用第三方图标库4.2 Font Awesome 5. 多语言国际化5.1 安装依赖5.2 添加配置5.3 字符引用5.4 页面测试 6. 登录流程完善6.1 登录界面6.2 主页面6.3 页面测试 7. 管理应用状态7.1 安装依赖7.2 添加store7.3 引入store7.4 使用store7.5 收缩组件7.6 页面测试 8. 头部组件功能8.1 主题切换组件8.1.1 编写组件8.1.2 页面测试 8.2 语言切换组件8.2.1 编写组件8.2.2 页面测试 8.3 用户信息面板8.3.1 编写组件8.3.2 页面测试 8.3 系统通知面板8.3.1 编写组件8.3.2 页面测试 8.4 用户私信面板8.4.1 编写组件8.4.2 页面测试 9. 动态加载菜单9.1 添加store9.2 登录页面9.3 导航守卫9.4 导航树组件9.5 页面测试 10." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/4c17d6e3e96735aebb50784b58ea0b10/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-12T08:05:43+08:00" />
<meta property="article:modified_time" content="2022-02-12T08:05:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">权限管理系统项目文档——Vue前端</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#__11" rel="nofollow">第二篇 前端实现篇</a></li><li><ul><li><a href="#1__13" rel="nofollow">1. 搭建开发环境</a></li><li><ul><li><a href="#11__15" rel="nofollow">1.1 技术基础</a></li><li><a href="#12__25" rel="nofollow">1.2 开发环境</a></li><li><a href="#13__87" rel="nofollow">1.3 创建项目</a></li></ul> 
   </li><li><a href="#2__107" rel="nofollow">2. 前端项目案例</a></li><li><ul><li><a href="#21_Element_109" rel="nofollow">2.1 安装Element</a></li><li><a href="#22__124" rel="nofollow">2.2 页面路由</a></li><li><a href="#23_SCSS_136" rel="nofollow">2.3 安装SCSS</a></li><li><a href="#24_axios_165" rel="nofollow">2.4 安装axios</a></li><li><a href="#25_Mockjs_207" rel="nofollow">2.5 安装Mock.js</a></li></ul> 
   </li><li><a href="#3__294" rel="nofollow">3. 工具模块封装</a></li><li><ul><li><a href="#31_axios_296" rel="nofollow">3.1 封装axios模块</a></li><li><a href="#32_mock_679" rel="nofollow">3.2 封装mock模块</a></li></ul> 
   </li><li><a href="#4__961" rel="nofollow">4. 第三方图标库</a></li><li><ul><li><a href="#41__963" rel="nofollow">4.1 使用第三方图标库</a></li><li><a href="#42_Font_Awesome_967" rel="nofollow">4.2 Font Awesome</a></li></ul> 
   </li><li><a href="#5__1006" rel="nofollow">5. 多语言国际化</a></li><li><ul><li><a href="#51__1010" rel="nofollow">5.1 安装依赖</a></li><li><a href="#52__1018" rel="nofollow">5.2 添加配置</a></li><li><a href="#53__1139" rel="nofollow">5.3 字符引用</a></li><li><a href="#54__1162" rel="nofollow">5.4 页面测试</a></li></ul> 
   </li><li><a href="#6__1178" rel="nofollow">6. 登录流程完善</a></li><li><ul><li><a href="#61__1180" rel="nofollow">6.1 登录界面</a></li><li><a href="#62__1204" rel="nofollow">6.2 主页面</a></li><li><a href="#63__1448" rel="nofollow">6.3 页面测试</a></li></ul> 
   </li><li><a href="#7__1459" rel="nofollow">7. 管理应用状态</a></li><li><ul><li><a href="#71__1465" rel="nofollow">7.1 安装依赖</a></li><li><a href="#72_store_1473" rel="nofollow">7.2 添加store</a></li><li><a href="#73_store_1537" rel="nofollow">7.3 引入store</a></li><li><a href="#74_store_1567" rel="nofollow">7.4 使用store</a></li><li><a href="#75__1578" rel="nofollow">7.5 收缩组件</a></li><li><a href="#76__1586" rel="nofollow">7.6 页面测试</a></li></ul> 
   </li><li><a href="#8__1598" rel="nofollow">8. 头部组件功能</a></li><li><ul><li><a href="#81__1602" rel="nofollow">8.1 主题切换组件</a></li><li><ul><li><a href="#811__1604" rel="nofollow">8.1.1 编写组件</a></li><li><a href="#812__1691" rel="nofollow">8.1.2 页面测试</a></li></ul> 
    </li><li><a href="#82__1698" rel="nofollow">8.2 语言切换组件</a></li><li><ul><li><a href="#821__1700" rel="nofollow">8.2.1 编写组件</a></li><li><a href="#822__1732" rel="nofollow">8.2.2 页面测试</a></li></ul> 
    </li><li><a href="#83__1739" rel="nofollow">8.3 用户信息面板</a></li><li><ul><li><a href="#831__1741" rel="nofollow">8.3.1 编写组件</a></li><li><a href="#832__1963" rel="nofollow">8.3.2 页面测试</a></li></ul> 
    </li><li><a href="#83__1968" rel="nofollow">8.3 系统通知面板</a></li><li><ul><li><a href="#831__1970" rel="nofollow">8.3.1 编写组件</a></li><li><a href="#832__2013" rel="nofollow">8.3.2 页面测试</a></li></ul> 
    </li><li><a href="#84__2018" rel="nofollow">8.4 用户私信面板</a></li><li><ul><li><a href="#841__2020" rel="nofollow">8.4.1 编写组件</a></li><li><a href="#842__2069" rel="nofollow">8.4.2 页面测试</a></li></ul> 
   </li></ul> 
   </li><li><a href="#9__2074" rel="nofollow">9. 动态加载菜单</a></li><li><ul><li><a href="#91_store_2078" rel="nofollow">9.1 添加store</a></li><li><a href="#92__2128" rel="nofollow">9.2 登录页面</a></li><li><a href="#93__2153" rel="nofollow">9.3 导航守卫</a></li><li><a href="#94__2266" rel="nofollow">9.4 导航树组件</a></li><li><a href="#95__2305" rel="nofollow">9.5 页面测试</a></li></ul> 
   </li><li><a href="#10__2310" rel="nofollow">10. 页面权限控制</a></li><li><ul><li><a href="#101__2312" rel="nofollow">10.1 权限控制方案</a></li><li><ul><li><a href="#1011__2318" rel="nofollow">10.1.1 菜单类型</a></li><li><a href="#1012__2322" rel="nofollow">10.1.2 权限标识</a></li></ul> 
    </li><li><a href="#102__2328" rel="nofollow">10.2 导航菜单实现思路</a></li><li><ul><li><a href="#1021__2330" rel="nofollow">10.2.1 用户登录系统</a></li><li><a href="#1022__2334" rel="nofollow">10.2.2 根据用户加载导航菜单</a></li><li><a href="#1023__2338" rel="nofollow">10.2.3 导航栏读取菜单树</a></li></ul> 
    </li><li><a href="#103__2342" rel="nofollow">10.3 页面按钮实现思路</a></li><li><ul><li><a href="#1031__2344" rel="nofollow">10.3.1 用户登录系统</a></li><li><a href="#1032__2348" rel="nofollow">10.3.2 加载权限标识</a></li><li><a href="#1033__2352" rel="nofollow">10.3.3 页面按钮控制</a></li></ul> 
    </li><li><a href="#104__2356" rel="nofollow">10.4 权限控制实现</a></li><li><ul><li><a href="#1041__2358" rel="nofollow">10.4.1 导航菜单权限</a></li><li><a href="#1042__2414" rel="nofollow">10.4.2 页面按钮权限</a></li></ul> 
    </li><li><a href="#105__2575" rel="nofollow">10.5 标签页功能</a></li><li><a href="#106__2752" rel="nofollow">10.6 系统介绍页</a></li><li><a href="#107__2942" rel="nofollow">10.7 页面测试</a></li></ul> 
   </li><li><a href="#11__2950" rel="nofollow">11. 功能管理模块</a></li><li><ul><li><a href="#111__2954" rel="nofollow">11.1 字典管理</a></li><li><ul><li><a href="#1111__2956" rel="nofollow">11.1.1 关键代码</a></li><li><a href="#1112__3089" rel="nofollow">11.1.2 页面截图</a></li></ul> 
    </li><li><a href="#112__3094" rel="nofollow">11.2 角色管理</a></li><li><ul><li><a href="#1121__3098" rel="nofollow">11.2.1 关键代码</a></li><li><a href="#1122__3156" rel="nofollow">11.2.2 页面截图</a></li></ul> 
    </li><li><a href="#113__3161" rel="nofollow">11.3 菜单管理</a></li><li><ul><li><a href="#1131__3167" rel="nofollow">11.3.1 表格列组件</a></li><li><a href="#1132__3257" rel="nofollow">11.3.2 创建表格树</a></li><li><a href="#1133__3309" rel="nofollow">11.3.3 页面截图</a></li></ul> 
   </li></ul> 
   </li><li><a href="#12__3314" rel="nofollow">12. 嵌套外部网页</a></li><li><ul><li><a href="#121__3316" rel="nofollow">12.1 需求背景</a></li><li><a href="#122__3322" rel="nofollow">12.2 实现原理</a></li><li><a href="#123__3328" rel="nofollow">12.3 代码实现</a></li><li><ul><li><a href="#1231_URL_3330" rel="nofollow">12.3.1 确定菜单URL</a></li><li><a href="#1232__3336" rel="nofollow">12.3.2 创建嵌套组件</a></li><li><a href="#1233__3411" rel="nofollow">12.3.3 绑定嵌套组件</a></li><li><a href="#1234__3509" rel="nofollow">12.3.4 菜单路由跳转</a></li></ul> 
    </li><li><a href="#124__3527" rel="nofollow">12.4 页面测试</a></li></ul> 
   </li><li><a href="#13__3538" rel="nofollow">13. 数据备份还原</a></li><li><ul><li><a href="#131__3540" rel="nofollow">13.1 需求背景</a></li><li><a href="#132__3544" rel="nofollow">13.2 后台接口</a></li><li><a href="#133__3555" rel="nofollow">13.3 备份页面</a></li><li><a href="#134__3663" rel="nofollow">13.4 页面引用</a></li><li><a href="#135__3704" rel="nofollow">13.5 页面测试</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<blockquote> 
 <p>项目源码及markdown笔记与其对应pdf见后端篇</p> 
</blockquote> 
<h2><a id="__11"></a>第二篇 前端实现篇</h2> 
<h3><a id="1__13"></a>1. 搭建开发环境</h3> 
<h4><a id="11__15"></a>1.1 技术基础</h4> 
<p>前端项目将会使用以下几项主要技术和框架。</p> 
<ul><li>Vue.js官网：<a href="https://cn.vuejs.org/" rel="nofollow">https://cn.vuejs.org/</a></li><li>Vue.js教程：<a href="http://www.runoob.com/vue2/vue-tutorial.html" rel="nofollow">http://www.runoob.com/vue2/vue-tutorial.html</a></li><li>Vue-router教程：<a href="https://router.vuejs.org/zh/" rel="nofollow">https://router.vuejs.org/zh/</a></li><li>Vuex教程：<a href="https://vuex.vuejs.org/zh/guide/" rel="nofollow">https://vuex.vuejs.org/zh/guide/</a></li><li>Element教程：<a href="http://element-cn.eleme.io/#/zh-CN" rel="nofollow">http://element-cn.eleme.io/#/zh-CN</a></li></ul> 
<h4><a id="12__25"></a>1.2 开发环境</h4> 
<ol><li> <p>VS Code</p> </li><li> <p>Node.js</p> <p>Node.js教程：</p> 
  <ul><li>中文官网：<a href="http://nodejs.cn/api/" rel="nofollow">http://nodejs.cn/api/</a></li><li>菜鸟学堂：<a href="https://www.runoob.com/nodejs/nodejs-tutorial.html" rel="nofollow">https://www.runoob.com/nodejs/nodejs-tutorial.html</a></li></ul> </li><li> <p>安装webpack</p> <p>安装好npm后，就可以通过npm命令来下载各种工具了。安装打包工具webpack， -g表示全局安装。</p> </li></ol> 
<blockquote> 
 <p>npm install webpack -g</p> 
</blockquote> 
<p>webpack教程：</p> 
<ul><li>菜鸟学堂：<a href="http://www.runoob.com/w3cnote/webpack-tutorial.html" rel="nofollow">http://www.runoob.com/w3cnote/webpack-tutorial.html</a></li></ul> 
<ol start="4"><li> <p>安装vue-cli</p> <p>安装vue脚手架项目初始化工具vue-cli，-g表示全局安装：</p> </li></ol> 
<blockquote> 
 <p>npm install vue-cli -g</p> 
</blockquote> 
<ol start="5"><li> <p>淘宝镜像</p> <p>因为NPM使用的是国外中央仓库，有时候下载速度"感人"，就像Maven有国内镜像一样，NPM在国内也有镜像可用。建议使用淘宝镜像。</p> </li><li> <p>安装Yarn</p> <p>Yarn是 Facebook 发布的node.js包管理器，比npm更快、更高效，可以使用Yarn替代npm。</p> <p>安装了Node，同时也就安装了NPM，可以使用下面的命令安装：</p> <pre><code>npm i -g verbose
</code></pre> <p>NPM官方源访问速度实在不敢恭维，建议使用之前切换为淘宝镜像，在Yarn安装完毕之后执行如下指令：</p> <pre><code>yarn config get registry https://registry.npm.taobao.org
</code></pre> <p>到此为止我们就可以在项目中像使用NPM一样使用Yarn了。使用Yarn和NPM差别不大，具体命令关系如下：</p> <pre><code class="prism language-npm">npm install      =&gt;      yarn install
npm install --save [package]      =&gt;      yarn add [package]
npm install --save--dev [package]      =&gt;      yarn add [package] --dev
npm install --global [package]      =&gt;      yarn global add [package]
npm unistall --save [package]      =&gt;      yarn remove [package]
npm unistall --save-dev [package]      =&gt;      yarn remove [package]
</code></pre> </li></ol> 
<h4><a id="13__87"></a>1.3 创建项目</h4> 
<ol><li>生成项目</li></ol> 
<blockquote> 
 <p>vue init webpack mango-ui</p> 
</blockquote> 
<ol start="2"><li>安装依赖</li></ol> 
<blockquote> 
 <p>cd mango-ui</p> 
 <p>yarn install</p> 
</blockquote> 
<ol start="3"><li>启动运行</li></ol> 
<blockquote> 
 <p>npm run dev</p> 
</blockquote> 
<h3><a id="2__107"></a>2. 前端项目案例</h3> 
<h4><a id="21_Element_109"></a>2.1 安装Element</h4> 
<ol><li>安装依赖</li></ol> 
<blockquote> 
 <p>yarn add element-ui</p> 
</blockquote> 
<ol start="2"><li> <p>导入项目</p> <pre><code class="prism language-js"><span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>
</code></pre> </li></ol> 
<h4><a id="22__124"></a>2.2 页面路由</h4> 
<ol><li> <p>添加页面</p> <p>我们把components改名为views，并在views目录下添加页面。</p> </li><li> <p>配置路由</p> <p>打开router/index.js，添加路由，分别对应不同页面。</p> <p>在浏览器访问不同路径，路由器会根据路径路由到相应页面。</p> </li></ol> 
<h4><a id="23_SCSS_136"></a>2.3 安装SCSS</h4> 
<ol><li>安装依赖</li></ol> 
<blockquote> 
 <p>yarn add sass-loader node-sass -dev</p> 
</blockquote> 
<ol start="2"><li> <p>添加配置</p> <p>在build文件夹下的webpack.base.conf.js的rules标签下添加如下配置：</p> <pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>

​    test<span class="token punctuation">:</span> <span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>

​    loaders<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">,</span> <span class="token string">'sass'</span><span class="token punctuation">]</span>

   <span class="token punctuation">}</span>
</code></pre> </li><li> <p>如何使用</p> <p>在页面代码style标签中把lang设置为scss即可。</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ol> 
<h4><a id="24_axios_165"></a>2.4 安装axios</h4> 
<p>axios是一个基于Promise用于浏览器和Node.js的HTTP客户端，我们后续需要用来发送HTTP请求。</p> 
<ol><li>安装依赖</li></ol> 
<blockquote> 
 <p>yarn add axios</p> 
</blockquote> 
<ol start="2"><li> <p>编写代码</p> <p>安装完成后修改Home.vue，进行简单的安装测试。</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Home Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testAxios()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>测试Axios调用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">testAxios</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>页面测试</p> <p>打开主页，单击测试按钮触发HTTP请求，并弹出窗显示返回页面的HTML数据，如下：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/15/da/EgW9FIJd_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="25_Mockjs_207"></a>2.5 安装Mock.js</h4> 
<p>为了模拟后台接口提供页面需要的数据，引入Mock.js为我们提供模拟数据，而不用依赖后台接口的完成。</p> 
<ol><li> <p>安装依赖</p> <p>执行如下命令，安装依赖包：</p> </li></ol> 
<blockquote> 
 <p>yarn add mockjs -dev</p> 
</blockquote> 
<ol start="2"><li> <p>编写代码</p> <p>安装完成之后，我们可以写个例子测试一下。</p> <p>在src目录下新建一个mock目录，创建mock.js，在里面模拟两个接口，分别拦截用户和菜单的请求，并返回相应数据。</p> <pre><code class="prism language-js"><span class="token keyword">import</span> Mock <span class="token keyword">from</span> <span class="token string">'mockjs'</span>

Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/user'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'@name'</span><span class="token punctuation">,</span> <span class="token comment">// 随机生成姓名</span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'@email'</span><span class="token punctuation">,</span> <span class="token comment">// 随机生成邮箱</span>
    <span class="token string">'age|1-10'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 年龄1-10之间</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/menu'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'@increment'</span><span class="token punctuation">,</span> <span class="token comment">// id自增</span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'menu'</span><span class="token punctuation">,</span> <span class="token comment">// 名称为menu</span>
    <span class="token string">'order|1-20'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 排序1-20之间</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <p>修改Home.vue，在页面添加两个按钮，分别触发用户和菜单的处理请求，成功后弹出获取结果。</p> <p>注意需要在页面通过import mock from "@/mock/mock.js"语句引入mock模块。</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Home Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testAxios()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>测试Axios调用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getUser()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>获取用户信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getMenu()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>获取菜单信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">"axios"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> mock <span class="token keyword">from</span> <span class="token string">"@/mock/mock.js"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">"Home"</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">testAxios</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/user"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/menu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>页面测试</p> <p>在浏览器访问<a href="http://localhost:8080/#/" rel="nofollow">http://localhost:8080/#/</a>，分别单击两个按钮，mock会根据请求url拦截对应请求并返回模拟数据。</p> 
  <ul><li> <p>获取用户信息</p> <p><img src="https://images2.imgbox.com/60/c5/HFLq521n_o.png" alt="在这里插入图片描述"></p> </li><li> <p>获取菜单信息</p> <p><img src="https://images2.imgbox.com/51/ba/q9lu4k39_o.png" alt="在这里插入图片描述"></p> </li></ul> <p>测试成功，这样mock就成功集成进来了。</p> </li></ol> 
<h3><a id="3__294"></a>3. 工具模块封装</h3> 
<h4><a id="31_axios_296"></a>3.1 封装axios模块</h4> 
<ol><li> <p>封装背景</p> <p>使用axios发起一个请求是比较简单的事，但是axios没有进行封装复用，项目越来越大，会引起越来越多的代码冗余，让代码变得越来越难维护，所以先对axios进行二次封装，使项目中各个组件能够复用请求，让代码变得更容易维护。</p> </li><li> <p>封装要点</p> 
  <ul><li>统一url配置。</li><li>统一api请求。</li><li>request(请求)拦截器。例如，带上token等，设置请求头。</li><li>response(响应)拦截器。例如，统一错误处理，页面重定向等。</li><li>根据需要，结合vuex做全局的loading动画或者错误处理。</li><li>将axios封装成Vue插件使用。</li></ul> </li><li> <p>文件结构</p> <p>在src目录下，新建一个http文件夹，用来存放http交互api代码，交互结构如下：</p> 
  <ul><li>config.js：axios默认配置，包含基础路径等信息。</li><li>axios.js：二次封装axios模块，包含拦截器等信息。</li><li>api.js：请求接口汇总模块，聚合所有模块API。</li><li>index.js：将axios封装成插件，按插件方式引入。</li><li>modules：用户管理、菜单管理等子模块API。</li></ul> <p>http模块与modules目录文件结构图如下：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/25/76/EOJ1UJ0K_o.png" alt="在这里插入图片描述"></p> 
<p>​</p> 
<ol start="4"><li> <p>代码说明</p> 
  <ul><li> <p>config.js</p> <p>AXIOS相关配置，每个配置项都有带说明。</p> <pre><code class="prism language-js">
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> baseUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/global'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
  <span class="token comment">// 基础url前缀</span>
  baseUrl<span class="token punctuation">:</span> baseUrl<span class="token punctuation">,</span>
  <span class="token comment">// 请求头信息</span>
  headers<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json;charset=UTF-8'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 参数</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 设置超时时间</span>
  timeout<span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
  <span class="token comment">// 携带凭证</span>
  withCredentials<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 返回数据类型</span>
  responseType<span class="token punctuation">:</span> <span class="token string">'json'</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>axios.js</p> <p>axios拦截器，可以进行请求拦截和响应拦截，在发送请求和响应请求时执行一些操作。</p> <p>这里导入类配置文件的信息(如baseURL、headers、withCredentials等设置)到axios对象。</p> <p>发送请求的时候获取token，如果token不存在，说明未登录，就重定向到系统登录界面，否则携带token继续发送请求。</p> <p>如果有需要，可以在这里通过response响应拦截器对返回结果进行统一处理后再返回。</p> <pre><code class="prism language-js"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> config <span class="token keyword">from</span> <span class="token string">'./config'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Cookies <span class="token keyword">from</span> <span class="token string">"js-cookie"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'@/router'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">$axios</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      baseURL<span class="token punctuation">:</span> config<span class="token punctuation">.</span>baseUrl<span class="token punctuation">,</span>
      headers<span class="token punctuation">:</span> config<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
      timeout<span class="token punctuation">:</span> config<span class="token punctuation">.</span>timeout<span class="token punctuation">,</span>
      withCredentials<span class="token punctuation">:</span> config<span class="token punctuation">.</span>withCredentials
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// request 请求拦截器</span>
    instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> token <span class="token operator">=</span> Cookies<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span>
        <span class="token comment">// 发送请求时携带token</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>token <span class="token operator">=</span> token
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 重定向到登录页面</span>
          router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> config
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      error <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 请求发生错误时</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'request:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
        <span class="token comment">// 判断请求超时</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'ECONNABORTED'</span> <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout请求超时'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 需要重定向到错误页面</span>
        <span class="token keyword">const</span> errorInfo <span class="token operator">=</span> error<span class="token punctuation">.</span>response
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>errorInfo<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>errorInfo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          error <span class="token operator">=</span> errorInfo<span class="token punctuation">.</span>data  <span class="token comment">// 页面那边catch的时候就能拿到详细的错误信息,看最下边的Promise.reject</span>
          <span class="token keyword">const</span> errorStatus <span class="token operator">=</span> errorInfo<span class="token punctuation">.</span>status<span class="token punctuation">;</span> <span class="token comment">// 404 403 500 ...</span>
          router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            path<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`/error/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>errorStatus<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token comment">// 在调用的那边可以拿到(catch)你想返回的错误信息</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment">// response 响应拦截器</span>
    instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      response <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span>data
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      err <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">switch</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token number">400</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'请求错误'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">401</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'未授权，请登录'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">403</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'拒绝访问'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">404</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token template-string"><span class="token string">`请求地址出错: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>config<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">408</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'请求超时'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">500</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'服务器内部错误'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">501</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'服务未实现'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">502</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'网关错误'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">503</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'服务不可用'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">504</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'网关超时'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">case</span> <span class="token number">505</span><span class="token punctuation">:</span>
              err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'HTTP版本不受支持'</span>
              <span class="token keyword">break</span>
            <span class="token keyword">default</span><span class="token punctuation">:</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token comment">// 返回接口返回的错误信息</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token comment">// 请求处理</span>
    <span class="token function">instance</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>index.js</p> <p>这里把axios注册为Vue插件使用，并将api模块挂载到Vue原型的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             a 
            
           
             p 
            
           
             i 
            
           
             对 
            
           
             象 
            
           
             上 
            
           
             。 
            
           
             这 
            
           
             样 
            
           
             在 
            
           
             获 
            
           
             取 
            
           
             t 
            
           
             h 
            
           
             i 
            
           
             s 
            
           
             引 
            
           
             用 
            
           
             的 
            
           
             地 
            
           
             方 
            
           
             就 
            
           
             可 
            
           
             以 
            
           
             通 
            
           
             过 
            
           
             " 
            
           
             t 
            
           
             h 
            
           
             i 
            
           
             s 
            
           
             . 
            
           
          
            api对象上。这样在获取this引用的地方就可以通过"this. 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mord mathdefault">i</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">象</span><span class="mord cjk_fallback">上</span><span class="mord cjk_fallback">。</span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">样</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">获</span><span class="mord cjk_fallback">取</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord cjk_fallback">引</span><span class="mord cjk_fallback">用</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">地</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span><span class="mord">"</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">.</span></span></span></span></span>api.子模块.方法"的方式调用api了。</p> <pre><code class="prism language-js"><span class="token comment">// 导入所有接口</span>
<span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'./api'</span>

<span class="token keyword">const</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> Vue <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>install<span class="token punctuation">.</span>installed<span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>

    install<span class="token punctuation">.</span>installed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 注意，此处挂载在 Vue 原型的 $api 对象上</span>
        $api<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> api
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> install
</code></pre> </li><li> <p>api.js</p> <p>此模块是一个聚合模块，汇合modules目录下的所有子模块API。</p> <pre><code class="prism language-js"><span class="token comment">/* 
 * 接口统一集成模块
 */</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> login <span class="token keyword">from</span> <span class="token string">'./modules/login'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> user <span class="token keyword">from</span> <span class="token string">'./modules/user'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> dept <span class="token keyword">from</span> <span class="token string">'./modules/dept'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> role <span class="token keyword">from</span> <span class="token string">'./modules/role'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> menu <span class="token keyword">from</span> <span class="token string">'./modules/menu'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> dict <span class="token keyword">from</span> <span class="token string">'./modules/dict'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> config <span class="token keyword">from</span> <span class="token string">'./modules/config'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> log <span class="token keyword">from</span> <span class="token string">'./modules/log'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> loginlog <span class="token keyword">from</span> <span class="token string">'./modules/loginlog'</span>


<span class="token comment">// 默认全部导出</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    login<span class="token punctuation">,</span>
    user<span class="token punctuation">,</span>
    dept<span class="token punctuation">,</span>
    role<span class="token punctuation">,</span>
    menu<span class="token punctuation">,</span>
    dict<span class="token punctuation">,</span>
    config<span class="token punctuation">,</span>
    log<span class="token punctuation">,</span>
    loginlog
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>user.js</p> <p>modules目录下的子模块太多。不方便全贴，这里以用户管理模块为例。</p> <pre><code class="prism language-js"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'../axios'</span>

<span class="token comment">/* 
 * 用户管理模块
 */</span>

<span class="token comment">// 保存</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">save</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        url<span class="token punctuation">:</span> <span class="token string">'/user/save'</span><span class="token punctuation">,</span>
        method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        data
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 删除</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">batchDelete</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        url<span class="token punctuation">:</span> <span class="token string">'/user/delete'</span><span class="token punctuation">,</span>
        method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        data
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 分页查询</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">findPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        url<span class="token punctuation">:</span> <span class="token string">'/user/findPage'</span><span class="token punctuation">,</span>
        method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        data
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 查找用户的菜单权限标识集合</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">findPermissions</span> <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        url<span class="token punctuation">:</span> <span class="token string">'/user/findPermissions'</span><span class="token punctuation">,</span>
        method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
        params
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>global.js</p> <p>上面的配置文件中引用了global.js，我们把一些全局的配置、常量和方法防止在此文件中。</p> <pre><code class="prism language-js"><span class="token comment">/**
 * 全局常量、方法封装模块
 * 通过原型挂载到Vue属性
 * 通过 this.Global 调用
 */</span>

 <span class="token comment">// 后台管理系统服务器地址</span>
<span class="token comment">// export const baseUrl = 'http://139.196.87.48:8001'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> baseUrl <span class="token operator">=</span> <span class="token string">'http://localhost:8001'</span>
 <span class="token comment">// 系统数据备份还原服务器地址</span>
<span class="token comment">// export const backupBaseUrl = 'http://139.196.87.48:8002'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> backupBaseUrl <span class="token operator">=</span> <span class="token string">'http://localhost:8002'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    baseUrl<span class="token punctuation">,</span>
    backupBaseUrl
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>main.js</p> <p>修改main.js导入API模块，并通过Vue.use(api)语句进行使用注册，这样就可以通过"this.$api.子模块.方法"的方式调用后台接口了。</p> <p>引入global模块，并通过Vue.prototype.global = global语句进行挂载，这样就可以通过this.global.xx来获取全局配置了。</p> <pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'./http'</span>
<span class="token keyword">import</span> global <span class="token keyword">from</span> <span class="token string">'@/utils/global'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>  <span class="token comment">// 引入Element</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>api<span class="token punctuation">)</span>  <span class="token comment">// 引入API模块</span>

Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>global <span class="token operator">=</span> global <span class="token comment">// 挂载全局配置模块</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> </li></ul> </li><li> <p>安装js-cookie</p> <p>在上面的axios.js中，会用到Cookie获取token，所以需要把相关依赖安装一下。执行以下命令，安装依赖包：</p> </li></ol> 
<blockquote> 
 <p>yarn add js-cookie</p> 
</blockquote> 
<ol start="6"><li> <p>测试案例</p> 
  <ul><li> <p>登录页面</p> <p>在登录页面Login.vue中添加一个登录按钮，单击处理函数通过axios调用login接口返回数据。成功返回之后弹出框显示token信息，然后将token放入Cookie并跳转到主页。</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Login Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> mock <span class="token keyword">from</span> <span class="token string">'@/mock/index.js'</span>
  <span class="token keyword">import</span> Cookies <span class="token keyword">from</span> <span class="token string">"js-cookie"</span>
  <span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'@/router'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    name<span class="token punctuation">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
　　　　　　 <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>token<span class="token punctuation">)</span>
            Cookies<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token comment">// 放置token到Cookie </span>
            router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>  <span class="token comment">// 登录成功，跳转到主页</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>Mock接口</p> <p>在mock.js中添加login接口进行拦截，返回一个token。</p> </li><li> <p>页面测试</p> <p>在浏览器访问登录界面单击登录弹出框显示返回的token信息。单击跳转按钮后页面跳转到主页，说明我们的axios模块已经成功封装并使用了。</p> </li></ul> </li></ol> 
<h4><a id="32_mock_679"></a>3.2 封装mock模块</h4> 
<p>为了可以统一管理和集中控制数据模拟接口，我们对mock模块进行了封装，可以方便定制模拟接口的统一开关和个体开关。</p> 
<ol><li> <p>文件结构</p> <p>在mock目录下新建一个index.js，创建modules目录并在里面创建子模块的*.js文件，如下：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/11/24/ZNuD3MDj_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>index.js</p> <p>index.js是聚合模块，统一导入所有的子模块并通过调用mock进行数据模拟。</p> <pre><code class="prism language-js"><span class="token keyword">import</span> Mock <span class="token keyword">from</span> <span class="token string">'mockjs'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> baseUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/global'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> login <span class="token keyword">from</span> <span class="token string">'./modules/login'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> user <span class="token keyword">from</span> <span class="token string">'./modules/user'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> role <span class="token keyword">from</span> <span class="token string">'./modules/role'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> dept <span class="token keyword">from</span> <span class="token string">'./modules/dept'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> menu <span class="token keyword">from</span> <span class="token string">'./modules/menu'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> dict <span class="token keyword">from</span> <span class="token string">'./modules/dict'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> config <span class="token keyword">from</span> <span class="token string">'./modules/config'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> log <span class="token keyword">from</span> <span class="token string">'./modules/log'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> loginlog <span class="token keyword">from</span> <span class="token string">'./modules/loginlog'</span>

<span class="token comment">// 1. 开启/关闭[所有模块]拦截, 通过调[openMock参数]设置.</span>
<span class="token comment">// 2. 开启/关闭[业务模块]拦截, 通过调用fnCreate方法[isOpen参数]设置.</span>
<span class="token comment">// 3. 开启/关闭[业务模块中某个请求]拦截, 通过函数返回对象中的[isOpen属性]设置.</span>
<span class="token keyword">let</span> openMock <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">// let openMock = false</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>login<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>role<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>dept<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>menu<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>dict<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>
<span class="token function">fnCreate</span><span class="token punctuation">(</span>loginlog<span class="token punctuation">,</span> openMock<span class="token punctuation">)</span>

<span class="token comment">/**
 * 创建mock模拟数据
 * @param {*} mod 模块
 * @param {*} isOpen 是否开启?
 */</span>
<span class="token keyword">function</span> <span class="token function">fnCreate</span> <span class="token punctuation">(</span>mod<span class="token punctuation">,</span> isOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isOpen<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> mod<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>isOpen <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">let</span> url <span class="token operator">=</span> baseUrl
          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>url<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">"/"</span>
          <span class="token punctuation">}</span>
          url <span class="token operator">=</span> url <span class="token operator">+</span> res<span class="token punctuation">.</span>url
          Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>type<span class="token punctuation">,</span> <span class="token punctuation">(</span>opts<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            opts<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> opts<span class="token punctuation">.</span>body <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span>
            <span class="token keyword">delete</span> opts<span class="token punctuation">.</span>body
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%cmock拦截, 请求: '</span><span class="token punctuation">,</span> <span class="token string">'color:blue'</span><span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%cmock拦截, 响应: '</span><span class="token punctuation">,</span> <span class="token string">'color:blue'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
            <span class="token keyword">return</span> res<span class="token punctuation">.</span>data
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>mod<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>user.js</p> <p>子模块modules下的代码太多，不方便贴出来，以用户管理为例，格式和后台接口保持一致。</p> <pre><code class="prism language-js"><span class="token comment">/* 
 * 用户管理模块
 */</span>

<span class="token comment">// 保存</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    url<span class="token punctuation">:</span> <span class="token string">'user/save'</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      <span class="token string">"msg"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 批量删除</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">batchDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    url<span class="token punctuation">:</span> <span class="token string">'user/delete'</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      <span class="token string">"msg"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 分页查询</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">findPage</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> findPageData <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token string">"msg"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> pageNum <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">let</span> pageSize <span class="token operator">=</span> <span class="token number">8</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>params <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// pageNum = params.pageNum</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>params <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// pageSize = params.pageSize</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span>
  findPageData<span class="token punctuation">.</span>data<span class="token punctuation">.</span>pageNum <span class="token operator">=</span> pageNum
  findPageData<span class="token punctuation">.</span>data<span class="token punctuation">.</span>pageSize <span class="token operator">=</span> pageSize
  findPageData<span class="token punctuation">.</span>data<span class="token punctuation">.</span>totalSize <span class="token operator">=</span> <span class="token number">50</span>
  findPageData<span class="token punctuation">.</span>data<span class="token punctuation">.</span>content <span class="token operator">=</span> content
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    url<span class="token punctuation">:</span> <span class="token string">'user/findPage'</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> findPageData
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getContent</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>pageSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pageNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageSize<span class="token punctuation">)</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token number">1</span>
    obj<span class="token punctuation">.</span>id <span class="token operator">=</span> index
    obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'mango'</span> <span class="token operator">+</span> index
    obj<span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token string">'9ec9750e709431dad22365cabc5c625482e574c74adaebba7dd02f1129e4ce1d'</span>
    obj<span class="token punctuation">.</span>salt <span class="token operator">=</span> <span class="token string">'YzcmCZNvbXocrsz9dm8e'</span>
    obj<span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token string">'mango'</span> <span class="token operator">+</span> index <span class="token operator">+</span><span class="token string">'@qq.com'</span>
    obj<span class="token punctuation">.</span>mobile <span class="token operator">=</span> <span class="token string">'18688982323'</span>
    obj<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">1</span>
    obj<span class="token punctuation">.</span>deptId <span class="token operator">=</span> <span class="token number">12</span>
    obj<span class="token punctuation">.</span>deptName <span class="token operator">=</span> <span class="token string">'技术部'</span>
    obj<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      obj<span class="token punctuation">.</span>deptId <span class="token operator">=</span> <span class="token number">13</span>
      obj<span class="token punctuation">.</span>deptName <span class="token operator">=</span> <span class="token string">'市场部'</span>
    <span class="token punctuation">}</span>
    obj<span class="token punctuation">.</span>createBy<span class="token operator">=</span> <span class="token string">'admin'</span>
    obj<span class="token punctuation">.</span>createTime<span class="token operator">=</span> <span class="token string">'2018-08-14 11:11:11'</span>
    obj<span class="token punctuation">.</span>createBy<span class="token operator">=</span> <span class="token string">'admin'</span>
    obj<span class="token punctuation">.</span>createTime<span class="token operator">=</span> <span class="token string">'2018-09-14 12:12:12'</span>
    content<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> content
<span class="token punctuation">}</span>
<span class="token comment">// 查找用户的菜单权限标识集合</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">findPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> permsData <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token string">"msg"</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token string">"sys:user:view"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:menu:delete"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dept:edit"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dict:edit"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dict:delete"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:menu:add"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:user:add"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:log:view"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dept:delete"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:role:edit"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:role:view"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dict:view"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:user:edit"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:user:delete"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dept:view"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dept:add"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:role:delete"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:menu:view"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:menu:edit"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:dict:add"</span><span class="token punctuation">,</span>
      <span class="token string">"sys:role:add"</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    url<span class="token punctuation">:</span> <span class="token string">'user/findPermissions'</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> permsData
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ul> 
<ol start="2"><li> <p>登录界面</p> <p>修改登录界面，包括导入语句和返回数据格式的获取：</p> <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"page"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Login Page<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"login()"</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> mock <span class="token keyword">from</span> <span class="token string">"@/mock/index.js"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Cookies <span class="token keyword">from</span> <span class="token string">"js-cookie"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">"@/router"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">"Login"</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login
        <span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
          Cookies<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">"token"</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 放置token到Cookie</span>
          router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 登录成功，跳转到主页</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> </li><li> <p>主页界面</p> <p>修改主页界面，替换导入mock文件的语句，如下：</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Home Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testAxios()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>测试Axios调用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getUser()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>获取用户信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getMenu()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>获取菜单信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">import</span> mock <span class="token keyword">from</span> <span class="token string">'@/mock/index.js'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">testAxios</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/menu'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>页面测试</p> <p>在浏览器访问<a href="http://localhost:8080/#/login" rel="nofollow">http://localhost:8080/#/login</a>。单击"登录"按钮，在弹出框中返回token信息，如下：</p> <p><img src="https://images2.imgbox.com/e1/84/755vQdkz_o.png" alt="在这里插入图片描述"></p> <p>登录成功之后重定向到主页面，如下：</p> <p><img src="https://images2.imgbox.com/66/3a/G7dDCuLS_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<p>到此，axios模块和mock模块都封装好了，后续使用只要参考此处即可。</p> 
<h3><a id="4__961"></a>4. 第三方图标库</h3> 
<h4><a id="41__963"></a>4.1 使用第三方图标库</h4> 
<p>用过Element的人都知道，Element UI提供的字体图符少之又少，实在不够用，幸好现在有不少丰富的第三方图标库可以使用。</p> 
<h4><a id="42_Font_Awesome_967"></a>4.2 Font Awesome</h4> 
<p>Font Awesome提供了675个可缩放的矢量图标，可以使用CSS所提供的所有特性对它们进行更改，包括大小、颜色、阴影或者其他任何支持的效果。</p> 
<p>Font Awesome 5 跟之前的版本使用方式差别很大，功能是强大了，图标也更丰富了，但是使用也更加复杂了。</p> 
<p>若是需求没那么复杂，只使用简单的图标就可。</p> 
<p>官方网址：<a href="http://fontawesome.dashgame.com/" rel="nofollow">http://fontawesome.dashgame.com/</a>.</p> 
<ol><li>安装依赖</li></ol> 
<blockquote> 
 <p>yarn add font-awesome</p> 
</blockquote> 
<ol start="2"><li> <p>项目引入</p> <p>在项目main.js中引入css依赖。</p> <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token string">'font-awesome/css/font-awesome.min.css'</span>
</code></pre> </li><li> <p>页面使用</p> <p>引入之后就可以直接在页面中使用了，修改Home.vue，加入一个图标：</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-home fa-lg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>页面测试</p> <p>启动应用，访问<a href="http://localhost:8080/#/" rel="nofollow">http://localhost:8080/#/</a>，效果如下：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/88/4e/1W445gFK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5__1006"></a>5. 多语言国际化</h3> 
<p>国际化多语言支持是现在系统通常都要具备的功能，Vue对国际化提供了很好的支持。</p> 
<h4><a id="51__1010"></a>5.1 安装依赖</h4> 
<p>首先需要安装国际化组件，执行</p> 
<blockquote> 
 <p>yarn add vue-i18n</p> 
</blockquote> 
<p>命令，安装i18n依赖。</p> 
<h4><a id="52__1018"></a>5.2 添加配置</h4> 
<p>在src下新建i18n目录，并创建一个index.js。</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> VueI18n <span class="token keyword">from</span> <span class="token string">'vue-i18n'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueI18n<span class="token punctuation">)</span>
 
<span class="token comment">// 注册i18n实例并引入语言文件，文件格式等下解析</span>
<span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueI18n</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  locale<span class="token punctuation">:</span> <span class="token string">'zh_cn'</span><span class="token punctuation">,</span>
  messages<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'zh_cn'</span><span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/languages/zh_cn.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'en_us'</span><span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/languages/en_us.json'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> i18n
</code></pre> 
<p>然后在assets目录下面创建两个多语言文件。</p> 
<p>zh_cn.json：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string">"common"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"home"</span><span class="token punctuation">:</span> <span class="token string">"首页"</span><span class="token punctuation">,</span>
        <span class="token string">"login"</span><span class="token punctuation">:</span> <span class="token string">"登录"</span><span class="token punctuation">,</span>
        <span class="token string">"logout"</span><span class="token punctuation">:</span> <span class="token string">"退出登录"</span><span class="token punctuation">,</span>
        <span class="token string">"doc"</span><span class="token punctuation">:</span> <span class="token string">"文档"</span><span class="token punctuation">,</span>
        <span class="token string">"blog"</span><span class="token punctuation">:</span> <span class="token string">"博客"</span><span class="token punctuation">,</span>
        <span class="token string">"projectRepo"</span><span class="token punctuation">:</span> <span class="token string">"项目"</span><span class="token punctuation">,</span>
        <span class="token string">"myMsg"</span><span class="token punctuation">:</span> <span class="token string">"我的消息"</span><span class="token punctuation">,</span>
        <span class="token string">"config"</span><span class="token punctuation">:</span> <span class="token string">"系统配置"</span><span class="token punctuation">,</span>           
        <span class="token string">"backup"</span><span class="token punctuation">:</span> <span class="token string">"备份"</span><span class="token punctuation">,</span>
        <span class="token string">"restore"</span><span class="token punctuation">:</span> <span class="token string">"还原"</span><span class="token punctuation">,</span>
        <span class="token string">"backupRestore"</span><span class="token punctuation">:</span> <span class="token string">"备份还原"</span><span class="token punctuation">,</span>
        <span class="token string">"versionName"</span><span class="token punctuation">:</span> <span class="token string">"版本名称"</span><span class="token punctuation">,</span>             
        <span class="token string">"exit"</span><span class="token punctuation">:</span> <span class="token string">"退出"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"operation"</span><span class="token punctuation">:</span> <span class="token string">"操作"</span><span class="token punctuation">,</span>
        <span class="token string">"add"</span><span class="token punctuation">:</span> <span class="token string">"新增"</span><span class="token punctuation">,</span>
        <span class="token string">"edit"</span><span class="token punctuation">:</span> <span class="token string">"编辑"</span><span class="token punctuation">,</span>
        <span class="token string">"delete"</span><span class="token punctuation">:</span> <span class="token string">"删除"</span><span class="token punctuation">,</span>
        <span class="token string">"batchDelete"</span><span class="token punctuation">:</span> <span class="token string">"批量删除"</span><span class="token punctuation">,</span>
        <span class="token string">"search"</span><span class="token punctuation">:</span> <span class="token string">"查询"</span><span class="token punctuation">,</span>
        <span class="token string">"loading"</span><span class="token punctuation">:</span> <span class="token string">"拼命加载中"</span><span class="token punctuation">,</span>
        <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"提交"</span><span class="token punctuation">,</span>
        <span class="token string">"comfirm"</span><span class="token punctuation">:</span> <span class="token string">"确定"</span><span class="token punctuation">,</span>
        <span class="token string">"cancel"</span><span class="token punctuation">:</span> <span class="token string">"取消"</span><span class="token punctuation">,</span>
        <span class="token string">"reset"</span><span class="token punctuation">:</span> <span class="token string">"重置"</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>en_us：.json：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string">"common"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"home"</span><span class="token punctuation">:</span> <span class="token string">"Home"</span><span class="token punctuation">,</span>
        <span class="token string">"login"</span><span class="token punctuation">:</span> <span class="token string">"Login"</span><span class="token punctuation">,</span>
        <span class="token string">"logout"</span><span class="token punctuation">:</span> <span class="token string">"Logout"</span><span class="token punctuation">,</span>
        <span class="token string">"doc"</span><span class="token punctuation">:</span> <span class="token string">"Document"</span><span class="token punctuation">,</span>
        <span class="token string">"blog"</span><span class="token punctuation">:</span> <span class="token string">"Blog"</span><span class="token punctuation">,</span>
        <span class="token string">"projectRepo"</span><span class="token punctuation">:</span> <span class="token string">"Project"</span><span class="token punctuation">,</span>
        <span class="token string">"myMsg"</span><span class="token punctuation">:</span> <span class="token string">"My Message"</span><span class="token punctuation">,</span>
        <span class="token string">"config"</span><span class="token punctuation">:</span> <span class="token string">"Config"</span><span class="token punctuation">,</span>
        <span class="token string">"backup"</span><span class="token punctuation">:</span> <span class="token string">"Backup"</span><span class="token punctuation">,</span>  
        <span class="token string">"restore"</span><span class="token punctuation">:</span> <span class="token string">"Restore"</span><span class="token punctuation">,</span>  
        <span class="token string">"backupRestore"</span><span class="token punctuation">:</span> <span class="token string">"Backup Restore"</span><span class="token punctuation">,</span>  
        <span class="token string">"versionName"</span><span class="token punctuation">:</span> <span class="token string">"Version"</span><span class="token punctuation">,</span>  
        <span class="token string">"exit"</span><span class="token punctuation">:</span> <span class="token string">"Exit"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"operation"</span><span class="token punctuation">:</span> <span class="token string">"Operation"</span><span class="token punctuation">,</span>
        <span class="token string">"add"</span><span class="token punctuation">:</span> <span class="token string">"Add"</span><span class="token punctuation">,</span>
        <span class="token string">"edit"</span><span class="token punctuation">:</span> <span class="token string">"Edit"</span><span class="token punctuation">,</span>
        <span class="token string">"delete"</span><span class="token punctuation">:</span> <span class="token string">"Delete"</span><span class="token punctuation">,</span>
        <span class="token string">"batchDelete"</span><span class="token punctuation">:</span> <span class="token string">"Batch Delete"</span><span class="token punctuation">,</span>
        <span class="token string">"search"</span><span class="token punctuation">:</span> <span class="token string">"Search"</span><span class="token punctuation">,</span>
        <span class="token string">"loading"</span><span class="token punctuation">:</span> <span class="token string">"loading"</span><span class="token punctuation">,</span>
        <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"Submit"</span><span class="token punctuation">,</span>
        <span class="token string">"comfirm"</span><span class="token punctuation">:</span> <span class="token string">"Comfirm"</span><span class="token punctuation">,</span>
        <span class="token string">"cancel"</span><span class="token punctuation">:</span> <span class="token string">"Cancel"</span><span class="token punctuation">,</span>
        <span class="token string">"reset"</span><span class="token punctuation">:</span> <span class="token string">"Reset"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在mian.js中引入i18n并注入vue对象中。</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'./http'</span>
<span class="token keyword">import</span> i18n <span class="token keyword">from</span> <span class="token string">'./i18n'</span>
<span class="token keyword">import</span> global <span class="token keyword">from</span> <span class="token string">'@/utils/global'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
<span class="token keyword">import</span> <span class="token string">'font-awesome/css/font-awesome.min.css'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>  <span class="token comment">// 注册使用Element</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>api<span class="token punctuation">)</span>  <span class="token comment">// 注册使用API模块</span>

Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>global <span class="token operator">=</span> global <span class="token comment">// 挂载全局配置模块</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  i18n<span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="53__1139"></a>5.3 字符引用</h4> 
<p>在原本使用字符的地方加入国际化字符串。</p> 
<p>打开Home.vue，在模板下面添加一个国际化字符串和两个按钮做中英文切换。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('common.doc')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>success<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>changeLanguage(<span class="token punctuation">'</span>zh_cn<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>简体中文<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>success<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>changeLanguage(<span class="token punctuation">'</span>en_us<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>English<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>在方法声明区域添加以下方法，设置国际化语言。</p> 
<pre><code class="prism language-js"><span class="token comment">// 语言切换</span>
    <span class="token function">changeLanguage</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      lang <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">?</span> <span class="token string">'zh_cn'</span> <span class="token punctuation">:</span> lang
      <span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span>locale <span class="token operator">=</span> lang
      <span class="token keyword">this</span><span class="token punctuation">.</span>langVisible <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h4><a id="54__1162"></a>5.4 页面测试</h4> 
<p>启动应用，访问<a href="http://localhost:8080/#/" rel="nofollow">http://localhost:8080/#/</a>，进入主页，如下所示。</p> 
<p><img src="https://images2.imgbox.com/7c/19/TB3d6gPq_o.png" alt="在这里插入图片描述"></p> 
<p>单击"English"按钮，国际化字符变成英文，如下：</p> 
<p><img src="https://images2.imgbox.com/4b/f0/4jNWDFTi_o.png" alt="在这里插入图片描述"></p> 
<p>单击"简体中文"按钮，国际化字符又变成中文。</p> 
<p>通过<strong>this.$i18n.locale = xx</strong>方式就可以全局切换语言，Vue框架会根据local的值读取对应的国际化多语言文件并进行适时更新。</p> 
<h3><a id="6__1178"></a>6. 登录流程完善</h3> 
<h4><a id="61__1180"></a>6.1 登录界面</h4> 
<p>登录方法主要逻辑是调用后台登录接口，并在登录成功之后保存token到Cookie，保存用户到本地存储，然后跳转到主页面。</p> 
<pre><code class="prism language-js"> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">let</span> userInfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> account<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>account<span class="token punctuation">,</span> password<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>password<span class="token punctuation">,</span> 
        captcha<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>captcha <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 调用登录接口</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>msg <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            Cookies<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token comment">// 放置token到Cookie</span>
            sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> userInfo<span class="token punctuation">.</span>account<span class="token punctuation">)</span> <span class="token comment">// 保存用户到本地会话</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>  <span class="token comment">// 登录成功，跳转到主页</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> res<span class="token punctuation">.</span>message<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="62__1204"></a>6.2 主页面</h4> 
<p>在views下面另外添加几个页面文件，分别在头部、左侧导航和主内容区域。</p> 
<p>Home.vue：</p> 
<p>主页由导航菜单、头部区域和主内容区域组成。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 导航菜单栏 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav-bar</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav-bar</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 头部区域 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head-bar</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head-bar</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 主内容区域 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main-content</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main-content</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> HeadBar <span class="token keyword">from</span> <span class="token string">"./HeadBar"</span>
<span class="token keyword">import</span> NavBar <span class="token keyword">from</span> <span class="token string">"./NavBar"</span>
<span class="token keyword">import</span> MainContent <span class="token keyword">from</span> <span class="token string">"./MainContent"</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  components<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
        HeadBar<span class="token punctuation">,</span>
        NavBar<span class="token punctuation">,</span>
        MainContent
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
  <span class="token selector">.container</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    // <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>224, 234, 235, 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>  
</code></pre> 
<p>HeaderBar.vue：</p> 
<p>头部导航主要是设置样式，并在右侧添加用户名和头像显示。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span> 
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>headbar<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span>#14889A</span><span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>position-left<span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 工具栏 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toolbar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>el-menu-demo<span class="token punctuation">"</span></span> <span class="token attr-name">background-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#14889A<span class="token punctuation">"</span></span> <span class="token attr-name">text-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#14889A<span class="token punctuation">"</span></span> <span class="token attr-name">active-text-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#14889A<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 用户信息 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user-info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user.avatar<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>{<!-- -->{user.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> mock <span class="token keyword">from</span> <span class="token string">"@/mock/index"</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      user<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        name<span class="token punctuation">:</span> <span class="token string">"Louis"</span><span class="token punctuation">,</span>
        avatar<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
        role<span class="token punctuation">:</span> <span class="token string">"超级管理员"</span><span class="token punctuation">,</span>
        registeInfo<span class="token punctuation">:</span> <span class="token string">"注册时间：2018-12-20 "</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      activeIndex<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
      langVisible<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">selectNavBar</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> keyPath<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> keyPath<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> user <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span>name <span class="token operator">=</span> user
      <span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span>avatar <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/user.png"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token selector">.headbar</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 1030<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>180, 190, 190, 0.8<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-left-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">border-left-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.navbar</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.toolbar</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.user-info</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token selector">;
  img</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">width</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 10px 0px 10px 10px<span class="token punctuation">;</span>
    <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">.position-left</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">left</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>NavBar.vue：</p> 
<p>左侧导航包含上方Logo区域和下方导航菜单区域。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu-bar-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- logo --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span>#14889A</span><span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>menu-bar-width<span class="token punctuation">'</span><span class="token punctuation">"</span></span>
        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$router.push(<span class="token punctuation">'</span>/<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>@/assets/logo.png<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Mango<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token selector">.menu-bar-container</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 1020<span class="token selector">;
  .logo</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>   
    <span class="token property">line-height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #545c64<span class="token punctuation">;</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token selector">;
    img</span> <span class="token punctuation">{<!-- --></span>
        <span class="token property">width</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 10px 10px 10px 10px<span class="token punctuation">;</span>
        <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">div</span> <span class="token punctuation">{<!-- --></span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
      <span class="token property">padding-left</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.menu-bar-width</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>MainContent.vue：</p> 
<p>主内容区域包含标签页导航和主内容区域，在主内容中放置route-view用于路由信息。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-container<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-container<span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>position-left<span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 标签页 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tab-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 主内容区域 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token selector">.main-container</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 5px 5px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>67, 69, 70, 0.1<span class="token punctuation">)</span><span class="token selector">;
  .main-content</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 45px<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">.position-left</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">left</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="63__1448"></a>6.3 页面测试</h4> 
<p>启动应用，访问<a href="http://localhost:8080/#/login" rel="nofollow">http://localhost:8080/#/login</a>，进入登录界面，如下所示：</p> 
<p><img src="https://images2.imgbox.com/8f/35/fxY97A8P_o.png" alt="在这里插入图片描述"></p> 
<p>单击"登录"按钮，登录之后跳转到主页面：</p> 
<p><img src="https://images2.imgbox.com/d3/de/JoJJNXNo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7__1459"></a>7. 管理应用状态</h3> 
<p>在很多应用场景下，我们需要在组件之间共享状态，比如我们的左侧导航栏需要收缩和展开的功能，收缩时宽度很小，只显示菜单图标，因为导航菜单栏收缩之后宽度变了，所以右侧的主内容区域要占用导航栏收缩的空间，主内容区域宽度也要根据导航栏的收缩状态做变更，而导航栏和主内容区域是两个不同的组件，而非父子组件之间不支持状态传递，所以组件之间的状态共享问题产生了。vuex是一个专门为vue.js应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p> 
<p>vuex资料可参考：<a href="https://vuex.vuejs.org/zh/" rel="nofollow">https://vuex.vuejs.org/zh/</a></p> 
<h4><a id="71__1465"></a>7.1 安装依赖</h4> 
<p>执行</p> 
<blockquote> 
 <p>yarn add vuex</p> 
</blockquote> 
<p>命令安装vuex依赖。</p> 
<h4><a id="72_store_1473"></a>7.2 添加store</h4> 
<p>在src下新建一个store目录，专门管理应用状态：</p> 
<p><img src="https://images2.imgbox.com/f6/ad/pvNNUFsR_o.png" alt="在这里插入图片描述"></p> 
<p>index.js：</p> 
<p>在index.js中引入vuex并统一组织导入和管理子模块。</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 引入子模块</span>
<span class="token keyword">import</span> app <span class="token keyword">from</span> <span class="token string">'./modules/app'</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    modules<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        app<span class="token punctuation">:</span> app
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store
</code></pre> 
<p>app.js：</p> 
<p>app.js是属于应用内的全局性配置，比如主题色、导航栏收缩状态等。</p> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        appName<span class="token punctuation">:</span> <span class="token string">"Mango Platform"</span><span class="token punctuation">,</span>  <span class="token comment">// 应用名称</span>
        themeColor<span class="token punctuation">:</span> <span class="token string">"#14889A"</span><span class="token punctuation">,</span>  <span class="token comment">// 主题颜色</span>
        oldThemeColor<span class="token punctuation">:</span> <span class="token string">"#14889A"</span><span class="token punctuation">,</span>   <span class="token comment">// 上一次主题颜色</span>
        collapse<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// 导航栏收缩状态</span>
        menuRouteLoaded<span class="token punctuation">:</span><span class="token boolean">false</span>    <span class="token comment">// 菜单和路由是否已经加载</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    getters<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">collapse</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">// 对应着上面state</span>
            <span class="token keyword">return</span> state<span class="token punctuation">.</span>collapse
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">onCollapse</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 改变收缩状态</span>
            state<span class="token punctuation">.</span>collapse <span class="token operator">=</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>collapse
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">setThemeColor</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> themeColor<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 改变主题颜色</span>
            state<span class="token punctuation">.</span>oldThemeColor <span class="token operator">=</span> state<span class="token punctuation">.</span>themeColor
            state<span class="token punctuation">.</span>themeColor <span class="token operator">=</span> themeColor
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">menuRouteLoaded</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> menuRouteLoaded<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 改变菜单和路由的加载状态</span>
            state<span class="token punctuation">.</span>menuRouteLoaded <span class="token operator">=</span> menuRouteLoaded<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="73_store_1537"></a>7.3 引入store</h4> 
<p>在main.js中引入store。</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'./http'</span>
<span class="token keyword">import</span> i18n <span class="token keyword">from</span> <span class="token string">'./i18n'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>
<span class="token keyword">import</span> global <span class="token keyword">from</span> <span class="token string">'@/utils/global'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
<span class="token keyword">import</span> <span class="token string">'font-awesome/css/font-awesome.min.css'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>  <span class="token comment">// 注册使用Element</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>api<span class="token punctuation">)</span>  <span class="token comment">// 注册使用API模块</span>

Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>global <span class="token operator">=</span> global <span class="token comment">// 挂载全局配置模块</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  i18n<span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
  store<span class="token punctuation">,</span>
  render<span class="token punctuation">:</span> h <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="74_store_1567"></a>7.4 使用store</h4> 
<p>这里以头部页面HeadBar.vue的状态使用为例，其他页面同理。</p> 
<p>首先通过computed计算属性引入store属性，这样就可以直接在页面中通过collapse引用状态值了，当然如果不嫌长也可以不使用计算属性，直接在页面中通过$store.state.app.collapse引用。</p> 
<p>然后在页面中通过collapse的状态值来绑定不同的宽度样式。</p> 
<p><img src="https://images2.imgbox.com/b9/cd/MkMb6A3m_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="75__1578"></a>7.5 收缩组件</h4> 
<p>在src下新建components目录，并在其下创建导航栏收缩展开组件Hamburger。</p> 
<p>组件是使用SVG绘制，绘制根据isActive状态决定是否旋转、显示收缩和展开状态不同的图形。在头部区域HeadBar中引入hamburger并将自身isActive状态跟收缩状态collapse绑定。</p> 
<p>单击导航栏收缩组件区域的响应函数，设置导航收缩状态到Store。</p> 
<h4><a id="76__1586"></a>7.6 页面测试</h4> 
<p>启动应用，访问<a href="http://localhost:8080/#/login" rel="nofollow">http://localhost:8080/#/login</a>，单击登录进入主页面。如下：</p> 
<p><img src="https://images2.imgbox.com/bb/1e/V0DBsKUx_o.png" alt="在这里插入图片描述"></p> 
<p>单击导航栏收缩展开组件，导航菜单栏收缩起来，效果如下：</p> 
<p><img src="https://images2.imgbox.com/47/0b/a2XvT1cd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="8__1598"></a>8. 头部组件功能</h3> 
<p>本章介绍头部区域一些常用功能的实现方案，比如动态主题切换器、国际化语言切换器、用户信息弹出面板等。</p> 
<h4><a id="81__1602"></a>8.1 主题切换组件</h4> 
<h5><a id="811__1604"></a>8.1.1 编写组件</h5> 
<p>在components目录下新建一个主题切换器组件ThemePicker。</p> 
<p>ThemePicker实现思路是使用一个颜色选取组件el-color-picker获取一个主题色，然后通过动态替换覆盖Element默认CSS样式的方式替换框架的主题色primary color，并在主题色切换成功之后提供回调函数，通过此回调函数同步更新需要更换主题色的页面或组件。</p> 
<p>组件使用el-color-picker获取主题色，并绑定theme属性和size属性。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-color-picker</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>theme-picker<span class="token punctuation">"</span></span> <span class="token attr-name">popper-class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>theme-picker-dropdown<span class="token punctuation">"</span></span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>theme<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-color-picker</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>通过watch监听theme属性即主题色的更新动态替换CSS样式，并在替换CSS后通过**this.$emit(‘onThemeChange’, val)**语句提供一个回调函数onThemeChange并将更新后的主题色的值val作为参数传入，使得外部组件可以通过此回调函数同步更新外部组件颜色为主题。</p> 
<pre><code class="prism language-js">watch<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">theme</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
      <span class="token comment">// 替换CSS样式，修改主题色</span>
      <span class="token keyword">const</span> themeCluster <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getThemeCluster</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> originalCluster <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getThemeCluster</span><span class="token punctuation">(</span>oldVal<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>themeCluster<span class="token punctuation">,</span> originalCluster<span class="token punctuation">)</span>
      <span class="token keyword">const</span> <span class="token function-variable function">getHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>variable<span class="token punctuation">,</span> id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> originalCluster <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getThemeCluster</span><span class="token punctuation">(</span><span class="token constant">ORIGINAL_THEME</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">const</span> newStyle <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStyle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>variable<span class="token punctuation">]</span><span class="token punctuation">,</span> originalCluster<span class="token punctuation">,</span> themeCluster<span class="token punctuation">)</span>

          <span class="token keyword">let</span> styleTag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>styleTag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            styleTag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span>
            styleTag<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>
            document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>styleTag<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          styleTag<span class="token punctuation">.</span>innerText <span class="token operator">=</span> newStyle
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> chalkHandler <span class="token operator">=</span> <span class="token function">getHandler</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">,</span> <span class="token string">'chalk-style'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>chalk<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token string">`https://unpkg.com/element-ui@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/lib/theme-chalk/index.css`</span></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCSSString</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> chalkHandler<span class="token punctuation">,</span> <span class="token string">'chalk'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">chalkHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> styles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>style <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> text <span class="token operator">=</span> style<span class="token punctuation">.</span>innerText
          <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>oldVal<span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token regex">/Chalk Variables/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      styles<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>style <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> innerText <span class="token punctuation">}</span> <span class="token operator">=</span> style
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> innerText <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
        style<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStyle</span><span class="token punctuation">(</span>innerText<span class="token punctuation">,</span> originalCluster<span class="token punctuation">,</span> themeCluster<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 响应外部操作</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'onThemeChange'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>showSuccess<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> <span class="token string">'换肤成功'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'success'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showSuccess <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>在HeadBar.vue中引入ThemePicker组件并在页面中添加一个皮肤主题色切换器菜单。</p> 
<p><img src="https://images2.imgbox.com/4c/c9/DVnswnL3_o.png" alt="在这里插入图片描述"></p> 
<p>在方法区定义主题切换的回调函数，同步设置store中的themeColor：</p> 
<pre><code class="prism language-js"> <span class="token comment">// 切换主题</span>
    onThemeChange<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>themeColor<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setThemeColor'</span><span class="token punctuation">,</span> themeColor<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>将各个页面中需要同步为主题色的页面或组件绑定store主题色中的主题色属性themeColor，这样每次通过切换器切换主题色的时候都会把主题色通过store传递到页面组件，如下所示：</p> 
<p><img src="https://images2.imgbox.com/59/cb/ZJDc4cbm_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="812__1691"></a>8.1.2 页面测试</h5> 
<p>启动应用，访问<a href="http://localhost:8080/#/" rel="nofollow">http://localhost:8080/#/</a>，单击切换按钮选择主题色：</p> 
<p><img src="https://images2.imgbox.com/2c/42/fPb8sV1Q_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="82__1698"></a>8.2 语言切换组件</h4> 
<h5><a id="821__1700"></a>8.2.1 编写组件</h5> 
<p>在HeadBar.vue工具栏主题切换器右边放置一个语言切换组件，可以选择中英文两种语言。</p> 
<p><img src="https://images2.imgbox.com/21/7a/ELkd8Vqt_o.png" alt="在这里插入图片描述"></p> 
<p>语言切换响应函数，设置local值并让弹出下拉面板消失：</p> 
<pre><code class="prism language-js"><span class="token comment">// 语言切换</span>
    <span class="token function">changeLanguage</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      lang <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">?</span> <span class="token string">'zh_cn'</span> <span class="token punctuation">:</span> lang
      <span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span>locale <span class="token operator">=</span> lang
      <span class="token keyword">this</span><span class="token punctuation">.</span>langVisible <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>在头部工具栏左侧放置一些菜单项，使用国际化字符串，以测试多语言切换效果：</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!-- 导航菜单 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>navbar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span> <span class="token attr-name">:default-active</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>activeIndex<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>el-menu-demo<span class="token punctuation">"</span></span> 
          <span class="token attr-name">:background-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>themeColor<span class="token punctuation">"</span></span> <span class="token attr-name">text-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token attr-name">active-text-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ffd04b<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span> <span class="token attr-name">@select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectNavBar()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$router.push(<span class="token punctuation">'</span>/<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t("common.home")}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openWindow(<span class="token punctuation">'</span>https://gitee.com/liuge1988/kitty/wikis/Home<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t("common.doc")}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openWindow(<span class="token punctuation">'</span>https://www.cnblogs.com/xifengxiaoma/<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t("common.blog")}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="822__1732"></a>8.2.2 页面测试</h5> 
<p>效果如下：</p> 
<p><img src="https://images2.imgbox.com/ed/a1/YgkH2rVO_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="83__1739"></a>8.3 用户信息面板</h4> 
<h5><a id="831__1741"></a>8.3.1 编写组件</h5> 
<p>在views目录下新建一个core目录并在其下新建一个用户信息面板PersonalPanel.vue，单击用户头像时弹出用户信息面板，面板显示用户信息和一些功能操作。</p> 
<p>用户信息面板页面内容如下：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>personal-panel<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>personal-desc<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token punctuation">{<!-- --></span><span class="token string">'background'</span><span class="token punctuation">:</span>this.$store.state.app.themeColor<span class="token punctuation">}</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>avatar-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>require(<span class="token punctuation">'</span>@/assets/user.png<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name-role<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{ user.name }} - {<!-- -->{ user.role }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>registe-info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>registe-info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-clock-o<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            {<!-- -->{ user.registeInfo }}
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>personal-relation<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>relation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>followers<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>relation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>watches<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>relation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>friends<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-operation<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-operation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-male<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 个人中心<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>    
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-operation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-key<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 修改密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-operation<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-operation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-eraser<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          清除缓存
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-operation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          在线人数
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-operation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-bell<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          访问次数
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-operation-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-undo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          {<!-- -->{$t("common.backupRestore")}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>personal-footer<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-sign-out<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      {<!-- -->{$t("common.logout")}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">'PersonalPanel'</span><span class="token punctuation">,</span>
  components<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    user<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      type<span class="token punctuation">:</span> Object<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        name<span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
        avatar<span class="token punctuation">:</span> <span class="token string">"@/assets/user.png"</span><span class="token punctuation">,</span>
        role<span class="token punctuation">:</span> <span class="token string">"超级管理员"</span><span class="token punctuation">,</span>
        registeInfo<span class="token punctuation">:</span> <span class="token string">"注册时间：2018-12-25 "</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 退出登录</span>
    logout<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token string">"确认退出吗?"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> <span class="token string">"warning"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token selector">.personal-panel</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>180, 190, 190, 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">border-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>182, 172, 172, 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> -14px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.personal-desc</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.avatar</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">width</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 90px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.name-role</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.personal-relation</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>200, 209, 204, 0.3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.relation-item</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.relation-item:hover</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>19, 138, 156<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.main-operation</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token comment">/* background: rgba(175, 182, 179, 0.3); */</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>201, 206, 206, 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-top-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">border-top-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.main-operation-item</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.other-operation</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>180, 190, 190, 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-top-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">border-top-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.other-operation-item</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.other-operation-item:hover</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #9e94941e<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>19, 138, 156<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.personal-footer</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>180, 190, 190, 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-top-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">border-top-style</span><span class="token punctuation">:</span> solid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.personal-footer:hover</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>19, 138, 156<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #b1a6a61e<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>退出登录处理函数。确认退出后清空本地存储，返回登录页面并调用后台退出登录接口：</p> 
<pre><code class="prism language-js"><span class="token comment">// 退出登录</span>
    logout<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token string">"确认退出吗?"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> <span class="token string">"warning"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>在头部区域引入组件，在用户头像信息组件下通过popover组件关联用户信息面板：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-popover:</span>popover-personal</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 用户信息 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user-info<span class="token punctuation">"</span></span>
            <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user.avatar<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>{<!-- -->{ user.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span>
          <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-popover</span>
            <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>popover-personal<span class="token punctuation">"</span></span>
            <span class="token attr-name">placement</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bottom-end<span class="token punctuation">"</span></span>
            <span class="token attr-name">trigger</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>click<span class="token punctuation">"</span></span>
            <span class="token attr-name">:visible-arrow</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
          <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>personal-panel</span> <span class="token attr-name">:user</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>personal-panel</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-popover</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="832__1963"></a>8.3.2 页面测试</h5> 
<p><img src="https://images2.imgbox.com/6b/d6/k0yb7DB0_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="83__1968"></a>8.3 系统通知面板</h4> 
<h5><a id="831__1970"></a>8.3.1 编写组件</h5> 
<p>在view/core目录下新建一个系统通知面板NoticePanel.vue，在头部工具栏中添加系统通知组件，单击弹出系统通知信息面板。</p> 
<p>系统通知面板页面如下，主要通过遍历通知信息列表展示：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>notice-panel<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>您有 {<!-- -->{data.length}} 条通知<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>notice-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item in data<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.key<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>notice-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>notice-icon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.icon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>notice-cotent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          {<!-- -->{ item.content }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>notice-footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查看所有通知<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>在头部区域HeadBar.vue中引入组件并通过popover组件关联通知面板：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-popover:</span>popover-notice</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 系统通知 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-badge</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span> <span class="token attr-name">:max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>99<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>badge<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-bell-o fa-lg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-badge</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-popover</span>
            <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>popover-notice<span class="token punctuation">"</span></span>
            <span class="token attr-name">placement</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bottom-end<span class="token punctuation">"</span></span>
            <span class="token attr-name">trigger</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>click<span class="token punctuation">"</span></span>
          <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>notice-panel</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>notice-panel</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-popover</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="832__2013"></a>8.3.2 页面测试</h5> 
<p><img src="https://images2.imgbox.com/16/7e/N08XbyyU_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="84__2018"></a>8.4 用户私信面板</h4> 
<h5><a id="841__2020"></a>8.4.1 编写组件</h5> 
<p>在view/core目录下新建一个用户私信面板MessagePanel.vue，在头部工具栏添加用户私信组件，单击弹出用户私信信息面板。</p> 
<p>用户私信面板页面内容如下，主要通过遍历私信信息列表展示：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-panel<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>您有 {<!-- -->{data.length}} 条消息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item in data<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.key<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-avatar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>require(<span class="token punctuation">'</span>@/assets/user.png<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          {<!-- -->{ item.sender }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-clock-o<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> {<!-- -->{ item.time }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-cotent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          {<!-- -->{ item.content }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message-footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查看所有消息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>在头部区域引入组件并通过popover组件关联私信面板：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-popover:</span>popover-message</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 我的私信 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-badge</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">:max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>99<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>badge<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-envelope-o fa-lg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-badge</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-popover</span>
            <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>popover-message<span class="token punctuation">"</span></span>
            <span class="token attr-name">placement</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bottom-end<span class="token punctuation">"</span></span>
            <span class="token attr-name">trigger</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>click<span class="token punctuation">"</span></span>
          <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message-panel</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message-panel</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-popover</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="842__2069"></a>8.4.2 页面测试</h5> 
<p><img src="https://images2.imgbox.com/eb/51/utmvzyJz_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="9__2074"></a>9. 动态加载菜单</h3> 
<p>本章我们将介绍如何动态加载数据库的菜单数据并显示到导航栏。</p> 
<h4><a id="91_store_2078"></a>9.1 添加store</h4> 
<p>我们先添加几个store状态，后续需要用来共享使用。</p> 
<p>首先在store/modules下的app.js中添加一个menuRouteLoaded状态，判断路由是否加载过：</p> 
<p><img src="https://images2.imgbox.com/c7/e3/EYExboIM_o.png" alt="在这里插入图片描述"></p> 
<p>然后在store/modules下新建一个menu.js，在index.js中引入，里面保存着加载后的导航菜单树数据。</p> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        navTree<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 导航菜单树</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    getters<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
   
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setNavTree</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> navTree<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 设置导航菜单树</span>
            state<span class="token punctuation">.</span>navTree <span class="token operator">=</span> navTree<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在store/modules下新建一个user.js并在index.js中引入，里面保存加载后的用户权限数据。</p> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        perms<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 用户权限标识集合</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    getters<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
   
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setPerms</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> perms<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 用户权限标识集合</span>
            state<span class="token punctuation">.</span>perms <span class="token operator">=</span> perms<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="92__2128"></a>9.2 登录页面</h4> 
<p>打开登录页面Login.vue，在登录接口设置菜单加载状态，要求重新登录之后重新加载菜单：</p> 
<pre><code class="prism language-js"><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">let</span> userInfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> account<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>account<span class="token punctuation">,</span> password<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>password<span class="token punctuation">,</span> 
        captcha<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>captcha <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 调用登录接口</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>msg <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            Cookies<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token comment">// 放置token到Cookie</span>
            sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> userInfo<span class="token punctuation">.</span>account<span class="token punctuation">)</span> <span class="token comment">// 保存用户到本地会话</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'menuRouteLoaded'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 要求重新加载导航菜单</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>  <span class="token comment">// 登录成功，跳转到主页</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> res<span class="token punctuation">.</span>message<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h4><a id="93__2153"></a>9.3 导航守卫</h4> 
<p>路由对象router为我们提供了beforeEach方法，可以在每次路由之前进行一些相关处理，也叫导航守卫，我们这里就是通过导航守卫实现动态菜单的加载。</p> 
<p>修改router/index.js文件，添加导航守卫，在每次路由时判断用户会话是否过期。如果登录有效且跳转的是登录页面，就直接路由到主页；如果是非登录页面且会话过期，就会跳到登录页面要求登录；否则加载动态菜单并路由到目标界面。</p> 
<pre><code class="prism language-js">router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 登录界面登录成功之后，会把用户信息保存在会话</span>
  <span class="token comment">// 存在时间为会话生命周期，页面关闭即失效。</span>
  <span class="token keyword">let</span> userName <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/login'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 如果是访问登录界面，如果用户会话信息存在，代表已登录过，跳转到主页</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> path<span class="token punctuation">:</span> <span class="token string">'/'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 如果访问非登录界面，且户会话信息不存在，代表未登录，则跳转到登录界面</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> path<span class="token punctuation">:</span> <span class="token string">'/login'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 加载动态菜单和路由</span>
      <span class="token function">addDynamicMenuAndRoutes</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span> to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>加载动态路由的方法内容如下。首先判断动态菜单是否已经存在，如果存在就不再重复加载损耗性能，否则调用后台接口加载数据库存储菜单数据，加载成功后通过router.addRoutes方法将菜单数据动态添加到路由器并同时保持菜单数据及加载状态以备后用。导航菜单加载成功之后，调用后台接口查找用户权限数据并保存起来，供权限判断时读取。</p> 
<pre><code class="prism language-js"><span class="token comment">/**
* 加载动态菜单和路由
*/</span>
<span class="token keyword">function</span> <span class="token function">addDynamicMenuAndRoutes</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span> to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>menuRouteLoaded<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'动态菜单和路由已经存在.'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  api<span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">findNavTree</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'userName'</span><span class="token punctuation">:</span>userName<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 添加动态路由</span>
    <span class="token keyword">let</span> dynamicRoutes <span class="token operator">=</span> <span class="token function">addDynamicRoutes</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    router<span class="token punctuation">.</span>options<span class="token punctuation">.</span>routes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children <span class="token operator">=</span> router<span class="token punctuation">.</span>options<span class="token punctuation">.</span>routes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>dynamicRoutes<span class="token punctuation">)</span>
    router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span>options<span class="token punctuation">.</span>routes<span class="token punctuation">)</span>
    <span class="token comment">// 保存加载状态</span>
    store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'menuRouteLoaded'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token comment">// 保存菜单树</span>
    store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setNavTree'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    api<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">findPermissions</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span>userName<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 保存用户权限标识集合</span>
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setPerms'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>下面是遍历菜单数据实际创建路由对象的逻辑。</p> 
<pre><code class="prism language-js"><span class="token comment">/**
* 添加动态(菜单)路由
* @param {*} menuList 菜单列表
* @param {*} routes 递归创建的动态(菜单)路由
*/</span>
<span class="token keyword">function</span> <span class="token function">addDynamicRoutes</span> <span class="token punctuation">(</span>menuList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 <span class="token keyword">var</span> temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> menuList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     temp <span class="token operator">=</span> temp<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url <span class="token operator">&amp;&amp;</span> <span class="token regex">/\S/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url <span class="token operator">=</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\//</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
      <span class="token comment">// 创建路由配置</span>
      <span class="token keyword">var</span> route <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        path<span class="token punctuation">:</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span>
        component<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
          icon<span class="token punctuation">:</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>icon<span class="token punctuation">,</span>
          index<span class="token punctuation">:</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 根据菜单URL动态加载vue组件，这里要求vue组件须按照url路径存储</span>
        <span class="token comment">// 如url="sys/user"，则组件路径应是"@/views/sys/user.vue",否则组件加载不到</span>
        <span class="token keyword">let</span> array <span class="token operator">=</span> menuList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          url <span class="token operator">+=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/'</span>
        <span class="token punctuation">}</span>
        url <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> url<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        route<span class="token punctuation">[</span><span class="token string">'component'</span><span class="token punctuation">]</span> <span class="token operator">=</span> resolve <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token template-string"><span class="token string">`@/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> resolve<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
      routes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token function">addDynamicRoutes</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> routes<span class="token punctuation">)</span>
 <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'动态路由加载...'</span><span class="token punctuation">)</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'动态路由加载完成.'</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> routes
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="94__2266"></a>9.4 导航树组件</h4> 
<p>在components目录下新建一个导航树组件MenuTree，文件结构如下：</p> 
<p><img src="https://images2.imgbox.com/06/ab/rhLfk7n2_o.png" alt="在这里插入图片描述"></p> 
<p>MenuTree.vue的页面内容大致如下，主要是遍历菜单数据创建导航菜单。</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-submenu</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu.children &amp;&amp; menu.children.length &gt;= 1<span class="token punctuation">"</span></span> <span class="token attr-name">:index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span><span class="token punctuation">'</span> + menu.id<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu.icon<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{menu.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuTree</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item in menu.children<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.id<span class="token punctuation">"</span></span> <span class="token attr-name">:menu</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MenuTree</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-submenu</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">v-else</span> <span class="token attr-name">:index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span><span class="token punctuation">'</span> + menu.id<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleRoute(menu)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu.icon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{menu.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>上面的导航菜单都绑定了handleRoute函数，在单击菜单项的时候路由到指定路径。路由业务功能页面目前没有实现，后面实现业务功能页面时会讲到。</p> 
<p>在NavBar.vue中引入导航菜单树组件，并编写导航菜单区域内容，其中的菜单数据navTree是在导航守卫加载并存储到store的：</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!-- 导航菜单 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>navmenu<span class="token punctuation">"</span></span> <span class="token attr-name">default-active</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collapse?<span class="token punctuation">'</span>menu-bar-collapse-width<span class="token punctuation">'</span>:<span class="token punctuation">'</span>menu-bar-width<span class="token punctuation">'</span><span class="token punctuation">"</span></span>
      <span class="token attr-name">:collapse</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collapse<span class="token punctuation">"</span></span> <span class="token attr-name">:collapse-transition</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">:unique-opened</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true  <span class="token punctuation">"</span></span>
      <span class="token attr-name">@open</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleopen<span class="token punctuation">"</span></span> <span class="token attr-name">@close</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleclose<span class="token punctuation">"</span></span> <span class="token attr-name">@select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleselect<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 导航菜单树组件，动态加载菜单 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>menu-tree</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item in navTree<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.id<span class="token punctuation">"</span></span> <span class="token attr-name">:menu</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>menu-tree</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="95__2305"></a>9.5 页面测试</h4> 
<p><img src="https://images2.imgbox.com/81/16/OYdiFPJ0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="10__2310"></a>10. 页面权限控制</h3> 
<h4><a id="101__2312"></a>10.1 权限控制方案</h4> 
<p>既然是后台权限管理系统，当然少不了权限控制。至于权限控制，前端方面就是指对页面资源的访问与操作控制。前端资源权限主要分两个部分，即导航菜单的查看权限和页面增删改查操作按钮的操作权限。</p> 
<p>我们的设计把页面导航菜单和页面操作按钮统一存储在菜单数据库表中，菜单表中包含以下权限关注点。</p> 
<h5><a id="1011__2318"></a>10.1.1 菜单类型</h5> 
<p>菜单类型代表页面资源的类型。</p> 
<h5><a id="1012__2322"></a>10.1.2 权限标识</h5> 
<p>权限标识是对页面资源进行权限控制的唯一标识，主要是增删改查的权限控制。权限标识主要包含四种，以用户管理为例，权限标识包括sys:user:add、sys:user:edit、sys:user:delete、sys:user:view。</p> 
<p>(后台接口根据用户权限加载用户菜单数据返回给前端，前端导航菜单显示用户菜单数据，并在管理界面根据用户操作权限标识设置页面操作按钮的可见性或可用状态。我们这里采用无操作权限则页面按钮为不可用状态的方式)</p> 
<h4><a id="102__2328"></a>10.2 导航菜单实现思路</h4> 
<h5><a id="1021__2330"></a>10.2.1 用户登录系统</h5> 
<p>用户登录成功之后跳转首页</p> 
<h5><a id="1022__2334"></a>10.2.2 根据用户加载导航菜单</h5> 
<p>在路由导航守卫路由时加载用户导航菜单并存储到store。加载过程如下，返回结果排除按钮类型：user→user_role→role_menu→menu。</p> 
<h5><a id="1023__2338"></a>10.2.3 导航栏读取菜单树</h5> 
<p>导航栏页面到store读取导航菜单树并进行展示</p> 
<h4><a id="103__2342"></a>10.3 页面按钮实现思路</h4> 
<h5><a id="1031__2344"></a>10.3.1 用户登录系统</h5> 
<p>用户登录之后跳转到首页</p> 
<h5><a id="1032__2348"></a>10.3.2 加载权限标识</h5> 
<p>在路由导航守卫路由时加载用户权限标识集合并保存到store备用。加载过程如下，返回结果是用户权限标识的集合：user→user_role→role_menu→menu。</p> 
<h5><a id="1033__2352"></a>10.3.3 页面按钮控制</h5> 
<p>页面操作按钮提供perms属性绑定权限标识，使用disable属性绑定权限判断方法的返回值，权限判断方法hasPerms(perms)通过查找上一步保存的用户权限标识集合是否包含perms来判断用户是否拥有此相关权限，否则设置当前操作按钮为不可用状态。</p> 
<h4><a id="104__2356"></a>10.4 权限控制实现</h4> 
<h5><a id="1041__2358"></a>10.4.1 导航菜单权限</h5> 
<ol><li> <p>加载导航菜单</p> <p>在导航守卫路由时加载导航菜单并保存状态：</p> <p>router/index.js：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/63/e6/EavQkyaG_o.png" alt="在这里插入图片描述"></p> 
<ol start="2"><li> <p>页面组件引用</p> <p>导航栏页面从共享状态中读取导航菜单树并展示：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/e3/34/fEXb9gqr_o.png" alt="在这里插入图片描述"></p> 
<p>修改NavBar.vue文件：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu-bar-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- logo --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span>
      <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token punctuation">{<!-- --></span> <span class="token string">'background-color'</span><span class="token punctuation">:</span> themeColor <span class="token punctuation">}</span></span><span class="token punctuation">"</span></span>
      <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collapse ? <span class="token punctuation">'</span>menu-bar-collapse-width<span class="token punctuation">'</span> : <span class="token punctuation">'</span>menu-bar-width<span class="token punctuation">'</span><span class="token punctuation">"</span></span>
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$router.push(<span class="token punctuation">'</span>/<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collapse<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>@/assets/logo.png<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{<!-- -->{ collapse ? "" : appName }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 导航菜单 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span>
      <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>navmenu<span class="token punctuation">"</span></span>
      <span class="token attr-name">default-active</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
      <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collapse ? <span class="token punctuation">'</span>menu-bar-collapse-width<span class="token punctuation">'</span> : <span class="token punctuation">'</span>menu-bar-width<span class="token punctuation">'</span><span class="token punctuation">"</span></span>
      <span class="token attr-name">:collapse</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collapse<span class="token punctuation">"</span></span>
      <span class="token attr-name">:collapse-transition</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
      <span class="token attr-name">:unique-opened</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
      <span class="token attr-name">@open</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleopen<span class="token punctuation">"</span></span>
      <span class="token attr-name">@close</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleclose<span class="token punctuation">"</span></span>
      <span class="token attr-name">@select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleselect<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 导航菜单树组件，动态加载菜单 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>menu-tree</span>
        <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item in navTree<span class="token punctuation">"</span></span>
        <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.id<span class="token punctuation">"</span></span>
        <span class="token attr-name">:menu</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>menu-tree</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="1042__2414"></a>10.4.2 页面按钮权限</h5> 
<ol><li> <p>加载权限标识</p> <p>打开router/index.js，在导航守卫路由时加载权限标识并保存状态。</p> <p><img src="https://images2.imgbox.com/01/1a/Y7JJFSP1_o.png" alt="在这里插入图片描述"></p> </li><li> <p>权限按钮判断</p> <p>封装了权限操作按钮组件，在组件中根据外部传入的权限标识进行权限判断。</p> <p>views/Core/KtButton.vue：</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">:type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>type<span class="token punctuation">"</span></span> <span class="token attr-name">:icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span>
    <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!hasPerms(perms)<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleClick<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    {<!-- -->{label}}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> hasPermission <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/permission/index.js'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">'KtButton'</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    label<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮显示文本</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'Button'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    icon<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮显示图标</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    size<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮尺寸</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'mini'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮类型</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    loading<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮加载标识</span>
      type<span class="token punctuation">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    disabled<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮是否禁用</span>
      type<span class="token punctuation">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    perms<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 按钮权限标识，外部使用者传入</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    handleClick<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 按钮操作处理函数</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    hasPerms<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>perms<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 根据权限标识和外部指示状态进行权限判断</span>
      <span class="token keyword">return</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span>perms<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>disabled
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>权限判断逻辑</p> <p>新建权限文件src/permission/index.js，提供权限判断方法hasPermission，传入当前组件绑定的权限标识perms，判断权限标识是否存在于store中保存的用户权限标识集合中。</p> <p>src/permission/index.js：</p> <pre><code class="prism language-js"><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'@/store'</span>
<span class="token comment">/**
 * 判断用户是否拥有操作权限
 * 根据传入的权限标识，查看是否存在用户权限标识集合
 * @param perms
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">hasPermission</span> <span class="token punctuation">(</span>perms<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> hasPermission <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">let</span> permissions <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>perms
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token operator">=</span>permissions<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>permissions<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> perms<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            hasPermission <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> hasPermission
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>权限按钮引用</p> <p>在文件views/Sys/User.vue中配置相关内容，新建一个用户管理页面。在页面中引入权限按钮组件并绑定权限标识。</p> <p>views/Sys/User.vue：</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">:inline</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">:model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>filters<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>filters.name<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>用户名<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-search<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.search<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:role:view<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>findPage(null)<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-plus<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.add<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:user:add2<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleAdd<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>
</code></pre> <p>在文件views/Core/KtTable.vue中配置相关内容，添加一个表格封装组件，在组件中引入权限按钮组件，并将表格设计的编辑、删除、批量删除按钮绑定对应的权限标识：</p> <p>views/Core/KtTable.vue：</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--表格栏--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data.content<span class="token punctuation">"</span></span> <span class="token attr-name">:highlight-current-row</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>highlightCurrentRow<span class="token punctuation">"</span></span> <span class="token attr-name">@selection-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectionChange<span class="token punctuation">"</span></span> 
          <span class="token attr-name">@current-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleCurrentChange<span class="token punctuation">"</span></span> <span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">:element-loading-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.loading<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">:border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>border<span class="token punctuation">"</span></span> <span class="token attr-name">:stripe</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stripe<span class="token punctuation">"</span></span>
          <span class="token attr-name">:show-overflow-tooltip</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>showOverflowTooltip<span class="token punctuation">"</span></span> <span class="token attr-name">:max-height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxHeight<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">:align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>align<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selection<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>showBatchDelete &amp; showOperation<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column in columns<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span>
        <span class="token attr-name">:prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.prop<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.label<span class="token punctuation">"</span></span> <span class="token attr-name">:width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.width<span class="token punctuation">"</span></span> <span class="token attr-name">:min-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.minWidth<span class="token punctuation">"</span></span> 
        <span class="token attr-name">:fixed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.fixed<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.prop<span class="token punctuation">"</span></span> <span class="token attr-name">:type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.type<span class="token punctuation">"</span></span> <span class="token attr-name">:formatter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.formatter<span class="token punctuation">"</span></span>
        <span class="token attr-name">:sortable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column.sortable==null?true:column.sortable<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.operation<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>185<span class="token punctuation">"</span></span> <span class="token attr-name">fixed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>showOperation<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-edit<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.edit<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">:perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>permsEdit<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleEdit(scope.$index, scope.row)<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-trash<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.delete<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">:perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>permsDelete<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>danger<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleDelete(scope.$index, scope.row)<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--分页栏--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toolbar<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">padding</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.batchDelete<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">:perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>permsDelete<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>danger<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleBatchDelete()<span class="token punctuation">"</span></span> 
        <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>this.selections.length===0<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>left<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>showBatchDelete &amp; showOperation<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-pagination</span> <span class="token attr-name">layout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>total, prev, pager, next, jumper<span class="token punctuation">"</span></span> <span class="token attr-name">@current-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>refreshPageRequest<span class="token punctuation">"</span></span> 
        <span class="token attr-name">:current-page</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pageRequest.pageNum<span class="token punctuation">"</span></span> <span class="token attr-name">:page-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pageRequest.pageSize<span class="token punctuation">"</span></span> <span class="token attr-name">:total</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data.totalSize<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>right<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-pagination</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ol> 
<h4><a id="105__2575"></a>10.5 标签页功能</h4> 
<p>新建store/modules/tab.js文件，用于存储标签页和当前选中标签选项：</p> 
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 主入口标签页</span>
    mainTabs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 当前标签页名</span>
    mainTabsActiveName<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">updateMainTabs</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> tabs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      state<span class="token punctuation">.</span>mainTabs <span class="token operator">=</span> tabs
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">updateMainTabsActiveName</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      state<span class="token punctuation">.</span>mainTabsActiveName <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>修改views/MainContent.vue文件，在主内容区域上面添加标签页组件，通过Element的选项卡el-tabs组件实现，能够通过切换标签页查看不同的路由页面，并需要支持导航菜单和标签页同步：</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!-- 标签页 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tab-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tabs</span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabs<span class="token punctuation">"</span></span>
        <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>
          $store.state.app.collapse ? <span class="token punctuation">'</span>position-collapse-left<span class="token punctuation">'</span> : <span class="token punctuation">'</span>position-left<span class="token punctuation">'</span>
        <span class="token punctuation">"</span></span>
        <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mainTabsActiveName<span class="token punctuation">"</span></span>
        <span class="token attr-name">:closable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>card<span class="token punctuation">"</span></span>
        <span class="token attr-name">@tab-click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectedTabHandle<span class="token punctuation">"</span></span>
        <span class="token attr-name">@tab-remove</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>removeTabHandle<span class="token punctuation">"</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabs-tools<span class="token punctuation">"</span></span> <span class="token attr-name">:show-timeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">trigger</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hover<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>50px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>el-icon-arrow-down<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-menu</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dropdown<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabsCloseCurrentHandle<span class="token punctuation">"</span></span>
              <span class="token punctuation">&gt;</span></span>关闭当前标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span>
            <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabsCloseOtherHandle<span class="token punctuation">"</span></span>
              <span class="token punctuation">&gt;</span></span>关闭其它标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span>
            <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabsCloseAllHandle<span class="token punctuation">"</span></span>
              <span class="token punctuation">&gt;</span></span>关闭全部标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span>
            <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabsRefreshCurrentHandle<span class="token punctuation">"</span></span>
              <span class="token punctuation">&gt;</span></span>刷新当前标签<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span>
            <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-menu</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span>
          <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item in mainTabs<span class="token punctuation">"</span></span>
          <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.name<span class="token punctuation">"</span></span>
          <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.title<span class="token punctuation">"</span></span>
          <span class="token attr-name">:name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.name<span class="token punctuation">"</span></span>
        <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>label<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.icon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span> {<!-- -->{ item.title }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tabs</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>通过watch实现对路由对象$route的监听，监听到路由变化的时候调用handleRoute方法进行处理，处理逻辑主要分三项：1.判断标签页是否存在，不存在则创建；2.如果是新创建了标签页，就把标签页加入当前标签页集合；3.同步标签页路由到导航菜单，设置选中状态。</p> 
<pre><code class="prism language-js">watch<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    $route<span class="token punctuation">:</span> <span class="token string">"handleRoute"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 路由操作处理</span>
    <span class="token function">handleRoute</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// tab标签页选中, 如果不存在则先添加</span>
      <span class="token keyword">var</span> tab <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> route<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tab<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        tab <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
          name<span class="token punctuation">:</span> route<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
          title<span class="token punctuation">:</span> route<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
          icon<span class="token punctuation">:</span> route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>icon
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabsActiveName <span class="token operator">=</span> tab<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
      <span class="token comment">// 切换标签页时同步更新高亮菜单</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>navmenu <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>navmenu<span class="token punctuation">.</span>activeIndex <span class="token operator">=</span> <span class="token string">""</span> <span class="token operator">+</span> route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>index<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>navmenu<span class="token punctuation">.</span><span class="token function">initOpenedMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>上一步将标签页存储到了store，这里mainTabs从store中获取标签页数据提供给页面：</p> 
<pre><code class="prism language-js">computed<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
	mainTabs<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>tab<span class="token punctuation">.</span>mainTabs<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">"updateMainTabs"</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mainTabsActiveName<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>tab<span class="token punctuation">.</span>mainTabsActiveName<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">"updateMainTabsActiveName"</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>标签页对应的操作函数包括标签的选中、关闭等系列操作。</p> 
<pre><code class="prism language-js"> methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// tabs, 选中tab</span>
    <span class="token function">selectedTabHandle</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      tab <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> tab<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>tab<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span> tab<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// tabs, 删除tab</span>
    <span class="token function">removeTabHandle</span><span class="token punctuation">(</span>tabName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">!==</span> tabName<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 当前选中tab被删除</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tabName <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabsActiveName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            <span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabsActiveName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// tabs, 关闭当前</span>
    <span class="token function">tabsCloseCurrentHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeTabHandle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mainTabsActiveName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// tabs, 关闭其它</span>
    <span class="token function">tabsCloseOtherHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
        item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabsActiveName
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// tabs, 关闭全部</span>
    <span class="token function">tabsCloseAllHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// tabs, 刷新当前</span>
    <span class="token function">tabsRefreshCurrentHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">var</span> tempTabName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainTabsActiveName<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeTabHandle</span><span class="token punctuation">(</span>tempTabName<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span> tempTabName <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="106__2752"></a>10.6 系统介绍页</h4> 
<p>为方便标签页效果的测试，这里添加一个系统介绍页，作为系统的首页。新建views/Intro/Intro.vue文件结构，添加系统介绍页面，附上介绍信息：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page-container<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span>99%<span class="token punctuation">;</span><span class="token property">margin-top</span><span class="token punctuation">:</span>15px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-carousel</span> <span class="token attr-name">:interval</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3000<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>card<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>450px<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>carousel<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-carousel-item</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>carousel-item-intro<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>项目介绍<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>基于 Spring Boot、Spring Cloud、Vue、Element 的 Java EE 快速开发平台<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>旨在提供一套简洁易用的解决方案，帮助用户有效降低项目开发难度和成本<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>博客提供项目开发过程同步系列教程文章，手把手的教你如何开发同类系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>@/assets/logo.png<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span>120px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>120px<span class="token punctuation">;</span><span class="token property">padding-top</span><span class="token punctuation">:</span>15px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-carousel-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-carousel-item</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>carousel-item-func<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>功能计划<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 系统登录：系统用户登录，系统登录认证（token方式）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 用户管理：新建用户，修改用户，删除用户，查询用户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 机构管理：新建机构，修改机构，删除机构，查询机构<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 角色管理：新建角色，修改角色，删除角色，查询角色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 菜单管理：新建菜单，修改菜单，删除菜单，查询菜单<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 系统日志：记录用户操作日志，查看系统执行日志记录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 数据监控：定制Druid信息，提供简洁有效的SQL监控<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 聚合文档：定制在线文档，提供简洁美观的API文档<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 备份还原：系统备份还原，一键恢复系统初始化数据<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 主题切换：支持主题切换，自定主题颜色，一键换肤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 服务治理：集成Spring Cloud，实现全方位服务治理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>✔ 服务监控：集成Spring Boot Admin，实现微服务监控<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-carousel-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-carousel-item</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>carousel-item-env<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>开发环境<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>IDE : eclipse 4.6.x。     JDK : JDK 1.8.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>Maven : Maven 3.5.x。   MySQL: MySQL 5.7.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>IDE : VS Code 1.27。    Webpack：webpack 3.2.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>NODE: Node 8.9.x。      NPM : NPM 6.4.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>技术选型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>核心框架：Spring Boot 2.x。  服务治理：Spring Cloud。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>视图框架：Spring MVC 5.x。   持久层框架：MyBatis 3.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>数据库连接池：Druid 1.x。    安全框架：Shiro 1.4.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>前端框架：Vue.js 2.x。       页面组件：Element 2.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>状态管理：Vuex.js 2.x。      后台交互：axios 0.18.x。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-carousel-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-carousel</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    components<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods <span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
  <span class="token selector">.carousel</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">padding-left</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token property">padding-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token property">margin-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel h2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #475669<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 22px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel ul</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #475669<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-intro h2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 22px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-intro ul</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 65px<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
   <span class="token selector">.carousel-item-func h2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #3f393b<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 22px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-func ul</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #3f393b<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">padding-left</span><span class="token punctuation">:</span> 90px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-env h2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #475669<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 22px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-env ul</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">color</span><span class="token punctuation">:</span> #475669<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.75<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 35px<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">padding-left</span><span class="token punctuation">:</span> 110px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-intro</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #19aaaf73<span class="token punctuation">;</span>
    <span class="token property">-webkit-border-radius</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">-moz-border-radius</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">background-clip</span><span class="token punctuation">:</span> padding-box<span class="token punctuation">;</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 25px #a3b3b965<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-func</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #19aaaf73<span class="token punctuation">;</span>
    <span class="token property">-webkit-border-radius</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">-moz-border-radius</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">background-clip</span><span class="token punctuation">:</span> padding-box<span class="token punctuation">;</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 25px #a3b3b965<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-env</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #19aaaf73<span class="token punctuation">;</span>
    <span class="token property">-webkit-border-radius</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">-moz-border-radius</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
    <span class="token property">background-clip</span><span class="token punctuation">:</span> padding-box<span class="token punctuation">;</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 25px #a3b3b965<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-intro</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #b95e5e<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-func</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #52c578<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.carousel-item-env</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #41a7b9<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>在router/index.js中添加系统介绍的路由。</p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
      path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">'首页'</span><span class="token punctuation">,</span>
      component<span class="token punctuation">:</span> Home<span class="token punctuation">,</span>
      children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span> 
          path<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> 
          name<span class="token punctuation">:</span> <span class="token string">'系统介绍'</span><span class="token punctuation">,</span> 
          component<span class="token punctuation">:</span> Intro<span class="token punctuation">,</span>
          meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            icon<span class="token punctuation">:</span> <span class="token string">'fa fa-home fa-lg'</span><span class="token punctuation">,</span>
            index<span class="token punctuation">:</span> <span class="token number">0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h4><a id="107__2942"></a>10.7 页面测试</h4> 
<p>效果如下：</p> 
<p><img src="https://images2.imgbox.com/6d/06/NfAdWAYj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3e/2d/fNEgjIEn_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="11__2950"></a>11. 功能管理模块</h3> 
<p>就目前来看，功能管理页面大都相似，如用户管理、功能管理模块的字典管理、系统配置、登录日志和操作日志等都是以表格管理数据为主，机构管理和菜单管理则以表格树的数据为主，所以这里在每个类型中挑选一个作为讲解案例。</p> 
<h4><a id="111__2954"></a>11.1 字典管理</h4> 
<h5><a id="1111__2956"></a>11.1.1 关键代码</h5> 
<p>参照用户管理界面，在views/Sys下添加字段管理页面组件，逐步添加页面内容。</p> 
<ol><li> <p>添加工具栏内容。</p> <pre><code class="prism language-html">views/Sys/Dict.vue

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--工具栏--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toolbar<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>left<span class="token punctuation">;</span><span class="token property">padding-top</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span><span class="token property">padding-left</span><span class="token punctuation">:</span>15px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">:inline</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">:model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>filters<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>filters.label<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>名称<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-search<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.search<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:dict:view<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>findPage(null)<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-plus<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.add<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:dict:add<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleAdd<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	
</code></pre> </li><li> <p>添加展示表格kt-table组件。</p> <pre><code class="prism language-html">views/Sys/Dict.vue

<span class="token comment">&lt;!--表格内容栏--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-table</span> <span class="token attr-name">permsEdit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:dict:edit<span class="token punctuation">"</span></span> <span class="token attr-name">permsDelete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:dict:delete<span class="token punctuation">"</span></span>
		<span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pageResult<span class="token punctuation">"</span></span> <span class="token attr-name">:columns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span> 
		<span class="token attr-name">@findPage</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>findPage<span class="token punctuation">"</span></span> <span class="token attr-name">@handleEdit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleEdit<span class="token punctuation">"</span></span> <span class="token attr-name">@handleDelete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleDelete<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kt-table</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>编辑对话框。</p> <pre><code class="prism language-html">views/Sys/Dict.vue

<span class="token comment">&lt;!--新增编辑界面--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>operation?<span class="token punctuation">'</span>新增<span class="token punctuation">'</span>:<span class="token punctuation">'</span>编辑<span class="token punctuation">'</span><span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40%<span class="token punctuation">"</span></span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>editDialogVisible<span class="token punctuation">"</span></span> <span class="token attr-name">:close-on-click-modal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">:model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm<span class="token punctuation">"</span></span> <span class="token attr-name">label-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80px<span class="token punctuation">"</span></span> <span class="token attr-name">:rules</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataFormRules<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm<span class="token punctuation">"</span></span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ID<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span>  <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.id<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>名称<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>label<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.label<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>值<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>value<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.value<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>类型<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>type<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.type<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>排序<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sort<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.sort<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>描述 <span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.description<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>备注<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>remarks<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataForm.remarks<span class="token punctuation">"</span></span> <span class="token attr-name">auto-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>textarea<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dialog-footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>editDialogVisible = false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('action.cancel')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>size<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submitForm<span class="token punctuation">"</span></span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>editLoading<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('action.submit')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>编写分页查询方法。</p> <pre><code class="prism language-js">views<span class="token operator">/</span>Sys<span class="token operator">/</span>Dict<span class="token punctuation">.</span>vue

<span class="token comment">// 获取分页数据</span>
		findPage<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pageRequest <span class="token operator">=</span> data<span class="token punctuation">.</span>pageRequest
			<span class="token punctuation">}</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>pageRequest<span class="token punctuation">.</span>params <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span><span class="token string">'label'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>filters<span class="token punctuation">.</span>label<span class="token punctuation">}</span><span class="token punctuation">]</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>dict<span class="token punctuation">.</span><span class="token function">findPage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pageRequest<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>pageResult <span class="token operator">=</span> res<span class="token punctuation">.</span>data
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">?</span>data<span class="token punctuation">.</span>callback<span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li><li> <p>编写批量删除方法。</p> <pre><code class="prism language-js">views<span class="token operator">/</span>Sys<span class="token operator">/</span>Dict<span class="token punctuation">.</span>vue

<span class="token comment">// 批量删除</span>
		handleDelete<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>dict<span class="token punctuation">.</span><span class="token function">batchDelete</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">?</span>data<span class="token punctuation">.</span>callback<span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li><li> <p>编辑提交方法。</p> <pre><code class="prism language-js">views<span class="token operator">/</span>Sys<span class="token operator">/</span>Dict<span class="token punctuation">.</span>vue

<span class="token comment">// 编辑</span>
		submitForm<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>dataForm<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token string">'确认提交吗？'</span><span class="token punctuation">,</span> <span class="token string">'提示'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>editLoading <span class="token operator">=</span> <span class="token boolean">true</span>
						<span class="token keyword">let</span> params <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataForm<span class="token punctuation">)</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>dict<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
							<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
								<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> <span class="token string">'操作成功'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'success'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
							<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
								<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>message<span class="token punctuation">:</span> <span class="token string">'操作失败, '</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
							<span class="token punctuation">}</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>editLoading <span class="token operator">=</span> <span class="token boolean">false</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">'dataForm'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>editDialogVisible <span class="token operator">=</span> <span class="token boolean">false</span>
							<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findPage</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
						<span class="token punctuation">}</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li></ol> 
<h5><a id="1112__3089"></a>11.1.2 页面截图</h5> 
<p><img src="https://images2.imgbox.com/0a/1b/E7BuFJKp_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="112__3094"></a>11.2 角色管理</h4> 
<p>角色管理页面除了表格展示之外，还可以给角色赋予角色菜单。</p> 
<h5><a id="1121__3098"></a>11.2.1 关键代码</h5> 
<p>首先在views/Sys下新建角色管理页面，然后模仿用户管理加入表格组件，再在角色表格下面添加一个角色菜单树，为用户分配角色菜单。</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--角色菜单，表格树内容栏--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu-container<span class="token punctuation">"</span></span> <span class="token attr-name">:v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu-header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>B</span><span class="token punctuation">&gt;</span></span>角色菜单授权<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>B</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tree</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menuData<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mini<span class="token punctuation">"</span></span> <span class="token attr-name">show-checkbox</span> <span class="token attr-name">node-key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>defaultProps<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">
			<span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">pading-top</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menuTree<span class="token punctuation">"</span></span> <span class="token attr-name">:render-content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>renderContent<span class="token punctuation">"</span></span>
			<span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menuLoading<span class="token punctuation">"</span></span> <span class="token attr-name">element-loading-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>拼命加载中<span class="token punctuation">"</span></span> <span class="token attr-name">:check-strictly</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
			<span class="token attr-name">@check-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleMenuCheckChange<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tree</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>left<span class="token punctuation">;</span><span class="token property">padding-left</span><span class="token punctuation">:</span>24px<span class="token punctuation">;</span><span class="token property">padding-top</span><span class="token punctuation">:</span>12px<span class="token punctuation">;</span><span class="token property">padding-bottom</span><span class="token punctuation">:</span>4px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-checkbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkAll<span class="token punctuation">"</span></span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleCheckAll<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>this.selectRole.id == null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>全选<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-checkbox</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">float</span><span class="token punctuation">:</span>right<span class="token punctuation">;</span><span class="token property">padding-right</span><span class="token punctuation">:</span>15px<span class="token punctuation">;</span><span class="token property">padding-top</span><span class="token punctuation">:</span>4px<span class="token punctuation">;</span><span class="token property">padding-bottom</span><span class="token punctuation">:</span>4px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.reset<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:role:edit<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>resetSelection<span class="token punctuation">"</span></span> 
				<span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>this.selectRole.id == null<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.submit<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:role:edit<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submitAuthForm<span class="token punctuation">"</span></span> 
				<span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>this.selectRole.id == null<span class="token punctuation">"</span></span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>authLoading<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>然后针对选中的角色同步更新菜单树的勾选项以及进行菜单树本身节点选中时对应父子关系的同步选中状态变更。</p> 
<pre><code class="prism language-js"><span class="token comment">// 角色选择改变监听</span>
		<span class="token function">handleRoleSelectChange</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> val<span class="token punctuation">.</span>val <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>selectRole <span class="token operator">=</span> val<span class="token punctuation">.</span>val
			<span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>role<span class="token punctuation">.</span><span class="token function">findRoleMenus</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'roleId'</span><span class="token punctuation">:</span>val<span class="token punctuation">.</span>val<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>currentRoleMenus <span class="token operator">=</span> res<span class="token punctuation">.</span>data
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">setCheckedNodes</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 树节点选择监听</span>
		<span class="token function">handleMenuCheckChange</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> check<span class="token punctuation">,</span> subCheck<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>check<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 节点选中时同步选中父节点</span>
				<span class="token keyword">let</span> parentId <span class="token operator">=</span> data<span class="token punctuation">.</span>parentId
				<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">setChecked</span><span class="token punctuation">(</span>parentId<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 节点取消选中时同步取消选中子节点</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>children <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					data<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>element <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>menuTree<span class="token punctuation">.</span><span class="token function">setChecked</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h5><a id="1122__3156"></a>11.2.2 页面截图</h5> 
<p><img src="https://images2.imgbox.com/80/cc/HUGAGJnD_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="113__3161"></a>11.3 菜单管理</h4> 
<p>菜单管理主要是放置一个表格树组件，可以支持表格的新增、编辑和删除。机构管理页面与此类似。</p> 
<p>在Core目录下添加一个TableTreeColumn封装组件，作为表格中可展开的列。</p> 
<h5><a id="1131__3167"></a>11.3.1 表格列组件</h5> 
<pre><code class="prism language-html">views/Core/TableTreeColumn.vue

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">:prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prop<span class="token punctuation">"</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$attrs<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>toggleHandle(scope.$index, scope.row)<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token function">childStyles</span><span class="token punctuation">(</span>scope.row<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iconClasses(scope.row)<span class="token punctuation">"</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token function">iconStyles</span><span class="token punctuation">(</span>scope.row<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
        {<!-- -->{ scope.row[prop] }}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> isArray <span class="token keyword">from</span> <span class="token string">'lodash/isArray'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    name<span class="token punctuation">:</span> <span class="token string">'table-tree-column'</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      prop<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> String
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      treeKey<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'id'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      parentKey<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'parentId'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      levelKey<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'level'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      childKey<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'children'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">childStyles</span> <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'padding-left'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>levelKey<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'px'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">iconClasses</span> <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span> <span class="token operator">!</span>row<span class="token punctuation">.</span>_expanded <span class="token operator">?</span> <span class="token string">'el-icon-caret-right'</span> <span class="token punctuation">:</span> <span class="token string">'el-icon-caret-bottom'</span> <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">iconStyles</span> <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'visibility'</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasChild</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'visible'</span> <span class="token punctuation">:</span> <span class="token string">'hidden'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">hasChild</span> <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>childKey<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> row<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>childKey<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 切换处理</span>
      <span class="token function">toggleHandle</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasChild</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>store<span class="token punctuation">.</span>states<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
          data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_expanded <span class="token operator">=</span> <span class="token operator">!</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_expanded
          <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>_expanded<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>childKey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeChildNode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>treeKey<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setData'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span><span class="token function">doLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 移除子节点</span>
      <span class="token function">removeChildNode</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> parentId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> parentIds <span class="token operator">=</span> <span class="token function">isArray</span><span class="token punctuation">(</span>parentId<span class="token punctuation">)</span> <span class="token operator">?</span> parentId <span class="token punctuation">:</span> <span class="token punctuation">[</span>parentId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parentId<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">return</span> data
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>parentIds<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>parentKey<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> parentIds<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>treeKey<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            ids<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>treeKey<span class="token punctuation">]</span><span class="token punctuation">)</span>
            i<span class="token operator">--</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeChildNode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> ids<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="1132__3257"></a>11.3.2 创建表格树</h5> 
<p>在Sys目录下新建一个菜单管理界面，加入工具栏、编辑对话框与其他功能类型，主要是在页面放置表格树组件，放置一个el-table，针对name列使用我们封装的TableTreeColumn组件显示子树的展示。</p> 
<pre><code class="prism language-html">views/Sys/Menu.vue

<span class="token comment">&lt;!--表格树内容栏--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tableTreeDdata<span class="token punctuation">"</span></span> <span class="token attr-name">stripe</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mini<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span>
      <span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">rowKey</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">element-loading-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.loading<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ID<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table-tree-column</span> 
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">treeKey</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>150<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>名称<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table-tree-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>图标<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope.row.icon || <span class="token punctuation">'</span><span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>type<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>类型<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope.row.type === 0<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>目录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope.row.type === 1<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>success<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>菜单<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope.row.type === 2<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> 
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>parentName<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>上级菜单<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>150<span class="token punctuation">"</span></span> 
        <span class="token attr-name">:show-overflow-tooltip</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>菜单URL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>perms<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>150<span class="token punctuation">"</span></span> 
        <span class="token attr-name">:show-overflow-tooltip</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>授权标识<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>orderNum<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>排序<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">fixed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>185<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.operation<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-edit<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.edit<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:menu:edit<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleEdit(scope.row)<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kt-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-trash<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.delete<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">perms</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sys:menu:delete<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>danger<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleDelete(scope.row)<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="1133__3309"></a>11.3.3 页面截图</h5> 
<p><img src="https://images2.imgbox.com/e3/cb/RVXEdvnR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12__3314"></a>12. 嵌套外部网页</h3> 
<h4><a id="121__3316"></a>12.1 需求背景</h4> 
<p>有些时候，我们需要内嵌外部网页，可以通过单击导航菜单，然后将我们的主内容栏加载外部网页的内容进行显示，如查看服务端提供的SQL监控页面、接口文档页面等。</p> 
<p>这是就要求我们的导航菜单能够解析外部嵌套网页的URL，并根据URL路由到相应的嵌套组件。</p> 
<h4><a id="122__3322"></a>12.2 实现原理</h4> 
<ol><li>给菜单URL添加外部嵌套网页格式，除内部渲染的页面URL外，外部网页统一直接以http[s]完整路径开头。</li><li>路由导航守卫在动态加载路由时，检测到如果是外部嵌套网页，就绑定到IFrame嵌套组件，最后使用IFrame组件来渲染嵌套页面。</li><li>菜单单击跳转时，根据路由类型生成不同的路由路径，载入特定的页面内容渲染到步骤2绑定的特定组件中。</li></ol> 
<h4><a id="123__3328"></a>12.3 代码实现</h4> 
<h5><a id="1231_URL_3330"></a>12.3.1 确定菜单URL</h5> 
<p>服务监控页面，其实显示的就是服务监控提供的现有页面。访问地址是<a href="http://localhost:8001/druid/login.html" rel="nofollow">http://localhost:8001/druid/login.html</a>，即完整的HTTP地址格式。输入完整的账号密码就可以看了(均为admin)。</p> 
<p>我们将SQL监控的菜单URL配置为<a href="http://127.0.0.1:8001/druid/login.html" rel="nofollow">http://127.0.0.1:8001/druid/login.html</a>，localhost跟127.0.0.1是一个意思，代表本机，届时路由解析时检测到以http开头的就是外部网页，然后绑定到IFrame嵌套页面组件上进行渲染。</p> 
<h5><a id="1232__3336"></a>12.3.2 创建嵌套组件</h5> 
<p>在views下创建IFrame目录并在其下创建一个IFrame.vue嵌套组件。</p> 
<p>IFrame组件在渲染时，读取store的iframeUrl以加载要渲染的内容(通过设置src)。</p> 
<pre><code class="prism language-html">views/IFrame/IFrame.vue

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframe-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>src<span class="token punctuation">"</span></span> <span class="token attr-name">scrolling</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>auto<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frame<span class="token punctuation">"</span></span> <span class="token attr-name">:onload</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onloaded()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      src<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      loading<span class="token punctuation">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取路径</span>
    resetSrc<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>src <span class="token operator">=</span> url
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    load<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$loading</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>  
        lock<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        text<span class="token punctuation">:</span> <span class="token string">"loading..."</span><span class="token punctuation">,</span>
        spinner<span class="token punctuation">:</span> <span class="token string">"el-icon-loading"</span><span class="token punctuation">,</span>
        background<span class="token punctuation">:</span> <span class="token string">"rgba(0, 0, 0, 0.5)"</span><span class="token punctuation">,</span>
        <span class="token comment">// fullscreen: false,</span>
        target<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#main-container "</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onloaded<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetSrc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>iframe<span class="token punctuation">.</span>iframeUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    $route<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      handler<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 如果是跳转到嵌套页面，切换iframe的url</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetSrc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>iframe<span class="token punctuation">.</span>iframeUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token selector">.iframe-container</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0px<span class="token selector">;
  .frame</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="1233__3411"></a>12.3.3 绑定嵌套组件</h5> 
<p>在导航守卫动态加载路由时，解析URL，如果是嵌套页面，就绑定到IFrame组件。</p> 
<p>router/index.js相关内容如下：</p> 
<p><img src="https://images2.imgbox.com/fc/7c/dAj7Yepm_o.png" alt="在这里插入图片描述"></p> 
<p>在每次路由时，把路由路径保存到store，如果是IFrame嵌套页面，IFrame就会在渲染的时候到store读取iframeUrl确定渲染的内容。</p> 
<pre><code class="prism language-js"><span class="token comment">/**
 * 处理IFrame嵌套页面
 */</span>
<span class="token keyword">function</span> <span class="token function">handleIFrameUrl</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 嵌套页面，保存iframeUrl到store，供IFrame组件读取展示</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> path
  <span class="token keyword">let</span> length <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>iframe<span class="token punctuation">.</span>iframeUrls<span class="token punctuation">.</span>length
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> iframe <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>iframe<span class="token punctuation">.</span>iframeUrls<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>path <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> path<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span>iframe<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      url <span class="token operator">=</span> iframe<span class="token punctuation">.</span>url
      store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'setIFrameUrl'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在store/modules下新建iframe.js文件，存储IFrame状态。</p> 
<pre><code class="prism language-js">store<span class="token operator">/</span>modules<span class="token operator">/</span>iframe<span class="token punctuation">.</span>js

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        iframeUrl<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment">// 当前嵌套页面路由路径</span>
        iframeUrls<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment">// 所有嵌套页面路由路径访问URL</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    getters<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setIFrameUrl</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> iframeUrl<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 设置iframeUrl</span>
            state<span class="token punctuation">.</span>iframeUrl <span class="token operator">=</span> iframeUrl
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">addIFrameUrl</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> iframeUrl<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// iframeUrls</span>
            state<span class="token punctuation">.</span>iframeUrls<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>iframeUrl<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>iframe.js是一个工具类，主要对嵌套URL进行处理：</p> 
<pre><code class="prism language-js">utils<span class="token operator">/</span>iframe<span class="token punctuation">.</span>js

<span class="token comment">/**
 * 嵌套页面IFrame模块
 */</span>

<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> baseUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/global'</span>

<span class="token comment">/**
 * 嵌套页面URL地址
 * @param {*} url
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getIFramePath</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> iframeUrl <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex">/^iframe:.*/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    iframeUrl <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'iframe:'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex">/^http[s]?:\/\/.*/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    iframeUrl <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>iframeUrl<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      iframeUrl <span class="token operator">=</span> iframeUrl<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>iframeUrl<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> iframeUrl
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 嵌套页面路由路径
 * @param {*} url
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getIFrameUrl</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> iframeUrl <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex">/^iframe:.*/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    iframeUrl <span class="token operator">=</span> baseUrl <span class="token operator">+</span> url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'iframe:'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex">/^http[s]?:\/\/.*/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    iframeUrl <span class="token operator">=</span> url
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> iframeUrl
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="1234__3509"></a>12.3.4 菜单路由跳转</h5> 
<p>在菜单路由跳转的时候，判断是否是IFrame路由，如果是就处理成IFrame需要的路由URL进行跳转。</p> 
<pre><code class="prism language-js">components<span class="token operator">/</span>MenuTree<span class="token operator">/</span>index<span class="token punctuation">.</span>vue

 <span class="token function">handleRoute</span> <span class="token punctuation">(</span>menu<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 如果是嵌套页面，转换成iframe的path</span>
      <span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">getIFramePath</span><span class="token punctuation">(</span>menu<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        path <span class="token operator">=</span> menu<span class="token punctuation">.</span>url
      <span class="token punctuation">}</span>
      <span class="token comment">// 通过菜单URL跳转至指定路由</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span> <span class="token operator">+</span> path<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="124__3527"></a>12.4 页面测试</h4> 
<p>启动注册中心、监控服务、后台服务，访问<a href="http://localhost:8080" rel="nofollow">http://localhost:8080</a>，登录主页。</p> 
<p>(数据监控如果页面显示拒绝加载，是因为Spring Security默认不允许页面被嵌套，所以X-Frame-Options默认设置为DENY，这个可以在后台WebSecurityConfig配置类通过http.headers().frameOptions().disable();禁用X-Frame-Options设置就可以正常显示了)</p> 
<p><img src="https://images2.imgbox.com/fc/a0/OpscCWHU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4d/da/JHJrhIpN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2a/22/EnpXAmuH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="13__3538"></a>13. 数据备份还原</h3> 
<h4><a id="131__3540"></a>13.1 需求背景</h4> 
<p>在很多时候，我们需要对系统数据进行备份还原。当然，生产线上专业的备份会由专门的工作人员如DBA在数据库服务端直接进行备份还原。我们这里主要通过界面进行少量的数据备份和还原，比如做一个在线演示系统，为了方便恢复被演示用户删除或修改过的演示数据，我们这里就实现了这么一个系统数据备份和还原的功能。通过代码调用MySQL的备份还原命令实现系统备份还原的功能，具体逻辑都是由后台代码实现的。</p> 
<h4><a id="132__3544"></a>13.2 后台接口</h4> 
<p>在前期我们已经准备好了系统备份还原的后台接口，具体可以参考备份还原后台篇。</p> 
<p>备份还原的接口主要有以下几个：</p> 
<ul><li>backup</li><li>delete</li><li>findRecord</li><li>restore</li></ul> 
<h4><a id="133__3555"></a>13.3 备份页面</h4> 
<p>在views目录下新建Backup目录和页面，页面内容主要是一个可以进行备份和还原的对话框组件。</p> 
<ol><li> <p>模板内容</p> <pre><code class="prism language-html">views/Backup/Backup.vue

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--备份还原界面--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>common.backupRestore<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40%<span class="token punctuation">"</span></span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>backupVisible<span class="token punctuation">"</span></span> <span class="token attr-name">:close-on-click-modal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">:modal</span><span class="token attr-value"><span class="token punctuation">=</span>false</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tableData<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>16px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>330px<span class="token punctuation">"</span></span> <span class="token attr-name">:show-header</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>showHeader<span class="token punctuation">"</span></span>
            <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mini<span class="token punctuation">"</span></span> <span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tableLoading<span class="token punctuation">"</span></span> <span class="token attr-name">:element-tableLoading-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.loading<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>common.versionName<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">header-align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">fixed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$t(<span class="token punctuation">'</span>action.operation<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>180<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleRestore(scope.row)<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mini<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('common.restore')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleDelete(scope.row)<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>danger<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope.row.name==<span class="token punctuation">'</span>backup<span class="token punctuation">'</span>?true:false<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mini<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('action.delete')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dialog-footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span>  <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>backupVisible = false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('action.cancel')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small<span class="token punctuation">"</span></span>  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleBackup<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('common.backup')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <p>针对备份查询、备份创建、备份还原和备份删除的方法如下，因为备份还原服务比较简单，这里就没有对axios进行封装了，直接调用axios方法即可。</p> </li><li> <p>备份查询</p> <pre><code class="prism language-js"><span class="token comment">// 查询备份记录</span>
		findRecords<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">true</span>
            axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl <span class="token operator">+</span> <span class="token string">'/backup/findRecords'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                res <span class="token operator">=</span> res<span class="token punctuation">.</span>data
                <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>tableData <span class="token operator">=</span> res<span class="token punctuation">.</span>data
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>message<span class="token punctuation">:</span> <span class="token string">'操作失败, '</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li><li> <p>备份创建</p> <pre><code class="prism language-js"><span class="token comment">// 数据备份</span>
		handleBackup<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">true</span>
            axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl <span class="token operator">+</span> <span class="token string">'/backup/backup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                res <span class="token operator">=</span> res<span class="token punctuation">.</span>data
                <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> <span class="token string">'操作成功'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'success'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>message<span class="token punctuation">:</span> <span class="token string">'操作失败, '</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">false</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li><li> <p>备份还原</p> <pre><code class="prism language-js"><span class="token comment">// 数据还原</span>
		handleRestore<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">true</span>
            axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl <span class="token operator">+</span> <span class="token string">'/backup/restore'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>params <span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>name <span class="token punctuation">:</span> data<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                res <span class="token operator">=</span> res<span class="token punctuation">.</span>data
                <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> <span class="token string">'操作成功'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'success'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'afterRestore'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>message<span class="token punctuation">:</span> <span class="token string">'操作失败, '</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">false</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> </li><li> <p>备份删除</p> <pre><code class="prism language-js"><span class="token comment">// 删除备份</span>
		handleDelete<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">true</span>
            axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl <span class="token operator">+</span> <span class="token string">'/backup/delete'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>params <span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>name <span class="token punctuation">:</span> data<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                res <span class="token operator">=</span> res<span class="token punctuation">.</span>data
                <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> message<span class="token punctuation">:</span> <span class="token string">'操作成功'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'success'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>message<span class="token punctuation">:</span> <span class="token string">'操作失败, '</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>tableLoading <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
</code></pre> </li></ol> 
<h4><a id="134__3663"></a>13.4 页面引用</h4> 
<p>之前在用户面板预留了备份还原的操作入口，在用户面板中引入备份还原组件。</p> 
<p>views/Core/PersonalPanel.vue相关内容如下：</p> 
<p><img src="https://images2.imgbox.com/31/3f/LuIkleRp_o.png" alt="在这里插入图片描述"></p> 
<p>在备份还原操作中添加响应函数，打开备份还原界面。views/Core/PersonalPanel.vue的相关内容如下：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other-operation-item<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>showBackupDialog<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-undo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          {<!-- -->{$t("common.backupRestore")}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
</code></pre> 
<p>响应函数，打开备份还原界面：</p> 
<pre><code class="prism language-js"><span class="token comment">// 打开备份还原界面</span>
    showBackupDialog<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>backupDialog<span class="token punctuation">.</span><span class="token function">setBackupVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>还原操作响应函数，还原成功之后清除用户信息并返回到登录页面：</p> 
<pre><code class="prism language-js"><span class="token comment">// 成功还原之后，重新登录</span>
    afterRestore<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>backupDialog<span class="token punctuation">.</span><span class="token function">setBackupVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="135__3704"></a>13.5 页面测试</h4> 
<p>启动注册中心、监控服务、后台服务、备份服务，访问<a href="http://localhost:8080/#/" rel="nofollow">http://localhost:8080/#/</a>，登录应用进入主页，单击"用户面板→备份还原"，弹出备份还原界面。</p> 
<ol><li> <p>备份查询</p> <p>可以看到初始状态系统会为我们创建一个初始备份，即系统默认备份，且系统默认备份不可删除，防止所有备份被删除时无备份可用。</p> <p><img src="https://images2.imgbox.com/42/64/ypSGTaHR_o.png" alt="在这里插入图片描述"></p> </li><li> <p>备份创建</p> <p>点击"备份"按钮，进行数据备份，系统创建了一个新的备份。备份名称格式为"backup_+时间戳"，对应SQL文件存储目录名称。</p> <p><img src="https://images2.imgbox.com/a2/a4/6Je1Dwd6_o.png" alt="在这里插入图片描述"></p> </li><li> <p>备份删除</p> <p>单击"删除"按钮，备份成功删除。</p> <p><img src="https://images2.imgbox.com/cf/41/SzFQSpHQ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>备份还原</p> <p>接下来我们测试接下来我们测试一下数据还原功能，选择"系统管理→机构管理"，删除轻尘集团和牧尘集团的两棵机构树，只剩下三国集团。</p> <p><img src="https://images2.imgbox.com/4e/ae/E9zXQ4Ag_o.png" alt="在这里插入图片描述"></p> <p>单击"还原"按钮，进行数据还原：</p> <p><img src="https://images2.imgbox.com/bb/2f/wZkDhrp0_o.png" alt="在这里插入图片描述"></p> <p>还原成功之后会回到登录页面，重新登录，查看机构管理，发现数据已经恢复。</p> <p><img src="https://images2.imgbox.com/18/b7/FrCm0VZV_o.png" alt="在这里插入图片描述"></p> </li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e70ad003ec82907b592dfc07ed64ba7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Eclipse 调试 PHP 配置教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f8e4ad2ecef3ec9fb49937fc02b11e1b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Pysyft学习笔记四：MINIST数据集下的联邦学习（并行训练与非并行训练）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>