<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OpenPCDet安装、使用方式及自定义数据集训练 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="OpenPCDet安装、使用方式及自定义数据集训练" />
<meta property="og:description" content="OpenPCDet安装、使用方式及自定义数据集训练 个人博客
OpenPCDet安装 # 先根据自己的cuda版本，安装对应的spconv pip install spconv-cu113 # 下载OpenPCDet并安装 git clone https://github.com/open-mmlab/OpenPCDet.git cd OpenPCDet pip install -r requirements.txt python setup.py develop # 安装open3d（可视化工具）（推荐） pip install open3d # （可选）安装mayavi（可视化工具） pip install vtk pip install mayavi pip install PyQt5 安装完，就可以运行demo.py，测试一下。（需要准备好模型和数据文件）
python demo.py --cfg_file cfgs/kitti_models/pv_rcnn.yaml --ckpt pv_rcnn_8369.pth --data_path ../data/kitti/testing/velodyne/000001.bin 如果出现SharedArray相关的错误的话，可以适当的降低其版本。例如pip install -U SharedArray==3.1
注意，demo.py运行成功需要在具有显示设备的条件下，如果只有终端的话是无法运行成功的。
KITTI数据集训练 首先需要准备KITTI数据集，为了快速训练演示，选取100个数据进行训练。将数据集按照以下目录格式存放。
OpenPCDet ├── data │ ├── kitti │ │ │── ImageSets │ │ │── training │ │ │ ├──calib &amp; velodyne &amp; label_2 &amp; image_2 &amp; (optional: planes) &amp; (optional: depth_2) │ │ │── testing │ │ │ ├──calib &amp; velodyne &amp; image_2 ├── pcdet ├── tools ImageSets中存在train." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/38124c7261ef1006929746a6f1038477/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-09T17:29:46+08:00" />
<meta property="article:modified_time" content="2023-06-09T17:29:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OpenPCDet安装、使用方式及自定义数据集训练</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="OpenPCDet_0"></a>OpenPCDet安装、使用方式及自定义数据集训练</h2> 
<p><a href="https://lightningleader.github.io/posts/26.html" rel="nofollow">个人博客</a></p> 
<h3><a id="OpenPCDet_4"></a>OpenPCDet安装</h3> 
<pre><code class="prism language-python"><span class="token comment"># 先根据自己的cuda版本，安装对应的spconv</span>
pip install spconv<span class="token operator">-</span>cu113

<span class="token comment"># 下载OpenPCDet并安装</span>
git clone https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token builtin">open</span><span class="token operator">-</span>mmlab<span class="token operator">/</span>OpenPCDet<span class="token punctuation">.</span>git
cd OpenPCDet
pip install <span class="token operator">-</span>r requirements<span class="token punctuation">.</span>txt 
python setup<span class="token punctuation">.</span>py develop

<span class="token comment"># 安装open3d（可视化工具）（推荐）</span>
pip install open3d

<span class="token comment"># （可选）安装mayavi（可视化工具）</span>
pip install vtk
pip install mayavi
pip install PyQt5
</code></pre> 
<p>安装完，就可以运行<strong>demo.py</strong>，测试一下。（需要准备好模型和数据文件）</p> 
<pre><code class="prism language-python">python demo<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>cfg_file cfgs<span class="token operator">/</span>kitti_models<span class="token operator">/</span>pv_rcnn<span class="token punctuation">.</span>yaml <span class="token operator">-</span><span class="token operator">-</span>ckpt pv_rcnn_8369<span class="token punctuation">.</span>pth <span class="token operator">-</span><span class="token operator">-</span>data_path <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>kitti<span class="token operator">/</span>testing<span class="token operator">/</span>velodyne<span class="token operator">/</span><span class="token number">000001.</span><span class="token builtin">bin</span>
</code></pre> 
<p>如果出现<strong>SharedArray</strong>相关的错误的话，可以适当的降低其版本。例如<code>pip install -U SharedArray==3.1</code></p> 
<p>注意，<strong>demo.py</strong>运行成功需要在具有显示设备的条件下，如果只有终端的话是无法运行成功的。</p> 
<h3><a id="KITTI_35"></a>KITTI数据集训练</h3> 
<p>首先需要准备KITTI数据集，为了快速训练演示，选取100个数据进行训练。将数据集按照以下目录格式存放。</p> 
<pre><code class="prism language-python">OpenPCDet
├── data
│   ├── kitti
│   │   │── ImageSets
│   │   │── training
│   │   │   ├──calib <span class="token operator">&amp;</span> velodyne <span class="token operator">&amp;</span> label_2 <span class="token operator">&amp;</span> image_2 <span class="token operator">&amp;</span> <span class="token punctuation">(</span>optional<span class="token punctuation">:</span> planes<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>optional<span class="token punctuation">:</span> depth_2<span class="token punctuation">)</span>
│   │   │── testing
│   │   │   ├──calib <span class="token operator">&amp;</span> velodyne <span class="token operator">&amp;</span> image_2
├── pcdet
├── tools
</code></pre> 
<p><strong>ImageSets</strong>中存在<strong>train.txt val.txt test.txt</strong>文本，其内容为训练、验证和测试使用的数据。</p> 
<p>运行下面的代码以生成infos，生成的文件可在<strong>data/kitti</strong>找到。</p> 
<pre><code class="prism language-python">python <span class="token operator">-</span>m pcdet<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>kitti<span class="token punctuation">.</span>kitti_dataset create_kitti_infos tools<span class="token operator">/</span>cfgs<span class="token operator">/</span>dataset_configs<span class="token operator">/</span>kitti_dataset<span class="token punctuation">.</span>yaml
</code></pre> 
<p>openPCDet的可训练网络配置（KITTI数据集）存放在<strong>cfgs/kitti_models</strong>目录下。以<strong>pv_rcnn</strong>训练为例，由于本次没有使用planes数据，将pv_rcnn.yaml中的<strong>USE_ROAD_PLANE</strong>改成False。之后在tools目录下运行下面代码即可进行训练。</p> 
<pre><code class="prism language-python">python train<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>cfg_file cfgs<span class="token operator">/</span>kitti_models<span class="token operator">/</span>pv_rcnn<span class="token punctuation">.</span>yaml <span class="token operator">-</span><span class="token operator">-</span>batch_size <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>workers <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>epochs <span class="token number">10</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/47/LXVt5MgR_o.png" alt="在这里插入图片描述"></p> 
<p>训练结束后可以在<strong>output/kitti_models</strong>目录中找到模型文件。</p> 
<h3><a id="trainpyKITTI_71"></a>训练注意事项—train.py（以KITTI数据集为例）</h3> 
<ol><li> <p>如果不指定具体的ckpt，<strong>train.py</strong>中会默认加载最新的ckpt。换句话说，如果上一次训练pv_rcnn网络的epochs为5，得到了5个ckpt，下一次训练pv_rcnn的时候没有指定ckpt且epochs值小于等于5，那么就不会进入训练而是直接进入eval。如果本次epochs为大于5的值，则会接着epochs=5的ckpt训练。</p> <pre><code class="prism language-python"><span class="token comment"># trian.py中的相关代码</span>
<span class="token comment"># 如果ckpt不为None的话，就加载该ckpt，并从指定ckpt的epoch开始训练</span>
<span class="token keyword">if</span> args<span class="token punctuation">.</span>ckpt <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    it<span class="token punctuation">,</span> start_epoch <span class="token operator">=</span> model<span class="token punctuation">.</span>load_params_with_optimizer<span class="token punctuation">(</span>args<span class="token punctuation">.</span>ckpt<span class="token punctuation">,</span> to_cpu<span class="token operator">=</span>dist_train<span class="token punctuation">,</span> optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span> logger<span class="token operator">=</span>logger<span class="token punctuation">)</span>
    last_epoch <span class="token operator">=</span> start_epoch <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token comment"># 如果为None的话，会默认加载最新的ckpt</span>
    ckpt_list <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ckpt_dir <span class="token operator">/</span> <span class="token string">'*.pth'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ckpt_list<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment"># 按时间进行排序</span>
        ckpt_list<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getmtime<span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ckpt_list<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                it<span class="token punctuation">,</span> start_epoch <span class="token operator">=</span> model<span class="token punctuation">.</span>load_params_with_optimizer<span class="token punctuation">(</span>
                    ckpt_list<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to_cpu<span class="token operator">=</span>dist_train<span class="token punctuation">,</span> optimizer<span class="token operator">=</span>optimizer<span class="token punctuation">,</span> logger<span class="token operator">=</span>logger
                <span class="token punctuation">)</span>
                last_epoch <span class="token operator">=</span> start_epoch <span class="token operator">+</span> <span class="token number">1</span>
                <span class="token keyword">break</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                ckpt_list <span class="token operator">=</span> ckpt_list<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> </li><li> <p><strong>max_ckpt_save_num</strong>参数代表最大保存ckpt的数量。如果当前ckpt的数量多于最大保存ckpt数量，那么会删除几个时间最早的ckpt。默认为30.</p> <pre><code class="prism language-python"><span class="token comment"># train_utils.py中的相关代码</span>
ckpt_list <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ckpt_save_dir <span class="token operator">/</span> <span class="token string">'checkpoint_epoch_*.pth'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ckpt_list<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getmtime<span class="token punctuation">)</span>

<span class="token comment"># 如果当前ckpt的数量多于最大保存ckpt数量，那么会删除几个时间最早的ckpt</span>
<span class="token keyword">if</span> ckpt_list<span class="token punctuation">.</span>__len__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> max_ckpt_save_num<span class="token punctuation">:</span>
    <span class="token keyword">for</span> cur_file_idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ckpt_list<span class="token punctuation">)</span> <span class="token operator">-</span> max_ckpt_save_num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>ckpt_list<span class="token punctuation">[</span>cur_file_idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><strong>ckpt_save_time_interval</strong>参数代表每隔{ckpt_save_time_interval}秒保存一次ckpt。默认为300</p> </li><li> <p>train.py中的eval使用的数据集是kitti_dataset.yaml中的test值。默认配置下，kitti_dataset.yaml中test值为val，如下面代码所示：</p> <pre><code class="prism language-python"><span class="token comment"># kitti_dataset.yaml</span>
<span class="token triple-quoted-string string">"""
总得来说，在训练的时候'train'和'test'分别对应训练集和验证集；在测试的时候'test'对应测试集。
所以需要根据训练和测试任务更换test的配置。
"""</span>

<span class="token comment"># 需要加载的文件名称，默认为train.txt val.txt</span>
DATA_SPLIT<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'train'</span><span class="token punctuation">:</span> train<span class="token punctuation">,</span>
    <span class="token string">'test'</span><span class="token punctuation">:</span> val
<span class="token punctuation">}</span>

<span class="token comment"># 需要加载的pkl文件 可以设置多个</span>
INFO_PATH<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'train'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>kitti_infos_train<span class="token punctuation">.</span>pkl<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'test'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>kitti_infos_val<span class="token punctuation">.</span>pkl<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol> 
<p>如果想要修改val数据集，就需要修改<strong>DATA_SPLIT</strong>和<strong>INFO_PATH</strong>中的test值。</p> 
<ol start="5"><li> <p><strong>num_epochs_to_eval</strong>参数代表只评估最后{num_epochs_to_eval}个epoch。比如当num_epochs_to_eval为1的时候，总epochs为5，那么只会评估后面4个epoch。默认为0，也就是每个epoch都评估。</p> </li><li> <p><em>build_dataloader</em>函数中</p> <pre><code class="prism language-python"><span class="token comment"># 使用变量 dataset_cfg.DATASET 中指定的数据集类型，创建一个数据集对象 dataset</span>
<span class="token comment"># 如果dataset_cfg.DATASET为KittiDataset，那么返回的dataset为kitti_dataset.py中的KittiDataset类型</span>
dataset <span class="token operator">=</span> __all__<span class="token punctuation">[</span>dataset_cfg<span class="token punctuation">.</span>DATASET<span class="token punctuation">]</span><span class="token punctuation">(</span>
    dataset_cfg<span class="token operator">=</span>dataset_cfg<span class="token punctuation">,</span>
    class_names<span class="token operator">=</span>class_names<span class="token punctuation">,</span>
    root_path<span class="token operator">=</span>root_path<span class="token punctuation">,</span>
    training<span class="token operator">=</span>training<span class="token punctuation">,</span>
    logger<span class="token operator">=</span>logger<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> </li><li> <p><em>cfg_from_yaml_file</em>函数将网络yaml和数据集yaml合并在一起，如果存在相同的key，则用网络yaml相应的val替换。因此如果网络yaml和数据集yaml中存在相同类型的配置，比如数据增强，那么最终训练使用的配置是网络yaml中的配置。实现这部分的相关代码可以在<strong>config.py</strong>中找到。</p> </li></ol> 
<h3><a id="testpyKITTI_156"></a>测试注意事项—test.py（以KITTI数据集为例）</h3> 
<ol><li> <p>运行<strong>test.py</strong>使用的测试数据集可以在<strong>kitti_dataset.yaml</strong>中的<strong>DATA_SPLIT</strong>和<strong>INFO_PATH</strong>找到相关配置。其中，它加载的测试数据集是<strong>INFO_PATH</strong>中的test值，这个值是一个列表，里面可以填多个.pkl文件，这部分的加载代码可以在<strong>kitti_dataset.py</strong>的<strong>include_kitti_data</strong>函数中找到；<strong>DATA_SPLIT</strong>中的test值默认为val，表示加载val.txt。</p> <p>所以说如果想要修改测试数据集就需要修改<strong>DATA_SPLIT</strong>和<strong>INFO_PATH</strong>中的test值。</p> <pre><code class="prism language-python"><span class="token comment"># kitti_dataset.yaml</span>
<span class="token triple-quoted-string string">"""
总得来说，在训练的时候'train'和'test'分别对应训练集和验证集；在测试的时候'test'对应测试集。
所以需要根据训练和测试任务更换test的配置。
"""</span>
<span class="token comment"># 需要加载的文件名称，默认为train.txt val.txt</span>
DATA_SPLIT<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'train'</span><span class="token punctuation">:</span> train<span class="token punctuation">,</span>
    <span class="token string">'test'</span><span class="token punctuation">:</span> val
<span class="token punctuation">}</span>

<span class="token comment"># 需要加载的pkl文件 可以设置多个</span>
INFO_PATH<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'train'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>kitti_infos_train<span class="token punctuation">.</span>pkl<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'test'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>kitti_infos_val<span class="token punctuation">.</span>pkl<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol> 
<h3><a id="demopyopen3d_vis_utilspyKITTI_181"></a>demo.py和open3d_vis_utils.py分析（以KITTI数据集为例）</h3> 
<ol><li> <p>使用Demo.py时，如果传入数据集参数时文件夹，则会获取文件夹所有符合后缀条件（.bin/.npy）的文件。</p> </li><li> <p>模型预测结果pred_dicts是一个列表，列表元素为字典，字典包含’pred_boxes’, ‘pred_scores’, 'pred_labels’三个键。</p> </li><li> <p>在open3d_vis_utils.py开头加入下面代码，目的是方式警告。不知道是什么原因，使用的时候一直会报颜色设置错误的警告。</p> <pre><code class="prism language-python"><span class="token comment"># 关闭警告</span>
open3d<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>set_verbosity_level<span class="token punctuation">(</span>open3d<span class="token punctuation">.</span>utility<span class="token punctuation">.</span>VerbosityLevel<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</code></pre> </li><li> <p>在<em>draw_box</em>函数中可以得到box3d，它是OrientedBoundingBox类型，所以可以通过<em>get_box_points</em>、<em>get_center</em>等函数获得相应的点坐标。</p> </li><li> <p>可以在<em>draw_box</em>函数中加入下面代码，功能是给方框标记中心点，中心点的颜色与方框相同。</p> <pre><code class="prism language-python"><span class="token comment"># 给方框标记中心点</span>
<span class="token keyword">if</span> center<span class="token punctuation">:</span>
    sphere_center <span class="token operator">=</span> open3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>TriangleMesh<span class="token punctuation">.</span>create_sphere<span class="token punctuation">(</span>radius<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    sphere_center<span class="token punctuation">.</span>paint_uniform_color<span class="token punctuation">(</span>box_colormap<span class="token punctuation">[</span>ref_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sphere_center<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>box3d<span class="token punctuation">.</span>get_center<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    vis<span class="token punctuation">.</span>add_geometry<span class="token punctuation">(</span>sphere_center<span class="token punctuation">)</span>
</code></pre> </li><li> <p>可以在open3d_vis_utils.py中添加下面的代码用于绘制<strong>POINT_CLOUD_RANGE</strong>。如图所示，红色框为点云边界框。</p> <pre><code class="prism language-python"><span class="token comment"># 根据最大边界点和最小边界点画出方框---在这里是用于画POINT_CLOUD_RANGE的，该参数配置于voxset.yaml</span>
min_bound <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">39.68</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
max_bound <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">69.12</span><span class="token punctuation">,</span> <span class="token number">39.68</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
bbox <span class="token operator">=</span> open3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>AxisAlignedBoundingBox<span class="token punctuation">(</span>min_bound<span class="token punctuation">,</span> max_bound<span class="token punctuation">)</span>
bbox_lines <span class="token operator">=</span> open3d<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>LineSet<span class="token punctuation">.</span>create_from_axis_aligned_bounding_box<span class="token punctuation">(</span>bbox<span class="token punctuation">)</span>
bbox_lines<span class="token punctuation">.</span>paint_uniform_color<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
vis<span class="token punctuation">.</span>add_geometry<span class="token punctuation">(</span>bbox_lines<span class="token punctuation">)</span>
</code></pre> </li></ol> 
<p><img src="https://images2.imgbox.com/77/e1/JYurKCdr_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_222"></a>使用自定义数据集进行训练</h3> 
<p><a href="https://github.com/open-mmlab/OpenPCDet/blob/master/docs/CUSTOM_DATASET_TUTORIAL.md">官方教程</a></p> 
<h4><a id="_226"></a>准备数据集</h4> 
<p>首先需要按照官方教程创建文件目录，如下所示。</p> 
<pre><code>OpenPCDet
├── data
│   ├── custom
│   │   │── ImageSets
│   │   │   │── train.txt
│   │   │   │── val.txt
│   │   │── points
│   │   │   │── 000000.npy
│   │   │   │── 999999.npy
│   │   │── labels
│   │   │   │── 000000.txt
│   │   │   │── 999999.txt
├── pcdet
├── tools
</code></pre> 
<p>使用SUSTechPOINTS标注完后会得到json格式的标签文件，我们需要提取有用的内容再保存成txt格式。</p> 
<p>OpenPCDet支持的自定义label文件格式如下所示</p> 
<pre><code># format: [x y z dx dy dz heading_angle category_name]
1.50 1.46 0.10 5.12 1.85 4.13 1.56 Vehicle
5.54 0.57 0.41 1.08 0.74 1.95 1.57 Pedestrian
</code></pre> 
<p>其中最后一个heading_angle，就是json标签文件中的rotation的z值。不过这个地方需要确保自己点云坐标系（激光雷达坐标系）与OpenPCDet中规定的坐标系是一致的，不然还需要转换成OpenPCDet坐标系。</p> 
<p><img src="https://images2.imgbox.com/df/83/l3d4cSd0_o.png" alt="在这里插入图片描述"></p> 
<p>可以使用下面这个函数实现将json格式的标签文件转换成符合OpenPCDet训练的标签文件。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">json_to_txt</span><span class="token punctuation">(</span>json_path<span class="token punctuation">,</span> txt_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    将json文件转化成符合OpenPCDet训练的标签文件
    	json_path: json文件所在目录
    	txt_path： 生成txt文件目录
    """</span>
    json_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>json_path<span class="token punctuation">)</span>
    <span class="token keyword">for</span> json_name <span class="token keyword">in</span> json_list<span class="token punctuation">:</span>
        json_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>json_path<span class="token punctuation">,</span> json_name<span class="token punctuation">)</span>
        
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>json_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        label_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> obj_dict <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            label_name <span class="token operator">=</span> obj_dict<span class="token punctuation">[</span><span class="token string">"obj_type"</span><span class="token punctuation">]</span>
            pos_xyz <span class="token operator">=</span> obj_dict<span class="token punctuation">[</span><span class="token string">"psr"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"position"</span><span class="token punctuation">]</span>
            rot_xyz <span class="token operator">=</span> obj_dict<span class="token punctuation">[</span><span class="token string">"psr"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"rotation"</span><span class="token punctuation">]</span>
            scale_xyz <span class="token operator">=</span> obj_dict<span class="token punctuation">[</span><span class="token string">"psr"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"scale"</span><span class="token punctuation">]</span>
            
            temp <span class="token operator">=</span> <span class="token string">""</span>
            <span class="token keyword">for</span> xyz_dict <span class="token keyword">in</span> <span class="token punctuation">[</span>pos_xyz<span class="token punctuation">,</span> scale_xyz<span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> key <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"z"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    temp <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>xyz_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    temp <span class="token operator">+=</span> <span class="token string">" "</span>
            temp <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>rot_xyz<span class="token punctuation">[</span><span class="token string">"z"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>label_name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span>
            label_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>

        txt_name <span class="token operator">=</span> json_name<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">".txt"</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>txt_path<span class="token punctuation">,</span> txt_name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            <span class="token keyword">for</span> label <span class="token keyword">in</span> label_list<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>label<span class="token punctuation">)</span>
</code></pre> 
<p>除了需要转换标签文件，还需要将pcd格式的点云转换成npy格式。可以使用下面的函数实现。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">pcd_to_npy</span><span class="token punctuation">(</span>pcd_path<span class="token punctuation">,</span> npy_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
        将pcd文件转换成npy文件
        pcd_path: pcd格式点云目录
        npy_path: npy格式点云输出目录
    """</span>
    pcd_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>pcd_path<span class="token punctuation">)</span>
    <span class="token keyword">for</span> pcd_name <span class="token keyword">in</span> pcd_list<span class="token punctuation">:</span>
        pcd_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>pcd_path<span class="token punctuation">,</span> pcd_name<span class="token punctuation">)</span>
        lidar <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        pcd <span class="token operator">=</span> o3d<span class="token punctuation">.</span>io<span class="token punctuation">.</span>read_point_cloud<span class="token punctuation">(</span>pcd_file<span class="token punctuation">)</span>
        points <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>pcd<span class="token punctuation">.</span>points<span class="token punctuation">)</span>

        <span class="token keyword">for</span> linestr <span class="token keyword">in</span> points<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>linestr<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>  <span class="token comment"># only x,y,z</span>
                linestr_convert <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> linestr<span class="token punctuation">)</span><span class="token punctuation">)</span>
                linestr_convert<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                lidar<span class="token punctuation">.</span>append<span class="token punctuation">(</span>linestr_convert<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>linestr<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>  <span class="token comment"># x,y,z,i</span>
                linestr_convert <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> linestr<span class="token punctuation">)</span><span class="token punctuation">)</span>

        lidar <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>lidar<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
        np<span class="token punctuation">.</span>save<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>npy_path<span class="token punctuation">,</span> pcd_name<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">".npy"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lidar<span class="token punctuation">)</span>
</code></pre> 
<p>可以使用下面的函数快速生成train.txt和val.txt</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_train_val_txt</span><span class="token punctuation">(</span>src_path<span class="token punctuation">,</span> dst_path<span class="token punctuation">,</span> num_of_train<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    	src_path: 标签文件目录
    	dst_path: 输出文件目录
    	num_of_train: 训练集样本数量
    """</span>
    src_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>src_path<span class="token punctuation">)</span>
    random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>src_list<span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dst_path<span class="token punctuation">,</span> <span class="token string">"train.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_of_train<span class="token punctuation">)</span><span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>src_list<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dst_path<span class="token punctuation">,</span> <span class="token string">"val.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_of_train<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>src_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>src_list<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
</code></pre> 
<p>将npy点云、txt标签、train.txt和val.txt放到指定目录下。修改<strong>custom_dataset.py</strong>，需要根据自己数据集修改分类类别。</p> 
<p><img src="https://images2.imgbox.com/f2/1f/bdaYjwKu_o.png" alt="在这里插入图片描述"></p> 
<p>修改<strong>custom_dataset.yaml</strong>。主要关注以下内容：</p> 
<pre><code class="prism language-yaml"><span class="token comment"># 与KITTI数据集映射   左边是自己数据集   右边是KITTI数据集</span>
<span class="token comment"># 这个地方只会在eval阶段会用到，所以如果自己不需要eval的话可以不加</span>
<span class="token key atrule">MAP_CLASS_TO_KITTI</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment"># 'Vehicle': 'Car'</span>
    <span class="token key atrule">'Pedestrian'</span><span class="token punctuation">:</span> <span class="token string">'Pedestrian'</span><span class="token punctuation">,</span>
    <span class="token key atrule">'BicycleRider'</span><span class="token punctuation">:</span> <span class="token string">'Cyclist'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-yaml"><span class="token comment"># 需要与自己的点云数据格式对应，一般不需要改</span>
<span class="token key atrule">POINT_FEATURE_ENCODING</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token key atrule">encoding_type</span><span class="token punctuation">:</span> absolute_coordinates_encoding<span class="token punctuation">,</span>
    <span class="token key atrule">used_feature_list</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token string">'intensity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token key atrule">src_feature_list</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token string">'intensity'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-yaml"><span class="token key atrule">DATA_AUGMENTOR</span><span class="token punctuation">:</span>
    <span class="token key atrule">DISABLE_AUG_LIST</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'placeholder'</span><span class="token punctuation">]</span>
    <span class="token key atrule">AUG_CONFIG_LIST</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">NAME</span><span class="token punctuation">:</span> gt_sampling
          <span class="token key atrule">USE_ROAD_PLANE</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>
          <span class="token key atrule">DB_INFO_PATH</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> custom_dbinfos_train.pkl
          <span class="token key atrule">PREPARE</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
          	<span class="token comment"># 需要改成自己的数据集类别</span>
            <span class="token key atrule">filter_by_min_points</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Pedestrian:5'</span><span class="token punctuation">,</span> <span class="token string">'BicycleRider:5'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment"># filter_by_difficulty: [-1], # 这个地方如果不注释的话训练可能会报错，可以自己尝试一下</span>
          <span class="token punctuation">}</span>
		  <span class="token comment"># 需要改成自己的数据集类别</span>
          <span class="token key atrule">SAMPLE_GROUPS</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Pedestrian<span class="token punctuation">:</span>15'<span class="token punctuation">,</span> <span class="token string">'BicycleRider:15'</span><span class="token punctuation">]</span>
          <span class="token key atrule">NUM_POINT_FEATURES</span><span class="token punctuation">:</span> <span class="token number">4</span>
          <span class="token key atrule">DATABASE_WITH_FAKELIDAR</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>
          <span class="token key atrule">REMOVE_EXTRA_WIDTH</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
          <span class="token key atrule">LIMIT_WHOLE_SCENE</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
</code></pre> 
<p>最后在命令行运行下面命令。如果不报错的话就可以得到训练数据集了。</p> 
<pre><code>python -m pcdet.datasets.custom.custom_dataset create_custom_infos tools/cfgs/dataset_configs/custom_dataset.yaml
</code></pre> 
<h4><a id="yaml_401"></a>修改网络yaml配置文件</h4> 
<pre><code class="prism language-yaml"><span class="token comment"># 要改成自己的类别</span>
<span class="token key atrule">CLASS_NAMES</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Pedestrian'</span><span class="token punctuation">,</span> <span class="token string">'BicycleRider'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-yaml"><span class="token comment"># 需要修改成custom_dataset.yaml</span>
<span class="token key atrule">_BASE_CONFIG_</span><span class="token punctuation">:</span> cfgs/dataset_configs/custom_dataset.yaml
<span class="token comment"># 点云范围 [x_min, y_min, z_min, x_max, y_max, z_max]</span>
<span class="token comment"># 需要和VOXEL_SIZE满足倍数关系。X和Y轴与体素需要满足16倍的关系。详细配置可以看官方教程。</span>
<span class="token key atrule">POINT_CLOUD_RANGE</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">-15.36</span><span class="token punctuation">,</span> <span class="token number">-2</span><span class="token punctuation">,</span> <span class="token number">15.36</span><span class="token punctuation">,</span> <span class="token number">15.36</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-yaml"><span class="token comment"># 按照自己数据集修改</span>
<span class="token key atrule">DATA_AUGMENTOR</span><span class="token punctuation">:</span>
    <span class="token key atrule">DISABLE_AUG_LIST</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'placeholder'</span><span class="token punctuation">]</span>
    <span class="token key atrule">AUG_CONFIG_LIST</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">NAME</span><span class="token punctuation">:</span> gt_sampling
        <span class="token comment"># 该数据增强方法起源于SECOND网络，作者将其他帧ground truth矩形框内的点云抽取出来放在当前帧的空余位置，</span>
        <span class="token comment"># 以此来形成“新”一帧的训练数据，达到数据增强的目的。</span>
          <span class="token key atrule">USE_ROAD_PLANE</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>
          <span class="token key atrule">DB_INFO_PATH</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> custom_dbinfos_train.pkl
          <span class="token key atrule">PREPARE</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment"># 保留至少5个点的车辆、行人和骑行者</span>
            <span class="token key atrule">filter_by_min_points</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Pedestrian:5'</span><span class="token punctuation">,</span> <span class="token string">'BicycleRider:5'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment"># filter_by_difficulty: [-1],</span>
          <span class="token punctuation">}</span>
            <span class="token comment"># 指定需要采样的物体类别和数量</span>
          <span class="token key atrule">SAMPLE_GROUPS</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Pedestrian:15'</span><span class="token punctuation">,</span> <span class="token string">'BicycleRider:15'</span><span class="token punctuation">]</span>
          <span class="token key atrule">NUM_POINT_FEATURES</span><span class="token punctuation">:</span> <span class="token number">4</span>
          <span class="token key atrule">DATABASE_WITH_FAKELIDAR</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>
          <span class="token key atrule">REMOVE_EXTRA_WIDTH</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
          <span class="token key atrule">LIMIT_WHOLE_SCENE</span><span class="token punctuation">:</span> <span class="token boolean important">False</span>
</code></pre> 
<pre><code class="prism language-yaml"><span class="token comment"># anchor配置，需要适配自己的数据集</span>
<span class="token key atrule">ANCHOR_GENERATOR_CONFIG</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token key atrule">'class_name'</span><span class="token punctuation">:</span> <span class="token string">'Pedestrian'</span><span class="token punctuation">,</span>
        <span class="token comment"># 尺寸 长宽高 单位为米</span>
        <span class="token key atrule">'anchor_sizes'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.66</span><span class="token punctuation">,</span> <span class="token number">1.73</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token key atrule">'anchor_rotations'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.57</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 旋转角度 0°和90°(弧度π/2=1.57）表示anchor可以沿水平和垂直方向旋转</span>
        <span class="token key atrule">'anchor_bottom_heights'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">-0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># 底部高度，离地面的高度</span>
        <span class="token key atrule">'align_center'</span><span class="token punctuation">:</span> <span class="token boolean important">False</span><span class="token punctuation">,</span>    <span class="token comment"># 居中对齐</span>
        <span class="token key atrule">'feature_map_stride'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token comment"># 特征图步幅</span>
        <span class="token key atrule">'matched_threshold'</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>    <span class="token comment"># 匹配阈值    高于这个阈值的被认为是正样本</span>
        <span class="token key atrule">'unmatched_threshold'</span><span class="token punctuation">:</span> <span class="token number">0.35</span>    <span class="token comment"># 不匹配阈值    低于这个阈值的被认为是负样本</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token key atrule">'class_name'</span><span class="token punctuation">:</span> <span class="token string">'BicycleRider'</span><span class="token punctuation">,</span>
        <span class="token key atrule">'anchor_sizes'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.83</span><span class="token punctuation">,</span> <span class="token number">0.74</span><span class="token punctuation">,</span> <span class="token number">1.64</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token key atrule">'anchor_rotations'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.57</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token key atrule">'anchor_bottom_heights'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">-0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token key atrule">'align_center'</span><span class="token punctuation">:</span> <span class="token boolean important">False</span><span class="token punctuation">,</span>
        <span class="token key atrule">'feature_map_stride'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token key atrule">'matched_threshold'</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
        <span class="token key atrule">'unmatched_threshold'</span><span class="token punctuation">:</span> <span class="token number">0.35</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> 
<p>可以使用下面的代码获取自己类别的平均anchor</p> 
<pre><code class="prism language-python"><span class="token comment"># 获取每个类别的评价lwh，以此来设置anchor</span>

<span class="token keyword">import</span> os

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    label_path <span class="token operator">=</span> <span class="token string">"data/custom/labels"</span>
    label_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>label_path<span class="token punctuation">)</span>
    <span class="token comment"># l w h</span>
    P_counts <span class="token operator">=</span> <span class="token number">0</span>
    Pedestrian <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
    B_counts <span class="token operator">=</span> <span class="token number">0</span>
    BicycleRider <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> label_name <span class="token keyword">in</span> label_list<span class="token punctuation">:</span>
        label_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>label_path<span class="token punctuation">,</span> label_name<span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>label_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            data <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> line <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                temp_list <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>
                cls_name <span class="token operator">=</span> temp_list<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> cls_name <span class="token operator">==</span> <span class="token string">"Pedestrian"</span><span class="token punctuation">:</span>
                    Pedestrian<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    Pedestrian<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    Pedestrian<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    P_counts <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    BicycleRider<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    BicycleRider<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    BicycleRider<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>temp_list<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    B_counts <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"P l</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>Pedestrian<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>P_counts<span class="token punctuation">}</span></span><span class="token string"> w</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>Pedestrian<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>P_counts<span class="token punctuation">}</span></span><span class="token string"> h</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>Pedestrian<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">/</span>P_counts<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"B l</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>BicycleRider<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>B_counts<span class="token punctuation">}</span></span><span class="token string"> w</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>BicycleRider<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>B_counts<span class="token punctuation">}</span></span><span class="token string"> h</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>BicycleRider<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">/</span>B_counts<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre> 
<p>按照上述要求修改完就可以训练了。</p> 
<p>最后分享一下我自己拍摄标注的数据集：<a href="https://wwxy.lanzouj.com/ihG600yp8kve" rel="nofollow">点我下载</a></p> 
<p>这个数据集是以树为目标的，已经处理成自定义数据集的格式了，可以直接使用。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/84bb05cf2f845bc66ebcbb4d82a4f0ab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">EasyExcel复杂报表导出</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/18b6f5a6298700046bcf1ee3cd22be25/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CSP-S大纲</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>