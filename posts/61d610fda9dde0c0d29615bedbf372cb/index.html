<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>fly.js使用 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="fly.js使用" />
<meta property="og:description" content="原文地址：http://www.voidcc.com/project/fly 项目信息 Fly.js 是一个基于 promise 的，轻量且强大的Javascript http 网络库 51 1,686 221 0 2018-09-06
开发语言: JavaScript 开源协议: MIT
项目代码: Github - fly
项目作者: wendux 作者主页: Github - wendux
项目描述 English|中文简体
正在上传…重新上传取消
转存失败重新上传取消 Fly.js 一个支持所有JavaScript运行环境的基于Promise的、支持请求转发、强大的http请求库。可以让您在多个端上尽可能大限度的实现代码复用。
浏览器支持 转存失败重新上传取消转存失败重新上传取消转存失败重新上传取消转存失败重新上传取消转存失败重新上传取消转存失败重新上传取消✔✔✔✔✔&gt; 8 其它支持的平台 正在上传…重新上传取消 目前Fly.js支持的平台包括：Node.js 、微信小程序 、Weex 、React Native 、Quick App 和浏览器，这些平台的 JavaScript 运行时都是不同的。更多的平台正在持续添加中，请保持关注。
简介 Fly.js 是一个基于 promise 的，轻量且强大的Javascript http 网络库，它有如下特点：
提供统一的 Promise API。浏览器环境下，轻量且非常轻量 。支持多种JavaScript 运行环境支持请求／响应拦截器。自动转换 JSON 数据。支持切换底层 Http Engine，可轻松适配各种运行环境。浏览器端支持全局Ajax拦截 。H5页面内嵌到原生 APP 中时，支持将 http 请求转发到 Native。支持直接请求图片。 定位与目标 Fly 的定位是成为 Javascript http请求的终极解决方案。也就是说，在任何能够执行 Javascript 的环境，只要具有访问网络的能力，Fly都能运行在其上，提供统一的API。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/61d610fda9dde0c0d29615bedbf372cb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-13T09:34:32+08:00" />
<meta property="article:modified_time" content="2022-09-13T09:34:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">fly.js使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>原文地址：<a href="http://www.voidcc.com/project/fly" rel="nofollow" title="http://www.voidcc.com/project/fly">http://www.voidcc.com/project/fly</a></h3> 
<h3>项目信息</h3> 
<p></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/06/5d/K0hALnso_o.png"></p> 
<h2>Fly.js 是一个基于 promise 的，轻量且强大的Javascript http 网络库 </h2> 
<p>51 1,686 221 0 2018-09-06</p> 
<p>开发语言: JavaScript 开源协议: MIT</p> 
<p>项目代码: Github - fly</p> 
<p>项目作者: wendux 作者主页: Github - wendux</p> 
<h3>项目描述</h3> 
<p>English|中文简体</p> 
<p>正在上传…重新上传取消</p> 
<p>转存失败重新上传取消    </p> 
<h3 id="articleHeader0">Fly.js</h3> 
<p>一个支持所有JavaScript运行环境的基于Promise的、支持请求转发、强大的http请求库。可以让您在多个端上尽可能大限度的实现代码复用。</p> 
<h4 id="articleHeader1">浏览器支持</h4> 
<table><thead><tr><th>转存失败重新上传取消</th><th>转存失败重新上传取消</th><th>转存失败重新上传取消</th><th>转存失败重新上传取消</th><th>转存失败重新上传取消</th><th>转存失败重新上传取消</th></tr></thead><tbody><tr><td>✔</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td><td>&gt; 8</td></tr></tbody></table> 
<h4 id="articleHeader2">其它支持的平台</h4> 
<table><tbody><tr><td style="vertical-align:middle;"> <p class="img-center"><img alt="" src="https://images2.imgbox.com/87/59/n58Zy8WG_o.png"></p> </td><td style="vertical-align:middle;"> <p class="img-center"><img alt="" src="https://images2.imgbox.com/92/30/gHpXC40l_o.png"></p> </td><td style="vertical-align:middle;"> <p class="img-center"><img alt="" src="https://images2.imgbox.com/f7/33/lXclSF3t_o.png"></p> </td><td style="vertical-align:middle;"> <p class="img-center"><img alt="" src="https://images2.imgbox.com/33/3f/mh9kZCgW_o.gif"></p> 正在上传…重新上传取消</td><td style="vertical-align:middle;"> <p class="img-center"><img alt="" src="https://images2.imgbox.com/be/cc/bAN6fEU4_o.png"></p> </td></tr></tbody></table> 
<p>目前Fly.js支持的平台包括：Node.js 、微信小程序 、Weex 、React Native 、Quick App 和浏览器，这些平台的 JavaScript 运行时都是不同的。更多的平台正在持续添加中，请保持关注。</p> 
<h3 id="articleHeader3">简介</h3> 
<p>Fly.js 是一个基于 promise 的，轻量且强大的Javascript http 网络库，它有如下特点：</p> 
<ol><li>提供统一的 Promise API。</li><li>浏览器环境下，<strong>轻量且非常轻量</strong> 。</li><li>支持多种JavaScript 运行环境</li><li>支持请求／响应拦截器。</li><li>自动转换 JSON 数据。</li><li><strong>支持切换底层 Http Engine，可轻松适配各种运行环境</strong>。</li><li><strong>浏览器端支持全局Ajax拦截 。</strong></li><li><strong>H5页面内嵌到原生 APP 中时，支持将 http 请求转发到 Native。支持直接请求图片</strong>。</li></ol> 
<h3 id="articleHeader4">定位与目标</h3> 
<p>Fly 的定位是成为 Javascript http请求的终极解决方案。也就是说，在任何能够执行 Javascript 的环境，只要具有访问网络的能力，Fly都能运行在其上，提供统一的API。</p> 
<h3 id="articleHeader5">官网</h3> 
<p>详细的文档请移步：Flyio官网文档 。 官网http请求使用的正是fly，为了方便大家验证fly功能特性，官网对fly进行了全局引入，您可以在官网页面打开控制台直接验证。</p> 
<p>English doc</p> 
<h3 id="articleHeader6">安装</h3> 
<p>使用NPM</p> 
<pre>npm install flyio</pre> 
<p>使用CDN(浏览器中)</p> 
<pre>&lt;script src="https://unpkg.com/flyio/dist/fly.min.js"&gt;&lt;/script&gt;</pre> 
<p>UMD（浏览器中）</p> 
<pre>https://unpkg.com/flyio/dist/umd/fly.umd.min.js</pre> 
<h3 id="articleHeader7">引入flyio</h3> 
<p><strong>不同JavaScript运行时的入口文件不同</strong> ，请查看文档后面相应平台的引入方式，但在浏览器、Node、React Native中引入的方式是一样的，下面是不同平台下的引入的方式：</p> 
<ol><li> <p>浏览器、Node、React Native中引入</p> <pre>//引入fly实例
var fly=require("flyio")</pre> <p>上面方式引入的是Fly的默认实例（浏览器、Node、React Native中相同），你也可以自己创建Fly实例：</p> <pre>// 浏览器和React Native
var Fly=require("flyio/dist/npm/fly")
// Node 入口
// var Fly=require("flyio/src/node")
var fly=new Fly;</pre> </li><li> <p>在微信小程序中引入</p> <pre>var Fly=require("flyio/dist/npm/wx") 
var fly=new Fly</pre> <p>如果您的微信小程序项目没有使用<code>npm</code>来管理依赖，您可以直接下载源码到您的小程序工程，下载链接wx.js 或 wx.umd.min.js .下载任意一个，保存到本地工程目录，假设在“lib”目录，接下来引入：</p> <pre>var Fly=require("../lib/wx") //wx.js为您下载的源码文件
var fly=new Fly; //创建fly实例</pre> </li><li> <p>快应用中引入</p> <p>快应用 中Fly依赖 <code>fetch</code>模块，需要先在 <code>manifest.json</code>中添加引用：</p> <pre>  "features": [
     ...
    {"name": "system.fetch"}
  ]</pre> <p>然后创建fly实例</p> <pre> //依赖快应用中的fetch模块，需要在
 var fetch = require("@system.fetch")
 var Fly=require("flyio/dist/npm/hap")
 var fly=new Fly(fetch)</pre> </li><li> <p>Weex中引入</p> <pre>var Fly=require("flyio/dist/npm/weex")
var fly=new Fly</pre> </li></ol> 
<p>引入之后，您就可以对fly实例进行全局配置、添加拦截器、发起网络请求了。</p> 
<h3 id="articleHeader8">例子</h3> 
<p>下面示例如无特殊说明，则在所有支持的平台下都能执行。</p> 
<h4 id="articleHeader9">发起GET请求</h4> 
<pre>//通过用户id获取信息,参数直接写在url中
fly.get('/user?id=133')
  .then(function (response) {
    console.log(response);
  })
  .catch(function (error) {
    console.log(error);
  });

//query参数通过对象传递
fly.get('/user', {
      id: 133
  })
  .then(function (response) {
    console.log(response);
  })
  .catch(function (error) {
    console.log(error);
  });
</pre> 
<h4 id="articleHeader10">发起POST请求</h4> 
<pre>fly.post('/user', {
    name: 'Doris',
    age: 24
    phone:"18513222525"
  })
  .then(function (response) {
    console.log(response);
  })
  .catch(function (error) {
    console.log(error);
  });</pre> 
<h4 id="articleHeader11">Post请求添加Url参数</h4> 
<pre>fly.get("../package.json", "xxx=5", {
        params: {
            c: 1
        }
    }
)</pre> 
<p>最终的URL是“package.json?c=1&amp;xxx=5”。</p> 
<h4 id="articleHeader12">发起多个并发请求</h4> 
<pre>function getUserRecords() {
  return fly.get('/user/133/records');
}

function getUserProjects() {
  return fly.get('/user/133/projects');
}

fly.all([getUserRecords(), getUserProjects()])
  .then(fly.spread(function (records, projects) {
    //两个请求都完成
  }))
  .catch(function(error){
    console.log(error)
  })</pre> 
<h4 id="articleHeader13">直接通过 <code>request</code> 接口发起请求</h4> 
<pre>//直接调用request函数发起post请求
fly.request("/test",{hh:5},{
    method:"post",
    timeout:5000 //超时设置为5s
 })
.then(d=&gt;{ console.log("request result:",d)})
.catch((e) =&gt; console.log("error", e))</pre> 
<h4 id="articleHeader14">发送<code>URLSearchParams</code></h4> 
<pre>const params = new URLSearchParams();
params.append('a', 1);
fly.post("",params)
.then(d=&gt;{ console.log("request result:",d)})</pre> 
<p>注：Node环境不存在URLSearchParams。各个浏览器对URLSearchParams的支持程度也不同，使用时务必注意</p> 
<h4 id="articleHeader15">发送 <code>FormData</code></h4> 
<pre> var formData = new FormData();
 var log=console.log
 formData.append('username', 'Chris');
 fly.post("../package.json",formData).then(log).catch(log)</pre> 
<p>注：Fly目前只在支持 <code>FormData</code> 的浏览器环境中支持 <code>FormData</code>，Node环境下对 <code>FormData</code> 的支持方式稍有不同，详情戳这里 Node 下增强的API</p> 
<h4 id="articleHeader16">请求二进制数据</h4> 
<pre>fly.get("/Fly/v.png",null,{
	responseType:"arraybuffer"
}).then(d=&gt;{
  //d.data 为ArrayBuffer实例
})</pre> 
<p>注：在浏览器中时 <code>responseType</code> 值可为 "arraybuffer" 或"blob"之一。在node下只需设为 "stream"即可。</p> 
<h3 id="articleHeader17">拦截器</h3> 
<p>Fly支持请求／响应拦截器，可以通过它在请求发起之前和收到响应数据之后做一些预处理。</p> 
<pre>//添加请求拦截器
fly.interceptors.request.use((request)=&gt;{
    //给所有请求添加自定义header
    request.headers["X-Tag"]="flyio";
  	//打印出请求体
  	console.log(request.body)
  	//终止请求
  	//var err=new Error("xxx")
  	//err.request=request
  	//return Promise.reject(new Error(""))
  
    //可以显式返回request, 也可以不返回，没有返回值时拦截器中默认返回request
    return request;
})

//添加响应拦截器，响应拦截器会在then/catch处理之前执行
fly.interceptors.response.use(
    (response) =&gt; {
        //只将请求结果的data字段返回
        return response.data
    },
    (err) =&gt; {
        //发生网络错误后会走到这里
        //return Promise.resolve("ssss")
    }
)</pre> 
<p><strong>请求拦截器</strong>中的request对象结构如下：</p> 
<pre>{
  baseURL,  //请求的基地址
  body, //请求的参数
  headers, //自定义的请求头
  method, // 请求方法
  timeout, //本次请求的超时时间
  url, // 本次请求的地址
  params, //url get参数(post请求或默认的get参数)    
  withCredentials, //跨域请求是否发送第三方cookie
  ... //options中自定义的属性
}</pre> 
<p><strong>响应拦截器</strong>中的response对象结构如下：</p> 
<pre>{
  data, //服务器返回的数据
  engine, //请求使用的http engine(见下面文档),浏览器中为本次请求的XMLHttpRequest对象
  headers, //响应头信息
  request  //本次响应对应的请求信息，即上面的request结构
}</pre> 
<h4 id="articleHeader18">移除拦截器</h4> 
<p>如果你想移除拦截器，只需要将拦截器设为null即可：</p> 
<pre>fly.interceptors.request.use(null)
fly.interceptors.response.use(null,null)</pre> 
<h4 id="articleHeader19">在拦截器中执行异步任务</h4> 
<p>现在，您可以在拦截器中执行异步任务了!</p> 
<p>下面我们看一个例子：由于安全原因，我们需要所有的请求都需要在header中设置一个<code>csrfToken</code>，如果<code>csrfToken</code>不存在时，我们需要先请求一个<code>csrfToken</code>，然后再发起网络请求，由于请求<code>csrfToken</code>是异步的，所以我们需要在拦截器中执行异步请求，代码如下：</p> 
<pre>var csrfToken="";
var tokenFly=new Fly();
var fly=new Fly();
fly.interceptors.request.use(function (request) {
  log(`发起请求：path:${request.url}，baseURL:${request.baseURL}`)
  if (!csrfToken) {
    log("没有token，先请求token...");
    //锁定当天实例，后续请求会在拦截器外排队
    fly.lock();
    return newFly.get("/token").then((d) =&gt; {
      request.headers["csrfToken"] = csrfToken = d.data.data.token;
      log("token请求成功，值为: " + d.data.data.token);
      log(`继续完成请求：path:${request.url}，baseURL:${request.baseURL}`)
      return request; //只有最终返回request对象时，原来的请求才会继续
    }).finally(()=&gt;{
      //fly.clear(); //clear the request queue
      fly.unlock();//解锁后，会继续发起请求队列中的任务
    }) 
  } else {
    request.headers["csrfToken"] = csrfToken;
  }
})</pre> 
<p>注意：</p> 
<ol><li>当前Fly实例会在调用<code>fly.lock</code>时会被锁定，fly实例锁定后，接下来的请求在进入请求拦截器前会进入一个队列排队，当解锁后(通过调用<code>fly.unlock</code>)，才会进入拦截器，这提供一种同步多个任务的方式。如果你想取消队列里的所有请求，可以调用<code>fly.clear()</code> 。</li><li>只有当最终返回<code>request</code>对象时(拦截器传递给你的回调参数)，请求才会继续（如代码中注释）， 否则将会把返回的值作为本次请求。</li></ol> 
<p>有关拦截器的详细信息和示例，请参阅flyio interceptor。</p> 
<h3 id="articleHeader20">错误处理</h3> 
<p>请求失败之后，<code>catch</code> 捕获到的 err 是一个对象，它的字段如下：</p> 
<pre>{
  message:"Not Find 404", //错误消息
  status:404, //如果服务器可通，则为http请求状态码。网络异常时为0，网络超时为1
  request:{...}, //对应的请求信息
  response:{}, //响应信息
  engine:{}//请求使用的http engine(见下面文档),浏览器中为本次请求的XMLHttpRequest对象
}</pre> 
<p><strong>错误码</strong></p> 
<table><thead><tr><th>错误码</th><th>含义</th></tr></thead><tbody><tr><td>0</td><td>网络错误</td></tr><tr><td>1</td><td>请求超时</td></tr><tr><td>2</td><td>文件下载成功，但保存失败，此错误只出现node环境下</td></tr><tr><td>&gt;=200</td><td>http请求状态码</td></tr></tbody></table> 
<p><strong>示例</strong></p> 
<pre>fly.get('/user/12345')
  .catch(function (error) {
    console.log('Error', error.message);
    console.log('Error engine:', error.engine)
    // The request was made but no response was received
    // `error.request` holds the request info.
    console.log('Error request info:',error.request);
    if (error.response) {
      // The request was made and the server responded with a status code
      // that falls out of the range of 2xx and 304
      console.log(error.response.data);
      console.log(error.response.status);
      console.log(error.response.statusText);
      console.log(error.response.headers);
    }
  });</pre> 
<h3 id="articleHeader21">请求配置选项</h3> 
<p>可配置选项：</p> 
<pre>{
  headers:{}, //http请求头，
  baseURL:"", //请求基地址
  timeout:0,//超时时间，为0时则无超时限制
  //是否自动将Content-Type为“application/json”的响应数据转化为JSON对象，默认为true    
  parseJson:true,
  params:{}, //默认公共的url get参数     
  withCredentials:false //跨域时是否发送cookie
}</pre> 
<p>配置支持<strong>实例级配置</strong>和<strong>单次请求配置</strong></p> 
<h4 id="articleHeader22">实例级配置</h4> 
<p>实例级配置可用于当前Fly实例发起的所有请求</p> 
<pre>//定义公共headers
fly.config.headers={xx:5,bb:6,dd:7}
//设置超时
fly.config.timeout=10000;
//设置请求基地址
fly.config.baseURL="https://wendux.github.io/"
//设置公共的Get参数
fly.config.params={"token":"testtoken"};</pre> 
<h4 id="articleHeader23">单次请求配置</h4> 
<p>需要对单次请求配置时，配置只对当次请求有效。</p> 
<pre>fly.request("/test",{hh:5},{
    method:"post",
    timeout:5000 //超时设置为5s
})</pre> 
<p><strong>注：若单次配置和实例配置冲突，则会优先使用单次请求配置</strong></p> 
<p>详细的配置请参考 Fly请求配置 。</p> 
<h3 id="articleHeader24">API</h3> 
<p><code>fly.get(url, data, options)</code></p> 
<p>发起 get 请求，url请求地址，data为请求数据，在浏览器环境下类型可以是:</p> 
<pre>String|Json|Object|Array|Blob|ArrayBuffer|FormData</pre> 
<p>options为请求配置项。</p> 
<p><code>fly.post(url, data, options)</code></p> 
<p>发起post请求，参数含义同fly.get。</p> 
<p><code>fly.request(url, data, options)</code></p> 
<p>发起请求，参数含义同上，在使用此API时需要指定options 的method：</p> 
<pre>//GET请求
fly.request("/user/8" null, {method:"get"})
//DELETE 请求
fly.request("/user/8/delete", null, {method:"delete"})
//PUT请求
fly.request("/user/register", {name:"doris"}, {method:"PUT"})
......</pre> 
<p>request 适合在 RESTful API 的场景下使用，为了方便使用，fly提供了响应的别名方法</p> 
<p><strong>别名方法</strong></p> 
<p><code>fly.put(url, data, options)</code></p> 
<p><code>fly.delete(url,data,options)</code></p> 
<p><code>fly.patch(url,data,options)</code></p> 
<p><code>fly.all([])</code></p> 
<p><code>fly.spread([])</code></p> 
<p>发起多个并发请求，参数是一个promise 数组；当所有请求都成功后才会调用<code>then</code>，只要有一个失败，就会调 <code>catch</code>。</p> 
<h3 id="articleHeader30">使用application/x-www-form-urlencoded 编码</h3> 
<p>Fly默认会将JavaScript objects 序列化为 <code>JSON</code> 发送（RequestBody），如果想以 <code>application/x-www-form-urlencoded</code> 编码格式发送，你可以使用如下方式：</p> 
<h4 id="articleHeader31">通过设置请求头</h4> 
<p>将请求头<code>content-type</code>设置为"application/x-www-form-urlencoded"后fly会自动对请求数据进行编码，如：</p> 
<pre>fly.post("../package.json",{aa:8,bb:9,tt:{xx:5}},{headers:{
    "content-type":"application/x-www-form-urlencoded"
}})
.then(console.log)</pre> 
<p>这种方法是通用的，意味着在任何JavaScript运行环境下都能正常工作，还有一些其它特定平台的方法：</p> 
<h4 id="articleHeader32">其它方法</h4> 
<p>浏览器中</p> 
<p>在浏览器中, 你可以使用 <code>URLSearchParams</code> ，如下:</p> 
<pre>var params = new URLSearchParams();
params.append('param1', 'value1');
params.append('param2', 'value2');
fly.post('/foo', params);</pre> 
<blockquote> 
 <p>注意，现在不是所有浏览器都支持 <code>URLSearchParams</code> (参考 caniuse.com), 但是有一个 polyfill 可用 (确保polyfill为全局变量).</p> 
</blockquote> 
<p>另一种方法，你可以使用 <code>qs</code> 库:</p> 
<pre>var qs = require('qs');
fly.post('/foo', qs.stringify({ 'bar': 123 }));</pre> 
<p>Node.js</p> 
<p>在node中，你可以使用 <code>querystring</code> 模块，如:</p> 
<pre>var querystring = require('querystring');
fly.post('http://something.com/', querystring.stringify({ foo: 'bar' }));</pre> 
<p>你仍然可以使用 <code>qs</code> 库.</p> 
<h3 id="articleHeader35">Promises</h3> 
<p>Fly 依赖 ES6 Promise 支持情况. 如果你的环境不支持 ES6 Promises, 你需要 polyfill.</p> 
<h3 id="articleHeader36">TypeScript</h3> 
<p>Fly 提供了 TypeScript 描述文件.你可以在TypeScript中方便使用：</p> 
<pre>import fly from 'flyio';
fly.get('/user?ID=12345');</pre> 
<h3 id="articleHeader37">创建Fly实例</h3> 
<p>为方便使用，在引入flyio库之后，会创建一个默认实例，一般情况下大多数请求都是通过默认实例发出的，但在一些场景中需要多个实例（可能使用不同的配置请求），这时你可以手动new一个：</p> 
<pre>//npm、node环境下
var  Fly=require("flyio/dist/npm/fly") //注意！此时引入的是 "flyio/dist/npm/fly"
var nFly=new Fly();

//CDN引入时直接new
var nFly=new Fly();</pre> 
<h3 id="articleHeader38">Http engine</h3> 
<p>Fly 引入了Http engine 的概念，所谓 Http engine，就是真正发起http请求的引擎，这在浏览器中一般都是<code>XMLHttpRequest</code>，而在 node 环境中，可以用任何能发起网络请求的库／模块实现，Fly 可以自由更换底层 http engine ，Fly 正是通过更换 engine 而实现同时支持 node 和 browser 。值得注意的是，http engine 不局限于node 和 browser 环境中，也可以是 android、ios、electron，正是由于这些，Fly 才有了一个非常强大的功能——<strong>请求重定向</strong>。基于请求重定向，我们可以实现一些非常有用的功能，比如<strong>将内嵌到 APP 的所有 http 请求重定向到 Native ，然后在端上( android、ios )统一发起网络请求、进行 cookie 管理、证书校验</strong>。详情请戳 Fly Http Engine</p> 
<h3 id="articleHeader39">全局Ajax拦截</h3> 
<p>在浏览器中，可以通过用 Fly engine 替换 <code>XMLHttpRequest</code> 的方式拦截<strong>全局</strong>的的 Ajax 请求，无论上层使用的是何种网络库。详细的内容请参考 Fly拦截全局Ajax</p> 
<h3 id="articleHeader40">Node</h3> 
<p>无论是在浏览器环境，还是在 Node 环境，Fly在上层提供了统一的 Promise API。这意味着无论您是 web 开发还是 node 开发，您都可以以相同的调用方式来发起http请求。不过，由于node和浏览器环境本身的差异，在Node环境下，Fly除了支持基本的API之外，还提供了一些增强的API，这些 API 主要涉及文件下载、多文件上传、http代理等众多强大的功能，详情请参考 Node下增强的API</p> 
<h3 id="articleHeader41">体积</h3> 
<p>在浏览器环境下，一个库的大小是非常重要的。这方面 Fly 做的很好，它在保持强大的功能的同时，将自己的身材控制到了最好。min 只有 4.6K 左右，GZIP 压缩后不到 2K，体积是 axios 的四分之一。</p> 
<h3 id="articleHeader42">工程目录结构</h3> 
<p>工程目录结构及文件说明请参照 fly源码目录说明 。</p> 
<h3 id="articleHeader43">最后</h3> 
<p>如果感觉 Fly 对您有用，欢迎 star 。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/47c9d1e1365a2b96e4a29e286e83a417/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">虚拟机挂起后硬盘响应变慢，SCSI转IDE方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/19896a0f656b565f53c16c0547fef72f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Aviator规则引擎保姆级教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>