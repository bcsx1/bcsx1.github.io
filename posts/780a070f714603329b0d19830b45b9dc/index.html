<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring-Xml配置 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spring-Xml配置" />
<meta property="og:description" content="一、Spring 简介 1.简介 文档下载地址：Index of /spring-framework/docs
1.简介 Spring framework 是 Spring 基础框架
学习Spring 家族产品
Spring framework
SpringBoot
SpringCloud
Spring 能用来做什么
开发 WEB 项目
微服务
分布式系统
Spring framework 是 Spring 最基础的框架，是其它框架技术的基础
SpringBoot 是用来做简化开发的，单一项目
SpringCloud 做分布式微服务相关的，拆分大单体项目为小模块项目
2.Spring 概述 2.1 Spring framework 介绍 概述：spring 提供了基础框架，你不必关心框架细节，只需要专注于代码业务逻辑
优点：
组件化模块化的：通过很多模块与组件组合成 spring 应用，以后可以通过 Xml 或者注解的方式去操作
控制反转（ Inversion of Control (IoC) ）：传统创建对象都是通过认为的new 对象的方式，把控制创建对象的权利转交给Spring
依赖注入（Dependency Injection）：自动化的注入属性
3.模块 3.1 Spring 系统架构图 3.2模块介绍 Core Container：核心容器，是Spring 最核心的模块，以后用到的都依赖该模块实现
Aop：面向切面编程，目的是不改变原有代码的前提下对功能进行增强
Aspects：是Aop 具体实现
Data Access/Integration：数据层" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/780a070f714603329b0d19830b45b9dc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-07T16:42:32+08:00" />
<meta property="article:modified_time" content="2023-03-07T16:42:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring-Xml配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、Spring 简介</h2> 
<h3>1.简介</h3> 
<ul><li> <p>文档下载地址：<a href="https://docs.spring.io/spring-framework/docs/" rel="nofollow" title="Index of /spring-framework/docs">Index of /spring-framework/docs</a></p> </li></ul> 
<h3>1.简介</h3> 
<ul><li> <p><strong>Spring framework</strong> 是 Spring 基础框架</p> </li><li> <p>学习Spring 家族产品</p> 
  <ul><li> <p>Spring framework</p> </li><li> <p>SpringBoot</p> </li><li> <p>SpringCloud</p> </li></ul></li><li> <p>Spring 能用来做什么</p> 
  <ul><li> <p>开发 WEB 项目</p> </li><li> <p>微服务</p> </li><li> <p>分布式系统</p> </li></ul></li><li> <p>Spring framework 是 Spring 最基础的框架，是其它框架技术的基础</p> </li><li> <p>SpringBoot 是用来做简化开发的，单一项目</p> </li><li> <p>SpringCloud 做分布式微服务相关的，拆分大单体项目为小模块项目</p> </li></ul> 
<h3>2.Spring 概述</h3> 
<h4>2.1 Spring framework 介绍</h4> 
<ul><li> <p>概述：spring 提供了基础框架，你不必关心框架细节，只需要专注于代码业务逻辑</p> </li><li> <p>优点：</p> 
  <ul><li> <p>组件化模块化的：通过很多模块与组件组合成 spring 应用，以后可以通过 Xml 或者注解的方式去操作</p> </li><li> <p>控制反转（ <em>Inversion of Control</em> (IoC) ）：传统创建对象都是通过认为的new 对象的方式，把控制创建对象的权利转交给Spring</p> </li><li> <p>依赖注入（Dependency Injection）：自动化的注入属性</p> </li></ul></li></ul> 
<h3>3.模块</h3> 
<h4>3.1 Spring 系统架构图  </h4> 
<p><img alt="" height="767" src="https://images2.imgbox.com/6c/eb/BlZ4j0y2_o.png" width="1052"></p> 
<h4>3.2模块介绍</h4> 
<ul><li> <p><strong>Core Container</strong>：核心容器，是Spring 最核心的模块，以后用到的都依赖该模块实现</p> </li><li> <p><strong>Aop</strong>：面向切面编程，目的是不改变原有代码的前提下对功能进行增强</p> 
  <ul><li> <p>Aspects：是Aop 具体实现</p> </li></ul></li><li> <p><strong>Data Access/Integration</strong>：数据层</p> 
  <ul><li> <p>Data Access：数据访问的</p> </li><li> <p>Data Integration：数据集成</p> </li><li> <p>Transactios：支持事务操作，通过 AOP 来实现，释放我们的双手</p> </li></ul></li><li> <p><strong>Web</strong>：WEB 层，SpringMVC 框架的</p> 
  <ul><li> <p>Servlet</p> </li><li> <p>Web</p> </li></ul></li><li> <p><strong>Test</strong>：做集成测试</p> 
  <ul><li> <p>整合 Junit 做单元测试</p> </li></ul></li></ul> 
<h2>二、IOC</h2> 
<h3>1.概述</h3> 
<h4>1.1 IOC：Inversion of Control 控制反转</h4> 
<ul><li>把对象的创建权利交出去，交由第三方容器负责。</li><li>把对象和对象之间关系的维护权利交出去，交给第三方容器负责。</li></ul> 
<h4>1.2 控制反转是一种思想</h4> 
<ul><li>为了降低程序耦合度，提高程序扩展力，达到OCP原则，达到DIP原则。</li></ul> 
<h4>1.3 如何实现控制反转</h4> 
<ul><li>DI：依赖注入</li></ul> 
<h3>2.回顾问题</h3> 
<h4>2.1问题：写了太多与业务无关的代码</h4> 
<ul><li> <p>耦合度非常高，写了很多和业务无关的代码</p> </li><li> <p>不利于项目的升级迭代</p> </li></ul> 
<h4><img alt="" height="904" src="https://images2.imgbox.com/1d/6e/zEIZIyzU_o.png" width="1200"></h4> 
<ul><li>思考的解决方案 
  <ul><li> <p>能够直接获取 mapper 接口，而不必去关心底层的获取方式</p> </li></ul></li></ul> 
<p><img alt="" height="552" src="https://images2.imgbox.com/39/9a/8f8jrSee_o.png" width="1186"></p> 
<h3>3.bean 配置</h3> 
<h4>3.1.创建 spring01 项目</h4> 
<p>项目结构</p> 
<p><img alt="" height="336" src="https://images2.imgbox.com/61/0f/J9ImuTbm_o.png" width="721"></p> 
<p>添加 Spring 依赖</p> 
<pre><code class="language-XML">&lt;dependencies&gt;
&lt;!--        添加 spring 依赖--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
            &lt;version&gt;5.2.17.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
&lt;!--        添加 junit 依赖--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
&lt;!--            &lt;scope&gt;test&lt;/scope&gt;--&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;</code></pre> 
<h4>3.2添加 Student 类</h4> 
<ul><li>创建空学生类</li></ul> 
<h4>3.3添加 Spring 配置文件</h4> 
<p><img alt="" height="1160" src="https://images2.imgbox.com/a6/e4/N9Iz3QXh_o.png" width="1200"></p> 
<p>开始配置 javabean</p> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
&lt;!--    配置 Student 学生类--&gt;
    &lt;bean id="student" name="stu" class="cn.wjcoder.domian.Student"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<h4> 3.4属性介绍</h4> 
<table><thead><tr><th>属性名称</th><th>说明</th></tr></thead><tbody><tr><td>id</td><td>给 bean 起名字（定义id 不能重复）</td></tr><tr><td>name</td><td>给 bean 起别名</td></tr><tr><td>class</td><td>类全限定类名</td></tr></tbody></table> 
<h3>4.容器创建</h3> 
<h4>4.1ClassPathXmlApplicationContext</h4> 
<pre><code class="language-java">ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
System.out.println(context);</code></pre> 
<h4>4.2.FileSystemXmlApplicationContext</h4> 
<pre><code class="language-java">ApplicationContext ctx = new FileSystemXmlApplicationContext("绝对路径地址");</code></pre> 
<p> 使用 ClassPathXmlApplicationContext 获取方式会出现如下问题</p> 
<p><img alt="" height="719" src="https://images2.imgbox.com/8d/92/AyEID7TX_o.png" width="1200"></p> 
<h3>5.从容器中获取 bean</h3> 
<h4>5.1根据id 获取</h4> 
<pre><code class="language-java">ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
        //从容器中根据 id 获取 bean 对象
Student stu = (Student)context.getBean("student");
		//通过别名获取 bean 对象
Student stuByName = (Student)context.getBean("stu");</code></pre> 
<p> 注意：如果id重复会有如下问题</p> 
<h4>5.2根据id和类型</h4> 
<pre><code class="language-java">ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
final Student bean = context.getBean(Student.class);</code></pre> 
<p>注意：使用类型获取的时候，一定要保证容器中只有一个 javabean 对象</p> 
<p><img alt="" height="621" src="https://images2.imgbox.com/03/12/OVsmW8iL_o.png" width="1200"></p> 
<h4>4.注意点</h4> 
<ul><li>bean 的配置spring 是使用反射调用对象的无参构造器实现的。所以必须提供无参构造器，否则会出现如下错误  </li></ul> 
<p><img alt="" height="947" src="https://images2.imgbox.com/7b/82/lUC0YbY3_o.png" width="1200"></p> 
<h3>6.设计模式</h3> 
<h4>6.1单例模式</h4> 
<ul><li> <p>概述：属于创建型模式，提供了创建对象的最佳方式。单例模式只能有一个单一的类</p> </li><li> <p>懒汉式单例模式:需要用的时候，再去把对象创建出来</p> </li></ul> 
<pre><code class="language-java">public class SingleObject {
    //线程不安全的懒汉式单例模式
    private static SingleObject instance;

    public static SingleObject getInstance(){
        if(instance == null){
            instance =new SingleObject();
        }
        return instance;
    }

}</code></pre> 
<ul><li>饿汉式单例模式：不管你有没有，我先创建出来</li></ul> 
<pre><code class="language-java">public class SingleObjectE {
    //线程不安全的饿汉式单例模式
    private static SingleObjectE instance = new SingleObjectE();

    public static SingleObjectE getInstance(){
        return instance;
    }
}</code></pre> 
<h4>6.2工厂模式</h4> 
<ul><li> <p>概述：也是属于创建型模式，目的也是提供创建对象的最佳方式</p> </li><li> <p>静态工厂</p> </li></ul> 
<pre><code class="language-java">public class BeanFactory {

    public static Student getBean() {
        return new Student();
    }

    public static Object getBean(String name) {
        if ("Student".equals(name))
            return new Student();
        else if("SingleObject".equals(name)) {
            return new SingleObject();
        }else{
            return new Object();
        }
    }

}</code></pre> 
<ul><li>实例工厂</li></ul> 
<pre><code class="language-java">public class BeanFactory {
    
    public Object getBean(){
        return new Student();
    }
}</code></pre> 
<h3>7.bean 实例化</h3> 
<ul><li> <p>bean 交给 spring 创建，底层究竟是怎么创建的？</p> </li><li> <p>实例化 bean 三种方式：</p> 
  <ul><li> <p>构造器(常用)</p> </li><li> <p>静态工厂方法</p> </li><li> <p>实例工厂方法</p> </li><li> <p>实现 FactoryBean（最常用）</p> </li></ul></li></ul> 
<h4>7.1<strong>无参构造器实例化</strong></h4> 
<p>新建 person 类，底层是通过 clz.getDeclaredClasses() 获取构造器</p> 
<pre><code class="language-java">public class Person {
    
    public Person(){
        
    }
    
}</code></pre> 
<p>配置 Person bean</p> 
<pre><code class="language-XML">&lt;bean id="person" class="cn.wjcoder.domian.Person"&gt;&lt;/bean&gt;</code></pre> 
<p> 从容器中获取 bean</p> 
<pre><code class="language-java">@Test
public void testConstructorInit(){
     final ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
     Person p = (Person) context.getBean("person");

}</code></pre> 
<p><strong>注意：修改构造器，添加参数测试，提示找不到无参构造器  </strong></p> 
<p><img alt="" height="279" src="https://images2.imgbox.com/67/09/gPdjXzlo_o.png" width="1200"></p> 
<p><img alt="" height="342" src="https://images2.imgbox.com/e8/5e/O3SI3zvZ_o.png" width="1200"></p> 
<h4><strong>7.2</strong>静态工厂方法实例化</h4> 
<p>创建 clintServer 类,提供静态工厂方法</p> 
<pre><code class="language-java">public class ClientServer {
    //创建自身对象并且私有化
    private static ClientServer clientServer = new ClientServer();
    private ClientServer() {}
    public static ClientServer createInstance(){
        return clientServer;
    }
}</code></pre> 
<p>配置bean 的 xml</p> 
<pre><code class="language-XML">&lt;bean id="clientServer" class="cn.wjcoder.domian.ClientServer" factory-method="createInstance"&gt;&lt;/bean&gt;</code></pre> 
<p>获取 bean</p> 
<pre><code class="language-java">@Test
    public void testFactoryStaticMethodInit(){
        final ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
        final ClientServer bean = context.getBean(ClientServer.class);
    }</code></pre> 
<p><img alt="" height="545" src="https://images2.imgbox.com/be/a1/nJJnnyVF_o.png" width="1200"></p> 
<p>配置关系</p> 
<p><img alt="" height="698" src="https://images2.imgbox.com/1d/07/03BwK23u_o.png" width="1200"></p> 
<h4>7.3实例工厂方法实例化</h4> 
<p>创建实例工厂类</p> 
<pre><code class="language-java">public class ClientServiceFactory {
    private static ClientService instance = new ClientService();
    private ClientServiceFactory(){}
    public ClientService getInstance(){
        return instance;
    }
}</code></pre> 
<pre><code class="language-java">public class ClientService {
}</code></pre> 
<p>配置 bean  </p> 
<pre><code class="language-XML">&lt;!--    配置工厂--&gt;
    &lt;bean id="clientFactory" class="cn.wjcoder.domian.ClientServiceFactory"&gt;&lt;/bean&gt;
&lt;!--    配置 clientService--&gt;
    &lt;bean id="clientService" factory-bean="clientFactory" factory-method="getInstance"&gt;&lt;/bean&gt;</code></pre> 
<p>获取bean</p> 
<pre><code class="language-java">@Test
    public void testFactoryInstanceMethodInit(){
        final ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
        final ClientService bean = context.getBean(ClientService.class);
    }</code></pre> 
<p>配置关系</p> 
<p><img alt="" height="939" src="https://images2.imgbox.com/ca/ca/b5bzN5j6_o.png" width="1200"></p> 
<h4>7.4实现 FactoryBean实例化</h4> 
<p>创建员工类</p> 
<pre><code class="language-java">public class Employee {
    public void check(){
        System.out.println("检查是否能够拿到员工类对象");
    }
}</code></pre> 
<p>创建员工 factory 类实现 FactoryBean</p> 
<pre><code class="language-java">public class EmployeeFactory implements FactoryBean&lt;Employee&gt; {
    public Employee getObject() throws Exception {
        System.out.println("获取 emp 对象");
        return new Employee();
    }

    public Class&lt;?&gt; getObjectType() {
        return Employee.class;
    }

    public boolean isSingleton() {
        return false;
    }
}</code></pre> 
<p>配置工厂类(<strong>并没有直接配置 emp 类</strong>)</p> 
<pre><code class="language-XML">&lt;bean id="employee" class="cn.wjcoder.domian.EmployeeFactory"&gt;&lt;/bean&gt;</code></pre> 
<pre><code class="language-java">@Test
    public void testFactoryBeanInit(){
        final ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
        final Employee emp = (Employee)context.getBean("employee");
        emp.check();
    }</code></pre> 
<p>实现方法说明</p> 
<ul><li> <p>isSingleton:如果是 true 返回单例的对象</p> </li></ul> 
<pre><code class="language-java">public boolean isSingleton() {
        return true;
    }</code></pre> 
<ul><li>getObject:进行对象创建的</li></ul> 
<pre><code class="language-java">public Employee getObject() throws Exception {
    System.out.println("获取 emp 对象");
    return new Employee();
}</code></pre> 
<h2>三、DI</h2> 
<h3>1.概述</h3> 
<ul><li> <p>概述：Dependency Injection 依赖注入，给对象设置属性，曾经我们需要自己去创建 mapper 对象，才能调用，现在交给 spring 创建，并且使用 DI 注入，直接拿来用，程序员就可以更加关注业务代码而不是创建对象</p> </li><li> <p>给对象设置属性方式：</p> 
  <ul><li> <p>构造器</p> </li><li> <p>set 方法</p> </li></ul></li><li> <p>spring 也是通过构造器以及set方法来实现属性设置</p> </li></ul> 
<h3>2.回顾问题</h3> 
<ul><li> <p>如果只给了 mapper 对象，那么调用的时候会出现空指针</p> </li></ul> 
<p><img alt="" height="558" src="https://images2.imgbox.com/83/f2/ad9HRUDG_o.png" width="977"></p> 
<p>解决方式：使用 DI 注入，解决方案如下</p> 
<p><img alt="" height="725" src="https://images2.imgbox.com/0f/c4/9Nd6neBw_o.png" width="1200"></p> 
<h3>3.构造器依赖注入  </h3> 
<h4>3.1创建学生类</h4> 
<pre><code class="language-java">public class Student {
}</code></pre> 
<h4>3.2创建Mapper 接口以及实现类</h4> 
<ul><li> <p>创建 Mapper 接口</p> <pre><code class="language-java">public interface StudentMapper {
    void insert(Student stu);
    
    int delete(Long id);
}</code></pre> </li><li> <p>创建 Mapper 实现类</p> <pre><code class="language-java">public class StudentMapperImpl implements StudentMapper{
    public void insert(Student stu) {
        System.out.println("保存学生信息");
    }
​
    public int delete(Long id) {
        System.out.println("删除id="+id+"的学生信息");
        return 1;
    }
}</code></pre> </li><li> <p>将 Mapper 交给容器管理</p> <pre><code class="language-XML">&lt;bean id="studentMapper" class="cn.wjcoder.di.mapper.StudentMapperImpl"&gt;&lt;/bean&gt;</code></pre> </li></ul> 
<h4>3.3创建 service 接口以及实现类</h4> 
<ul><li> <p>创建 service 接口</p> <pre><code class="language-java">public interface IStudentService {
    void insert(Student stu);
​
    int delete(Long id);
}</code></pre> </li><li> <p>创建 service 实现类</p> <pre><code class="language-java">public class StudentServiceImpl implements IStudentService {
​
    private StudentMapper mapper;
​
    public void insert(Student stu) {
        mapper.insert(stu);
    }
​
    public int delete(Long id) {
        return mapper.delete(id);
    }
}</code></pre> </li><li> <p>将 service 交给容器管理</p> <pre><code class="language-XML">&lt;bean id="iStudentService" class="cn.wjcoder.di.service.impl.StudentServiceImpl"&gt;&lt;/bean&gt;</code></pre> </li></ul> 
<h4>3.4如果没有使用DI注入直接调用</h4> 
<ul><li> <p>会产生如下问题</p> </li></ul> 
<p><img alt="" height="1163" src="https://images2.imgbox.com/50/94/4YqwcIQa_o.png" width="1200"></p> 
<h4>4.5配置构造器注入属性</h4> 
<p>配置 service 构造器</p> 
<pre><code class="language-java">public class StudentServiceImpl implements IStudentService {

    private StudentMapper mapper;

    public StudentServiceImpl(StudentMapper mapper){
        this.mapper = mapper;
    }

    public void insert(Student stu) {
        mapper.insert(stu);
    }

    public int delete(Long id) {
        return mapper.delete(id);
    }
}</code></pre> 
<p> 配置 xml</p> 
<pre><code class="language-XML">&lt;!--    配置 service--&gt;
    &lt;bean id="iStudentService" class="cn.wjcoder.di.service.impl.StudentServiceImpl"&gt;
        &lt;constructor-arg name="mapper" ref="studentMapper"&gt;&lt;/constructor-arg&gt;
    &lt;/bean&gt;
&lt;!--    配置 mapper--&gt;
    &lt;bean id="studentMapper" class="cn.wjcoder.di.mapper.StudentMapperImpl"&gt;&lt;/bean&gt;</code></pre> 
<p>注意：</p> 
<ul><li> <p>name:构造器的参数名称</p> </li><li> <p>ref:配置文件中其它 bean 的名称</p> </li><li> <p>图示如下</p> </li></ul> 
<p><img alt="" height="837" src="https://images2.imgbox.com/d6/ed/aVpmWQ5E_o.png" width="1200"></p> 
<h4>3.6构造器配置多个引用类型参数</h4> 
<p>配置service</p> 
<pre><code class="language-java">public class StudentServiceImpl implements IStudentService {

    private StudentMapper mapper;

    private UserMapper userMapper;

    public StudentServiceImpl(StudentMapper mapper,UserMapper userMapper){
        this.mapper = mapper;
        this.userMapper = userMapper;
    }

    public void insert(Student stu) {
        mapper.insert(stu);
    }

    public int delete(Long id) {
        userMapper.delete(id);
        return mapper.delete(id);
    }
}</code></pre> 
<p> 创建mapper</p> 
<pre><code class="language-java">public interface UserMapper {
    int delete(Long id);
}</code></pre> 
<p>创建mapper实现类</p> 
<pre><code class="language-java">public class UserMapperImpl implements UserMapper{

    public int delete(Long id) {
        System.out.println("删除id="+id+"的用户信息");
        return 1;
    }
}</code></pre> 
<p>配置bean</p> 
<pre><code class="language-XML">&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
&lt;!--    配置 service--&gt;
&lt;bean id="iStudentService" class="cn.wjcoder.di.service.impl.StudentServiceImpl"&gt;
     &lt;constructor-arg name="mapper" ref="studentMapper"&gt;&lt;/constructor-arg&gt;
     &lt;constructor-arg name="userMapper" ref="userMapper"&gt;&lt;/constructor-arg&gt;
&lt;/bean&gt;
&lt;!--    配置学生mapper--&gt;
&lt;bean id="studentMapper" class="cn.wjcoder.di.mapper.StudentMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置用户mapper--&gt;
&lt;bean id="userMapper" class="cn.wjcoder.di.mapper.UserMapperImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<h4>3.7构造器配置多个基本数据类型参数</h4> 
<p>配置service</p> 
<pre><code class="language-java">public class StudentServiceImpl implements IStudentService {

    private String name;

    private int age;

    private StudentMapper mapper;

    private UserMapper userMapper;

    public StudentServiceImpl(String name,int age,StudentMapper mapper,UserMapper userMapper){
        this.name = name;
        this.age = age;
        this.mapper = mapper;
        this.userMapper = userMapper;
    }

    public void insert(Student stu) {
        mapper.insert(stu);
    }

    public int delete(Long id) {
        System.out.println( name+":"+age);
        userMapper.delete(id);
        return mapper.delete(id);
    }
}</code></pre> 
<p>配置bean</p> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
&lt;!--    配置 service--&gt;
    &lt;bean id="iStudentService" class="cn.sycoder.di.service.impl.StudentServiceImpl"&gt;
        &lt;constructor-arg name="userMapper" ref="userMapper"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg name="mapper" ref="studentMapper"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg type="int" value="18"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg type="java.lang.String" value="sy"&gt;&lt;/constructor-arg&gt;
    &lt;/bean&gt;
&lt;!--    配置学生mapper--&gt;
    &lt;bean id="studentMapper" class="cn.sycoder.di.mapper.StudentMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置用户mapper--&gt;
    &lt;bean id="userMapper" class="cn.sycoder.di.mapper.UserMapperImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<p>这种方式会存在参数覆盖的问题，解决方式，删除 type 添加 index 属性</p> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
&lt;!--    配置 service--&gt;
    &lt;bean id="iStudentService" class="cn.sycoder.di.service.impl.StudentServiceImpl"&gt;
        &lt;constructor-arg name="userMapper" ref="userMapper"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg name="mapper" ref="studentMapper"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg index="2" value="18"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg index="1" value="1"&gt;&lt;/constructor-arg&gt;
        &lt;constructor-arg type="java.lang.String" value="sy"&gt;&lt;/constructor-arg&gt;

    &lt;/bean&gt;
&lt;!--    配置学生mapper--&gt;
    &lt;bean id="studentMapper" class="cn.sycoder.di.mapper.StudentMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置用户mapper--&gt;
    &lt;bean id="userMapper" class="cn.sycoder.di.mapper.UserMapperImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<h3>4.setter依赖注入</h3> 
<ul><li> <p>使用 set 方法实现属性的注入</p> </li><li> <p>使用 property 属性</p> 
  <ul><li> <p>name:属性名称</p> </li><li> <p>value:直接给值</p> </li><li> <p>ref:其它bean的引用</p> </li></ul></li></ul> 
<h4>4.1创建员工类 </h4> 
<pre><code class="language-java">public class Employee {
}</code></pre> 
<h4>4.2创建 mapper 接口以及实现类</h4> 
<ul><li> <p>mapper 接口</p> <pre><code class="language-java">public interface EmployeeMapper {
    int delete(Long id);
}</code></pre> </li><li> <p>mapper 实现类</p> <pre><code class="language-java">public class EmployeeMapperImpl implements EmployeeMapper {
    public int delete(Long id) {
        System.out.println("删除当前员工id:"+id);
        return 1;
    }
}</code></pre> </li></ul> 
<h4>4.3创建 servie 接口以及实现类</h4> 
<ul><li> <p>创建 service 接口</p> <pre><code class="language-java">public interface IEmployeeService {
    int delete(Long id);
}</code></pre> </li><li> <p>创建 service 接口实现类</p> <pre><code class="language-java">public class EmployeeServiceImpl implements IEmployeeService {
​
    private EmployeeMapper mapper;
​
    public int delete(Long id) {
        return mapper.delete(id);
    }
}</code></pre> </li></ul> 
<h4>4.4配置 setter 注入</h4> 
<ul><li> <p>配置bean</p> </li></ul> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;&lt;!--    配置mapper实现类--&gt;
&lt;!--    配置mapper--&gt;
    &lt;bean id="empMapper" class="cn.sycoder.di.setter.mapper.EmployeeMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置service--&gt;
    &lt;bean id="empService" class="cn.sycoder.di.setter.service.impl.EmployeeServiceImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<ul><li> <p>service 实现中提供 mapper 的setter 方法</p> <pre><code class="language-java">public class EmployeeServiceImpl implements IEmployeeService {
​
    private EmployeeMapper employeeMapper;
​
    public int delete(Long id) {
        return employeeMapper.delete(id);
    }
    
    public void setEmployeeMapper(EmployeeMapper employeeMapper){
        this.employeeMapper = employeeMapper;
    }
}</code></pre> </li><li> <p>修改 beans.xml 通过 setter 注入</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;&lt;!--    配置mapper实现类--&gt;
&lt;!--    配置mapper--&gt;
    &lt;bean id="empMapper" class="cn.sycoder.di.setter.mapper.EmployeeMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置service--&gt;
    &lt;bean id="empService" class="cn.sycoder.di.setter.service.impl.EmployeeServiceImpl"&gt;
        &lt;property name="employeeMapper" ref="empMapper"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre> </li><li> <p>获取 service 执行 delete 方法</p> <pre><code class="language-java">@Test
    public void testSetDi(){
        final ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("DiSetterBeans.xml");
        final IEmployeeService empService = (IEmployeeService) context.getBean("empService");
        empService.delete(2L);
    }</code></pre> </li><li> <p>setter 注入过程分析</p> </li></ul> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/19/fa/ncPVyAH5_o.png" width="1200"></p> 
<h4>4.5配置多个 setter 方法注入多个属性</h4> 
<ul><li> <p>给service 添加新的属性以及新的setter方法</p> <pre><code class="language-java">public class EmployeeServiceImpl implements IEmployeeService {
​
    private EmployeeMapper employeeMapper;
​
    private UserMapper userMapper;
​
    public int delete(Long id) {
        return employeeMapper.delete(id);
    }
​
    public void setEmployeeMapper(EmployeeMapper employeeMapper){
        System.out.println("=======使用 setter 注入=======");
        this.employeeMapper = employeeMapper;
    }
​
    public void setUserMapper(UserMapper mapper){
        this.userMapper = mapper;
    }
}</code></pre> </li><li> <p>配置 userMapper bean</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;&lt;!--    配置mapper实现类--&gt;
&lt;!--    配置mapper--&gt;
    &lt;bean id="empMapper" class="cn.sycoder.di.setter.mapper.EmployeeMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置service--&gt;
    &lt;bean id="empService" class="cn.sycoder.di.setter.service.impl.EmployeeServiceImpl"&gt;
        &lt;property name="employeeMapper" ref="empMapper"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;!--    配置 userMapper--&gt;
    &lt;bean id="userMapper" class="cn.sycoder.di.constructor.mapper.StudentMapperImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> </li><li> <p>通过 setter 注入</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;&lt;!--    配置mapper实现类--&gt;
&lt;!--    配置mapper--&gt;
    &lt;bean id="empMapper" class="cn.sycoder.di.setter.mapper.EmployeeMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置service--&gt;
    &lt;bean id="empService" class="cn.sycoder.di.setter.service.impl.EmployeeServiceImpl"&gt;
        &lt;property name="employeeMapper" ref="empMapper"&gt;&lt;/property&gt;
        &lt;property name="userMapper" ref="userMapper"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;!--    配置 userMapper--&gt;
    &lt;bean id="userMapper" class="cn.sycoder.di.constructor.mapper.UserMapperImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> </li><li> <p>获取 service 操作delete 方法</p> <pre><code class="language-java">@Test
    public void testSetterSDi(){
        final ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("DiSetterBeans.xml");
        final IEmployeeService empService = (IEmployeeService) context.getBean("empService");
        empService.delete(2L);
    }</code></pre> </li></ul> 
<h4>4.6使用 setter 注入简单类型</h4> 
<ul><li> <p>修改 service 类，提供两个属性 int age = 18,String name = "sy"</p> <pre><code class="language-java">public class EmployeeServiceImpl implements IEmployeeService {
​
    private EmployeeMapper employeeMapper;
​
    private UserMapper userMapper;
    
    private String name;
    
    private int age;
    
    public void setName(String name){
        this.name = name;
    }
    public void setAge(int age){
        this.age = age;
    }
​
    public int delete(Long id) {
        System.out.println(name + ":" + age);
        userMapper.delete(id);
        return employeeMapper.delete(id);
    }
​
    public void setEmployeeMapper(EmployeeMapper employeeMapper){
        System.out.println("=======EmployeeMapper使用 setter 注入=======");
        this.employeeMapper = employeeMapper;
    }
​
    public void setUserMapper(UserMapper mapper){
        System.out.println("=======UserMapper使用 setter 注入=======");
        this.userMapper = mapper;
    }
}</code></pre> </li><li> <p>配置 xml 设置值</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;&lt;!--    配置mapper实现类--&gt;
&lt;!--    配置mapper--&gt;
    &lt;bean id="empMapper" class="cn.sycoder.di.setter.mapper.EmployeeMapperImpl"&gt;&lt;/bean&gt;
&lt;!--    配置service--&gt;
    &lt;bean id="empService" class="cn.sycoder.di.setter.service.impl.EmployeeServiceImpl"&gt;
        &lt;property name="employeeMapper" ref="empMapper"&gt;&lt;/property&gt;
        &lt;property name="userMapper" ref="userMapper"&gt;&lt;/property&gt;
        &lt;property name="name" value="sy"&gt;&lt;/property&gt;
        &lt;property name="age" value="18"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;!--    配置 userMapper--&gt;
    &lt;bean id="userMapper" class="cn.sycoder.di.constructor.mapper.UserMapperImpl"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> </li><li> <p>可能出现的问题</p> </li></ul> 
<p><img alt="" height="1002" src="https://images2.imgbox.com/83/d7/hKIKPWif_o.png" width="1200"></p> 
<h4>4.7setter 注入总结</h4> 
<ul><li>对于引用数据类型来说使用</li></ul> 
<pre><code class="language-XML">&lt;property name="" ref=""&gt;&lt;/property&gt;</code></pre> 
<p></p> 
<ul><li>对于简单数据类型</li></ul> 
<pre><code class="language-XML">*&lt;property name="" value=""&gt;&lt;/property&gt;</code></pre> 
<h3>5.集合注入</h3> 
<p>List，Set，Map，Array，Properties</p> 
<h4>5.1添加CollectiosDemo类</h4> 
<pre><code class="language-java">1.添加CollectiosDemo类1.添加CollectiosDemo类public class CollectionsDemo {
    private List&lt;Integer&gt; list;
    private Map&lt;String,String&gt; map;
    private Set&lt;String&gt; set;
    private Properties properties;
    private int[] arr;

    public void print(){
        System.out.println("list:"+list);
        System.out.println("map:"+map);
        System.out.println("set:"+set);
        System.out.println("properties:"+properties);
        System.out.println("arr:"+ Arrays.toString(arr));
    }

    public void setList(List&lt;Integer&gt; list) {
        this.list = list;
    }

    public void setMap(Map&lt;String, String&gt; map) {
        this.map = map;
    }

    public void setSet(Set&lt;String&gt; set) {
        this.set = set;
    }

    public void setProperties(Properties properties) {
        this.properties = properties;
    }

    public void setArr(int[] arr) {
        this.arr = arr;
    }
}</code></pre> 
<h4> 5.2配置 bean</h4> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
    &lt;bean id="collectionsDemo" class="cn.sycoder.collections.CollectionsDemo"&gt;
&lt;!--        注入 list--&gt;
        &lt;property name="list"&gt;
            &lt;list&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;value&gt;2&lt;/value&gt;
                &lt;value&gt;3&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
        &lt;property name="map"&gt;
            &lt;map&gt;
                &lt;entry key="name" value="sy"/&gt;
                &lt;entry key ="age" value="18"/&gt;
            &lt;/map&gt;
        &lt;/property&gt;
        &lt;property name="set"&gt;
            &lt;set&gt;
                &lt;value&gt;just some string&lt;/value&gt;
                &lt;value&gt;just string&lt;/value&gt;
            &lt;/set&gt;
        &lt;/property&gt;
        &lt;property name="properties"&gt;
            &lt;props&gt;
                &lt;prop key="url"&gt;@example.org&lt;/prop&gt;
                &lt;prop key="user"&gt;root&lt;/prop&gt;
                &lt;prop key="password"&gt;123456&lt;/prop&gt;
            &lt;/props&gt;
        &lt;/property&gt;
        &lt;property name="arr"&gt;
            &lt;array&gt;
                &lt;value&gt;2&lt;/value&gt;
                &lt;value&gt;2&lt;/value&gt;
                &lt;value&gt;2&lt;/value&gt;
            &lt;/array&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<p> 如果不提供setter 方法会出现如下错误</p> 
<p><img alt="" height="511" src="https://images2.imgbox.com/9c/b5/PguRvF2n_o.png" width="1200"></p> 
<h3>6.自动装配</h3> 
<h4>6.1概述</h4> 
<ul><li> <p>概述：IOC容器根据bean所依赖的属性，自动查找并进行自动装配。</p> </li></ul> 
<h4>6.2分类</h4> 
<ul><li> <p>不启用自动装配</p> </li><li> <p>byName 通过名称</p> </li><li> <p>byType 通过类型</p> </li><li> <p>constructor 通过构造器</p> </li></ul> 
<h4>6.3实操</h4> 
<ul><li> <p>准备工作</p> <pre><code class="language-java">public class EmployeeService {
    private EmployeeMapperImpl employeeMapper;
    public int delete(Long id) {
        return employeeMapper.delete(id);
    }
    public void setEmployeeMapper(EmployeeMapperImpl employeeMapper){
        System.out.println("=======EmployeeMapper使用 setter 注入=======");
        this.employeeMapper = employeeMapper;
    }
}
public class EmployeeMapperImpl{
    public int delete(Long id) {
        System.out.println("删除当前员工id:"+id);
        return 1;
    }
}</code></pre> </li><li> <p>配置 bean 并且通过 bype 自动装配</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
    &lt;bean id="empService" class="cn.sycoder.autowired.EmpService" autowire="byType"&gt;&lt;/bean&gt;
    &lt;bean id="empMapperImpl" class="cn.sycoder.autowired.EmpMapperImpl"&gt;&lt;/bean&gt;
​
&lt;/beans&gt;</code></pre> </li><li> <p>配置 bean 并且通过 byName 自动装配</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
    &lt;bean id="empService" class="cn.sycoder.autowired.EmpService" autowire="byName"&gt;&lt;/bean&gt;
    &lt;bean id="empMapperImpl" class="cn.sycoder.autowired.EmpMapperImpl"&gt;&lt;/bean&gt;
​
&lt;/beans&gt;</code></pre> </li><li> <p>通过名称和类型的自动装配</p> 
  <ul><li> <p>byName</p> 
    <ul><li> <p>使用 id 或者是 name 别名</p> </li><li> <p>如果自动注入时，有多个相同对象，只能使用 byName</p> </li></ul></li><li> <p>byType</p> 
    <ul><li> <p>根据类型注入</p> </li><li> <p>通过 byType 注入要保证容器中只有一个 bean 对象，否则会出现如下错误</p> </li></ul></li></ul></li></ul> 
<p><img alt="" height="980" src="https://images2.imgbox.com/04/9f/ccLAKdit_o.png" width="1200"></p> 
<ul><li>注意： 
  <ul><li> <p><strong>自动注入的优先级是低于 setter 和 构造器注入的</strong></p> </li><li> <p>自动注入只能用于引用类型，不能用于基本数据类型</p> </li><li> <p>推荐使用 byType 方式实现自动注入</p> </li><li> <p>注入流程</p> 
    <ul><li> <p>byType 根据 getClass 去注入</p> </li><li> <p>byName 根据属性名称去注入</p> </li></ul></li></ul></li></ul> 
<h3>7.bean scopes</h3> 
<ul><li>常见的作用域</li></ul> 
<table><thead><tr><th>作用域</th><th>说明</th></tr></thead><tbody><tr><td>singleton</td><td>单例的</td></tr><tr><td>prototype</td><td>多例</td></tr><tr><td>request</td><td>请求</td></tr><tr><td>session</td><td>会话</td></tr></tbody></table> 
<ul><li>单例 singleton</li></ul> 
<p><img alt="" height="995" src="https://images2.imgbox.com/62/35/7GjSjJUT_o.png" width="1200"></p> 
<ul><li>修改对象变成多个实例的 </li></ul> 
<p><img alt="" height="1101" src="https://images2.imgbox.com/77/af/e6n2Vsbr_o.png" width="1200"></p> 
<ul><li> <p>注意：容器模式就是以单例的方式创建对象的，如果需要修改成非单例，使用 scope 属性修改即可</p> </li><li> <p>以后开发中适合将那些bean对象交给 spring 管理</p> 
  <ul><li> <p>持久层 mapper</p> </li><li> <p>业务层 service</p> </li><li> <p>控制层 controller</p> </li></ul></li><li> <p>单例bean会出现线程安全吗</p> 
  <ul><li> <p>判断bean 对象是否存储数据，如果用来存储数据了，会导致线程安全问题</p> </li><li> <p>使用局部变量做存储，方法调用结束就销毁了，所以不存在线程安全问题</p> </li></ul></li></ul> 
<h3>8.bean 生命周期</h3> 
<h4>8.1概述</h4> 
<ul><li> <p>概述：生命周期就是一个对象从出生到死亡的过程</p> </li></ul> 
<h4>8.2使用用户类观察生命周期</h4> 
<ul><li> <p>创建用户类</p> <pre><code class="language-java">public class User {
    private String name;
    public User(){
        System.out.println("构造器执行====");
    }
​
    public void setName(String name) {
        System.out.println("调用 set 方法");
        this.name = name;
    }
    
    public void init(){
        System.out.println("调用 init 方法");
    }
    
    public void destroy(){
        System.out.println("调用销毁方法");
    }
}</code></pre> </li><li> <p>配置 bean</p> <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
    &lt;bean id="user" class="cn.sycoder.lifecycle.User" init-method="init" destroy-method="destroy"&gt;
        &lt;property name="name" value="sy"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre> </li><li> <p>获取 bean 出现如下问题，没有打印销毁方法</p> 
  <ul><li> <p>原因：</p> 
    <ul><li> <p>spring ioc 容器是运行在 jvm 虚拟机中的</p> </li><li> <p>执行 test 方法后 jvm 虚拟机开启，spring 加载配置文件创建 bean 对象，调用构造器以及 init 方法</p> </li><li> <p>test 方法执行完毕的时候， jvm 退出，spring ioc 容器来不及关闭销毁 bean，所以没有去调用 destroy 方法</p> </li></ul></li></ul></li></ul> 
<p><img alt="" height="903" src="https://images2.imgbox.com/40/d8/Znb2eV9J_o.png" width="1200"></p> 
<ul><li>解决办法，手动关闭容器</li></ul> 
<p><img alt="" height="1057" src="https://images2.imgbox.com/5b/7e/y61W3JK1_o.png" width="1200"></p> 
<h4>5.3BeanPostProcessor</h4> 
<ul><li>自定义自己 bean 处理器</li></ul> 
<pre><code class="language-java">public class MyBeanPostProcessor  implements BeanPostProcessor{
    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
        //bean 前置处理器
        System.out.println("bean 的前置处理器");
        return bean;
    }

    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
        System.out.println("bean 的后置处理器");
        //bean 后置处理器
        return bean;
    }
}</code></pre> 
<ul><li>配置 bean</li></ul> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
    &lt;bean id="user" class="cn.sycoder.lifecycle.User" init-method="init" destroy-method="destroy"&gt;
        &lt;property name="name" value="sy"&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;bean class="cn.sycoder.lifecycle.MyBeanPostProcessor"&gt;&lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<h4>5.4生命周期总结</h4> 
<ul><li> <p>bean 对象创建（调用无参构造器）</p> </li><li> <p>设置属性通过 setter 方法</p> </li><li> <p>init 方法前调用 bean 的前置处理器</p> </li><li> <p>bean 的 init 方法</p> </li><li> <p>bean 的后置处理器</p> </li><li> <p>对象可以正常使用</p> </li><li> <p>destroy 销毁方法</p> </li><li> <p>ioc 容器关闭</p> </li><li> <p>jvm 虚拟机的退出</p> </li></ul> 
<h2>四、容器执行点（第三方注入）</h2> 
<h3>1.整合 druid 连接池</h3> 
<p>添加依赖</p> 
<pre><code class="language-XML">&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;druid&lt;/artifactId&gt;
    &lt;version&gt;1.2.8&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<h4>1.1硬编码方式整合</h4> 
<p>新建德鲁伊配置</p> 
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
    &lt;bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource"&gt;
        &lt;property name="username" value="root"&gt;&lt;/property&gt;
        &lt;property name="password" value="123456"&gt;&lt;/property&gt;
        &lt;property name="driverClassName" value="com.mysql.cj.jdbc.Driver"&gt;&lt;/property&gt;
        &lt;property name="url" value="jdbc:mysql://localhost:3306/mybatis"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre> 
<p><span style="color:#fe2c24;"><strong>注意：属性是通过 set 方法注入进来的</strong></span></p> 
<h4><span style="color:#0d0016;">1.2使用占位符获取连接数据</span></h4> 
<ul><li><span style="color:#0d0016;">建立 db.properties 配置文件</span></li></ul> 
<pre><code class="language-XML">username=root
password=123456
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql://localhost:3306/mybatis</code></pre> 
<ul><li>配置引用db.properties</li></ul> 
<pre><code class="language-XML"> &lt;bean id="dataSource1" class="com.alibaba.druid.pool.DruidDataSource"&gt;
        &lt;property name="username" value="${username}"&gt;&lt;/property&gt;
        &lt;property name="password" value="${password}"&gt;&lt;/property&gt;
        &lt;property name="driverClassName" value="${driverClassName}"&gt;&lt;/property&gt;
        &lt;property name="url" value="${url}"&gt;&lt;/property&gt;
    &lt;/bean&gt;
&lt;!--    获取db.properties 配置文件--&gt;
    &lt;bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
        &lt;property name="location" value="db.properties"&gt;&lt;/property&gt;
    &lt;/bean&gt;</code></pre> 
<ul><li>引入 db.properties 缩写</li></ul> 
<pre><code class="language-XML">&lt;context:property-placeholder location="db.properties"/&gt;</code></pre> 
<h4>1.3注意事项</h4> 
<ul><li> <p>&lt;context:property-placeholder location="db.properties"/&gt; 使用这个标签加载配置会加载到电脑系统配置</p> </li><li>解决方式 
  <ul><li>给配置文件加上前缀变量</li></ul></li></ul> 
<pre><code class="language-XML">jdbc.username=root
jdbc.password=123456
jdbc.driverClassName=com.mysql.cj.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/mybatis
username=123</code></pre> 
<ul><li>添加属性</li></ul> 
<pre><code class="language-XML">&lt;context:property-placeholder system-properties-mode="NEVER" location="db.properties"/&gt;</code></pre> 
<ul><li>加载多个配置文件可以用 * 代替</li></ul> 
<pre><code class="language-XML">&lt;context:property-placeholder system-properties-mode="NEVER" location="*.properties"/&gt;</code></pre> 
<h3>2.容器总结</h3> 
<h4>2.1容器层级结构</h4> 
<ul><li>按两次 shift 搜索 BeanFactory</li></ul> 
<p><img alt="" height="362" src="https://images2.imgbox.com/d1/92/mM5xcfeE_o.png" width="1141"></p> 
<ul><li>按 ctrl + h 查看继承结构 </li></ul> 
<p><img alt="" height="778" src="https://images2.imgbox.com/38/54/p2I3pkqD_o.png" width="1200"></p> 
<h4>2.2创建容器 </h4> 
<ul><li> <p>BeanFactory 是容器顶层接口</p> </li><li> <p>ApplicationContext 核心接口</p> </li><li> <p>AbstractApplicationContext 抽象类，提供了获取 bean 以及加载资源的功能</p> </li><li> <p><strong>ClassPathXmlApplicationContext</strong> 装载bean的，做初始化的</p> </li></ul> 
<h4>2.3bean 配置</h4> 
<pre><code class="language-XML">&lt;bean id="user" class="cn.sycoder.lifecycle.User" init-method="init" destroy-method="destroy" scope="默认单例" autowire="byName" lazy-init="false"&gt;
    &lt;property name="name" value="sy"&gt;&lt;/property&gt;
&lt;/bean&gt;</code></pre> 
<ul><li> <p>lazy-init:如果开启懒加载，默认是调用时才创建bean</p> </li><li> <p>init-method:初始化方法</p> </li><li> <p>destroy-method:销毁方法</p> </li><li> <p>scope:作用域，单例，原型</p> </li><li> <p>autowire：自动注入</p> </li><li> <p>id:代表名称，必须唯一</p> </li><li> <p>class:全限定类名</p> </li></ul> 
<h4>2.4di 注入</h4> 
<ul><li>constructor-arg：构造器注入 </li><li>property : setter 注入</li><li>集合注入</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c353d7a4b4a7a8809a54a6fb7cc5db2c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">软件测试 | websocket接口测试</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7c8bc71d6964cbc65a34563cd1d2058c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">开源鸿蒙南向嵌入学习笔记——NAPI框架学习（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>