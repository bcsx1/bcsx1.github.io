<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL数据库基础语句 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL数据库基础语句" />
<meta property="og:description" content="插入语句（增） 插入语句基本语法：insert into 表名（列名，列名） values（值，值） 2、插入多行数据（在此语句中不能使用default默认关键字）：
insert into 表名（列名） select 列名对应的数值
union
select 列名对应的数值
例：insert A (ID,name,sex) select 1,’闪闪&#39;,’女’ union
select 2,’珊珊&#39;,’女’ union
select 3,’潸潸&#39;,’女’ union
select 4,’讪讪&#39;,’女’ 把查询结果放到一个新表中：select......into （例-将旧表中，女生的信息插入到新表中：select * into新表 from旧表 where sex=‘女’）
（注：使用select......into......语句向表中添加数据时，这个表必须是原数据库中不存在的新表，否则会出现错误）
删除语句（删） 删除语句基本语法：delete from 表名 where 判断条件 删除表中所有数据： (1) delete from 表名 DELETE语句删除的是一整行数据，而不是删除某列数据，因此DELETE关键字和FROM关键字之间不能放列名
(2) truncate table 表名
执行速度更快，使用的系统资源和事务日志更少；有外键约束的数据表不能使用 truncate table
删除表：drop table 表名 更新语句（改） 更新语句基本语法：update 表名 set 列名=值 where 判断条件
在使用update修改数据时一定要注意where语句约束修改范围，当where子句省略时，则修改表中的所有行。
例：将A表中ID为1的记录的姓名改为“潸潸”—update A set name=’潸潸’ where ID=1" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2f9bf771f6945bc0c9d16527e27fc113/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-13T18:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-13T18:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL数据库基础语句</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:justify;"></p> 
<ul><li style="text-align:justify;"> <h4><a name="_Toc25849680"> 插入语句（增）</a></h4> </li></ul> 
<ol><li style="text-align:justify;">插入语句<strong><span style="color:#ff0000;">基本语法</span></strong>：insert into 表名（列名，列名） values（值，值）</li></ol> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">2、<strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">插入多行数据</span></span></strong>（<span style="color:#00b050;">在此语句中不能使用default默认关键字</span>）：</p> 
<p style="margin-left:0;text-align:justify;">insert into 表名（列名） select 列名对应的数值</p> 
<p style="margin-left:0;text-align:justify;">union</p> 
<p style="margin-left:0;text-align:justify;">select 列名对应的数值</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong><span style="color:#000000;">insert A (ID,name,sex) select  1,’</span><span style="color:#000000;">闪闪',’女’ union</span></p> 
<p style="margin-left:0;text-align:justify;">                                          <span style="color:#000000;">select  2,’</span><span style="color:#000000;">珊珊',’女’ union</span></p> 
<p style="margin-left:0;text-align:justify;">                                          <span style="color:#000000;">select  3,’</span><span style="color:#000000;">潸潸',’女’ union</span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#000000;">                                         select  4,’</span><span style="color:#000000;">讪讪',’女’ </span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<ol><li style="text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">把查询结果放到一个新表中</span></span>：select......into</li></ol> 
<p style="margin-left:0;text-align:justify;">（<span style="color:#00b050;">例</span>-将旧表中，女生的信息插入到新表中：select * into新表 from旧表 where sex=‘女’）</p> 
<p style="margin-left:0;text-align:justify;">（<strong><span style="color:#ff0000;">注：</span></strong>使用select......into......语句向表中添加数据时，这个表<span style="color:#ff0000;">必须是原数据库中不存在的新表</span>，否则会出现错误）</p> 
<ul><li style="text-align:justify;"> <h4><a name="_Toc25849681"> 删除语句（删）</a></h4> </li></ul> 
<ol><li style="text-align:justify;">删除语句<strong><span style="color:#ff0000;">基本语法</span></strong>：delete from 表名 where 判断条件</li></ol> 
<p style="margin-left:0;text-align:justify;"></p> 
<ol><li style="text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">删除表中所有数据</span></span>：</li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">(1) delete from </span><span style="color:#ff0000;">表名</span> </strong></p> 
<p style="margin-left:0;text-align:justify;">DELETE语句删除的是一整行数据，而不是删除某列数据，因此DELETE关键字和FROM关键字之间不能放列名</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">(2) truncate table </span><span style="color:#ff0000;">表名</span></strong></p> 
<p style="margin-left:0;text-align:justify;">执行速度更快，使用的系统资源和事务日志更少；<span style="background-color:#ffff00;"><span style="color:#00b050;">有外键约束的数据表不能使用 truncate table</span></span></p> 
<ol><li style="text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">删除表</span></span>：drop table 表名</li></ol> 
<ul><li style="text-align:justify;"> <h4><a name="_Toc25849682"> 更新语句（改）</a></h4> </li></ul> 
<p style="margin-left:0;text-align:justify;">更新语句<strong><span style="color:#ff0000;">基本语法</span></strong>：update 表名 set 列名=值 where 判断条件</p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;">在使用update修改数据时一定要注意where语句约束修改范围，<span style="color:#ff0000;">当where子句省略时，则修改表中的所有行。</span></span></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>将A表中ID为1的记录的姓名改为“潸潸”—update A set name=’潸潸’ where ID=1</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">注：</span></strong>如果想<span style="color:#ff0000;">修改数据表中多列的数据</span>，可以<span style="color:#ff0000;">在set子句后面跟随多个列名以及更新值，中间用逗号隔开</span></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>update A set name=”讪讪”，sex=’男’ where ID=1</p> 
<ul><li style="text-align:justify;"> <h4><a name="_Toc25849683"> 查询语句（查）</a></h4> </li></ul> 
<ol><li style="text-align:justify;"> <h5><a name="_Toc25849684"> 基本查询</a></h5> </li></ol> 
<p style="margin-left:0;text-align:justify;">查询语句<strong><span style="color:#ff0000;">基本语法</span></strong>：select * from 表名 where 判断条件              </p> 
<ul><li style="text-align:justify;">若要从一个数据库表中选取全部字段作为SELECT查询的输出字段，在SELECT 子句中使用一个“*”符号就OK，此时还必须用FROM子句来指定作为查询的数据源（表或视图）</li><li style="text-align:justify;">可以在SELECT 子句中给出包含所选取字段的一个列表，各个字段之间用逗号分隔，选择部分列并指定它们的显示次序。<span style="color:#ff0000;">查询结果集合中数据的排列顺序与选择列表中所指定的列名排列顺序相同。</span></li><li style="text-align:justify;">在字段列表前面加上选择关键字<strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">DISTINCT</span></span></strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">可以消除查询结果中的重复记录</span></span><span style="color:#000000;">-select distinct ID from A</span></li></ul> 
<ol><li style="text-align:justify;"> <h5><a name="_Toc25849685"> 设置字段别名</a></h5> </li></ol> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849686"> 设置字段别名</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;">显示选择查询的结果时，表头（第一行）中显示的是各个输出字段的名称，为方便可指定更易理解的字段名来取代原来的字段名。语法格式如下：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">原字段名 AS 字段别名</span></strong>             ——select ID as 学号from A</li><li style="text-align:justify;"><strong><span style="color:#ff0000;">字段别名 = 原字段名        </span></strong>       ——select 学号=ID from A</li><li style="text-align:justify;"><strong><span style="color:#ff0000;">原字段名 空格 字段别名   </span></strong>       ——select ID 学号 from A</li></ol> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849687"> 字段别名</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;">使用<strong><span style="color:#ff0000;">“性别-学员姓名”</span></strong>格式查看数据：</span></p> 
<p style="margin-left:0;text-align:justify;">Select<strong><span style="color:#00b050;"> <span style="background-color:#ffff00;">Sex + ’-' + Name</span> </span></strong>as ‘性别-学员姓名’ from A</p> 
<ol><li style="text-align:justify;"> <h5><a name="_Toc25849688"> 运算符</a></h5> </li></ol> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849689"> 范围运算符</a></h6> </li></ol> 
<table border="1" cellspacing="0" style="margin-left:21pt;"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;">范围运算符（表达式值是否在指定的范围）</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">BETWEEN ... AND ...</span></strong></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">NOT BETWEEN ...AND ...</span></strong></li></ol></td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询A表中学号在/不在2-4之间的学员信息—select * from A where StuID between/not between 2 and 4</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849690"> 列表运算符</a></h6> </li></ol> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;">列表运算符（判断表达式是否为列表中的指定项）</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">IN(</span><span style="color:#ff0000;">项1，项2......)  </span><span style="color:#00b050;"> (IN</span><span style="color:#00b050;">关键字可以选择与列表中的任意值匹配的行)</span></strong></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">NOT IN(</span><span style="color:#ff0000;">项1，项2......)</span></strong></li></ol></td></tr></tbody></table> 
<p style="margin-left:0px;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询A表中学号为/不为1、3、5的学员信息—select * from A where StuID in/not in(1,3,5)</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849691"> 空值判断符</a></h6> </li></ol> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;">空值判断符（判断表达式是否为空）</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">IS NULL</span></strong></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">IS NOT NULL</span></strong></li></ol></td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询A表中ID为空的学生姓名—select name from A where ID is null</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849692"> 逻辑运算符</a></h6> </li></ol> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;">逻辑运算符（用于多条件的逻辑连接）</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">NOT</span></strong><span style="color:#00b050;">-</span><span style="color:#00b050;">逻辑与</span></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">AND</span></strong><span style="color:#00b050;">-</span><span style="color:#00b050;">逻辑或</span></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">OR</span></strong><span style="color:#00b050;">-</span><span style="color:#00b050;">逻辑非</span></li></ol></td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">逻辑运算符一般用来连接条件表达式。AND连接条件表达式，<span style="background-color:#ffff00;"><span style="color:#ff0000;">当两个条件都满足时才返回真</span></span>。OR连接条件表达式，<span style="background-color:#ffff00;"><span style="color:#ff0000;">只要其中一个条件满足就返回真</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询A表中学员为1的学员的Java成绩—select * from A where StuID=1 and Subject=’Java’</p> 
<p style="margin-left:0;text-align:justify;">查询A表中学号为1、3、5的学员信息—select * from A where StuID=1 or StuID=3 or StuID=5</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849693"> 比较运算符</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;">比较运算符（大小比较，包括&gt;、&gt;=、=、&lt;、&lt;=、&lt;&gt;、!&gt;、!&lt;）</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">比较运算符</p> </td><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">含义</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">=</span></strong></p> </td><td style="vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">等于</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">&gt; / &lt;</span></strong></p> </td><td style="vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">大于 / 小于</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">&gt;= / &lt;=</span></strong></p> </td><td style="vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">大于或等于 / 小于或等于</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">&lt;&gt;</span></strong></p> </td><td style="vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">不等于</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">!</span></strong></p> </td><td style="vertical-align:top;width:138.25pt;"> <p style="margin-left:0;text-align:center;">非</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询A表中除“潸潸”以外的所有的学员信息—select * from A where name&lt;&gt;’潸潸’</p> 
<ol><li style="text-align:justify;"> <h5><a name="_Toc25849694"> 模糊查询</a></h5> </li></ol> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;">模式匹配符（判断值是否与指定的字符通配格式相符）</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">LIKE</span></strong></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><strong><span style="color:#ff0000;">NOT LIKE</span></strong></li></ol></td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"><span style="color:#ff0000;">LIKE</span><span style="color:#ff0000;">关键字搜索与指定模式匹配的字符串、日期或时间值</span>。匹配方式可包含4种通配符的任意组合</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;">通配符               含义</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">%</span></strong>                 包含零个或更多字符的任意字符串</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">-</span></strong>                 任何单个字符</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">[ ]</span></strong>                指定范围（如[a-f]）或集合（[abcdef]或[1,3,5,7,9]）内的任何单个字符</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">[^]</span></strong>              不在指定范围（如[^a-f]）或集合（如[^abcdef]）内的任何单个字符</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;">（<strong><span style="color:#00b050;">注：</span></strong><span style="color:#00b050;">在使用时，通配符和字符要用单引号引起来</span>）</span></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">例 </span></strong>：查询姓氏为张的学生信息—Select * from 表名 where 姓名 like ‘张%’         </p> 
<p style="margin-left:0;text-align:justify;">     LIKE ‘%gon’—搜索以字母gon结尾的所有字符串（如G-Dragon 或Martagon）</p> 
<p style="margin-left:0;text-align:justify;">         LIKE ‘_heryl’—搜索以字母heryl结尾的所有6个字母的字符串（如Cheryl和 Sheryl）</p> 
<p style="margin-left:0;text-align:justify;">     LIKE ‘[M~Z]inger’—搜索以字母inger结尾，以M~Z中的任何单个字母开头的所有字符串（如Ringer）</p> 
<p style="margin-left:0;text-align:justify;">     LIKE ‘S[^C]%’— 搜索以字母S开头，并且第二个字母不是C的所有字符串（如 Strawberry）</p> 
<ol><li style="text-align:justify;"> <h5><a name="_Toc25849695"> 排序</a></h5> </li></ol> 
<p style="margin-left:0;text-align:justify;">当要对查询结果进行排序时需要在select语句中加 <strong><span style="color:#ff0000;">ORDER BY</span></strong>子句。（在order by子句中可以使用一个或多个排序要求，<span style="background-color:#ffff00;"><span style="color:#00b050;">优先级次序从左到右</span></span>）</p> 
<p style="margin-left:0;text-align:justify;">排序的方向可以是升序或降序。<span style="background-color:#ffff00;"><span style="color:#ff0000;">ASC-</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">递增顺序</span></span>和<span style="background-color:#ffff00;"><span style="color:#ff0000;">DESC-</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">递减顺序</span></span>用于指定排序方向。<span style="color:#00b050;">默认的排序方向为递增顺序。空值（NULL）将被处理为最小值。</span></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">语法</span></strong>：order by 列名 desc/asc</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>针对学生年龄进行降序排序—Select * from 表名 order by 年龄 desc</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">ORDER BY</span></strong><strong><span style="color:#ff0000;">子句与TOP关键字连用</span></strong>-可通过order by 与top 关键字搭配使用来选取按照排序之后查询结果中前若干行或前百分比的数据（<strong><span style="color:#ff0000;">PS</span><span style="color:#ff0000;">：</span><span style="color:#00b050;">TOP</span><span style="color:#00b050;">：</span></strong>如果在字段列表前面使用<strong><span style="color:#ff0000;">TOP n percent</span></strong>，则在查询结果中显示前面占总记录数的百分比为n% 的记录）</p> 
<p style="margin-left:0px;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询学号为前三名的学生信息—Select top 3 * from 表名 order by 学号</p> 
<ol><li style="text-align:justify;"> <h5><a name="_Toc25849696"> 聚合函数</a></h5> </li></ol> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849697"> 求和函数-SUM-使用SUM函数计算字段的累加和</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">SUM</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数用于统计数值型字段的总和，只能用于数值型字段，而且NULL值将被忽略</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">例：查询学生成绩的总和—Select sum（成绩） from 表名</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849698"> 平均函数-AVG-使用AVG函数计算字段的平均值</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">AVG</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数用于计算一个数值型字段的平均值，该字段中的NULL值在计算过程中将被忽略</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#00b050;">例</span>：查询所有学生的平均成绩—Select avg(成绩) from 表名</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849699"> 最大/小值-MAX、MIN-计算字段的最大值和最小值</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">MAX</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数用于返回表达式中的最大值，MIN函数则用于返回表达式中的最小值，计算过程中遇到NULL值时予以忽略</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#00b050;">例：</span>查询学生成绩当中的最大值—Select max(成绩) from 表名</p> 
<p style="margin-left:0;text-align:justify;">查询学生成绩当中的最小值—Select min(成绩) from 表名</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849701"></a><a name="_Toc25849700"> 计数函数-COUNT-使用COUNT函数统计记录行数</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">COUNT</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数用于统计字段中选取的项数或查询输出记录行数。（统计记录的条数）</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询总共有多少个学生—Select count(*) from 表名</p> 
<ol><li style="text-align:justify;"> <h5>分组</h5> </li></ol> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849702"> GROUP BY 子句</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;">Group by子句指定将结果集内的记录分成若干个组来输出，每个组中的记录在指定的字段中具有相同的值。</p> 
<p style="margin-left:0;text-align:justify;">在一个查询语句中，可以使用任意多个字段对结果集内的记录进行分组，<span style="background-color:#ffff00;"><span style="color:#ff0000;">字段列表中的每个输出字段必须在group by子句中出现或者用在某个聚合函数中。</span></span></p> 
<p style="margin-left:0;text-align:justify;">使用 group by 子句时，如果<span style="background-color:#ffff00;"><span style="color:#00b050;">在select 子句的字段列表中包含有聚合函数，则针对每个组计算出一个汇总值</span></span>，从而实现对查询结果的分组统计</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询每一个学生的总成绩—Select sum(成绩) from 表名 group by 学号</p> 
<p style="margin-left:0;text-align:justify;">    分别统计参加每个科目考试的人数—select Subject AS 科目，COUNT（*）AS人数 from A group by Subject</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">(<strong><span style="color:#ff0000;">注</span></strong>：当指定group by时，<span style="color:#00b050;">字段列表中任一非聚合表达式内的所有字段都应包含在group by</span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#00b050;">列表中</span>，或者group by表达式必须与字段列表表达式完全匹配)</p> 
<p style="margin-left:0;text-align:justify;">（<strong><span style="color:#ff0000;">注</span></strong>：分组表达式是执行分组时所依据的一个表达式，通常是一个字段名。在字段列表中指定的字段别名不能作为分组表达式来使用。另外<span style="color:#00b050;">，<strong>text、ntext、image</strong>以及<strong>bit</strong>数据类型的字段也不能在分组表达式中</span>）</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">综合： group by 、order by、 top三者连用</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>求出总成绩的前三名</p> 
<p style="margin-left:0;text-align:justify;">Select top 3 * sum(成绩) 总成绩 from 表名 group by 学号 order by 总成绩 desc</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849703"> HAVING 子句</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;">Having子句用于指定组或聚合的搜索条件，该子句<span style="background-color:#ffff00;"><span style="color:#ff0000;">通常与group by子句一起使用</span></span>。如果不使用group by子句，则having子句的行为与where子句一样。所不同的是：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<table border="1" cellspacing="0"><tbody><tr><td rowspan="2" style="border-color:#000000;vertical-align:top;width:99pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">WHERE</span></strong></p> </td><td style="border-color:#000000;vertical-align:top;width:315.8pt;"> <p style="margin-left:0;text-align:justify;">1、where子句搜索条件在进行分组<strong><span style="color:#00b050;">操作之前</span></strong>应用</p> </td></tr><tr><td style="vertical-align:top;width:315.8pt;"> <p style="margin-left:0;text-align:justify;">2、where对<strong><span style="color:#00b050;">原始数据</span></strong>进行条件筛选</p> </td></tr><tr><td rowspan="3" style="border-color:#000000;vertical-align:top;width:99pt;"> <p style="margin-left:0;text-align:center;"></p> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">HAVING</span></strong></p> </td><td style="vertical-align:top;width:315.8pt;"> <p style="margin-left:0;text-align:justify;">1、having搜索条件在进行分组<strong><span style="color:#00b050;">操作之后</span></strong>应用</p> </td></tr><tr><td style="vertical-align:top;width:315.8pt;"> <p style="margin-left:0;text-align:justify;">2、可以包含聚合函数</p> </td></tr><tr><td style="vertical-align:top;width:315.8pt;"> <p style="margin-left:0;text-align:justify;">3、Having子句可以引用字段表中出现的任意项，是对<strong><span style="color:#00b050;">运算聚合</span></strong>后的数据进行条件筛选</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>统计平均分大于75分的科目—select subject AS 科目,AVG(score) AS 平均分数 from A group by subject having AVG(score)&gt;75</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">综合： group by 、order by、 top、having连用</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>求出学生平均成绩大于75分的前三名的学生——</p> 
<p style="margin-left:0;text-align:justify;">Seslect top 3 *,avg(成绩)  平均成绩 from 表名 group by 学号 having avg(成绩)&gt;75</p> 
<p style="margin-left:0;text-align:justify;">Order by 平均成绩 desc</p> 
<ul><li style="text-align:justify;"> <h5><a name="_Toc25849704"> 联接查询</a></h5> </li></ul> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849705"> <span style="color:#ff0000;">内部联接查询</span></a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;">内部联接是联接类型中最普通的一种。内部联接根据一个或几个相同的字段将记录匹配在一起，<span style="background-color:#ffff00;"><span style="color:#ff0000;">但是内部联接仅仅返回那些存在字段匹配的记录</span></span>。使用内部联接时，如果两个来源表的相关字段满足联接条件，则从这两个表中提取数据并组合成新的记录。</p> 
<p style="margin-left:0;text-align:justify;">语法格式：</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffff00;"><span style="color:#00b050;">Select </span></span><span style="background-color:#ffff00;"><span style="color:#00b050;">字段列表 from 表1 INNER JOIN 表2 ON 条件表达式</span></span></strong></p> 
<p style="margin-left:0;text-align:justify;">（其中<strong><span style="color:#ff0000;">‘表1’和‘表2‘</span></strong>为要从其中组合记录的表名称；<strong><span style="color:#ff0000;">&lt;</span><span style="color:#ff0000;">条件表达式&gt;</span></strong>用于指定两个表的联接条件，由两个表中的字段名称和关系比较运算符组成）</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>将A表与B表联接，查询考试分数大于或等于88分的学员信息并显示相关科目和分数</p> 
<p style="margin-left:0;text-align:justify;">Select<span style="color:#00b050;"> <strong>A.ID, A.Name, A.Sex, B.Subject, B.Score </strong></span>from A inner join B on A.ID=B.ID where <strong><span style="color:#00b050;">B.Score</span></strong>&gt;=88</p> 
<p style="margin-left:0;text-align:justify;">或</p> 
<p style="margin-left:0;text-align:justify;">Select <strong><span style="color:#00b050;">A.ID, Name, Sex, Subject, Score</span></strong> from A inner join B on A.ID=B.ID where <strong><span style="color:#00b050;">Score</span></strong>&gt;=88</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">表A与表B都包含了ID字段，如果在SQL语句中不具体地指明来自哪个表，则SQL Server也不知道该对哪一个ID进行计算。因此，<span style="background-color:#ffff00;"><span style="color:#ff0000;">当返回列的名称在联接结果中存在多次时，必须完全确定列的名称</span></span>。可通过两种方法中的任一种来确定列名：</p> 
<ol><li style="text-align:justify;">提供选择列所在表的表名，接着是一个点号（.）和列名<span style="color:#ff0000;">-(</span><span style="color:#ff0000;">表.列名)</span></li><li style="text-align:justify;">为表提供一个别名，接着是一个点号（.）和列名<span style="color:#ff0000;">-(</span><span style="color:#ff0000;">别名.列名)</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>select A.ID, A.Name, A.Sex, B.Subject, B.Score from<strong><span style="color:#00b050;"> StuInfo A </span></strong>inner join <strong><span style="color:#00b050;">StuMarks B</span></strong> on A.ID=B.ID where B.Score&gt;=88</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">INNER JOIN</span></strong><strong><span style="color:#ff0000;">— 类似WHERE子句</span></strong></p> 
<p style="margin-left:0;text-align:justify;">所有的内部联接都会返回联接之后匹配的记录，这个特点与where子句相似，因为where子句也只返回满足规定标准的记录。上述的例子也可使用where子句来实现：</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>select A.ID, A.Name, A.Sex, B.Subject, B.Score<strong><span style="color:#00b050;"> from StuInfo A, StuMarks B where A.ID=B.ID and B.Score&gt;=88</span></strong></p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849706"> <span style="color:#ff0000;">外部联接查询</span></a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;">与内部联接(INNER JOIN)相对的方式称为外部联接(OUTER JOIN)。在外部联接中，参与联接的表有主从之分，以主表的每行数据去匹配从表的数据列，符合联接条件的数据将直接返回到结果集中<span style="color:#ff0000;">，那些不符合联接条件的列，将被填上NULL值后再返回到结果集中（BIT类型的数据，将被填上0）</span></p> 
<p style="margin-left:0;text-align:justify;">外部联接分为左外部联接(LEFT OUTER JOIN)和右外部联接(RIGHT OUTER JOIN)两种。<span style="background-color:#ffff00;"><span style="color:#ff0000;">以主表所在的方向区分外部联接，主表在JOIN的左边，则称为左外部联接，主表在JOIN 的右边，则称为右外部联接。</span></span></p> 
<p style="margin-left:0;text-align:justify;">语法格式：</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffff00;"><span style="color:#00b050;">Select </span></span><span style="background-color:#ffff00;"><span style="color:#00b050;">字段列表 from 表1 &lt;LEFT/RIGHT&gt; [OUTER] JOIN 表2 on 条件表达式</span></span></strong></p> 
<p style="margin-left:0;text-align:justify;">（<strong><span style="color:#ff0000;">注：</span></strong>OUTER关键字为可选项，只需使用LEFT或RIGHT关键字-如LEFT JOIN）</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<table border="1" cellspacing="0" style="width:432.1pt;"><tbody><tr><td colspan="2" style="border-color:#000000;vertical-align:top;width:432.1pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">内部联接、外部联接区别</span></strong></p> </td></tr><tr><td rowspan="2" style="border-color:#000000;vertical-align:top;width:136.7pt;"> <p style="margin-left:0;text-align:center;">内部联接</p> </td><td style="vertical-align:top;width:295.4pt;"> <p style="margin-left:0;text-align:justify;">1、无法满足联接条件的数据即被丢弃</p> </td></tr><tr><td style="vertical-align:top;width:295.4pt;"> <p style="margin-left:0;text-align:justify;">2、参与联接的表的地位是平等的</p> </td></tr><tr><td rowspan="2" style="border-color:#000000;vertical-align:top;width:136.7pt;"> <p style="margin-left:0;text-align:center;">外部联接</p> </td><td style="vertical-align:top;width:295.4pt;"> <p style="margin-left:0;text-align:justify;">1、不符合联接条件的列，将被填上NULL值后再返回到结果集</p> </td></tr><tr><td style="vertical-align:top;width:295.4pt;"> <p style="margin-left:0;text-align:justify;">2、参与联接的表有主从之分</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">在学生信息表中插入一个新同学“扇扇”，他没有参加考试，所以学生成绩表中没有这个同学的信息，现在需要查询所有同学的成绩，就算没有参加考试，也必须显示每个学生的名字</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>select A.ID, A.Name, A.Sex, B.Subject, B.Score from StuInfo A left outer join StuMarks B on A.ID=B.ID   <span style="color:#00b050;">——左外联接</span></p> 
<p style="margin-left:0;text-align:justify;">内部联接，寻找的是与“条件表达式”匹配的数据，而“扇扇”的信息仅仅只在学生信息表中存在，因而无法与成绩表中的任何记录匹配。</p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#ff0000;">外部联接中有一个表是主表，另一个表的记录会根据“条件表达式”与主表的记录匹配，如果没有与主表相匹配的记录，则会显示NULL</span>。要求每个学员的信息必须显示，无论考试成绩存不存在，只需使用外部联接，并将学生信息表作为主表即可实现。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">左外联接与右外联接的区别仅仅只是写法不同而已，上述左外联接也可写成如下右外联接：</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>select A.ID, A.Name, A.Sex, B.Subject, B.Score from StuMarks B right outer join StuInfo A on A.ID=B.ID   <span style="color:#00b050;">——右外联接</span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<ul><li style="text-align:justify;"> <h5><a name="_Toc25849707"> 子查询</a></h5> </li></ul> 
<p style="margin-left:0;text-align:justify;">子查询是一个<strong><span style="color:#ff0000;">嵌套在SELECT、INSERT、UPDATE或DELETE语句或其他子查询</span></strong>中的查询。<span style="background-color:#ffff00;"><span style="color:#ff0000;">任何允许使用表达式的地方都可以使用子查询</span></span>。子查询也称为内部查询或内部选择，而包含子查询的语句也称为外部查询或外部选择。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong> <span style="color:#00b050;">例：</span></strong>查询“潸潸”同学的分数大于80分的考试成绩记录</p> 
<p style="margin-left:0;text-align:justify;">Select Name,Subject,Score from StuInfo A,StuMarks B where A.ID=B.ID and A.Name=’潸潸’ and B.Score&gt;80   <span style="color:#00b050;">——之前所学知识</span></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffff00;"><span style="color:#00b050;">子查询思路：</span></span></strong></p> 
<ol><li style="text-align:justify;">找到分数大于80分的学员</li></ol> 
<p style="margin-left:0;text-align:justify;">Select * from StuMarks where Score &gt;80</p> 
<ol><li style="text-align:justify;">连表，将找到的这些学员的分数与姓名部分连接起来</li></ol> 
<p style="margin-left:0;text-align:justify;">Select Name,Subject,Score from StuInfo A,( Select * from StuMarks where Score &gt;80) B <strong><span style="color:#00b050;">where A.ID=B.ID </span></strong></p> 
<ol><li style="text-align:justify;">根据姓名查找到以选出的数据中“潸潸”的成绩</li></ol> 
<p style="margin-left:0;text-align:justify;">Select Name,Subject,Score from StuInfo A,( Select * from StuMarks where Score &gt;80) B where A.ID=B.ID <strong><span style="color:#00b050;">and A.Name=’</span></strong><strong><span style="color:#00b050;">潸潸’</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#00b050;">——在小括号中的查询被称为子查询或内部查询，包含这个查询的查询语句为外部查询</span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:justify;"><strong><span style="color:#ff0000;">子查询的特点和优势：</span></strong></p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><span style="color:#000000;">使用灵活，可以成为SQL语句的多个部分</span></li></ol></td></tr><tr><td style="border-color:#000000;vertical-align:top;width:414.8pt;"> 
    <ol><li style="text-align:justify;"><span style="color:#000000;">降低SQL语句的复杂度，提高SQL语句的可读性</span></li></ol></td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p> 
<ul><li style="text-align:justify;"><strong><span style="color:#ff0000;">子查询作为查询条件使用</span></strong></li></ul> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询学号在“讪讪“同学前面的学员信息</p> 
<p style="margin-left:0;text-align:justify;">Select * from A where ID &lt; (select ID from A where Name=’讪讪’)</p> 
<p style="margin-left:0;text-align:justify;">思路：</p> 
<p style="margin-left:0;text-align:justify;">通过子查询找到“讪讪”学号，然后将子查询的结果作为where子句的 ‘&lt;’ 后面的部分</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">注：</span></span></strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">在查询条件中使用‘&lt;’ ‘&gt;’ ‘=’ 符号后的子查询的结果只能有一个值</span></span></p> 
<ul><li style="text-align:justify;"><strong><span style="color:#ff0000;">子查询作为临时表使用</span></strong></li></ul> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询所有学员的“HTML”成绩，如果没有成绩显示成“NULL”</p> 
<p style="margin-left:0;text-align:justify;">Select A.*,B.Score from StuInfo A left outer join (select * from StuMarks where Subject =’HTML’) B on A.ID=B.ID</p> 
<ul><li style="text-align:justify;"><strong><span style="color:#ff0000;">子查询作为列使用</span></strong></li></ul> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询所有学员的“HTML”成绩，如果没有成绩显示成“NULL”</p> 
<p style="margin-left:0;text-align:justify;">Select A.*,(select Score from StuMarks B where A.ID=B.ID and Subject =’HTML’) Score from StuInfo A</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849709"> <span style="color:#ff0000;">使用EXISTS和 NOT EXISTS完成子查询</span></a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询存在分数的学员的信息</p> 
<p style="margin-left:0;text-align:justify;">Select * from A where exists (select * from B where A.ID=B.ID)</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">——EXISTS / NOT EXISTS 表示存在/不存在的意思。<strong><span style="background-color:#ffff00;"><span style="color:#00b050;">在语句中会判断EXISTS / NOT EXISTS 后连接的子句是否存在和是否不存在。</span></span></strong></p> 
<p style="margin-left:0;text-align:justify;">NOT EXISTS 的用法与EXISTS相同，唯一的区别就是意义相反</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#00b050;">--</span><span style="color:#00b050;">常用的EXISTS用法</span></p> 
<p style="margin-left:0;text-align:justify;"> if exists(select * from sys.databases where name= '名字')</p> 
<p style="margin-left:0;text-align:justify;"> drop database名字</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849710"></a><a name="_Toc25849708"> <span style="color:#ff0000;">使用IN 和 NOT IN完成子查询</span></a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>查询Java分数大于88分的学员姓名</p> 
<p style="margin-left:0;text-align:justify;">Select Name from A where ID in (select ID from B where Score &gt;88 and Subject =’Java’)</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffff00;"><span style="color:#00b050;">——IN子句中可以包含多个值，值之间使用逗号隔开</span></span></strong></p> 
<p style="margin-left:0;text-align:justify;">NOT IN 的用法与IN相同，唯一的区别就是意义相反</p> 
<ol><li style="text-align:justify;"> <h6><span style="color:#ff0000;">使用SOME、ANY、ALL完成子查询</span></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="background-color:#ffff00;"><span style="color:#00b050;">在SQL查询中，SOME、ANY、ALL后必须跟子查询。</span></span></strong></p> 
<p style="margin-left:0;text-align:justify;">SOME和ANY的查询功能是一样的，where条件就能满足SOME和ANY所连接的子查询中的<span style="color:#ff0000;">任意一个值</span>就表示where条件成立。</p> 
<p style="margin-left:0;text-align:justify;">ALL表示的是能够满足ALL所连接的子查询中的<span style="color:#ff0000;">所有值</span>才能成立。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">以’&gt;’运算符为例，&gt;ALL表示大于每一个值。换句话说，它<strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">大于最大值</span></span></strong>。例如，&gt;ALL(1,2,3)表示大于3。&gt;ANY表示至少大于一个值，即<strong><span style="background-color:#ffff00;"><span style="color:#ff0000;">大于最小值</span></span></strong>。因此&gt;ANY(1,2,3)表示大于1</p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>找到大于张三或者李四同学学号的 学生信息</p> 
<p style="margin-left:0;text-align:justify;"> select * from A where ID&gt;<strong><span style="color:#ff0000;">some</span></strong> (select ID from A where Name='张三' or Name='李四')</p> 
<p style="margin-left:0;text-align:justify;"> select * from A where ID&gt;<strong><span style="color:#ff0000;">any </span></strong>(select ID from A where Name='张三' or Name='李四')</p> 
<p style="margin-left:0;text-align:justify;">找到大于张三和李四同学学号的 学生信息</p> 
<p style="margin-left:0;text-align:justify;"> select * from A where ID&gt;<strong><span style="color:#ff0000;">all </span></strong>(select ID from A where Name='张三' or Name='李四')</p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849711"> <span style="color:#ff0000;">排序函数</span></a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;">排序函数语法：<strong><span style="color:#00b050;">OVER ( [</span><span style="color:#00b050;">分组子句] 排序子句 [DESC] [ASC] )</span></strong></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;">排序子句：<strong><span style="color:#00b050;">ORDER BY </span><span style="color:#00b050;">排序列，排序列…</span></strong></span></p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849712"> ROW_NUMBER函数</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>对学员的Java成绩进行排名</p> 
<p style="margin-left:0;text-align:justify;">Select ROW_number() over (order by Score desc) AS 排名, A.Name,B.Score from StuInfo A,StuMarks B where A.ID=B.ID and B.Subject =’Java’</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">ROW_NUMBER</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数排序特点是没有并列编号，不跳空编号</span></span></p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849713"> RANK 函数</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>对学员的Java成绩进行排名</p> 
<p style="margin-left:0;text-align:justify;">Select RANK() over (order by Score desc) AS 排名, A.Name,B.Score from StuInfo A,StuMarks B where A.ID=B.ID and B.Subject =’Java’</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">RANK</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数生成的排序根据排序子句给出递增的序号，但是存在并列并且跳空。</span></span></p> 
<ol><li style="text-align:justify;"> <h6><a name="_Toc25849714"> DENSE_RANK 函数</a></h6> </li></ol> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#00b050;">例：</span></strong>对学员的Java成绩进行排名</p> 
<p style="margin-left:0;text-align:justify;">Select DENSE_RANK() over (order by Score desc) AS 排名, A.Name,B.Score from StuInfo A,StuMarks B where A.ID=B.ID and B.Subject =’Java’</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffff00;"><span style="color:#ff0000;">DENSE_RANK</span></span><span style="background-color:#ffff00;"><span style="color:#ff0000;">函数生成的排序根据排序子句给出递增的序号，但是存在并列不跳空。</span></span></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<table border="1" cellspacing="0"><tbody><tr><td colspan="2" style="border-color:#000000;vertical-align:top;width:414.8pt;"> <p style="margin-left:0;text-align:center;"><strong><span style="color:#ff0000;">排序函数特点</span></strong></p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:144.75pt;"> <p style="margin-left:0;text-align:justify;">ROW_NUMBER函数</p> </td><td style="vertical-align:top;width:270.05pt;"> <p style="margin-left:0;text-align:justify;">没有并列编号，不跳空编号</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:144.75pt;"> <p style="margin-left:0;text-align:justify;">RANK函数</p> </td><td style="vertical-align:top;width:270.05pt;"> <p style="margin-left:0;text-align:justify;">有并列编号，有跳空编号</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:144.75pt;"> <p style="margin-left:0;text-align:justify;">DENSE_RANK函数</p> </td><td style="vertical-align:top;width:270.05pt;"> <p style="margin-left:0;text-align:justify;">有并列编号，没有跳空编号</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:justify;"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0edc0ab3e08ce9377f1ce3cdaeb68443/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">29. 深度学习进阶 - 卷积的原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/366282c6ac1c1633c6e603891547d879/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux救援：开机进不了系统，显示”GRUB＞”命令提示符的解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>