<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python数据处理 - 编程随想</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python数据处理" />
<meta property="og:description" content="一、数组 1.创建 2.属性 a = np.arange(6).reshape(2, 3) # 使用resize方法改变数组形状, 不够的地方通过循环补充 b = np.resize(a, (3, 3)) print(a) print(&#39;更改之后:\n&#39;, b) &#39;&#39;&#39; [[0 1 2] [3 4 5]] 更改之后: [[0 1 2] [3 4 5] [0 1 2]] &#39;&#39;&#39; 3.切片 二、numpy 1.统计 通过axis=0 or 1 来进行行 or 列计算
平均数 mean()
中位数 median()
标准差 std()
方差 var()
最大值 max()
最小值 min()
求和 sum()
加权平均值 average()，其中包含一个weights(相应的权重，数组)
2.文件操作 loadtxt()
3.其他函数 1）random # 产生[-5,5)的两块2行3列的随机生成整数 np.random.randint(-5, 5, size=(2, 2, 3)) &#39;&#39;&#39; array([[[-5, 0, -3], [ 0, -4, -4]], [[ 0, -2, -2], [-1, -4, 0]]]) &#39;&#39;&#39; 可以通过seed()控制随机种子" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/35f0291318f9be5258d0eaa374c4b05c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-09T16:34:24+08:00" />
<meta property="article:modified_time" content="2022-08-09T16:34:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程随想" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程随想</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python数据处理</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>一、数组</h2> 
<h3><a id="1_1"></a>1.创建</h3> 
<p><img src="https://images2.imgbox.com/8e/0c/6AQITGM4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_3"></a>2.属性</h3> 
<p><img src="https://images2.imgbox.com/0a/57/oIECbBVO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 使用resize方法改变数组形状, 不够的地方通过循环补充</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'更改之后:\n'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[0 1 2]
 [3 4 5]]
更改之后:
 [[0 1 2]
 [3 4 5]
 [0 1 2]]
'''</span>
</code></pre> 
<h3><a id="3_21"></a>3.切片</h3> 
<p><img src="https://images2.imgbox.com/ac/a3/rZkGZOmy_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="numpy_23"></a>二、numpy</h2> 
<h3><a id="1_24"></a>1.统计</h3> 
<p><mark>通过axis=0 or 1 来进行行 or 列计算</mark><br> 平均数 mean()<br> 中位数 median()<br> 标准差 std()<br> 方差 var()<br> 最大值 max()<br> 最小值 min()<br> 求和 sum()<br> 加权平均值 average()，其中包含一个weights(相应的权重，数组)</p> 
<h3><a id="2_34"></a>2.文件操作</h3> 
<p><mark>loadtxt()</mark><br> <img src="https://images2.imgbox.com/bd/c0/DiHC1nph_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_37"></a>3.其他函数</h3> 
<h4><a id="1random_38"></a>1）random</h4> 
<p><img src="https://images2.imgbox.com/e9/46/Fe8ZbSad_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 产生[-5,5)的两块2行3列的随机生成整数</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
array([[[-5,  0, -3],
        [ 0, -4, -4]],

       [[ 0, -2, -2],
        [-1, -4,  0]]])
'''</span>
</code></pre> 
<p><mark>可以通过seed()控制随机种子</mark></p> 
<pre><code class="prism language-python"><span class="token comment"># 无论怎么运行输出的值始终保持不变</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
3
4
'''</span>
</code></pre> 
<h4><a id="2_64"></a>2）数组的其他函数</h4> 
<p><img src="https://images2.imgbox.com/7f/5b/7sz5F7XS_o.png" alt="在这里插入图片描述"></p> 
<p><mark>操作不会改变原数组，需要重新接收才可以</mark></p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'增加新元素:\n'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数组:\n'</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
增加新元素:
 [[ 0  1  2  3  1  2  3  4]
 [ 4  5  6  7  1  2  3  4]
 [ 8  9 10 11  1  2  3  4]]
原数组:
 [[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]
'''</span>
</code></pre> 
<h2><a id="matplotlib_83"></a>三、matplotlib</h2> 
<h3><a id="1_84"></a>1.基本方法</h3> 
<p><img src="https://images2.imgbox.com/49/ce/TUcDhEfT_o.png" alt="在这里插入图片描述"></p> 
<p><mark>解决图表中不显示中，同时还需要配合解决负号问题</mark></p> 
<pre><code class="prism language-python"><span class="token comment"># 设置中文字体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>

<span class="token comment"># 解决负号不显示问题</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token triple-quoted-string string">'''
SimHei 中文黑体
Kaiti 中文楷体
LiSu 中文隶书
FangSong 中文仿宋
'''</span>
</code></pre> 
<p>可以通过title(fontsize=18)来改变标题大小，同样也可以plot(linewidth=5)来改变线条的粗细</p> 
<h4><a id="1xticksyticks_xy_104"></a>1）xticks/yticks() x/y坐标轴</h4> 
<p><img src="https://images2.imgbox.com/86/d9/mJOtOzQp_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># ticks可以坐标轴数量 通过label可以得到自己想要的坐标值</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>ticks<span class="token operator">=</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 当前就会输出5个，并且由1,2,3,4,5代替</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a0/ec/j9RFBvJc_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>str_<span class="token punctuation">)</span> <span class="token comment"># 这里的np.str_很关键</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>ticks<span class="token operator">=</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ed/d2/f5LQaa0Y_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2legend__121"></a>2）legend() 图例</h4> 
<p><img src="https://images2.imgbox.com/c3/f0/3ADeF7jL_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3text_123"></a>3）text()</h4> 
<p><img src="https://images2.imgbox.com/d0/a6/AycVNUxF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_125"></a>2.其他元素可视性</h3> 
<h4><a id="1_pltgird_126"></a>1）显示网格 plt.gird()</h4> 
<p><img src="https://images2.imgbox.com/e7/9a/N75B8sqz_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_pltgca_128"></a>2）对坐标轴的操作 plt.gca()</h4> 
<p><img src="https://images2.imgbox.com/2b/78/wliYJZ3r_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">2</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>ticks<span class="token operator">=</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 不需要右、上线条  right left top bottom</span>
ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'right'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'top'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>

<span class="token comment"># 将坐标轴移动到中心位置</span>
ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'left'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_position<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 还有一个outward参数</span>
<span class="token comment"># ax.spines['left'].set_position(('axes', 0.5)) axes范围在0.0-1.0之间</span>
    
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3_147"></a>3）图表的样式参数</h4> 
<p><img src="https://images2.imgbox.com/b6/0a/QMDQgWfs_o.png" alt="在这里插入图片描述"><br> 颜色：蓝色-b；绿色-g；红色-r；青色-c；品红-m；黄色-y；黑色-k；白色-w <mark>颜色也可以用16进制表示，如#FFFFFF</mark><br> 透明度：0-1范围<br> 折线样式：实线：‘-’；虚线：‘- -’；点划线：‘-.’；虚线：‘：’<br> 标记点：点标记：‘.’；圆圈：‘o’；X标记：‘X’；钻石标记：‘D’；六角标记：‘H’；正方形标记：‘s’；加号标记：‘+’</p> 
<h4><a id="4_153"></a>4）创建图形对象</h4> 
<p><img src="https://images2.imgbox.com/6c/23/oP48JzM3_o.png" alt="在这里插入图片描述"></p> 
<p><mark>可以通过plt.figure().add_subplot()方式绘制子图</mark><br> <img src="https://images2.imgbox.com/28/61/3NFcod31_o.png" alt="在这里插入图片描述"><br> 如果子图2标题显示在子图1里面，可以通过plt.tight_layout()解决</p> 
<p>还可以通过 <mark>subplots()</mark> 方法创建子图，这也是通过返回区域对象设置，很多方法都是set_开头，例如set_title()设置标题</p> 
<pre><code class="prism language-python"><span class="token comment"># 创建了一个2行2列的画布，由fig接收figure参数，axes接收具体是哪个画布</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> x <span class="token operator">**</span> x<span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'square'</span><span class="token punctuation">)</span>

axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'sqrt'</span><span class="token punctuation">)</span>

axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'exp'</span><span class="token punctuation">)</span>

axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> np<span class="token punctuation">.</span>log10<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'log10'</span><span class="token punctuation">)</span>

<span class="token comment"># 处理标题遮挡</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b5/d9/qplihuWi_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_184"></a>3.基本图形绘制</h3> 
<h4><a id="1_185"></a>1）柱状图</h4> 
<p><img src="https://images2.imgbox.com/9a/a4/C6g875Gf_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">countries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'纳微'</span><span class="token punctuation">,</span> <span class="token string">'德国'</span><span class="token punctuation">,</span> <span class="token string">'中国'</span><span class="token punctuation">,</span> <span class="token string">'美国'</span><span class="token punctuation">,</span> <span class="token string">'瑞典'</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 对应金牌、银牌、铜牌</span>
gold_medal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span>
silver_medal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
bronze_medal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>

<span class="token comment"># 设置位置</span>
len_array <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>countries<span class="token punctuation">)</span><span class="token punctuation">)</span>
width <span class="token operator">=</span> <span class="token number">0.2</span>
a <span class="token operator">=</span> len_array
b <span class="token operator">=</span> len_array <span class="token operator">+</span> width
c <span class="token operator">=</span> len_array <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> width

plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>a<span class="token punctuation">,</span>gold_medal<span class="token punctuation">,</span> width<span class="token operator">=</span>width<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'gold'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>b<span class="token punctuation">,</span>silver_medal<span class="token punctuation">,</span> width<span class="token operator">=</span>width<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>c<span class="token punctuation">,</span>bronze_medal<span class="token punctuation">,</span> width<span class="token operator">=</span>width<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>

<span class="token comment"># 使横坐标移动到中间位置</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>len_array <span class="token operator">+</span> width<span class="token punctuation">,</span> labels<span class="token operator">=</span>countries<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

<span class="token comment"># 设置具体数值</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>countries<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 垂直居底 水平居中</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> gold_medal<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> gold_medal<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> silver_medal<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> silver_medal<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> bronze_medal<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> bronze_medal<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'金牌'</span><span class="token punctuation">,</span> <span class="token string">'铜牌'</span><span class="token punctuation">,</span> <span class="token string">'银牌'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5d/dc/6oZ7z2wu_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_225"></a>2）饼图</h4> 
<p><img src="https://images2.imgbox.com/04/5a/CZrLQq5I_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_227"></a>3）散点图</h4> 
<p><img src="https://images2.imgbox.com/a7/d6/ietlGAcz_o.png" alt=" "></p> 
<h2><a id="pandas_229"></a>四、pandas</h2> 
<h3><a id="1Series_0_230"></a>1.Series 类似于字典，但索引默认从0开始</h3> 
<p><img src="https://images2.imgbox.com/18/df/picU32nJ_o.png" alt="在这里插入图片描述"><br> <mark>如果标签中出现数值型数据，就不可以通过下标取值了</mark></p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 报错，但是可以通过x[1]取出2，其他1和4必须通过x['a']和x['b']的方式取出</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 可以通过index指定索引下标</span>
data <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
100    0
101    1
102    2
dtype: int32
'''</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 当指定索引不能和字典健匹配时，索引补充NAN</span>
d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>d<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
a    1.0
d    NaN
e    NaN
dtype: float64
'''</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 可以通过[[]]方式访问多个元素</span>
s<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
1
2
3
'''</span>
</code></pre> 
<p><mark>head() 查看前几条数据，默认5条<br> tail() 查看后几条数据，默认5条<br> reindex() 重新索引，可以通过fill_value参数来添加缺失值<br> drop() 删除，通过inplace参数控制是否修改原值</mark></p> 
<h3><a id="2DataFrame_277"></a>2.DataFrame</h3> 
<h4><a id="1_278"></a>1）创建</h4> 
<p><img src="https://images2.imgbox.com/93/95/r6C5Fscr_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/50/bd/2AAsbhP8_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/55/3c/3tNLEmyV_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'abc'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'def'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'hij'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df
<span class="token triple-quoted-string string">'''
   name	value
0	abc	10
1	def	20
2	hij	30
'''</span>
</code></pre> 
<pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'second'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df
<span class="token triple-quoted-string string">'''
        a	b	 c
first	1	2	NaN
second	2	3	4.0
'''</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 使用Series创建DataFrame</span>
<span class="token comment"># 可以通过这种方式 设置每列不同数据类型</span>

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'yjy'</span><span class="token punctuation">,</span> <span class="token string">'zah'</span><span class="token punctuation">,</span> <span class="token string">'qjw'</span><span class="token punctuation">,</span> <span class="token string">'dk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'gender'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'salary'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">4500.5</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">780.4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
df
<span class="token triple-quoted-string string">'''
	Name	Age	gender	salary
0	yjy	    22	 男	    600.0
1	zah	    22	 男	    4500.5
2	qjw	    23	 男		600.0
3	dk	    23	 男		780.4
'''</span>
</code></pre> 
<h4><a id="2_336"></a>2）添加/删除列</h4> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'add'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'add2'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">+</span> df<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span>
df
<span class="token triple-quoted-string string">'''

	Name	Age	gender	salary add	add2
0	yjy		22	男		600.0	1	622.0
1	zah		22	男		4500.5	2	4522.5
2	qjw		23	男		600.0	3	623.0
3	dk		23	男		780.4	NaN	803.4
'''</span>
</code></pre> 
<p><mark>insert() 方法添加</mark><br> <img src="https://images2.imgbox.com/4e/25/Ez8t75vK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'second'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token string">'add'</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 添加到哪列，列名，列值</span>
df
<span class="token triple-quoted-string string">'''
		one	add	two
first	1	4	2
second	5	5	6
'''</span>
</code></pre> 
<p><mark>del 和 pop() 都可以删除列，其中pop()有返回值</mark></p> 
<h4><a id="3_365"></a>3）处理行</h4> 
<p>需要通过loc() 属性来完成，全部使用的是标签索性<br> iloc() 全部使用的位置索引</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
one    1
add    4
two    2
Name: first, dtype: int64
'''</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 还可以读取指定行、列</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
1
'''</span>
</code></pre> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 可以，用切片的方式可以直接使用位置索引</span>
df<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 不可以</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0a/04/dC0aq7Cg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'one'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'add'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'add'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df
<span class="token triple-quoted-string string">'''
		one	add	two
first	1.0	4.0	2.0
second	5.0	5.0	6.0
add		3.0	4.0	NaN
'''</span>
<span class="token comment"># df = df.append(data, ignore_index=True)</span>
<span class="token comment"># 下面这种方式会把原来的索引值变成0 1 2</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ae/5f/A9s8vXFF_o.png" alt="在这里插入图片描述"><br> <mark>使用drop() 方法删除行，需要接收，或者通过inplace=True参数来更改</mark></p> 
<h4><a id="4_408"></a>4）属性和方法</h4> 
<p><img src="https://images2.imgbox.com/e7/6d/xhH6pzB9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/08/66/4KKmcSri_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b9/e9/jeG5Svrd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/da/46/WKc2zHoh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8f/21/MIad5eAk_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># first行升序， add行降序</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'add'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df
<span class="token comment"># 实际上最后一个add行并没有降序排序</span>
<span class="token triple-quoted-string string">'''
		one	two	add
first	1.0	2.0	4.0
second	5.0	6.0	5.0
add		3.0	NaN	4.0  
'''</span>

<span class="token comment"># 将原 df 列名 Unnamed: 2、Unnamed: 3、Unnamed: 4 修改为 金牌数、银牌数、铜牌数</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'Unnamed: 2'</span><span class="token punctuation">:</span><span class="token string">'金牌数'</span><span class="token punctuation">,</span>
                  <span class="token string">'Unnamed: 3'</span><span class="token punctuation">:</span><span class="token string">'银牌数'</span><span class="token punctuation">,</span>
                  <span class="token string">'Unnamed: 4'</span><span class="token punctuation">:</span><span class="token string">'铜牌数'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> 
                  
<span class="token comment"># 将第一列（排名）设置为索引</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">"排名"</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 修改索引名为 金牌排名</span>
df<span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token string">"金牌排名"</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 将 无 替换为 缺失值,将 0 替换为 None</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'无'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span><span class="token string">'None'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 新增两列，分别是</span>
<span class="token comment"># 金铜牌总数（金牌数+铜牌数）</span>
<span class="token comment"># 银铜牌总数（银牌数+铜牌数）</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>金铜牌总数<span class="token operator">=</span>df<span class="token punctuation">.</span>金牌数 <span class="token operator">+</span> df<span class="token punctuation">.</span>铜牌数<span class="token punctuation">,</span>
			   银铜牌总数<span class="token operator">=</span>df<span class="token punctuation">.</span>银牌数<span class="token operator">+</span>df<span class="token punctuation">.</span>铜牌数<span class="token punctuation">)</span> 

<span class="token comment"># 提取第 1、2、3、4 列名</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 等价于df[['金牌数', '银牌数', '铜牌数']]</span>

<span class="token comment"># 提取 中国、美国、英国、日本、巴西 五行数据</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'国家奥委会'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'中国'</span><span class="token punctuation">,</span><span class="token string">'美国'</span><span class="token punctuation">,</span><span class="token string">'英国'</span><span class="token punctuation">,</span><span class="token string">'日本'</span><span class="token punctuation">,</span><span class="token string">'巴西'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 在上一题的条件下，新增一个条件：金牌数小于30</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'金牌数'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'国家奥委会'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'中国'</span><span class="token punctuation">,</span><span class="token string">'美国'</span><span class="token punctuation">,</span><span class="token string">'英国'</span><span class="token punctuation">,</span><span class="token string">'日本'</span><span class="token punctuation">,</span><span class="token string">'巴西'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 提取 国家奥委会 列中，所有包含 国的行</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>国家奥委会<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'国'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 如果是查找以 国 为结尾，用endwith</span>

<span class="token comment"># 提取行索引为 4 ，列名为 金牌数 的值</span>
df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'金牌数'</span><span class="token punctuation">]</span>

<span class="token comment"># 使用 query 提取 金牌数 + 银牌数 大于 15 的国家</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'金牌数+银牌数 &gt; 15'</span><span class="token punctuation">)</span>

<span class="token comment"># 使用 query 提取 金牌数 大于 金牌均值的国家</span>
gold_mean <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'金牌数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'金牌数 &gt; </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>gold_mean<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3time_470"></a>3.time</h3> 
<p><img src="https://images2.imgbox.com/91/5a/doXnHlHp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/72/ab/9t82Req5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4datetime_473"></a>4.datetime</h3> 
<p><mark>datatime模块重新封装了time模块，提供了更多接口、类：date、time、datetime、timedelta、tzinfo</mark></p> 
<h4><a id="1data_475"></a>1）data类</h4> 
<p><img src="https://images2.imgbox.com/6d/04/nP8BFFLt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/97/7pgkwg6a_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2datetime_478"></a>2）datetime类</h4> 
<p><img src="https://images2.imgbox.com/67/4a/P9xohzFg_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3timedelta_480"></a>3）timedelta类</h4> 
<p><mark>可以方便的在日期上做天、小时、分钟等相关数据的运算</mark></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> date<span class="token punctuation">,</span> datetime<span class="token punctuation">,</span> timedelta<span class="token punctuation">,</span> tzinfo

dt <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获得当前时间</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">,</span> dt<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %X'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

dt_yesterday <span class="token operator">=</span> dt <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 昨天</span>
dt_tomorrow <span class="token operator">=</span> dt <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 明天</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>dt_yesterday<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %X'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dt_tomorrow<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %X'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="4_495"></a>4）时间转化</h4> 
<p><img src="https://images2.imgbox.com/ef/9b/jzdPcojx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 将复数形式转化为datetime格式</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'year'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">2018</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'month'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0   2022-09-02
1   2018-09-07
dtype: datetime64[ns]
'''</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 通过origin设置起始时间</span>
pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">,</span> origin<span class="token operator">=</span>pd<span class="token punctuation">.</span>Timestamp<span class="token punctuation">(</span><span class="token string">'2022-8-4'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
DatetimeIndex(['2022-08-05', '2022-08-02', '2022-08-07'], dtype='datetime64[ns]', freq=None)
'''</span>
</code></pre> 
<h4><a id="5_516"></a>5）生成时间戳范围</h4> 
<p><img src="https://images2.imgbox.com/ed/cd/doVyd0ZS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/88/2e/FMgkwiux_o.png" alt="在这里插入图片描述"><br> <mark>这里的periods是要输出多少个日期</mark></p> 
<pre><code class="prism language-python">pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">'2022-8-4'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2022-8-6'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token string">''</span>'
DatetimeIndex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2022-08-04 00:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2022-08-04 16:00:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2022-08-05 08:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2022-08-06 00:00:00'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              dtype<span class="token operator">=</span><span class="token string">'datetime64[ns]'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token string">' 	'</span>'
</code></pre> 
<p><img src="https://images2.imgbox.com/75/c0/5dLRcNZs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_530"></a>5.数据的读取和存储</h3> 
<h4><a id="1_531"></a>1）读取</h4> 
<table><thead><tr><th>方法</th><th>文件类型</th></tr></thead><tbody><tr><td>read_csv()</td><td>读取CSV文件</td></tr><tr><td>read_excel()</td><td>读取EXCEL文件</td></tr><tr><td>read_json()</td><td>读取JSON文件</td></tr><tr><td>read_table()</td><td>读取TXT文件</td></tr></tbody></table> 
<table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>nrows</td><td>顺序读取指定行数</td></tr><tr><td>skiprows</td><td>指定读取哪些行</td></tr><tr><td>usecols</td><td>指定读取哪些列</td></tr><tr><td>index_col</td><td>指定索引</td></tr><tr><td>names</td><td>设置标题名称</td></tr><tr><td>keep_default_na</td><td>将缺失值标记为NA</td></tr><tr><td>na_values</td><td>指定缺失值的表述方式</td></tr><tr><td>na_filter</td><td>不处理缺失值</td></tr><tr><td>dtype</td><td>设置数据类型</td></tr><tr><td>chunksize</td><td>每次读取多少行</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token comment"># 读取前20行数据</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> nrows<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>

<span class="token comment"># 跳过前20行</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> skiprows<span class="token operator">=</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 读取当前目录下 某招聘网站数据.csv 文件中全部偶数行</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> skiprows<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 指定列，可以用列索引也可以用列名</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 指定索引</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">'positionId'</span><span class="token punctuation">)</span>

<span class="token comment"># 将 positionId、positionName、salary 列，并将标题设置为 ID、岗位名称、薪资</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'ID'</span><span class="token punctuation">,</span> <span class="token string">'岗位名称'</span><span class="token punctuation">,</span> <span class="token string">'薪资'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 将缺失值标记为 NA</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> keep_default_na<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 将[]标记为缺失值</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span>na_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'[]'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 不处理缺失值</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"某招聘网站数据.csv"</span><span class="token punctuation">,</span>na_filter<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 将 positionId,companyId 设置为字符串格式</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'某招聘网站数据.csv'</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'positionId'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span><span class="token string">'companyId'</span><span class="token punctuation">:</span><span class="token builtin">str</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 返回一个可迭代对象，每次读取 10 行</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"某招聘网站数据.csv"</span><span class="token punctuation">,</span> chunksize<span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2_585"></a>2）存储</h4> 
<pre><code class="prism language-python"><span class="token comment"># 且只保留positionName、salary两列</span>
data<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./outdata/33.csv'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'positionName'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 取消每一行的索引</span>
data<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./outdata/34.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="6_595"></a>6.数据预览与处理</h3> 
<h4><a id="1_596"></a>1）查看</h4> 
<p>做为DataFrame的补充</p> 
<table><thead><tr><th>方法</th><th>功能</th></tr></thead><tbody><tr><td>sample()</td><td>随机查看数据，默认为1条</td></tr><tr><td>describe()</td><td>查看 数值型 列的统计信息</td></tr><tr><td>round()</td><td>保留小数</td></tr><tr><td>idxmax()</td><td>返回每列最大值在哪行</td></tr><tr><td>median()</td><td>中位数</td></tr><tr><td>mode()</td><td>众数</td></tr><tr><td>groupby()</td><td>分组</td></tr><tr><td>corr()</td><td>相关系数矩阵</td></tr><tr><td>value_counts()</td><td>统计不同值得次数</td></tr><tr><td>rename_axis</td><td>重新命名，默认是列</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token comment"># 计算 总分、高端人才得分、办学层次得分的最大最小值、中位数、均值</span>
df<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">"总分"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"min"</span><span class="token punctuation">,</span> <span class="token string">"max"</span><span class="token punctuation">,</span> <span class="token string">"median"</span><span class="token punctuation">,</span> <span class="token string">"mean"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"高端人才得分"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"min"</span><span class="token punctuation">,</span> <span class="token string">"max"</span><span class="token punctuation">,</span> <span class="token string">"median"</span><span class="token punctuation">,</span> <span class="token string">"mean"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"办学层次得分"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">"min"</span><span class="token punctuation">,</span> <span class="token string">"max"</span><span class="token punctuation">,</span> <span class="token string">"median"</span><span class="token punctuation">,</span> <span class="token string">"mean"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 计算各省市总分均值，可以是多个分组</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"省市"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'总分'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 不使用 district 做为索引</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"district"</span><span class="token punctuation">,</span> as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 计算不同行政区(district)，不同规模公司(companySize)出现的次数</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'companySize'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2_629"></a>2）缺失值</h4> 
<table><thead><tr><th>方法</th><th>功能</th></tr></thead><tbody><tr><td>isnull()</td><td>识别缺失值。可以配合sum()查看缺失值数目</td></tr><tr><td>dropna()</td><td>删除缺失值。axis接收0/1判断是行/列删除，how表示删除形式（all 全部为缺失值时才删除，默认为any 只要有就删除），subset表示去重的行/列（默认为None，所有行列），inplace是否在原数据上操作</td></tr><tr><td>fillna()</td><td>替换缺失值。method接收string（取bfill时用下一个非缺失值来填充，ffill用上一个），limit限制填充个数</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token comment"># df是存放数据的参数名</span>
<span class="token comment"># 每列具体由多少缺失值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 缺失值所在的行并增量</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>highlight_null<span class="token punctuation">(</span>null_color<span class="token operator">=</span><span class="token string">'skyblue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 删除缺失值</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 缺失值替换为 *</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span>

<span class="token comment"># 对于评分列的缺失值处理，我们可以用上一个电影的评分进行填充</span>
df<span class="token punctuation">[</span><span class="token string">'评分'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">'ffill'</span><span class="token punctuation">)</span>

<span class="token comment"># 将评价人数列的缺失值，用整列的均值进行填充</span>
df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 评价人数列的缺失值，用上下数字的均值进行填充</span>
df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'评价人数'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>interpolate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3_659"></a>3）重复值</h4> 
<pre><code class="prism language-python"><span class="token comment"># 重复值所在的行筛选出来</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 根据某列查找重复值</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'导演'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 删除全部的重复值，但保留最后一次出现的值</span>
<span class="token comment"># first保留第一个，默认为False全部删除</span>
df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>keep <span class="token operator">=</span> <span class="token string">'last'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="7_672"></a>7.数据分组和聚合</h3> 
<h4><a id="1groupby_673"></a>1）groupby</h4> 
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>by</td><td>分组对象</td></tr><tr><td>axis</td><td>行/列</td></tr><tr><td>level</td><td>索引名</td></tr><tr><td>as_index</td><td>聚合标签是否以DataFrame索引形式输出，默认为True</td></tr><tr><td>sort</td><td>排序。默认为True</td></tr><tr><td>group_keys</td><td>显示分组标签名称。默认为True</td></tr><tr><td>squeeze</td><td>对数据进行降维度。默认为False</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token comment"># 计算各区(district)的薪资(salary)均值</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'district'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 重新按照上一题要求进行分组，但不使用 district 做为索引</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"district"</span><span class="token punctuation">,</span> as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 计算并提取平均薪资最高的区</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'district'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 计算不同行政区(district)，不同规模公司(companySize)出现的次数</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'companySize'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 将上一题的索引名修改为 district -&gt; 行政区；companySize -&gt; 公司规模</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"district"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'companySize'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"行政区"</span><span class="token punctuation">,</span> <span class="token string">"公司规模"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 计算上一题，每个区出现的公司数量</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"district"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'companySize'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据按照 district、salary 进行分组，并查看各分组内容</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'district'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groups

<span class="token comment"># 将数据按照 district、salary 进行分组，并查看西湖区薪资为 30000 的工作</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"district"</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_group<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"西湖区"</span><span class="token punctuation">,</span><span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 将 score 和 matchScore 的和记为总分，与 salary 列同时进行分组，并查看结果</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'salary'</span><span class="token punctuation">:</span><span class="token string">'薪资'</span><span class="token punctuation">,</span><span class="token string">'score'</span><span class="token punctuation">:</span><span class="token string">'总分'</span><span class="token punctuation">,</span><span class="token string">'matchScore'</span><span class="token punctuation">:</span><span class="token string">'总分'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 在原数据框 df 新增一列，数值为该区的平均薪资水平</span>
df<span class="token punctuation">[</span><span class="token string">'平均薪资'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">'mean'</span><span class="token punctuation">)</span>

<span class="token comment"># 提取平均工资小于 30000 的行政区的全部数据</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">30000</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2apply_718"></a>2）apply</h4> 
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>func</td><td>每行or每列的函数。默认无</td></tr><tr><td>axis</td><td>行/列</td></tr><tr><td>broadcast</td><td>是否广播。默认False</td></tr><tr><td>reduce</td><td>返回值的格式。默认为False</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token comment"># 计算各行政区的企业领域（industryField）包含电商的总数</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"district"</span><span class="token punctuation">,</span> sort<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"industryField"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"电商"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3agg_730"></a>3）agg</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 分组计算不同行政区，薪水的最小值、最大值和平均值</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 将上一题的列名（包括索引名）修改为中文</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>
    最低工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    最高工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    平均工资<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"行政区"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 对不同行政区进行分组，并统计薪水的均值、中位数、方差，以及得分的均值</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'salary'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> np<span class="token punctuation">.</span>median<span class="token punctuation">,</span> np<span class="token punctuation">.</span>std<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'score'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>mean
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 在聚合计算时新增一列计算最大值与平均值的差值</span>
<span class="token keyword">def</span> <span class="token function">myfunc</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'district'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>
    最低工资 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    最高工资 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    平均工资 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    最大值与均值差值 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> myfunc<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>rename_axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"行政区"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8_763"></a>8.数据透视与合并</h3> 
<h4><a id="1_764"></a>1）透视表</h4> 
<p>pd.pivot_table</p> 
<table><thead><tr><th>参数名称</th><th>说明</th></tr></thead><tbody><tr><td>data</td><td>接收DataFrame数据</td></tr><tr><td>values</td><td>用于指定聚合的数据字段名</td></tr><tr><td>index</td><td>行分组键</td></tr><tr><td>columns</td><td>列分组键</td></tr><tr><td>aggfunc</td><td>聚合函数</td></tr><tr><td>dropna</td><td>删除NaN列</td></tr></tbody></table> 
<pre><code class="prism language-python"><span class="token comment"># 制作各省「销售总额」与「平均销售额」的数据透视表</span>
pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>data<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token string">'省/自治区'</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 制作各省市「不同类别」产品的「销售总额」透视表</span>
pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>data<span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'省/自治区'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'类别'</span><span class="token punctuation">,</span> aggfunc <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">)</span>

<span class="token comment"># 制作「各省市」、「不同类别」产品「销售量与销售额」的「均值与总和」的数据透视表，并在最后追加一行『合计』</span>
pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>data<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">,</span> <span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'省/自治区'</span><span class="token punctuation">,</span> <span class="token string">'类别'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span> <span class="token builtin">sum</span><span class="token punctuation">]</span><span class="token punctuation">,</span> margins<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 在上一题的基础上，查询 「类别」 等于 「办公用品」 的详情</span>
table <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>data<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'销售额'</span><span class="token punctuation">,</span> <span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'省/自治区'</span><span class="token punctuation">,</span> <span class="token string">'类别'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span> <span class="token builtin">sum</span><span class="token punctuation">]</span><span class="token punctuation">,</span> margins<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
table<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'类别 == ["办公用品"]'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2_789"></a>2）合并</h4> 
<p>左外连接：保留左表数据，右表与之相同字段<br> 右外连接：保留右表数据，左表与之相同字段<br> 内连接：两个表相同字段<br> 外连接：所有字段</p> 
<p>连接方法有pd.concat、pd.merge、join</p> 
<pre><code class="prism language-python"><span class="token comment"># concat连接</span>
<span class="token comment"># 内连接的横向方法拼接df1、df4</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df4<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> join<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>

<span class="token comment"># 只取包含 df1 索引的部分</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df4<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>df1<span class="token punctuation">.</span>index<span class="token punctuation">)</span>

<span class="token comment"># 拼接 df1、df2、df3，同时新增一个索引（x、y、z）来区分不同的表数据来源</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> df3<span class="token punctuation">]</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token comment"># merge连接</span>
<span class="token comment"># 左连接关键字key1、key2的方法 拼接left和right</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">,</span> <span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token comment"># join连接</span>
<span class="token comment"># 右连接关键字key1、key2 拼接left和right</span>
left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">,</span> <span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/009d2fedef07ec5e23d95e95b6f7b267/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sql语句中使用临时表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/db36395d77e825a36f5ccc5c95486090/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vscode搜索所有汉字</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程随想.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151182"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>